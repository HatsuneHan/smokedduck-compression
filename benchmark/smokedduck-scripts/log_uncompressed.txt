
Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│         PROJECTION        │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│__internal_decompress_strin│
│           g(#0)           │
│__internal_decompress_strin│
│           g(#1)           │
│             #2            │
│             #3            │
│             #4            │
│             #5            │
│             #6            │
│             #7            │
│             #8            │
│             #9            │
└─────────────┬─────────────┘                             
┌─────────────┴─────────────┐
│          ORDER_BY         │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│          ORDERS:          │
│ lineitem.l_returnflag ASC │
│ lineitem.l_linestatus ASC │
└─────────────┬─────────────┘                             
┌─────────────┴─────────────┐
│         PROJECTION        │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│__internal_compress_string_│
│        utinyint(#0)       │
│__internal_compress_string_│
│        utinyint(#1)       │
│             #2            │
│             #3            │
│             #4            │
│             #5            │
│             #6            │
│             #7            │
│             #8            │
│             #9            │
└─────────────┬─────────────┘                             
┌─────────────┴─────────────┐
│         PROJECTION        │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│__internal_decompress_strin│
│           g(#0)           │
│__internal_decompress_strin│
│           g(#1)           │
│             #2            │
│             #3            │
│             #4            │
│             #5            │
│             #6            │
│             #7            │
│             #8            │
│             #9            │
└─────────────┬─────────────┘                             
┌─────────────┴─────────────┐
│   PERFECT_HASH_GROUP_BY   │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│             #0            │
│             #1            │
│    sum_no_overflow(#2)    │
│    sum_no_overflow(#3)    │
│    sum_no_overflow(#4)    │
│    sum_no_overflow(#5)    │
│          avg(#6)          │
│          avg(#7)          │
│          avg(#8)          │
│        count_star()       │
└─────────────┬─────────────┘                             
┌─────────────┴─────────────┐
│         PROJECTION        │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│        l_returnflag       │
│        l_linestatus       │
│         l_quantity        │
│      l_extendedprice      │
│             #4            │
│   (#4 * (1.00 + l_tax))   │
│         l_quantity        │
│      l_extendedprice      │
│         l_discount        │
└─────────────┬─────────────┘                             
┌─────────────┴─────────────┐
│         PROJECTION        │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│__internal_compress_string_│
│        utinyint(#0)       │
│__internal_compress_string_│
│        utinyint(#1)       │
│             #2            │
│             #3            │
│             #4            │
│             #5            │
│             #6            │
└─────────────┬─────────────┘                             
┌─────────────┴─────────────┐
│         PROJECTION        │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│        l_returnflag       │
│        l_linestatus       │
│         l_quantity        │
│      l_extendedprice      │
│ (l_extendedprice * (1.00 -│
│        l_discount))       │
│           l_tax           │
│         l_discount        │
└─────────────┬─────────────┘                             
┌─────────────┴─────────────┐
│         SEQ_SCAN          │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│          lineitem         │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│        l_returnflag       │
│        l_linestatus       │
│         l_quantity        │
│      l_extendedprice      │
│         l_discount        │
│           l_tax           │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│ Filters: l_shipdate<='1998│
│-09-02'::DATE AND l_sh...  │
│         IS NOT NULL       │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│        EC: 1200243        │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

uncompressed filter_log_size: 816
uncompressed filter_log_buffer_size: 0
uncompressed limit_offset_size: 816
uncompressed limit_offset_buffer_size: 0
uncompressed perfect_full_scan_ht_log_size: 816
uncompressed perfect_full_scan_ht_log_buffer_size: 0
uncompressed perfect_probe_ht_log_size: 816
uncompressed perfect_probe_ht_log_buffer_size: 0
uncompressed row_group_log_size: 23798252
uncompressed row_group_log_buffer_size: 23666364
uncompressed scatter_log_size: 47399080
uncompressed scatter_log_buffer_size: 47332728
uncompressed scatter_sel_log_size: 816
uncompressed scatter_sel_log_buffer_size: 0
uncompressed gather_log_size: 816
uncompressed gather_log_buffer_size: 0
uncompressed combine_log_size: 904
uncompressed combine_log_buffer_size: 64
uncompressed finalize_states_log_size: 864
uncompressed finalize_states_log_buffer_size: 32
uncompressed join_gather_log_size: 816
uncompressed join_gather_log_buffer_size: 0
uncompressed reorder_log_size: 872
uncompressed reorder_log_buffer_size: 0
uncompressed cross_log_size: 816
uncompressed cross_log_buffer_size: 0
uncompressed nlj_log_size: 816
uncompressed nlj_log_buffer_size: 0
uncompressed total_size: 71207316
uncompressed total_buffer_size: 70999188
uncompressed total_element_size: 208128

Clear Lineage
True
%%%%%%%%%%%%%%%% Running Query #  1  threads:  1
SELECT l_returnflag, l_linestatus, sum(l_quantity) AS sum_qty, sum(l_extendedprice) AS sum_base_price, sum(l_extendedprice * (1 - l_discount)) AS sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) AS sum_charge, avg(l_quantity) AS avg_qty, avg(l_extendedprice) AS avg_price, avg(l_discount) AS avg_disc, count(*) AS count_order FROM lineitem WHERE l_shipdate <= CAST('1998-09-02' AS date) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus
Run:  None SELECT l_returnflag, l_linestatus, sum(l_quantity) AS sum_qty, sum(l_extendedprice) AS sum_base_price, sum(l_extendedprice * (1 - l_discount)) AS sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) AS sum_charge, avg(l_quantity) AS avg_qty, avg(l_extendedprice) AS avg_price, avg(l_discount) AS avg_disc, count(*) AS count_order FROM lineitem WHERE l_shipdate <= CAST('1998-09-02' AS date) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus
Avg Time in sec:  0.5535562722943723  output size:  4
  l_returnflag l_linestatus     sum_qty  ...     avg_price  avg_disc  count_order
0            A            F  37734107.0  ...  38273.129735  0.049985      1478493
1            N            F    991417.0  ...  38284.467761  0.050093        38854
2            N            O  74476040.0  ...  38249.117989  0.049997      2920374
3            R            F  37719753.0  ...  38250.854626  0.050009      1478870

[4 rows x 10 columns]
{'name': 'Query', 'result': 0.547329, 'timing': 0.547329, 'cardinality': 0, 'extra-info': "SELECT l_returnflag, l_linestatus, sum(l_quantity) AS sum_qty, sum(l_extendedprice) AS sum_base_price, sum(l_extendedprice * (1 - l_discount)) AS sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) AS sum_charge, avg(l_quantity) AS avg_qty, avg(l_extendedprice) AS avg_price, avg(l_discount) AS avg_disc, count(*) AS count_order FROM lineitem WHERE l_shipdate <= CAST('1998-09-02' AS date) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 3.3e-05, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 1e-06, 'cardinality': 4, 'extra_info': '__internal_decompress_string(#0)\n__internal_decompress_string(#1)\n#2\n#3\n#4\n#5\n#6\n#7\n#8\n#9\n', 'children': [{'name': 'ORDER_BY', 'timing': 7e-05, 'cardinality': 4, 'extra_info': 'ORDERS:\nlineitem.l_returnflag ASC\nlineitem.l_linestatus ASC', 'children': [{'name': 'PROJECTION', 'timing': 2e-06, 'cardinality': 4, 'extra_info': '__internal_compress_string_utinyint(#0)\n__internal_compress_string_utinyint(#1)\n#2\n#3\n#4\n#5\n#6\n#7\n#8\n#9\n', 'children': [{'name': 'PROJECTION', 'timing': 4e-06, 'cardinality': 4, 'extra_info': '__internal_decompress_string(#0)\n__internal_decompress_string(#1)\n#2\n#3\n#4\n#5\n#6\n#7\n#8\n#9\n', 'children': [{'name': 'PERFECT_HASH_GROUP_BY', 'timing': 0.129183, 'cardinality': 4, 'extra_info': '#0\n#1\nsum_no_overflow(#2)\nsum_no_overflow(#3)\nsum_no_overflow(#4)\nsum_no_overflow(#5)\navg(#6)\navg(#7)\navg(#8)\ncount_star()', 'children': [{'name': 'PROJECTION', 'timing': 0.045531, 'cardinality': 5916591, 'extra_info': 'l_returnflag\nl_linestatus\nl_quantity\nl_extendedprice\n#4\n(#4 * (1.00 + l_tax))\nl_quantity\nl_extendedprice\nl_discount\n', 'children': [{'name': 'PROJECTION', 'timing': 0.023996, 'cardinality': 5916591, 'extra_info': '__internal_compress_string_utinyint(#0)\n__internal_compress_string_utinyint(#1)\n#2\n#3\n#4\n#5\n#6\n', 'children': [{'name': 'PROJECTION', 'timing': 0.066454, 'cardinality': 5916591, 'extra_info': 'l_returnflag\nl_linestatus\nl_quantity\nl_extendedprice\n(l_extendedprice * (1.00 - l_discount))\nl_tax\nl_discount\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.271829, 'cardinality': 5916591, 'extra_info': "lineitem\n[INFOSEPARATOR]\nl_returnflag\nl_linestatus\nl_quantity\nl_extendedprice\nl_discount\nl_tax\n[INFOSEPARATOR]\nFilters: l_shipdate<='1998-09-02'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243", 'children': []}]}]}]}]}]}]}]}]}]}]}
X {'RESULT_COLLECTOR0': 3.3e-05, 'PROJECTION1': 1e-06, 'ORDER_BY2': 7e-05, 'PROJECTION3': 2e-06, 'PROJECTION4': 4e-06, 'PERFECT_HASH_GROUP_BY5': 0.129183, 'PROJECTION6': 0.045531, 'PROJECTION7': 0.023996, 'PROJECTION8': 0.066454, 'SEQ_SCAN 9': 0.271829}
**** output size:  4
LINEAGE_4_ORDER_BY_7
LINEAGE_4_PERFECT_HASH_GROUP_BY_4
LINEAGE_4_SEQ_SCAN_0
SELECT l_returnflag, l_linestatus, sum(l_quantity) AS sum_qty, sum(l_extendedprice) AS sum_base_price, sum(l_extendedprice * (1 - l_discount)) AS sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) AS sum_charge, avg(l_quantity) AS avg_qty, avg(l_extendedprice) AS avg_price, avg(l_discount) AS avg_disc, count(*) AS count_order FROM lineitem WHERE l_shipdate <= CAST('1998-09-02' AS date) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus
   query_id  ...                                               plan
0         4  ...  {"name": "PROJECTION", "opid": "8", "children"...

[1 rows x 7 columns]
Query info:  query_id                                                            4
query               SELECT l_returnflag, l_linestatus, sum(l_quant...
size_bytes_max                                               71207316
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "PROJECTION", "opid": "8", "children"...
Name: 0, dtype: object
{"name": "PROJECTION", "opid": "8", "children": [{"name": "ORDER_BY", "opid": "7", "children": [{"name": "PROJECTION", "opid": "6", "children": [{"name": "PROJECTION", "opid": "5", "children": [{"name": "PERFECT_HASH_GROUP_BY", "opid": "4", "children": [{"name": "PROJECTION", "opid": "3", "children": [{"name": "PROJECTION", "opid": "2", "children": [{"name": "PROJECTION", "opid": "1", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_returnflag\nl_linestatus\nl_quantity\nl_extendedprice\nl_discount\nl_tax\n[INFOSEPARATOR]\nFilters: l_shipdate<='1998-09-02'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243"}],"table": "","extra": "l_returnflag\nl_linestatus\nl_quantity\nl_extendedprice\n(l_extendedprice * (1.00 - l_discount))\nl_tax\nl_discount\n"}],"table": "","extra": "__internal_compress_string_utinyint(#0)\n__internal_compress_string_utinyint(#1)\n#2\n#3\n#4\n#5\n#6\n"}],"table": "","extra": "l_returnflag\nl_linestatus\nl_quantity\nl_extendedprice\n#4\n(#4 * (1.00 + l_tax))\nl_quantity\nl_extendedprice\nl_discount\n"}],"table": "","extra": "#0\n#1\nsum_no_overflow(#2)\nsum_no_overflow(#3)\nsum_no_overflow(#4)\nsum_no_overflow(#5)\navg(#6)\navg(#7)\navg(#8)\ncount_star()"}],"table": "","extra": "__internal_decompress_string(#0)\n__internal_decompress_string(#1)\n#2\n#3\n#4\n#5\n#6\n#7\n#8\n#9\n"}],"table": "","extra": "__internal_compress_string_utinyint(#0)\n__internal_compress_string_utinyint(#1)\n#2\n#3\n#4\n#5\n#6\n#7\n#8\n#9\n"}],"table": "","extra": "ORDERS:\nlineitem.l_returnflag ASC\nlineitem.l_linestatus ASC"}],"table": "","extra": "__internal_decompress_string(#0)\n__internal_decompress_string(#1)\n#2\n#3\n#4\n#5\n#6\n#7\n#8\n#9\n"}
%%%%%%%%%%%%%%%% Running Query #  2  threads:  1
SELECT s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment FROM part, supplier, partsupp, nation, region WHERE p_partkey = ps_partkey AND s_suppkey = ps_suppkey AND p_size = 15 AND p_type LIKE '%BRASS' AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'EUROPE' AND ps_supplycost = ( SELECT min(ps_supplycost) FROM partsupp, supplier, nation, region WHERE p_partkey = ps_partkey AND s_suppkey = ps_suppkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'EUROPE' ) ORDER BY s_acctbal DESC, n_name, s_name, p_partkey LIMIT 100;
Run:  None SELECT s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment FROM part, supplier, partsupp, nation, region WHERE p_partkey = ps_partkey AND s_suppkey = ps_suppkey AND p_size = 15 AND p_type LIKE '%BRASS' AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'EUROPE' AND ps_supplycost = ( SELECT min(ps_supplycost) FROM partsupp, supplier, nation, region WHERE p_partkey = ps_partkey AND s_suppkey = ps_suppkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'EUROPE' ) ORDER BY s_acctbal DESC, n_name, s_name, p_partkey LIMIT 100;
Enable Lineage Capture

Enable Persist Lineage
┌───────────────────┐                                                                                                                                                                                                                  
│  STREAMING_LIMIT  │                                                                                                                                                                                                                  
└─────────┬─────────┘                                                                                                                                                                                                                                       
┌─────────┴─────────┐                                                                                                                                                                                                                  
│     PROJECTION    │                                                                                                                                                                                                                  
│   ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                                  
│         #0        │                                                                                                                                                                                                                  
│         #1        │                                                                                                                                                                                                                  
│__internal_decompre│                                                                                                                                                                                                                  
│   ss_string(#2)   │                                                                                                                                                                                                                  
│__internal_decompre│                                                                                                                                                                                                                  
│ss_integral_bigint(│                                                                                                                                                                                                                  
│       #3, 1)      │                                                                                                                                                                                                                  
│__internal_decompre│                                                                                                                                                                                                                  
│   ss_string(#4)   │                                                                                                                                                                                                                  
│         #5        │                                                                                                                                                                                                                  
│__internal_decompre│                                                                                                                                                                                                                  
│   ss_string(#6)   │                                                                                                                                                                                                                  
│         #7        │                                                                                                                                                                                                                  
└─────────┬─────────┘                                                                                                                                                                                                                                       
┌─────────┴─────────┐                                                                                                                                                                                                                  
│      ORDER_BY     │                                                                                                                                                                                                                  
│   ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                                  
│      ORDERS:      │                                                                                                                                                                                                                  
│ supplier.s_acctbal│                                                                                                                                                                                                                  
│        DESC       │                                                                                                                                                                                                                  
│ nation.n_name ASC │                                                                                                                                                                                                                  
│supplier.s_name ASC│                                                                                                                                                                                                                  
│ part.p_partkey ASC│                                                                                                                                                                                                                  
└─────────┬─────────┘                                                                                                                                                                                                                                       
┌─────────┴─────────┐                                                                                                                                                                                                                  
│     PROJECTION    │                                                                                                                                                                                                                  
│   ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                                  
│         #0        │                                                                                                                                                                                                                  
│         #1        │                                                                                                                                                                                                                  
│__internal_compress│                                                                                                                                                                                                                  
│_string_hugeint(#2)│                                                                                                                                                                                                                  
│__internal_compress│                                                                                                                                                                                                                  
│_integral_uinteger(│                                                                                                                                                                                                                  
│       #3, 1)      │                                                                                                                                                                                                                  
│__internal_compress│                                                                                                                                                                                                                  
│_string_hugeint(#4)│                                                                                                                                                                                                                  
│         #5        │                                                                                                                                                                                                                  
│__internal_compress│                                                                                                                                                                                                                  
│_string_hugeint(#6)│                                                                                                                                                                                                                  
│         #7        │                                                                                                                                                                                                                  
└─────────┬─────────┘                                                                                                                                                                                                                                       
┌─────────┴─────────┐                                                                                                                                                                                                                  
│     PROJECTION    │                                                                                                                                                                                                                  
│   ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                                  
│     s_acctbal     │                                                                                                                                                                                                                  
│       s_name      │                                                                                                                                                                                                                  
│       n_name      │                                                                                                                                                                                                                  
│     p_partkey     │                                                                                                                                                                                                                  
│       p_mfgr      │                                                                                                                                                                                                                  
│     s_address     │                                                                                                                                                                                                                  
│      s_phone      │                                                                                                                                                                                                                  
│     s_comment     │                                                                                                                                                                                                                  
└─────────┬─────────┘                                                                                                                                                                                                                                       
┌─────────┴─────────┐                                                                                                                                                                                                                  
│     PROJECTION    │                                                                                                                                                                                                                  
│   ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                                  
│         #0        │                                                                                                                                                                                                                  
│         #2        │                                                                                                                                                                                                                  
│         #4        │                                                                                                                                                                                                                  
│         #6        │                                                                                                                                                                                                                  
│         #8        │                                                                                                                                                                                                                  
│         #9        │                                                                                                                                                                                                                  
│        #10        │                                                                                                                                                                                                                  
│        #11        │                                                                                                                                                                                                                  
│        #12        │                                                                                                                                                                                                                  
│        #13        │                                                                                                                                                                                                                  
└─────────┬─────────┘                                                                                                                                                                                                                                       
┌─────────┴─────────┐                                                                                                                                                                                                                  
│       FILTER      │                                                                                                                                                                                                                  
│   ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                                  
│  (ps_supplycost = │                                                                                                                                                                                                                  
│      SUBQUERY)    │                                                                                                                                                                                                                  
│   ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                                  
│     EC: 400000    │                                                                                                                                                                                                                  
└─────────┬─────────┘                                                                                                                                                                                                                                       
┌─────────┴─────────┐                                                                                                                                                                                                                  
│  RIGHT_DELIM_JOIN │                                                                                                                                                                                                                  
│   ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                                  
│       RIGHT       │                                                                                                                                                                                                                  
│  p_partkey IS NOT │                                                                                                                                                                                                                  
│    DISTINCT FROM  ├──────────────────────────────────────────────────────────────────────────────────────────────┐                                                                                                                   
│      p_partkey    │                                                                                              │                                                                                                                   
│   ─ ─ ─ ─ ─ ─ ─   │                                                                                              │                                                                                                                   
│     EC: 400000    │                                                                                              │                                                                                                                   
└─────────┬─────────┘                                                                                              │                                                                                                                                        
┌─────────┴─────────┐                                                                                    ┌─────────┴─────────┐                                                                                                         
│     HASH_JOIN     │                                                                                    │     HASH_JOIN     │                                                                                                         
│   ─ ─ ─ ─ ─ ─ ─   │                                                                                    │   ─ ─ ─ ─ ─ ─ ─   │                                                                                                         
│       INNER       │                                                                                    │       RIGHT       │                                                                                                         
│    ps_suppkey =   │                                                                                    │  p_partkey IS NOT │                                                                                                         
│      s_suppkey    │                                                                                    │    DISTINCT FROM  │                                                                                                         
│   ─ ─ ─ ─ ─ ─ ─   ├───────────────────────────────┐                                                    │      p_partkey    ├──────────────────────────────────────────────────────────────────────────────────────────────┐          
│    Build Min: 1   │                               │                                                    │   ─ ─ ─ ─ ─ ─ ─   │                                                                                              │          
│  Build Max: 10000 │                               │                                                    │     EC: 400000    │                                                                                              │          
│   ─ ─ ─ ─ ─ ─ ─   │                               │                                                    │                   │                                                                                              │          
│      EC: 587      │                               │                                                    │                   │                                                                                              │          
└─────────┬─────────┘                               │                                                    └─────────┬─────────┘                                                                                              │                               
┌─────────┴─────────┐                     ┌─────────┴─────────┐                                          ┌─────────┴─────────┐                                                                                    ┌─────────┴─────────┐
│     HASH_JOIN     │                     │     HASH_JOIN     │                                          │     PROJECTION    │                                                                                    │     DUMMY_SCAN    │
│   ─ ─ ─ ─ ─ ─ ─   │                     │   ─ ─ ─ ─ ─ ─ ─   │                                          │   ─ ─ ─ ─ ─ ─ ─   │                                                                                    │                   │
│       INNER       │                     │       INNER       │                                          │ min(ps_supplycost)│                                                                                    │                   │
│    ps_partkey =   │                     │   s_nationkey =   │                                          │     p_partkey     │                                                                                    │                   │
│      p_partkey    │                     │     n_nationkey   │                                          │                   │                                                                                    │                   │
│   ─ ─ ─ ─ ─ ─ ─   ├──────────┐          │   ─ ─ ─ ─ ─ ─ ─   ├──────────┐                               │                   │                                                                                    │                   │
│    Build Min: 1   │          │          │    Build Min: 0   │          │                               │                   │                                                                                    │                   │
│ Build Max: 200000 │          │          │   Build Max: 24   │          │                               │                   │                                                                                    │                   │
│   ─ ─ ─ ─ ─ ─ ─   │          │          │   ─ ─ ─ ─ ─ ─ ─   │          │                               │                   │                                                                                    │                   │
│      EC: 3377     │          │          │      EC: 2000     │          │                               │                   │                                                                                    │                   │
└─────────┬─────────┘          │          └─────────┬─────────┘          │                               └─────────┬─────────┘                                                                                    └───────────────────┘                     
┌─────────┴─────────┐┌─────────┴─────────┐┌─────────┴─────────┐┌─────────┴─────────┐                     ┌─────────┴─────────┐                                                                                                         
│     SEQ_SCAN      ││       FILTER      ││     SEQ_SCAN      ││     HASH_JOIN     │                     │     PROJECTION    │                                                                                                         
│   ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─   │                     │   ─ ─ ─ ─ ─ ─ ─   │                                                                                                         
│      partsupp     ││  suffix(p_type,   ││      supplier     ││       INNER       │                     │__internal_decompre│                                                                                                         
│   ─ ─ ─ ─ ─ ─ ─   ││      'BRASS')     ││   ─ ─ ─ ─ ─ ─ ─   ││   n_regionkey =   │                     │ss_integral_bigint(│                                                                                                         
│     ps_partkey    ││   ─ ─ ─ ─ ─ ─ ─   ││     s_suppkey     ││     r_regionkey   │                     │       #0, 1)      │                                                                                                         
│     ps_suppkey    ││      EC: 800      ││    s_nationkey    ││   ─ ─ ─ ─ ─ ─ ─   │                     │         #1        │                                                                                                         
│   ps_supplycost   ││                   ││     s_acctbal     ││    Build Min: 0   ├──────────┐          │                   │                                                                                                         
│   ─ ─ ─ ─ ─ ─ ─   ││                   ││       s_name      ││    Build Max: 4   │          │          │                   │                                                                                                         
│     EC: 800000    ││                   ││     s_address     ││   ─ ─ ─ ─ ─ ─ ─   │          │          │                   │                                                                                                         
│                   ││                   ││      s_phone      ││       EC: 5       │          │          │                   │                                                                                                         
│                   ││                   ││     s_comment     ││                   │          │          │                   │                                                                                                         
│                   ││                   ││   ─ ─ ─ ─ ─ ─ ─   ││                   │          │          │                   │                                                                                                         
│                   ││                   ││     EC: 10000     ││                   │          │          │                   │                                                                                                         
└───────────────────┘└─────────┬─────────┘└───────────────────┘└─────────┬─────────┘          │          └─────────┬─────────┘                                                                                                                              
                     ┌─────────┴─────────┐                     ┌─────────┴─────────┐┌─────────┴─────────┐┌─────────┴─────────┐                                                                                                         
                     │     SEQ_SCAN      │                     │     SEQ_SCAN      ││     SEQ_SCAN      ││   HASH_GROUP_BY   │                                                                                                         
                     │   ─ ─ ─ ─ ─ ─ ─   │                     │   ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─   │                                                                                                         
                     │        part       │                     │       nation      ││       region      ││         #0        │                                                                                                         
                     │   ─ ─ ─ ─ ─ ─ ─   │                     │   ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─   ││      min(#1)      │                                                                                                         
                     │     p_partkey     │                     │    n_nationkey    ││    r_regionkey    ││                   │                                                                                                         
                     │       p_type      │                     │    n_regionkey    ││   ─ ─ ─ ─ ─ ─ ─   ││                   │                                                                                                         
                     │       p_mfgr      │                     │       n_name      ││  Filters: r_name= ││                   │                                                                                                         
                     │   ─ ─ ─ ─ ─ ─ ─   │                     │   ─ ─ ─ ─ ─ ─ ─   ││'EUROPE' AND r...  ││                   │                                                                                                         
                     │ Filters: p_size=15│                     │       EC: 25      ││      NOT NULL     ││                   │                                                                                                         
                     │  AND p_size IS NOT│                     │                   ││   ─ ─ ─ ─ ─ ─ ─   ││                   │                                                                                                         
                     │        NULL       │                     │                   ││       EC: 1       ││                   │                                                                                                         
                     │   ─ ─ ─ ─ ─ ─ ─   │                     │                   ││                   ││                   │                                                                                                         
                     │      EC: 800      │                     │                   ││                   ││                   │                                                                                                         
                     └───────────────────┘                     └───────────────────┘└───────────────────┘└─────────┬─────────┘                                                                                                                              
                                                                                                         ┌─────────┴─────────┐                                                                                                         
                                                                                                         │     PROJECTION    │                                                                                                         
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   │                                                                                                         
                                                                                                         │     p_partkey     │                                                                                                         
                                                                                                         │   ps_supplycost   │                                                                                                         
                                                                                                         └─────────┬─────────┘                                                                                                                              
                                                                                                         ┌─────────┴─────────┐                                                                                                         
                                                                                                         │     PROJECTION    │                                                                                                         
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   │                                                                                                         
                                                                                                         │__internal_compress│                                                                                                         
                                                                                                         │_integral_uinteger(│                                                                                                         
                                                                                                         │       #0, 1)      │                                                                                                         
                                                                                                         │__internal_compress│                                                                                                         
                                                                                                         │_integral_usmallint│                                                                                                         
                                                                                                         │      (#1, 1)      │                                                                                                         
                                                                                                         │         #2        │                                                                                                         
                                                                                                         │__internal_compress│                                                                                                         
                                                                                                         │_integral_usmallint│                                                                                                         
                                                                                                         │      (#3, 1)      │                                                                                                         
                                                                                                         │__internal_compress│                                                                                                         
                                                                                                         │_integral_utinyint(│                                                                                                         
                                                                                                         │       #4, 0)      │                                                                                                         
                                                                                                         │__internal_compress│                                                                                                         
                                                                                                         │_integral_utinyint(│                                                                                                         
                                                                                                         │       #5, 0)      │                                                                                                         
                                                                                                         │__internal_compress│                                                                                                         
                                                                                                         │_integral_utinyint(│                                                                                                         
                                                                                                         │       #6, 0)      │                                                                                                         
                                                                                                         │__internal_compress│                                                                                                         
                                                                                                         │_integral_utinyint(│                                                                                                         
                                                                                                         │       #7, 0)      │                                                                                                         
                                                                                                         │         #8        │                                                                                                         
                                                                                                         └─────────┬─────────┘                                                                                                                              
                                                                                                         ┌─────────┴─────────┐                                                                                                         
                                                                                                         │     HASH_JOIN     │                                                                                                         
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   │                                                                                                         
                                                                                                         │       INNER       │                                                                                                         
                                                                                                         │    ps_partkey =   ├─────────────────────────────────────────────────────────────────────────┐                               
                                                                                                         │      p_partkey    │                                                                         │                               
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   │                                                                         │                               
                                                                                                         │     EC: 800000    │                                                                         │                               
                                                                                                         └─────────┬─────────┘                                                                         │                                                    
                                                                                                         ┌─────────┴─────────┐                                                               ┌─────────┴─────────┐                     
                                                                                                         │     HASH_JOIN     │                                                               │     DELIM_SCAN    │                     
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   │                                                               │                   │                     
                                                                                                         │       INNER       │                                                               │                   │                     
                                                                                                         │   n_regionkey =   │                                                               │                   │                     
                                                                                                         │     r_regionkey   │                                                               │                   │                     
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   ├────────────────────────────────────────────────────┐          │                   │                     
                                                                                                         │    Build Min: 0   │                                                    │          │                   │                     
                                                                                                         │    Build Max: 4   │                                                    │          │                   │                     
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   │                                                    │          │                   │                     
                                                                                                         │     EC: 800000    │                                                    │          │                   │                     
                                                                                                         └─────────┬─────────┘                                                    │          └───────────────────┘                                          
                                                                                                         ┌─────────┴─────────┐                                          ┌─────────┴─────────┐                                          
                                                                                                         │     HASH_JOIN     │                                          │     SEQ_SCAN      │                                          
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   │                                          │   ─ ─ ─ ─ ─ ─ ─   │                                          
                                                                                                         │       INNER       │                                          │       region      │                                          
                                                                                                         │   s_nationkey =   │                                          │   ─ ─ ─ ─ ─ ─ ─   │                                          
                                                                                                         │     n_nationkey   │                                          │    r_regionkey    │                                          
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   ├───────────────────────────────┐          │   ─ ─ ─ ─ ─ ─ ─   │                                          
                                                                                                         │    Build Min: 0   │                               │          │  Filters: r_name= │                                          
                                                                                                         │   Build Max: 24   │                               │          │'EUROPE' AND r...  │                                          
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   │                               │          │      NOT NULL     │                                          
                                                                                                         │     EC: 800000    │                               │          │   ─ ─ ─ ─ ─ ─ ─   │                                          
                                                                                                         │                   │                               │          │       EC: 1       │                                          
                                                                                                         └─────────┬─────────┘                               │          └───────────────────┘                                                               
                                                                                                         ┌─────────┴─────────┐                     ┌─────────┴─────────┐                                                               
                                                                                                         │     HASH_JOIN     │                     │     SEQ_SCAN      │                                                               
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   │                     │   ─ ─ ─ ─ ─ ─ ─   │                                                               
                                                                                                         │       INNER       │                     │       nation      │                                                               
                                                                                                         │    ps_suppkey =   │                     │   ─ ─ ─ ─ ─ ─ ─   │                                                               
                                                                                                         │      s_suppkey    │                     │    n_nationkey    │                                                               
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   ├──────────┐          │    n_regionkey    │                                                               
                                                                                                         │    Build Min: 1   │          │          │   ─ ─ ─ ─ ─ ─ ─   │                                                               
                                                                                                         │  Build Max: 10000 │          │          │       EC: 25      │                                                               
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   │          │          │                   │                                                               
                                                                                                         │     EC: 800000    │          │          │                   │                                                               
                                                                                                         └─────────┬─────────┘          │          └───────────────────┘                                                                                    
                                                                                                         ┌─────────┴─────────┐┌─────────┴─────────┐                                                                                    
                                                                                                         │     SEQ_SCAN      ││     SEQ_SCAN      │                                                                                    
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─   │                                                                                    
                                                                                                         │      partsupp     ││      supplier     │                                                                                    
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─   │                                                                                    
                                                                                                         │     ps_partkey    ││     s_suppkey     │                                                                                    
                                                                                                         │     ps_suppkey    ││    s_nationkey    │                                                                                    
                                                                                                         │   ps_supplycost   ││   ─ ─ ─ ─ ─ ─ ─   │                                                                                    
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   ││     EC: 10000     │                                                                                    
                                                                                                         │     EC: 800000    ││                   │                                                                                    
                                                                                                         └───────────────────┘└───────────────────┘                                                                                                         

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

Avg Time in sec:  0.05065795499831438  output size:  100
    s_acctbal  ...                                          s_comment
0     9938.53  ...                      l, ironic instructions cajole
1     9937.84  ...  es. furiously silent deposits among the deposi...
2     9936.22  ...  ar, regular requests nag blithely special acco...
3     9923.77  ...  s sleep according to the quick requests. caref...
4     9871.22  ...  against the slyly daring requests. unusual acc...
..        ...  ...                                                ...
95    7887.08  ...   the regular ideas. furiously bold deposits bo...
96    7871.50  ...  ording to the furious theodolites cajole caref...
97    7852.45  ...  egular, regular ideas. requests are carefully....
98    7850.66  ...                   ccounts. special, final deposits
99    7843.52  ...  sits. blithely regular requests above the pend...

[100 rows x 8 columns]
{'name': 'Query', 'result': 0.046197, 'timing': 0.046197, 'cardinality': 0, 'extra-info': "SELECT s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment FROM part, supplier, partsupp, nation, region WHERE p_partkey = ps_partkey AND s_suppkey = ps_suppkey AND p_size = 15 AND p_type LIKE '%BRASS' AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'EUROPE' AND ps_supplycost = ( SELECT min(ps_supplycost) FROM partsupp, supplier, nation, region WHERE p_partkey = ps_partkey AND s_suppkey = ps_suppkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'EUROPE' ) ORDER BY s_acctbal DESC, n_name, s_name, p_partkey LIMIT 100;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 4.3e-05, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'STREAMING_LIMIT', 'timing': 2e-06, 'cardinality': 100, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 3.5e-05, 'cardinality': 460, 'extra_info': '#0\n#1\n__internal_decompress_string(#2)\n__internal_decompress_integral_bigint(#3, 1)\n__internal_decompress_string(#4)\n#5\n__internal_decompress_string(#6)\n#7\n', 'children': [{'name': 'ORDER_BY', 'timing': 0.000255, 'cardinality': 460, 'extra_info': 'ORDERS:\nsupplier.s_acctbal DESC\nnation.n_name ASC\nsupplier.s_name ASC\npart.p_partkey ASC', 'children': [{'name': 'PROJECTION', 'timing': 4.4e-05, 'cardinality': 460, 'extra_info': '#0\n#1\n__internal_compress_string_hugeint(#2)\n__internal_compress_integral_uinteger(#3, 1)\n__internal_compress_string_hugeint(#4)\n#5\n__internal_compress_string_hugeint(#6)\n#7\n', 'children': [{'name': 'PROJECTION', 'timing': 2e-06, 'cardinality': 460, 'extra_info': 's_acctbal\ns_name\nn_name\np_partkey\np_mfgr\ns_address\ns_phone\ns_comment\n', 'children': [{'name': 'PROJECTION', 'timing': 3e-06, 'cardinality': 460, 'extra_info': '#0\n#2\n#4\n#6\n#8\n#9\n#10\n#11\n#12\n#13\n', 'children': [{'name': 'FILTER', 'timing': 8.5e-05, 'cardinality': 460, 'extra_info': '(ps_supplycost = SUBQUERY)\n[INFOSEPARATOR]\nEC: 400000', 'children': [{'name': 'RIGHT_DELIM_JOIN', 'timing': 0.001119, 'cardinality': 0, 'extra_info': 'RIGHT\np_partkey IS NOT DISTINCT FROM p_partkey\n\n[INFOSEPARATOR]\nEC: 400000\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.000724, 'cardinality': 642, 'extra_info': 'INNER\nps_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 587\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.00286, 'cardinality': 2988, 'extra_info': 'INNER\nps_partkey = p_partkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 3377\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.000957, 'cardinality': 800000, 'extra_info': 'partsupp\n[INFOSEPARATOR]\nps_partkey\nps_suppkey\nps_supplycost\n[INFOSEPARATOR]\nEC: 800000', 'children': []}, {'name': 'FILTER', 'timing': 0.000408, 'cardinality': 747, 'extra_info': "suffix(p_type, 'BRASS')\n[INFOSEPARATOR]\nEC: 800", 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.006867, 'cardinality': 3907, 'extra_info': 'part\n[INFOSEPARATOR]\np_partkey\np_type\np_mfgr\n[INFOSEPARATOR]\nFilters: p_size=15 AND p_size IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 800', 'children': []}]}]}, {'name': 'HASH_JOIN', 'timing': 0.000118, 'cardinality': 1987, 'extra_info': 'INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 2000\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.000761, 'cardinality': 10000, 'extra_info': 'supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\ns_acctbal\ns_name\ns_address\ns_phone\ns_comment\n[INFOSEPARATOR]\nEC: 10000', 'children': []}, {'name': 'HASH_JOIN', 'timing': 6.8e-05, 'cardinality': 5, 'extra_info': 'INNER\nn_regionkey = r_regionkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 4\n\n[INFOSEPARATOR]\nEC: 5\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 1.7e-05, 'cardinality': 25, 'extra_info': 'nation\n[INFOSEPARATOR]\nn_nationkey\nn_regionkey\nn_name\n[INFOSEPARATOR]\nEC: 25', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 2.5e-05, 'cardinality': 1, 'extra_info': "region\n[INFOSEPARATOR]\nr_regionkey\n[INFOSEPARATOR]\nFilters: r_name='EUROPE' AND r_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1", 'children': []}]}]}]}, {'name': 'HASH_JOIN', 'timing': 0.000199, 'cardinality': 642, 'extra_info': 'RIGHT\np_partkey IS NOT DISTINCT FROM p_partkey\n\n[INFOSEPARATOR]\nEC: 400000\n', 'children': [{'name': 'PROJECTION', 'timing': 0.0, 'cardinality': 460, 'extra_info': 'min(ps_supplycost)\np_partkey\n', 'children': [{'name': 'PROJECTION', 'timing': 5e-06, 'cardinality': 460, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n#1\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.000755, 'cardinality': 460, 'extra_info': '#0\nmin(#1)', 'children': [{'name': 'PROJECTION', 'timing': 1e-06, 'cardinality': 642, 'extra_info': 'p_partkey\nps_supplycost\n', 'children': [{'name': 'PROJECTION', 'timing': 2.5e-05, 'cardinality': 642, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n__internal_compress_integral_usmallint(#1, 1)\n#2\n__internal_compress_integral_usmallint(#3, 1)\n__internal_compress_integral_utinyint(#4, 0)\n__internal_compress_integral_utinyint(#5, 0)\n__internal_compress_integral_utinyint(#6, 0)\n__internal_compress_integral_utinyint(#7, 0)\n#8\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.008898, 'cardinality': 642, 'extra_info': 'INNER\nps_partkey = p_partkey\n\n[INFOSEPARATOR]\nEC: 800000\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.004217, 'cardinality': 158960, 'extra_info': 'INNER\nn_regionkey = r_regionkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 4\n\n[INFOSEPARATOR]\nEC: 800000\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.002518, 'cardinality': 800000, 'extra_info': 'INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 800000\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.003212, 'cardinality': 800000, 'extra_info': 'INNER\nps_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 800000\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.000979, 'cardinality': 800000, 'extra_info': 'partsupp\n[INFOSEPARATOR]\nps_partkey\nps_suppkey\nps_supplycost\n[INFOSEPARATOR]\nEC: 800000', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 3.1e-05, 'cardinality': 10000, 'extra_info': 'supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\n[INFOSEPARATOR]\nEC: 10000', 'children': []}]}, {'name': 'SEQ_SCAN ', 'timing': 5e-06, 'cardinality': 25, 'extra_info': 'nation\n[INFOSEPARATOR]\nn_nationkey\nn_regionkey\n[INFOSEPARATOR]\nEC: 25', 'children': []}]}, {'name': 'SEQ_SCAN ', 'timing': 1.1e-05, 'cardinality': 1, 'extra_info': "region\n[INFOSEPARATOR]\nr_regionkey\n[INFOSEPARATOR]\nFilters: r_name='EUROPE' AND r_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1", 'children': []}]}, {'name': 'DELIM_SCAN', 'timing': 0.0, 'cardinality': 0, 'extra_info': '', 'children': []}]}]}]}]}]}]}, {'name': 'DUMMY_SCAN', 'timing': 0.0, 'cardinality': 0, 'extra_info': '', 'children': []}]}, {'name': 'HASH_GROUP_BY', 'timing': 1.2e-05, 'cardinality': 460, 'extra_info': '#0', 'children': []}]}]}]}]}]}]}]}]}]}]}
X {'RESULT_COLLECTOR0': 4.3e-05, 'STREAMING_LIMIT1': 2e-06, 'PROJECTION2': 3.5e-05, 'ORDER_BY3': 0.000255, 'PROJECTION4': 4.4e-05, 'PROJECTION5': 2e-06, 'PROJECTION6': 3e-06, 'FILTER7': 8.5e-05, 'RIGHT_DELIM_JOIN8': 0.001119, 'HASH_JOIN9': 0.000724, 'HASH_JOIN10': 0.00286, 'SEQ_SCAN 11': 0.000957, 'FILTER12': 0.000408, 'SEQ_SCAN 13': 0.006867, 'HASH_JOIN14': 0.000118, 'SEQ_SCAN 15': 0.000761, 'HASH_JOIN16': 6.8e-05, 'SEQ_SCAN 17': 1.7e-05, 'SEQ_SCAN 18': 2.5e-05, 'HASH_JOIN19': 0.000199, 'PROJECTION20': 0.0, 'PROJECTION21': 5e-06, 'HASH_GROUP_BY22': 0.000755, 'PROJECTION23': 1e-06, 'PROJECTION24': 2.5e-05, 'HASH_JOIN25': 0.008898, 'HASH_JOIN26': 0.004217, 'HASH_JOIN27': 0.002518, 'HASH_JOIN28': 0.003212, 'SEQ_SCAN 29': 0.000979, 'SEQ_SCAN 30': 3.1e-05, 'SEQ_SCAN 31': 5e-06, 'SEQ_SCAN 32': 1.1e-05, 'DELIM_SCAN33': 0.0, 'DUMMY_SCAN34': 0.0, 'HASH_GROUP_BY35': 1.2e-05}
uncompressed filter_log_size: 10084
uncompressed filter_log_buffer_size: 4828
uncompressed limit_offset_size: 2112
uncompressed limit_offset_buffer_size: 0
uncompressed perfect_full_scan_ht_log_size: 207184
uncompressed perfect_full_scan_ht_log_buffer_size: 204648
uncompressed perfect_probe_ht_log_size: 7794872
uncompressed perfect_probe_ht_log_buffer_size: 7726896
uncompressed row_group_log_size: 55228
uncompressed row_group_log_buffer_size: 15636
uncompressed scatter_log_size: 12408
uncompressed scatter_log_buffer_size: 10272
uncompressed scatter_sel_log_size: 169264
uncompressed scatter_sel_log_buffer_size: 166408
uncompressed gather_log_size: 2088
uncompressed gather_log_buffer_size: 0
uncompressed combine_log_size: 2088
uncompressed combine_log_buffer_size: 0
uncompressed finalize_states_log_size: 9480
uncompressed finalize_states_log_buffer_size: 7360
uncompressed join_gather_log_size: 34136
uncompressed join_gather_log_buffer_size: 15408
uncompressed reorder_log_size: 5792
uncompressed reorder_log_buffer_size: 0
uncompressed cross_log_size: 2088
uncompressed cross_log_buffer_size: 0
uncompressed nlj_log_size: 2088
uncompressed nlj_log_buffer_size: 0
uncompressed total_size: 8308912
uncompressed total_buffer_size: 8151456
uncompressed total_element_size: 157456

Clear Lineage

**** output size:  100
LINEAGE_4_FILTER_19
LINEAGE_4_FILTER_28
LINEAGE_4_HASH_GROUP_BY_11
LINEAGE_4_HASH_GROUP_BY_16
LINEAGE_4_HASH_JOIN_15
LINEAGE_4_HASH_JOIN_2
LINEAGE_4_HASH_JOIN_20
LINEAGE_4_HASH_JOIN_24
LINEAGE_4_HASH_JOIN_25
LINEAGE_4_HASH_JOIN_26
LINEAGE_4_HASH_JOIN_4
LINEAGE_4_HASH_JOIN_6
LINEAGE_4_HASH_JOIN_8
LINEAGE_4_ORDER_BY_32
LINEAGE_4_SEQ_SCAN_0
LINEAGE_4_SEQ_SCAN_1
LINEAGE_4_SEQ_SCAN_17
LINEAGE_4_SEQ_SCAN_18
LINEAGE_4_SEQ_SCAN_21
LINEAGE_4_SEQ_SCAN_22
LINEAGE_4_SEQ_SCAN_23
LINEAGE_4_SEQ_SCAN_3
LINEAGE_4_SEQ_SCAN_5
LINEAGE_4_STREAMING_LIMIT_34
SELECT s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment FROM part, supplier, partsupp, nation, region WHERE p_partkey = ps_partkey AND s_suppkey = ps_suppkey AND p_size = 15 AND p_type LIKE '%BRASS' AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'EUROPE' AND ps_supplycost = ( SELECT min(ps_supplycost) FROM partsupp, supplier, nation, region WHERE p_partkey = ps_partkey AND s_suppkey = ps_suppkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'EUROPE' ) ORDER BY s_acctbal DESC, n_name, s_name, p_partkey LIMIT 100;
   query_id  ...                                               plan
0         4  ...  {"name": "STREAMING_LIMIT", "opid": "34", "chi...

[1 rows x 7 columns]
Query info:  query_id                                                            4
query               SELECT s_acctbal, s_name, n_name, p_partkey, p...
size_bytes_max                                                8308912
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "STREAMING_LIMIT", "opid": "34", "chi...
Name: 0, dtype: object
{"name": "STREAMING_LIMIT", "opid": "34", "children": [{"name": "PROJECTION", "opid": "33", "children": [{"name": "ORDER_BY", "opid": "32", "children": [{"name": "PROJECTION", "opid": "31", "children": [{"name": "PROJECTION", "opid": "30", "children": [{"name": "PROJECTION", "opid": "29", "children": [{"name": "FILTER", "opid": "28", "children": [{"name": "RIGHT_DELIM_JOIN", "opid": "27", "children": [{"name": "HASH_GROUP_BY", "opid": "16", "children": [],"table": "","extra": "#0"},{"name": "HASH_JOIN", "opid": "15", "children": [{"name": "PROJECTION", "opid": "13", "children": [{"name": "PROJECTION", "opid": "12", "children": [{"name": "HASH_GROUP_BY", "opid": "11", "children": [{"name": "PROJECTION", "opid": "10", "children": [{"name": "PROJECTION", "opid": "9", "children": [{"name": "HASH_JOIN", "opid": "8", "children": [{"name": "HASH_JOIN", "opid": "6", "children": [{"name": "HASH_JOIN", "opid": "4", "children": [{"name": "HASH_JOIN", "opid": "2", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "partsupp","extra": "partsupp\n[INFOSEPARATOR]\nps_partkey\nps_suppkey\nps_supplycost\n[INFOSEPARATOR]\nEC: 800000"},{"name": "SEQ_SCAN ", "opid": "1", "children": [],"table": "supplier","extra": "supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\n[INFOSEPARATOR]\nEC: 10000"}],"table": "","extra": "INNER\nps_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 800000\n"},{"name": "SEQ_SCAN ", "opid": "3", "children": [],"table": "nation","extra": "nation\n[INFOSEPARATOR]\nn_nationkey\nn_regionkey\n[INFOSEPARATOR]\nEC: 25"}],"table": "","extra": "INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 800000\n"},{"name": "SEQ_SCAN ", "opid": "5", "children": [],"table": "region","extra": "region\n[INFOSEPARATOR]\nr_regionkey\n[INFOSEPARATOR]\nFilters: r_name='EUROPE' AND r_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1"}],"table": "","extra": "INNER\nn_regionkey = r_regionkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 4\n\n[INFOSEPARATOR]\nEC: 800000\n"},{"name": "DELIM_SCAN", "opid": "7", "children": [],"table": "","extra": ""}],"table": "","extra": "INNER\nps_partkey = p_partkey\n\n[INFOSEPARATOR]\nEC: 800000\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n__internal_compress_integral_usmallint(#1, 1)\n#2\n__internal_compress_integral_usmallint(#3, 1)\n__internal_compress_integral_utinyint(#4, 0)\n__internal_compress_integral_utinyint(#5, 0)\n__internal_compress_integral_utinyint(#6, 0)\n__internal_compress_integral_utinyint(#7, 0)\n#8\n"}],"table": "","extra": "p_partkey\nps_supplycost\n"}],"table": "","extra": "#0\nmin(#1)"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n#1\n"}],"table": "","extra": "min(ps_supplycost)\np_partkey\n"},{"name": "DUMMY_SCAN", "opid": "14", "children": [],"table": "","extra": ""}],"table": "","extra": "RIGHT\np_partkey IS NOT DISTINCT FROM p_partkey\n\n[INFOSEPARATOR]\nEC: 400000\n"},{"name": "HASH_JOIN", "opid": "26", "children": [{"name": "HASH_JOIN", "opid": "20", "children": [{"name": "SEQ_SCAN ", "opid": "17", "children": [],"table": "partsupp","extra": "partsupp\n[INFOSEPARATOR]\nps_partkey\nps_suppkey\nps_supplycost\n[INFOSEPARATOR]\nEC: 800000"},{"name": "FILTER", "opid": "19", "children": [{"name": "SEQ_SCAN ", "opid": "18", "children": [],"table": "part","extra": "part\n[INFOSEPARATOR]\np_partkey\np_type\np_mfgr\n[INFOSEPARATOR]\nFilters: p_size=15 AND p_size IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 800"}],"table": "","extra": "suffix(p_type, 'BRASS')\n[INFOSEPARATOR]\nEC: 800"}],"table": "","extra": "INNER\nps_partkey = p_partkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 3377\n"},{"name": "HASH_JOIN", "opid": "25", "children": [{"name": "SEQ_SCAN ", "opid": "21", "children": [],"table": "supplier","extra": "supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\ns_acctbal\ns_name\ns_address\ns_phone\ns_comment\n[INFOSEPARATOR]\nEC: 10000"},{"name": "HASH_JOIN", "opid": "24", "children": [{"name": "SEQ_SCAN ", "opid": "22", "children": [],"table": "nation","extra": "nation\n[INFOSEPARATOR]\nn_nationkey\nn_regionkey\nn_name\n[INFOSEPARATOR]\nEC: 25"},{"name": "SEQ_SCAN ", "opid": "23", "children": [],"table": "region","extra": "region\n[INFOSEPARATOR]\nr_regionkey\n[INFOSEPARATOR]\nFilters: r_name='EUROPE' AND r_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1"}],"table": "","extra": "INNER\nn_regionkey = r_regionkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 4\n\n[INFOSEPARATOR]\nEC: 5\n"}],"table": "","extra": "INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 2000\n"}],"table": "","extra": "INNER\nps_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 587\n"}],"table": "","extra": "RIGHT\np_partkey IS NOT DISTINCT FROM p_partkey\n\n[INFOSEPARATOR]\nEC: 400000\n"}],"table": "","extra": "(ps_supplycost = SUBQUERY)\n[INFOSEPARATOR]\nEC: 400000"}],"table": "","extra": "#0\n#2\n#4\n#6\n#8\n#9\n#10\n#11\n#12\n#13\n"}],"table": "","extra": "s_acctbal\ns_name\nn_name\np_partkey\np_mfgr\ns_address\ns_phone\ns_comment\n"}],"table": "","extra": "#0\n#1\n__internal_compress_string_hugeint(#2)\n__internal_compress_integral_uinteger(#3, 1)\n__internal_compress_string_hugeint(#4)\n#5\n__internal_compress_string_hugeint(#6)\n#7\n"}],"table": "","extra": "ORDERS:\nsupplier.s_acctbal DESC\nnation.n_name ASC\nsupplier.s_name ASC\npart.p_partkey ASC"}],"table": "","extra": "#0\n#1\n__internal_decompress_string(#2)\n__internal_decompress_integral_bigint(#3, 1)\n__internal_decompress_string(#4)\n#5\n__internal_decompress_string(#6)\n#7\n"}],"table": "","extra": ""}
%%%%%%%%%%%%%%%% Running Query #  3  threads:  1
SELECT l_orderkey, sum(l_extendedprice * (1 - l_discount)) AS revenue, o_orderdate, o_shippriority FROM customer, orders, lineitem WHERE c_mktsegment = 'BUILDING' AND c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate < CAST('1995-03-15' AS date) AND l_shipdate > CAST('1995-03-15' AS date) GROUP BY l_orderkey, o_orderdate, o_shippriority ORDER BY revenue DESC, o_orderdate LIMIT 10;
Run:  None SELECT l_orderkey, sum(l_extendedprice * (1 - l_discount)) AS revenue, o_orderdate, o_shippriority FROM customer, orders, lineitem WHERE c_mktsegment = 'BUILDING' AND c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate < CAST('1995-03-15' AS date) AND l_shipdate > CAST('1995-03-15' AS date) GROUP BY l_orderkey, o_orderdate, o_shippriority ORDER BY revenue DESC, o_orderdate LIMIT 10;
Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐                                                          
│      STREAMING_LIMIT      │                                                          
└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          
│         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│__internal_decompress_integ│                                                          
│     ral_bigint(#0, 1)     │                                                          
│             #1            │                                                          
│             #2            │                                                          
│__internal_decompress_integ│                                                          
│     ral_integer(#3, 0)    │                                                          
└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          
│          ORDER_BY         │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│          ORDERS:          │                                                          
│       sum((lineitem       │                                                          
│.l_extendedprice * (1 ...  │                                                          
│    .l_discount))) DESC    │                                                          
│   orders.o_orderdate ASC  │                                                          
└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          
│         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│__internal_compress_integra│                                                          
│     l_uinteger(#0, 1)     │                                                          
│             #1            │                                                          
│             #2            │                                                          
│__internal_compress_integra│                                                          
│     l_utinyint(#3, 0)     │                                                          
└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          
│         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│         l_orderkey        │                                                          
│          revenue          │                                                          
│        o_orderdate        │                                                          
│       o_shippriority      │                                                          
└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          
│         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│__internal_decompress_integ│                                                          
│     ral_bigint(#0, 1)     │                                                          
│             #1            │                                                          
│__internal_decompress_integ│                                                          
│     ral_integer(#2, 0)    │                                                          
│             #3            │                                                          
└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          
│       HASH_GROUP_BY       │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│             #0            │                                                          
│             #1            │                                                          
│             #2            │                                                          
│          sum(#3)          │                                                          
└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          
│         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│         l_orderkey        │                                                          
│        o_orderdate        │                                                          
│       o_shippriority      │                                                          
│ (l_extendedprice * (1.00 -│                                                          
│        l_discount))       │                                                          
└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          
│         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│__internal_compress_integra│                                                          
│     l_uinteger(#0, 1)     │                                                          
│             #1            │                                                          
│             #2            │                                                          
│__internal_compress_integra│                                                          
│     l_uinteger(#3, 1)     │                                                          
│             #4            │                                                          
│__internal_compress_integra│                                                          
│     l_utinyint(#5, 0)     │                                                          
└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          
│         HASH_JOIN         │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│           INNER           │                                                          
│  l_orderkey = o_orderkey  ├──────────────┐                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                           
│         EC: 28949         │              │                                           
└─────────────┬─────────────┘              │                                                                        
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             
│         SEQ_SCAN          ││         HASH_JOIN         │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│          lineitem         ││           INNER           │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   o_custkey = c_custkey   │                             
│         l_orderkey        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│      l_extendedprice      ││        Build Min: 1       │                             
│         l_discount        ││     Build Max: 149999     ├──────────────┐              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              
│ Filters: l_shipdate>'1995 ││         EC: 36179         │              │              
│-03-15'::DATE AND l_sh...  ││                           │              │              
│         IS NOT NULL       ││                           │              │              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │              │              
│        EC: 1200243        ││                           │              │              
└───────────────────────────┘└─────────────┬─────────────┘              │                                           
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
                             │         SEQ_SCAN          ││           FILTER          │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                             │           orders          ││   (c_custkey <= 149999)   │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                             │         o_custkey         ││         EC: 30000         │
                             │         o_orderkey        ││                           │
                             │        o_orderdate        ││                           │
                             │       o_shippriority      ││                           │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │
                             │ Filters: o_orderdate<'1995││                           │
                             │     -03-15'::DATE AND     ││                           │
                             │   o_orderdate IS NOT NULL ││                           │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │
                             │         EC: 300000        ││                           │
                             └───────────────────────────┘└─────────────┬─────────────┘                             
                                                          ┌─────────────┴─────────────┐
                                                          │         SEQ_SCAN          │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │          customer         │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │         c_custkey         │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │   Filters: c_mktsegment=  │
                                                          │'BUILDING' AND c_mktse...  │
                                                          │          NOT NULL         │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │         EC: 30000         │
                                                          └───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

uncompressed filter_log_size: 4152
uncompressed filter_log_buffer_size: 0
uncompressed limit_offset_size: 1104
uncompressed limit_offset_buffer_size: 0
uncompressed perfect_full_scan_ht_log_size: 483472
uncompressed perfect_full_scan_ht_log_buffer_size: 482328
uncompressed perfect_probe_ht_log_size: 1210856
uncompressed perfect_probe_ht_log_buffer_size: 1177008
uncompressed row_group_log_size: 16165908
uncompressed row_group_log_buffer_size: 15996892
uncompressed scatter_log_size: 245488
uncompressed scatter_log_buffer_size: 244152
uncompressed scatter_sel_log_size: 2165160
uncompressed scatter_sel_log_buffer_size: 2127216
uncompressed gather_log_size: 1080
uncompressed gather_log_buffer_size: 0
uncompressed combine_log_size: 1080
uncompressed combine_log_buffer_size: 0
uncompressed finalize_states_log_size: 94168
uncompressed finalize_states_log_buffer_size: 92960
uncompressed join_gather_log_size: 629452
uncompressed join_gather_log_buffer_size: 366228
uncompressed reorder_log_size: 94064
uncompressed reorder_log_buffer_size: 0
uncompressed cross_log_size: 1080
uncompressed cross_log_buffer_size: 0
uncompressed nlj_log_size: 1080
uncompressed nlj_log_buffer_size: 0
uncompressed total_size: 21098144
uncompressed total_buffer_size: 20486784
uncompressed total_element_size: 611360

Avg Time in sec:  0.17800860898569226  output size:  10
   l_orderkey      revenue o_orderdate  o_shippriority
0     2456423  406181.0111  1995-03-05               0
1     3459808  405838.6989  1995-03-04               0
2      492164  390324.0610  1995-02-19               0
3     1188320  384537.9359  1995-03-09               0
4     2435712  378673.0558  1995-02-26               0
5     4878020  378376.7952  1995-03-12               0
6     5521732  375153.9215  1995-03-13               0
7     2628192  373133.3094  1995-02-22               0
8      993600  371407.4595  1995-03-05               0
9     2300070  367371.1452  1995-03-13               0
{'name': 'Query', 'result': 0.174698, 'timing': 0.174698, 'cardinality': 0, 'extra-info': "SELECT l_orderkey, sum(l_extendedprice * (1 - l_discount)) AS revenue, o_orderdate, o_shippriority FROM customer, orders, lineitem WHERE c_mktsegment = 'BUILDING' AND c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate < CAST('1995-03-15' AS date) AND l_shipdate > CAST('1995-03-15' AS date) GROUP BY l_orderkey, o_orderdate, o_shippriority ORDER BY revenue DESC, o_orderdate LIMIT 10;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 6e-06, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'STREAMING_LIMIT', 'timing': 3e-06, 'cardinality': 10, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 1.5e-05, 'cardinality': 4096, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n#1\n#2\n__internal_decompress_integral_integer(#3, 0)\n', 'children': [{'name': 'ORDER_BY', 'timing': 0.000422, 'cardinality': 4096, 'extra_info': 'ORDERS:\nsum((lineitem.l_extendedprice * (1 - lineitem.l_discount))) DESC\norders.o_orderdate ASC', 'children': [{'name': 'PROJECTION', 'timing': 1.3e-05, 'cardinality': 11620, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n#1\n#2\n__internal_compress_integral_utinyint(#3, 0)\n', 'children': [{'name': 'PROJECTION', 'timing': 3e-06, 'cardinality': 11620, 'extra_info': 'l_orderkey\nrevenue\no_orderdate\no_shippriority\n', 'children': [{'name': 'PROJECTION', 'timing': 2.8e-05, 'cardinality': 11620, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n#1\n__internal_decompress_integral_integer(#2, 0)\n#3\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.002943, 'cardinality': 11620, 'extra_info': '#0\n#1\n#2\nsum(#3)', 'children': [{'name': 'PROJECTION', 'timing': 0.000175, 'cardinality': 30519, 'extra_info': 'l_orderkey\no_orderdate\no_shippriority\n(l_extendedprice * (1.00 - l_discount))\n', 'children': [{'name': 'PROJECTION', 'timing': 0.000248, 'cardinality': 30519, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n#1\n#2\n__internal_compress_integral_uinteger(#3, 1)\n#4\n__internal_compress_integral_utinyint(#5, 0)\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.10184, 'cardinality': 30519, 'extra_info': 'INNER\nl_orderkey = o_orderkey\n\n[INFOSEPARATOR]\nEC: 28949\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.029195, 'cardinality': 3241776, 'extra_info': "lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nFilters: l_shipdate>'1995-03-15'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243", 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.009571, 'cardinality': 147126, 'extra_info': 'INNER\no_custkey = c_custkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 149999\n\n[INFOSEPARATOR]\nEC: 36179\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.01308, 'cardinality': 727305, 'extra_info': "orders\n[INFOSEPARATOR]\no_custkey\no_orderkey\no_orderdate\no_shippriority\n[INFOSEPARATOR]\nFilters: o_orderdate<'1995-03-15'::DATE AND o_orderdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 300000", 'children': []}, {'name': 'FILTER', 'timing': 0.000254, 'cardinality': 30142, 'extra_info': '(c_custkey <= 149999)\n[INFOSEPARATOR]\nEC: 30000', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.003382, 'cardinality': 30142, 'extra_info': "customer\n[INFOSEPARATOR]\nc_custkey\n[INFOSEPARATOR]\nFilters: c_mktsegment='BUILDING' AND c_mktsegment IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 30000", 'children': []}]}]}]}]}]}]}]}]}]}]}]}]}]}]}
X {'RESULT_COLLECTOR0': 6e-06, 'STREAMING_LIMIT1': 3e-06, 'PROJECTION2': 1.5e-05, 'ORDER_BY3': 0.000422, 'PROJECTION4': 1.3e-05, 'PROJECTION5': 3e-06, 'PROJECTION6': 2.8e-05, 'HASH_GROUP_BY7': 0.002943, 'PROJECTION8': 0.000175, 'PROJECTION9': 0.000248, 'HASH_JOIN10': 0.10184, 'SEQ_SCAN 11': 0.029195, 'HASH_JOIN12': 0.009571, 'SEQ_SCAN 13': 0.01308, 'FILTER14': 0.000254, 'SEQ_SCAN 15': 0.003382}
**** output size:  10
LINEAGE_4_FILTER_3
LINEAGE_4_HASH_GROUP_BY_8
LINEAGE_4_HASH_JOIN_4
LINEAGE_4_HASH_JOIN_5
LINEAGE_4_ORDER_BY_12
LINEAGE_4_SEQ_SCAN_0
LINEAGE_4_SEQ_SCAN_1
LINEAGE_4_SEQ_SCAN_2
LINEAGE_4_STREAMING_LIMIT_14
SELECT l_orderkey, sum(l_extendedprice * (1 - l_discount)) AS revenue, o_orderdate, o_shippriority FROM customer, orders, lineitem WHERE c_mktsegment = 'BUILDING' AND c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate < CAST('1995-03-15' AS date) AND l_shipdate > CAST('1995-03-15' AS date) GROUP BY l_orderkey, o_orderdate, o_shippriority ORDER BY revenue DESC, o_orderdate LIMIT 10;
   query_id  ...                                               plan
0         4  ...  {"name": "STREAMING_LIMIT", "opid": "14", "chi...

[1 rows x 7 columns]
Query info:  query_id                                                            4
query               SELECT l_orderkey, sum(l_extendedprice * (1 - ...
size_bytes_max                                               21098144
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "STREAMING_LIMIT", "opid": "14", "chi...
Name: 0, dtype: object
{"name": "STREAMING_LIMIT", "opid": "14", "children": [{"name": "PROJECTION", "opid": "13", "children": [{"name": "ORDER_BY", "opid": "12", "children": [{"name": "PROJECTION", "opid": "11", "children": [{"name": "PROJECTION", "opid": "10", "children": [{"name": "PROJECTION", "opid": "9", "children": [{"name": "HASH_GROUP_BY", "opid": "8", "children": [{"name": "PROJECTION", "opid": "7", "children": [{"name": "PROJECTION", "opid": "6", "children": [{"name": "HASH_JOIN", "opid": "5", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nFilters: l_shipdate>'1995-03-15'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243"},{"name": "HASH_JOIN", "opid": "4", "children": [{"name": "SEQ_SCAN ", "opid": "1", "children": [],"table": "orders","extra": "orders\n[INFOSEPARATOR]\no_custkey\no_orderkey\no_orderdate\no_shippriority\n[INFOSEPARATOR]\nFilters: o_orderdate<'1995-03-15'::DATE AND o_orderdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 300000"},{"name": "FILTER", "opid": "3", "children": [{"name": "SEQ_SCAN ", "opid": "2", "children": [],"table": "customer","extra": "customer\n[INFOSEPARATOR]\nc_custkey\n[INFOSEPARATOR]\nFilters: c_mktsegment='BUILDING' AND c_mktsegment IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 30000"}],"table": "","extra": "(c_custkey <= 149999)\n[INFOSEPARATOR]\nEC: 30000"}],"table": "","extra": "INNER\no_custkey = c_custkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 149999\n\n[INFOSEPARATOR]\nEC: 36179\n"}],"table": "","extra": "INNER\nl_orderkey = o_orderkey\n\n[INFOSEPARATOR]\nEC: 28949\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n#1\n#2\n__internal_compress_integral_uinteger(#3, 1)\n#4\n__internal_compress_integral_utinyint(#5, 0)\n"}],"table": "","extra": "l_orderkey\no_orderdate\no_shippriority\n(l_extendedprice * (1.00 - l_discount))\n"}],"table": "","extra": "#0\n#1\n#2\nsum(#3)"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n#1\n__internal_decompress_integral_integer(#2, 0)\n#3\n"}],"table": "","extra": "l_orderkey\nrevenue\no_orderdate\no_shippriority\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n#1\n#2\n__internal_compress_integral_utinyint(#3, 0)\n"}],"table": "","extra": "ORDERS:\nsum((lineitem.l_extendedprice * (1 - lineitem.l_discount))) DESC\norders.o_orderdate ASC"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n#1\n#2\n__internal_decompress_integral_integer(#3, 0)\n"}],"table": "","extra": ""}
Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│__internal_decompress_strin│                                                                                       
│           g(#0)           │                                                                                       
│             #1            │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│          ORDER_BY         │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│          ORDERS:          │                                                                                       
│ orders.o_orderpriority ASC│                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│__internal_compress_string_│                                                                                       
│        hugeint(#0)        │                                                                                       
│             #1            │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│__internal_decompress_strin│                                                                                       
│           g(#0)           │                                                                                       
│             #1            │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│       HASH_GROUP_BY       │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│             #0            │                                                                                       
│        count_star()       │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│      o_orderpriority      │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│__internal_compress_integra│                                                                                       
│     l_uinteger(#0, 1)     │                                                                                       
│__internal_compress_string_│                                                                                       
│        hugeint(#1)        │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│      RIGHT_DELIM_JOIN     │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│         RIGHT_SEMI        │                                                                                       
│ o_orderkey IS NOT DISTINCT├──────────────┐                                                                        
│       FROM o_orderkey     │              │                                                                        
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                                                        
│        EC: 1200243        │              │                                                                        
└─────────────┬─────────────┘              │                                                                                                     
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                          
│         SEQ_SCAN          ││         HASH_JOIN         │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│           orders          ││         RIGHT_SEMI        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││ o_orderkey IS NOT DISTINCT│                                                          
│         o_orderkey        ││       FROM o_orderkey     │                                                          
│      o_orderpriority      ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││        EC: 1200243        ├───────────────────────────────────────────┐              
│Filters: o_orderdate>='1993││                           │                                           │              
│     -07-01'::DATE AND     ││                           │                                           │              
│ o_orderdate<'1993-10-...  ││                           │                                           │              
│   o_orderdate IS NOT NULL ││                           │                                           │              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                           │              
│         EC: 300000        ││                           │                                           │              
└───────────────────────────┘└─────────────┬─────────────┘                                           │                                           
                             ┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐
                             │         PROJECTION        │                             │         DUMMY_SCAN        │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │                           │
                             │         o_orderkey        │                             │                           │
                             └─────────────┬─────────────┘                             └───────────────────────────┘                             
                             ┌─────────────┴─────────────┐                                                          
                             │         HASH_JOIN         │                                                          
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                             │           INNER           │                                                          
                             │  l_orderkey = o_orderkey  ├──────────────┐                                           
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                           
                             │        EC: 1200243        │              │                                           
                             └─────────────┬─────────────┘              │                                                                        
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             
                             │           FILTER          ││         DELIM_SCAN        │                             
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                             
                             │      (l_commitdate <      ││                           │                             
                             │       l_receiptdate)      ││                           │                             
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                             
                             │        EC: 6001215        ││                           │                             
                             └─────────────┬─────────────┘└───────────────────────────┘                                                          
                             ┌─────────────┴─────────────┐                                                          
                             │         SEQ_SCAN          │                                                          
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                             │          lineitem         │                                                          
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                             │         l_orderkey        │                                                          
                             │        l_commitdate       │                                                          
                             │       l_receiptdate       │                                                          
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                             │        EC: 6001215        │                                                          
                             └───────────────────────────┘                                                                                       

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

uncompressed filter_log_size: 15272496
uncompressed filter_log_buffer_size: 15173184
uncompressed limit_offset_size: 1008
uncompressed limit_offset_buffer_size: 0
uncompressed perfect_full_scan_ht_log_size: 1008
uncompressed perfect_full_scan_ht_log_buffer_size: 0
uncompressed perfect_probe_ht_log_size: 1008
uncompressed perfect_probe_ht_log_buffer_size: 0
uncompressed row_group_log_size: 393720
uncompressed row_group_log_buffer_size: 228872
uncompressed scatter_log_size: 895832
uncompressed scatter_log_buffer_size: 877928
uncompressed scatter_sel_log_size: 1408032
uncompressed scatter_sel_log_buffer_size: 1373232
uncompressed gather_log_size: 1008
uncompressed gather_log_buffer_size: 0
uncompressed combine_log_size: 1008
uncompressed combine_log_buffer_size: 0
uncompressed finalize_states_log_size: 459320
uncompressed finalize_states_log_buffer_size: 457784
uncompressed join_gather_log_size: 4176576
uncompressed join_gather_log_buffer_size: 3897040
uncompressed reorder_log_size: 1072
uncompressed reorder_log_buffer_size: 0
uncompressed cross_log_size: 1008
uncompressed cross_log_buffer_size: 0
uncompressed nlj_log_size: 1008
uncompressed nlj_log_buffer_size: 0
uncompressed total_size: 22614104
uncompressed total_buffer_size: 22008040
uncompressed total_element_size: 606064

Clear Lineage

%%%%%%%%%%%%%%%% Running Query #  4  threads:  1
SELECT o_orderpriority, count(*) AS order_count FROM orders WHERE o_orderdate >= CAST('1993-07-01' AS date) AND o_orderdate < CAST('1993-10-01' AS date) AND EXISTS ( SELECT * FROM lineitem WHERE l_orderkey = o_orderkey AND l_commitdate < l_receiptdate) GROUP BY o_orderpriority ORDER BY o_orderpriority;
Run:  None SELECT o_orderpriority, count(*) AS order_count FROM orders WHERE o_orderdate >= CAST('1993-07-01' AS date) AND o_orderdate < CAST('1993-10-01' AS date) AND EXISTS ( SELECT * FROM lineitem WHERE l_orderkey = o_orderkey AND l_commitdate < l_receiptdate) GROUP BY o_orderpriority ORDER BY o_orderpriority;
Avg Time in sec:  0.20040193805471063  output size:  5
   o_orderpriority  order_count
0         1-URGENT        10594
1           2-HIGH        10476
2         3-MEDIUM        10410
3  4-NOT SPECIFIED        10556
4            5-LOW        10487
{'name': 'Query', 'result': 0.198151, 'timing': 0.198151, 'cardinality': 0, 'extra-info': "SELECT o_orderpriority, count(*) AS order_count FROM orders WHERE o_orderdate >= CAST('1993-07-01' AS date) AND o_orderdate < CAST('1993-10-01' AS date) AND EXISTS ( SELECT * FROM lineitem WHERE l_orderkey = o_orderkey AND l_commitdate < l_receiptdate) GROUP BY o_orderpriority ORDER BY o_orderpriority;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 8e-06, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 5e-06, 'cardinality': 5, 'extra_info': '__internal_decompress_string(#0)\n#1\n', 'children': [{'name': 'ORDER_BY', 'timing': 2.3e-05, 'cardinality': 5, 'extra_info': 'ORDERS:\norders.o_orderpriority ASC', 'children': [{'name': 'PROJECTION', 'timing': 1e-06, 'cardinality': 5, 'extra_info': '__internal_compress_string_hugeint(#0)\n#1\n', 'children': [{'name': 'PROJECTION', 'timing': 6e-06, 'cardinality': 5, 'extra_info': '__internal_decompress_string(#0)\n#1\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.00192, 'cardinality': 5, 'extra_info': '#0\ncount_star()', 'children': [{'name': 'PROJECTION', 'timing': 6e-06, 'cardinality': 52523, 'extra_info': 'o_orderpriority\n', 'children': [{'name': 'PROJECTION', 'timing': 0.000615, 'cardinality': 52523, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n__internal_compress_string_hugeint(#1)\n', 'children': [{'name': 'RIGHT_DELIM_JOIN', 'timing': 0.014324, 'cardinality': 0, 'extra_info': 'RIGHT_SEMI\no_orderkey IS NOT DISTINCT FROM o_orderkey\n\n[INFOSEPARATOR]\nEC: 1200243\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.043901, 'cardinality': 57218, 'extra_info': "orders\n[INFOSEPARATOR]\no_orderkey\no_orderpriority\n[INFOSEPARATOR]\nFilters: o_orderdate>='1993-07-01'::DATE AND o_orderdate<'1993-10-01'::DATE AND o_orderdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 300000", 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.009119, 'cardinality': 52523, 'extra_info': 'RIGHT_SEMI\no_orderkey IS NOT DISTINCT FROM o_orderkey\n\n[INFOSEPARATOR]\nEC: 1200243\n', 'children': [{'name': 'PROJECTION', 'timing': 6.1e-05, 'cardinality': 144869, 'extra_info': 'o_orderkey\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.07953, 'cardinality': 144869, 'extra_info': 'INNER\nl_orderkey = o_orderkey\n\n[INFOSEPARATOR]\nEC: 1200243\n', 'children': [{'name': 'FILTER', 'timing': 0.028966, 'cardinality': 3793296, 'extra_info': '(l_commitdate < l_receiptdate)\n[INFOSEPARATOR]\nEC: 6001215', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.00856, 'cardinality': 6001215, 'extra_info': 'lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_commitdate\nl_receiptdate\n[INFOSEPARATOR]\nEC: 6001215', 'children': []}]}, {'name': 'DELIM_SCAN', 'timing': 0.0, 'cardinality': 0, 'extra_info': '', 'children': []}]}]}, {'name': 'DUMMY_SCAN', 'timing': 0.0, 'cardinality': 0, 'extra_info': '', 'children': []}]}, {'name': 'HASH_GROUP_BY', 'timing': 0.000573, 'cardinality': 57218, 'extra_info': '#0', 'children': []}]}]}]}]}]}]}]}]}]}]}
X {'RESULT_COLLECTOR0': 8e-06, 'PROJECTION1': 5e-06, 'ORDER_BY2': 2.3e-05, 'PROJECTION3': 1e-06, 'PROJECTION4': 6e-06, 'HASH_GROUP_BY5': 0.00192, 'PROJECTION6': 6e-06, 'PROJECTION7': 0.000615, 'RIGHT_DELIM_JOIN8': 0.014324, 'SEQ_SCAN 9': 0.043901, 'HASH_JOIN10': 0.009119, 'PROJECTION11': 6.1e-05, 'HASH_JOIN12': 0.07953, 'FILTER13': 0.028966, 'SEQ_SCAN 14': 0.00856, 'DELIM_SCAN15': 0.0, 'DUMMY_SCAN16': 0.0, 'HASH_GROUP_BY17': 0.000573}
**** output size:  5
LINEAGE_4_FILTER_1
LINEAGE_4_HASH_GROUP_BY_12
LINEAGE_4_HASH_GROUP_BY_7
LINEAGE_4_HASH_JOIN_3
LINEAGE_4_HASH_JOIN_6
LINEAGE_4_ORDER_BY_15
LINEAGE_4_SEQ_SCAN_0
LINEAGE_4_SEQ_SCAN_8
SELECT o_orderpriority, count(*) AS order_count FROM orders WHERE o_orderdate >= CAST('1993-07-01' AS date) AND o_orderdate < CAST('1993-10-01' AS date) AND EXISTS ( SELECT * FROM lineitem WHERE l_orderkey = o_orderkey AND l_commitdate < l_receiptdate) GROUP BY o_orderpriority ORDER BY o_orderpriority;
   query_id  ...                                               plan
0         4  ...  {"name": "PROJECTION", "opid": "16", "children...

[1 rows x 7 columns]
Query info:  query_id                                                            4
query               SELECT o_orderpriority, count(*) AS order_coun...
size_bytes_max                                               22614104
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "PROJECTION", "opid": "16", "children...
Name: 0, dtype: object
{"name": "PROJECTION", "opid": "16", "children": [{"name": "ORDER_BY", "opid": "15", "children": [{"name": "PROJECTION", "opid": "14", "children": [{"name": "PROJECTION", "opid": "13", "children": [{"name": "HASH_GROUP_BY", "opid": "12", "children": [{"name": "PROJECTION", "opid": "11", "children": [{"name": "PROJECTION", "opid": "10", "children": [{"name": "RIGHT_DELIM_JOIN", "opid": "9", "children": [{"name": "HASH_GROUP_BY", "opid": "7", "children": [],"table": "","extra": "#0"},{"name": "HASH_JOIN", "opid": "6", "children": [{"name": "PROJECTION", "opid": "4", "children": [{"name": "HASH_JOIN", "opid": "3", "children": [{"name": "FILTER", "opid": "1", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_commitdate\nl_receiptdate\n[INFOSEPARATOR]\nEC: 6001215"}],"table": "","extra": "(l_commitdate < l_receiptdate)\n[INFOSEPARATOR]\nEC: 6001215"},{"name": "DELIM_SCAN", "opid": "2", "children": [],"table": "","extra": ""}],"table": "","extra": "INNER\nl_orderkey = o_orderkey\n\n[INFOSEPARATOR]\nEC: 1200243\n"}],"table": "","extra": "o_orderkey\n"},{"name": "DUMMY_SCAN", "opid": "5", "children": [],"table": "","extra": ""}],"table": "","extra": "RIGHT_SEMI\no_orderkey IS NOT DISTINCT FROM o_orderkey\n\n[INFOSEPARATOR]\nEC: 1200243\n"},{"name": "SEQ_SCAN ", "opid": "8", "children": [],"table": "orders","extra": "orders\n[INFOSEPARATOR]\no_orderkey\no_orderpriority\n[INFOSEPARATOR]\nFilters: o_orderdate>='1993-07-01'::DATE AND o_orderdate<'1993-10-01'::DATE AND o_orderdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 300000"}],"table": "","extra": "RIGHT_SEMI\no_orderkey IS NOT DISTINCT FROM o_orderkey\n\n[INFOSEPARATOR]\nEC: 1200243\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n__internal_compress_string_hugeint(#1)\n"}],"table": "","extra": "o_orderpriority\n"}],"table": "","extra": "#0\ncount_star()"}],"table": "","extra": "__internal_decompress_string(#0)\n#1\n"}],"table": "","extra": "__internal_compress_string_hugeint(#0)\n#1\n"}],"table": "","extra": "ORDERS:\norders.o_orderpriority ASC"}],"table": "","extra": "__internal_decompress_string(#0)\n#1\n"}
%%%%%%%%%%%%%%%% Running Query #  5  threads:  1
SELECT n_name, sum(l_extendedprice * (1 - l_discount)) AS revenue FROM customer, orders, lineitem, supplier, nation, region WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND l_suppkey = s_suppkey AND c_nationkey = s_nationkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'ASIA' AND o_orderdate >= CAST('1994-01-01' AS date) AND o_orderdate < CAST('1995-01-01' AS date) GROUP BY n_name ORDER BY revenue DESC;
Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│__internal_decompress_strin│                                                                                                                                                 
│           g(#0)           │                                                                                                                                                 
│             #1            │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│          ORDER_BY         │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│          ORDERS:          │                                                                                                                                                 
│       sum((lineitem       │                                                                                                                                                 
│.l_extendedprice * (1 ...  │                                                                                                                                                 
│    .l_discount))) DESC    │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│__internal_compress_string_│                                                                                                                                                 
│        hugeint(#0)        │                                                                                                                                                 
│             #1            │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│__internal_decompress_strin│                                                                                                                                                 
│           g(#0)           │                                                                                                                                                 
│             #1            │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│       HASH_GROUP_BY       │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│             #0            │                                                                                                                                                 
│          sum(#1)          │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│           n_name          │                                                                                                                                                 
│ (l_extendedprice * (1.00 -│                                                                                                                                                 
│        l_discount))       │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│__internal_compress_integra│                                                                                                                                                 
│     l_uinteger(#0, 1)     │                                                                                                                                                 
│__internal_compress_integra│                                                                                                                                                 
│     l_usmallint(#1, 1)    │                                                                                                                                                 
│             #2            │                                                                                                                                                 
│             #3            │                                                                                                                                                 
│__internal_compress_integra│                                                                                                                                                 
│     l_uinteger(#4, 1)     │                                                                                                                                                 
│__internal_compress_integra│                                                                                                                                                 
│     l_utinyint(#5, 0)     │                                                                                                                                                 
│__internal_compress_string_│                                                                                                                                                 
│        hugeint(#6)        │                                                                                                                                                 
│__internal_compress_integra│                                                                                                                                                 
│     l_usmallint(#7, 1)    │                                                                                                                                                 
│__internal_compress_integra│                                                                                                                                                 
│     l_utinyint(#8, 0)     │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         HASH_JOIN         │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│           INNER           │                                                                                                                                                 
│ n_nationkey = s_nationkey ├──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐              
│   l_suppkey = s_suppkey   │                                                                                                                                  │              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                  │              
│         EC: 143512        │                                                                                                                                  │              
└─────────────┬─────────────┘                                                                                                                                  │                                           
┌─────────────┴─────────────┐                                                                                                                    ┌─────────────┴─────────────┐
│         HASH_JOIN         │                                                                                                                    │         SEQ_SCAN          │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│           INNER           │                                                                                                                    │          supplier         │
│  l_orderkey = o_orderkey  │                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐                                                                                                     │         s_suppkey         │
│         EC: 144747        │              │                                                                                                     │        s_nationkey        │
│                           │              │                                                                                                     │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│                           │              │                                                                                                     │         EC: 10000         │
└─────────────┬─────────────┘              │                                                                                                     └───────────────────────────┘                             
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                                                    
│         SEQ_SCAN          ││         HASH_JOIN         │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│          lineitem         ││           INNER           │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   o_custkey = c_custkey   │                                                                                                                    
│         l_orderkey        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│         l_suppkey         ││        Build Min: 1       ├──────────────┐                                                                                                     
│      l_extendedprice      ││     Build Max: 149999     │              │                                                                                                     
│         l_discount        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                                                                                     
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││         EC: 36179         │              │                                                                                                     
│        EC: 6001215        ││                           │              │                                                                                                     
└───────────────────────────┘└─────────────┬─────────────┘              │                                                                                                                                  
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                       
                             │         SEQ_SCAN          ││         PROJECTION        │                                                                                       
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
                             │           orders          ││             #0            │                                                                                       
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││             #1            │                                                                                       
                             │         o_custkey         ││             #3            │                                                                                       
                             │         o_orderkey        ││                           │                                                                                       
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                                                                       
                             │Filters: o_orderdate>='1994││                           │                                                                                       
                             │     -01-01'::DATE AND     ││                           │                                                                                       
                             │ o_orderdate<'1995-01-...  ││                           │                                                                                       
                             │   o_orderdate IS NOT NULL ││                           │                                                                                       
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                                                                       
                             │         EC: 300000        ││                           │                                                                                       
                             └───────────────────────────┘└─────────────┬─────────────┘                                                                                                                    
                                                          ┌─────────────┴─────────────┐                                                                                       
                                                          │           FILTER          │                                                                                       
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
                                                          │   (c_custkey <= 149999)   │                                                                                       
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
                                                          │         EC: 30000         │                                                                                       
                                                          └─────────────┬─────────────┘                                                                                                                    
                                                          ┌─────────────┴─────────────┐                                                                                       
                                                          │         HASH_JOIN         │                                                                                       
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
                                                          │           INNER           │                                                                                       
                                                          │ c_nationkey = n_nationkey │                                                                                       
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐                                                                        
                                                          │        Build Min: 0       │              │                                                                        
                                                          │       Build Max: 24       │              │                                                                        
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                                                        
                                                          │         EC: 30000         │              │                                                                        
                                                          └─────────────┬─────────────┘              │                                                                                                     
                                                          ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                          
                                                          │         SEQ_SCAN          ││         HASH_JOIN         │                                                          
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                          │          customer         ││           INNER           │                                                          
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││ n_regionkey = r_regionkey │                                                          
                                                          │         c_custkey         ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐                                           
                                                          │        c_nationkey        ││           EC: 25          │              │                                           
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │              │                                           
                                                          │         EC: 150000        ││                           │              │                                           
                                                          └───────────────────────────┘└─────────────┬─────────────┘              │                                                                        
                                                                                       ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             
                                                                                       │         SEQ_SCAN          ││         SEQ_SCAN          │                             
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                                                                                       │           nation          ││           region          │                             
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                                                                                       │        n_nationkey        ││        r_regionkey        │                             
                                                                                       │        n_regionkey        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                                                                                       │           n_name          ││ Filters: r_name='ASIA' AND│                             
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││     r_name IS NOT NULL    │                             
                                                                                       │           EC: 25          ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                                                                                       │                           ││           EC: 1           │                             
                                                                                       └───────────────────────────┘└───────────────────────────┘                                                          

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

uncompressed filter_log_size: 4368
uncompressed filter_log_buffer_size: 0
uncompressed limit_offset_size: 1296
uncompressed limit_offset_buffer_size: 0
uncompressed perfect_full_scan_ht_log_size: 484544
uncompressed perfect_full_scan_ht_log_buffer_size: 483120
uncompressed perfect_probe_ht_log_size: 647688
uncompressed perfect_probe_ht_log_buffer_size: 609528
uncompressed row_group_log_size: 1079944
uncompressed row_group_log_buffer_size: 910392
uncompressed scatter_log_size: 60264
uncompressed scatter_log_buffer_size: 57944
uncompressed scatter_sel_log_size: 1056456
uncompressed scatter_sel_log_buffer_size: 1034360
uncompressed gather_log_size: 1296
uncompressed gather_log_buffer_size: 0
uncompressed combine_log_size: 1296
uncompressed combine_log_buffer_size: 0
uncompressed finalize_states_log_size: 1352
uncompressed finalize_states_log_buffer_size: 40
uncompressed join_gather_log_size: 2624968
uncompressed join_gather_log_buffer_size: 2295960
uncompressed reorder_log_size: 1360
uncompressed reorder_log_buffer_size: 0
uncompressed cross_log_size: 1296
uncompressed cross_log_buffer_size: 0
uncompressed nlj_log_size: 1296
uncompressed nlj_log_buffer_size: 0
uncompressed total_size: 5967424
uncompressed total_buffer_size: 5391344
uncompressed total_element_size: 576080

Run:  None SELECT n_name, sum(l_extendedprice * (1 - l_discount)) AS revenue FROM customer, orders, lineitem, supplier, nation, region WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND l_suppkey = s_suppkey AND c_nationkey = s_nationkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'ASIA' AND o_orderdate >= CAST('1994-01-01' AS date) AND o_orderdate < CAST('1995-01-01' AS date) GROUP BY n_name ORDER BY revenue DESC;
Avg Time in sec:  0.18066180497407913  output size:  5
      n_name       revenue
0  INDONESIA  5.550204e+07
1    VIETNAM  5.529509e+07
2      CHINA  5.372449e+07
3      INDIA  5.203551e+07
4      JAPAN  4.541018e+07
{'name': 'Query', 'result': 0.177295, 'timing': 0.177295, 'cardinality': 0, 'extra-info': "SELECT n_name, sum(l_extendedprice * (1 - l_discount)) AS revenue FROM customer, orders, lineitem, supplier, nation, region WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND l_suppkey = s_suppkey AND c_nationkey = s_nationkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'ASIA' AND o_orderdate >= CAST('1994-01-01' AS date) AND o_orderdate < CAST('1995-01-01' AS date) GROUP BY n_name ORDER BY revenue DESC;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 4e-06, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 1e-06, 'cardinality': 5, 'extra_info': '__internal_decompress_string(#0)\n#1\n', 'children': [{'name': 'ORDER_BY', 'timing': 2.7e-05, 'cardinality': 5, 'extra_info': 'ORDERS:\nsum((lineitem.l_extendedprice * (1 - lineitem.l_discount))) DESC', 'children': [{'name': 'PROJECTION', 'timing': 1e-06, 'cardinality': 5, 'extra_info': '__internal_compress_string_hugeint(#0)\n#1\n', 'children': [{'name': 'PROJECTION', 'timing': 2e-06, 'cardinality': 5, 'extra_info': '__internal_decompress_string(#0)\n#1\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.000835, 'cardinality': 5, 'extra_info': '#0\nsum(#1)', 'children': [{'name': 'PROJECTION', 'timing': 0.000196, 'cardinality': 7243, 'extra_info': 'n_name\n(l_extendedprice * (1.00 - l_discount))\n', 'children': [{'name': 'PROJECTION', 'timing': 0.000575, 'cardinality': 7243, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n__internal_compress_integral_usmallint(#1, 1)\n#2\n#3\n__internal_compress_integral_uinteger(#4, 1)\n__internal_compress_integral_utinyint(#5, 0)\n__internal_compress_string_hugeint(#6)\n__internal_compress_integral_usmallint(#7, 1)\n__internal_compress_integral_utinyint(#8, 0)\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.018369, 'cardinality': 7243, 'extra_info': 'INNER\nn_nationkey = s_nationkey\nl_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nEC: 143512\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.109654, 'cardinality': 184082, 'extra_info': 'INNER\nl_orderkey = o_orderkey\n\n[INFOSEPARATOR]\nEC: 144747\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.011699, 'cardinality': 6001215, 'extra_info': 'lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_suppkey\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nEC: 6001215', 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.006875, 'cardinality': 46008, 'extra_info': 'INNER\no_custkey = c_custkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 149999\n\n[INFOSEPARATOR]\nEC: 36179\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.01298, 'cardinality': 227597, 'extra_info': "orders\n[INFOSEPARATOR]\no_custkey\no_orderkey\n[INFOSEPARATOR]\nFilters: o_orderdate>='1994-01-01'::DATE AND o_orderdate<'1995-01-01'::DATE AND o_orderdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 300000", 'children': []}, {'name': 'PROJECTION', 'timing': 2.4e-05, 'cardinality': 30183, 'extra_info': '#0\n#1\n#3\n', 'children': [{'name': 'FILTER', 'timing': 0.000241, 'cardinality': 30183, 'extra_info': '(c_custkey <= 149999)\n[INFOSEPARATOR]\nEC: 30000', 'children': [{'name': 'HASH_JOIN', 'timing': 0.000678, 'cardinality': 30183, 'extra_info': 'INNER\nc_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 30000\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.00017, 'cardinality': 150000, 'extra_info': 'customer\n[INFOSEPARATOR]\nc_custkey\nc_nationkey\n[INFOSEPARATOR]\nEC: 150000', 'children': []}, {'name': 'HASH_JOIN', 'timing': 4.2e-05, 'cardinality': 5, 'extra_info': 'INNER\nn_regionkey = r_regionkey\n\n[INFOSEPARATOR]\nEC: 25\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 1.1e-05, 'cardinality': 25, 'extra_info': 'nation\n[INFOSEPARATOR]\nn_nationkey\nn_regionkey\nn_name\n[INFOSEPARATOR]\nEC: 25', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 1.2e-05, 'cardinality': 1, 'extra_info': "region\n[INFOSEPARATOR]\nr_regionkey\n[INFOSEPARATOR]\nFilters: r_name='ASIA' AND r_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1", 'children': []}]}]}]}]}]}]}, {'name': 'SEQ_SCAN ', 'timing': 4e-05, 'cardinality': 10000, 'extra_info': 'supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\n[INFOSEPARATOR]\nEC: 10000', 'children': []}]}]}]}]}]}]}]}]}]}]}
X {'RESULT_COLLECTOR0': 4e-06, 'PROJECTION1': 1e-06, 'ORDER_BY2': 2.7e-05, 'PROJECTION3': 1e-06, 'PROJECTION4': 2e-06, 'HASH_GROUP_BY5': 0.000835, 'PROJECTION6': 0.000196, 'PROJECTION7': 0.000575, 'HASH_JOIN8': 0.018369, 'HASH_JOIN9': 0.109654, 'SEQ_SCAN 10': 0.011699, 'HASH_JOIN11': 0.006875, 'SEQ_SCAN 12': 0.01298, 'PROJECTION13': 2.4e-05, 'FILTER14': 0.000241, 'HASH_JOIN15': 0.000678, 'SEQ_SCAN 16': 0.00017, 'HASH_JOIN17': 4.2e-05, 'SEQ_SCAN 18': 1.1e-05, 'SEQ_SCAN 19': 1.2e-05, 'SEQ_SCAN 20': 4e-05}
**** output size:  5
LINEAGE_4_FILTER_7
LINEAGE_4_HASH_GROUP_BY_15
LINEAGE_4_HASH_JOIN_10
LINEAGE_4_HASH_JOIN_12
LINEAGE_4_HASH_JOIN_5
LINEAGE_4_HASH_JOIN_6
LINEAGE_4_HASH_JOIN_9
LINEAGE_4_ORDER_BY_18
LINEAGE_4_SEQ_SCAN_0
LINEAGE_4_SEQ_SCAN_1
LINEAGE_4_SEQ_SCAN_11
LINEAGE_4_SEQ_SCAN_2
LINEAGE_4_SEQ_SCAN_3
LINEAGE_4_SEQ_SCAN_4
SELECT n_name, sum(l_extendedprice * (1 - l_discount)) AS revenue FROM customer, orders, lineitem, supplier, nation, region WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND l_suppkey = s_suppkey AND c_nationkey = s_nationkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'ASIA' AND o_orderdate >= CAST('1994-01-01' AS date) AND o_orderdate < CAST('1995-01-01' AS date) GROUP BY n_name ORDER BY revenue DESC;
   query_id  ...                                               plan
0         4  ...  {"name": "PROJECTION", "opid": "19", "children...

[1 rows x 7 columns]
Query info:  query_id                                                            4
query               SELECT n_name, sum(l_extendedprice * (1 - l_di...
size_bytes_max                                                5967424
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "PROJECTION", "opid": "19", "children...
Name: 0, dtype: object
{"name": "PROJECTION", "opid": "19", "children": [{"name": "ORDER_BY", "opid": "18", "children": [{"name": "PROJECTION", "opid": "17", "children": [{"name": "PROJECTION", "opid": "16", "children": [{"name": "HASH_GROUP_BY", "opid": "15", "children": [{"name": "PROJECTION", "opid": "14", "children": [{"name": "PROJECTION", "opid": "13", "children": [{"name": "HASH_JOIN", "opid": "12", "children": [{"name": "HASH_JOIN", "opid": "10", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_suppkey\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nEC: 6001215"},{"name": "HASH_JOIN", "opid": "9", "children": [{"name": "SEQ_SCAN ", "opid": "1", "children": [],"table": "orders","extra": "orders\n[INFOSEPARATOR]\no_custkey\no_orderkey\n[INFOSEPARATOR]\nFilters: o_orderdate>='1994-01-01'::DATE AND o_orderdate<'1995-01-01'::DATE AND o_orderdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 300000"},{"name": "PROJECTION", "opid": "8", "children": [{"name": "FILTER", "opid": "7", "children": [{"name": "HASH_JOIN", "opid": "6", "children": [{"name": "SEQ_SCAN ", "opid": "2", "children": [],"table": "customer","extra": "customer\n[INFOSEPARATOR]\nc_custkey\nc_nationkey\n[INFOSEPARATOR]\nEC: 150000"},{"name": "HASH_JOIN", "opid": "5", "children": [{"name": "SEQ_SCAN ", "opid": "3", "children": [],"table": "nation","extra": "nation\n[INFOSEPARATOR]\nn_nationkey\nn_regionkey\nn_name\n[INFOSEPARATOR]\nEC: 25"},{"name": "SEQ_SCAN ", "opid": "4", "children": [],"table": "region","extra": "region\n[INFOSEPARATOR]\nr_regionkey\n[INFOSEPARATOR]\nFilters: r_name='ASIA' AND r_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1"}],"table": "","extra": "INNER\nn_regionkey = r_regionkey\n\n[INFOSEPARATOR]\nEC: 25\n"}],"table": "","extra": "INNER\nc_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 30000\n"}],"table": "","extra": "(c_custkey <= 149999)\n[INFOSEPARATOR]\nEC: 30000"}],"table": "","extra": "#0\n#1\n#3\n"}],"table": "","extra": "INNER\no_custkey = c_custkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 149999\n\n[INFOSEPARATOR]\nEC: 36179\n"}],"table": "","extra": "INNER\nl_orderkey = o_orderkey\n\n[INFOSEPARATOR]\nEC: 144747\n"},{"name": "SEQ_SCAN ", "opid": "11", "children": [],"table": "supplier","extra": "supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\n[INFOSEPARATOR]\nEC: 10000"}],"table": "","extra": "INNER\nn_nationkey = s_nationkey\nl_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nEC: 143512\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n__internal_compress_integral_usmallint(#1, 1)\n#2\n#3\n__internal_compress_integral_uinteger(#4, 1)\n__internal_compress_integral_utinyint(#5, 0)\n__internal_compress_string_hugeint(#6)\n__internal_compress_integral_usmallint(#7, 1)\n__internal_compress_integral_utinyint(#8, 0)\n"}],"table": "","extra": "n_name\n(l_extendedprice * (1.00 - l_discount))\n"}],"table": "","extra": "#0\nsum(#1)"}],"table": "","extra": "__internal_decompress_string(#0)\n#1\n"}],"table": "","extra": "__internal_compress_string_hugeint(#0)\n#1\n"}],"table": "","extra": "ORDERS:\nsum((lineitem.l_extendedprice * (1 - lineitem.l_discount))) DESC"}],"table": "","extra": "__internal_decompress_string(#0)\n#1\n"}
Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│    UNGROUPED_AGGREGATE    │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│    sum_no_overflow(#0)    │
└─────────────┬─────────────┘                             
┌─────────────┴─────────────┐
│         PROJECTION        │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│     (l_extendedprice *    │
│         l_discount)       │
└─────────────┬─────────────┘                             
┌─────────────┴─────────────┐
│         SEQ_SCAN          │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│          lineitem         │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│         l_discount        │
│      l_extendedprice      │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│ Filters: l_shipdate>='1994│
│-01-01'::DATE AND l_sh...  │
│  <'1995-01-01'::DATE AND  │
│   l_shipdate IS NOT NULL  │
│    l_discount>=0.05 AND   │
│ l_discount<=0.07 AND ...  │
│         IS NOT NULL       │
│    l_quantity<24.00 AND   │
│   l_quantity IS NOT NULL  │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│        EC: 1200243        │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

uncompressed filter_log_size: 432
uncompressed filter_log_buffer_size: 0
uncompressed limit_offset_size: 432
uncompressed limit_offset_buffer_size: 0
uncompressed perfect_full_scan_ht_log_size: 432
uncompressed perfect_full_scan_ht_log_buffer_size: 0
uncompressed perfect_probe_ht_log_size: 432
uncompressed perfect_probe_ht_log_buffer_size: 0
uncompressed row_group_log_size: 588144
uncompressed row_group_log_buffer_size: 456640
uncompressed scatter_log_size: 432
uncompressed scatter_log_buffer_size: 0
uncompressed scatter_sel_log_size: 432
uncompressed scatter_sel_log_buffer_size: 0
uncompressed gather_log_size: 432
uncompressed gather_log_buffer_size: 0
uncompressed combine_log_size: 432
uncompressed combine_log_buffer_size: 0
uncompressed finalize_states_log_size: 432
uncompressed finalize_states_log_buffer_size: 0
uncompressed join_gather_log_size: 432
uncompressed join_gather_log_buffer_size: 0
uncompressed reorder_log_size: 432
uncompressed reorder_log_buffer_size: 0
uncompressed cross_log_size: 432
uncompressed cross_log_buffer_size: 0
uncompressed nlj_log_size: 432
uncompressed nlj_log_buffer_size: 0
uncompressed total_size: 593760
uncompressed total_buffer_size: 456640
uncompressed total_element_size: 137120

Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│__internal_decompress_strin│                                                                                                                                                 
│           g(#0)           │                                                                                                                                                 
│__internal_decompress_strin│                                                                                                                                                 
│           g(#1)           │                                                                                                                                                 
│__internal_decompress_integ│                                                                                                                                                 
│    ral_bigint(#2, 1992)   │                                                                                                                                                 
│             #3            │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│          ORDER_BY         │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│          ORDERS:          │                                                                                                                                                 
│  shipping.supp_nation ASC │                                                                                                                                                 
│  shipping.cust_nation ASC │                                                                                                                                                 
│    shipping.l_year ASC    │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│__internal_compress_string_│                                                                                                                                                 
│        hugeint(#0)        │                                                                                                                                                 
│__internal_compress_string_│                                                                                                                                                 
│        hugeint(#1)        │                                                                                                                                                 
│__internal_compress_integra│                                                                                                                                                 
│    l_utinyint(#2, 1992)   │                                                                                                                                                 
│             #3            │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│__internal_decompress_strin│                                                                                                                                                 
│           g(#0)           │                                                                                                                                                 
│__internal_decompress_strin│                                                                                                                                                 
│           g(#1)           │                                                                                                                                                 
│__internal_decompress_integ│                                                                                                                                                 
│    ral_bigint(#2, 1992)   │                                                                                                                                                 
│             #3            │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│       HASH_GROUP_BY       │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│             #0            │                                                                                                                                                 
│             #1            │                                                                                                                                                 
│             #2            │                                                                                                                                                 
│          sum(#3)          │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│        supp_nation        │                                                                                                                                                 
│        cust_nation        │                                                                                                                                                 
│           l_year          │                                                                                                                                                 
│           volume          │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│__internal_compress_string_│                                                                                                                                                 
│        hugeint(#0)        │                                                                                                                                                 
│__internal_compress_string_│                                                                                                                                                 
│        hugeint(#1)        │                                                                                                                                                 
│__internal_compress_integra│                                                                                                                                                 
│    l_utinyint(#2, 1992)   │                                                                                                                                                 
│             #3            │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│        supp_nation        │                                                                                                                                                 
│        cust_nation        │                                                                                                                                                 
│      year(l_shipdate)     │                                                                                                                                                 
│           volume          │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│             #2            │                                                                                                                                                 
│             #3            │                                                                                                                                                 
│             #4            │                                                                                                                                                 
│             #6            │                                                                                                                                                 
│             #8            │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│           FILTER          │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│ (((n_name = 'FRANCE') AND │                                                                                                                                                 
│ (n_name = 'GERMANY')) OR (│                                                                                                                                                 
│ (n_name = 'GERMANY') AND  │                                                                                                                                                 
│   (n_name = 'FRANCE')))   │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│         EC: 717564        │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         HASH_JOIN         │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│           INNER           │                                                                                                                                                 
│   l_suppkey = s_suppkey   │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├─────────────────────────────────────────────────────────────────────────────────────────────────────┐                                           
│        Build Min: 1       │                                                                                                     │                                           
│      Build Max: 10000     │                                                                                                     │                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                     │                                           
│         EC: 717564        │                                                                                                     │                                           
└─────────────┬─────────────┘                                                                                                     │                                                                        
┌─────────────┴─────────────┐                                                                                       ┌─────────────┴─────────────┐                             
│         HASH_JOIN         │                                                                                       │         HASH_JOIN         │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│           INNER           │                                                                                       │           INNER           │                             
│  l_orderkey = o_orderkey  │                                                                                       │ s_nationkey = n_nationkey │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐                                                                        │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐              
│         EC: 723735        │              │                                                                        │        Build Min: 0       │              │              
│                           │              │                                                                        │       Build Max: 24       │              │              
│                           │              │                                                                        │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              
│                           │              │                                                                        │         EC: 10000         │              │              
└─────────────┬─────────────┘              │                                                                        └─────────────┬─────────────┘              │                                           
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
│         SEQ_SCAN          ││         HASH_JOIN         │                                                          │         SEQ_SCAN          ││         SEQ_SCAN          │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│          lineitem         ││           INNER           │                                                          │          supplier         ││           nation          │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   o_custkey = c_custkey   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│         l_suppkey         ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │         s_suppkey         ││        n_nationkey        │
│         l_orderkey        ││        Build Min: 1       │                                                          │        s_nationkey        ││           n_name          │
│         l_shipdate        ││     Build Max: 149999     │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│      l_extendedprice      ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │         EC: 10000         ││           EC: 25          │
│         l_discount        ││         EC: 904486        ├──────────────┐                                           │                           ││                           │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │              │                                           │                           ││                           │
│ Filters: l_shipdate>='1995││                           │              │                                           │                           ││                           │
│-01-01'::DATE AND l_sh...  ││                           │              │                                           │                           ││                           │
│  <='1996-12-31'::DATE AND ││                           │              │                                           │                           ││                           │
│   l_shipdate IS NOT NULL  ││                           │              │                                           │                           ││                           │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │              │                                           │                           ││                           │
│        EC: 1200243        ││                           │              │                                           │                           ││                           │
└───────────────────────────┘└─────────────┬─────────────┘              │                                           └───────────────────────────┘└───────────────────────────┘                             
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                       
                             │         SEQ_SCAN          ││         HASH_JOIN         │                                                                                       
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
                             │           orders          ││           INNER           │                                                                                       
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││ c_nationkey = n_nationkey │                                                                                       
                             │         o_orderkey        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐                                                                        
                             │         o_custkey         ││         EC: 150000        │              │                                                                        
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │              │                                                                        
                             │        EC: 1500000        ││                           │              │                                                                        
                             └───────────────────────────┘└─────────────┬─────────────┘              │                                                                                                     
                                                          ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                          
                                                          │         SEQ_SCAN          ││         SEQ_SCAN          │                                                          
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                          │          customer         ││           nation          │                                                          
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                          │         c_custkey         ││        n_nationkey        │                                                          
                                                          │        c_nationkey        ││           n_name          │                                                          
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                          │ Filters: c_custkey<=149999││           EC: 25          │                                                          
                                                          │  AND c_custkey IS NOT NULL││                           │                                                          
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                                          
                                                          │         EC: 150000        ││                           │                                                          
                                                          └───────────────────────────┘└───────────────────────────┘                                                                                       

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

%%%%%%%%%%%%%%%% Running Query #  6  threads:  1
SELECT sum(l_extendedprice * l_discount) AS revenue FROM lineitem WHERE l_shipdate >= CAST('1994-01-01' AS date) AND l_shipdate < CAST('1995-01-01' AS date) AND l_discount BETWEEN 0.05 AND 0.07 AND l_quantity < 24;
Run:  None SELECT sum(l_extendedprice * l_discount) AS revenue FROM lineitem WHERE l_shipdate >= CAST('1994-01-01' AS date) AND l_shipdate < CAST('1995-01-01' AS date) AND l_discount BETWEEN 0.05 AND 0.07 AND l_quantity < 24;
Avg Time in sec:  0.05914900917559862  output size:  1
        revenue
0  1.231411e+08
{'name': 'Query', 'result': 0.057822, 'timing': 0.057822, 'cardinality': 0, 'extra-info': "SELECT sum(l_extendedprice * l_discount) AS revenue FROM lineitem WHERE l_shipdate >= CAST('1994-01-01' AS date) AND l_shipdate < CAST('1995-01-01' AS date) AND l_discount BETWEEN 0.05 AND 0.07 AND l_quantity < 24;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 7e-06, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'UNGROUPED_AGGREGATE', 'timing': 0.000913, 'cardinality': 1, 'extra_info': 'sum_no_overflow(#0)', 'children': [{'name': 'PROJECTION', 'timing': 0.003572, 'cardinality': 114160, 'extra_info': '(l_extendedprice * l_discount)\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.050563, 'cardinality': 114160, 'extra_info': "lineitem\n[INFOSEPARATOR]\nl_discount\nl_extendedprice\n[INFOSEPARATOR]\nFilters: l_shipdate>='1994-01-01'::DATE AND l_shipdate<'1995-01-01'::DATE AND l_shipdate IS NOT NULL\nl_discount>=0.05 AND l_discount<=0.07 AND l_discount IS NOT NULL\nl_quantity<24.00 AND l_quantity IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243", 'children': []}]}]}]}]}
X {'RESULT_COLLECTOR0': 7e-06, 'UNGROUPED_AGGREGATE1': 0.000913, 'PROJECTION2': 0.003572, 'SEQ_SCAN 3': 0.050563}
**** output size:  1
LINEAGE_4_SEQ_SCAN_0
SELECT sum(l_extendedprice * l_discount) AS revenue FROM lineitem WHERE l_shipdate >= CAST('1994-01-01' AS date) AND l_shipdate < CAST('1995-01-01' AS date) AND l_discount BETWEEN 0.05 AND 0.07 AND l_quantity < 24;
   query_id  ...                                               plan
0         4  ...  {"name": "UNGROUPED_AGGREGATE", "opid": "2", "...

[1 rows x 7 columns]
Query info:  query_id                                                            4
query               SELECT sum(l_extendedprice * l_discount) AS re...
size_bytes_max                                                 593760
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "UNGROUPED_AGGREGATE", "opid": "2", "...
Name: 0, dtype: object
{"name": "UNGROUPED_AGGREGATE", "opid": "2", "children": [{"name": "PROJECTION", "opid": "1", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_discount\nl_extendedprice\n[INFOSEPARATOR]\nFilters: l_shipdate>='1994-01-01'::DATE AND l_shipdate<'1995-01-01'::DATE AND l_shipdate IS NOT NULL\nl_discount>=0.05 AND l_discount<=0.07 AND l_discount IS NOT NULL\nl_quantity<24.00 AND l_quantity IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243"}],"table": "","extra": "(l_extendedprice * l_discount)\n"}],"table": "","extra": "sum_no_overflow(#0)"}
%%%%%%%%%%%%%%%% Running Query #  7  threads:  1
SELECT supp_nation, cust_nation, l_year, sum(volume) AS revenue FROM ( SELECT n1.n_name AS supp_nation, n2.n_name AS cust_nation, extract(year FROM l_shipdate) AS l_year, l_extendedprice * (1 - l_discount) AS volume FROM supplier, lineitem, orders, customer, nation n1, nation n2 WHERE s_suppkey = l_suppkey AND o_orderkey = l_orderkey AND c_custkey = o_custkey AND s_nationkey = n1.n_nationkey AND c_nationkey = n2.n_nationkey AND ((n1.n_name = 'FRANCE' AND n2.n_name = 'GERMANY') OR (n1.n_name = 'GERMANY' AND n2.n_name = 'FRANCE')) AND l_shipdate BETWEEN CAST('1995-01-01' AS date) AND CAST('1996-12-31' AS date)) AS shipping GROUP BY supp_nation, cust_nation, l_year ORDER BY supp_nation, cust_nation, l_year;
Run:  None SELECT supp_nation, cust_nation, l_year, sum(volume) AS revenue FROM ( SELECT n1.n_name AS supp_nation, n2.n_name AS cust_nation, extract(year FROM l_shipdate) AS l_year, l_extendedprice * (1 - l_discount) AS volume FROM supplier, lineitem, orders, customer, nation n1, nation n2 WHERE s_suppkey = l_suppkey AND o_orderkey = l_orderkey AND c_custkey = o_custkey AND s_nationkey = n1.n_nationkey AND c_nationkey = n2.n_nationkey AND ((n1.n_name = 'FRANCE' AND n2.n_name = 'GERMANY') OR (n1.n_name = 'GERMANY' AND n2.n_name = 'FRANCE')) AND l_shipdate BETWEEN CAST('1995-01-01' AS date) AND CAST('1996-12-31' AS date)) AS shipping GROUP BY supp_nation, cust_nation, l_year ORDER BY supp_nation, cust_nation, l_year;
Avg Time in sec:  0.4833033522590995  output size:  4
  supp_nation cust_nation  l_year       revenue
0      FRANCE     GERMANY    1995  5.463973e+07
1      FRANCE     GERMANY    1996  5.463308e+07
2     GERMANY      FRANCE    1995  5.253175e+07
3     GERMANY      FRANCE    1996  5.252055e+07
{'name': 'Query', 'result': 0.473686, 'timing': 0.473686, 'cardinality': 0, 'extra-info': "SELECT supp_nation, cust_nation, l_year, sum(volume) AS revenue FROM ( SELECT n1.n_name AS supp_nation, n2.n_name AS cust_nation, extract(year FROM l_shipdate) AS l_year, l_extendedprice * (1 - l_discount) AS volume FROM supplier, lineitem, orders, customer, nation n1, nation n2 WHERE s_suppkey = l_suppkey AND o_orderkey = l_orderkey AND c_custkey = o_custkey AND s_nationkey = n1.n_nationkey AND c_nationkey = n2.n_nationkey AND ((n1.n_name = 'FRANCE' AND n2.n_name = 'GERMANY') OR (n1.n_name = 'GERMANY' AND n2.n_name = 'FRANCE')) AND l_shipdate BETWEEN CAST('1995-01-01' AS date) AND CAST('1996-12-31' AS date)) AS shipping GROUP BY supp_nation, cust_nation, l_year ORDER BY supp_nation, cust_nation, l_year;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 5e-06, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 2e-06, 'cardinality': 4, 'extra_info': '__internal_decompress_string(#0)\n__internal_decompress_string(#1)\n__internal_decompress_integral_bigint(#2, 1992)\n#3\n', 'children': [{'name': 'ORDER_BY', 'timing': 2.7e-05, 'cardinality': 4, 'extra_info': 'ORDERS:\nshipping.supp_nation ASC\nshipping.cust_nation ASC\nshipping.l_year ASC', 'children': [{'name': 'PROJECTION', 'timing': 2e-06, 'cardinality': 4, 'extra_info': '__internal_compress_string_hugeint(#0)\n__internal_compress_string_hugeint(#1)\n__internal_compress_integral_utinyint(#2, 1992)\n#3\n', 'children': [{'name': 'PROJECTION', 'timing': 1e-05, 'cardinality': 4, 'extra_info': '__internal_decompress_string(#0)\n__internal_decompress_string(#1)\n__internal_decompress_integral_bigint(#2, 1992)\n#3\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.000971, 'cardinality': 4, 'extra_info': '#0\n#1\n#2\nsum(#3)', 'children': [{'name': 'PROJECTION', 'timing': 4e-06, 'cardinality': 5924, 'extra_info': 'supp_nation\ncust_nation\nl_year\nvolume\n', 'children': [{'name': 'PROJECTION', 'timing': 0.000158, 'cardinality': 5924, 'extra_info': '__internal_compress_string_hugeint(#0)\n__internal_compress_string_hugeint(#1)\n__internal_compress_integral_utinyint(#2, 1992)\n#3\n', 'children': [{'name': 'PROJECTION', 'timing': 0.000126, 'cardinality': 5924, 'extra_info': 'supp_nation\ncust_nation\nyear(l_shipdate)\nvolume\n', 'children': [{'name': 'PROJECTION', 'timing': 7e-06, 'cardinality': 5924, 'extra_info': '#2\n#3\n#4\n#6\n#8\n', 'children': [{'name': 'FILTER', 'timing': 0.073806, 'cardinality': 5924, 'extra_info': "(((n_name = 'FRANCE') AND (n_name = 'GERMANY')) OR ((n_name = 'GERMANY') AND (n_name = 'FRANCE')))\n[INFOSEPARATOR]\nEC: 717564", 'children': [{'name': 'HASH_JOIN', 'timing': 0.020104, 'cardinality': 1828450, 'extra_info': 'INNER\nl_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 717564\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.214686, 'cardinality': 1828450, 'extra_info': 'INNER\nl_orderkey = o_orderkey\n\n[INFOSEPARATOR]\nEC: 723735\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.040539, 'cardinality': 1828450, 'extra_info': "lineitem\n[INFOSEPARATOR]\nl_suppkey\nl_orderkey\nl_shipdate\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nFilters: l_shipdate>='1995-01-01'::DATE AND l_shipdate<='1996-12-31'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243", 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.013846, 'cardinality': 1500000, 'extra_info': 'INNER\no_custkey = c_custkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 149999\n\n[INFOSEPARATOR]\nEC: 904486\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.002334, 'cardinality': 1500000, 'extra_info': 'orders\n[INFOSEPARATOR]\no_orderkey\no_custkey\n[INFOSEPARATOR]\nEC: 1500000', 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.002879, 'cardinality': 149999, 'extra_info': 'INNER\nc_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nEC: 150000\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.000475, 'cardinality': 149999, 'extra_info': 'customer\n[INFOSEPARATOR]\nc_custkey\nc_nationkey\n[INFOSEPARATOR]\nFilters: c_custkey<=149999 AND c_custkey IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 150000', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 7e-06, 'cardinality': 25, 'extra_info': 'nation\n[INFOSEPARATOR]\nn_nationkey\nn_name\n[INFOSEPARATOR]\nEC: 25', 'children': []}]}]}]}, {'name': 'HASH_JOIN', 'timing': 9.8e-05, 'cardinality': 10000, 'extra_info': 'INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 10000\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 2.6e-05, 'cardinality': 10000, 'extra_info': 'supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\n[INFOSEPARATOR]\nEC: 10000', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 1.8e-05, 'cardinality': 25, 'extra_info': 'nation\n[INFOSEPARATOR]\nn_nationkey\nn_name\n[INFOSEPARATOR]\nEC: 25', 'children': []}]}]}]}]}]}]}]}]}]}]}]}]}]}]}
uncompressed filter_log_size: 123344
uncompressed filter_log_buffer_size: 23696
uncompressed limit_offset_size: 1344
uncompressed limit_offset_buffer_size: 0
uncompressed perfect_full_scan_ht_log_size: 2562088
uncompressed perfect_full_scan_ht_log_buffer_size: 2560552
uncompressed perfect_probe_ht_log_size: 20974800
uncompressed perfect_probe_ht_log_buffer_size: 20678288
uncompressed row_group_log_size: 8083396
uncompressed row_group_log_buffer_size: 7913796
uncompressed scatter_log_size: 48800
uncompressed scatter_log_buffer_size: 47392
uncompressed scatter_sel_log_size: 19959116
uncompressed scatter_sel_log_buffer_size: 19920588
uncompressed gather_log_size: 1344
uncompressed gather_log_buffer_size: 0
uncompressed combine_log_size: 1344
uncompressed combine_log_buffer_size: 0
uncompressed finalize_states_log_size: 1392
uncompressed finalize_states_log_buffer_size: 32
uncompressed join_gather_log_size: 24271116
uncompressed join_gather_log_buffer_size: 23741388
uncompressed reorder_log_size: 1400
uncompressed reorder_log_buffer_size: 0
uncompressed cross_log_size: 1344
uncompressed cross_log_buffer_size: 0
uncompressed nlj_log_size: 1344
uncompressed nlj_log_buffer_size: 0
uncompressed total_size: 76032172
uncompressed total_buffer_size: 74885732
uncompressed total_element_size: 1146440

Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐                                                                                                                                                                                                           
│         PROJECTION        │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│__internal_decompress_integ│                                                                                                                                                                                                           
│    ral_bigint(#0, 1992)   │                                                                                                                                                                                                           
│             #1            │                                                                                                                                                                                                           
└─────────────┬─────────────┘                                                                                                                                                                                                                                        
┌─────────────┴─────────────┐                                                                                                                                                                                                           
│          ORDER_BY         │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│          ORDERS:          │                                                                                                                                                                                                           
│   all_nations.o_year ASC  │                                                                                                                                                                                                           
└─────────────┬─────────────┘                                                                                                                                                                                                                                        
┌─────────────┴─────────────┐                                                                                                                                                                                                           
│         PROJECTION        │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│__internal_compress_integra│                                                                                                                                                                                                           
│    l_utinyint(#0, 1992)   │                                                                                                                                                                                                           
│             #1            │                                                                                                                                                                                                           
└─────────────┬─────────────┘                                                                                                                                                                                                                                        
┌─────────────┴─────────────┐                                                                                                                                                                                                           
│         PROJECTION        │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│           o_year          │                                                                                                                                                                                                           
│         mkt_share         │                                                                                                                                                                                                           
└─────────────┬─────────────┘                                                                                                                                                                                                                                        
┌─────────────┴─────────────┐                                                                                                                                                                                                           
│         PROJECTION        │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│__internal_decompress_integ│                                                                                                                                                                                                           
│    ral_bigint(#0, 1992)   │                                                                                                                                                                                                           
│             #1            │                                                                                                                                                                                                           
│             #2            │                                                                                                                                                                                                           
└─────────────┬─────────────┘                                                                                                                                                                                                                                        
┌─────────────┴─────────────┐                                                                                                                                                                                                           
│   PERFECT_HASH_GROUP_BY   │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│             #0            │                                                                                                                                                                                                           
│          sum(#1)          │                                                                                                                                                                                                           
│          sum(#2)          │                                                                                                                                                                                                           
└─────────────┬─────────────┘                                                                                                                                                                                                                                        
┌─────────────┴─────────────┐                                                                                                                                                                                                           
│         PROJECTION        │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│           o_year          │                                                                                                                                                                                                           
│   CASE  WHEN ((nation =   │                                                                                                                                                                                                           
│'BRAZIL')) THEN (volum...  │                                                                                                                                                                                                           
│         .0000 END         │                                                                                                                                                                                                           
│           volume          │                                                                                                                                                                                                           
└─────────────┬─────────────┘                                                                                                                                                                                                                                        
┌─────────────┴─────────────┐                                                                                                                                                                                                           
│         PROJECTION        │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│__internal_compress_integra│                                                                                                                                                                                                           
│    l_utinyint(#0, 1992)   │                                                                                                                                                                                                           
│             #1            │                                                                                                                                                                                                           
│             #2            │                                                                                                                                                                                                           
└─────────────┬─────────────┘                                                                                                                                                                                                                                        
┌─────────────┴─────────────┐                                                                                                                                                                                                           
│         PROJECTION        │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│     year(o_orderdate)     │                                                                                                                                                                                                           
│           volume          │                                                                                                                                                                                                           
│           nation          │                                                                                                                                                                                                           
└─────────────┬─────────────┘                                                                                                                                                                                                                                        
┌─────────────┴─────────────┐                                                                                                                                                                                                           
│         HASH_JOIN         │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│           INNER           │                                                                                                                                                                                                           
│ s_nationkey = n_nationkey │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐              
│        Build Min: 0       │                                                                                                                                                                                            │              
│       Build Max: 24       │                                                                                                                                                                                            │              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                            │              
│          EC: 508          │                                                                                                                                                                                            │              
└─────────────┬─────────────┘                                                                                                                                                                                            │                                           
┌─────────────┴─────────────┐                                                                                                                                                                              ┌─────────────┴─────────────┐
│         HASH_JOIN         │                                                                                                                                                                              │         SEQ_SCAN          │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│           INNER           │                                                                                                                                                                              │           nation          │
│   s_suppkey = l_suppkey   │                                                                                                                                                                              │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐                                                                                                                                                               │        n_nationkey        │
│        Build Min: 1       │              │                                                                                                                                                               │           n_name          │
│      Build Max: 10000     │              │                                                                                                                                                               │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                                                                                                                                               │           EC: 25          │
│          EC: 508          │              │                                                                                                                                                               │                           │
└─────────────┬─────────────┘              │                                                                                                                                                               └───────────────────────────┘                             
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                                                                                                              
│         SEQ_SCAN          ││         HASH_JOIN         │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│          supplier         ││           INNER           │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││ c_nationkey = n_nationkey │                                                                                                                                                                              
│         s_suppkey         ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├─────────────────────────────────────────────────────────────────────────────────────────────────────┐                                                                        
│        s_nationkey        ││        Build Min: 0       │                                                                                                     │                                                                        
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││       Build Max: 24       │                                                                                                     │                                                                        
│         EC: 10000         ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                     │                                                                        
│                           ││          EC: 512          │                                                                                                     │                                                                        
└───────────────────────────┘└─────────────┬─────────────┘                                                                                                     │                                                                                                     
                             ┌─────────────┴─────────────┐                                                                                       ┌─────────────┴─────────────┐                                                          
                             │         HASH_JOIN         │                                                                                       │         HASH_JOIN         │                                                          
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                             │           INNER           │                                                                                       │           INNER           │                                                          
                             │   c_custkey = o_custkey   │                                                                                       │ n_regionkey = r_regionkey │                                                          
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐                                                                        │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐                                           
                             │        Build Min: 1       │              │                                                                        │        Build Min: 0       │              │                                           
                             │     Build Max: 149999     │              │                                                                        │        Build Max: 4       │              │                                           
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                                                        │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                           
                             │          EC: 2562         │              │                                                                        │           EC: 5           │              │                                           
                             └─────────────┬─────────────┘              │                                                                        └─────────────┬─────────────┘              │                                                                        
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             
                             │         SEQ_SCAN          ││         HASH_JOIN         │                                                          │         SEQ_SCAN          ││         SEQ_SCAN          │                             
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                             │          customer         ││           INNER           │                                                          │           nation          ││           region          │                             
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││  o_orderkey = l_orderkey  │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                             │         c_custkey         ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │        n_nationkey        ││        r_regionkey        │                             
                             │        c_nationkey        ││          EC: 4249         ├──────────────┐                                           │        n_regionkey        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │              │                                           │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││ Filters: r_name='AMERICA' │                             
                             │ Filters: c_custkey<=149999││                           │              │                                           │           EC: 25          ││   AND r_name IS NOT NULL  │                             
                             │  AND c_custkey IS NOT NULL││                           │              │                                           │                           ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │              │                                           │                           ││           EC: 1           │                             
                             │         EC: 150000        ││                           │              │                                           │                           ││                           │                             
                             └───────────────────────────┘└─────────────┬─────────────┘              │                                           └───────────────────────────┘└───────────────────────────┘                                                          
                                                          ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                                                    
                                                          │         SEQ_SCAN          ││         HASH_JOIN         │                                                                                                                    
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
                                                          │           orders          ││           INNER           │                                                                                                                    
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   l_partkey = p_partkey   │                                                                                                                    
                                                          │         o_orderkey        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
                                                          │         o_custkey         ││        Build Min: 1       │                                                                                                                    
                                                          │        o_orderdate        ││     Build Max: 200000     │                                                                                                                    
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐                                                                                                     
                                                          │Filters: o_orderdate>='1995││         EC: 21246         │              │                                                                                                     
                                                          │     -01-01'::DATE AND     ││                           │              │                                                                                                     
                                                          │ o_orderdate<='1996-12...  ││                           │              │                                                                                                     
                                                          │   o_orderdate IS NOT NULL ││                           │              │                                                                                                     
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │              │                                                                                                     
                                                          │         EC: 300000        ││                           │              │                                                                                                     
                                                          └───────────────────────────┘└─────────────┬─────────────┘              │                                                                                                                                  
                                                                                       ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                       
                                                                                       │         SEQ_SCAN          ││         SEQ_SCAN          │                                                                                       
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
                                                                                       │          lineitem         ││            part           │                                                                                       
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
                                                                                       │         l_partkey         ││         p_partkey         │                                                                                       
                                                                                       │         l_suppkey         ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
                                                                                       │         l_orderkey        ││  Filters: p_type='ECONOMY │                                                                                       
                                                                                       │      l_extendedprice      ││ ANODIZED STEEL' AND p...  │                                                                                       
                                                                                       │         l_discount        ││          NOT NULL         │                                                                                       
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
                                                                                       │        EC: 6001215        ││          EC: 1325         │                                                                                       
                                                                                       └───────────────────────────┘└───────────────────────────┘                                                                                                                    

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

X {'RESULT_COLLECTOR0': 5e-06, 'PROJECTION1': 2e-06, 'ORDER_BY2': 2.7e-05, 'PROJECTION3': 2e-06, 'PROJECTION4': 1e-05, 'HASH_GROUP_BY5': 0.000971, 'PROJECTION6': 4e-06, 'PROJECTION7': 0.000158, 'PROJECTION8': 0.000126, 'PROJECTION9': 7e-06, 'FILTER10': 0.073806, 'HASH_JOIN11': 0.020104, 'HASH_JOIN12': 0.214686, 'SEQ_SCAN 13': 0.040539, 'HASH_JOIN14': 0.013846, 'SEQ_SCAN 15': 0.002334, 'HASH_JOIN16': 0.002879, 'SEQ_SCAN 17': 0.000475, 'SEQ_SCAN 18': 7e-06, 'HASH_JOIN19': 9.8e-05, 'SEQ_SCAN 20': 2.6e-05, 'SEQ_SCAN 21': 1.8e-05}
**** output size:  4
LINEAGE_4_FILTER_11
LINEAGE_4_HASH_GROUP_BY_16
LINEAGE_4_HASH_JOIN_10
LINEAGE_4_HASH_JOIN_4
LINEAGE_4_HASH_JOIN_5
LINEAGE_4_HASH_JOIN_6
LINEAGE_4_HASH_JOIN_9
LINEAGE_4_ORDER_BY_19
LINEAGE_4_SEQ_SCAN_0
LINEAGE_4_SEQ_SCAN_1
LINEAGE_4_SEQ_SCAN_2
LINEAGE_4_SEQ_SCAN_3
LINEAGE_4_SEQ_SCAN_7
LINEAGE_4_SEQ_SCAN_8
SELECT supp_nation, cust_nation, l_year, sum(volume) AS revenue FROM ( SELECT n1.n_name AS supp_nation, n2.n_name AS cust_nation, extract(year FROM l_shipdate) AS l_year, l_extendedprice * (1 - l_discount) AS volume FROM supplier, lineitem, orders, customer, nation n1, nation n2 WHERE s_suppkey = l_suppkey AND o_orderkey = l_orderkey AND c_custkey = o_custkey AND s_nationkey = n1.n_nationkey AND c_nationkey = n2.n_nationkey AND ((n1.n_name = 'FRANCE' AND n2.n_name = 'GERMANY') OR (n1.n_name = 'GERMANY' AND n2.n_name = 'FRANCE')) AND l_shipdate BETWEEN CAST('1995-01-01' AS date) AND CAST('1996-12-31' AS date)) AS shipping GROUP BY supp_nation, cust_nation, l_year ORDER BY supp_nation, cust_nation, l_year;
   query_id  ...                                               plan
0         4  ...  {"name": "PROJECTION", "opid": "20", "children...

[1 rows x 7 columns]
Query info:  query_id                                                            4
query               SELECT supp_nation, cust_nation, l_year, sum(v...
size_bytes_max                                               76032172
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "PROJECTION", "opid": "20", "children...
Name: 0, dtype: object
{"name": "PROJECTION", "opid": "20", "children": [{"name": "ORDER_BY", "opid": "19", "children": [{"name": "PROJECTION", "opid": "18", "children": [{"name": "PROJECTION", "opid": "17", "children": [{"name": "HASH_GROUP_BY", "opid": "16", "children": [{"name": "PROJECTION", "opid": "15", "children": [{"name": "PROJECTION", "opid": "14", "children": [{"name": "PROJECTION", "opid": "13", "children": [{"name": "PROJECTION", "opid": "12", "children": [{"name": "FILTER", "opid": "11", "children": [{"name": "HASH_JOIN", "opid": "10", "children": [{"name": "HASH_JOIN", "opid": "6", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_suppkey\nl_orderkey\nl_shipdate\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nFilters: l_shipdate>='1995-01-01'::DATE AND l_shipdate<='1996-12-31'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243"},{"name": "HASH_JOIN", "opid": "5", "children": [{"name": "SEQ_SCAN ", "opid": "1", "children": [],"table": "orders","extra": "orders\n[INFOSEPARATOR]\no_orderkey\no_custkey\n[INFOSEPARATOR]\nEC: 1500000"},{"name": "HASH_JOIN", "opid": "4", "children": [{"name": "SEQ_SCAN ", "opid": "2", "children": [],"table": "customer","extra": "customer\n[INFOSEPARATOR]\nc_custkey\nc_nationkey\n[INFOSEPARATOR]\nFilters: c_custkey<=149999 AND c_custkey IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 150000"},{"name": "SEQ_SCAN ", "opid": "3", "children": [],"table": "nation","extra": "nation\n[INFOSEPARATOR]\nn_nationkey\nn_name\n[INFOSEPARATOR]\nEC: 25"}],"table": "","extra": "INNER\nc_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nEC: 150000\n"}],"table": "","extra": "INNER\no_custkey = c_custkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 149999\n\n[INFOSEPARATOR]\nEC: 904486\n"}],"table": "","extra": "INNER\nl_orderkey = o_orderkey\n\n[INFOSEPARATOR]\nEC: 723735\n"},{"name": "HASH_JOIN", "opid": "9", "children": [{"name": "SEQ_SCAN ", "opid": "7", "children": [],"table": "supplier","extra": "supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\n[INFOSEPARATOR]\nEC: 10000"},{"name": "SEQ_SCAN ", "opid": "8", "children": [],"table": "nation","extra": "nation\n[INFOSEPARATOR]\nn_nationkey\nn_name\n[INFOSEPARATOR]\nEC: 25"}],"table": "","extra": "INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 10000\n"}],"table": "","extra": "INNER\nl_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 717564\n"}],"table": "","extra": "(((n_name = 'FRANCE') AND (n_name = 'GERMANY')) OR ((n_name = 'GERMANY') AND (n_name = 'FRANCE')))\n[INFOSEPARATOR]\nEC: 717564"}],"table": "","extra": "#2\n#3\n#4\n#6\n#8\n"}],"table": "","extra": "supp_nation\ncust_nation\nyear(l_shipdate)\nvolume\n"}],"table": "","extra": "__internal_compress_string_hugeint(#0)\n__internal_compress_string_hugeint(#1)\n__internal_compress_integral_utinyint(#2, 1992)\n#3\n"}],"table": "","extra": "supp_nation\ncust_nation\nl_year\nvolume\n"}],"table": "","extra": "#0\n#1\n#2\nsum(#3)"}],"table": "","extra": "__internal_decompress_string(#0)\n__internal_decompress_string(#1)\n__internal_decompress_integral_bigint(#2, 1992)\n#3\n"}],"table": "","extra": "__internal_compress_string_hugeint(#0)\n__internal_compress_string_hugeint(#1)\n__internal_compress_integral_utinyint(#2, 1992)\n#3\n"}],"table": "","extra": "ORDERS:\nshipping.supp_nation ASC\nshipping.cust_nation ASC\nshipping.l_year ASC"}],"table": "","extra": "__internal_decompress_string(#0)\n__internal_decompress_string(#1)\n__internal_decompress_integral_bigint(#2, 1992)\n#3\n"}
%%%%%%%%%%%%%%%% Running Query #  8  threads:  1
SELECT o_year, sum( CASE WHEN nation = 'BRAZIL' THEN volume ELSE 0 END) / sum(volume) AS mkt_share FROM ( SELECT extract(year FROM o_orderdate) AS o_year, l_extendedprice * (1 - l_discount) AS volume, n2.n_name AS nation FROM part, supplier, lineitem, orders, customer, nation n1, nation n2, region WHERE p_partkey = l_partkey AND s_suppkey = l_suppkey AND l_orderkey = o_orderkey AND o_custkey = c_custkey AND c_nationkey = n1.n_nationkey AND n1.n_regionkey = r_regionkey AND r_name = 'AMERICA' AND s_nationkey = n2.n_nationkey AND o_orderdate BETWEEN CAST('1995-01-01' AS date) AND CAST('1996-12-31' AS date) AND p_type = 'ECONOMY ANODIZED STEEL') AS all_nations GROUP BY o_year ORDER BY o_year;
Run:  None SELECT o_year, sum( CASE WHEN nation = 'BRAZIL' THEN volume ELSE 0 END) / sum(volume) AS mkt_share FROM ( SELECT extract(year FROM o_orderdate) AS o_year, l_extendedprice * (1 - l_discount) AS volume, n2.n_name AS nation FROM part, supplier, lineitem, orders, customer, nation n1, nation n2, region WHERE p_partkey = l_partkey AND s_suppkey = l_suppkey AND l_orderkey = o_orderkey AND o_custkey = c_custkey AND c_nationkey = n1.n_nationkey AND n1.n_regionkey = r_regionkey AND r_name = 'AMERICA' AND s_nationkey = n2.n_nationkey AND o_orderdate BETWEEN CAST('1995-01-01' AS date) AND CAST('1996-12-31' AS date) AND p_type = 'ECONOMY ANODIZED STEEL') AS all_nations GROUP BY o_year ORDER BY o_year;
Avg Time in sec:  0.11358473589643836  output size:  2
   o_year  mkt_share
0    1995   0.034436
1    1996   0.041486
{'name': 'Query', 'result': 0.109206, 'timing': 0.109206, 'cardinality': 0, 'extra-info': "SELECT o_year, sum( CASE WHEN nation = 'BRAZIL' THEN volume ELSE 0 END) / sum(volume) AS mkt_share FROM ( SELECT extract(year FROM o_orderdate) AS o_year, l_extendedprice * (1 - l_discount) AS volume, n2.n_name AS nation FROM part, supplier, lineitem, orders, customer, nation n1, nation n2, region WHERE p_partkey = l_partkey AND s_suppkey = l_suppkey AND l_orderkey = o_orderkey AND o_custkey = c_custkey AND c_nationkey = n1.n_nationkey AND n1.n_regionkey = r_regionkey AND r_name = 'AMERICA' AND s_nationkey = n2.n_nationkey AND o_orderdate BETWEEN CAST('1995-01-01' AS date) AND CAST('1996-12-31' AS date) AND p_type = 'ECONOMY ANODIZED STEEL') AS all_nations GROUP BY o_year ORDER BY o_year;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 4e-06, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 1e-06, 'cardinality': 2, 'extra_info': '__internal_decompress_integral_bigint(#0, 1992)\n#1\n', 'children': [{'name': 'ORDER_BY', 'timing': 4.3e-05, 'cardinality': 2, 'extra_info': 'ORDERS:\nall_nations.o_year ASC', 'children': [{'name': 'PROJECTION', 'timing': 1e-06, 'cardinality': 2, 'extra_info': '__internal_compress_integral_utinyint(#0, 1992)\n#1\n', 'children': [{'name': 'PROJECTION', 'timing': 1.8e-05, 'cardinality': 2, 'extra_info': 'o_year\nmkt_share\n', 'children': [{'name': 'PROJECTION', 'timing': 2e-06, 'cardinality': 2, 'extra_info': '__internal_decompress_integral_bigint(#0, 1992)\n#1\n#2\n', 'children': [{'name': 'PERFECT_HASH_GROUP_BY', 'timing': 3.8e-05, 'cardinality': 2, 'extra_info': '#0\nsum(#1)\nsum(#2)', 'children': [{'name': 'PROJECTION', 'timing': 4.4e-05, 'cardinality': 2603, 'extra_info': "o_year\nCASE  WHEN ((nation = 'BRAZIL')) THEN (volume) ELSE 0.0000 END\nvolume\n", 'children': [{'name': 'PROJECTION', 'timing': 1.2e-05, 'cardinality': 2603, 'extra_info': '__internal_compress_integral_utinyint(#0, 1992)\n#1\n#2\n', 'children': [{'name': 'PROJECTION', 'timing': 6.7e-05, 'cardinality': 2603, 'extra_info': 'year(o_orderdate)\nvolume\nnation\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.000104, 'cardinality': 2603, 'extra_info': 'INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 508\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.000536, 'cardinality': 2603, 'extra_info': 'INNER\ns_suppkey = l_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 508\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 2.8e-05, 'cardinality': 10000, 'extra_info': 'supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\n[INFOSEPARATOR]\nEC: 10000', 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.000554, 'cardinality': 2603, 'extra_info': 'INNER\nc_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 512\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.004111, 'cardinality': 13389, 'extra_info': 'INNER\nc_custkey = o_custkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 149999\n\n[INFOSEPARATOR]\nEC: 2562\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.000469, 'cardinality': 149999, 'extra_info': 'customer\n[INFOSEPARATOR]\nc_custkey\nc_nationkey\n[INFOSEPARATOR]\nFilters: c_custkey<=149999 AND c_custkey IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 150000', 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.017456, 'cardinality': 13389, 'extra_info': 'INNER\no_orderkey = l_orderkey\n\n[INFOSEPARATOR]\nEC: 4249\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.014396, 'cardinality': 457263, 'extra_info': "orders\n[INFOSEPARATOR]\no_orderkey\no_custkey\no_orderdate\n[INFOSEPARATOR]\nFilters: o_orderdate>='1995-01-01'::DATE AND o_orderdate<='1996-12-31'::DATE AND o_orderdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 300000", 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.04228, 'cardinality': 43693, 'extra_info': 'INNER\nl_partkey = p_partkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 21246\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.011998, 'cardinality': 6001215, 'extra_info': 'lineitem\n[INFOSEPARATOR]\nl_partkey\nl_suppkey\nl_orderkey\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nEC: 6001215', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 0.003767, 'cardinality': 1451, 'extra_info': "part\n[INFOSEPARATOR]\np_partkey\n[INFOSEPARATOR]\nFilters: p_type='ECONOMY ANODIZED STEEL' AND p_type IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1325", 'children': []}]}]}]}, {'name': 'HASH_JOIN', 'timing': 2.8e-05, 'cardinality': 5, 'extra_info': 'INNER\nn_regionkey = r_regionkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 4\n\n[INFOSEPARATOR]\nEC: 5\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 9e-06, 'cardinality': 25, 'extra_info': 'nation\n[INFOSEPARATOR]\nn_nationkey\nn_regionkey\n[INFOSEPARATOR]\nEC: 25', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 1.2e-05, 'cardinality': 1, 'extra_info': "region\n[INFOSEPARATOR]\nr_regionkey\n[INFOSEPARATOR]\nFilters: r_name='AMERICA' AND r_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1", 'children': []}]}]}]}, {'name': 'SEQ_SCAN ', 'timing': 1.9e-05, 'cardinality': 25, 'extra_info': 'nation\n[INFOSEPARATOR]\nn_nationkey\nn_name\n[INFOSEPARATOR]\nEC: 25', 'children': []}]}]}]}]}]}]}]}]}]}]}]}]}
uncompressed filter_log_size: 1560
uncompressed filter_log_buffer_size: 0
uncompressed limit_offset_size: 1560
uncompressed limit_offset_buffer_size: 0
uncompressed perfect_full_scan_ht_log_size: 25752
uncompressed perfect_full_scan_ht_log_buffer_size: 23936
uncompressed perfect_probe_ht_log_size: 528504
uncompressed perfect_probe_ht_log_buffer_size: 391232
uncompressed row_group_log_size: 2608800
uncompressed row_group_log_buffer_size: 2434856
uncompressed scatter_log_size: 22640
uncompressed scatter_log_buffer_size: 20824
uncompressed scatter_sel_log_size: 741160
uncompressed scatter_sel_log_buffer_size: 734000
uncompressed gather_log_size: 1560
uncompressed gather_log_buffer_size: 0
uncompressed combine_log_size: 1616
uncompressed combine_log_buffer_size: 32
uncompressed finalize_states_log_size: 1592
uncompressed finalize_states_log_buffer_size: 16
uncompressed join_gather_log_size: 437076
uncompressed join_gather_log_buffer_size: 352572
uncompressed reorder_log_size: 1600
uncompressed reorder_log_buffer_size: 0
uncompressed cross_log_size: 1560
uncompressed cross_log_buffer_size: 0
uncompressed nlj_log_size: 1560
uncompressed nlj_log_buffer_size: 0
uncompressed total_size: 4376540
uncompressed total_buffer_size: 3957468
uncompressed total_element_size: 419072

Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│__internal_decompress_strin│                                                                                                                                                 
│           g(#0)           │                                                                                                                                                 
│__internal_decompress_integ│                                                                                                                                                 
│    ral_bigint(#1, 1992)   │                                                                                                                                                 
│             #2            │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│          ORDER_BY         │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│          ORDERS:          │                                                                                                                                                 
│     profit.nation ASC     │                                                                                                                                                 
│     profit.o_year DESC    │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│__internal_compress_string_│                                                                                                                                                 
│        hugeint(#0)        │                                                                                                                                                 
│__internal_compress_integra│                                                                                                                                                 
│    l_utinyint(#1, 1992)   │                                                                                                                                                 
│             #2            │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│__internal_decompress_strin│                                                                                                                                                 
│           g(#0)           │                                                                                                                                                 
│__internal_decompress_integ│                                                                                                                                                 
│    ral_bigint(#1, 1992)   │                                                                                                                                                 
│             #2            │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│       HASH_GROUP_BY       │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│             #0            │                                                                                                                                                 
│             #1            │                                                                                                                                                 
│          sum(#2)          │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│           nation          │                                                                                                                                                 
│           o_year          │                                                                                                                                                 
│           amount          │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│__internal_compress_string_│                                                                                                                                                 
│        hugeint(#0)        │                                                                                                                                                 
│__internal_compress_integra│                                                                                                                                                 
│    l_utinyint(#1, 1992)   │                                                                                                                                                 
│             #2            │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│           nation          │                                                                                                                                                 
│     year(o_orderdate)     │                                                                                                                                                 
│           amount          │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         HASH_JOIN         │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│           INNER           │                                                                                                                                                 
│  o_orderkey = l_orderkey  ├──────────────┐                                                                                                                                  
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                                                                                                                  
│        EC: 1191610        │              │                                                                                                                                  
└─────────────┬─────────────┘              │                                                                                                                                                               
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                                                    
│         SEQ_SCAN          ││         HASH_JOIN         │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│           orders          ││           INNER           │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   l_suppkey = ps_suppkey  │                                                                                                                    
│         o_orderkey        ││   l_partkey = ps_partkey  ├──────────────┐                                                                                                     
│        o_orderdate        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                                                                                     
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││        EC: 1191610        │              │                                                                                                     
│        EC: 1500000        ││                           │              │                                                                                                     
└───────────────────────────┘└─────────────┬─────────────┘              │                                                                                                                                  
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                       
                             │         SEQ_SCAN          ││         HASH_JOIN         │                                                                                       
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
                             │          lineitem         ││           INNER           │                                                                                       
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ps_suppkey = s_suppkey  │                                                                                       
                             │         l_suppkey         ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
                             │         l_partkey         ││        Build Min: 1       │                                                                                       
                             │         l_orderkey        ││      Build Max: 10000     ├───────────────────────────────────────────┐                                           
                             │      l_extendedprice      ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                           │                                           
                             │         l_discount        ││         EC: 74312         │                                           │                                           
                             │         l_quantity        ││                           │                                           │                                           
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                           │                                           
                             │        EC: 6001215        ││                           │                                           │                                           
                             └───────────────────────────┘└─────────────┬─────────────┘                                           │                                                                        
                                                          ┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐                             
                                                          │         HASH_JOIN         │                             │         HASH_JOIN         │                             
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                                                          │           INNER           │                             │           INNER           │                             
                                                          │   ps_partkey = p_partkey  │                             │ s_nationkey = n_nationkey │                             
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐              │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐              
                                                          │        Build Min: 1       │              │              │        Build Min: 0       │              │              
                                                          │     Build Max: 200000     │              │              │       Build Max: 24       │              │              
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              
                                                          │         EC: 85503         │              │              │         EC: 10000         │              │              
                                                          └─────────────┬─────────────┘              │              └─────────────┬─────────────┘              │                                           
                                                          ┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐
                                                          │         SEQ_SCAN          ││           FILTER          ││         SEQ_SCAN          ││         SEQ_SCAN          │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │          partsupp         ││ contains(p_name, 'green') ││          supplier         ││           nation          │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │         ps_suppkey        ││         EC: 40000         ││         s_suppkey         ││        n_nationkey        │
                                                          │         ps_partkey        ││                           ││        s_nationkey        ││           n_name          │
                                                          │       ps_supplycost       ││                           ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           ││         EC: 10000         ││           EC: 25          │
                                                          │         EC: 800000        ││                           ││                           ││                           │
                                                          └───────────────────────────┘└─────────────┬─────────────┘└───────────────────────────┘└───────────────────────────┘                             
                                                                                       ┌─────────────┴─────────────┐                                                          
                                                                                       │         SEQ_SCAN          │                                                          
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                                                       │            part           │                                                          
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                                                       │         p_partkey         │                                                          
                                                                                       │           p_name          │                                                          
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                                                       │         EC: 40000         │                                                          
                                                                                       └───────────────────────────┘                                                                                       

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

X {'RESULT_COLLECTOR0': 4e-06, 'PROJECTION1': 1e-06, 'ORDER_BY2': 4.3e-05, 'PROJECTION3': 1e-06, 'PROJECTION4': 1.8e-05, 'PROJECTION5': 2e-06, 'PERFECT_HASH_GROUP_BY6': 3.8e-05, 'PROJECTION7': 4.4e-05, 'PROJECTION8': 1.2e-05, 'PROJECTION9': 6.7e-05, 'HASH_JOIN10': 0.000104, 'HASH_JOIN11': 0.000536, 'SEQ_SCAN 12': 2.8e-05, 'HASH_JOIN13': 0.000554, 'HASH_JOIN14': 0.004111, 'SEQ_SCAN 15': 0.000469, 'HASH_JOIN16': 0.017456, 'SEQ_SCAN 17': 0.014396, 'HASH_JOIN18': 0.04228, 'SEQ_SCAN 19': 0.011998, 'SEQ_SCAN 20': 0.003767, 'HASH_JOIN21': 2.8e-05, 'SEQ_SCAN 22': 9e-06, 'SEQ_SCAN 23': 1.2e-05, 'SEQ_SCAN 24': 1.9e-05}
**** output size:  2
LINEAGE_4_HASH_JOIN_10
LINEAGE_4_HASH_JOIN_11
LINEAGE_4_HASH_JOIN_12
LINEAGE_4_HASH_JOIN_14
LINEAGE_4_HASH_JOIN_5
LINEAGE_4_HASH_JOIN_6
LINEAGE_4_HASH_JOIN_7
LINEAGE_4_ORDER_BY_22
LINEAGE_4_PERFECT_HASH_GROUP_BY_18
LINEAGE_4_SEQ_SCAN_0
LINEAGE_4_SEQ_SCAN_1
LINEAGE_4_SEQ_SCAN_13
LINEAGE_4_SEQ_SCAN_2
LINEAGE_4_SEQ_SCAN_3
LINEAGE_4_SEQ_SCAN_4
LINEAGE_4_SEQ_SCAN_8
LINEAGE_4_SEQ_SCAN_9
SELECT o_year, sum( CASE WHEN nation = 'BRAZIL' THEN volume ELSE 0 END) / sum(volume) AS mkt_share FROM ( SELECT extract(year FROM o_orderdate) AS o_year, l_extendedprice * (1 - l_discount) AS volume, n2.n_name AS nation FROM part, supplier, lineitem, orders, customer, nation n1, nation n2, region WHERE p_partkey = l_partkey AND s_suppkey = l_suppkey AND l_orderkey = o_orderkey AND o_custkey = c_custkey AND c_nationkey = n1.n_nationkey AND n1.n_regionkey = r_regionkey AND r_name = 'AMERICA' AND s_nationkey = n2.n_nationkey AND o_orderdate BETWEEN CAST('1995-01-01' AS date) AND CAST('1996-12-31' AS date) AND p_type = 'ECONOMY ANODIZED STEEL') AS all_nations GROUP BY o_year ORDER BY o_year;
   query_id  ...                                               plan
0         4  ...  {"name": "PROJECTION", "opid": "23", "children...

[1 rows x 7 columns]
Query info:  query_id                                                            4
query               SELECT o_year, sum( CASE WHEN nation = 'BRAZIL...
size_bytes_max                                                4376540
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "PROJECTION", "opid": "23", "children...
Name: 0, dtype: object
{"name": "PROJECTION", "opid": "23", "children": [{"name": "ORDER_BY", "opid": "22", "children": [{"name": "PROJECTION", "opid": "21", "children": [{"name": "PROJECTION", "opid": "20", "children": [{"name": "PROJECTION", "opid": "19", "children": [{"name": "PERFECT_HASH_GROUP_BY", "opid": "18", "children": [{"name": "PROJECTION", "opid": "17", "children": [{"name": "PROJECTION", "opid": "16", "children": [{"name": "PROJECTION", "opid": "15", "children": [{"name": "HASH_JOIN", "opid": "14", "children": [{"name": "HASH_JOIN", "opid": "12", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "supplier","extra": "supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\n[INFOSEPARATOR]\nEC: 10000"},{"name": "HASH_JOIN", "opid": "11", "children": [{"name": "HASH_JOIN", "opid": "7", "children": [{"name": "SEQ_SCAN ", "opid": "1", "children": [],"table": "customer","extra": "customer\n[INFOSEPARATOR]\nc_custkey\nc_nationkey\n[INFOSEPARATOR]\nFilters: c_custkey<=149999 AND c_custkey IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 150000"},{"name": "HASH_JOIN", "opid": "6", "children": [{"name": "SEQ_SCAN ", "opid": "2", "children": [],"table": "orders","extra": "orders\n[INFOSEPARATOR]\no_orderkey\no_custkey\no_orderdate\n[INFOSEPARATOR]\nFilters: o_orderdate>='1995-01-01'::DATE AND o_orderdate<='1996-12-31'::DATE AND o_orderdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 300000"},{"name": "HASH_JOIN", "opid": "5", "children": [{"name": "SEQ_SCAN ", "opid": "3", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_partkey\nl_suppkey\nl_orderkey\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nEC: 6001215"},{"name": "SEQ_SCAN ", "opid": "4", "children": [],"table": "part","extra": "part\n[INFOSEPARATOR]\np_partkey\n[INFOSEPARATOR]\nFilters: p_type='ECONOMY ANODIZED STEEL' AND p_type IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1325"}],"table": "","extra": "INNER\nl_partkey = p_partkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 21246\n"}],"table": "","extra": "INNER\no_orderkey = l_orderkey\n\n[INFOSEPARATOR]\nEC: 4249\n"}],"table": "","extra": "INNER\nc_custkey = o_custkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 149999\n\n[INFOSEPARATOR]\nEC: 2562\n"},{"name": "HASH_JOIN", "opid": "10", "children": [{"name": "SEQ_SCAN ", "opid": "8", "children": [],"table": "nation","extra": "nation\n[INFOSEPARATOR]\nn_nationkey\nn_regionkey\n[INFOSEPARATOR]\nEC: 25"},{"name": "SEQ_SCAN ", "opid": "9", "children": [],"table": "region","extra": "region\n[INFOSEPARATOR]\nr_regionkey\n[INFOSEPARATOR]\nFilters: r_name='AMERICA' AND r_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1"}],"table": "","extra": "INNER\nn_regionkey = r_regionkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 4\n\n[INFOSEPARATOR]\nEC: 5\n"}],"table": "","extra": "INNER\nc_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 512\n"}],"table": "","extra": "INNER\ns_suppkey = l_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 508\n"},{"name": "SEQ_SCAN ", "opid": "13", "children": [],"table": "nation","extra": "nation\n[INFOSEPARATOR]\nn_nationkey\nn_name\n[INFOSEPARATOR]\nEC: 25"}],"table": "","extra": "INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 508\n"}],"table": "","extra": "year(o_orderdate)\nvolume\nnation\n"}],"table": "","extra": "__internal_compress_integral_utinyint(#0, 1992)\n#1\n#2\n"}],"table": "","extra": "o_year\nCASE  WHEN ((nation = 'BRAZIL')) THEN (volume) ELSE 0.0000 END\nvolume\n"}],"table": "","extra": "#0\nsum(#1)\nsum(#2)"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1992)\n#1\n#2\n"}],"table": "","extra": "o_year\nmkt_share\n"}],"table": "","extra": "__internal_compress_integral_utinyint(#0, 1992)\n#1\n"}],"table": "","extra": "ORDERS:\nall_nations.o_year ASC"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1992)\n#1\n"}
%%%%%%%%%%%%%%%% Running Query #  9  threads:  1
SELECT nation, o_year, sum(amount) AS sum_profit FROM ( SELECT n_name AS nation, extract(year FROM o_orderdate) AS o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity AS amount FROM part, supplier, lineitem, partsupp, orders, nation WHERE s_suppkey = l_suppkey AND ps_suppkey = l_suppkey AND ps_partkey = l_partkey AND p_partkey = l_partkey AND o_orderkey = l_orderkey AND s_nationkey = n_nationkey AND p_name LIKE '%green%') AS profit GROUP BY nation, o_year ORDER BY nation, o_year DESC;
Run:  None SELECT nation, o_year, sum(amount) AS sum_profit FROM ( SELECT n_name AS nation, extract(year FROM o_orderdate) AS o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity AS amount FROM part, supplier, lineitem, partsupp, orders, nation WHERE s_suppkey = l_suppkey AND ps_suppkey = l_suppkey AND ps_partkey = l_partkey AND p_partkey = l_partkey AND o_orderkey = l_orderkey AND s_nationkey = n_nationkey AND p_name LIKE '%green%') AS profit GROUP BY nation, o_year ORDER BY nation, o_year DESC;
Avg Time in sec:  0.4026293340139091  output size:  175
      nation  o_year    sum_profit
0    ALGERIA    1998  2.713690e+07
1    ALGERIA    1997  4.861183e+07
2    ALGERIA    1996  4.828548e+07
3    ALGERIA    1995  4.440227e+07
4    ALGERIA    1994  4.869401e+07
..       ...     ...           ...
170  VIETNAM    1996  4.782460e+07
171  VIETNAM    1995  4.823514e+07
172  VIETNAM    1994  4.772926e+07
173  VIETNAM    1993  4.535268e+07
174  VIETNAM    1992  4.784636e+07

[175 rows x 3 columns]
{'name': 'Query', 'result': 0.394693, 'timing': 0.394693, 'cardinality': 0, 'extra-info': "SELECT nation, o_year, sum(amount) AS sum_profit FROM ( SELECT n_name AS nation, extract(year FROM o_orderdate) AS o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity AS amount FROM part, supplier, lineitem, partsupp, orders, nation WHERE s_suppkey = l_suppkey AND ps_suppkey = l_suppkey AND ps_partkey = l_partkey AND p_partkey = l_partkey AND o_orderkey = l_orderkey AND s_nationkey = n_nationkey AND p_name LIKE '%green%') AS profit GROUP BY nation, o_year ORDER BY nation, o_year DESC;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 1e-05, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 7e-06, 'cardinality': 175, 'extra_info': '__internal_decompress_string(#0)\n__internal_decompress_integral_bigint(#1, 1992)\n#2\n', 'children': [{'name': 'ORDER_BY', 'timing': 3.5e-05, 'cardinality': 175, 'extra_info': 'ORDERS:\nprofit.nation ASC\nprofit.o_year DESC', 'children': [{'name': 'PROJECTION', 'timing': 4e-06, 'cardinality': 175, 'extra_info': '__internal_compress_string_hugeint(#0)\n__internal_compress_integral_utinyint(#1, 1992)\n#2\n', 'children': [{'name': 'PROJECTION', 'timing': 9e-06, 'cardinality': 175, 'extra_info': '__internal_decompress_string(#0)\n__internal_decompress_integral_bigint(#1, 1992)\n#2\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.015505, 'cardinality': 175, 'extra_info': '#0\n#1\nsum(#2)', 'children': [{'name': 'PROJECTION', 'timing': 0.000509, 'cardinality': 319404, 'extra_info': 'nation\no_year\namount\n', 'children': [{'name': 'PROJECTION', 'timing': 0.004969, 'cardinality': 319404, 'extra_info': '__internal_compress_string_hugeint(#0)\n__internal_compress_integral_utinyint(#1, 1992)\n#2\n', 'children': [{'name': 'PROJECTION', 'timing': 0.010246, 'cardinality': 319404, 'extra_info': 'nation\nyear(o_orderdate)\namount\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.128589, 'cardinality': 319404, 'extra_info': 'INNER\no_orderkey = l_orderkey\n\n[INFOSEPARATOR]\nEC: 1191610\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.002338, 'cardinality': 1500000, 'extra_info': 'orders\n[INFOSEPARATOR]\no_orderkey\no_orderdate\n[INFOSEPARATOR]\nEC: 1500000', 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.169354, 'cardinality': 319404, 'extra_info': 'INNER\nl_suppkey = ps_suppkey\nl_partkey = ps_partkey\n\n[INFOSEPARATOR]\nEC: 1191610\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.013957, 'cardinality': 6001215, 'extra_info': 'lineitem\n[INFOSEPARATOR]\nl_suppkey\nl_partkey\nl_orderkey\nl_extendedprice\nl_discount\nl_quantity\n[INFOSEPARATOR]\nEC: 6001215', 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.001335, 'cardinality': 42656, 'extra_info': 'INNER\nps_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 74312\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.00311, 'cardinality': 42656, 'extra_info': 'INNER\nps_partkey = p_partkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 85503\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.001092, 'cardinality': 800000, 'extra_info': 'partsupp\n[INFOSEPARATOR]\nps_suppkey\nps_partkey\nps_supplycost\n[INFOSEPARATOR]\nEC: 800000', 'children': []}, {'name': 'FILTER', 'timing': 0.006966, 'cardinality': 10664, 'extra_info': "contains(p_name, 'green')\n[INFOSEPARATOR]\nEC: 40000", 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.00366, 'cardinality': 200000, 'extra_info': 'part\n[INFOSEPARATOR]\np_partkey\np_name\n[INFOSEPARATOR]\nEC: 40000', 'children': []}]}]}, {'name': 'HASH_JOIN', 'timing': 0.000104, 'cardinality': 10000, 'extra_info': 'INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 10000\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 2.8e-05, 'cardinality': 10000, 'extra_info': 'supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\n[INFOSEPARATOR]\nEC: 10000', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 2e-05, 'cardinality': 25, 'extra_info': 'nation\n[INFOSEPARATOR]\nn_nationkey\nn_name\n[INFOSEPARATOR]\nEC: 25', 'children': []}]}]}]}]}]}]}]}]}]}]}]}]}]}]}
uncompressed filter_log_size: 47072
uncompressed filter_log_buffer_size: 42656
uncompressed limit_offset_size: 1344
uncompressed limit_offset_buffer_size: 0
uncompressed perfect_full_scan_ht_log_size: 332728
uncompressed perfect_full_scan_ht_log_buffer_size: 331192
uncompressed perfect_probe_ht_log_size: 764096
uncompressed perfect_probe_ht_log_buffer_size: 729728
uncompressed row_group_log_size: 185952
uncompressed row_group_log_buffer_size: 0
uncompressed scatter_log_size: 2589344
uncompressed scatter_log_buffer_size: 2555232
uncompressed scatter_sel_log_size: 4746172
uncompressed scatter_sel_log_buffer_size: 4592988
uncompressed gather_log_size: 1344
uncompressed gather_log_buffer_size: 0
uncompressed combine_log_size: 1344
uncompressed combine_log_buffer_size: 0
uncompressed finalize_states_log_size: 2760
uncompressed finalize_states_log_buffer_size: 1400
uncompressed join_gather_log_size: 8322400
uncompressed join_gather_log_buffer_size: 7665696
uncompressed reorder_log_size: 2768
uncompressed reorder_log_buffer_size: 0
uncompressed cross_log_size: 1344
uncompressed cross_log_buffer_size: 0
uncompressed nlj_log_size: 1344
uncompressed nlj_log_buffer_size: 0
uncompressed total_size: 17000012
uncompressed total_buffer_size: 15918892
uncompressed total_element_size: 1081120

Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐                                                                                       
│      STREAMING_LIMIT      │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│__internal_decompress_integ│                                                                                       
│     ral_bigint(#0, 1)     │                                                                                       
│             #1            │                                                                                       
│             #2            │                                                                                       
│             #3            │                                                                                       
│__internal_decompress_strin│                                                                                       
│           g(#4)           │                                                                                       
│             #5            │                                                                                       
│__internal_decompress_strin│                                                                                       
│           g(#6)           │                                                                                       
│             #7            │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│          ORDER_BY         │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│          ORDERS:          │                                                                                       
│       sum((lineitem       │                                                                                       
│.l_extendedprice * (1 ...  │                                                                                       
│    .l_discount))) DESC    │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│__internal_compress_integra│                                                                                       
│     l_uinteger(#0, 1)     │                                                                                       
│             #1            │                                                                                       
│             #2            │                                                                                       
│             #3            │                                                                                       
│__internal_compress_string_│                                                                                       
│        hugeint(#4)        │                                                                                       
│             #5            │                                                                                       
│__internal_compress_string_│                                                                                       
│        hugeint(#6)        │                                                                                       
│             #7            │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│         c_custkey         │                                                                                       
│           c_name          │                                                                                       
│          revenue          │                                                                                       
│         c_acctbal         │                                                                                       
│           n_name          │                                                                                       
│         c_address         │                                                                                       
│          c_phone          │                                                                                       
│         c_comment         │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│__internal_decompress_integ│                                                                                       
│     ral_bigint(#0, 1)     │                                                                                       
│             #1            │                                                                                       
│             #2            │                                                                                       
│__internal_decompress_strin│                                                                                       
│           g(#3)           │                                                                                       
│__internal_decompress_strin│                                                                                       
│           g(#4)           │                                                                                       
│             #5            │                                                                                       
│             #6            │                                                                                       
│             #7            │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│       HASH_GROUP_BY       │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│             #0            │                                                                                       
│             #1            │                                                                                       
│             #2            │                                                                                       
│             #3            │                                                                                       
│             #4            │                                                                                       
│             #5            │                                                                                       
│             #6            │                                                                                       
│          sum(#7)          │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│         c_custkey         │                                                                                       
│           c_name          │                                                                                       
│         c_acctbal         │                                                                                       
│          c_phone          │                                                                                       
│           n_name          │                                                                                       
│         c_address         │                                                                                       
│         c_comment         │                                                                                       
│ (l_extendedprice * (1.00 -│                                                                                       
│        l_discount))       │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│__internal_compress_integra│                                                                                       
│     l_uinteger(#0, 1)     │                                                                                       
│             #1            │                                                                                       
│             #2            │                                                                                       
│__internal_compress_integra│                                                                                       
│     l_uinteger(#3, 1)     │                                                                                       
│__internal_compress_integra│                                                                                       
│     l_uinteger(#4, 1)     │                                                                                       
│             #5            │                                                                                       
│             #6            │                                                                                       
│__internal_compress_string_│                                                                                       
│        hugeint(#7)        │                                                                                       
│             #8            │                                                                                       
│             #9            │                                                                                       
│__internal_compress_string_│                                                                                       
│        hugeint(#10)       │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         HASH_JOIN         │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│           INNER           │                                                                                       
│  l_orderkey = o_orderkey  ├──────────────┐                                                                        
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                                                        
│         EC: 241245        │              │                                                                        
└─────────────┬─────────────┘              │                                                                                                     
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                          
│         SEQ_SCAN          ││         HASH_JOIN         │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│          lineitem         ││           INNER           │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   o_custkey = c_custkey   │                                                          
│         l_orderkey        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│      l_extendedprice      ││        Build Min: 1       │                                                          
│         l_discount        ││     Build Max: 149999     ├──────────────┐                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                           
│ Filters: l_returnflag='R' ││         EC: 180897        │              │                                           
│ AND l_returnflag IS N...  ││                           │              │                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │              │                                           
│        EC: 2000405        ││                           │              │                                           
└───────────────────────────┘└─────────────┬─────────────┘              │                                                                        
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             
                             │         SEQ_SCAN          ││         HASH_JOIN         │                             
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                             │           orders          ││           INNER           │                             
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││ c_nationkey = n_nationkey │                             
                             │         o_custkey         ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                             │         o_orderkey        ││         EC: 150000        │                             
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           ├──────────────┐              
                             │Filters: o_orderdate>='1993││                           │              │              
                             │     -10-01'::DATE AND     ││                           │              │              
                             │ o_orderdate<'1994-01-...  ││                           │              │              
                             │   o_orderdate IS NOT NULL ││                           │              │              
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │              │              
                             │         EC: 300000        ││                           │              │              
                             └───────────────────────────┘└─────────────┬─────────────┘              │                                           
                                                          ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
                                                          │         SEQ_SCAN          ││         SEQ_SCAN          │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │          customer         ││           nation          │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │         c_custkey         ││        n_nationkey        │
                                                          │        c_nationkey        ││           n_name          │
                                                          │           c_name          ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │         c_acctbal         ││           EC: 25          │
                                                          │          c_phone          ││                           │
                                                          │         c_address         ││                           │
                                                          │         c_comment         ││                           │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │
                                                          │ Filters: c_custkey<=149999││                           │
                                                          │  AND c_custkey IS NOT NULL││                           │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │
                                                          │         EC: 150000        ││                           │
                                                          └───────────────────────────┘└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

X {'RESULT_COLLECTOR0': 1e-05, 'PROJECTION1': 7e-06, 'ORDER_BY2': 3.5e-05, 'PROJECTION3': 4e-06, 'PROJECTION4': 9e-06, 'HASH_GROUP_BY5': 0.015505, 'PROJECTION6': 0.000509, 'PROJECTION7': 0.004969, 'PROJECTION8': 0.010246, 'HASH_JOIN9': 0.128589, 'SEQ_SCAN 10': 0.002338, 'HASH_JOIN11': 0.169354, 'SEQ_SCAN 12': 0.013957, 'HASH_JOIN13': 0.001335, 'HASH_JOIN14': 0.00311, 'SEQ_SCAN 15': 0.001092, 'FILTER16': 0.006966, 'SEQ_SCAN 17': 0.00366, 'HASH_JOIN18': 0.000104, 'SEQ_SCAN 19': 2.8e-05, 'SEQ_SCAN 20': 2e-05}
**** output size:  175
LINEAGE_4_FILTER_4
LINEAGE_4_HASH_GROUP_BY_15
LINEAGE_4_HASH_JOIN_10
LINEAGE_4_HASH_JOIN_11
LINEAGE_4_HASH_JOIN_5
LINEAGE_4_HASH_JOIN_8
LINEAGE_4_HASH_JOIN_9
LINEAGE_4_ORDER_BY_18
LINEAGE_4_SEQ_SCAN_0
LINEAGE_4_SEQ_SCAN_1
LINEAGE_4_SEQ_SCAN_2
LINEAGE_4_SEQ_SCAN_3
LINEAGE_4_SEQ_SCAN_6
LINEAGE_4_SEQ_SCAN_7
SELECT nation, o_year, sum(amount) AS sum_profit FROM ( SELECT n_name AS nation, extract(year FROM o_orderdate) AS o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity AS amount FROM part, supplier, lineitem, partsupp, orders, nation WHERE s_suppkey = l_suppkey AND ps_suppkey = l_suppkey AND ps_partkey = l_partkey AND p_partkey = l_partkey AND o_orderkey = l_orderkey AND s_nationkey = n_nationkey AND p_name LIKE '%green%') AS profit GROUP BY nation, o_year ORDER BY nation, o_year DESC;
   query_id  ...                                               plan
0         4  ...  {"name": "PROJECTION", "opid": "19", "children...

[1 rows x 7 columns]
Query info:  query_id                                                            4
query               SELECT nation, o_year, sum(amount) AS sum_prof...
size_bytes_max                                               17000012
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "PROJECTION", "opid": "19", "children...
Name: 0, dtype: object
{"name": "PROJECTION", "opid": "19", "children": [{"name": "ORDER_BY", "opid": "18", "children": [{"name": "PROJECTION", "opid": "17", "children": [{"name": "PROJECTION", "opid": "16", "children": [{"name": "HASH_GROUP_BY", "opid": "15", "children": [{"name": "PROJECTION", "opid": "14", "children": [{"name": "PROJECTION", "opid": "13", "children": [{"name": "PROJECTION", "opid": "12", "children": [{"name": "HASH_JOIN", "opid": "11", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "orders","extra": "orders\n[INFOSEPARATOR]\no_orderkey\no_orderdate\n[INFOSEPARATOR]\nEC: 1500000"},{"name": "HASH_JOIN", "opid": "10", "children": [{"name": "SEQ_SCAN ", "opid": "1", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_suppkey\nl_partkey\nl_orderkey\nl_extendedprice\nl_discount\nl_quantity\n[INFOSEPARATOR]\nEC: 6001215"},{"name": "HASH_JOIN", "opid": "9", "children": [{"name": "HASH_JOIN", "opid": "5", "children": [{"name": "SEQ_SCAN ", "opid": "2", "children": [],"table": "partsupp","extra": "partsupp\n[INFOSEPARATOR]\nps_suppkey\nps_partkey\nps_supplycost\n[INFOSEPARATOR]\nEC: 800000"},{"name": "FILTER", "opid": "4", "children": [{"name": "SEQ_SCAN ", "opid": "3", "children": [],"table": "part","extra": "part\n[INFOSEPARATOR]\np_partkey\np_name\n[INFOSEPARATOR]\nEC: 40000"}],"table": "","extra": "contains(p_name, 'green')\n[INFOSEPARATOR]\nEC: 40000"}],"table": "","extra": "INNER\nps_partkey = p_partkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 85503\n"},{"name": "HASH_JOIN", "opid": "8", "children": [{"name": "SEQ_SCAN ", "opid": "6", "children": [],"table": "supplier","extra": "supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\n[INFOSEPARATOR]\nEC: 10000"},{"name": "SEQ_SCAN ", "opid": "7", "children": [],"table": "nation","extra": "nation\n[INFOSEPARATOR]\nn_nationkey\nn_name\n[INFOSEPARATOR]\nEC: 25"}],"table": "","extra": "INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 10000\n"}],"table": "","extra": "INNER\nps_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 74312\n"}],"table": "","extra": "INNER\nl_suppkey = ps_suppkey\nl_partkey = ps_partkey\n\n[INFOSEPARATOR]\nEC: 1191610\n"}],"table": "","extra": "INNER\no_orderkey = l_orderkey\n\n[INFOSEPARATOR]\nEC: 1191610\n"}],"table": "","extra": "nation\nyear(o_orderdate)\namount\n"}],"table": "","extra": "__internal_compress_string_hugeint(#0)\n__internal_compress_integral_utinyint(#1, 1992)\n#2\n"}],"table": "","extra": "nation\no_year\namount\n"}],"table": "","extra": "#0\n#1\nsum(#2)"}],"table": "","extra": "__internal_decompress_string(#0)\n__internal_decompress_integral_bigint(#1, 1992)\n#2\n"}],"table": "","extra": "__internal_compress_string_hugeint(#0)\n__internal_compress_integral_utinyint(#1, 1992)\n#2\n"}],"table": "","extra": "ORDERS:\nprofit.nation ASC\nprofit.o_year DESC"}],"table": "","extra": "__internal_decompress_string(#0)\n__internal_decompress_integral_bigint(#1, 1992)\n#2\n"}
%%%%%%%%%%%%%%%% Running Query #  10  threads:  1
SELECT c_custkey, c_name, sum(l_extendedprice * (1 - l_discount)) AS revenue, c_acctbal, n_name, c_address, c_phone, c_comment FROM customer, orders, lineitem, nation WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate >= CAST('1993-10-01' AS date) AND o_orderdate < CAST('1994-01-01' AS date) AND l_returnflag = 'R' AND c_nationkey = n_nationkey GROUP BY c_custkey, c_name, c_acctbal, c_phone, n_name, c_address, c_comment ORDER BY revenue DESC LIMIT 20;
Run:  None SELECT c_custkey, c_name, sum(l_extendedprice * (1 - l_discount)) AS revenue, c_acctbal, n_name, c_address, c_phone, c_comment FROM customer, orders, lineitem, nation WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate >= CAST('1993-10-01' AS date) AND o_orderdate < CAST('1994-01-01' AS date) AND l_returnflag = 'R' AND c_nationkey = n_nationkey GROUP BY c_custkey, c_name, c_acctbal, c_phone, n_name, c_address, c_comment ORDER BY revenue DESC LIMIT 20;
Avg Time in sec:  0.4876733566634357  output size:  20
    c_custkey  ...                                          c_comment
0       57040  ...  ep. blithely regular foxes promise slyly furio...
1      143347  ...  endencies sleep. slyly express deposits nag ca...
2       60838  ...   tes. final instructions nag quickly according to
3      101998  ...  ost carefully. slyly regular packages cajole a...
4      125341  ...  ly furiously brave packages. quickly regular d...
5       25501  ...  y ironic foxes hinder according to the furious...
6      115831  ...  unts nag carefully final packages. express the...
7       84223  ...  longside of the slyly final deposits. blithely...
8       54289  ...      cajole furiously after the quickly unusual fo
9       39922  ...  ironic deposits sublate furiously. carefully r...
10       6226  ...  nal packages are alongside of the quickly bold...
11        922  ...                cuses cajole carefully regular idea
12     147946  ...  ly pending platelets. ironic requests haggle a...
13     115640  ...             ffily ironic deposits. blithely specia
14      73606  ...                 uests cajole according to the foxe
15     110246  ...        ow carefully. blithely careful packages hag
16     142549  ...  . slyly bold packages nag quickly against the ...
17     146149  ...  nic, special instructions. multipliers run car...
18      52528  ...  olphins. blithely silent platelets affix caref...
19      23431  ...    the final sentiments. carefully ironic packages

[20 rows x 8 columns]
{'name': 'Query', 'result': 0.479704, 'timing': 0.479704, 'cardinality': 0, 'extra-info': "SELECT c_custkey, c_name, sum(l_extendedprice * (1 - l_discount)) AS revenue, c_acctbal, n_name, c_address, c_phone, c_comment FROM customer, orders, lineitem, nation WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate >= CAST('1993-10-01' AS date) AND o_orderdate < CAST('1994-01-01' AS date) AND l_returnflag = 'R' AND c_nationkey = n_nationkey GROUP BY c_custkey, c_name, c_acctbal, c_phone, n_name, c_address, c_comment ORDER BY revenue DESC LIMIT 20;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 3.4e-05, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'STREAMING_LIMIT', 'timing': 4e-06, 'cardinality': 20, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 0.000177, 'cardinality': 4096, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n#1\n#2\n#3\n__internal_decompress_string(#4)\n#5\n__internal_decompress_string(#6)\n#7\n', 'children': [{'name': 'ORDER_BY', 'timing': 0.005392, 'cardinality': 4096, 'extra_info': 'ORDERS:\nsum((lineitem.l_extendedprice * (1 - lineitem.l_discount))) DESC', 'children': [{'name': 'PROJECTION', 'timing': 0.001217, 'cardinality': 37967, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n#1\n#2\n#3\n__internal_compress_string_hugeint(#4)\n#5\n__internal_compress_string_hugeint(#6)\n#7\n', 'children': [{'name': 'PROJECTION', 'timing': 1.7e-05, 'cardinality': 37967, 'extra_info': 'c_custkey\nc_name\nrevenue\nc_acctbal\nn_name\nc_address\nc_phone\nc_comment\n', 'children': [{'name': 'PROJECTION', 'timing': 0.001428, 'cardinality': 37967, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n#1\n#2\n__internal_decompress_string(#3)\n__internal_decompress_string(#4)\n#5\n#6\n#7\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.033195, 'cardinality': 37967, 'extra_info': '#0\n#1\n#2\n#3\n#4\n#5\n#6\nsum(#7)', 'children': [{'name': 'PROJECTION', 'timing': 0.000495, 'cardinality': 114705, 'extra_info': 'c_custkey\nc_name\nc_acctbal\nc_phone\nn_name\nc_address\nc_comment\n(l_extendedprice * (1.00 - l_discount))\n', 'children': [{'name': 'PROJECTION', 'timing': 0.004611, 'cardinality': 114705, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n#1\n#2\n__internal_compress_integral_uinteger(#3, 1)\n__internal_compress_integral_uinteger(#4, 1)\n#5\n#6\n__internal_compress_string_hugeint(#7)\n#8\n#9\n__internal_compress_string_hugeint(#10)\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.155789, 'cardinality': 114705, 'extra_info': 'INNER\nl_orderkey = o_orderkey\n\n[INFOSEPARATOR]\nEC: 241245\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.162443, 'cardinality': 1478870, 'extra_info': "lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nFilters: l_returnflag='R' AND l_returnflag IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 2000405", 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.031221, 'cardinality': 57069, 'extra_info': 'INNER\no_custkey = c_custkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 149999\n\n[INFOSEPARATOR]\nEC: 180897\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.013223, 'cardinality': 57069, 'extra_info': "orders\n[INFOSEPARATOR]\no_custkey\no_orderkey\n[INFOSEPARATOR]\nFilters: o_orderdate>='1993-10-01'::DATE AND o_orderdate<'1994-01-01'::DATE AND o_orderdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 300000", 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.003085, 'cardinality': 149999, 'extra_info': 'INNER\nc_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nEC: 150000\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.012572, 'cardinality': 149999, 'extra_info': 'customer\n[INFOSEPARATOR]\nc_custkey\nc_nationkey\nc_name\nc_acctbal\nc_phone\nc_address\nc_comment\n[INFOSEPARATOR]\nFilters: c_custkey<=149999 AND c_custkey IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 150000', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 2.1e-05, 'cardinality': 25, 'extra_info': 'nation\n[INFOSEPARATOR]\nn_nationkey\nn_name\n[INFOSEPARATOR]\nEC: 25', 'children': []}]}]}]}]}]}]}]}]}]}]}]}]}]}]}
uncompressed filter_log_size: 1104
uncompressed filter_log_buffer_size: 0
uncompressed limit_offset_size: 1128
uncompressed limit_offset_buffer_size: 0
uncompressed perfect_full_scan_ht_log_size: 2401208
uncompressed perfect_full_scan_ht_log_buffer_size: 2400040
uncompressed perfect_probe_ht_log_size: 490424
uncompressed perfect_probe_ht_log_buffer_size: 456552
uncompressed row_group_log_size: 6912824
uncompressed row_group_log_buffer_size: 6743752
uncompressed scatter_log_size: 919768
uncompressed scatter_log_buffer_size: 917640
uncompressed scatter_sel_log_size: 2523116
uncompressed scatter_sel_log_buffer_size: 2485116
uncompressed gather_log_size: 1104
uncompressed gather_log_buffer_size: 0
uncompressed combine_log_size: 1104
uncompressed combine_log_buffer_size: 0
uncompressed finalize_states_log_size: 305352
uncompressed finalize_states_log_buffer_size: 303736
uncompressed join_gather_log_size: 3443792
uncompressed join_gather_log_buffer_size: 3176448
uncompressed reorder_log_size: 304864
uncompressed reorder_log_buffer_size: 0
uncompressed cross_log_size: 1104
uncompressed cross_log_buffer_size: 0
uncompressed nlj_log_size: 1104
uncompressed nlj_log_buffer_size: 0
uncompressed total_size: 17307996
uncompressed total_buffer_size: 16483284
uncompressed total_element_size: 824712

Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│__internal_decompress_integ│                                                                                                                                                 
│     ral_bigint(#0, 1)     │                                                                                                                                                 
│             #1            │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│          ORDER_BY         │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│          ORDERS:          │                                                                                                                                                 
│sum((partsupp.ps_supplycost│                                                                                                                                                 
│  * partsupp.ps_availqty)) │                                                                                                                                                 
│            DESC           │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│__internal_compress_integra│                                                                                                                                                 
│     l_uinteger(#0, 1)     │                                                                                                                                                 
│             #1            │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│         ps_partkey        │                                                                                                                                                 
│           value           │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│      NESTED_LOOP_JOIN     │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│           INNER           │                                                                                                                                                 
│       CAST(sum((CAST      │                                                                                                                                                 
│(ps_supplycost AS DECI...  │                                                                                                                                                 
│(ps_availqty AS DECIMA...  ├────────────────────────────────────────────────────────────────────────┐                                                                        
│ )))) AS DECIMAL(38,11)) > │                                                                        │                                                                        
│          SUBQUERY         │                                                                        │                                                                        
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                        │                                                                        
│           EC: 1           │                                                                        │                                                                        
└─────────────┬─────────────┘                                                                        │                                                                                                     
┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐                                                          
│         PROJECTION        │                                                          │    UNGROUPED_AGGREGATE    │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│__internal_decompress_integ│                                                          │         first(#0)         │                                                          
│     ral_bigint(#0, 1)     │                                                          │                           │                                                          
│             #1            │                                                          │                           │                                                          
└─────────────┬─────────────┘                                                          └─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐                                                          
│       HASH_GROUP_BY       │                                                          │         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│             #0            │                                                          │             #0            │                                                          
│          sum(#1)          │                                                          │                           │                                                          
└─────────────┬─────────────┘                                                          └─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐                                                          
│         PROJECTION        │                                                          │      STREAMING_LIMIT      │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │                           │                                                          
│         ps_partkey        │                                                          │                           │                                                          
│   (CAST(ps_supplycost AS  │                                                          │                           │                                                          
│    DECIMAL(34,2)) * CAST  │                                                          │                           │                                                          
│(ps_availqty AS DECIMA...  │                                                          │                           │                                                          
└─────────────┬─────────────┘                                                          └─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐                                                          
│         PROJECTION        │                                                          │         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│__internal_compress_integra│                                                          │(sum((CAST(ps_supplycost AS│                                                          
│     l_usmallint(#0, 1)    │                                                          │    DECIMAL(34,2)) * CAST  │                                                          
│__internal_compress_integra│                                                          │(ps_availqty AS DECIMA...  │                                                          
│     l_uinteger(#1, 1)     │                                                          │       * 0.000100000)      │                                                          
│             #2            │                                                          │                           │                                                          
│             #3            │                                                          │                           │                                                          
│__internal_compress_integra│                                                          │                           │                                                          
│     l_usmallint(#4, 1)    │                                                          │                           │                                                          
└─────────────┬─────────────┘                                                          └─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐                                                          
│         HASH_JOIN         │                                                          │    UNGROUPED_AGGREGATE    │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│           INNER           │                                                          │          sum(#0)          │                                                          
│   ps_suppkey = s_suppkey  │                                                          │                           │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐                                           │                           │                                                          
│        Build Min: 1       │              │                                           │                           │                                                          
│      Build Max: 10000     │              │                                           │                           │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                           │                           │                                                          
│         EC: 27811         │              │                                           │                           │                                                          
└─────────────┬─────────────┘              │                                           └─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐                                                          
│         SEQ_SCAN          ││         HASH_JOIN         │                             │         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│          partsupp         ││           INNER           │                             │   (CAST(ps_supplycost AS  │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││ s_nationkey = n_nationkey │                             │    DECIMAL(34,2)) * CAST  │                                                          
│         ps_suppkey        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │(ps_availqty AS DECIMA...  │                                                          
│         ps_partkey        ││        Build Min: 0       ├──────────────┐              │                           │                                                          
│       ps_supplycost       ││       Build Max: 24       │              │              │                           │                                                          
│        ps_availqty        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              │                           │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││          EC: 400          │              │              │                           │                                                          
│         EC: 800000        ││                           │              │              │                           │                                                          
└───────────────────────────┘└─────────────┬─────────────┘              │              └─────────────┬─────────────┘                                                                                       
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                          
                             │         SEQ_SCAN          ││         SEQ_SCAN          ││         HASH_JOIN         │                                                          
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                             │          supplier         ││           nation          ││           INNER           │                                                          
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ps_suppkey = s_suppkey  │                                                          
                             │         s_suppkey         ││        n_nationkey        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                             │        s_nationkey        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││        Build Min: 1       ├──────────────┐                                           
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││ Filters: n_name='GERMANY' ││      Build Max: 10000     │              │                                           
                             │         EC: 10000         ││   AND n_name IS NOT NULL  ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                           
                             │                           ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││         EC: 27811         │              │                                           
                             │                           ││           EC: 1           ││                           │              │                                           
                             └───────────────────────────┘└───────────────────────────┘└─────────────┬─────────────┘              │                                                                        
                                                                                       ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             
                                                                                       │         SEQ_SCAN          ││         HASH_JOIN         │                             
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                                                                                       │          partsupp         ││           INNER           │                             
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││ s_nationkey = n_nationkey │                             
                                                                                       │         ps_suppkey        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐              
                                                                                       │       ps_supplycost       ││        Build Min: 0       │              │              
                                                                                       │        ps_availqty        ││       Build Max: 24       │              │              
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              
                                                                                       │         EC: 800000        ││          EC: 400          │              │              
                                                                                       └───────────────────────────┘└─────────────┬─────────────┘              │                                           
                                                                                                                    ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
                                                                                                                    │         SEQ_SCAN          ││         SEQ_SCAN          │
                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                                                    │          supplier         ││           nation          │
                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                                                    │         s_suppkey         ││        n_nationkey        │
                                                                                                                    │        s_nationkey        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││ Filters: n_name='GERMANY' │
                                                                                                                    │         EC: 10000         ││   AND n_name IS NOT NULL  │
                                                                                                                    │                           ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                                                    │                           ││           EC: 1           │
                                                                                                                    └───────────────────────────┘└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

X {'RESULT_COLLECTOR0': 3.4e-05, 'STREAMING_LIMIT1': 4e-06, 'PROJECTION2': 0.000177, 'ORDER_BY3': 0.005392, 'PROJECTION4': 0.001217, 'PROJECTION5': 1.7e-05, 'PROJECTION6': 0.001428, 'HASH_GROUP_BY7': 0.033195, 'PROJECTION8': 0.000495, 'PROJECTION9': 0.004611, 'HASH_JOIN10': 0.155789, 'SEQ_SCAN 11': 0.162443, 'HASH_JOIN12': 0.031221, 'SEQ_SCAN 13': 0.013223, 'HASH_JOIN14': 0.003085, 'SEQ_SCAN 15': 0.012572, 'SEQ_SCAN 16': 2.1e-05}
**** output size:  20
LINEAGE_4_HASH_GROUP_BY_9
LINEAGE_4_HASH_JOIN_4
LINEAGE_4_HASH_JOIN_5
LINEAGE_4_HASH_JOIN_6
LINEAGE_4_ORDER_BY_13
LINEAGE_4_SEQ_SCAN_0
LINEAGE_4_SEQ_SCAN_1
LINEAGE_4_SEQ_SCAN_2
LINEAGE_4_SEQ_SCAN_3
LINEAGE_4_STREAMING_LIMIT_15
SELECT c_custkey, c_name, sum(l_extendedprice * (1 - l_discount)) AS revenue, c_acctbal, n_name, c_address, c_phone, c_comment FROM customer, orders, lineitem, nation WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate >= CAST('1993-10-01' AS date) AND o_orderdate < CAST('1994-01-01' AS date) AND l_returnflag = 'R' AND c_nationkey = n_nationkey GROUP BY c_custkey, c_name, c_acctbal, c_phone, n_name, c_address, c_comment ORDER BY revenue DESC LIMIT 20;
   query_id  ...                                               plan
0         4  ...  {"name": "STREAMING_LIMIT", "opid": "15", "chi...

[1 rows x 7 columns]
Query info:  query_id                                                            4
query               SELECT c_custkey, c_name, sum(l_extendedprice ...
size_bytes_max                                               17307996
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "STREAMING_LIMIT", "opid": "15", "chi...
Name: 0, dtype: object
{"name": "STREAMING_LIMIT", "opid": "15", "children": [{"name": "PROJECTION", "opid": "14", "children": [{"name": "ORDER_BY", "opid": "13", "children": [{"name": "PROJECTION", "opid": "12", "children": [{"name": "PROJECTION", "opid": "11", "children": [{"name": "PROJECTION", "opid": "10", "children": [{"name": "HASH_GROUP_BY", "opid": "9", "children": [{"name": "PROJECTION", "opid": "8", "children": [{"name": "PROJECTION", "opid": "7", "children": [{"name": "HASH_JOIN", "opid": "6", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nFilters: l_returnflag='R' AND l_returnflag IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 2000405"},{"name": "HASH_JOIN", "opid": "5", "children": [{"name": "SEQ_SCAN ", "opid": "1", "children": [],"table": "orders","extra": "orders\n[INFOSEPARATOR]\no_custkey\no_orderkey\n[INFOSEPARATOR]\nFilters: o_orderdate>='1993-10-01'::DATE AND o_orderdate<'1994-01-01'::DATE AND o_orderdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 300000"},{"name": "HASH_JOIN", "opid": "4", "children": [{"name": "SEQ_SCAN ", "opid": "2", "children": [],"table": "customer","extra": "customer\n[INFOSEPARATOR]\nc_custkey\nc_nationkey\nc_name\nc_acctbal\nc_phone\nc_address\nc_comment\n[INFOSEPARATOR]\nFilters: c_custkey<=149999 AND c_custkey IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 150000"},{"name": "SEQ_SCAN ", "opid": "3", "children": [],"table": "nation","extra": "nation\n[INFOSEPARATOR]\nn_nationkey\nn_name\n[INFOSEPARATOR]\nEC: 25"}],"table": "","extra": "INNER\nc_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nEC: 150000\n"}],"table": "","extra": "INNER\no_custkey = c_custkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 149999\n\n[INFOSEPARATOR]\nEC: 180897\n"}],"table": "","extra": "INNER\nl_orderkey = o_orderkey\n\n[INFOSEPARATOR]\nEC: 241245\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n#1\n#2\n__internal_compress_integral_uinteger(#3, 1)\n__internal_compress_integral_uinteger(#4, 1)\n#5\n#6\n__internal_compress_string_hugeint(#7)\n#8\n#9\n__internal_compress_string_hugeint(#10)\n"}],"table": "","extra": "c_custkey\nc_name\nc_acctbal\nc_phone\nn_name\nc_address\nc_comment\n(l_extendedprice * (1.00 - l_discount))\n"}],"table": "","extra": "#0\n#1\n#2\n#3\n#4\n#5\n#6\nsum(#7)"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n#1\n#2\n__internal_decompress_string(#3)\n__internal_decompress_string(#4)\n#5\n#6\n#7\n"}],"table": "","extra": "c_custkey\nc_name\nrevenue\nc_acctbal\nn_name\nc_address\nc_phone\nc_comment\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n#1\n#2\n#3\n__internal_compress_string_hugeint(#4)\n#5\n__internal_compress_string_hugeint(#6)\n#7\n"}],"table": "","extra": "ORDERS:\nsum((lineitem.l_extendedprice * (1 - lineitem.l_discount))) DESC"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n#1\n#2\n#3\n__internal_decompress_string(#4)\n#5\n__internal_decompress_string(#6)\n#7\n"}],"table": "","extra": ""}
%%%%%%%%%%%%%%%% Running Query #  11  threads:  1
SELECT ps_partkey, sum(ps_supplycost * ps_availqty) AS value FROM partsupp, supplier, nation WHERE ps_suppkey = s_suppkey AND s_nationkey = n_nationkey AND n_name = 'GERMANY' GROUP BY ps_partkey HAVING sum(ps_supplycost * ps_availqty) > ( SELECT sum(ps_supplycost * ps_availqty) * 0.000100000 FROM partsupp, supplier, nation WHERE ps_suppkey = s_suppkey AND s_nationkey = n_nationkey AND n_name = 'GERMANY') ORDER BY value DESC;
Run:  None SELECT ps_partkey, sum(ps_supplycost * ps_availqty) AS value FROM partsupp, supplier, nation WHERE ps_suppkey = s_suppkey AND s_nationkey = n_nationkey AND n_name = 'GERMANY' GROUP BY ps_partkey HAVING sum(ps_supplycost * ps_availqty) > ( SELECT sum(ps_supplycost * ps_availqty) * 0.000100000 FROM partsupp, supplier, nation WHERE ps_suppkey = s_suppkey AND s_nationkey = n_nationkey AND n_name = 'GERMANY') ORDER BY value DESC;
Avg Time in sec:  0.03810770716518164  output size:  1048
      ps_partkey        value
0         129760  17538456.86
1         166726  16503353.92
2         191287  16474801.97
3         161758  16101755.54
4          34452  15983844.72
...          ...          ...
1043      154731   7888301.33
1044      101674   7879324.60
1045       51968   7879102.21
1046       72073   7877736.11
1047        5182   7874521.73

[1048 rows x 2 columns]
{'name': 'Query', 'result': 0.033073, 'timing': 0.033073, 'cardinality': 0, 'extra-info': "SELECT ps_partkey, sum(ps_supplycost * ps_availqty) AS value FROM partsupp, supplier, nation WHERE ps_suppkey = s_suppkey AND s_nationkey = n_nationkey AND n_name = 'GERMANY' GROUP BY ps_partkey HAVING sum(ps_supplycost * ps_availqty) > ( SELECT sum(ps_supplycost * ps_availqty) * 0.000100000 FROM partsupp, supplier, nation WHERE ps_suppkey = s_suppkey AND s_nationkey = n_nationkey AND n_name = 'GERMANY') ORDER BY value DESC;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 1.2e-05, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 2e-06, 'cardinality': 1048, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n#1\n', 'children': [{'name': 'ORDER_BY', 'timing': 0.00013, 'cardinality': 1048, 'extra_info': 'ORDERS:\nsum((partsupp.ps_supplycost * partsupp.ps_availqty)) DESC', 'children': [{'name': 'PROJECTION', 'timing': 2e-05, 'cardinality': 1048, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n#1\n', 'children': [{'name': 'PROJECTION', 'timing': 5e-06, 'cardinality': 1048, 'extra_info': 'ps_partkey\nvalue\n', 'children': [{'name': 'NESTED_LOOP_JOIN', 'timing': 0.001141, 'cardinality': 1048, 'extra_info': 'INNER\nCAST(sum((CAST(ps_supplycost AS DECIMAL(34,2)) * CAST(ps_availqty AS DECIMAL(34,0)))) AS DECIMAL(38,11)) > SUBQUERY\n\n[INFOSEPARATOR]\nEC: 1\n', 'children': [{'name': 'PROJECTION', 'timing': 3.1e-05, 'cardinality': 29818, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n#1\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.005129, 'cardinality': 29818, 'extra_info': '#0\nsum(#1)', 'children': [{'name': 'PROJECTION', 'timing': 0.005878, 'cardinality': 31680, 'extra_info': 'ps_partkey\n(CAST(ps_supplycost AS DECIMAL(34,2)) * CAST(ps_availqty AS DECIMAL(34,0)))\n', 'children': [{'name': 'PROJECTION', 'timing': 0.001519, 'cardinality': 31680, 'extra_info': '__internal_compress_integral_usmallint(#0, 1)\n__internal_compress_integral_uinteger(#1, 1)\n#2\n#3\n__internal_compress_integral_usmallint(#4, 1)\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.003225, 'cardinality': 31680, 'extra_info': 'INNER\nps_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 27811\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.001614, 'cardinality': 800000, 'extra_info': 'partsupp\n[INFOSEPARATOR]\nps_suppkey\nps_partkey\nps_supplycost\nps_availqty\n[INFOSEPARATOR]\nEC: 800000', 'children': []}, {'name': 'HASH_JOIN', 'timing': 3.6e-05, 'cardinality': 396, 'extra_info': 'INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 400\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 1.8e-05, 'cardinality': 10000, 'extra_info': 'supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\n[INFOSEPARATOR]\nEC: 10000', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 8e-06, 'cardinality': 1, 'extra_info': "nation\n[INFOSEPARATOR]\nn_nationkey\n[INFOSEPARATOR]\nFilters: n_name='GERMANY' AND n_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1", 'children': []}]}]}]}]}]}]}, {'name': 'UNGROUPED_AGGREGATE', 'timing': 2e-06, 'cardinality': 1, 'extra_info': 'first(#0)', 'children': [{'name': 'PROJECTION', 'timing': 0.0, 'cardinality': 1, 'extra_info': '#0\n', 'children': [{'name': 'STREAMING_LIMIT', 'timing': 2e-06, 'cardinality': 1, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 3e-06, 'cardinality': 1, 'extra_info': '(sum((CAST(ps_supplycost AS DECIMAL(34,2)) * CAST(ps_availqty AS DECIMAL(34,0)))) * 0.000100000)\n', 'children': [{'name': 'UNGROUPED_AGGREGATE', 'timing': 0.000473, 'cardinality': 1, 'extra_info': 'sum(#0)', 'children': [{'name': 'PROJECTION', 'timing': 0.005166, 'cardinality': 31680, 'extra_info': '(CAST(ps_supplycost AS DECIMAL(34,2)) * CAST(ps_availqty AS DECIMAL(34,0)))\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.0028, 'cardinality': 31680, 'extra_info': 'INNER\nps_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 27811\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.001239, 'cardinality': 800000, 'extra_info': 'partsupp\n[INFOSEPARATOR]\nps_suppkey\nps_supplycost\nps_availqty\n[INFOSEPARATOR]\nEC: 800000', 'children': []}, {'name': 'HASH_JOIN', 'timing': 6.8e-05, 'cardinality': 396, 'extra_info': 'INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 400\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 3.1e-05, 'cardinality': 10000, 'extra_info': 'supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\n[INFOSEPARATOR]\nEC: 10000', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 2.6e-05, 'cardinality': 1, 'extra_info': "nation\n[INFOSEPARATOR]\nn_nationkey\n[INFOSEPARATOR]\nFilters: n_name='GERMANY' AND n_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1", 'children': []}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}
uncompressed filter_log_size: 1488
uncompressed filter_log_buffer_size: 0
uncompressed limit_offset_size: 1512
uncompressed limit_offset_buffer_size: 0
uncompressed perfect_full_scan_ht_log_size: 14672
uncompressed perfect_full_scan_ht_log_buffer_size: 12928
uncompressed perfect_probe_ht_log_size: 547984
uncompressed perfect_probe_ht_log_buffer_size: 513216
uncompressed row_group_log_size: 34840
uncompressed row_group_log_buffer_size: 8
uncompressed scatter_log_size: 263120
uncompressed scatter_log_buffer_size: 253440
uncompressed scatter_sel_log_size: 11584
uncompressed scatter_sel_log_buffer_size: 9520
uncompressed gather_log_size: 1488
uncompressed gather_log_buffer_size: 0
uncompressed combine_log_size: 1488
uncompressed combine_log_buffer_size: 0
uncompressed finalize_states_log_size: 240288
uncompressed finalize_states_log_buffer_size: 238544
uncompressed join_gather_log_size: 1488
uncompressed join_gather_log_buffer_size: 0
uncompressed reorder_log_size: 9896
uncompressed reorder_log_buffer_size: 0
uncompressed cross_log_size: 1488
uncompressed cross_log_buffer_size: 0
uncompressed nlj_log_size: 11008
uncompressed nlj_log_buffer_size: 8624
uncompressed total_size: 1142344
uncompressed total_buffer_size: 1036280
uncompressed total_element_size: 106064

Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│__internal_decompress_strin│                             
│           g(#0)           │                             
│             #1            │                             
│             #2            │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│          ORDER_BY         │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│          ORDERS:          │                             
│  lineitem.l_shipmode ASC  │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│__internal_compress_string_│                             
│        ubigint(#0)        │                             
│             #1            │                             
│             #2            │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│__internal_decompress_strin│                             
│           g(#0)           │                             
│             #1            │                             
│             #2            │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│       HASH_GROUP_BY       │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│             #0            │                             
│          sum(#1)          │                             
│          sum(#2)          │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│         l_shipmode        │                             
│       CASE  WHEN ((       │                             
│(o_orderpriority = '1-...  │                             
│(o_orderpriority = '2-...  │                             
│     THEN (1) ELSE 0 END   │                             
│       CASE  WHEN ((       │                             
│(o_orderpriority != '1...  │                             
│(o_orderpriority != '2...  │                             
│     THEN (1) ELSE 0 END   │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│__internal_compress_integra│                             
│     l_uinteger(#0, 1)     │                             
│             #1            │                             
│__internal_compress_integra│                             
│     l_uinteger(#2, 1)     │                             
│__internal_compress_string_│                             
│        ubigint(#3)        │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         HASH_JOIN         │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│           INNER           │                             
│  o_orderkey = l_orderkey  ├──────────────┐              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              
│         EC: 240048        │              │              
└─────────────┬─────────────┘              │                                           
┌─────────────┴─────────────┐┌─────────────┴─────────────┐
│         SEQ_SCAN          ││           FILTER          │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│           orders          ││      ((l_commitdate <     │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││ l_receiptdate) AND (l...  │
│         o_orderkey        ││ l_commitdate) AND ((l...  │
│      o_orderpriority      ││= 'MAIL') OR (l_shipmode = │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││         'SHIP')))         │
│        EC: 1500000        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│                           ││         EC: 240048        │
└───────────────────────────┘└─────────────┬─────────────┘                             
                             ┌─────────────┴─────────────┐
                             │         SEQ_SCAN          │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                             │          lineitem         │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                             │         l_orderkey        │
                             │         l_shipmode        │
                             │        l_commitdate       │
                             │       l_receiptdate       │
                             │         l_shipdate        │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                             │  Filters: l_receiptdate>= │
                             │   '1994-01-01'::DATE AND  │
                             │ l_receiptdate<'1995-0...  │
                             │  AND l_receiptdate IS NOT │
                             │            NULL           │
                             │ l_commitdate<'1995-01-01':│
                             │ :DATE AND l_commitdate IS │
                             │          NOT NULL         │
                             │  l_shipdate<'1995-01-01': │
                             │:DATE AND l_shipdate IS NOT│
                             │            NULL           │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                             │         EC: 240048        │
                             └───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

X {'RESULT_COLLECTOR0': 1.2e-05, 'PROJECTION1': 2e-06, 'ORDER_BY2': 0.00013, 'PROJECTION3': 2e-05, 'PROJECTION4': 5e-06, 'NESTED_LOOP_JOIN5': 0.001141, 'PROJECTION6': 3.1e-05, 'HASH_GROUP_BY7': 0.005129, 'PROJECTION8': 0.005878, 'PROJECTION9': 0.001519, 'HASH_JOIN10': 0.003225, 'SEQ_SCAN 11': 0.001614, 'HASH_JOIN12': 3.6e-05, 'SEQ_SCAN 13': 1.8e-05, 'SEQ_SCAN 14': 8e-06, 'UNGROUPED_AGGREGATE15': 2e-06, 'PROJECTION16': 0.0, 'STREAMING_LIMIT17': 2e-06, 'PROJECTION18': 3e-06, 'UNGROUPED_AGGREGATE19': 0.000473, 'PROJECTION20': 0.005166, 'HASH_JOIN21': 0.0028, 'SEQ_SCAN 22': 0.001239, 'HASH_JOIN23': 6.8e-05, 'SEQ_SCAN 24': 3.1e-05, 'SEQ_SCAN 25': 2.6e-05}
**** output size:  1048
LINEAGE_4_HASH_GROUP_BY_7
LINEAGE_4_HASH_JOIN_12
LINEAGE_4_HASH_JOIN_13
LINEAGE_4_HASH_JOIN_3
LINEAGE_4_HASH_JOIN_4
LINEAGE_4_NESTED_LOOP_JOIN_20
LINEAGE_4_ORDER_BY_23
LINEAGE_4_SEQ_SCAN_0
LINEAGE_4_SEQ_SCAN_1
LINEAGE_4_SEQ_SCAN_10
LINEAGE_4_SEQ_SCAN_11
LINEAGE_4_SEQ_SCAN_2
LINEAGE_4_SEQ_SCAN_9
LINEAGE_4_STREAMING_LIMIT_17
SELECT ps_partkey, sum(ps_supplycost * ps_availqty) AS value FROM partsupp, supplier, nation WHERE ps_suppkey = s_suppkey AND s_nationkey = n_nationkey AND n_name = 'GERMANY' GROUP BY ps_partkey HAVING sum(ps_supplycost * ps_availqty) > ( SELECT sum(ps_supplycost * ps_availqty) * 0.000100000 FROM partsupp, supplier, nation WHERE ps_suppkey = s_suppkey AND s_nationkey = n_nationkey AND n_name = 'GERMANY') ORDER BY value DESC;
   query_id  ...                                               plan
0         4  ...  {"name": "PROJECTION", "opid": "24", "children...

[1 rows x 7 columns]
Query info:  query_id                                                            4
query               SELECT ps_partkey, sum(ps_supplycost * ps_avai...
size_bytes_max                                                1142344
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "PROJECTION", "opid": "24", "children...
Name: 0, dtype: object
{"name": "PROJECTION", "opid": "24", "children": [{"name": "ORDER_BY", "opid": "23", "children": [{"name": "PROJECTION", "opid": "22", "children": [{"name": "PROJECTION", "opid": "21", "children": [{"name": "NESTED_LOOP_JOIN", "opid": "20", "children": [{"name": "PROJECTION", "opid": "8", "children": [{"name": "HASH_GROUP_BY", "opid": "7", "children": [{"name": "PROJECTION", "opid": "6", "children": [{"name": "PROJECTION", "opid": "5", "children": [{"name": "HASH_JOIN", "opid": "4", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "partsupp","extra": "partsupp\n[INFOSEPARATOR]\nps_suppkey\nps_partkey\nps_supplycost\nps_availqty\n[INFOSEPARATOR]\nEC: 800000"},{"name": "HASH_JOIN", "opid": "3", "children": [{"name": "SEQ_SCAN ", "opid": "1", "children": [],"table": "supplier","extra": "supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\n[INFOSEPARATOR]\nEC: 10000"},{"name": "SEQ_SCAN ", "opid": "2", "children": [],"table": "nation","extra": "nation\n[INFOSEPARATOR]\nn_nationkey\n[INFOSEPARATOR]\nFilters: n_name='GERMANY' AND n_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1"}],"table": "","extra": "INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 400\n"}],"table": "","extra": "INNER\nps_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 27811\n"}],"table": "","extra": "__internal_compress_integral_usmallint(#0, 1)\n__internal_compress_integral_uinteger(#1, 1)\n#2\n#3\n__internal_compress_integral_usmallint(#4, 1)\n"}],"table": "","extra": "ps_partkey\n(CAST(ps_supplycost AS DECIMAL(34,2)) * CAST(ps_availqty AS DECIMAL(34,0)))\n"}],"table": "","extra": "#0\nsum(#1)"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n#1\n"},{"name": "UNGROUPED_AGGREGATE", "opid": "19", "children": [{"name": "PROJECTION", "opid": "18", "children": [{"name": "STREAMING_LIMIT", "opid": "17", "children": [{"name": "PROJECTION", "opid": "16", "children": [{"name": "UNGROUPED_AGGREGATE", "opid": "15", "children": [{"name": "PROJECTION", "opid": "14", "children": [{"name": "HASH_JOIN", "opid": "13", "children": [{"name": "SEQ_SCAN ", "opid": "9", "children": [],"table": "partsupp","extra": "partsupp\n[INFOSEPARATOR]\nps_suppkey\nps_supplycost\nps_availqty\n[INFOSEPARATOR]\nEC: 800000"},{"name": "HASH_JOIN", "opid": "12", "children": [{"name": "SEQ_SCAN ", "opid": "10", "children": [],"table": "supplier","extra": "supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\n[INFOSEPARATOR]\nEC: 10000"},{"name": "SEQ_SCAN ", "opid": "11", "children": [],"table": "nation","extra": "nation\n[INFOSEPARATOR]\nn_nationkey\n[INFOSEPARATOR]\nFilters: n_name='GERMANY' AND n_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1"}],"table": "","extra": "INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 400\n"}],"table": "","extra": "INNER\nps_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 27811\n"}],"table": "","extra": "(CAST(ps_supplycost AS DECIMAL(34,2)) * CAST(ps_availqty AS DECIMAL(34,0)))\n"}],"table": "","extra": "sum(#0)"}],"table": "","extra": "(sum((CAST(ps_supplycost AS DECIMAL(34,2)) * CAST(ps_availqty AS DECIMAL(34,0)))) * 0.000100000)\n"}],"table": "","extra": ""}],"table": "","extra": "#0\n"}],"table": "","extra": "first(#0)"}],"table": "","extra": "INNER\nCAST(sum((CAST(ps_supplycost AS DECIMAL(34,2)) * CAST(ps_availqty AS DECIMAL(34,0)))) AS DECIMAL(38,11)) > SUBQUERY\n\n[INFOSEPARATOR]\nEC: 1\n"}],"table": "","extra": "ps_partkey\nvalue\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n#1\n"}],"table": "","extra": "ORDERS:\nsum((partsupp.ps_supplycost * partsupp.ps_availqty)) DESC"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n#1\n"}
%%%%%%%%%%%%%%%% Running Query #  12  threads:  1
SELECT l_shipmode, sum( CASE WHEN o_orderpriority = '1-URGENT' OR o_orderpriority = '2-HIGH' THEN 1 ELSE 0 END) AS high_line_count, sum( CASE WHEN o_orderpriority <> '1-URGENT' AND o_orderpriority <> '2-HIGH' THEN 1 ELSE 0 END) AS low_line_count FROM orders, lineitem WHERE o_orderkey = l_orderkey AND l_shipmode IN ('MAIL', 'SHIP') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= CAST('1994-01-01' AS date) AND l_receiptdate < CAST('1995-01-01' AS date) GROUP BY l_shipmode ORDER BY l_shipmode;
Run:  None SELECT l_shipmode, sum( CASE WHEN o_orderpriority = '1-URGENT' OR o_orderpriority = '2-HIGH' THEN 1 ELSE 0 END) AS high_line_count, sum( CASE WHEN o_orderpriority <> '1-URGENT' AND o_orderpriority <> '2-HIGH' THEN 1 ELSE 0 END) AS low_line_count FROM orders, lineitem WHERE o_orderkey = l_orderkey AND l_shipmode IN ('MAIL', 'SHIP') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= CAST('1994-01-01' AS date) AND l_receiptdate < CAST('1995-01-01' AS date) GROUP BY l_shipmode ORDER BY l_shipmode;
Avg Time in sec:  0.3185456320643425  output size:  2
  l_shipmode  high_line_count  low_line_count
0       MAIL           6202.0          9324.0
1       SHIP           6200.0          9262.0
{'name': 'Query', 'result': 0.316039, 'timing': 0.316039, 'cardinality': 0, 'extra-info': "SELECT l_shipmode, sum( CASE WHEN o_orderpriority = '1-URGENT' OR o_orderpriority = '2-HIGH' THEN 1 ELSE 0 END) AS high_line_count, sum( CASE WHEN o_orderpriority <> '1-URGENT' AND o_orderpriority <> '2-HIGH' THEN 1 ELSE 0 END) AS low_line_count FROM orders, lineitem WHERE o_orderkey = l_orderkey AND l_shipmode IN ('MAIL', 'SHIP') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= CAST('1994-01-01' AS date) AND l_receiptdate < CAST('1995-01-01' AS date) GROUP BY l_shipmode ORDER BY l_shipmode;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 1.3e-05, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 1e-06, 'cardinality': 2, 'extra_info': '__internal_decompress_string(#0)\n#1\n#2\n', 'children': [{'name': 'ORDER_BY', 'timing': 3.4e-05, 'cardinality': 2, 'extra_info': 'ORDERS:\nlineitem.l_shipmode ASC', 'children': [{'name': 'PROJECTION', 'timing': 1e-06, 'cardinality': 2, 'extra_info': '__internal_compress_string_ubigint(#0)\n#1\n#2\n', 'children': [{'name': 'PROJECTION', 'timing': 2e-06, 'cardinality': 2, 'extra_info': '__internal_decompress_string(#0)\n#1\n#2\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.001448, 'cardinality': 2, 'extra_info': '#0\nsum(#1)\nsum(#2)', 'children': [{'name': 'PROJECTION', 'timing': 0.001056, 'cardinality': 30988, 'extra_info': "l_shipmode\nCASE  WHEN (((o_orderpriority = '1-URGENT') OR (o_orderpriority = '2-HIGH'))) THEN (1) ELSE 0 END\nCASE  WHEN (((o_orderpriority != '1-URGENT') AND (o_orderpriority != '2-HIGH'))) THEN (1) ELSE 0 END\n", 'children': [{'name': 'PROJECTION', 'timing': 0.000337, 'cardinality': 30988, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n#1\n__internal_compress_integral_uinteger(#2, 1)\n__internal_compress_string_ubigint(#3)\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.03964, 'cardinality': 30988, 'extra_info': 'INNER\no_orderkey = l_orderkey\n\n[INFOSEPARATOR]\nEC: 240048\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.036408, 'cardinality': 1500000, 'extra_info': 'orders\n[INFOSEPARATOR]\no_orderkey\no_orderpriority\n[INFOSEPARATOR]\nEC: 1500000', 'children': []}, {'name': 'FILTER', 'timing': 0.034219, 'cardinality': 30988, 'extra_info': "((l_commitdate < l_receiptdate) AND (l_shipdate < l_commitdate) AND ((l_shipmode = 'MAIL') OR (l_shipmode = 'SHIP')))\n[INFOSEPARATOR]\nEC: 240048", 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.194178, 'cardinality': 885773, 'extra_info': "lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_shipmode\nl_commitdate\nl_receiptdate\nl_shipdate\n[INFOSEPARATOR]\nFilters: l_receiptdate>='1994-01-01'::DATE AND l_receiptdate<'1995-01-01'::DATE AND l_receiptdate IS NOT NULL\nl_commitdate<'1995-01-01'::DATE AND l_commitdate IS NOT NULL\nl_shipdate<'1995-01-01'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 240048", 'children': []}]}]}]}]}]}]}]}]}]}]}]}
uncompressed filter_log_size: 223096
uncompressed filter_log_buffer_size: 123952
uncompressed limit_offset_size: 840
uncompressed limit_offset_buffer_size: 0
uncompressed perfect_full_scan_ht_log_size: 840
uncompressed perfect_full_scan_ht_log_buffer_size: 0
uncompressed perfect_probe_ht_log_size: 840
uncompressed perfect_probe_ht_log_buffer_size: 0
uncompressed row_group_log_size: 3707772
uncompressed row_group_log_buffer_size: 3543092
uncompressed scatter_log_size: 249000
uncompressed scatter_log_buffer_size: 247904
uncompressed scatter_sel_log_size: 373208
uncompressed scatter_sel_log_buffer_size: 371856
uncompressed gather_log_size: 840
uncompressed gather_log_buffer_size: 0
uncompressed combine_log_size: 840
uncompressed combine_log_buffer_size: 0
uncompressed finalize_states_log_size: 872
uncompressed finalize_states_log_buffer_size: 16
uncompressed join_gather_log_size: 503768
uncompressed join_gather_log_buffer_size: 371856
uncompressed reorder_log_size: 880
uncompressed reorder_log_buffer_size: 0
uncompressed cross_log_size: 840
uncompressed cross_log_buffer_size: 0
uncompressed nlj_log_size: 840
uncompressed nlj_log_buffer_size: 0
uncompressed total_size: 5064476
uncompressed total_buffer_size: 4658676
uncompressed total_element_size: 405800

Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐                             
│          ORDER_BY         │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│          ORDERS:          │                             
│     count_star() DESC     │                             
│   c_orders.c_count DESC   │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│       HASH_GROUP_BY       │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│             #0            │                             
│        count_star()       │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│          c_count          │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│     count(o_orderkey)     │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│__internal_decompress_integ│                             
│     ral_bigint(#0, 1)     │                             
│             #1            │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│       HASH_GROUP_BY       │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│             #0            │                             
│         count(#1)         │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│         c_custkey         │                             
│         o_orderkey        │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│__internal_compress_integra│                             
│     l_uinteger(#0, 1)     │                             
│             #1            │                             
│             #2            │                             
│__internal_compress_integra│                             
│     l_uinteger(#3, 1)     │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         HASH_JOIN         │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│           RIGHT           │                             
│   o_custkey = c_custkey   ├──────────────┐              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              
│         EC: 300000        │              │              
└─────────────┬─────────────┘              │                                           
┌─────────────┴─────────────┐┌─────────────┴─────────────┐
│           FILTER          ││         SEQ_SCAN          │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│  (o_comment !~~ '%special ││          customer         │
│        %requests%')       ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││         c_custkey         │
│         EC: 300000        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│                           ││         EC: 150000        │
└─────────────┬─────────────┘└───────────────────────────┘                             
┌─────────────┴─────────────┐                             
│         SEQ_SCAN          │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│           orders          │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│         o_custkey         │                             
│         o_comment         │                             
│         o_orderkey        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│        EC: 1500000        │                             
└───────────────────────────┘                                                          

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

X {'RESULT_COLLECTOR0': 1.3e-05, 'PROJECTION1': 1e-06, 'ORDER_BY2': 3.4e-05, 'PROJECTION3': 1e-06, 'PROJECTION4': 2e-06, 'HASH_GROUP_BY5': 0.001448, 'PROJECTION6': 0.001056, 'PROJECTION7': 0.000337, 'HASH_JOIN8': 0.03964, 'SEQ_SCAN 9': 0.036408, 'FILTER10': 0.034219, 'SEQ_SCAN 11': 0.194178}
**** output size:  2
LINEAGE_4_FILTER_2
LINEAGE_4_HASH_GROUP_BY_6
LINEAGE_4_HASH_JOIN_3
LINEAGE_4_ORDER_BY_9
LINEAGE_4_SEQ_SCAN_0
LINEAGE_4_SEQ_SCAN_1
SELECT l_shipmode, sum( CASE WHEN o_orderpriority = '1-URGENT' OR o_orderpriority = '2-HIGH' THEN 1 ELSE 0 END) AS high_line_count, sum( CASE WHEN o_orderpriority <> '1-URGENT' AND o_orderpriority <> '2-HIGH' THEN 1 ELSE 0 END) AS low_line_count FROM orders, lineitem WHERE o_orderkey = l_orderkey AND l_shipmode IN ('MAIL', 'SHIP') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= CAST('1994-01-01' AS date) AND l_receiptdate < CAST('1995-01-01' AS date) GROUP BY l_shipmode ORDER BY l_shipmode;
   query_id  ...                                               plan
0         4  ...  {"name": "PROJECTION", "opid": "10", "children...

[1 rows x 7 columns]
Query info:  query_id                                                            4
query               SELECT l_shipmode, sum( CASE WHEN o_orderprior...
size_bytes_max                                                5064476
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "PROJECTION", "opid": "10", "children...
Name: 0, dtype: object
{"name": "PROJECTION", "opid": "10", "children": [{"name": "ORDER_BY", "opid": "9", "children": [{"name": "PROJECTION", "opid": "8", "children": [{"name": "PROJECTION", "opid": "7", "children": [{"name": "HASH_GROUP_BY", "opid": "6", "children": [{"name": "PROJECTION", "opid": "5", "children": [{"name": "PROJECTION", "opid": "4", "children": [{"name": "HASH_JOIN", "opid": "3", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "orders","extra": "orders\n[INFOSEPARATOR]\no_orderkey\no_orderpriority\n[INFOSEPARATOR]\nEC: 1500000"},{"name": "FILTER", "opid": "2", "children": [{"name": "SEQ_SCAN ", "opid": "1", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_shipmode\nl_commitdate\nl_receiptdate\nl_shipdate\n[INFOSEPARATOR]\nFilters: l_receiptdate>='1994-01-01'::DATE AND l_receiptdate<'1995-01-01'::DATE AND l_receiptdate IS NOT NULL\nl_commitdate<'1995-01-01'::DATE AND l_commitdate IS NOT NULL\nl_shipdate<'1995-01-01'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 240048"}],"table": "","extra": "((l_commitdate < l_receiptdate) AND (l_shipdate < l_commitdate) AND ((l_shipmode = 'MAIL') OR (l_shipmode = 'SHIP')))\n[INFOSEPARATOR]\nEC: 240048"}],"table": "","extra": "INNER\no_orderkey = l_orderkey\n\n[INFOSEPARATOR]\nEC: 240048\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n#1\n__internal_compress_integral_uinteger(#2, 1)\n__internal_compress_string_ubigint(#3)\n"}],"table": "","extra": "l_shipmode\nCASE  WHEN (((o_orderpriority = '1-URGENT') OR (o_orderpriority = '2-HIGH'))) THEN (1) ELSE 0 END\nCASE  WHEN (((o_orderpriority != '1-URGENT') AND (o_orderpriority != '2-HIGH'))) THEN (1) ELSE 0 END\n"}],"table": "","extra": "#0\nsum(#1)\nsum(#2)"}],"table": "","extra": "__internal_decompress_string(#0)\n#1\n#2\n"}],"table": "","extra": "__internal_compress_string_ubigint(#0)\n#1\n#2\n"}],"table": "","extra": "ORDERS:\nlineitem.l_shipmode ASC"}],"table": "","extra": "__internal_decompress_string(#0)\n#1\n#2\n"}
%%%%%%%%%%%%%%%% Running Query #  13  threads:  1
SELECT c_count, count(*) AS custdist FROM ( SELECT c_custkey, count(o_orderkey) FROM customer LEFT OUTER JOIN orders ON c_custkey = o_custkey AND o_comment NOT LIKE '%special%requests%' GROUP BY c_custkey) AS c_orders (c_custkey, c_count) GROUP BY c_count ORDER BY custdist DESC, c_count DESC;
Run:  None SELECT c_count, count(*) AS custdist FROM ( SELECT c_custkey, count(o_orderkey) FROM customer LEFT OUTER JOIN orders ON c_custkey = o_custkey AND o_comment NOT LIKE '%special%requests%' GROUP BY c_custkey) AS c_orders (c_custkey, c_count) GROUP BY c_count ORDER BY custdist DESC, c_count DESC;
Avg Time in sec:  0.4442521929740906  output size:  42
    c_count  custdist
0         0     50004
1        10      6668
2         9      6563
3        11      6004
4         8      5890
5        12      5600
6        13      5029
7        19      4805
8         7      4680
9        18      4531
10       20      4507
11       14      4473
12       15      4463
13       17      4445
14       16      4410
15       21      4168
16       22      3742
17        6      3273
18       23      3189
19       24      2700
20       25      2090
21        5      1957
22       26      1653
23       27      1177
24        4      1010
25       28       901
26       29       564
27        3       408
28       30       378
29       31       242
30       32       133
31        2       128
32       33        72
33       34        52
34       35        32
35       36        20
36        1        20
37       37         8
38       38         4
39       41         3
40       40         3
41       39         1
{'name': 'Query', 'result': 0.44138, 'timing': 0.44138, 'cardinality': 0, 'extra-info': "SELECT c_count, count(*) AS custdist FROM ( SELECT c_custkey, count(o_orderkey) FROM customer LEFT OUTER JOIN orders ON c_custkey = o_custkey AND o_comment NOT LIKE '%special%requests%' GROUP BY c_custkey) AS c_orders (c_custkey, c_count) GROUP BY c_count ORDER BY custdist DESC, c_count DESC;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 1.3e-05, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'ORDER_BY', 'timing': 3.1e-05, 'cardinality': 42, 'extra_info': 'ORDERS:\ncount_star() DESC\nc_orders.c_count DESC', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.002602, 'cardinality': 42, 'extra_info': '#0\ncount_star()', 'children': [{'name': 'PROJECTION', 'timing': 1.6e-05, 'cardinality': 150000, 'extra_info': 'c_count\n', 'children': [{'name': 'PROJECTION', 'timing': 1.8e-05, 'cardinality': 150000, 'extra_info': 'count(o_orderkey)\n', 'children': [{'name': 'PROJECTION', 'timing': 0.000143, 'cardinality': 150000, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n#1\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.117881, 'cardinality': 150000, 'extra_info': '#0\ncount(#1)', 'children': [{'name': 'PROJECTION', 'timing': 0.000753, 'cardinality': 1534302, 'extra_info': 'c_custkey\no_orderkey\n', 'children': [{'name': 'PROJECTION', 'timing': 0.006329, 'cardinality': 1534302, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n#1\n#2\n__internal_compress_integral_uinteger(#3, 1)\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.111822, 'cardinality': 1534302, 'extra_info': 'RIGHT\no_custkey = c_custkey\n\n[INFOSEPARATOR]\nEC: 300000\n', 'children': [{'name': 'FILTER', 'timing': 0.120362, 'cardinality': 1484298, 'extra_info': "(o_comment !~~ '%special%requests%')\n[INFOSEPARATOR]\nEC: 300000", 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.067384, 'cardinality': 1500000, 'extra_info': 'orders\n[INFOSEPARATOR]\no_custkey\no_comment\no_orderkey\n[INFOSEPARATOR]\nEC: 1500000', 'children': []}]}, {'name': 'SEQ_SCAN ', 'timing': 0.0002, 'cardinality': 150000, 'extra_info': 'customer\n[INFOSEPARATOR]\nc_custkey\n[INFOSEPARATOR]\nEC: 150000', 'children': []}]}]}]}]}]}]}]}]}]}]}]}
X {'RESULT_COLLECTOR0': 1.3e-05, 'ORDER_BY1': 3.1e-05, 'HASH_GROUP_BY2': 0.002602, 'PROJECTION3': 1.6e-05, 'PROJECTION4': 1.8e-05, 'PROJECTION5': 0.000143, 'HASH_GROUP_BY6': 0.117881, 'PROJECTION7': 0.000753, 'PROJECTION8': 0.006329, 'HASH_JOIN9': 0.111822, 'FILTER10': 0.120362, 'SEQ_SCAN 11': 0.067384, 'SEQ_SCAN 12': 0.0002}
**** output size:  42
LINEAGE_4_FILTER_1
LINEAGE_4_HASH_GROUP_BY_10
LINEAGE_4_HASH_GROUP_BY_6
LINEAGE_4_HASH_JOIN_3
LINEAGE_4_ORDER_BY_11
LINEAGE_4_SEQ_SCAN_0
LINEAGE_4_SEQ_SCAN_2
SELECT c_count, count(*) AS custdist FROM ( SELECT c_custkey, count(o_orderkey) FROM customer LEFT OUTER JOIN orders ON c_custkey = o_custkey AND o_comment NOT LIKE '%special%requests%' GROUP BY c_custkey) AS c_orders (c_custkey, c_count) GROUP BY c_count ORDER BY custdist DESC, c_count DESC;
uncompressed filter_log_size: 5962632
uncompressed filter_log_buffer_size: 5937192
uncompressed limit_offset_size: 864
uncompressed limit_offset_buffer_size: 0
uncompressed perfect_full_scan_ht_log_size: 864
uncompressed perfect_full_scan_ht_log_buffer_size: 0
uncompressed perfect_probe_ht_log_size: 864
uncompressed perfect_probe_ht_log_buffer_size: 0
uncompressed row_group_log_size: 37728
uncompressed row_group_log_buffer_size: 0
uncompressed scatter_log_size: 13510096
uncompressed scatter_log_buffer_size: 13474416
uncompressed scatter_sel_log_size: 1804960
uncompressed scatter_sel_log_buffer_size: 1800000
uncompressed gather_log_size: 864
uncompressed gather_log_buffer_size: 0
uncompressed combine_log_size: 2403936
uncompressed combine_log_buffer_size: 2400000
uncompressed finalize_states_log_size: 1203264
uncompressed finalize_states_log_buffer_size: 1200336
uncompressed join_gather_log_size: 18343544
uncompressed join_gather_log_buffer_size: 18211608
uncompressed reorder_log_size: 1224
uncompressed reorder_log_buffer_size: 0
uncompressed cross_log_size: 864
uncompressed cross_log_buffer_size: 0
uncompressed nlj_log_size: 864
uncompressed nlj_log_buffer_size: 0
uncompressed total_size: 43272568
uncompressed total_buffer_size: 43023552
uncompressed total_element_size: 249016

Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│       promo_revenue       │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│    UNGROUPED_AGGREGATE    │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│          sum(#0)          │                             
│          sum(#1)          │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│CASE  WHEN (prefix(p_type, │                             
│      'PROMO')) THEN (     │                             
│(l_extendedprice * (1....  │                             
│     )) ELSE 0.0000 END    │                             
│ (l_extendedprice * (1.00 -│                             
│        l_discount))       │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         HASH_JOIN         │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│           INNER           │                             
│   l_partkey = p_partkey   │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐              
│        Build Min: 1       │              │              
│     Build Max: 200000     │              │              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              
│         EC: 641407        │              │              
└─────────────┬─────────────┘              │                                           
┌─────────────┴─────────────┐┌─────────────┴─────────────┐
│         SEQ_SCAN          ││         SEQ_SCAN          │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│          lineitem         ││            part           │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│         l_partkey         ││         p_partkey         │
│      l_extendedprice      ││           p_type          │
│         l_discount        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││         EC: 200000        │
│ Filters: l_shipdate>='1995││                           │
│-09-01'::DATE AND l_sh...  ││                           │
│  <'1995-10-01'::DATE AND  ││                           │
│   l_shipdate IS NOT NULL  ││                           │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │
│        EC: 1200243        ││                           │
└───────────────────────────┘└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

uncompressed filter_log_size: 624
uncompressed filter_log_buffer_size: 0
uncompressed limit_offset_size: 624
uncompressed limit_offset_buffer_size: 0
uncompressed perfect_full_scan_ht_log_size: 3200744
uncompressed perfect_full_scan_ht_log_buffer_size: 3200056
uncompressed perfect_probe_ht_log_size: 739560
uncompressed perfect_probe_ht_log_buffer_size: 607864
uncompressed row_group_log_size: 439724
uncompressed row_group_log_buffer_size: 303932
uncompressed scatter_log_size: 624
uncompressed scatter_log_buffer_size: 0
uncompressed scatter_sel_log_size: 2404720
uncompressed scatter_sel_log_buffer_size: 2400000
uncompressed gather_log_size: 624
uncompressed gather_log_buffer_size: 0
uncompressed combine_log_size: 624
uncompressed combine_log_buffer_size: 0
uncompressed finalize_states_log_size: 624
uncompressed finalize_states_log_buffer_size: 0
uncompressed join_gather_log_size: 624
uncompressed join_gather_log_buffer_size: 0
uncompressed reorder_log_size: 624
uncompressed reorder_log_buffer_size: 0
uncompressed cross_log_size: 624
uncompressed cross_log_buffer_size: 0
uncompressed nlj_log_size: 624
uncompressed nlj_log_buffer_size: 0
uncompressed total_size: 6790988
uncompressed total_buffer_size: 6511852
uncompressed total_element_size: 279136

Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐                                                          
│         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│__internal_decompress_integ│                                                          
│     ral_bigint(#0, 1)     │                                                          
│             #1            │                                                          
│             #2            │                                                          
│__internal_decompress_strin│                                                          
│           g(#3)           │                                                          
│             #4            │                                                          
└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          
│          ORDER_BY         │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│          ORDERS:          │                                                          
│   supplier.s_suppkey ASC  │                                                          
└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          
│         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│__internal_compress_integra│                                                          
│     l_usmallint(#0, 1)    │                                                          
│             #1            │                                                          
│             #2            │                                                          
│__internal_compress_string_│                                                          
│        hugeint(#3)        │                                                          
│             #4            │                                                          
└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          
│         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│         s_suppkey         │                                                          
│           s_name          │                                                          
│         s_address         │                                                          
│          s_phone          │                                                          
│       total_revenue       │                                                          
└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          
│         HASH_JOIN         │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│           INNER           │                                                          
│  s_suppkey = supplier_no  │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐                                           
│        Build Min: 1       │              │                                           
│      Build Max: 10000     │              │                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                           
│           EC: 4           │              │                                           
└─────────────┬─────────────┘              │                                                                        
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             
│         SEQ_SCAN          ││         HASH_JOIN         │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│          supplier         ││           INNER           │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││  total_revenue = SUBQUERY │                             
│         s_suppkey         ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│           s_name          ││           EC: 3           ├──────────────┐              
│         s_address         ││                           │              │              
│          s_phone          ││                           │              │              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │              │              
│         EC: 10000         ││                           │              │              
└───────────────────────────┘└─────────────┬─────────────┘              │                                           
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
                             │         PROJECTION        ││    UNGROUPED_AGGREGATE    │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                             │__internal_decompress_integ││         first(#0)         │
                             │     ral_bigint(#0, 1)     ││                           │
                             │             #1            ││                           │
                             └─────────────┬─────────────┘└─────────────┬─────────────┘                             
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
                             │       HASH_GROUP_BY       ││         PROJECTION        │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                             │             #0            ││             #0            │
                             │    sum_no_overflow(#1)    ││                           │
                             └─────────────┬─────────────┘└─────────────┬─────────────┘                             
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
                             │         PROJECTION        ││      STREAMING_LIMIT      │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │
                             │         l_suppkey         ││                           │
                             │ (l_extendedprice * (1.00 -││                           │
                             │        l_discount))       ││                           │
                             └─────────────┬─────────────┘└─────────────┬─────────────┘                             
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
                             │         PROJECTION        ││    UNGROUPED_AGGREGATE    │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                             │__internal_compress_integra││          max(#0)          │
                             │     l_usmallint(#0, 1)    ││                           │
                             │             #1            ││                           │
                             │             #2            ││                           │
                             └─────────────┬─────────────┘└─────────────┬─────────────┘                             
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
                             │         SEQ_SCAN          ││         PROJECTION        │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                             │          lineitem         ││       total_revenue       │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │
                             │         l_suppkey         ││                           │
                             │      l_extendedprice      ││                           │
                             │         l_discount        ││                           │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │
                             │ Filters: l_shipdate>='1996││                           │
                             │-01-01'::DATE AND l_sh...  ││                           │
                             │  <'1996-04-01'::DATE AND  ││                           │
                             │   l_shipdate IS NOT NULL  ││                           │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │
                             │        EC: 1200243        ││                           │
                             └───────────────────────────┘└─────────────┬─────────────┘                             
                                                          ┌─────────────┴─────────────┐
                                                          │         PROJECTION        │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │  sum((l_extendedprice *   │
                                                          │(CAST(1 AS DECIMAL(16,2)) -│
                                                          │        l_discount)))      │
                                                          └─────────────┬─────────────┘                             
                                                          ┌─────────────┴─────────────┐
                                                          │         PROJECTION        │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │__internal_decompress_integ│
                                                          │     ral_bigint(#0, 1)     │
                                                          │             #1            │
                                                          └─────────────┬─────────────┘                             
                                                          ┌─────────────┴─────────────┐
                                                          │       HASH_GROUP_BY       │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │             #0            │
                                                          │    sum_no_overflow(#1)    │
                                                          └─────────────┬─────────────┘                             
                                                          ┌─────────────┴─────────────┐
                                                          │         PROJECTION        │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │         l_suppkey         │
                                                          │ (l_extendedprice * (1.00 -│
                                                          │        l_discount))       │
                                                          └─────────────┬─────────────┘                             
                                                          ┌─────────────┴─────────────┐
                                                          │         PROJECTION        │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │__internal_compress_integra│
                                                          │     l_usmallint(#0, 1)    │
                                                          │             #1            │
                                                          │             #2            │
                                                          └─────────────┬─────────────┘                             
                                                          ┌─────────────┴─────────────┐
                                                          │         SEQ_SCAN          │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │          lineitem         │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │         l_suppkey         │
                                                          │      l_extendedprice      │
                                                          │         l_discount        │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │ Filters: l_shipdate>='1996│
                                                          │-01-01'::DATE AND l_sh...  │
                                                          │  <'1996-04-01'::DATE AND  │
                                                          │   l_shipdate IS NOT NULL  │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │        EC: 1200243        │
                                                          └───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

   query_id  ...                                               plan
0         4  ...  {"name": "ORDER_BY", "opid": "11", "children":...

[1 rows x 7 columns]
Query info:  query_id                                                            4
query               SELECT c_count, count(*) AS custdist FROM ( SE...
size_bytes_max                                               43272568
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "ORDER_BY", "opid": "11", "children":...
Name: 0, dtype: object
{"name": "ORDER_BY", "opid": "11", "children": [{"name": "HASH_GROUP_BY", "opid": "10", "children": [{"name": "PROJECTION", "opid": "9", "children": [{"name": "PROJECTION", "opid": "8", "children": [{"name": "PROJECTION", "opid": "7", "children": [{"name": "HASH_GROUP_BY", "opid": "6", "children": [{"name": "PROJECTION", "opid": "5", "children": [{"name": "PROJECTION", "opid": "4", "children": [{"name": "HASH_JOIN", "opid": "3", "children": [{"name": "FILTER", "opid": "1", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "orders","extra": "orders\n[INFOSEPARATOR]\no_custkey\no_comment\no_orderkey\n[INFOSEPARATOR]\nEC: 1500000"}],"table": "","extra": "(o_comment !~~ '%special%requests%')\n[INFOSEPARATOR]\nEC: 300000"},{"name": "SEQ_SCAN ", "opid": "2", "children": [],"table": "customer","extra": "customer\n[INFOSEPARATOR]\nc_custkey\n[INFOSEPARATOR]\nEC: 150000"}],"table": "","extra": "RIGHT\no_custkey = c_custkey\n\n[INFOSEPARATOR]\nEC: 300000\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n#1\n#2\n__internal_compress_integral_uinteger(#3, 1)\n"}],"table": "","extra": "c_custkey\no_orderkey\n"}],"table": "","extra": "#0\ncount(#1)"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n#1\n"}],"table": "","extra": "count(o_orderkey)\n"}],"table": "","extra": "c_count\n"}],"table": "","extra": "#0\ncount_star()"}],"table": "","extra": "ORDERS:\ncount_star() DESC\nc_orders.c_count DESC"}
%%%%%%%%%%%%%%%% Running Query #  14  threads:  1
SELECT 100.00 * sum( CASE WHEN p_type LIKE 'PROMO%' THEN l_extendedprice * (1 - l_discount) ELSE 0 END) / sum(l_extendedprice * (1 - l_discount)) AS promo_revenue FROM lineitem, part WHERE l_partkey = p_partkey AND l_shipdate >= date '1995-09-01' AND l_shipdate < CAST('1995-10-01' AS date);
Run:  None SELECT 100.00 * sum( CASE WHEN p_type LIKE 'PROMO%' THEN l_extendedprice * (1 - l_discount) ELSE 0 END) / sum(l_extendedprice * (1 - l_discount)) AS promo_revenue FROM lineitem, part WHERE l_partkey = p_partkey AND l_shipdate >= date '1995-09-01' AND l_shipdate < CAST('1995-10-01' AS date);
Avg Time in sec:  0.10027072671800852  output size:  1
   promo_revenue
0      16.380779
{'name': 'Query', 'result': 0.097691, 'timing': 0.097691, 'cardinality': 0, 'extra-info': "SELECT 100.00 * sum( CASE WHEN p_type LIKE 'PROMO%' THEN l_extendedprice * (1 - l_discount) ELSE 0 END) / sum(l_extendedprice * (1 - l_discount)) AS promo_revenue FROM lineitem, part WHERE l_partkey = p_partkey AND l_shipdate >= date '1995-09-01' AND l_shipdate < CAST('1995-10-01' AS date);", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 6e-06, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 9e-06, 'cardinality': 1, 'extra_info': 'promo_revenue\n', 'children': [{'name': 'UNGROUPED_AGGREGATE', 'timing': 0.000245, 'cardinality': 1, 'extra_info': 'sum(#0)\nsum(#1)', 'children': [{'name': 'PROJECTION', 'timing': 0.001387, 'cardinality': 75983, 'extra_info': "CASE  WHEN (prefix(p_type, 'PROMO')) THEN ((l_extendedprice * (1.00 - l_discount))) ELSE 0.0000 END\n(l_extendedprice * (1.00 - l_discount))\n", 'children': [{'name': 'HASH_JOIN', 'timing': 0.038352, 'cardinality': 75983, 'extra_info': 'INNER\nl_partkey = p_partkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 641407\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.039106, 'cardinality': 75983, 'extra_info': "lineitem\n[INFOSEPARATOR]\nl_partkey\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nFilters: l_shipdate>='1995-09-01'::DATE AND l_shipdate<'1995-10-01'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243", 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 0.003948, 'cardinality': 200000, 'extra_info': 'part\n[INFOSEPARATOR]\np_partkey\np_type\n[INFOSEPARATOR]\nEC: 200000', 'children': []}]}]}]}]}]}]}
X {'RESULT_COLLECTOR0': 6e-06, 'PROJECTION1': 9e-06, 'UNGROUPED_AGGREGATE2': 0.000245, 'PROJECTION3': 0.001387, 'HASH_JOIN4': 0.038352, 'SEQ_SCAN 5': 0.039106, 'SEQ_SCAN 6': 0.003948}
**** output size:  1
LINEAGE_4_HASH_JOIN_2
LINEAGE_4_SEQ_SCAN_0
LINEAGE_4_SEQ_SCAN_1
SELECT 100.00 * sum( CASE WHEN p_type LIKE 'PROMO%' THEN l_extendedprice * (1 - l_discount) ELSE 0 END) / sum(l_extendedprice * (1 - l_discount)) AS promo_revenue FROM lineitem, part WHERE l_partkey = p_partkey AND l_shipdate >= date '1995-09-01' AND l_shipdate < CAST('1995-10-01' AS date);
   query_id  ...                                               plan
0         4  ...  {"name": "PROJECTION", "opid": "5", "children"...

[1 rows x 7 columns]
Query info:  query_id                                                            4
query               SELECT 100.00 * sum( CASE WHEN p_type LIKE 'PR...
size_bytes_max                                                6790988
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "PROJECTION", "opid": "5", "children"...
Name: 0, dtype: object
{"name": "PROJECTION", "opid": "5", "children": [{"name": "UNGROUPED_AGGREGATE", "opid": "4", "children": [{"name": "PROJECTION", "opid": "3", "children": [{"name": "HASH_JOIN", "opid": "2", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_partkey\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nFilters: l_shipdate>='1995-09-01'::DATE AND l_shipdate<'1995-10-01'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243"},{"name": "SEQ_SCAN ", "opid": "1", "children": [],"table": "part","extra": "part\n[INFOSEPARATOR]\np_partkey\np_type\n[INFOSEPARATOR]\nEC: 200000"}],"table": "","extra": "INNER\nl_partkey = p_partkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 641407\n"}],"table": "","extra": "CASE  WHEN (prefix(p_type, 'PROMO')) THEN ((l_extendedprice * (1.00 - l_discount))) ELSE 0.0000 END\n(l_extendedprice * (1.00 - l_discount))\n"}],"table": "","extra": "sum(#0)\nsum(#1)"}],"table": "","extra": "promo_revenue\n"}
%%%%%%%%%%%%%%%% Running Query #  15  threads:  1
with revenue0 (supplier_no, total_revenue) as ( select l_suppkey, sum(l_extendedprice * (1 - l_discount)) from lineitem where l_shipdate >= date '1996-01-01' and l_shipdate < date '1996-01-01' + interval '3' month group by l_suppkey ) SELECT s_suppkey, s_name, s_address, s_phone, total_revenue FROM supplier, revenue0 WHERE s_suppkey = supplier_no AND total_revenue = ( SELECT max(total_revenue) FROM revenue0) ORDER BY s_suppkey;
Run:  None with revenue0 (supplier_no, total_revenue) as ( select l_suppkey, sum(l_extendedprice * (1 - l_discount)) from lineitem where l_shipdate >= date '1996-01-01' and l_shipdate < date '1996-01-01' + interval '3' month group by l_suppkey ) SELECT s_suppkey, s_name, s_address, s_phone, total_revenue FROM supplier, revenue0 WHERE s_suppkey = supplier_no AND total_revenue = ( SELECT max(total_revenue) FROM revenue0) ORDER BY s_suppkey;
Avg Time in sec:  0.1441807053051889  output size:  1
   s_suppkey              s_name  ...          s_phone total_revenue
0       8449  Supplier#000008449  ...  20-469-856-8873  1.772627e+06

[1 rows x 5 columns]
{'name': 'Query', 'result': 0.140796, 'timing': 0.140796, 'cardinality': 0, 'extra-info': "with revenue0 (supplier_no, total_revenue) as ( select l_suppkey, sum(l_extendedprice * (1 - l_discount)) from lineitem where l_shipdate >= date '1996-01-01' and l_shipdate < date '1996-01-01' + interval '3' month group by l_suppkey ) SELECT s_suppkey, s_name, s_address, s_phone, total_revenue FROM supplier, revenue0 WHERE s_suppkey = supplier_no AND total_revenue = ( SELECT max(total_revenue) FROM revenue0) ORDER BY s_suppkey;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 9e-06, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 4e-06, 'cardinality': 1, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n#1\n#2\n__internal_decompress_string(#3)\n#4\n', 'children': [{'name': 'ORDER_BY', 'timing': 3.4e-05, 'cardinality': 1, 'extra_info': 'ORDERS:\nsupplier.s_suppkey ASC', 'children': [{'name': 'PROJECTION', 'timing': 5e-06, 'cardinality': 1, 'extra_info': '__internal_compress_integral_usmallint(#0, 1)\n#1\n#2\n__internal_compress_string_hugeint(#3)\n#4\n', 'children': [{'name': 'PROJECTION', 'timing': 2e-06, 'cardinality': 1, 'extra_info': 's_suppkey\ns_name\ns_address\ns_phone\ntotal_revenue\n', 'children': [{'name': 'HASH_JOIN', 'timing': 9.2e-05, 'cardinality': 1, 'extra_info': 'INNER\ns_suppkey = supplier_no\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 4\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.000538, 'cardinality': 10000, 'extra_info': 'supplier\n[INFOSEPARATOR]\ns_suppkey\ns_name\ns_address\ns_phone\n[INFOSEPARATOR]\nEC: 10000', 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.000168, 'cardinality': 1, 'extra_info': 'INNER\ntotal_revenue = SUBQUERY\n\n[INFOSEPARATOR]\nEC: 3\n', 'children': [{'name': 'PROJECTION', 'timing': 9e-06, 'cardinality': 10000, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n#1\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.012651, 'cardinality': 10000, 'extra_info': '#0\nsum_no_overflow(#1)', 'children': [{'name': 'PROJECTION', 'timing': 0.010434, 'cardinality': 225954, 'extra_info': 'l_suppkey\n(l_extendedprice * (1.00 - l_discount))\n', 'children': [{'name': 'PROJECTION', 'timing': 0.005099, 'cardinality': 225954, 'extra_info': '__internal_compress_integral_usmallint(#0, 1)\n#1\n#2\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.03762, 'cardinality': 225954, 'extra_info': "lineitem\n[INFOSEPARATOR]\nl_suppkey\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nFilters: l_shipdate>='1996-01-01'::DATE AND l_shipdate<'1996-04-01'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243", 'children': []}]}]}]}]}, {'name': 'UNGROUPED_AGGREGATE', 'timing': 2e-06, 'cardinality': 1, 'extra_info': 'first(#0)', 'children': [{'name': 'PROJECTION', 'timing': 0.0, 'cardinality': 1, 'extra_info': '#0\n', 'children': [{'name': 'STREAMING_LIMIT', 'timing': 2e-06, 'cardinality': 1, 'extra_info': '', 'children': [{'name': 'UNGROUPED_AGGREGATE', 'timing': 2.6e-05, 'cardinality': 1, 'extra_info': 'max(#0)', 'children': [{'name': 'PROJECTION', 'timing': 1e-06, 'cardinality': 10000, 'extra_info': 'total_revenue\n', 'children': [{'name': 'PROJECTION', 'timing': 1e-06, 'cardinality': 10000, 'extra_info': 'sum((l_extendedprice * (CAST(1 AS DECIMAL(16,2)) - l_discount)))\n', 'children': [{'name': 'PROJECTION', 'timing': 1e-05, 'cardinality': 10000, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n#1\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.012241, 'cardinality': 10000, 'extra_info': '#0\nsum_no_overflow(#1)', 'children': [{'name': 'PROJECTION', 'timing': 0.01002, 'cardinality': 225954, 'extra_info': 'l_suppkey\n(l_extendedprice * (1.00 - l_discount))\n', 'children': [{'name': 'PROJECTION', 'timing': 0.004932, 'cardinality': 225954, 'extra_info': '__internal_compress_integral_usmallint(#0, 1)\n#1\n#2\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.036052, 'cardinality': 225954, 'extra_info': "lineitem\n[INFOSEPARATOR]\nl_suppkey\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nFilters: l_shipdate>='1996-01-01'::DATE AND l_shipdate<'1996-04-01'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243", 'children': []}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}
uncompressed filter_log_size: 1392
uncompressed filter_log_buffer_size: 0
uncompressed limit_offset_size: 1416
uncompressed limit_offset_buffer_size: 0
uncompressed perfect_full_scan_ht_log_size: 1528
uncompressed perfect_full_scan_ht_log_buffer_size: 72
uncompressed perfect_probe_ht_log_size: 1432
uncompressed perfect_probe_ht_log_buffer_size: 8
uncompressed row_group_log_size: 2071424
uncompressed row_group_log_buffer_size: 1807632
uncompressed scatter_log_size: 3747728
uncompressed scatter_log_buffer_size: 3615264
uncompressed scatter_sel_log_size: 1472
uncompressed scatter_sel_log_buffer_size: 16
uncompressed gather_log_size: 1392
uncompressed gather_log_buffer_size: 0
uncompressed combine_log_size: 1392
uncompressed combine_log_buffer_size: 0
uncompressed finalize_states_log_size: 161648
uncompressed finalize_states_log_buffer_size: 160000
uncompressed join_gather_log_size: 1436
uncompressed join_gather_log_buffer_size: 12
uncompressed reorder_log_size: 1424
uncompressed reorder_log_buffer_size: 0
uncompressed cross_log_size: 1392
uncompressed cross_log_buffer_size: 0
uncompressed nlj_log_size: 1392
uncompressed nlj_log_buffer_size: 0
uncompressed total_size: 5996468
uncompressed total_buffer_size: 5583004
uncompressed total_element_size: 413464

Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│__internal_decompress_strin│                                                                                       
│           g(#0)           │                                                                                       
│             #1            │                                                                                       
│__internal_decompress_integ│                                                                                       
│     ral_integer(#2, 1)    │                                                                                       
│             #3            │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│          ORDER_BY         │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│          ORDERS:          │                                                                                       
│  count(DISTINCT partsupp  │                                                                                       
│     .ps_suppkey) DESC     │                                                                                       
│      part.p_brand ASC     │                                                                                       
│      part.p_type ASC      │                                                                                       
│      part.p_size ASC      │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│__internal_compress_string_│                                                                                       
│        hugeint(#0)        │                                                                                       
│             #1            │                                                                                       
│__internal_compress_integra│                                                                                       
│     l_utinyint(#2, 1)     │                                                                                       
│             #3            │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│__internal_decompress_strin│                                                                                       
│           g(#0)           │                                                                                       
│             #1            │                                                                                       
│__internal_decompress_integ│                                                                                       
│     ral_integer(#2, 1)    │                                                                                       
│             #3            │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│       HASH_GROUP_BY       │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│             #0            │                                                                                       
│             #1            │                                                                                       
│             #2            │                                                                                       
│     count(DISTINCT #3)    │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│          p_brand          │                                                                                       
│           p_type          │                                                                                       
│           p_size          │                                                                                       
│         ps_suppkey        │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│             #0            │                                                                                       
│__internal_compress_string_│                                                                                       
│        hugeint(#1)        │                                                                                       
│             #2            │                                                                                       
│__internal_compress_integra│                                                                                       
│     l_utinyint(#3, 1)     │                                                                                       
│             #4            │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│             #1            │                                                                                       
│             #3            │                                                                                       
│             #4            │                                                                                       
│             #5            │                                                                                       
│             #6            │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│           FILTER          │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│       (NOT SUBQUERY)      │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│         EC: 33778         │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         HASH_JOIN         │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│            MARK           │                                                                                       
│      ps_suppkey = #0      ├────────────────────────────────────────────────────────────────────────┐              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                        │              
│         EC: 168893        │                                                                        │              
└─────────────┬─────────────┘                                                                        │                                           
┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐
│         HASH_JOIN         │                                                          │         PROJECTION        │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│           INNER           │                                                          │         s_suppkey         │
│   ps_partkey = p_partkey  │                                                          │                           │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐                                           │                           │
│        Build Min: 1       │              │                                           │                           │
│     Build Max: 200000     │              │                                           │                           │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                           │                           │
│         EC: 168893        │              │                                           │                           │
└─────────────┬─────────────┘              │                                           └─────────────┬─────────────┘                             
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐
│         SEQ_SCAN          ││           FILTER          │                             │           FILTER          │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│          partsupp         ││ (IN (...) AND (p_brand != │                             │  (s_comment ~~ '%Customer │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││'Brand#45') AND (NOT prefix│                             │       %Complaints%')      │
│         ps_partkey        ││(p_type, 'MEDIUM POLIS...  │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│         ps_suppkey        ││             )             │                             │          EC: 2000         │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │                           │
│         EC: 800000        ││         EC: 40000         │                             │                           │
└───────────────────────────┘└─────────────┬─────────────┘                             └─────────────┬─────────────┘                             
                             ┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐
                             │         HASH_JOIN         │                             │         SEQ_SCAN          │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                             │            MARK           │                             │          supplier         │
                             │        p_size = #0        │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐              │         s_comment         │
                             │         EC: 200000        │              │              │         s_suppkey         │
                             │                           │              │              │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                             │                           │              │              │         EC: 10000         │
                             └─────────────┬─────────────┘              │              └───────────────────────────┘                             
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             
                             │         SEQ_SCAN          ││      COLUMN_DATA_SCAN     │                             
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                             
                             │            part           ││                           │                             
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                             
                             │         p_partkey         ││                           │                             
                             │          p_brand          ││                           │                             
                             │           p_type          ││                           │                             
                             │           p_size          ││                           │                             
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                             
                             │         EC: 200000        ││                           │                             
                             └───────────────────────────┘└───────────────────────────┘                                                          

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

X {'RESULT_COLLECTOR0': 9e-06, 'PROJECTION1': 4e-06, 'ORDER_BY2': 3.4e-05, 'PROJECTION3': 5e-06, 'PROJECTION4': 2e-06, 'HASH_JOIN5': 9.2e-05, 'SEQ_SCAN 6': 0.000538, 'HASH_JOIN7': 0.000168, 'PROJECTION8': 9e-06, 'HASH_GROUP_BY9': 0.012651, 'PROJECTION10': 0.010434, 'PROJECTION11': 0.005099, 'SEQ_SCAN 12': 0.03762, 'UNGROUPED_AGGREGATE13': 2e-06, 'PROJECTION14': 0.0, 'STREAMING_LIMIT15': 2e-06, 'UNGROUPED_AGGREGATE16': 2.6e-05, 'PROJECTION17': 1e-06, 'PROJECTION18': 1e-06, 'PROJECTION19': 1e-05, 'HASH_GROUP_BY20': 0.012241, 'PROJECTION21': 0.01002, 'PROJECTION22': 0.004932, 'SEQ_SCAN 23': 0.036052}
**** output size:  1
LINEAGE_4_HASH_GROUP_BY_4
LINEAGE_4_HASH_GROUP_BY_9
LINEAGE_4_HASH_JOIN_17
LINEAGE_4_HASH_JOIN_18
LINEAGE_4_ORDER_BY_21
LINEAGE_4_SEQ_SCAN_0
LINEAGE_4_SEQ_SCAN_1
LINEAGE_4_SEQ_SCAN_6
LINEAGE_4_STREAMING_LIMIT_14
with revenue0 (supplier_no, total_revenue) as ( select l_suppkey, sum(l_extendedprice * (1 - l_discount)) from lineitem where l_shipdate >= date '1996-01-01' and l_shipdate < date '1996-01-01' + interval '3' month group by l_suppkey ) SELECT s_suppkey, s_name, s_address, s_phone, total_revenue FROM supplier, revenue0 WHERE s_suppkey = supplier_no AND total_revenue = ( SELECT max(total_revenue) FROM revenue0) ORDER BY s_suppkey;
   query_id  ...                                               plan
0         4  ...  {"name": "PROJECTION", "opid": "22", "children...

[1 rows x 7 columns]
Query info:  query_id                                                            4
query               with revenue0 (supplier_no, total_revenue) as ...
size_bytes_max                                                5996468
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "PROJECTION", "opid": "22", "children...
Name: 0, dtype: object
{"name": "PROJECTION", "opid": "22", "children": [{"name": "ORDER_BY", "opid": "21", "children": [{"name": "PROJECTION", "opid": "20", "children": [{"name": "PROJECTION", "opid": "19", "children": [{"name": "HASH_JOIN", "opid": "18", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "supplier","extra": "supplier\n[INFOSEPARATOR]\ns_suppkey\ns_name\ns_address\ns_phone\n[INFOSEPARATOR]\nEC: 10000"},{"name": "HASH_JOIN", "opid": "17", "children": [{"name": "PROJECTION", "opid": "5", "children": [{"name": "HASH_GROUP_BY", "opid": "4", "children": [{"name": "PROJECTION", "opid": "3", "children": [{"name": "PROJECTION", "opid": "2", "children": [{"name": "SEQ_SCAN ", "opid": "1", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_suppkey\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nFilters: l_shipdate>='1996-01-01'::DATE AND l_shipdate<'1996-04-01'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243"}],"table": "","extra": "__internal_compress_integral_usmallint(#0, 1)\n#1\n#2\n"}],"table": "","extra": "l_suppkey\n(l_extendedprice * (1.00 - l_discount))\n"}],"table": "","extra": "#0\nsum_no_overflow(#1)"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n#1\n"},{"name": "UNGROUPED_AGGREGATE", "opid": "16", "children": [{"name": "PROJECTION", "opid": "15", "children": [{"name": "STREAMING_LIMIT", "opid": "14", "children": [{"name": "UNGROUPED_AGGREGATE", "opid": "13", "children": [{"name": "PROJECTION", "opid": "12", "children": [{"name": "PROJECTION", "opid": "11", "children": [{"name": "PROJECTION", "opid": "10", "children": [{"name": "HASH_GROUP_BY", "opid": "9", "children": [{"name": "PROJECTION", "opid": "8", "children": [{"name": "PROJECTION", "opid": "7", "children": [{"name": "SEQ_SCAN ", "opid": "6", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_suppkey\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nFilters: l_shipdate>='1996-01-01'::DATE AND l_shipdate<'1996-04-01'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243"}],"table": "","extra": "__internal_compress_integral_usmallint(#0, 1)\n#1\n#2\n"}],"table": "","extra": "l_suppkey\n(l_extendedprice * (1.00 - l_discount))\n"}],"table": "","extra": "#0\nsum_no_overflow(#1)"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n#1\n"}],"table": "","extra": "sum((l_extendedprice * (CAST(1 AS DECIMAL(16,2)) - l_discount)))\n"}],"table": "","extra": "total_revenue\n"}],"table": "","extra": "max(#0)"}],"table": "","extra": ""}],"table": "","extra": "#0\n"}],"table": "","extra": "first(#0)"}],"table": "","extra": "INNER\ntotal_revenue = SUBQUERY\n\n[INFOSEPARATOR]\nEC: 3\n"}],"table": "","extra": "INNER\ns_suppkey = supplier_no\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 4\n"}],"table": "","extra": "s_suppkey\ns_name\ns_address\ns_phone\ntotal_revenue\n"}],"table": "","extra": "__internal_compress_integral_usmallint(#0, 1)\n#1\n#2\n__internal_compress_string_hugeint(#3)\n#4\n"}],"table": "","extra": "ORDERS:\nsupplier.s_suppkey ASC"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n#1\n#2\n__internal_decompress_string(#3)\n#4\n"}
%%%%%%%%%%%%%%%% Running Query #  16  threads:  1
SELECT p_brand, p_type, p_size, count(DISTINCT ps_suppkey) AS supplier_cnt FROM partsupp, part WHERE p_partkey = ps_partkey AND p_brand <> 'Brand#45' AND p_type NOT LIKE 'MEDIUM POLISHED%' AND p_size IN (49, 14, 23, 45, 19, 3, 36, 9) AND ps_suppkey NOT IN ( SELECT s_suppkey FROM supplier WHERE s_comment LIKE '%Customer%Complaints%') GROUP BY p_brand, p_type, p_size ORDER BY supplier_cnt DESC, p_brand, p_type, p_size;
Run:  None SELECT p_brand, p_type, p_size, count(DISTINCT ps_suppkey) AS supplier_cnt FROM partsupp, part WHERE p_partkey = ps_partkey AND p_brand <> 'Brand#45' AND p_type NOT LIKE 'MEDIUM POLISHED%' AND p_size IN (49, 14, 23, 45, 19, 3, 36, 9) AND ps_suppkey NOT IN ( SELECT s_suppkey FROM supplier WHERE s_comment LIKE '%Customer%Complaints%') GROUP BY p_brand, p_type, p_size ORDER BY supplier_cnt DESC, p_brand, p_type, p_size;
Avg Time in sec:  0.09708613995462656  output size:  18314
        p_brand                    p_type  p_size  supplier_cnt
0      Brand#41        MEDIUM BRUSHED TIN       3            28
1      Brand#54   STANDARD BRUSHED COPPER      14            27
2      Brand#11      STANDARD BRUSHED TIN      23            24
3      Brand#11  STANDARD BURNISHED BRASS      36            24
4      Brand#15    MEDIUM ANODIZED NICKEL       3            24
...         ...                       ...     ...           ...
18309  Brand#52      MEDIUM BRUSHED BRASS      45             3
18310  Brand#53        MEDIUM BRUSHED TIN      45             3
18311  Brand#54    ECONOMY POLISHED BRASS       9             3
18312  Brand#55        PROMO PLATED BRASS      19             3
18313  Brand#55       STANDARD PLATED TIN      49             3

[18314 rows x 4 columns]
{'name': 'Query', 'result': 0.091509, 'timing': 0.091509, 'cardinality': 0, 'extra-info': "SELECT p_brand, p_type, p_size, count(DISTINCT ps_suppkey) AS supplier_cnt FROM partsupp, part WHERE p_partkey = ps_partkey AND p_brand <> 'Brand#45' AND p_type NOT LIKE 'MEDIUM POLISHED%' AND p_size IN (49, 14, 23, 45, 19, 3, 36, 9) AND ps_suppkey NOT IN ( SELECT s_suppkey FROM supplier WHERE s_comment LIKE '%Customer%Complaints%') GROUP BY p_brand, p_type, p_size ORDER BY supplier_cnt DESC, p_brand, p_type, p_size;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 0.001416, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 0.000407, 'cardinality': 18314, 'extra_info': '__internal_decompress_string(#0)\n#1\n__internal_decompress_integral_integer(#2, 1)\n#3\n', 'children': [{'name': 'ORDER_BY', 'timing': 0.00209, 'cardinality': 18314, 'extra_info': 'ORDERS:\ncount(DISTINCT partsupp.ps_suppkey) DESC\npart.p_brand ASC\npart.p_type ASC\npart.p_size ASC', 'children': [{'name': 'PROJECTION', 'timing': 0.000219, 'cardinality': 18314, 'extra_info': '__internal_compress_string_hugeint(#0)\n#1\n__internal_compress_integral_utinyint(#2, 1)\n#3\n', 'children': [{'name': 'PROJECTION', 'timing': 0.000427, 'cardinality': 18314, 'extra_info': '__internal_decompress_string(#0)\n#1\n__internal_decompress_integral_integer(#2, 1)\n#3\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.020957, 'cardinality': 18314, 'extra_info': '#0\n#1\n#2\ncount(DISTINCT #3)', 'children': [{'name': 'PROJECTION', 'timing': 0.000154, 'cardinality': 118274, 'extra_info': 'p_brand\np_type\np_size\nps_suppkey\n', 'children': [{'name': 'PROJECTION', 'timing': 0.002522, 'cardinality': 118274, 'extra_info': '#0\n__internal_compress_string_hugeint(#1)\n#2\n__internal_compress_integral_utinyint(#3, 1)\n#4\n', 'children': [{'name': 'PROJECTION', 'timing': 0.000229, 'cardinality': 118274, 'extra_info': '#1\n#3\n#4\n#5\n#6\n', 'children': [{'name': 'FILTER', 'timing': 0.000751, 'cardinality': 118274, 'extra_info': '(NOT SUBQUERY)\n[INFOSEPARATOR]\nEC: 33778', 'children': [{'name': 'HASH_JOIN', 'timing': 0.005522, 'cardinality': 118324, 'extra_info': 'MARK\nps_suppkey = #0\n\n[INFOSEPARATOR]\nEC: 168893\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.007756, 'cardinality': 118324, 'extra_info': 'INNER\nps_partkey = p_partkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 168893\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.001348, 'cardinality': 800000, 'extra_info': 'partsupp\n[INFOSEPARATOR]\nps_partkey\nps_suppkey\n[INFOSEPARATOR]\nEC: 800000', 'children': []}, {'name': 'FILTER', 'timing': 0.001584, 'cardinality': 29581, 'extra_info': "(IN (...) AND (p_brand != 'Brand#45') AND (NOT prefix(p_type, 'MEDIUM POLISHED')))\n[INFOSEPARATOR]\nEC: 40000", 'children': [{'name': 'HASH_JOIN', 'timing': 0.001724, 'cardinality': 200000, 'extra_info': 'MARK\np_size = #0\n\n[INFOSEPARATOR]\nEC: 200000\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.00901, 'cardinality': 200000, 'extra_info': 'part\n[INFOSEPARATOR]\np_partkey\np_brand\np_type\np_size\n[INFOSEPARATOR]\nEC: 200000', 'children': []}, {'name': 'COLUMN_DATA_SCAN', 'timing': 5e-06, 'cardinality': 8, 'extra_info': '', 'children': []}]}]}]}, {'name': 'PROJECTION', 'timing': 1e-06, 'cardinality': 4, 'extra_info': 's_suppkey\n', 'children': [{'name': 'FILTER', 'timing': 0.000246, 'cardinality': 4, 'extra_info': "(s_comment ~~ '%Customer%Complaints%')\n[INFOSEPARATOR]\nEC: 2000", 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.000249, 'cardinality': 10000, 'extra_info': 'supplier\n[INFOSEPARATOR]\ns_comment\ns_suppkey\n[INFOSEPARATOR]\nEC: 10000', 'children': []}]}]}]}]}]}]}]}]}]}]}]}]}]}]}
uncompressed filter_log_size: 197100
uncompressed filter_log_buffer_size: 180396
uncompressed limit_offset_size: 1248
uncompressed limit_offset_buffer_size: 0
uncompressed perfect_full_scan_ht_log_size: 474664
uncompressed perfect_full_scan_ht_log_buffer_size: 473352
uncompressed perfect_probe_ht_log_size: 964224
uncompressed perfect_probe_ht_log_buffer_size: 946592
uncompressed row_group_log_size: 21984
uncompressed row_group_log_buffer_size: 0
uncompressed scatter_log_size: 955632
uncompressed scatter_log_buffer_size: 946192
uncompressed scatter_sel_log_size: 360524
uncompressed scatter_sel_log_buffer_size: 355116
uncompressed gather_log_size: 1248
uncompressed gather_log_buffer_size: 0
uncompressed combine_log_size: 1248
uncompressed combine_log_buffer_size: 0
uncompressed finalize_states_log_size: 148016
uncompressed finalize_states_log_buffer_size: 146512
uncompressed join_gather_log_size: 1248
uncompressed join_gather_log_buffer_size: 0
uncompressed reorder_log_size: 147784
uncompressed reorder_log_buffer_size: 0
uncompressed cross_log_size: 1248
uncompressed cross_log_buffer_size: 0
uncompressed nlj_log_size: 1248
uncompressed nlj_log_buffer_size: 0
uncompressed total_size: 3277416
uncompressed total_buffer_size: 3048160
uncompressed total_element_size: 229256

Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐                                                                                                                    
│         PROJECTION        │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│         avg_yearly        │                                                                                                                    
└─────────────┬─────────────┘                                                                                                                                                 
┌─────────────┴─────────────┐                                                                                                                    
│    UNGROUPED_AGGREGATE    │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│          sum(#0)          │                                                                                                                    
└─────────────┬─────────────┘                                                                                                                                                 
┌─────────────┴─────────────┐                                                                                                                    
│         PROJECTION        │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│      l_extendedprice      │                                                                                                                    
└─────────────┬─────────────┘                                                                                                                                                 
┌─────────────┴─────────────┐                                                                                                                    
│         PROJECTION        │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│             #0            │                                                                                                                    
│             #3            │                                                                                                                    
│             #4            │                                                                                                                    
└─────────────┬─────────────┘                                                                                                                                                 
┌─────────────┴─────────────┐                                                                                                                    
│           FILTER          │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│(CAST(l_quantity AS DOUBLE)│                                                                                                                    
│         < SUBQUERY)       │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│        EC: 3000607        │                                                                                                                    
└─────────────┬─────────────┘                                                                                                                                                 
┌─────────────┴─────────────┐                                                                                                                    
│      RIGHT_DELIM_JOIN     │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│           RIGHT           │                                                                                                                    
│ p_partkey IS NOT DISTINCT ├───────────────────────────────────────────┐                                                                        
│       FROM p_partkey      │                                           │                                                                        
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                           │                                                                        
│        EC: 3000607        │                                           │                                                                        
└─────────────┬─────────────┘                                           │                                                                                                     
┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐                                                          
│         HASH_JOIN         │                             │         HASH_JOIN         │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│           INNER           │                             │           RIGHT           │                                                          
│   l_partkey = p_partkey   │                             │ p_partkey IS NOT DISTINCT │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐              │       FROM p_partkey      ├───────────────────────────────────────────┐              
│        Build Min: 1       │              │              │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                           │              
│     Build Max: 200000     │              │              │        EC: 3000607        │                                           │              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              │                           │                                           │              
│         EC: 80175         │              │              │                           │                                           │              
└─────────────┬─────────────┘              │              └─────────────┬─────────────┘                                           │                                           
┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐
│         SEQ_SCAN          ││         SEQ_SCAN          ││         PROJECTION        │                             │         DUMMY_SCAN        │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │                           │
│          lineitem         ││            part           ││  (0.2 * avg(l_quantity))  │                             │                           │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││         p_partkey         │                             │                           │
│         l_partkey         ││         p_partkey         ││                           │                             │                           │
│         l_quantity        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                             │                           │
│      l_extendedprice      ││Filters: p_brand='Brand#23'││                           │                             │                           │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   AND p_brand IS NOT NULL ││                           │                             │                           │
│        EC: 6001215        ││ p_container='MED BOX' AND ││                           │                             │                           │
│                           ││   p_container IS NOT NULL ││                           │                             │                           │
│                           ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                             │                           │
│                           ││          EC: 5000         ││                           │                             │                           │
└───────────────────────────┘└───────────────────────────┘└─────────────┬─────────────┘                             └───────────────────────────┘                             
                                                          ┌─────────────┴─────────────┐                                                          
                                                          │         PROJECTION        │                                                          
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                          │__internal_decompress_integ│                                                          
                                                          │     ral_bigint(#0, 1)     │                                                          
                                                          │             #1            │                                                          
                                                          └─────────────┬─────────────┘                                                                                       
                                                          ┌─────────────┴─────────────┐                                                          
                                                          │       HASH_GROUP_BY       │                                                          
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                          │             #0            │                                                          
                                                          │          avg(#1)          │                                                          
                                                          └─────────────┬─────────────┘                                                                                       
                                                          ┌─────────────┴─────────────┐                                                          
                                                          │         PROJECTION        │                                                          
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                          │         p_partkey         │                                                          
                                                          │         l_quantity        │                                                          
                                                          └─────────────┬─────────────┘                                                                                       
                                                          ┌─────────────┴─────────────┐                                                          
                                                          │         PROJECTION        │                                                          
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                          │__internal_compress_integra│                                                          
                                                          │     l_uinteger(#0, 1)     │                                                          
                                                          │             #1            │                                                          
                                                          │             #2            │                                                          
                                                          └─────────────┬─────────────┘                                                                                       
                                                          ┌─────────────┴─────────────┐                                                          
                                                          │         HASH_JOIN         │                                                          
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                          │           INNER           │                                                          
                                                          │   l_partkey = p_partkey   ├──────────────┐                                           
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                           
                                                          │        EC: 6001215        │              │                                           
                                                          └─────────────┬─────────────┘              │                                                                        
                                                          ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             
                                                          │         SEQ_SCAN          ││         DELIM_SCAN        │                             
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                             
                                                          │          lineitem         ││                           │                             
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                             
                                                          │         l_partkey         ││                           │                             
                                                          │         l_quantity        ││                           │                             
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                             
                                                          │        EC: 6001215        ││                           │                             
                                                          └───────────────────────────┘└───────────────────────────┘                                                          

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

X {'RESULT_COLLECTOR0': 0.001416, 'PROJECTION1': 0.000407, 'ORDER_BY2': 0.00209, 'PROJECTION3': 0.000219, 'PROJECTION4': 0.000427, 'HASH_GROUP_BY5': 0.020957, 'PROJECTION6': 0.000154, 'PROJECTION7': 0.002522, 'PROJECTION8': 0.000229, 'FILTER9': 0.000751, 'HASH_JOIN10': 0.005522, 'HASH_JOIN11': 0.007756, 'SEQ_SCAN 12': 0.001348, 'FILTER13': 0.001584, 'HASH_JOIN14': 0.001724, 'SEQ_SCAN 15': 0.00901, 'COLUMN_DATA_SCAN16': 5e-06, 'PROJECTION17': 1e-06, 'FILTER18': 0.000246, 'SEQ_SCAN 19': 0.000249}
**** output size:  18314
LINEAGE_4_COLUMN_DATA_SCAN_2
LINEAGE_4_FILTER_10
LINEAGE_4_FILTER_4
LINEAGE_4_FILTER_7
LINEAGE_4_HASH_GROUP_BY_14
LINEAGE_4_HASH_JOIN_3
LINEAGE_4_HASH_JOIN_5
LINEAGE_4_HASH_JOIN_9
LINEAGE_4_ORDER_BY_17
LINEAGE_4_SEQ_SCAN_0
LINEAGE_4_SEQ_SCAN_1
LINEAGE_4_SEQ_SCAN_6
SELECT p_brand, p_type, p_size, count(DISTINCT ps_suppkey) AS supplier_cnt FROM partsupp, part WHERE p_partkey = ps_partkey AND p_brand <> 'Brand#45' AND p_type NOT LIKE 'MEDIUM POLISHED%' AND p_size IN (49, 14, 23, 45, 19, 3, 36, 9) AND ps_suppkey NOT IN ( SELECT s_suppkey FROM supplier WHERE s_comment LIKE '%Customer%Complaints%') GROUP BY p_brand, p_type, p_size ORDER BY supplier_cnt DESC, p_brand, p_type, p_size;
   query_id  ...                                               plan
0         4  ...  {"name": "PROJECTION", "opid": "18", "children...

[1 rows x 7 columns]
Query info:  query_id                                                            4
query               SELECT p_brand, p_type, p_size, count(DISTINCT...
size_bytes_max                                                3277416
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "PROJECTION", "opid": "18", "children...
Name: 0, dtype: object
{"name": "PROJECTION", "opid": "18", "children": [{"name": "ORDER_BY", "opid": "17", "children": [{"name": "PROJECTION", "opid": "16", "children": [{"name": "PROJECTION", "opid": "15", "children": [{"name": "HASH_GROUP_BY", "opid": "14", "children": [{"name": "PROJECTION", "opid": "13", "children": [{"name": "PROJECTION", "opid": "12", "children": [{"name": "PROJECTION", "opid": "11", "children": [{"name": "FILTER", "opid": "10", "children": [{"name": "HASH_JOIN", "opid": "9", "children": [{"name": "HASH_JOIN", "opid": "5", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "partsupp","extra": "partsupp\n[INFOSEPARATOR]\nps_partkey\nps_suppkey\n[INFOSEPARATOR]\nEC: 800000"},{"name": "FILTER", "opid": "4", "children": [{"name": "HASH_JOIN", "opid": "3", "children": [{"name": "SEQ_SCAN ", "opid": "1", "children": [],"table": "part","extra": "part\n[INFOSEPARATOR]\np_partkey\np_brand\np_type\np_size\n[INFOSEPARATOR]\nEC: 200000"},{"name": "COLUMN_DATA_SCAN", "opid": "2", "children": [],"table": "","extra": ""}],"table": "","extra": "MARK\np_size = #0\n\n[INFOSEPARATOR]\nEC: 200000\n"}],"table": "","extra": "(IN (...) AND (p_brand != 'Brand#45') AND (NOT prefix(p_type, 'MEDIUM POLISHED')))\n[INFOSEPARATOR]\nEC: 40000"}],"table": "","extra": "INNER\nps_partkey = p_partkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 168893\n"},{"name": "PROJECTION", "opid": "8", "children": [{"name": "FILTER", "opid": "7", "children": [{"name": "SEQ_SCAN ", "opid": "6", "children": [],"table": "supplier","extra": "supplier\n[INFOSEPARATOR]\ns_comment\ns_suppkey\n[INFOSEPARATOR]\nEC: 10000"}],"table": "","extra": "(s_comment ~~ '%Customer%Complaints%')\n[INFOSEPARATOR]\nEC: 2000"}],"table": "","extra": "s_suppkey\n"}],"table": "","extra": "MARK\nps_suppkey = #0\n\n[INFOSEPARATOR]\nEC: 168893\n"}],"table": "","extra": "(NOT SUBQUERY)\n[INFOSEPARATOR]\nEC: 33778"}],"table": "","extra": "#1\n#3\n#4\n#5\n#6\n"}],"table": "","extra": "#0\n__internal_compress_string_hugeint(#1)\n#2\n__internal_compress_integral_utinyint(#3, 1)\n#4\n"}],"table": "","extra": "p_brand\np_type\np_size\nps_suppkey\n"}],"table": "","extra": "#0\n#1\n#2\ncount(DISTINCT #3)"}],"table": "","extra": "__internal_decompress_string(#0)\n#1\n__internal_decompress_integral_integer(#2, 1)\n#3\n"}],"table": "","extra": "__internal_compress_string_hugeint(#0)\n#1\n__internal_compress_integral_utinyint(#2, 1)\n#3\n"}],"table": "","extra": "ORDERS:\ncount(DISTINCT partsupp.ps_suppkey) DESC\npart.p_brand ASC\npart.p_type ASC\npart.p_size ASC"}],"table": "","extra": "__internal_decompress_string(#0)\n#1\n__internal_decompress_integral_integer(#2, 1)\n#3\n"}
%%%%%%%%%%%%%%%% Running Query #  17  threads:  1
SELECT sum(l_extendedprice) / 7.0 AS avg_yearly FROM lineitem, part WHERE p_partkey = l_partkey AND p_brand = 'Brand#23' AND p_container = 'MED BOX' AND l_quantity < ( SELECT 0.2 * avg(l_quantity) FROM lineitem WHERE l_partkey = p_partkey);
Run:  None SELECT sum(l_extendedprice) / 7.0 AS avg_yearly FROM lineitem, part WHERE p_partkey = l_partkey AND p_brand = 'Brand#23' AND p_container = 'MED BOX' AND l_quantity < ( SELECT 0.2 * avg(l_quantity) FROM lineitem WHERE l_partkey = p_partkey);
Avg Time in sec:  0.1415196950547397  output size:  1
      avg_yearly
0  348406.054286
{'name': 'Query', 'result': 0.13705, 'timing': 0.13705, 'cardinality': 0, 'extra-info': "SELECT sum(l_extendedprice) / 7.0 AS avg_yearly FROM lineitem, part WHERE p_partkey = l_partkey AND p_brand = 'Brand#23' AND p_container = 'MED BOX' AND l_quantity < ( SELECT 0.2 * avg(l_quantity) FROM lineitem WHERE l_partkey = p_partkey);", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 4e-06, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 4e-06, 'cardinality': 1, 'extra_info': 'avg_yearly\n', 'children': [{'name': 'UNGROUPED_AGGREGATE', 'timing': 5e-06, 'cardinality': 1, 'extra_info': 'sum(#0)', 'children': [{'name': 'PROJECTION', 'timing': 0.0, 'cardinality': 587, 'extra_info': 'l_extendedprice\n', 'children': [{'name': 'PROJECTION', 'timing': 1e-06, 'cardinality': 587, 'extra_info': '#0\n#3\n#4\n', 'children': [{'name': 'FILTER', 'timing': 0.000276, 'cardinality': 587, 'extra_info': '(CAST(l_quantity AS DOUBLE) < SUBQUERY)\n[INFOSEPARATOR]\nEC: 3000607', 'children': [{'name': 'RIGHT_DELIM_JOIN', 'timing': 0.001402, 'cardinality': 0, 'extra_info': 'RIGHT\np_partkey IS NOT DISTINCT FROM p_partkey\n\n[INFOSEPARATOR]\nEC: 3000607\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.028575, 'cardinality': 6088, 'extra_info': 'INNER\nl_partkey = p_partkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 80175\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.010701, 'cardinality': 6001215, 'extra_info': 'lineitem\n[INFOSEPARATOR]\nl_partkey\nl_quantity\nl_extendedprice\n[INFOSEPARATOR]\nEC: 6001215', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 0.014416, 'cardinality': 204, 'extra_info': "part\n[INFOSEPARATOR]\np_partkey\n[INFOSEPARATOR]\nFilters: p_brand='Brand#23' AND p_brand IS NOT NULL\np_container='MED BOX' AND p_container IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 5000", 'children': []}]}, {'name': 'HASH_JOIN', 'timing': 0.000303, 'cardinality': 6088, 'extra_info': 'RIGHT\np_partkey IS NOT DISTINCT FROM p_partkey\n\n[INFOSEPARATOR]\nEC: 3000607\n', 'children': [{'name': 'PROJECTION', 'timing': 1.6e-05, 'cardinality': 204, 'extra_info': '(0.2 * avg(l_quantity))\np_partkey\n', 'children': [{'name': 'PROJECTION', 'timing': 3e-06, 'cardinality': 204, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n#1\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.000827, 'cardinality': 204, 'extra_info': '#0\navg(#1)', 'children': [{'name': 'PROJECTION', 'timing': 4e-06, 'cardinality': 6088, 'extra_info': 'p_partkey\nl_quantity\n', 'children': [{'name': 'PROJECTION', 'timing': 3.5e-05, 'cardinality': 6088, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n#1\n#2\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.064005, 'cardinality': 6088, 'extra_info': 'INNER\nl_partkey = p_partkey\n\n[INFOSEPARATOR]\nEC: 6001215\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.005772, 'cardinality': 6001215, 'extra_info': 'lineitem\n[INFOSEPARATOR]\nl_partkey\nl_quantity\n[INFOSEPARATOR]\nEC: 6001215', 'children': []}, {'name': 'DELIM_SCAN', 'timing': 0.0, 'cardinality': 0, 'extra_info': '', 'children': []}]}]}]}]}]}]}, {'name': 'DUMMY_SCAN', 'timing': 0.0, 'cardinality': 0, 'extra_info': '', 'children': []}]}, {'name': 'HASH_GROUP_BY', 'timing': 1.7e-05, 'cardinality': 204, 'extra_info': '#0', 'children': []}]}]}]}]}]}]}]}]}
uncompressed filter_log_size: 5084
uncompressed filter_log_buffer_size: 2348
uncompressed limit_offset_size: 1200
uncompressed limit_offset_buffer_size: 0
uncompressed perfect_full_scan_ht_log_size: 4584
uncompressed perfect_full_scan_ht_log_buffer_size: 3320
uncompressed perfect_probe_ht_log_size: 180976
uncompressed perfect_probe_ht_log_buffer_size: 48704
uncompressed row_group_log_size: 268256
uncompressed row_group_log_buffer_size: 816
uncompressed scatter_log_size: 98736
uncompressed scatter_log_buffer_size: 97408
uncompressed scatter_sel_log_size: 83264
uncompressed scatter_sel_log_buffer_size: 77808
uncompressed gather_log_size: 1200
uncompressed gather_log_buffer_size: 0
uncompressed combine_log_size: 1200
uncompressed combine_log_buffer_size: 0
uncompressed finalize_states_log_size: 4496
uncompressed finalize_states_log_buffer_size: 3264
uncompressed join_gather_log_size: 280432
uncompressed join_gather_log_buffer_size: 146112
uncompressed reorder_log_size: 1200
uncompressed reorder_log_buffer_size: 0
uncompressed cross_log_size: 1200
uncompressed cross_log_buffer_size: 0
uncompressed nlj_log_size: 1200
uncompressed nlj_log_buffer_size: 0
uncompressed total_size: 933028
uncompressed total_buffer_size: 379780
uncompressed total_element_size: 553248

Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐                                                                                       
│      STREAMING_LIMIT      │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│             #0            │                                                                                       
│__internal_decompress_integ│                                                                                       
│     ral_bigint(#1, 1)     │                                                                                       
│__internal_decompress_integ│                                                                                       
│     ral_bigint(#2, 1)     │                                                                                       
│             #3            │                                                                                       
│             #4            │                                                                                       
│             #5            │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│          ORDER_BY         │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│          ORDERS:          │                                                                                       
│  orders.o_totalprice DESC │                                                                                       
│   orders.o_orderdate ASC  │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│             #0            │                                                                                       
│__internal_compress_integra│                                                                                       
│     l_uinteger(#1, 1)     │                                                                                       
│__internal_compress_integra│                                                                                       
│     l_uinteger(#2, 1)     │                                                                                       
│             #3            │                                                                                       
│             #4            │                                                                                       
│             #5            │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│             #0            │                                                                                       
│__internal_decompress_integ│                                                                                       
│     ral_bigint(#1, 1)     │                                                                                       
│__internal_decompress_integ│                                                                                       
│     ral_bigint(#2, 1)     │                                                                                       
│             #3            │                                                                                       
│             #4            │                                                                                       
│             #5            │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│       HASH_GROUP_BY       │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│             #0            │                                                                                       
│             #1            │                                                                                       
│             #2            │                                                                                       
│             #3            │                                                                                       
│             #4            │                                                                                       
│          sum(#5)          │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│           c_name          │                                                                                       
│         c_custkey         │                                                                                       
│         o_orderkey        │                                                                                       
│        o_orderdate        │                                                                                       
│        o_totalprice       │                                                                                       
│         l_quantity        │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│__internal_compress_integra│                                                                                       
│     l_uinteger(#0, 1)     │                                                                                       
│             #1            │                                                                                       
│__internal_compress_integra│                                                                                       
│     l_uinteger(#2, 1)     │                                                                                       
│__internal_compress_integra│                                                                                       
│     l_uinteger(#3, 1)     │                                                                                       
│             #4            │                                                                                       
│             #5            │                                                                                       
│             #6            │                                                                                       
│__internal_compress_integra│                                                                                       
│     l_uinteger(#7, 1)     │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         HASH_JOIN         │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│           INNER           │                                                                                       
│      o_orderkey = #0      ├────────────────────────────────────────────────────────────────────────┐              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                        │              
│        EC: 3618677        │                                                                        │              
└─────────────┬─────────────┘                                                                        │                                           
┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐
│         HASH_JOIN         │                                                          │         PROJECTION        │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│           INNER           │                                                          │__internal_decompress_integ│
│  l_orderkey = o_orderkey  ├──────────────┐                                           │     ral_bigint(#0, 1)     │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                           │                           │
│        EC: 3618677        │              │                                           │                           │
└─────────────┬─────────────┘              │                                           └─────────────┬─────────────┘                             
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐
│         SEQ_SCAN          ││         HASH_JOIN         │                             │       HASH_GROUP_BY       │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│          lineitem         ││           INNER           │                             │             #0            │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   o_custkey = c_custkey   │                             │                           │
│         l_orderkey        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐              │                           │
│         l_quantity        ││        Build Min: 1       │              │              │                           │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││     Build Max: 149999     │              │              │                           │
│        EC: 6001215        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              │                           │
│                           ││         EC: 904486        │              │              │                           │
└───────────────────────────┘└─────────────┬─────────────┘              │              └─────────────┬─────────────┘                             
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐
                             │         SEQ_SCAN          ││         SEQ_SCAN          ││         PROJECTION        │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                             │           orders          ││          customer         ││             #0            │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │
                             │         o_orderkey        ││         c_custkey         ││                           │
                             │         o_custkey         ││           c_name          ││                           │
                             │        o_orderdate        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │
                             │        o_totalprice       ││ Filters: c_custkey<=149999││                           │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││  AND c_custkey IS NOT NULL││                           │
                             │        EC: 1500000        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │
                             │                           ││         EC: 150000        ││                           │
                             └───────────────────────────┘└───────────────────────────┘└─────────────┬─────────────┘                             
                                                                                       ┌─────────────┴─────────────┐
                                                                                       │         PROJECTION        │
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                       │__internal_compress_integra│
                                                                                       │     l_uinteger(#0, 1)     │
                                                                                       └─────────────┬─────────────┘                             
                                                                                       ┌─────────────┴─────────────┐
                                                                                       │         PROJECTION        │
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                       │         l_orderkey        │
                                                                                       └─────────────┬─────────────┘                             
                                                                                       ┌─────────────┴─────────────┐
                                                                                       │           FILTER          │
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                       │ (sum(l_quantity) > 300.00)│
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                       │         EC: 47042         │
                                                                                       └─────────────┬─────────────┘                             
                                                                                       ┌─────────────┴─────────────┐
                                                                                       │         PROJECTION        │
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                       │__internal_decompress_integ│
                                                                                       │     ral_bigint(#0, 1)     │
                                                                                       │             #1            │
                                                                                       └─────────────┬─────────────┘                             
                                                                                       ┌─────────────┴─────────────┐
                                                                                       │       HASH_GROUP_BY       │
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                       │             #0            │
                                                                                       │    sum_no_overflow(#1)    │
                                                                                       └─────────────┬─────────────┘                             
                                                                                       ┌─────────────┴─────────────┐
                                                                                       │         PROJECTION        │
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                       │         l_orderkey        │
                                                                                       │         l_quantity        │
                                                                                       └─────────────┬─────────────┘                             
                                                                                       ┌─────────────┴─────────────┐
                                                                                       │         PROJECTION        │
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                       │__internal_compress_integra│
                                                                                       │     l_uinteger(#0, 1)     │
                                                                                       │             #1            │
                                                                                       └─────────────┬─────────────┘                             
                                                                                       ┌─────────────┴─────────────┐
                                                                                       │         SEQ_SCAN          │
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                       │          lineitem         │
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                       │         l_orderkey        │
                                                                                       │         l_quantity        │
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                       │        EC: 6001215        │
                                                                                       └───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

X {'RESULT_COLLECTOR0': 4e-06, 'PROJECTION1': 4e-06, 'UNGROUPED_AGGREGATE2': 5e-06, 'PROJECTION3': 0.0, 'PROJECTION4': 1e-06, 'FILTER5': 0.000276, 'RIGHT_DELIM_JOIN6': 0.001402, 'HASH_JOIN7': 0.028575, 'SEQ_SCAN 8': 0.010701, 'SEQ_SCAN 9': 0.014416, 'HASH_JOIN10': 0.000303, 'PROJECTION11': 1.6e-05, 'PROJECTION12': 3e-06, 'HASH_GROUP_BY13': 0.000827, 'PROJECTION14': 4e-06, 'PROJECTION15': 3.5e-05, 'HASH_JOIN16': 0.064005, 'SEQ_SCAN 17': 0.005772, 'DELIM_SCAN18': 0.0, 'DUMMY_SCAN19': 0.0, 'HASH_GROUP_BY20': 1.7e-05}
**** output size:  1
LINEAGE_4_FILTER_15
LINEAGE_4_HASH_GROUP_BY_10
LINEAGE_4_HASH_GROUP_BY_5
LINEAGE_4_HASH_JOIN_13
LINEAGE_4_HASH_JOIN_2
LINEAGE_4_HASH_JOIN_9
LINEAGE_4_SEQ_SCAN_0
LINEAGE_4_SEQ_SCAN_11
LINEAGE_4_SEQ_SCAN_12
SELECT sum(l_extendedprice) / 7.0 AS avg_yearly FROM lineitem, part WHERE p_partkey = l_partkey AND p_brand = 'Brand#23' AND p_container = 'MED BOX' AND l_quantity < ( SELECT 0.2 * avg(l_quantity) FROM lineitem WHERE l_partkey = p_partkey);
   query_id  ...                                               plan
0         4  ...  {"name": "PROJECTION", "opid": "19", "children...

[1 rows x 7 columns]
Query info:  query_id                                                            4
query               SELECT sum(l_extendedprice) / 7.0 AS avg_yearl...
size_bytes_max                                                 933028
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "PROJECTION", "opid": "19", "children...
Name: 0, dtype: object
{"name": "PROJECTION", "opid": "19", "children": [{"name": "UNGROUPED_AGGREGATE", "opid": "18", "children": [{"name": "PROJECTION", "opid": "17", "children": [{"name": "PROJECTION", "opid": "16", "children": [{"name": "FILTER", "opid": "15", "children": [{"name": "RIGHT_DELIM_JOIN", "opid": "14", "children": [{"name": "HASH_GROUP_BY", "opid": "10", "children": [],"table": "","extra": "#0"},{"name": "HASH_JOIN", "opid": "9", "children": [{"name": "PROJECTION", "opid": "7", "children": [{"name": "PROJECTION", "opid": "6", "children": [{"name": "HASH_GROUP_BY", "opid": "5", "children": [{"name": "PROJECTION", "opid": "4", "children": [{"name": "PROJECTION", "opid": "3", "children": [{"name": "HASH_JOIN", "opid": "2", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_partkey\nl_quantity\n[INFOSEPARATOR]\nEC: 6001215"},{"name": "DELIM_SCAN", "opid": "1", "children": [],"table": "","extra": ""}],"table": "","extra": "INNER\nl_partkey = p_partkey\n\n[INFOSEPARATOR]\nEC: 6001215\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n#1\n#2\n"}],"table": "","extra": "p_partkey\nl_quantity\n"}],"table": "","extra": "#0\navg(#1)"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n#1\n"}],"table": "","extra": "(0.2 * avg(l_quantity))\np_partkey\n"},{"name": "DUMMY_SCAN", "opid": "8", "children": [],"table": "","extra": ""}],"table": "","extra": "RIGHT\np_partkey IS NOT DISTINCT FROM p_partkey\n\n[INFOSEPARATOR]\nEC: 3000607\n"},{"name": "HASH_JOIN", "opid": "13", "children": [{"name": "SEQ_SCAN ", "opid": "11", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_partkey\nl_quantity\nl_extendedprice\n[INFOSEPARATOR]\nEC: 6001215"},{"name": "SEQ_SCAN ", "opid": "12", "children": [],"table": "part","extra": "part\n[INFOSEPARATOR]\np_partkey\n[INFOSEPARATOR]\nFilters: p_brand='Brand#23' AND p_brand IS NOT NULL\np_container='MED BOX' AND p_container IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 5000"}],"table": "","extra": "INNER\nl_partkey = p_partkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 80175\n"}],"table": "","extra": "RIGHT\np_partkey IS NOT DISTINCT FROM p_partkey\n\n[INFOSEPARATOR]\nEC: 3000607\n"}],"table": "","extra": "(CAST(l_quantity AS DOUBLE) < SUBQUERY)\n[INFOSEPARATOR]\nEC: 3000607"}],"table": "","extra": "#0\n#3\n#4\n"}],"table": "","extra": "l_extendedprice\n"}],"table": "","extra": "sum(#0)"}],"table": "","extra": "avg_yearly\n"}
%%%%%%%%%%%%%%%% Running Query #  18  threads:  1
SELECT c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, sum(l_quantity) FROM customer, orders, lineitem WHERE o_orderkey IN ( SELECT l_orderkey FROM lineitem GROUP BY l_orderkey HAVING sum(l_quantity) > 300) AND c_custkey = o_custkey AND o_orderkey = l_orderkey GROUP BY c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice ORDER BY o_totalprice DESC, o_orderdate LIMIT 100;
Run:  None SELECT c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, sum(l_quantity) FROM customer, orders, lineitem WHERE o_orderkey IN ( SELECT l_orderkey FROM lineitem GROUP BY l_orderkey HAVING sum(l_quantity) > 300) AND c_custkey = o_custkey AND o_orderkey = l_orderkey GROUP BY c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice ORDER BY o_totalprice DESC, o_orderdate LIMIT 100;
Avg Time in sec:  1.1748457639478147  output size:  57
                c_name  c_custkey  ...  o_totalprice sum(l_quantity)
0   Customer#000128120     128120  ...     544089.09           323.0
1   Customer#000144617     144617  ...     530604.44           317.0
2   Customer#000013940      13940  ...     522720.61           304.0
3   Customer#000066790      66790  ...     515531.82           327.0
4   Customer#000046435      46435  ...     508047.99           309.0
5   Customer#000015272      15272  ...     500241.33           302.0
6   Customer#000146608     146608  ...     499794.58           303.0
7   Customer#000096103      96103  ...     494398.79           312.0
8   Customer#000024341      24341  ...     491348.26           302.0
9   Customer#000137446     137446  ...     487763.25           311.0
10  Customer#000107590     107590  ...     485141.38           301.0
11  Customer#000050008      50008  ...     483891.26           302.0
12  Customer#000015619      15619  ...     480083.96           318.0
13  Customer#000077260      77260  ...     479499.43           307.0
14  Customer#000109379     109379  ...     478064.11           302.0
15  Customer#000054602      54602  ...     471220.08           307.0
16  Customer#000105995     105995  ...     469692.58           307.0
17  Customer#000148885     148885  ...     469630.44           313.0
18  Customer#000114586     114586  ...     469605.59           308.0
19  Customer#000105260     105260  ...     469360.57           303.0
20  Customer#000147197     147197  ...     467149.67           320.0
21  Customer#000064483      64483  ...     466991.35           304.0
22  Customer#000136573     136573  ...     461282.73           301.0
23  Customer#000016384      16384  ...     458378.92           312.0
24  Customer#000117919     117919  ...     456815.92           317.0
25  Customer#000012251      12251  ...     455107.26           309.0
26  Customer#000120098     120098  ...     453451.23           308.0
27  Customer#000066098      66098  ...     453436.16           304.0
28  Customer#000117076     117076  ...     449545.85           301.0
29  Customer#000129379     129379  ...     448665.79           303.0
30  Customer#000126865     126865  ...     447606.65           320.0
31  Customer#000088876      88876  ...     446717.46           304.0
32  Customer#000036619      36619  ...     446704.09           328.0
33  Customer#000141823     141823  ...     446269.12           310.0
34  Customer#000053029      53029  ...     446144.49           302.0
35  Customer#000018188      18188  ...     443807.22           308.0
36  Customer#000066533      66533  ...     443576.50           305.0
37  Customer#000037729      37729  ...     441082.97           309.0
38  Customer#000003566       3566  ...     439803.36           304.0
39  Customer#000045538      45538  ...     436275.31           305.0
40  Customer#000081581      81581  ...     435405.90           305.0
41  Customer#000119989     119989  ...     434568.25           320.0
42  Customer#000003680       3680  ...     433525.97           301.0
43  Customer#000113131     113131  ...     432957.75           301.0
44  Customer#000141098     141098  ...     430986.69           301.0
45  Customer#000093392      93392  ...     425487.51           304.0
46  Customer#000015631      15631  ...     419879.59           302.0
47  Customer#000112987     112987  ...     418161.49           305.0
48  Customer#000012599      12599  ...     415200.61           304.0
49  Customer#000105410     105410  ...     412754.51           302.0
50  Customer#000149842     149842  ...     411329.35           302.0
51  Customer#000010129      10129  ...     409129.85           309.0
52  Customer#000069904      69904  ...     408513.00           305.0
53  Customer#000017746      17746  ...     408446.93           303.0
54  Customer#000013072      13072  ...     399195.47           301.0
55  Customer#000082441      82441  ...     382579.74           305.0
56  Customer#000088703      88703  ...     363812.12           302.0

[57 rows x 6 columns]
uncompressed filter_log_size: 3252
uncompressed filter_log_buffer_size: 228
uncompressed limit_offset_size: 1512
uncompressed limit_offset_buffer_size: 0
uncompressed perfect_full_scan_ht_log_size: 2401592
uncompressed perfect_full_scan_ht_log_buffer_size: 2400040
uncompressed perfect_probe_ht_log_size: 6037712
uncompressed perfect_probe_ht_log_buffer_size: 6003456
uncompressed row_group_log_size: 900492
uncompressed row_group_log_buffer_size: 599996
uncompressed scatter_log_size: 48080424
uncompressed scatter_log_buffer_size: 48013368
uncompressed scatter_sel_log_size: 19839056
uncompressed scatter_sel_log_buffer_size: 19800672
uncompressed gather_log_size: 1488
uncompressed gather_log_buffer_size: 0
uncompressed combine_log_size: 1488
uncompressed combine_log_buffer_size: 0
uncompressed finalize_states_log_size: 12018816
uncompressed finalize_states_log_buffer_size: 12000912
uncompressed join_gather_log_size: 72547192
uncompressed join_gather_log_buffer_size: 72019368
uncompressed reorder_log_size: 1968
uncompressed reorder_log_buffer_size: 0
uncompressed cross_log_size: 1488
uncompressed cross_log_buffer_size: 0
uncompressed nlj_log_size: 1488
uncompressed nlj_log_buffer_size: 0
uncompressed total_size: 161837968
uncompressed total_buffer_size: 160838040
uncompressed total_element_size: 999928

{'name': 'Query', 'result': 1.163475, 'timing': 1.163475, 'cardinality': 0, 'extra-info': 'SELECT c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, sum(l_quantity) FROM customer, orders, lineitem WHERE o_orderkey IN ( SELECT l_orderkey FROM lineitem GROUP BY l_orderkey HAVING sum(l_quantity) > 300) AND c_custkey = o_custkey AND o_orderkey = l_orderkey GROUP BY c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice ORDER BY o_totalprice DESC, o_orderdate LIMIT 100;', 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 1.2e-05, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'STREAMING_LIMIT', 'timing': 2e-06, 'cardinality': 57, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 2e-06, 'cardinality': 57, 'extra_info': '#0\n__internal_decompress_integral_bigint(#1, 1)\n__internal_decompress_integral_bigint(#2, 1)\n#3\n#4\n#5\n', 'children': [{'name': 'ORDER_BY', 'timing': 4.6e-05, 'cardinality': 57, 'extra_info': 'ORDERS:\norders.o_totalprice DESC\norders.o_orderdate ASC', 'children': [{'name': 'PROJECTION', 'timing': 4e-06, 'cardinality': 57, 'extra_info': '#0\n__internal_compress_integral_uinteger(#1, 1)\n__internal_compress_integral_uinteger(#2, 1)\n#3\n#4\n#5\n', 'children': [{'name': 'PROJECTION', 'timing': 2.1e-05, 'cardinality': 57, 'extra_info': '#0\n__internal_decompress_integral_bigint(#1, 1)\n__internal_decompress_integral_bigint(#2, 1)\n#3\n#4\n#5\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.000804, 'cardinality': 57, 'extra_info': '#0\n#1\n#2\n#3\n#4\nsum(#5)', 'children': [{'name': 'PROJECTION', 'timing': 2e-06, 'cardinality': 399, 'extra_info': 'c_name\nc_custkey\no_orderkey\no_orderdate\no_totalprice\nl_quantity\n', 'children': [{'name': 'PROJECTION', 'timing': 2.3e-05, 'cardinality': 399, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n#1\n__internal_compress_integral_uinteger(#2, 1)\n__internal_compress_integral_uinteger(#3, 1)\n#4\n#5\n#6\n__internal_compress_integral_uinteger(#7, 1)\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.093165, 'cardinality': 399, 'extra_info': 'INNER\no_orderkey = #0\n\n[INFOSEPARATOR]\nEC: 3618677\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.483473, 'cardinality': 6001215, 'extra_info': 'INNER\nl_orderkey = o_orderkey\n\n[INFOSEPARATOR]\nEC: 3618677\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.008401, 'cardinality': 6001215, 'extra_info': 'lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_quantity\n[INFOSEPARATOR]\nEC: 6001215', 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.019157, 'cardinality': 1500000, 'extra_info': 'INNER\no_custkey = c_custkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 149999\n\n[INFOSEPARATOR]\nEC: 904486\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.004692, 'cardinality': 1500000, 'extra_info': 'orders\n[INFOSEPARATOR]\no_orderkey\no_custkey\no_orderdate\no_totalprice\n[INFOSEPARATOR]\nEC: 1500000', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 0.00404, 'cardinality': 149999, 'extra_info': 'customer\n[INFOSEPARATOR]\nc_custkey\nc_name\n[INFOSEPARATOR]\nFilters: c_custkey<=149999 AND c_custkey IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 150000', 'children': []}]}]}, {'name': 'PROJECTION', 'timing': 3e-06, 'cardinality': 57, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.000301, 'cardinality': 57, 'extra_info': '#0', 'children': [{'name': 'PROJECTION', 'timing': 1e-06, 'cardinality': 57, 'extra_info': '#0\n', 'children': [{'name': 'PROJECTION', 'timing': 3e-06, 'cardinality': 57, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n', 'children': [{'name': 'PROJECTION', 'timing': 1e-06, 'cardinality': 57, 'extra_info': 'l_orderkey\n', 'children': [{'name': 'FILTER', 'timing': 0.004073, 'cardinality': 57, 'extra_info': '(sum(l_quantity) > 300.00)\n[INFOSEPARATOR]\nEC: 47042', 'children': [{'name': 'PROJECTION', 'timing': 0.001164, 'cardinality': 1500000, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n#1\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.40884, 'cardinality': 1500000, 'extra_info': '#0\nsum_no_overflow(#1)', 'children': [{'name': 'PROJECTION', 'timing': 0.000838, 'cardinality': 6001215, 'extra_info': 'l_orderkey\nl_quantity\n', 'children': [{'name': 'PROJECTION', 'timing': 0.008253, 'cardinality': 6001215, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n#1\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.008327, 'cardinality': 6001215, 'extra_info': 'lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_quantity\n[INFOSEPARATOR]\nEC: 6001215', 'children': []}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}
X {'RESULT_COLLECTOR0': 1.2e-05, 'STREAMING_LIMIT1': 2e-06, 'PROJECTION2': 2e-06, 'ORDER_BY3': 4.6e-05, 'PROJECTION4': 4e-06, 'PROJECTION5': 2.1e-05, 'HASH_GROUP_BY6': 0.000804, 'PROJECTION7': 2e-06, 'PROJECTION8': 2.3e-05, 'HASH_JOIN9': 0.093165, 'HASH_JOIN10': 0.483473, 'SEQ_SCAN 11': 0.008401, 'HASH_JOIN12': 0.019157, 'SEQ_SCAN 13': 0.004692, 'SEQ_SCAN 14': 0.00404, 'PROJECTION15': 3e-06, 'HASH_GROUP_BY16': 0.000301, 'PROJECTION17': 1e-06, 'PROJECTION18': 3e-06, 'PROJECTION19': 1e-06, 'FILTER20': 0.004073, 'PROJECTION21': 0.001164, 'HASH_GROUP_BY22': 0.40884, 'PROJECTION23': 0.000838, 'PROJECTION24': 0.008253, 'SEQ_SCAN 25': 0.008327}
**** output size:  57
LINEAGE_4_FILTER_10
LINEAGE_4_HASH_GROUP_BY_14
LINEAGE_4_HASH_GROUP_BY_19
LINEAGE_4_HASH_GROUP_BY_8
LINEAGE_4_HASH_JOIN_16
LINEAGE_4_HASH_JOIN_3
LINEAGE_4_HASH_JOIN_4
LINEAGE_4_ORDER_BY_22
LINEAGE_4_SEQ_SCAN_0
LINEAGE_4_SEQ_SCAN_1
LINEAGE_4_SEQ_SCAN_2
LINEAGE_4_SEQ_SCAN_5
LINEAGE_4_STREAMING_LIMIT_24
SELECT c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, sum(l_quantity) FROM customer, orders, lineitem WHERE o_orderkey IN ( SELECT l_orderkey FROM lineitem GROUP BY l_orderkey HAVING sum(l_quantity) > 300) AND c_custkey = o_custkey AND o_orderkey = l_orderkey GROUP BY c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice ORDER BY o_totalprice DESC, o_orderdate LIMIT 100;
   query_id  ...                                               plan
0         4  ...  {"name": "STREAMING_LIMIT", "opid": "24", "chi...

[1 rows x 7 columns]
Query info:  query_id                                                            4
query               SELECT c_name, c_custkey, o_orderkey, o_orderd...
size_bytes_max                                              161837968
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "STREAMING_LIMIT", "opid": "24", "chi...
Name: 0, dtype: object
{"name": "STREAMING_LIMIT", "opid": "24", "children": [{"name": "PROJECTION", "opid": "23", "children": [{"name": "ORDER_BY", "opid": "22", "children": [{"name": "PROJECTION", "opid": "21", "children": [{"name": "PROJECTION", "opid": "20", "children": [{"name": "HASH_GROUP_BY", "opid": "19", "children": [{"name": "PROJECTION", "opid": "18", "children": [{"name": "PROJECTION", "opid": "17", "children": [{"name": "HASH_JOIN", "opid": "16", "children": [{"name": "HASH_JOIN", "opid": "4", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_quantity\n[INFOSEPARATOR]\nEC: 6001215"},{"name": "HASH_JOIN", "opid": "3", "children": [{"name": "SEQ_SCAN ", "opid": "1", "children": [],"table": "orders","extra": "orders\n[INFOSEPARATOR]\no_orderkey\no_custkey\no_orderdate\no_totalprice\n[INFOSEPARATOR]\nEC: 1500000"},{"name": "SEQ_SCAN ", "opid": "2", "children": [],"table": "customer","extra": "customer\n[INFOSEPARATOR]\nc_custkey\nc_name\n[INFOSEPARATOR]\nFilters: c_custkey<=149999 AND c_custkey IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 150000"}],"table": "","extra": "INNER\no_custkey = c_custkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 149999\n\n[INFOSEPARATOR]\nEC: 904486\n"}],"table": "","extra": "INNER\nl_orderkey = o_orderkey\n\n[INFOSEPARATOR]\nEC: 3618677\n"},{"name": "PROJECTION", "opid": "15", "children": [{"name": "HASH_GROUP_BY", "opid": "14", "children": [{"name": "PROJECTION", "opid": "13", "children": [{"name": "PROJECTION", "opid": "12", "children": [{"name": "PROJECTION", "opid": "11", "children": [{"name": "FILTER", "opid": "10", "children": [{"name": "PROJECTION", "opid": "9", "children": [{"name": "HASH_GROUP_BY", "opid": "8", "children": [{"name": "PROJECTION", "opid": "7", "children": [{"name": "PROJECTION", "opid": "6", "children": [{"name": "SEQ_SCAN ", "opid": "5", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_quantity\n[INFOSEPARATOR]\nEC: 6001215"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n#1\n"}],"table": "","extra": "l_orderkey\nl_quantity\n"}],"table": "","extra": "#0\nsum_no_overflow(#1)"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n#1\n"}],"table": "","extra": "(sum(l_quantity) > 300.00)\n[INFOSEPARATOR]\nEC: 47042"}],"table": "","extra": "l_orderkey\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n"}],"table": "","extra": "#0\n"}],"table": "","extra": "#0"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n"}],"table": "","extra": "INNER\no_orderkey = #0\n\n[INFOSEPARATOR]\nEC: 3618677\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n#1\n__internal_compress_integral_uinteger(#2, 1)\n__internal_compress_integral_uinteger(#3, 1)\n#4\n#5\n#6\n__internal_compress_integral_uinteger(#7, 1)\n"}],"table": "","extra": "c_name\nc_custkey\no_orderkey\no_orderdate\no_totalprice\nl_quantity\n"}],"table": "","extra": "#0\n#1\n#2\n#3\n#4\nsum(#5)"}],"table": "","extra": "#0\n__internal_decompress_integral_bigint(#1, 1)\n__internal_decompress_integral_bigint(#2, 1)\n#3\n#4\n#5\n"}],"table": "","extra": "#0\n__internal_compress_integral_uinteger(#1, 1)\n__internal_compress_integral_uinteger(#2, 1)\n#3\n#4\n#5\n"}],"table": "","extra": "ORDERS:\norders.o_totalprice DESC\norders.o_orderdate ASC"}],"table": "","extra": "#0\n__internal_decompress_integral_bigint(#1, 1)\n__internal_decompress_integral_bigint(#2, 1)\n#3\n#4\n#5\n"}],"table": "","extra": ""}
Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐                             
│    UNGROUPED_AGGREGATE    │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│          sum(#0)          │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│ (l_extendedprice * (1.00 -│                             
│        l_discount))       │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│             #1            │                             
│             #2            │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│             #1            │                             
│             #3            │                             
│             #4            │                             
│             #6            │                             
│             #7            │                             
│             #8            │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│           FILTER          │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│(((l_quantity <= 11.00) AND│                             
│ (p_size <= 5) AND (p_brand│                             
│     = 'Brand#12') AND (   │                             
│(p_container = 'SM CAS...  │                             
│(p_container = 'SM BOX...  │                             
│(p_container = 'SM PAC...  │                             
│(p_container = 'SM PKG...  │                             
│ ((l_quantity >= 10.00) AND│                             
│ (l_quantity <= 20.00) AND │                             
│(p_size <= 10) AND (p_brand│                             
│     = 'Brand#23') AND (   │                             
│(p_container = 'MED BA...  │                             
│(p_container = 'MED BO...  │                             
│(p_container = 'MED PK...  │                             
│(p_container = 'MED PA...  │                             
│  OR ((l_quantity >= 20.00)│                             
│  AND (l_quantity <= 30.00)│                             
│   AND (p_size <= 15) AND  │                             
│(p_brand = 'Brand#34')...  │                             
│(p_container = 'LG CAS...  │                             
│(p_container = 'LG BOX...  │                             
│(p_container = 'LG PAC...  │                             
│ (p_container = 'LG PKG')))│                             
│             )             │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│         EC: 160351        │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         HASH_JOIN         │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│           INNER           │                             
│   l_partkey = p_partkey   │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐              
│        Build Min: 1       │              │              
│     Build Max: 200000     │              │              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              
│         EC: 160351        │              │              
└─────────────┬─────────────┘              │                                           
┌─────────────┴─────────────┐┌─────────────┴─────────────┐
│           FILTER          ││         SEQ_SCAN          │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│ ((l_shipmode = 'AIR') OR  ││            part           │
│ (l_shipmode = 'AIR REG')) ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││         p_partkey         │
│         EC: 300060        ││          p_brand          │
│                           ││        p_container        │
│                           ││           p_size          │
│                           ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│                           ││         EC: 200000        │
└─────────────┬─────────────┘└───────────────────────────┘                             
┌─────────────┴─────────────┐                             
│         SEQ_SCAN          │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│          lineitem         │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│         l_partkey         │                             
│         l_quantity        │                             
│         l_shipmode        │                             
│      l_extendedprice      │                             
│         l_discount        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│  Filters: l_shipinstruct= │                             
│  'DELIVER IN PERSON' AND  │                             
│ l_shipinstruct IS NOT NULL│                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│         EC: 300060        │                             
└───────────────────────────┘                                                          

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

uncompressed filter_log_size: 960136
uncompressed filter_log_buffer_size: 857992
uncompressed limit_offset_size: 768
uncompressed limit_offset_buffer_size: 0
uncompressed perfect_full_scan_ht_log_size: 3200888
uncompressed perfect_full_scan_ht_log_buffer_size: 3200056
uncompressed perfect_probe_ht_log_size: 1846856
uncompressed perfect_probe_ht_log_buffer_size: 1715016
uncompressed row_group_log_size: 6136128
uncompressed row_group_log_buffer_size: 6000192
uncompressed scatter_log_size: 768
uncompressed scatter_log_buffer_size: 0
uncompressed scatter_sel_log_size: 2404864
uncompressed scatter_sel_log_buffer_size: 2400000
uncompressed gather_log_size: 768
uncompressed gather_log_buffer_size: 0
uncompressed combine_log_size: 768
uncompressed combine_log_buffer_size: 0
uncompressed finalize_states_log_size: 768
uncompressed finalize_states_log_buffer_size: 0
uncompressed join_gather_log_size: 768
uncompressed join_gather_log_buffer_size: 0
uncompressed reorder_log_size: 768
uncompressed reorder_log_buffer_size: 0
uncompressed cross_log_size: 768
uncompressed cross_log_buffer_size: 0
uncompressed nlj_log_size: 768
uncompressed nlj_log_buffer_size: 0
uncompressed total_size: 14555784
uncompressed total_buffer_size: 14173256
uncompressed total_element_size: 382528

%%%%%%%%%%%%%%%% Running Query #  19  threads:  1
SELECT sum(l_extendedprice * (1 - l_discount)) AS revenue FROM lineitem, part WHERE (p_partkey = l_partkey AND p_brand = 'Brand#12' AND p_container IN ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') AND l_quantity >= 1 AND l_quantity <= 1 + 10 AND p_size BETWEEN 1 AND 5 AND l_shipmode IN ('AIR', 'AIR REG') AND l_shipinstruct = 'DELIVER IN PERSON') OR (p_partkey = l_partkey AND p_brand = 'Brand#23' AND p_container IN ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') AND l_quantity >= 10 AND l_quantity <= 10 + 10 AND p_size BETWEEN 1 AND 10 AND l_shipmode IN ('AIR', 'AIR REG') AND l_shipinstruct = 'DELIVER IN PERSON') OR (p_partkey = l_partkey AND p_brand = 'Brand#34' AND p_container IN ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') AND l_quantity >= 20 AND l_quantity <= 20 + 10 AND p_size BETWEEN 1 AND 15 AND l_shipmode IN ('AIR', 'AIR REG') AND l_shipinstruct = 'DELIVER IN PERSON');
Run:  None SELECT sum(l_extendedprice * (1 - l_discount)) AS revenue FROM lineitem, part WHERE (p_partkey = l_partkey AND p_brand = 'Brand#12' AND p_container IN ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') AND l_quantity >= 1 AND l_quantity <= 1 + 10 AND p_size BETWEEN 1 AND 5 AND l_shipmode IN ('AIR', 'AIR REG') AND l_shipinstruct = 'DELIVER IN PERSON') OR (p_partkey = l_partkey AND p_brand = 'Brand#23' AND p_container IN ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') AND l_quantity >= 10 AND l_quantity <= 10 + 10 AND p_size BETWEEN 1 AND 10 AND l_shipmode IN ('AIR', 'AIR REG') AND l_shipinstruct = 'DELIVER IN PERSON') OR (p_partkey = l_partkey AND p_brand = 'Brand#34' AND p_container IN ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') AND l_quantity >= 20 AND l_quantity <= 20 + 10 AND p_size BETWEEN 1 AND 15 AND l_shipmode IN ('AIR', 'AIR REG') AND l_shipinstruct = 'DELIVER IN PERSON');
Avg Time in sec:  0.4851538618095219  output size:  1
        revenue
0  3.083843e+06
{'name': 'Query', 'result': 0.481599, 'timing': 0.481599, 'cardinality': 0, 'extra-info': "SELECT sum(l_extendedprice * (1 - l_discount)) AS revenue FROM lineitem, part WHERE (p_partkey = l_partkey AND p_brand = 'Brand#12' AND p_container IN ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') AND l_quantity >= 1 AND l_quantity <= 1 + 10 AND p_size BETWEEN 1 AND 5 AND l_shipmode IN ('AIR', 'AIR REG') AND l_shipinstruct = 'DELIVER IN PERSON') OR (p_partkey = l_partkey AND p_brand = 'Brand#23' AND p_container IN ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') AND l_quantity >= 10 AND l_quantity <= 10 + 10 AND p_size BETWEEN 1 AND 10 AND l_shipmode IN ('AIR', 'AIR REG') AND l_shipinstruct = 'DELIVER IN PERSON') OR (p_partkey = l_partkey AND p_brand = 'Brand#34' AND p_container IN ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') AND l_quantity >= 20 AND l_quantity <= 20 + 10 AND p_size BETWEEN 1 AND 15 AND l_shipmode IN ('AIR', 'AIR REG') AND l_shipinstruct = 'DELIVER IN PERSON');", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 5e-06, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'UNGROUPED_AGGREGATE', 'timing': 7e-06, 'cardinality': 1, 'extra_info': 'sum(#0)', 'children': [{'name': 'PROJECTION', 'timing': 1.5e-05, 'cardinality': 121, 'extra_info': '(l_extendedprice * (1.00 - l_discount))\n', 'children': [{'name': 'PROJECTION', 'timing': 1e-06, 'cardinality': 121, 'extra_info': '#1\n#2\n', 'children': [{'name': 'PROJECTION', 'timing': 3e-06, 'cardinality': 121, 'extra_info': '#1\n#3\n#4\n#6\n#7\n#8\n', 'children': [{'name': 'FILTER', 'timing': 0.059792, 'cardinality': 121, 'extra_info': "(((l_quantity <= 11.00) AND (p_size <= 5) AND (p_brand = 'Brand#12') AND ((p_container = 'SM CASE') OR (p_container = 'SM BOX') OR (p_container = 'SM PACK') OR (p_container = 'SM PKG'))) OR ((l_quantity >= 10.00) AND (l_quantity <= 20.00) AND (p_size <= 10) AND (p_brand = 'Brand#23') AND ((p_container = 'MED BAG') OR (p_container = 'MED BOX') OR (p_container = 'MED PKG') OR (p_container = 'MED PACK'))) OR ((l_quantity >= 20.00) AND (l_quantity <= 30.00) AND (p_size <= 15) AND (p_brand = 'Brand#34') AND ((p_container = 'LG CASE') OR (p_container = 'LG BOX') OR (p_container = 'LG PACK') OR (p_container = 'LG PKG'))))\n[INFOSEPARATOR]\nEC: 160351", 'children': [{'name': 'HASH_JOIN', 'timing': 0.020993, 'cardinality': 214377, 'extra_info': 'INNER\nl_partkey = p_partkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 160351\n', 'children': [{'name': 'FILTER', 'timing': 0.030314, 'cardinality': 214377, 'extra_info': "((l_shipmode = 'AIR') OR (l_shipmode = 'AIR REG'))\n[INFOSEPARATOR]\nEC: 300060", 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.333766, 'cardinality': 1500048, 'extra_info': "lineitem\n[INFOSEPARATOR]\nl_partkey\nl_quantity\nl_shipmode\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nFilters: l_shipinstruct='DELIVER IN PERSON' AND l_shipinstruct IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 300060", 'children': []}]}, {'name': 'SEQ_SCAN ', 'timing': 0.008735, 'cardinality': 200000, 'extra_info': 'part\n[INFOSEPARATOR]\np_partkey\np_brand\np_container\np_size\n[INFOSEPARATOR]\nEC: 200000', 'children': []}]}]}]}]}]}]}]}]}
X {'RESULT_COLLECTOR0': 5e-06, 'UNGROUPED_AGGREGATE1': 7e-06, 'PROJECTION2': 1.5e-05, 'PROJECTION3': 1e-06, 'PROJECTION4': 3e-06, 'FILTER5': 0.059792, 'HASH_JOIN6': 0.020993, 'FILTER7': 0.030314, 'SEQ_SCAN 8': 0.333766, 'SEQ_SCAN 9': 0.008735}
**** output size:  1
LINEAGE_4_FILTER_1
LINEAGE_4_FILTER_4
LINEAGE_4_HASH_JOIN_3
LINEAGE_4_SEQ_SCAN_0
LINEAGE_4_SEQ_SCAN_2
SELECT sum(l_extendedprice * (1 - l_discount)) AS revenue FROM lineitem, part WHERE (p_partkey = l_partkey AND p_brand = 'Brand#12' AND p_container IN ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') AND l_quantity >= 1 AND l_quantity <= 1 + 10 AND p_size BETWEEN 1 AND 5 AND l_shipmode IN ('AIR', 'AIR REG') AND l_shipinstruct = 'DELIVER IN PERSON') OR (p_partkey = l_partkey AND p_brand = 'Brand#23' AND p_container IN ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') AND l_quantity >= 10 AND l_quantity <= 10 + 10 AND p_size BETWEEN 1 AND 10 AND l_shipmode IN ('AIR', 'AIR REG') AND l_shipinstruct = 'DELIVER IN PERSON') OR (p_partkey = l_partkey AND p_brand = 'Brand#34' AND p_container IN ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') AND l_quantity >= 20 AND l_quantity <= 20 + 10 AND p_size BETWEEN 1 AND 15 AND l_shipmode IN ('AIR', 'AIR REG') AND l_shipinstruct = 'DELIVER IN PERSON');
   query_id  ...                                               plan
0         4  ...  {"name": "UNGROUPED_AGGREGATE", "opid": "8", "...

[1 rows x 7 columns]
Query info:  query_id                                                            4
query               SELECT sum(l_extendedprice * (1 - l_discount))...
size_bytes_max                                               14555784
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "UNGROUPED_AGGREGATE", "opid": "8", "...
Name: 0, dtype: object
{"name": "UNGROUPED_AGGREGATE", "opid": "8", "children": [{"name": "PROJECTION", "opid": "7", "children": [{"name": "PROJECTION", "opid": "6", "children": [{"name": "PROJECTION", "opid": "5", "children": [{"name": "FILTER", "opid": "4", "children": [{"name": "HASH_JOIN", "opid": "3", "children": [{"name": "FILTER", "opid": "1", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_partkey\nl_quantity\nl_shipmode\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nFilters: l_shipinstruct='DELIVER IN PERSON' AND l_shipinstruct IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 300060"}],"table": "","extra": "((l_shipmode = 'AIR') OR (l_shipmode = 'AIR REG'))\n[INFOSEPARATOR]\nEC: 300060"},{"name": "SEQ_SCAN ", "opid": "2", "children": [],"table": "part","extra": "part\n[INFOSEPARATOR]\np_partkey\np_brand\np_container\np_size\n[INFOSEPARATOR]\nEC: 200000"}],"table": "","extra": "INNER\nl_partkey = p_partkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 160351\n"}],"table": "","extra": "(((l_quantity <= 11.00) AND (p_size <= 5) AND (p_brand = 'Brand#12') AND ((p_container = 'SM CASE') OR (p_container = 'SM BOX') OR (p_container = 'SM PACK') OR (p_container = 'SM PKG'))) OR ((l_quantity >= 10.00) AND (l_quantity <= 20.00) AND (p_size <= 10) AND (p_brand = 'Brand#23') AND ((p_container = 'MED BAG') OR (p_container = 'MED BOX') OR (p_container = 'MED PKG') OR (p_container = 'MED PACK'))) OR ((l_quantity >= 20.00) AND (l_quantity <= 30.00) AND (p_size <= 15) AND (p_brand = 'Brand#34') AND ((p_container = 'LG CASE') OR (p_container = 'LG BOX') OR (p_container = 'LG PACK') OR (p_container = 'LG PKG'))))\n[INFOSEPARATOR]\nEC: 160351"}],"table": "","extra": "#1\n#3\n#4\n#6\n#7\n#8\n"}],"table": "","extra": "#1\n#2\n"}],"table": "","extra": "(l_extendedprice * (1.00 - l_discount))\n"}],"table": "","extra": "sum(#0)"}
Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐                                                                                                                                                                              
│          ORDER_BY         │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│          ORDERS:          │                                                                                                                                                                              
│    supplier.s_name ASC    │                                                                                                                                                                              
└─────────────┬─────────────┘                                                                                                                                                                                                           
┌─────────────┴─────────────┐                                                                                                                                                                              
│         PROJECTION        │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│           s_name          │                                                                                                                                                                              
│         s_address         │                                                                                                                                                                              
└─────────────┬─────────────┘                                                                                                                                                                                                           
┌─────────────┴─────────────┐                                                                                                                                                                              
│         HASH_JOIN         │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│           INNER           │                                                                                                                                                                              
│       #0 = s_suppkey      │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐                                           
│        Build Min: 1       │                                                                                                                                  │                                           
│      Build Max: 10000     │                                                                                                                                  │                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                  │                                           
│          EC: 400          │                                                                                                                                  │                                           
└─────────────┬─────────────┘                                                                                                                                  │                                                                        
┌─────────────┴─────────────┐                                                                                                                    ┌─────────────┴─────────────┐                             
│         PROJECTION        │                                                                                                                    │         HASH_JOIN         │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│__internal_decompress_integ│                                                                                                                    │           INNER           │                             
│     ral_bigint(#0, 1)     │                                                                                                                    │ s_nationkey = n_nationkey │                             
│                           │                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐              
│                           │                                                                                                                    │        Build Min: 0       │              │              
│                           │                                                                                                                    │       Build Max: 24       │              │              
│                           │                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              
│                           │                                                                                                                    │          EC: 400          │              │              
└─────────────┬─────────────┘                                                                                                                    └─────────────┬─────────────┘              │                                           
┌─────────────┴─────────────┐                                                                                                                    ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
│       HASH_GROUP_BY       │                                                                                                                    │         SEQ_SCAN          ││         SEQ_SCAN          │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│             #0            │                                                                                                                    │          supplier         ││           nation          │
│                           │                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│                           │                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│                           │                                                                                                                    │         EC: 10000         ││  Filters: n_name='CANADA' │
│                           │                                                                                                                    │                           ││   AND n_name IS NOT NULL  │
│                           │                                                                                                                    │                           ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│                           │                                                                                                                    │                           ││           EC: 1           │
└─────────────┬─────────────┘                                                                                                                    └───────────────────────────┘└───────────────────────────┘                             
┌─────────────┴─────────────┐                                                                                                                                                                              
│         PROJECTION        │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│             #0            │                                                                                                                                                                              
└─────────────┬─────────────┘                                                                                                                                                                                                           
┌─────────────┴─────────────┐                                                                                                                                                                              
│         PROJECTION        │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│__internal_compress_integra│                                                                                                                                                                              
│     l_usmallint(#0, 1)    │                                                                                                                                                                              
└─────────────┬─────────────┘                                                                                                                                                                                                           
┌─────────────┴─────────────┐                                                                                                                                                                              
│         PROJECTION        │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│         ps_suppkey        │                                                                                                                                                                              
└─────────────┬─────────────┘                                                                                                                                                                                                           
┌─────────────┴─────────────┐                                                                                                                                                                              
│         PROJECTION        │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│             #0            │                                                                                                                                                                              
│             #4            │                                                                                                                                                                              
│             #5            │                                                                                                                                                                              
└─────────────┬─────────────┘                                                                                                                                                                                                           
┌─────────────┴─────────────┐                                                                                                                                                                              
│           FILTER          │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│    (CAST(ps_availqty AS   │                                                                                                                                                                              
│ DECIMAL(38,3)) > SUBQUERY)│                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│         EC: 800000        │                                                                                                                                                                              
└─────────────┬─────────────┘                                                                                                                                                                                                           
┌─────────────┴─────────────┐                                                                                                                                                                              
│      RIGHT_DELIM_JOIN     │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│           RIGHT           │                                                                                                                                                                              
│ ps_partkey IS NOT DISTINCT│                                                                                                                                                                              
│       FROM ps_partkey     ├───────────────────────────────────────────┐                                                                                                                                  
│ ps_suppkey IS NOT DISTINCT│                                           │                                                                                                                                  
│       FROM ps_suppkey     │                                           │                                                                                                                                  
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                           │                                                                                                                                  
│         EC: 800000        │                                           │                                                                                                                                  
└─────────────┬─────────────┘                                           │                                                                                                                                                               
┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐                                                                                                                    
│         HASH_JOIN         │                             │         HASH_JOIN         │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│           INNER           │                             │           RIGHT           │                                                                                                                    
│      ps_partkey = #0      │                             │ ps_partkey IS NOT DISTINCT│                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐              │       FROM ps_partkey     ├───────────────────────────────────────────┐                                                                        
│        Build Min: 1       │              │              │ ps_suppkey IS NOT DISTINCT│                                           │                                                                        
│     Build Max: 200000     │              │              │       FROM ps_suppkey     │                                           │                                                                        
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                           │                                                                        
│         EC: 800000        │              │              │         EC: 800000        │                                           │                                                                        
└─────────────┬─────────────┘              │              └─────────────┬─────────────┘                                           │                                                                                                     
┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐                                                          
│         SEQ_SCAN          ││         PROJECTION        ││         PROJECTION        │                             │         DUMMY_SCAN        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │                           │                                                          
│          partsupp         ││__internal_decompress_integ││  (0.5 * sum(l_quantity))  │                             │                           │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││     ral_bigint(#0, 1)     ││         ps_partkey        │                             │                           │                                                          
│         ps_partkey        ││                           ││         ps_suppkey        │                             │                           │                                                          
│        ps_availqty        ││                           ││                           │                             │                           │                                                          
│         ps_suppkey        ││                           ││                           │                             │                           │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           ││                           │                             │                           │                                                          
│         EC: 800000        ││                           ││                           │                             │                           │                                                          
└───────────────────────────┘└─────────────┬─────────────┘└─────────────┬─────────────┘                             └───────────────────────────┘                                                                                       
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                                                    
                             │       HASH_GROUP_BY       ││         PROJECTION        │                                                                                                                    
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
                             │             #0            ││__internal_decompress_integ│                                                                                                                    
                             │                           ││     ral_bigint(#0, 1)     │                                                                                                                    
                             │                           ││__internal_decompress_integ│                                                                                                                    
                             │                           ││     ral_bigint(#1, 1)     │                                                                                                                    
                             │                           ││             #2            │                                                                                                                    
                             └─────────────┬─────────────┘└─────────────┬─────────────┘                                                                                                                                                 
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                                                    
                             │         PROJECTION        ││       HASH_GROUP_BY       │                                                                                                                    
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
                             │             #0            ││             #0            │                                                                                                                    
                             │                           ││             #1            │                                                                                                                    
                             │                           ││          sum(#2)          │                                                                                                                    
                             └─────────────┬─────────────┘└─────────────┬─────────────┘                                                                                                                                                 
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                                                    
                             │         PROJECTION        ││         PROJECTION        │                                                                                                                    
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
                             │__internal_compress_integra││         ps_partkey        │                                                                                                                    
                             │     l_uinteger(#0, 1)     ││         ps_suppkey        │                                                                                                                    
                             │                           ││         l_quantity        │                                                                                                                    
                             └─────────────┬─────────────┘└─────────────┬─────────────┘                                                                                                                                                 
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                                                    
                             │         PROJECTION        ││         PROJECTION        │                                                                                                                    
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
                             │         p_partkey         ││__internal_compress_integra│                                                                                                                    
                             │                           ││     l_uinteger(#0, 1)     │                                                                                                                    
                             │                           ││__internal_compress_integra│                                                                                                                    
                             │                           ││     l_usmallint(#1, 1)    │                                                                                                                    
                             │                           ││             #2            │                                                                                                                    
                             │                           ││             #3            │                                                                                                                    
                             │                           ││             #4            │                                                                                                                    
                             └─────────────┬─────────────┘└─────────────┬─────────────┘                                                                                                                                                 
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                                                    
                             │           FILTER          ││         HASH_JOIN         │                                                                                                                    
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
                             │  prefix(p_name, 'forest') ││           INNER           │                                                                                                                    
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   l_partkey = ps_partkey  ├──────────────┐                                                                                                     
                             │          EC: 8000         ││   l_suppkey = ps_suppkey  │              │                                                                                                     
                             │                           ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                                                                                     
                             │                           ││        EC: 1200243        │              │                                                                                                     
                             └─────────────┬─────────────┘└─────────────┬─────────────┘              │                                                                                                                                  
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                       
                             │         SEQ_SCAN          ││         SEQ_SCAN          ││         DELIM_SCAN        │                                                                                       
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                                                                       
                             │            part           ││          lineitem         ││                           │                                                                                       
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                                                                       
                             │           p_name          ││         l_partkey         ││                           │                                                                                       
                             │         p_partkey         ││         l_suppkey         ││                           │                                                                                       
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││         l_quantity        ││                           │                                                                                       
                             │ Filters: p_name>='forest' ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                                                                       
                             │   AND p_name<'foresu' AND ││ Filters: l_shipdate>='1994││                           │                                                                                       
                             │     p_name IS NOT NULL    ││-01-01'::DATE AND l_sh...  ││                           │                                                                                       
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││  <'1995-01-01'::DATE AND  ││                           │                                                                                       
                             │         EC: 40000         ││   l_shipdate IS NOT NULL  ││                           │                                                                                       
                             │                           ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                                                                       
                             │                           ││        EC: 1200243        ││                           │                                                                                       
                             └───────────────────────────┘└───────────────────────────┘└───────────────────────────┘                                                                                                                    

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

%%%%%%%%%%%%%%%% Running Query #  20  threads:  1
SELECT s_name, s_address FROM supplier, nation WHERE s_suppkey IN ( SELECT ps_suppkey FROM partsupp WHERE ps_partkey IN ( SELECT p_partkey FROM part WHERE p_name LIKE 'forest%') AND ps_availqty > ( SELECT 0.5 * sum(l_quantity) FROM lineitem WHERE l_partkey = ps_partkey AND l_suppkey = ps_suppkey AND l_shipdate >= CAST('1994-01-01' AS date) AND l_shipdate < CAST('1995-01-01' AS date))) AND s_nationkey = n_nationkey AND n_name = 'CANADA' ORDER BY s_name;
Run:  None SELECT s_name, s_address FROM supplier, nation WHERE s_suppkey IN ( SELECT ps_suppkey FROM partsupp WHERE ps_partkey IN ( SELECT p_partkey FROM part WHERE p_name LIKE 'forest%') AND ps_availqty > ( SELECT 0.5 * sum(l_quantity) FROM lineitem WHERE l_partkey = ps_partkey AND l_suppkey = ps_suppkey AND l_shipdate >= CAST('1994-01-01' AS date) AND l_shipdate < CAST('1995-01-01' AS date))) AND s_nationkey = n_nationkey AND n_name = 'CANADA' ORDER BY s_name;
Avg Time in sec:  0.126412948127836  output size:  186
                 s_name                               s_address
0    Supplier#000000020               JtPqm19E7tF 152Rl1wQZ8j0H
1    Supplier#000000091    35WVnU7GLNbQDcc2TARavGtk6RB6ZCd46UAY
2    Supplier#000000205                            Alrx5TN,hdnG
3    Supplier#000000285           q TMZEDyZtv vUiFKBhT3NJlnIxpL
4    Supplier#000000287                       UQR8bUA4V2HxVbw9K
..                  ...                                     ...
181  Supplier#000009811                  nXIxtBT6D1v6TCb2iMYkyU
182  Supplier#000009812     rbl9euXFoPLlKQVYDVyRouslbbbKDHAkyXY
183  Supplier#000009846  WTzdvihXbyqnx0JfbbVaxBOcO9d93DYbtBhi J
184  Supplier#000009899                       U3NBqk s Zz06al2m
185  Supplier#000009974         Uvh0hWngOu96WgB,OafBQOqwpWqzwg8

[186 rows x 2 columns]
{'name': 'Query', 'result': 0.12086, 'timing': 0.12086, 'cardinality': 0, 'extra-info': "SELECT s_name, s_address FROM supplier, nation WHERE s_suppkey IN ( SELECT ps_suppkey FROM partsupp WHERE ps_partkey IN ( SELECT p_partkey FROM part WHERE p_name LIKE 'forest%') AND ps_availqty > ( SELECT 0.5 * sum(l_quantity) FROM lineitem WHERE l_partkey = ps_partkey AND l_suppkey = ps_suppkey AND l_shipdate >= CAST('1994-01-01' AS date) AND l_shipdate < CAST('1995-01-01' AS date))) AND s_nationkey = n_nationkey AND n_name = 'CANADA' ORDER BY s_name;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 2.4e-05, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'ORDER_BY', 'timing': 9.7e-05, 'cardinality': 186, 'extra_info': 'ORDERS:\nsupplier.s_name ASC', 'children': [{'name': 'PROJECTION', 'timing': 2e-06, 'cardinality': 186, 'extra_info': 's_name\ns_address\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.000245, 'cardinality': 186, 'extra_info': 'INNER\n#0 = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 400\n', 'children': [{'name': 'PROJECTION', 'timing': 7e-06, 'cardinality': 4397, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.000557, 'cardinality': 4397, 'extra_info': '#0', 'children': [{'name': 'PROJECTION', 'timing': 3e-06, 'cardinality': 5833, 'extra_info': '#0\n', 'children': [{'name': 'PROJECTION', 'timing': 2.2e-05, 'cardinality': 5833, 'extra_info': '__internal_compress_integral_usmallint(#0, 1)\n', 'children': [{'name': 'PROJECTION', 'timing': 2e-06, 'cardinality': 5833, 'extra_info': 'ps_suppkey\n', 'children': [{'name': 'PROJECTION', 'timing': 7e-06, 'cardinality': 5833, 'extra_info': '#0\n#4\n#5\n', 'children': [{'name': 'FILTER', 'timing': 0.000491, 'cardinality': 5833, 'extra_info': '(CAST(ps_availqty AS DECIMAL(38,3)) > SUBQUERY)\n[INFOSEPARATOR]\nEC: 800000', 'children': [{'name': 'RIGHT_DELIM_JOIN', 'timing': 0.001042, 'cardinality': 0, 'extra_info': 'RIGHT\nps_partkey IS NOT DISTINCT FROM ps_partkey\nps_suppkey IS NOT DISTINCT FROM ps_suppkey\n\n[INFOSEPARATOR]\nEC: 800000\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.004126, 'cardinality': 8508, 'extra_info': 'INNER\nps_partkey = #0\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 800000\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.001253, 'cardinality': 800000, 'extra_info': 'partsupp\n[INFOSEPARATOR]\nps_partkey\nps_availqty\nps_suppkey\n[INFOSEPARATOR]\nEC: 800000', 'children': []}, {'name': 'PROJECTION', 'timing': 6e-06, 'cardinality': 2127, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.000319, 'cardinality': 2127, 'extra_info': '#0', 'children': [{'name': 'PROJECTION', 'timing': 1e-06, 'cardinality': 2127, 'extra_info': '#0\n', 'children': [{'name': 'PROJECTION', 'timing': 6e-06, 'cardinality': 2127, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n', 'children': [{'name': 'PROJECTION', 'timing': 2e-06, 'cardinality': 2127, 'extra_info': 'p_partkey\n', 'children': [{'name': 'FILTER', 'timing': 0.000413, 'cardinality': 2127, 'extra_info': "prefix(p_name, 'forest')\n[INFOSEPARATOR]\nEC: 8000", 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.007453, 'cardinality': 2127, 'extra_info': "part\n[INFOSEPARATOR]\np_name\np_partkey\n[INFOSEPARATOR]\nFilters: p_name>='forest' AND p_name<'foresu' AND p_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 40000", 'children': []}]}]}]}]}]}]}]}, {'name': 'HASH_JOIN', 'timing': 0.000696, 'cardinality': 8508, 'extra_info': 'RIGHT\nps_partkey IS NOT DISTINCT FROM ps_partkey\nps_suppkey IS NOT DISTINCT FROM ps_suppkey\n\n[INFOSEPARATOR]\nEC: 800000\n', 'children': [{'name': 'PROJECTION', 'timing': 0.000252, 'cardinality': 5843, 'extra_info': '(0.5 * sum(l_quantity))\nps_partkey\nps_suppkey\n', 'children': [{'name': 'PROJECTION', 'timing': 2.2e-05, 'cardinality': 5843, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n__internal_decompress_integral_bigint(#1, 1)\n#2\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.001433, 'cardinality': 5843, 'extra_info': '#0\n#1\nsum(#2)', 'children': [{'name': 'PROJECTION', 'timing': 6e-06, 'cardinality': 9741, 'extra_info': 'ps_partkey\nps_suppkey\nl_quantity\n', 'children': [{'name': 'PROJECTION', 'timing': 9.4e-05, 'cardinality': 9741, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n__internal_compress_integral_usmallint(#1, 1)\n#2\n#3\n#4\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.04945, 'cardinality': 9741, 'extra_info': 'INNER\nl_partkey = ps_partkey\nl_suppkey = ps_suppkey\n\n[INFOSEPARATOR]\nEC: 1200243\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.041761, 'cardinality': 909455, 'extra_info': "lineitem\n[INFOSEPARATOR]\nl_partkey\nl_suppkey\nl_quantity\n[INFOSEPARATOR]\nFilters: l_shipdate>='1994-01-01'::DATE AND l_shipdate<'1995-01-01'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243", 'children': []}, {'name': 'DELIM_SCAN', 'timing': 0.0, 'cardinality': 0, 'extra_info': '', 'children': []}]}]}]}]}]}]}, {'name': 'DUMMY_SCAN', 'timing': 0.0, 'cardinality': 0, 'extra_info': '', 'children': []}]}, {'name': 'HASH_GROUP_BY', 'timing': 0.000102, 'cardinality': 8508, 'extra_info': '#0\n#2', 'children': []}]}]}]}]}]}]}]}]}, {'name': 'HASH_JOIN', 'timing': 7.8e-05, 'cardinality': 412, 'extra_info': 'INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 400\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.000416, 'cardinality': 10000, 'extra_info': 'supplier\n[INFOSEPARATOR]\n\n[INFOSEPARATOR]\nEC: 10000', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 3e-05, 'cardinality': 1, 'extra_info': "nation\n[INFOSEPARATOR]\n\n[INFOSEPARATOR]\nFilters: n_name='CANADA' AND n_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1", 'children': []}]}]}]}]}]}]}
X {'RESULT_COLLECTOR0': 2.4e-05, 'ORDER_BY1': 9.7e-05, 'PROJECTION2': 2e-06, 'HASH_JOIN3': 0.000245, 'PROJECTION4': 7e-06, 'HASH_GROUP_BY5': 0.000557, 'PROJECTION6': 3e-06, 'PROJECTION7': 2.2e-05, 'PROJECTION8': 2e-06, 'PROJECTION9': 7e-06, 'FILTER10': 0.000491, 'RIGHT_DELIM_JOIN11': 0.001042, 'HASH_JOIN12': 0.004126, 'SEQ_SCAN 13': 0.001253, 'PROJECTION14': 6e-06, 'HASH_GROUP_BY15': 0.000319, 'PROJECTION16': 1e-06, 'PROJECTION17': 6e-06, 'PROJECTION18': 2e-06, 'FILTER19': 0.000413, 'SEQ_SCAN 20': 0.007453, 'HASH_JOIN21': 0.000696, 'PROJECTION22': 0.000252, 'PROJECTION23': 2.2e-05, 'HASH_GROUP_BY24': 0.001433, 'PROJECTION25': 6e-06, 'PROJECTION26': 9.4e-05, 'HASH_JOIN27': 0.04945, 'SEQ_SCAN 28': 0.041761, 'DELIM_SCAN29': 0.0, 'DUMMY_SCAN30': 0.0, 'HASH_GROUP_BY31': 0.000102, 'HASH_JOIN32': 7.8e-05, 'SEQ_SCAN 33': 0.000416, 'SEQ_SCAN 34': 3e-05}
uncompressed filter_log_size: 26564
uncompressed filter_log_buffer_size: 21428
uncompressed limit_offset_size: 1872
uncompressed limit_offset_buffer_size: 0
uncompressed perfect_full_scan_ht_log_size: 42872
uncompressed perfect_full_scan_ht_log_buffer_size: 40808
uncompressed perfect_probe_ht_log_size: 91488
uncompressed perfect_probe_ht_log_buffer_size: 72848
uncompressed row_group_log_size: 3800044
uncompressed row_group_log_buffer_size: 3646332
uncompressed scatter_log_size: 211960
uncompressed scatter_log_buffer_size: 209672
uncompressed scatter_sel_log_size: 237404
uncompressed scatter_sel_log_buffer_size: 234668
uncompressed gather_log_size: 1872
uncompressed gather_log_buffer_size: 0
uncompressed combine_log_size: 1872
uncompressed combine_log_buffer_size: 0
uncompressed finalize_states_log_size: 169160
uncompressed finalize_states_log_buffer_size: 167000
uncompressed join_gather_log_size: 341784
uncompressed join_gather_log_buffer_size: 208328
uncompressed reorder_log_size: 3384
uncompressed reorder_log_buffer_size: 0
uncompressed cross_log_size: 1872
uncompressed cross_log_buffer_size: 0
uncompressed nlj_log_size: 1872
uncompressed nlj_log_buffer_size: 0
uncompressed total_size: 4934020
uncompressed total_buffer_size: 4601084
uncompressed total_element_size: 332936

Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌─────────────────────┐                                                                                                                                                                                                               
│   STREAMING_LIMIT   │                                                                                                                                                                                                               
└──────────┬──────────┘                                                                                                                                                                                                                                      
┌──────────┴──────────┐                                                                                                                                                                                                               
│       ORDER_BY      │                                                                                                                                                                                                               
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                               
│       ORDERS:       │                                                                                                                                                                                                               
│  count_star() DESC  │                                                                                                                                                                                                               
│ supplier.s_name ASC │                                                                                                                                                                                                               
└──────────┬──────────┘                                                                                                                                                                                                                                      
┌──────────┴──────────┐                                                                                                                                                                                                               
│    HASH_GROUP_BY    │                                                                                                                                                                                                               
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                               
│          #0         │                                                                                                                                                                                                               
│     count_star()    │                                                                                                                                                                                                               
└──────────┬──────────┘                                                                                                                                                                                                                                      
┌──────────┴──────────┐                                                                                                                                                                                                               
│      PROJECTION     │                                                                                                                                                                                                               
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                               
│        s_name       │                                                                                                                                                                                                               
└──────────┬──────────┘                                                                                                                                                                                                                                      
┌──────────┴──────────┐                                                                                                                                                                                                               
│      PROJECTION     │                                                                                                                                                                                                               
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                               
│__internal_compress_i│                                                                                                                                                                                                               
│ ntegral_uinteger(#0,│                                                                                                                                                                                                               
│          1)         │                                                                                                                                                                                                               
│__internal_compress_i│                                                                                                                                                                                                               
│ntegral_usmallint(#1,│                                                                                                                                                                                                               
│          1)         │                                                                                                                                                                                                               
│__internal_compress_i│                                                                                                                                                                                                               
│ ntegral_uinteger(#2,│                                                                                                                                                                                                               
│          1)         │                                                                                                                                                                                                               
│          #3         │                                                                                                                                                                                                               
└──────────┬──────────┘                                                                                                                                                                                                                                      
┌──────────┴──────────┐                                                                                                                                                                                                               
│   RIGHT_DELIM_JOIN  │                                                                                                                                                                                                               
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                               
│      RIGHT_ANTI     │                                                                                                                                                                                                               
│  l_orderkey IS NOT  │                                                                                                                                                                                                               
│ DISTINCT FROM l...  ├─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐                                                         
│   l_suppkey IS NOT  │                                                                                                                                                     │                                                         
│ DISTINCT FROM l...  │                                                                                                                                                     │                                                         
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                     │                                                         
│     EC: 6001215     │                                                                                                                                                     │                                                         
└──────────┬──────────┘                                                                                                                                                     │                                                                                
┌──────────┴──────────┐                                                                                                                                          ┌──────────┴──────────┐                                              
│   RIGHT_DELIM_JOIN  │                                                                                                                                          │      HASH_JOIN      │                                              
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                          │   ─ ─ ─ ─ ─ ─ ─ ─   │                                              
│      RIGHT_SEMI     │                                                                                                                                          │      RIGHT_ANTI     │                                              
│  l_orderkey IS NOT  │                                                                                                                                          │  l_orderkey IS NOT  │                                              
│ DISTINCT FROM l...  ├────────────────────────────────────────────────────────────────────────────────┐                                                         │ DISTINCT FROM l...  ├──────────────────────────────────┐           
│   l_suppkey IS NOT  │                                                                                │                                                         │   l_suppkey IS NOT  │                                  │           
│ DISTINCT FROM l...  │                                                                                │                                                         │ DISTINCT FROM l...  │                                  │           
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                │                                                         │   ─ ─ ─ ─ ─ ─ ─ ─   │                                  │           
│     EC: 6001215     │                                                                                │                                                         │     EC: 6001215     │                                  │           
└──────────┬──────────┘                                                                                │                                                         └──────────┬──────────┘                                  │                                  
┌──────────┴──────────┐                                                                     ┌──────────┴──────────┐                                              ┌──────────┴──────────┐                       ┌──────────┴──────────┐
│      HASH_JOIN      │                                                                     │      HASH_JOIN      │                                              │      PROJECTION     │                       │      DUMMY_SCAN     │
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                     │   ─ ─ ─ ─ ─ ─ ─ ─   │                                              │   ─ ─ ─ ─ ─ ─ ─ ─   │                       │                     │
│        INNER        │                                                                     │      RIGHT_SEMI     │                                              │      l_orderkey     │                       │                     │
│     o_orderkey =    │                                                                     │  l_orderkey IS NOT  │                                              │      l_suppkey      │                       │                     │
│      l_orderkey     ├───────────┐                                                         │ DISTINCT FROM l...  ├──────────────────────────────────┐           │                     │                       │                     │
│   ─ ─ ─ ─ ─ ─ ─ ─   │           │                                                         │   l_suppkey IS NOT  │                                  │           │                     │                       │                     │
│      EC: 15866      │           │                                                         │ DISTINCT FROM l...  │                                  │           │                     │                       │                     │
│                     │           │                                                         │   ─ ─ ─ ─ ─ ─ ─ ─   │                                  │           │                     │                       │                     │
│                     │           │                                                         │     EC: 6001215     │                                  │           │                     │                       │                     │
└──────────┬──────────┘           │                                                         └──────────┬──────────┘                                  │           └──────────┬──────────┘                       └─────────────────────┘                       
┌──────────┴──────────┐┌──────────┴──────────┐                                              ┌──────────┴──────────┐                       ┌──────────┴──────────┐┌──────────┴──────────┐                                              
│      SEQ_SCAN       ││      HASH_JOIN      │                                              │      PROJECTION     │                       │      DUMMY_SCAN     ││      HASH_JOIN      │                                              
│   ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─   │                                              │   ─ ─ ─ ─ ─ ─ ─ ─   │                       │                     ││   ─ ─ ─ ─ ─ ─ ─ ─   │                                              
│        orders       ││        INNER        │                                              │      l_orderkey     │                       │                     ││        INNER        │                                              
│   ─ ─ ─ ─ ─ ─ ─ ─   ││l_suppkey = s_suppkey│                                              │      l_suppkey      │                       │                     ││     l_orderkey =    │                                              
│      o_orderkey     ││   ─ ─ ─ ─ ─ ─ ─ ─   │                                              │                     │                       │                     ││      l_orderkey     │                                              
│   ─ ─ ─ ─ ─ ─ ─ ─   ││     Build Min: 1    ├───────────┐                                  │                     │                       │                     ││     l_suppkey !=    ├───────────┐                                  
│Filters: o_orderstatu││   Build Max: 10000  │           │                                  │                     │                       │                     ││       l_suppkey     │           │                                  
│      s='F' AND      ││   ─ ─ ─ ─ ─ ─ ─ ─   │           │                                  │                     │                       │                     ││   ─ ─ ─ ─ ─ ─ ─ ─   │           │                                  
│ o_orderstatus I...  ││      EC: 47600      │           │                                  │                     │                       │                     ││     EC: 1200243     │           │                                  
│   ─ ─ ─ ─ ─ ─ ─ ─   ││                     │           │                                  │                     │                       │                     ││                     │           │                                  
│      EC: 500000     ││                     │           │                                  │                     │                       │                     ││                     │           │                                  
└─────────────────────┘└──────────┬──────────┘           │                                  └──────────┬──────────┘                       └─────────────────────┘└──────────┬──────────┘           │                                                         
                       ┌──────────┴──────────┐┌──────────┴──────────┐                       ┌──────────┴──────────┐                                              ┌──────────┴──────────┐┌──────────┴──────────┐                       
                       │        FILTER       ││      HASH_JOIN      │                       │      HASH_JOIN      │                                              │        FILTER       ││      DELIM_SCAN     │                       
                       │   ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─   │                       │   ─ ─ ─ ─ ─ ─ ─ ─   │                                              │   ─ ─ ─ ─ ─ ─ ─ ─   ││                     │                       
                       │   (l_receiptdate >  ││        INNER        │                       │        INNER        │                                              │   (l_receiptdate >  ││                     │                       
                       │     l_commitdate)   ││    s_nationkey =    │                       │     l_orderkey =    │                                              │     l_commitdate)   ││                     │                       
                       │   ─ ─ ─ ─ ─ ─ ─ ─   ││      n_nationkey    │                       │      l_orderkey     │                                              │   ─ ─ ─ ─ ─ ─ ─ ─   ││                     │                       
                       │     EC: 1200243     ││   ─ ─ ─ ─ ─ ─ ─ ─   ├───────────┐           │     l_suppkey !=    ├───────────┐                                  │     EC: 6001215     ││                     │                       
                       │                     ││     Build Min: 0    │           │           │       l_suppkey     │           │                                  │                     ││                     │                       
                       │                     ││    Build Max: 24    │           │           │   ─ ─ ─ ─ ─ ─ ─ ─   │           │                                  │                     ││                     │                       
                       │                     ││   ─ ─ ─ ─ ─ ─ ─ ─   │           │           │     EC: 6001215     │           │                                  │                     ││                     │                       
                       │                     ││       EC: 400       │           │           │                     │           │                                  │                     ││                     │                       
                       └──────────┬──────────┘└──────────┬──────────┘           │           └──────────┬──────────┘           │                                  └──────────┬──────────┘└─────────────────────┘                                              
                       ┌──────────┴──────────┐┌──────────┴──────────┐┌──────────┴──────────┐┌──────────┴──────────┐┌──────────┴──────────┐                       ┌──────────┴──────────┐                                              
                       │      SEQ_SCAN       ││      SEQ_SCAN       ││      SEQ_SCAN       ││      SEQ_SCAN       ││      DELIM_SCAN     │                       │      SEQ_SCAN       │                                              
                       │   ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─   ││                     │                       │   ─ ─ ─ ─ ─ ─ ─ ─   │                                              
                       │       lineitem      ││       supplier      ││        nation       ││       lineitem      ││                     │                       │       lineitem      │                                              
                       │   ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─   ││                     │                       │   ─ ─ ─ ─ ─ ─ ─ ─   │                                              
                       │      l_suppkey      ││      s_suppkey      ││     n_nationkey     ││      l_orderkey     ││                     │                       │      l_orderkey     │                                              
                       │      l_orderkey     ││     s_nationkey     ││   ─ ─ ─ ─ ─ ─ ─ ─   ││      l_suppkey      ││                     │                       │      l_suppkey      │                                              
                       │    l_receiptdate    ││        s_name       ││   Filters: n_name=  ││   ─ ─ ─ ─ ─ ─ ─ ─   ││                     │                       │    l_receiptdate    │                                              
                       │     l_commitdate    ││   ─ ─ ─ ─ ─ ─ ─ ─   ││'SAUDI ARABIA' A...  ││     EC: 6001215     ││                     │                       │     l_commitdate    │                                              
                       │   ─ ─ ─ ─ ─ ─ ─ ─   ││      EC: 10000      ││      IS NOT NULL    ││                     ││                     │                       │   ─ ─ ─ ─ ─ ─ ─ ─   │                                              
                       │     EC: 1200243     ││                     ││   ─ ─ ─ ─ ─ ─ ─ ─   ││                     ││                     │                       │     EC: 6001215     │                                              
                       │                     ││                     ││        EC: 1        ││                     ││                     │                       │                     │                                              
                       └─────────────────────┘└─────────────────────┘└─────────────────────┘└─────────────────────┘└─────────────────────┘                       └─────────────────────┘                                                                     

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

**** output size:  186
LINEAGE_4_FILTER_13
LINEAGE_4_FILTER_21
LINEAGE_4_HASH_GROUP_BY_10
LINEAGE_4_HASH_GROUP_BY_17
LINEAGE_4_HASH_GROUP_BY_26
LINEAGE_4_HASH_GROUP_BY_5
LINEAGE_4_HASH_JOIN_19
LINEAGE_4_HASH_JOIN_2
LINEAGE_4_HASH_JOIN_30
LINEAGE_4_HASH_JOIN_31
LINEAGE_4_HASH_JOIN_9
LINEAGE_4_ORDER_BY_33
LINEAGE_4_SEQ_SCAN_0
LINEAGE_4_SEQ_SCAN_11
LINEAGE_4_SEQ_SCAN_12
LINEAGE_4_SEQ_SCAN_28
LINEAGE_4_SEQ_SCAN_29
SELECT s_name, s_address FROM supplier, nation WHERE s_suppkey IN ( SELECT ps_suppkey FROM partsupp WHERE ps_partkey IN ( SELECT p_partkey FROM part WHERE p_name LIKE 'forest%') AND ps_availqty > ( SELECT 0.5 * sum(l_quantity) FROM lineitem WHERE l_partkey = ps_partkey AND l_suppkey = ps_suppkey AND l_shipdate >= CAST('1994-01-01' AS date) AND l_shipdate < CAST('1995-01-01' AS date))) AND s_nationkey = n_nationkey AND n_name = 'CANADA' ORDER BY s_name;
   query_id  ...                                               plan
0         4  ...  {"name": "ORDER_BY", "opid": "33", "children":...

[1 rows x 7 columns]
Query info:  query_id                                                            4
query               SELECT s_name, s_address FROM supplier, nation...
size_bytes_max                                                4934020
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "ORDER_BY", "opid": "33", "children":...
Name: 0, dtype: object
{"name": "ORDER_BY", "opid": "33", "children": [{"name": "PROJECTION", "opid": "32", "children": [{"name": "HASH_JOIN", "opid": "31", "children": [{"name": "PROJECTION", "opid": "27", "children": [{"name": "HASH_GROUP_BY", "opid": "26", "children": [{"name": "PROJECTION", "opid": "25", "children": [{"name": "PROJECTION", "opid": "24", "children": [{"name": "PROJECTION", "opid": "23", "children": [{"name": "PROJECTION", "opid": "22", "children": [{"name": "FILTER", "opid": "21", "children": [{"name": "RIGHT_DELIM_JOIN", "opid": "20", "children": [{"name": "HASH_GROUP_BY", "opid": "10", "children": [],"table": "","extra": "#0\n#2"},{"name": "HASH_JOIN", "opid": "9", "children": [{"name": "PROJECTION", "opid": "7", "children": [{"name": "PROJECTION", "opid": "6", "children": [{"name": "HASH_GROUP_BY", "opid": "5", "children": [{"name": "PROJECTION", "opid": "4", "children": [{"name": "PROJECTION", "opid": "3", "children": [{"name": "HASH_JOIN", "opid": "2", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_partkey\nl_suppkey\nl_quantity\n[INFOSEPARATOR]\nFilters: l_shipdate>='1994-01-01'::DATE AND l_shipdate<'1995-01-01'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243"},{"name": "DELIM_SCAN", "opid": "1", "children": [],"table": "","extra": ""}],"table": "","extra": "INNER\nl_partkey = ps_partkey\nl_suppkey = ps_suppkey\n\n[INFOSEPARATOR]\nEC: 1200243\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n__internal_compress_integral_usmallint(#1, 1)\n#2\n#3\n#4\n"}],"table": "","extra": "ps_partkey\nps_suppkey\nl_quantity\n"}],"table": "","extra": "#0\n#1\nsum(#2)"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n__internal_decompress_integral_bigint(#1, 1)\n#2\n"}],"table": "","extra": "(0.5 * sum(l_quantity))\nps_partkey\nps_suppkey\n"},{"name": "DUMMY_SCAN", "opid": "8", "children": [],"table": "","extra": ""}],"table": "","extra": "RIGHT\nps_partkey IS NOT DISTINCT FROM ps_partkey\nps_suppkey IS NOT DISTINCT FROM ps_suppkey\n\n[INFOSEPARATOR]\nEC: 800000\n"},{"name": "HASH_JOIN", "opid": "19", "children": [{"name": "SEQ_SCAN ", "opid": "11", "children": [],"table": "partsupp","extra": "partsupp\n[INFOSEPARATOR]\nps_partkey\nps_availqty\nps_suppkey\n[INFOSEPARATOR]\nEC: 800000"},{"name": "PROJECTION", "opid": "18", "children": [{"name": "HASH_GROUP_BY", "opid": "17", "children": [{"name": "PROJECTION", "opid": "16", "children": [{"name": "PROJECTION", "opid": "15", "children": [{"name": "PROJECTION", "opid": "14", "children": [{"name": "FILTER", "opid": "13", "children": [{"name": "SEQ_SCAN ", "opid": "12", "children": [],"table": "part","extra": "part\n[INFOSEPARATOR]\np_name\np_partkey\n[INFOSEPARATOR]\nFilters: p_name>='forest' AND p_name<'foresu' AND p_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 40000"}],"table": "","extra": "prefix(p_name, 'forest')\n[INFOSEPARATOR]\nEC: 8000"}],"table": "","extra": "p_partkey\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n"}],"table": "","extra": "#0\n"}],"table": "","extra": "#0"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n"}],"table": "","extra": "INNER\nps_partkey = #0\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 800000\n"}],"table": "","extra": "RIGHT\nps_partkey IS NOT DISTINCT FROM ps_partkey\nps_suppkey IS NOT DISTINCT FROM ps_suppkey\n\n[INFOSEPARATOR]\nEC: 800000\n"}],"table": "","extra": "(CAST(ps_availqty AS DECIMAL(38,3)) > SUBQUERY)\n[INFOSEPARATOR]\nEC: 800000"}],"table": "","extra": "#0\n#4\n#5\n"}],"table": "","extra": "ps_suppkey\n"}],"table": "","extra": "__internal_compress_integral_usmallint(#0, 1)\n"}],"table": "","extra": "#0\n"}],"table": "","extra": "#0"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n"},{"name": "HASH_JOIN", "opid": "30", "children": [{"name": "SEQ_SCAN ", "opid": "28", "children": [],"table": "supplier","extra": "supplier\n[INFOSEPARATOR]\n\n[INFOSEPARATOR]\nEC: 10000"},{"name": "SEQ_SCAN ", "opid": "29", "children": [],"table": "nation","extra": "nation\n[INFOSEPARATOR]\n\n[INFOSEPARATOR]\nFilters: n_name='CANADA' AND n_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1"}],"table": "","extra": "INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 400\n"}],"table": "","extra": "INNER\n#0 = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 400\n"}],"table": "","extra": "s_name\ns_address\n"}],"table": "","extra": "ORDERS:\nsupplier.s_name ASC"}
%%%%%%%%%%%%%%%% Running Query #  21  threads:  1
SELECT s_name, count(*) AS numwait FROM supplier, lineitem l1, orders, nation WHERE s_suppkey = l1.l_suppkey AND o_orderkey = l1.l_orderkey AND o_orderstatus = 'F' AND l1.l_receiptdate > l1.l_commitdate AND EXISTS ( SELECT * FROM lineitem l2 WHERE l2.l_orderkey = l1.l_orderkey AND l2.l_suppkey <> l1.l_suppkey) AND NOT EXISTS ( SELECT * FROM lineitem l3 WHERE l3.l_orderkey = l1.l_orderkey AND l3.l_suppkey <> l1.l_suppkey AND l3.l_receiptdate > l3.l_commitdate) AND s_nationkey = n_nationkey AND n_name = 'SAUDI ARABIA' GROUP BY s_name ORDER BY numwait DESC, s_name LIMIT 100;
Run:  None SELECT s_name, count(*) AS numwait FROM supplier, lineitem l1, orders, nation WHERE s_suppkey = l1.l_suppkey AND o_orderkey = l1.l_orderkey AND o_orderstatus = 'F' AND l1.l_receiptdate > l1.l_commitdate AND EXISTS ( SELECT * FROM lineitem l2 WHERE l2.l_orderkey = l1.l_orderkey AND l2.l_suppkey <> l1.l_suppkey) AND NOT EXISTS ( SELECT * FROM lineitem l3 WHERE l3.l_orderkey = l1.l_orderkey AND l3.l_suppkey <> l1.l_suppkey AND l3.l_receiptdate > l3.l_commitdate) AND s_nationkey = n_nationkey AND n_name = 'SAUDI ARABIA' GROUP BY s_name ORDER BY numwait DESC, s_name LIMIT 100;
Avg Time in sec:  0.48758488800376654  output size:  100
                s_name  numwait
0   Supplier#000002829       20
1   Supplier#000005808       18
2   Supplier#000000262       17
3   Supplier#000000496       17
4   Supplier#000002160       17
..                 ...      ...
95  Supplier#000001916       12
96  Supplier#000001925       12
97  Supplier#000002039       12
98  Supplier#000002357       12
99  Supplier#000002483       12

[100 rows x 2 columns]
{'name': 'Query', 'result': 0.483081, 'timing': 0.483081, 'cardinality': 0, 'extra-info': "SELECT s_name, count(*) AS numwait FROM supplier, lineitem l1, orders, nation WHERE s_suppkey = l1.l_suppkey AND o_orderkey = l1.l_orderkey AND o_orderstatus = 'F' AND l1.l_receiptdate > l1.l_commitdate AND EXISTS ( SELECT * FROM lineitem l2 WHERE l2.l_orderkey = l1.l_orderkey AND l2.l_suppkey <> l1.l_suppkey) AND NOT EXISTS ( SELECT * FROM lineitem l3 WHERE l3.l_orderkey = l1.l_orderkey AND l3.l_suppkey <> l1.l_suppkey AND l3.l_receiptdate > l3.l_commitdate) AND s_nationkey = n_nationkey AND n_name = 'SAUDI ARABIA' GROUP BY s_name ORDER BY numwait DESC, s_name LIMIT 100;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 1e-05, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'STREAMING_LIMIT', 'timing': 2e-06, 'cardinality': 100, 'extra_info': '', 'children': [{'name': 'ORDER_BY', 'timing': 4.7e-05, 'cardinality': 411, 'extra_info': 'ORDERS:\ncount_star() DESC\nsupplier.s_name ASC', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.00101, 'cardinality': 411, 'extra_info': '#0\ncount_star()', 'children': [{'name': 'PROJECTION', 'timing': 2e-06, 'cardinality': 4141, 'extra_info': 's_name\n', 'children': [{'name': 'PROJECTION', 'timing': 2.4e-05, 'cardinality': 4141, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n__internal_compress_integral_usmallint(#1, 1)\n__internal_compress_integral_uinteger(#2, 1)\n#3\n', 'children': [{'name': 'RIGHT_DELIM_JOIN', 'timing': 0.008126, 'cardinality': 0, 'extra_info': 'RIGHT_ANTI\nl_orderkey IS NOT DISTINCT FROM l_orderkey\nl_suppkey IS NOT DISTINCT FROM l_suppkey\n\n[INFOSEPARATOR]\nEC: 6001215\n', 'children': [{'name': 'RIGHT_DELIM_JOIN', 'timing': 0.020339, 'cardinality': 0, 'extra_info': 'RIGHT_SEMI\nl_orderkey IS NOT DISTINCT FROM l_orderkey\nl_suppkey IS NOT DISTINCT FROM l_suppkey\n\n[INFOSEPARATOR]\nEC: 6001215\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.044172, 'cardinality': 75871, 'extra_info': 'INNER\no_orderkey = l_orderkey\n\n[INFOSEPARATOR]\nEC: 15866\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.040253, 'cardinality': 729413, 'extra_info': "orders\n[INFOSEPARATOR]\no_orderkey\n[INFOSEPARATOR]\nFilters: o_orderstatus='F' AND o_orderstatus IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 500000", 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.029796, 'cardinality': 156739, 'extra_info': 'INNER\nl_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 47600\n', 'children': [{'name': 'FILTER', 'timing': 0.016019, 'cardinality': 3793296, 'extra_info': '(l_receiptdate > l_commitdate)\n[INFOSEPARATOR]\nEC: 1200243', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.014117, 'cardinality': 6001215, 'extra_info': 'lineitem\n[INFOSEPARATOR]\nl_suppkey\nl_orderkey\nl_receiptdate\nl_commitdate\n[INFOSEPARATOR]\nEC: 1200243', 'children': []}]}, {'name': 'HASH_JOIN', 'timing': 5.8e-05, 'cardinality': 411, 'extra_info': 'INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 400\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.000192, 'cardinality': 10000, 'extra_info': 'supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\ns_name\n[INFOSEPARATOR]\nEC: 10000', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 2.4e-05, 'cardinality': 1, 'extra_info': "nation\n[INFOSEPARATOR]\nn_nationkey\n[INFOSEPARATOR]\nFilters: n_name='SAUDI ARABIA' AND n_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1", 'children': []}]}]}]}, {'name': 'HASH_JOIN', 'timing': 0.03402, 'cardinality': 73089, 'extra_info': 'RIGHT_SEMI\nl_orderkey IS NOT DISTINCT FROM l_orderkey\nl_suppkey IS NOT DISTINCT FROM l_suppkey\n\n[INFOSEPARATOR]\nEC: 6001215\n', 'children': [{'name': 'PROJECTION', 'timing': 0.000819, 'cardinality': 302356, 'extra_info': 'l_orderkey\nl_suppkey\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.096782, 'cardinality': 302356, 'extra_info': 'INNER\nl_orderkey = l_orderkey\nl_suppkey != l_suppkey\n\n[INFOSEPARATOR]\nEC: 6001215\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.007126, 'cardinality': 6001215, 'extra_info': 'lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_suppkey\n[INFOSEPARATOR]\nEC: 6001215', 'children': []}, {'name': 'DELIM_SCAN', 'timing': 0.0, 'cardinality': 0, 'extra_info': '', 'children': []}]}]}, {'name': 'DUMMY_SCAN', 'timing': 0.0, 'cardinality': 0, 'extra_info': '', 'children': []}]}, {'name': 'HASH_GROUP_BY', 'timing': 0.000992, 'cardinality': 75864, 'extra_info': '#0\n#1', 'children': []}]}, {'name': 'HASH_JOIN', 'timing': 0.018481, 'cardinality': 4141, 'extra_info': 'RIGHT_ANTI\nl_orderkey IS NOT DISTINCT FROM l_orderkey\nl_suppkey IS NOT DISTINCT FROM l_suppkey\n\n[INFOSEPARATOR]\nEC: 6001215\n', 'children': [{'name': 'PROJECTION', 'timing': 0.000235, 'cardinality': 190909, 'extra_info': 'l_orderkey\nl_suppkey\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.085725, 'cardinality': 190909, 'extra_info': 'INNER\nl_orderkey = l_orderkey\nl_suppkey != l_suppkey\n\n[INFOSEPARATOR]\nEC: 1200243\n', 'children': [{'name': 'FILTER', 'timing': 0.015607, 'cardinality': 3793296, 'extra_info': '(l_receiptdate > l_commitdate)\n[INFOSEPARATOR]\nEC: 6001215', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.009321, 'cardinality': 6001215, 'extra_info': 'lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_suppkey\nl_receiptdate\nl_commitdate\n[INFOSEPARATOR]\nEC: 6001215', 'children': []}]}, {'name': 'DELIM_SCAN', 'timing': 0.0, 'cardinality': 0, 'extra_info': '', 'children': []}]}]}, {'name': 'DUMMY_SCAN', 'timing': 0.0, 'cardinality': 0, 'extra_info': '', 'children': []}]}, {'name': 'HASH_GROUP_BY', 'timing': 0.000956, 'cardinality': 73082, 'extra_info': '#0\n#1', 'children': []}]}]}]}]}]}]}]}]}
uncompressed filter_log_size: 30544608
uncompressed filter_log_buffer_size: 30346368
uncompressed limit_offset_size: 1656
uncompressed limit_offset_buffer_size: 0
uncompressed perfect_full_scan_ht_log_size: 8464
uncompressed perfect_full_scan_ht_log_buffer_size: 6704
uncompressed perfect_probe_ht_log_size: 1390160
uncompressed perfect_probe_ht_log_buffer_size: 1257200
uncompressed row_group_log_size: 3345560
uncompressed row_group_log_buffer_size: 2917656
uncompressed scatter_log_size: 1243912
uncompressed scatter_log_buffer_size: 1224808
uncompressed scatter_sel_log_size: 5348420
uncompressed scatter_sel_log_buffer_size: 5291204
uncompressed gather_log_size: 1632
uncompressed gather_log_buffer_size: 0
uncompressed combine_log_size: 1632
uncompressed combine_log_buffer_size: 0
uncompressed finalize_states_log_size: 1198552
uncompressed finalize_states_log_buffer_size: 1194856
uncompressed join_gather_log_size: 14351876
uncompressed join_gather_log_buffer_size: 13367204
uncompressed reorder_log_size: 4944
uncompressed reorder_log_buffer_size: 0
uncompressed cross_log_size: 1632
uncompressed cross_log_buffer_size: 0
uncompressed nlj_log_size: 1632
uncompressed nlj_log_buffer_size: 0
uncompressed total_size: 57444680
uncompressed total_buffer_size: 55606000
uncompressed total_element_size: 1838680

Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐                                                                                                                                                                              
│          ORDER_BY         │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│          ORDERS:          │                                                                                                                                                                              
│   custsale.cntrycode ASC  │                                                                                                                                                                              
└─────────────┬─────────────┘                                                                                                                                                                                                           
┌─────────────┴─────────────┐                                                                                                                                                                              
│       HASH_GROUP_BY       │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│             #0            │                                                                                                                                                                              
│        count_star()       │                                                                                                                                                                              
│          sum(#1)          │                                                                                                                                                                              
└─────────────┬─────────────┘                                                                                                                                                                                                           
┌─────────────┴─────────────┐                                                                                                                                                                              
│         PROJECTION        │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│         cntrycode         │                                                                                                                                                                              
│         c_acctbal         │                                                                                                                                                                              
└─────────────┬─────────────┘                                                                                                                                                                                                           
┌─────────────┴─────────────┐                                                                                                                                                                              
│         PROJECTION        │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│         cntrycode         │                                                                                                                                                                              
│         c_acctbal         │                                                                                                                                                                              
└─────────────┬─────────────┘                                                                                                                                                                                                           
┌─────────────┴─────────────┐                                                                                                                                                                              
│      RIGHT_DELIM_JOIN     │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│         RIGHT_ANTI        │                                                                                                                                                                              
│ c_custkey IS NOT DISTINCT ├─────────────────────────────────────────────────────────────────────────────────────────────────────┐                                                                        
│       FROM c_custkey      │                                                                                                     │                                                                        
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                     │                                                                        
│        EC: 1500000        │                                                                                                     │                                                                        
└─────────────┬─────────────┘                                                                                                     │                                                                                                     
┌─────────────┴─────────────┐                                                                                       ┌─────────────┴─────────────┐                                                          
│      NESTED_LOOP_JOIN     │                                                                                       │         HASH_JOIN         │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│           INNER           │                                                                                       │         RIGHT_ANTI        │                                                          
│CAST(c_acctbal AS DOUBLE) >├───────────────────────────────────────────┐                                           │ c_custkey IS NOT DISTINCT ├───────────────────────────────────────────┐              
│          SUBQUERY         │                                           │                                           │       FROM c_custkey      │                                           │              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                           │                                           │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                           │              
│           EC: 0           │                                           │                                           │        EC: 1500000        │                                           │              
└─────────────┬─────────────┘                                           │                                           └─────────────┬─────────────┘                                           │                                           
┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐
│           FILTER          │                             │    UNGROUPED_AGGREGATE    │                             │         PROJECTION        │                             │         DUMMY_SCAN        │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │                           │
│          IN (...)         │                             │         first(#0)         │                             │         c_custkey         │                             │                           │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │                           │                             │                           │                             │                           │
│         EC: 30000         │                             │                           │                             │                           │                             │                           │
└─────────────┬─────────────┘                             └─────────────┬─────────────┘                             └─────────────┬─────────────┘                             └───────────────────────────┘                             
┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐                                                          
│         HASH_JOIN         │                             │         PROJECTION        │                             │         HASH_JOIN         │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│            MARK           │                             │             #0            │                             │           INNER           │                                                          
│substring(c_phone, 1, 2) = ├──────────────┐              │                           │                             │   o_custkey = c_custkey   ├──────────────┐                                           
│             #0            │              │              │                           │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              │                           │                             │        EC: 1500000        │              │                                           
│         EC: 150000        │              │              │                           │                             │                           │              │                                           
└─────────────┬─────────────┘              │              └─────────────┬─────────────┘                             └─────────────┬─────────────┘              │                                                                        
┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             
│         SEQ_SCAN          ││      COLUMN_DATA_SCAN     ││      STREAMING_LIMIT      │                             │         SEQ_SCAN          ││         DELIM_SCAN        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           ││                           │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                             
│          customer         ││                           ││                           │                             │           orders          ││                           │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           ││                           │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                             
│          c_phone          ││                           ││                           │                             │         o_custkey         ││                           │                             
│         c_acctbal         ││                           ││                           │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                             
│         c_custkey         ││                           ││                           │                             │        EC: 1500000        ││                           │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           ││                           │                             │                           ││                           │                             
│         EC: 150000        ││                           ││                           │                             │                           ││                           │                             
└───────────────────────────┘└───────────────────────────┘└─────────────┬─────────────┘                             └───────────────────────────┘└───────────────────────────┘                                                          
                                                          ┌─────────────┴─────────────┐                                                                                                                    
                                                          │    UNGROUPED_AGGREGATE    │                                                                                                                    
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
                                                          │          avg(#0)          │                                                                                                                    
                                                          └─────────────┬─────────────┘                                                                                                                                                 
                                                          ┌─────────────┴─────────────┐                                                                                                                    
                                                          │         PROJECTION        │                                                                                                                    
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
                                                          │         c_acctbal         │                                                                                                                    
                                                          └─────────────┬─────────────┘                                                                                                                                                 
                                                          ┌─────────────┴─────────────┐                                                                                                                    
                                                          │         PROJECTION        │                                                                                                                    
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
                                                          │             #0            │                                                                                                                    
                                                          │             #2            │                                                                                                                    
                                                          └─────────────┬─────────────┘                                                                                                                                                 
                                                          ┌─────────────┴─────────────┐                                                                                                                    
                                                          │           FILTER          │                                                                                                                    
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
                                                          │          IN (...)         │                                                                                                                    
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
                                                          │          EC: 6000         │                                                                                                                    
                                                          └─────────────┬─────────────┘                                                                                                                                                 
                                                          ┌─────────────┴─────────────┐                                                                                                                    
                                                          │         HASH_JOIN         │                                                                                                                    
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
                                                          │            MARK           │                                                                                                                    
                                                          │substring(c_phone, 1, 2) = ├──────────────┐                                                                                                     
                                                          │             #0            │              │                                                                                                     
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                                                                                     
                                                          │         EC: 30000         │              │                                                                                                     
                                                          └─────────────┬─────────────┘              │                                                                                                                                  
                                                          ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                       
                                                          │         SEQ_SCAN          ││      COLUMN_DATA_SCAN     │                                                                                       
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                                                                       
                                                          │          customer         ││                           │                                                                                       
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                                                                       
                                                          │         c_acctbal         ││                           │                                                                                       
                                                          │          c_phone          ││                           │                                                                                       
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                                                                       
                                                          │Filters: c_acctbal>0.00 AND││                           │                                                                                       
                                                          │    c_acctbal IS NOT NULL  ││                           │                                                                                       
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                                                                       
                                                          │         EC: 30000         ││                           │                                                                                       
                                                          └───────────────────────────┘└───────────────────────────┘                                                                                                                    

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

X {'RESULT_COLLECTOR0': 1e-05, 'STREAMING_LIMIT1': 2e-06, 'ORDER_BY2': 4.7e-05, 'HASH_GROUP_BY3': 0.00101, 'PROJECTION4': 2e-06, 'PROJECTION5': 2.4e-05, 'RIGHT_DELIM_JOIN6': 0.008126, 'RIGHT_DELIM_JOIN7': 0.020339, 'HASH_JOIN8': 0.044172, 'SEQ_SCAN 9': 0.040253, 'HASH_JOIN10': 0.029796, 'FILTER11': 0.016019, 'SEQ_SCAN 12': 0.014117, 'HASH_JOIN13': 5.8e-05, 'SEQ_SCAN 14': 0.000192, 'SEQ_SCAN 15': 2.4e-05, 'HASH_JOIN16': 0.03402, 'PROJECTION17': 0.000819, 'HASH_JOIN18': 0.096782, 'SEQ_SCAN 19': 0.007126, 'DELIM_SCAN20': 0.0, 'DUMMY_SCAN21': 0.0, 'HASH_GROUP_BY22': 0.000992, 'HASH_JOIN23': 0.018481, 'PROJECTION24': 0.000235, 'HASH_JOIN25': 0.085725, 'FILTER26': 0.015607, 'SEQ_SCAN 27': 0.009321, 'DELIM_SCAN28': 0.0, 'DUMMY_SCAN29': 0.0, 'HASH_GROUP_BY30': 0.000956}
**** output size:  100
LINEAGE_4_FILTER_1
LINEAGE_4_FILTER_17
LINEAGE_4_HASH_GROUP_BY_14
LINEAGE_4_HASH_GROUP_BY_27
LINEAGE_4_HASH_GROUP_BY_7
LINEAGE_4_HASH_JOIN_10
LINEAGE_4_HASH_JOIN_13
LINEAGE_4_HASH_JOIN_20
LINEAGE_4_HASH_JOIN_21
LINEAGE_4_HASH_JOIN_22
LINEAGE_4_HASH_JOIN_3
LINEAGE_4_HASH_JOIN_6
LINEAGE_4_ORDER_BY_28
LINEAGE_4_SEQ_SCAN_0
LINEAGE_4_SEQ_SCAN_15
LINEAGE_4_SEQ_SCAN_16
LINEAGE_4_SEQ_SCAN_18
LINEAGE_4_SEQ_SCAN_19
LINEAGE_4_SEQ_SCAN_8
LINEAGE_4_STREAMING_LIMIT_29
SELECT s_name, count(*) AS numwait FROM supplier, lineitem l1, orders, nation WHERE s_suppkey = l1.l_suppkey AND o_orderkey = l1.l_orderkey AND o_orderstatus = 'F' AND l1.l_receiptdate > l1.l_commitdate AND EXISTS ( SELECT * FROM lineitem l2 WHERE l2.l_orderkey = l1.l_orderkey AND l2.l_suppkey <> l1.l_suppkey) AND NOT EXISTS ( SELECT * FROM lineitem l3 WHERE l3.l_orderkey = l1.l_orderkey AND l3.l_suppkey <> l1.l_suppkey AND l3.l_receiptdate > l3.l_commitdate) AND s_nationkey = n_nationkey AND n_name = 'SAUDI ARABIA' GROUP BY s_name ORDER BY numwait DESC, s_name LIMIT 100;
   query_id  ...                                               plan
0         4  ...  {"name": "STREAMING_LIMIT", "opid": "29", "chi...

[1 rows x 7 columns]
Query info:  query_id                                                            4
query               SELECT s_name, count(*) AS numwait FROM suppli...
size_bytes_max                                               57444680
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "STREAMING_LIMIT", "opid": "29", "chi...
Name: 0, dtype: object
{"name": "STREAMING_LIMIT", "opid": "29", "children": [{"name": "ORDER_BY", "opid": "28", "children": [{"name": "HASH_GROUP_BY", "opid": "27", "children": [{"name": "PROJECTION", "opid": "26", "children": [{"name": "PROJECTION", "opid": "25", "children": [{"name": "RIGHT_DELIM_JOIN", "opid": "24", "children": [{"name": "HASH_GROUP_BY", "opid": "7", "children": [],"table": "","extra": "#0\n#1"},{"name": "HASH_JOIN", "opid": "6", "children": [{"name": "PROJECTION", "opid": "4", "children": [{"name": "HASH_JOIN", "opid": "3", "children": [{"name": "FILTER", "opid": "1", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_suppkey\nl_receiptdate\nl_commitdate\n[INFOSEPARATOR]\nEC: 6001215"}],"table": "","extra": "(l_receiptdate > l_commitdate)\n[INFOSEPARATOR]\nEC: 6001215"},{"name": "DELIM_SCAN", "opid": "2", "children": [],"table": "","extra": ""}],"table": "","extra": "INNER\nl_orderkey = l_orderkey\nl_suppkey != l_suppkey\n\n[INFOSEPARATOR]\nEC: 1200243\n"}],"table": "","extra": "l_orderkey\nl_suppkey\n"},{"name": "DUMMY_SCAN", "opid": "5", "children": [],"table": "","extra": ""}],"table": "","extra": "RIGHT_ANTI\nl_orderkey IS NOT DISTINCT FROM l_orderkey\nl_suppkey IS NOT DISTINCT FROM l_suppkey\n\n[INFOSEPARATOR]\nEC: 6001215\n"},{"name": "RIGHT_DELIM_JOIN", "opid": "23", "children": [{"name": "HASH_GROUP_BY", "opid": "14", "children": [],"table": "","extra": "#0\n#1"},{"name": "HASH_JOIN", "opid": "13", "children": [{"name": "PROJECTION", "opid": "11", "children": [{"name": "HASH_JOIN", "opid": "10", "children": [{"name": "SEQ_SCAN ", "opid": "8", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_suppkey\n[INFOSEPARATOR]\nEC: 6001215"},{"name": "DELIM_SCAN", "opid": "9", "children": [],"table": "","extra": ""}],"table": "","extra": "INNER\nl_orderkey = l_orderkey\nl_suppkey != l_suppkey\n\n[INFOSEPARATOR]\nEC: 6001215\n"}],"table": "","extra": "l_orderkey\nl_suppkey\n"},{"name": "DUMMY_SCAN", "opid": "12", "children": [],"table": "","extra": ""}],"table": "","extra": "RIGHT_SEMI\nl_orderkey IS NOT DISTINCT FROM l_orderkey\nl_suppkey IS NOT DISTINCT FROM l_suppkey\n\n[INFOSEPARATOR]\nEC: 6001215\n"},{"name": "HASH_JOIN", "opid": "22", "children": [{"name": "SEQ_SCAN ", "opid": "15", "children": [],"table": "orders","extra": "orders\n[INFOSEPARATOR]\no_orderkey\n[INFOSEPARATOR]\nFilters: o_orderstatus='F' AND o_orderstatus IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 500000"},{"name": "HASH_JOIN", "opid": "21", "children": [{"name": "FILTER", "opid": "17", "children": [{"name": "SEQ_SCAN ", "opid": "16", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_suppkey\nl_orderkey\nl_receiptdate\nl_commitdate\n[INFOSEPARATOR]\nEC: 1200243"}],"table": "","extra": "(l_receiptdate > l_commitdate)\n[INFOSEPARATOR]\nEC: 1200243"},{"name": "HASH_JOIN", "opid": "20", "children": [{"name": "SEQ_SCAN ", "opid": "18", "children": [],"table": "supplier","extra": "supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\ns_name\n[INFOSEPARATOR]\nEC: 10000"},{"name": "SEQ_SCAN ", "opid": "19", "children": [],"table": "nation","extra": "nation\n[INFOSEPARATOR]\nn_nationkey\n[INFOSEPARATOR]\nFilters: n_name='SAUDI ARABIA' AND n_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1"}],"table": "","extra": "INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 400\n"}],"table": "","extra": "INNER\nl_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 47600\n"}],"table": "","extra": "INNER\no_orderkey = l_orderkey\n\n[INFOSEPARATOR]\nEC: 15866\n"}],"table": "","extra": "RIGHT_SEMI\nl_orderkey IS NOT DISTINCT FROM l_orderkey\nl_suppkey IS NOT DISTINCT FROM l_suppkey\n\n[INFOSEPARATOR]\nEC: 6001215\n"}],"table": "","extra": "RIGHT_ANTI\nl_orderkey IS NOT DISTINCT FROM l_orderkey\nl_suppkey IS NOT DISTINCT FROM l_suppkey\n\n[INFOSEPARATOR]\nEC: 6001215\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n__internal_compress_integral_usmallint(#1, 1)\n__internal_compress_integral_uinteger(#2, 1)\n#3\n"}],"table": "","extra": "s_name\n"}],"table": "","extra": "#0\ncount_star()"}],"table": "","extra": "ORDERS:\ncount_star() DESC\nsupplier.s_name ASC"}],"table": "","extra": ""}
%%%%%%%%%%%%%%%% Running Query #  22  threads:  1
SELECT cntrycode, count(*) AS numcust, sum(c_acctbal) AS totacctbal FROM ( SELECT substring(c_phone FROM 1 FOR 2) AS cntrycode, c_acctbal FROM customer WHERE substring(c_phone FROM 1 FOR 2) IN ('13', '31', '23', '29', '30', '18', '17') AND c_acctbal > ( SELECT avg(c_acctbal) FROM customer WHERE c_acctbal > 0.00 AND substring(c_phone FROM 1 FOR 2) IN ('13', '31', '23', '29', '30', '18', '17')) AND NOT EXISTS ( SELECT * FROM orders WHERE o_custkey = c_custkey)) AS custsale GROUP BY cntrycode ORDER BY cntrycode;
Run:  None SELECT cntrycode, count(*) AS numcust, sum(c_acctbal) AS totacctbal FROM ( SELECT substring(c_phone FROM 1 FOR 2) AS cntrycode, c_acctbal FROM customer WHERE substring(c_phone FROM 1 FOR 2) IN ('13', '31', '23', '29', '30', '18', '17') AND c_acctbal > ( SELECT avg(c_acctbal) FROM customer WHERE c_acctbal > 0.00 AND substring(c_phone FROM 1 FOR 2) IN ('13', '31', '23', '29', '30', '18', '17')) AND NOT EXISTS ( SELECT * FROM orders WHERE o_custkey = c_custkey)) AS custsale GROUP BY cntrycode ORDER BY cntrycode;
Avg Time in sec:  0.08233178313821554  output size:  7
  cntrycode  numcust  totacctbal
0        13      888  6737713.99
1        17      861  6460573.72
2        18      964  7236687.40
3        23      892  6701457.95
4        29      948  7158866.63
5        30      909  6808436.13
6        31      922  6806670.18
uncompressed filter_log_size: 328268
uncompressed filter_log_buffer_size: 320540
uncompressed limit_offset_size: 1608
uncompressed limit_offset_buffer_size: 0
uncompressed perfect_full_scan_ht_log_size: 1584
uncompressed perfect_full_scan_ht_log_buffer_size: 0
uncompressed perfect_probe_ht_log_size: 1584
uncompressed perfect_probe_ht_log_buffer_size: 0
uncompressed row_group_log_size: 587776
uncompressed row_group_log_buffer_size: 545232
uncompressed scatter_log_size: 206768
uncompressed scatter_log_buffer_size: 203072
uncompressed scatter_sel_log_size: 462424
uncompressed scatter_sel_log_buffer_size: 456168
uncompressed gather_log_size: 1584
uncompressed gather_log_buffer_size: 0
uncompressed combine_log_size: 1584
uncompressed combine_log_buffer_size: 0
uncompressed finalize_states_log_size: 153912
uncompressed finalize_states_log_buffer_size: 152056
uncompressed join_gather_log_size: 4778152
uncompressed join_gather_log_buffer_size: 4612728
uncompressed reorder_log_size: 1664
uncompressed reorder_log_buffer_size: 0
uncompressed cross_log_size: 1584
uncompressed cross_log_buffer_size: 0
uncompressed nlj_log_size: 161936
uncompressed nlj_log_buffer_size: 153184
uncompressed total_size: 6690428
uncompressed total_buffer_size: 6442980
uncompressed total_element_size: 247448

{'name': 'Query', 'result': 0.078693, 'timing': 0.078693, 'cardinality': 0, 'extra-info': "SELECT cntrycode, count(*) AS numcust, sum(c_acctbal) AS totacctbal FROM ( SELECT substring(c_phone FROM 1 FOR 2) AS cntrycode, c_acctbal FROM customer WHERE substring(c_phone FROM 1 FOR 2) IN ('13', '31', '23', '29', '30', '18', '17') AND c_acctbal > ( SELECT avg(c_acctbal) FROM customer WHERE c_acctbal > 0.00 AND substring(c_phone FROM 1 FOR 2) IN ('13', '31', '23', '29', '30', '18', '17')) AND NOT EXISTS ( SELECT * FROM orders WHERE o_custkey = c_custkey)) AS custsale GROUP BY cntrycode ORDER BY cntrycode;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 6e-06, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'ORDER_BY', 'timing': 4.9e-05, 'cardinality': 7, 'extra_info': 'ORDERS:\ncustsale.cntrycode ASC', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.000954, 'cardinality': 7, 'extra_info': '#0\ncount_star()\nsum(#1)', 'children': [{'name': 'PROJECTION', 'timing': 2e-06, 'cardinality': 6384, 'extra_info': 'cntrycode\nc_acctbal\n', 'children': [{'name': 'PROJECTION', 'timing': 0.000273, 'cardinality': 6384, 'extra_info': 'cntrycode\nc_acctbal\n', 'children': [{'name': 'RIGHT_DELIM_JOIN', 'timing': 0.005963, 'cardinality': 0, 'extra_info': 'RIGHT_ANTI\nc_custkey IS NOT DISTINCT FROM c_custkey\n\n[INFOSEPARATOR]\nEC: 1500000\n', 'children': [{'name': 'NESTED_LOOP_JOIN', 'timing': 0.00148, 'cardinality': 19000, 'extra_info': 'INNER\nCAST(c_acctbal AS DOUBLE) > SUBQUERY\n\n[INFOSEPARATOR]\nEC: 0\n', 'children': [{'name': 'FILTER', 'timing': 0.000678, 'cardinality': 42015, 'extra_info': 'IN (...)\n[INFOSEPARATOR]\nEC: 30000', 'children': [{'name': 'HASH_JOIN', 'timing': 0.00732, 'cardinality': 150000, 'extra_info': 'MARK\nsubstring(c_phone, 1, 2) = #0\n\n[INFOSEPARATOR]\nEC: 150000\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.002585, 'cardinality': 150000, 'extra_info': 'customer\n[INFOSEPARATOR]\nc_phone\nc_acctbal\nc_custkey\n[INFOSEPARATOR]\nEC: 150000', 'children': []}, {'name': 'COLUMN_DATA_SCAN', 'timing': 3e-06, 'cardinality': 7, 'extra_info': '', 'children': []}]}]}, {'name': 'UNGROUPED_AGGREGATE', 'timing': 2e-06, 'cardinality': 1, 'extra_info': 'first(#0)', 'children': [{'name': 'PROJECTION', 'timing': 0.0, 'cardinality': 1, 'extra_info': '#0\n', 'children': [{'name': 'STREAMING_LIMIT', 'timing': 2e-06, 'cardinality': 1, 'extra_info': '', 'children': [{'name': 'UNGROUPED_AGGREGATE', 'timing': 0.000107, 'cardinality': 1, 'extra_info': 'avg(#0)', 'children': [{'name': 'PROJECTION', 'timing': 1.5e-05, 'cardinality': 38120, 'extra_info': 'c_acctbal\n', 'children': [{'name': 'PROJECTION', 'timing': 2.3e-05, 'cardinality': 38120, 'extra_info': '#0\n#2\n', 'children': [{'name': 'FILTER', 'timing': 0.000646, 'cardinality': 38120, 'extra_info': 'IN (...)\n[INFOSEPARATOR]\nEC: 6000', 'children': [{'name': 'HASH_JOIN', 'timing': 0.006777, 'cardinality': 136308, 'extra_info': 'MARK\nsubstring(c_phone, 1, 2) = #0\n\n[INFOSEPARATOR]\nEC: 30000\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.003657, 'cardinality': 136308, 'extra_info': 'customer\n[INFOSEPARATOR]\nc_acctbal\nc_phone\n[INFOSEPARATOR]\nFilters: c_acctbal>0.00 AND c_acctbal IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 30000', 'children': []}, {'name': 'COLUMN_DATA_SCAN', 'timing': 8e-06, 'cardinality': 7, 'extra_info': '', 'children': []}]}]}]}]}]}]}]}]}]}, {'name': 'HASH_JOIN', 'timing': 0.010321, 'cardinality': 6384, 'extra_info': 'RIGHT_ANTI\nc_custkey IS NOT DISTINCT FROM c_custkey\n\n[INFOSEPARATOR]\nEC: 1500000\n', 'children': [{'name': 'PROJECTION', 'timing': 0.000186, 'cardinality': 190069, 'extra_info': 'c_custkey\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.030447, 'cardinality': 190069, 'extra_info': 'INNER\no_custkey = c_custkey\n\n[INFOSEPARATOR]\nEC: 1500000\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.001346, 'cardinality': 1500000, 'extra_info': 'orders\n[INFOSEPARATOR]\no_custkey\n[INFOSEPARATOR]\nEC: 1500000', 'children': []}, {'name': 'DELIM_SCAN', 'timing': 0.0, 'cardinality': 0, 'extra_info': '', 'children': []}]}]}, {'name': 'DUMMY_SCAN', 'timing': 0.0, 'cardinality': 0, 'extra_info': '', 'children': []}]}, {'name': 'HASH_GROUP_BY', 'timing': 0.000158, 'cardinality': 19000, 'extra_info': '#2', 'children': []}]}]}]}]}]}]}]}
X {'RESULT_COLLECTOR0': 6e-06, 'ORDER_BY1': 4.9e-05, 'HASH_GROUP_BY2': 0.000954, 'PROJECTION3': 2e-06, 'PROJECTION4': 0.000273, 'RIGHT_DELIM_JOIN5': 0.005963, 'NESTED_LOOP_JOIN6': 0.00148, 'FILTER7': 0.000678, 'HASH_JOIN8': 0.00732, 'SEQ_SCAN 9': 0.002585, 'COLUMN_DATA_SCAN10': 3e-06, 'UNGROUPED_AGGREGATE11': 2e-06, 'PROJECTION12': 0.0, 'STREAMING_LIMIT13': 2e-06, 'UNGROUPED_AGGREGATE14': 0.000107, 'PROJECTION15': 1.5e-05, 'PROJECTION16': 2.3e-05, 'FILTER17': 0.000646, 'HASH_JOIN18': 0.006777, 'SEQ_SCAN 19': 0.003657, 'COLUMN_DATA_SCAN20': 8e-06, 'HASH_JOIN21': 0.010321, 'PROJECTION22': 0.000186, 'HASH_JOIN23': 0.030447, 'SEQ_SCAN 24': 0.001346, 'DELIM_SCAN25': 0.0, 'DUMMY_SCAN26': 0.0, 'HASH_GROUP_BY27': 0.000158}
**** output size:  7
LINEAGE_4_COLUMN_DATA_SCAN_12
LINEAGE_4_COLUMN_DATA_SCAN_8
LINEAGE_4_FILTER_10
LINEAGE_4_FILTER_14
LINEAGE_4_HASH_GROUP_BY_25
LINEAGE_4_HASH_GROUP_BY_6
LINEAGE_4_HASH_JOIN_13
LINEAGE_4_HASH_JOIN_2
LINEAGE_4_HASH_JOIN_5
LINEAGE_4_HASH_JOIN_9
LINEAGE_4_NESTED_LOOP_JOIN_21
LINEAGE_4_ORDER_BY_26
LINEAGE_4_SEQ_SCAN_0
LINEAGE_4_SEQ_SCAN_11
LINEAGE_4_SEQ_SCAN_7
LINEAGE_4_STREAMING_LIMIT_18
SELECT cntrycode, count(*) AS numcust, sum(c_acctbal) AS totacctbal FROM ( SELECT substring(c_phone FROM 1 FOR 2) AS cntrycode, c_acctbal FROM customer WHERE substring(c_phone FROM 1 FOR 2) IN ('13', '31', '23', '29', '30', '18', '17') AND c_acctbal > ( SELECT avg(c_acctbal) FROM customer WHERE c_acctbal > 0.00 AND substring(c_phone FROM 1 FOR 2) IN ('13', '31', '23', '29', '30', '18', '17')) AND NOT EXISTS ( SELECT * FROM orders WHERE o_custkey = c_custkey)) AS custsale GROUP BY cntrycode ORDER BY cntrycode;
   query_id  ...                                               plan
0         4  ...  {"name": "ORDER_BY", "opid": "26", "children":...

[1 rows x 7 columns]
Query info:  query_id                                                            4
query               SELECT cntrycode, count(*) AS numcust, sum(c_a...
size_bytes_max                                                6690428
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "ORDER_BY", "opid": "26", "children":...
Name: 0, dtype: object
{"name": "ORDER_BY", "opid": "26", "children": [{"name": "HASH_GROUP_BY", "opid": "25", "children": [{"name": "PROJECTION", "opid": "24", "children": [{"name": "PROJECTION", "opid": "23", "children": [{"name": "RIGHT_DELIM_JOIN", "opid": "22", "children": [{"name": "HASH_GROUP_BY", "opid": "6", "children": [],"table": "","extra": "#2"},{"name": "HASH_JOIN", "opid": "5", "children": [{"name": "PROJECTION", "opid": "3", "children": [{"name": "HASH_JOIN", "opid": "2", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "orders","extra": "orders\n[INFOSEPARATOR]\no_custkey\n[INFOSEPARATOR]\nEC: 1500000"},{"name": "DELIM_SCAN", "opid": "1", "children": [],"table": "","extra": ""}],"table": "","extra": "INNER\no_custkey = c_custkey\n\n[INFOSEPARATOR]\nEC: 1500000\n"}],"table": "","extra": "c_custkey\n"},{"name": "DUMMY_SCAN", "opid": "4", "children": [],"table": "","extra": ""}],"table": "","extra": "RIGHT_ANTI\nc_custkey IS NOT DISTINCT FROM c_custkey\n\n[INFOSEPARATOR]\nEC: 1500000\n"},{"name": "NESTED_LOOP_JOIN", "opid": "21", "children": [{"name": "FILTER", "opid": "10", "children": [{"name": "HASH_JOIN", "opid": "9", "children": [{"name": "SEQ_SCAN ", "opid": "7", "children": [],"table": "customer","extra": "customer\n[INFOSEPARATOR]\nc_phone\nc_acctbal\nc_custkey\n[INFOSEPARATOR]\nEC: 150000"},{"name": "COLUMN_DATA_SCAN", "opid": "8", "children": [],"table": "","extra": ""}],"table": "","extra": "MARK\nsubstring(c_phone, 1, 2) = #0\n\n[INFOSEPARATOR]\nEC: 150000\n"}],"table": "","extra": "IN (...)\n[INFOSEPARATOR]\nEC: 30000"},{"name": "UNGROUPED_AGGREGATE", "opid": "20", "children": [{"name": "PROJECTION", "opid": "19", "children": [{"name": "STREAMING_LIMIT", "opid": "18", "children": [{"name": "UNGROUPED_AGGREGATE", "opid": "17", "children": [{"name": "PROJECTION", "opid": "16", "children": [{"name": "PROJECTION", "opid": "15", "children": [{"name": "FILTER", "opid": "14", "children": [{"name": "HASH_JOIN", "opid": "13", "children": [{"name": "SEQ_SCAN ", "opid": "11", "children": [],"table": "customer","extra": "customer\n[INFOSEPARATOR]\nc_acctbal\nc_phone\n[INFOSEPARATOR]\nFilters: c_acctbal>0.00 AND c_acctbal IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 30000"},{"name": "COLUMN_DATA_SCAN", "opid": "12", "children": [],"table": "","extra": ""}],"table": "","extra": "MARK\nsubstring(c_phone, 1, 2) = #0\n\n[INFOSEPARATOR]\nEC: 30000\n"}],"table": "","extra": "IN (...)\n[INFOSEPARATOR]\nEC: 6000"}],"table": "","extra": "#0\n#2\n"}],"table": "","extra": "c_acctbal\n"}],"table": "","extra": "avg(#0)"}],"table": "","extra": ""}],"table": "","extra": "#0\n"}],"table": "","extra": "first(#0)"}],"table": "","extra": "INNER\nCAST(c_acctbal AS DOUBLE) > SUBQUERY\n\n[INFOSEPARATOR]\nEC: 0\n"}],"table": "","extra": "RIGHT_ANTI\nc_custkey IS NOT DISTINCT FROM c_custkey\n\n[INFOSEPARATOR]\nEC: 1500000\n"}],"table": "","extra": "cntrycode\nc_acctbal\n"}],"table": "","extra": "cntrycode\nc_acctbal\n"}],"table": "","extra": "#0\ncount_star()\nsum(#1)"}],"table": "","extra": "ORDERS:\ncustsale.cntrycode ASC"}
Clear Lineage

average 24.121308240023527
tpch_benchmark_capture_output_prefix.csv
