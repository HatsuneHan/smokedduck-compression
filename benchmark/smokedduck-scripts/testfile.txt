
Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐
│         PROJECTION        │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│__internal_decompress_strin│
│           g(#0)           │
│__internal_decompress_strin│
│           g(#1)           │
│             #2            │
│             #3            │
│             #4            │
│             #5            │
│             #6            │
│             #7            │
│             #8            │
│             #9            │
└─────────────┬─────────────┘                             
┌─────────────┴─────────────┐
│          ORDER_BY         │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│          ORDERS:          │
│ lineitem.l_returnflag ASC │
│ lineitem.l_linestatus ASC │
└─────────────┬─────────────┘                             
┌─────────────┴─────────────┐
│         PROJECTION        │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│__internal_compress_string_│
│        utinyint(#0)       │
│__internal_compress_string_│
│        utinyint(#1)       │
│             #2            │
│             #3            │
│             #4            │
│             #5            │
│             #6            │
│             #7            │
│             #8            │
│             #9            │
└─────────────┬─────────────┘                             
┌─────────────┴─────────────┐
│         PROJECTION        │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│__internal_decompress_strin│
│           g(#0)           │
│__internal_decompress_strin│
│           g(#1)           │
│             #2            │
│             #3            │
│             #4            │
│             #5            │
│             #6            │
│             #7            │
│             #8            │
│             #9            │
└─────────────┬─────────────┘                             
┌─────────────┴─────────────┐
│   PERFECT_HASH_GROUP_BY   │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│             #0            │
│             #1            │
│    sum_no_overflow(#2)    │
│    sum_no_overflow(#3)    │
│    sum_no_overflow(#4)    │
│    sum_no_overflow(#5)    │
│          avg(#6)          │
│          avg(#7)          │
│          avg(#8)          │
│        count_star()       │
└─────────────┬─────────────┘                             
┌─────────────┴─────────────┐
│         PROJECTION        │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│        l_returnflag       │
│        l_linestatus       │
│         l_quantity        │
│      l_extendedprice      │
│             #4            │
│   (#4 * (1.00 + l_tax))   │
│         l_quantity        │
│      l_extendedprice      │
│         l_discount        │
└─────────────┬─────────────┘                             
┌─────────────┴─────────────┐
│         PROJECTION        │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│__internal_compress_string_│
│        utinyint(#0)       │
│__internal_compress_string_│
│        utinyint(#1)       │
│             #2            │
│             #3            │
│             #4            │
│             #5            │
│             #6            │
└─────────────┬─────────────┘                             
┌─────────────┴─────────────┐
│         PROJECTION        │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│        l_returnflag       │
│        l_linestatus       │
│         l_quantity        │
│      l_extendedprice      │
│ (l_extendedprice * (1.00 -│
│        l_discount))       │
│           l_tax           │
│         l_discount        │
└─────────────┬─────────────┘                             
┌─────────────┴─────────────┐
│         SEQ_SCAN          │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│          lineitem         │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│        l_returnflag       │
│        l_linestatus       │
│         l_quantity        │
│      l_extendedprice      │
│         l_discount        │
│           l_tax           │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│ Filters: l_shipdate<='1998│
│-09-02'::DATE AND l_sh...  │
│         IS NOT NULL       │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│        EC: 1200243        │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

Clear Lineage
True
%%%%%%%%%%%%%%%% Running Query #  1  threads:  1
SELECT l_returnflag, l_linestatus, sum(l_quantity) AS sum_qty, sum(l_extendedprice) AS sum_base_price, sum(l_extendedprice * (1 - l_discount)) AS sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) AS sum_charge, avg(l_quantity) AS avg_qty, avg(l_extendedprice) AS avg_price, avg(l_discount) AS avg_disc, count(*) AS count_order FROM lineitem WHERE l_shipdate <= CAST('1998-09-02' AS date) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus
Run:  None SELECT l_returnflag, l_linestatus, sum(l_quantity) AS sum_qty, sum(l_extendedprice) AS sum_base_price, sum(l_extendedprice * (1 - l_discount)) AS sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) AS sum_charge, avg(l_quantity) AS avg_qty, avg(l_extendedprice) AS avg_price, avg(l_discount) AS avg_disc, count(*) AS count_order FROM lineitem WHERE l_shipdate <= CAST('1998-09-02' AS date) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus
Avg Time in sec:  0.5690359296277165  output size:  4
  l_returnflag l_linestatus     sum_qty  ...     avg_price  avg_disc  count_order
0            A            F  37734107.0  ...  38273.129735  0.049985      1478493
1            N            F    991417.0  ...  38284.467761  0.050093        38854
2            N            O  74476040.0  ...  38249.117989  0.049997      2920374
3            R            F  37719753.0  ...  38250.854626  0.050009      1478870

[4 rows x 10 columns]
{'name': 'Query', 'result': 0.564856, 'timing': 0.564856, 'cardinality': 0, 'extra-info': "SELECT l_returnflag, l_linestatus, sum(l_quantity) AS sum_qty, sum(l_extendedprice) AS sum_base_price, sum(l_extendedprice * (1 - l_discount)) AS sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) AS sum_charge, avg(l_quantity) AS avg_qty, avg(l_extendedprice) AS avg_price, avg(l_discount) AS avg_disc, count(*) AS count_order FROM lineitem WHERE l_shipdate <= CAST('1998-09-02' AS date) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 3.4e-05, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 2e-06, 'cardinality': 4, 'extra_info': '__internal_decompress_string(#0)\n__internal_decompress_string(#1)\n#2\n#3\n#4\n#5\n#6\n#7\n#8\n#9\n', 'children': [{'name': 'ORDER_BY', 'timing': 6.3e-05, 'cardinality': 4, 'extra_info': 'ORDERS:\nlineitem.l_returnflag ASC\nlineitem.l_linestatus ASC', 'children': [{'name': 'PROJECTION', 'timing': 1e-06, 'cardinality': 4, 'extra_info': '__internal_compress_string_utinyint(#0)\n__internal_compress_string_utinyint(#1)\n#2\n#3\n#4\n#5\n#6\n#7\n#8\n#9\n', 'children': [{'name': 'PROJECTION', 'timing': 4e-06, 'cardinality': 4, 'extra_info': '__internal_decompress_string(#0)\n__internal_decompress_string(#1)\n#2\n#3\n#4\n#5\n#6\n#7\n#8\n#9\n', 'children': [{'name': 'PERFECT_HASH_GROUP_BY', 'timing': 0.156647, 'cardinality': 4, 'extra_info': '#0\n#1\nsum_no_overflow(#2)\nsum_no_overflow(#3)\nsum_no_overflow(#4)\nsum_no_overflow(#5)\navg(#6)\navg(#7)\navg(#8)\ncount_star()', 'children': [{'name': 'PROJECTION', 'timing': 0.037087, 'cardinality': 5916591, 'extra_info': 'l_returnflag\nl_linestatus\nl_quantity\nl_extendedprice\n#4\n(#4 * (1.00 + l_tax))\nl_quantity\nl_extendedprice\nl_discount\n', 'children': [{'name': 'PROJECTION', 'timing': 0.027179, 'cardinality': 5916591, 'extra_info': '__internal_compress_string_utinyint(#0)\n__internal_compress_string_utinyint(#1)\n#2\n#3\n#4\n#5\n#6\n', 'children': [{'name': 'PROJECTION', 'timing': 0.056129, 'cardinality': 5916591, 'extra_info': 'l_returnflag\nl_linestatus\nl_quantity\nl_extendedprice\n(l_extendedprice * (1.00 - l_discount))\nl_tax\nl_discount\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.27687, 'cardinality': 5916591, 'extra_info': "lineitem\n[INFOSEPARATOR]\nl_returnflag\nl_linestatus\nl_quantity\nl_extendedprice\nl_discount\nl_tax\n[INFOSEPARATOR]\nFilters: l_shipdate<='1998-09-02'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243", 'children': []}]}]}]}]}]}]}]}]}]}]}
X {'RESULT_COLLECTOR0': 3.4e-05, 'PROJECTION1': 2e-06, 'ORDER_BY2': 6.3e-05, 'PROJECTION3': 1e-06, 'PROJECTION4': 4e-06, 'PERFECT_HASH_GROUP_BY5': 0.156647, 'PROJECTION6': 0.037087, 'PROJECTION7': 0.027179, 'PROJECTION8': 0.056129, 'SEQ_SCAN 9': 0.27687}
Physical operator output, input_left, input_right: 
**** output size:  4
LINEAGE_5_ORDER_BY_7
LINEAGE_5_PERFECT_HASH_GROUP_BY_4
LINEAGE_5_SEQ_SCAN_0
SELECT l_returnflag, l_linestatus, sum(l_quantity) AS sum_qty, sum(l_extendedprice) AS sum_base_price, sum(l_extendedprice * (1 - l_discount)) AS sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) AS sum_charge, avg(l_quantity) AS avg_qty, avg(l_extendedprice) AS avg_price, avg(l_discount) AS avg_disc, count(*) AS count_order FROM lineitem WHERE l_shipdate <= CAST('1998-09-02' AS date) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus
   query_id  ...                                               plan
0         5  ...  {"name": "PROJECTION", "opid": "8", "children"...

[1 rows x 8 columns]
Query info:  query_id                                                            5
query               SELECT l_returnflag, l_linestatus, sum(l_quant...
size_bytes_max                                               12252080
physical_op_size          [0, 0, 64, 0, 0, 11988404, 0, 0, 0, 263612]
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "PROJECTION", "opid": "8", "children"...
Name: 0, dtype: object
physical op size is:
{"name": "PROJECTION", "opid": "8", "children": [{"name": "ORDER_BY", "opid": "7", "children": [{"name": "PROJECTION", "opid": "6", "children": [{"name": "PROJECTION", "opid": "5", "children": [{"name": "PERFECT_HASH_GROUP_BY", "opid": "4", "children": [{"name": "PROJECTION", "opid": "3", "children": [{"name": "PROJECTION", "opid": "2", "children": [{"name": "PROJECTION", "opid": "1", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_returnflag\nl_linestatus\nl_quantity\nl_extendedprice\nl_discount\nl_tax\n[INFOSEPARATOR]\nFilters: l_shipdate<='1998-09-02'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243"}],"table": "","extra": "l_returnflag\nl_linestatus\nl_quantity\nl_extendedprice\n(l_extendedprice * (1.00 - l_discount))\nl_tax\nl_discount\n"}],"table": "","extra": "__internal_compress_string_utinyint(#0)\n__internal_compress_string_utinyint(#1)\n#2\n#3\n#4\n#5\n#6\n"}],"table": "","extra": "l_returnflag\nl_linestatus\nl_quantity\nl_extendedprice\n#4\n(#4 * (1.00 + l_tax))\nl_quantity\nl_extendedprice\nl_discount\n"}],"table": "","extra": "#0\n#1\nsum_no_overflow(#2)\nsum_no_overflow(#3)\nsum_no_overflow(#4)\nsum_no_overflow(#5)\navg(#6)\navg(#7)\navg(#8)\ncount_star()"}],"table": "","extra": "__internal_decompress_string(#0)\n__internal_decompress_string(#1)\n#2\n#3\n#4\n#5\n#6\n#7\n#8\n#9\n"}],"table": "","extra": "__internal_compress_string_utinyint(#0)\n__internal_compress_string_utinyint(#1)\n#2\n#3\n#4\n#5\n#6\n#7\n#8\n#9\n"}],"table": "","extra": "ORDERS:\nlineitem.l_returnflag ASC\nlineitem.l_linestatus ASC"}],"table": "","extra": "__internal_decompress_string(#0)\n__internal_decompress_string(#1)\n#2\n#3\n#4\n#5\n#6\n#7\n#8\n#9\n"}
%%%%%%%%%%%%%%%% Running Query #  2  threads:  1
SELECT s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment FROM part, supplier, partsupp, nation, region WHERE p_partkey = ps_partkey AND s_suppkey = ps_suppkey AND p_size = 15 AND p_type LIKE '%BRASS' AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'EUROPE' AND ps_supplycost = ( SELECT min(ps_supplycost) FROM partsupp, supplier, nation, region WHERE p_partkey = ps_partkey AND s_suppkey = ps_suppkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'EUROPE' ) ORDER BY s_acctbal DESC, n_name, s_name, p_partkey LIMIT 100;
Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────┐                                                                                                                                                                                                                  
│  STREAMING_LIMIT  │                                                                                                                                                                                                                  
└─────────┬─────────┘                                                                                                                                                                                                                                       
┌─────────┴─────────┐                                                                                                                                                                                                                  
│     PROJECTION    │                                                                                                                                                                                                                  
│   ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                                  
│         #0        │                                                                                                                                                                                                                  
│         #1        │                                                                                                                                                                                                                  
│__internal_decompre│                                                                                                                                                                                                                  
│   ss_string(#2)   │                                                                                                                                                                                                                  
│__internal_decompre│                                                                                                                                                                                                                  
│ss_integral_bigint(│                                                                                                                                                                                                                  
│       #3, 1)      │                                                                                                                                                                                                                  
│__internal_decompre│                                                                                                                                                                                                                  
│   ss_string(#4)   │                                                                                                                                                                                                                  
│         #5        │                                                                                                                                                                                                                  
│__internal_decompre│                                                                                                                                                                                                                  
│   ss_string(#6)   │                                                                                                                                                                                                                  
│         #7        │                                                                                                                                                                                                                  
└─────────┬─────────┘                                                                                                                                                                                                                                       
┌─────────┴─────────┐                                                                                                                                                                                                                  
│      ORDER_BY     │                                                                                                                                                                                                                  
│   ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                                  
│      ORDERS:      │                                                                                                                                                                                                                  
│ supplier.s_acctbal│                                                                                                                                                                                                                  
│        DESC       │                                                                                                                                                                                                                  
│ nation.n_name ASC │                                                                                                                                                                                                                  
│supplier.s_name ASC│                                                                                                                                                                                                                  
│ part.p_partkey ASC│                                                                                                                                                                                                                  
└─────────┬─────────┘                                                                                                                                                                                                                                       
┌─────────┴─────────┐                                                                                                                                                                                                                  
│     PROJECTION    │                                                                                                                                                                                                                  
│   ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                                  
│         #0        │                                                                                                                                                                                                                  
│         #1        │                                                                                                                                                                                                                  
│__internal_compress│                                                                                                                                                                                                                  
│_string_hugeint(#2)│                                                                                                                                                                                                                  
│__internal_compress│                                                                                                                                                                                                                  
│_integral_uinteger(│                                                                                                                                                                                                                  
│       #3, 1)      │                                                                                                                                                                                                                  
│__internal_compress│                                                                                                                                                                                                                  
│_string_hugeint(#4)│                                                                                                                                                                                                                  
│         #5        │                                                                                                                                                                                                                  
│__internal_compress│                                                                                                                                                                                                                  
│_string_hugeint(#6)│                                                                                                                                                                                                                  
│         #7        │                                                                                                                                                                                                                  
└─────────┬─────────┘                                                                                                                                                                                                                                       
┌─────────┴─────────┐                                                                                                                                                                                                                  
│     PROJECTION    │                                                                                                                                                                                                                  
│   ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                                  
│     s_acctbal     │                                                                                                                                                                                                                  
│       s_name      │                                                                                                                                                                                                                  
│       n_name      │                                                                                                                                                                                                                  
│     p_partkey     │                                                                                                                                                                                                                  
│       p_mfgr      │                                                                                                                                                                                                                  
│     s_address     │                                                                                                                                                                                                                  
│      s_phone      │                                                                                                                                                                                                                  
│     s_comment     │                                                                                                                                                                                                                  
└─────────┬─────────┘                                                                                                                                                                                                                                       
┌─────────┴─────────┐                                                                                                                                                                                                                  
│     PROJECTION    │                                                                                                                                                                                                                  
│   ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                                  
│         #0        │                                                                                                                                                                                                                  
│         #2        │                                                                                                                                                                                                                  
│         #4        │                                                                                                                                                                                                                  
│         #6        │                                                                                                                                                                                                                  
│         #8        │                                                                                                                                                                                                                  
│         #9        │                                                                                                                                                                                                                  
│        #10        │                                                                                                                                                                                                                  
│        #11        │                                                                                                                                                                                                                  
│        #12        │                                                                                                                                                                                                                  
│        #13        │                                                                                                                                                                                                                  
└─────────┬─────────┘                                                                                                                                                                                                                                       
┌─────────┴─────────┐                                                                                                                                                                                                                  
│       FILTER      │                                                                                                                                                                                                                  
│   ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                                  
│  (ps_supplycost = │                                                                                                                                                                                                                  
│      SUBQUERY)    │                                                                                                                                                                                                                  
│   ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                                  
│     EC: 400000    │                                                                                                                                                                                                                  
└─────────┬─────────┘                                                                                                                                                                                                                                       
┌─────────┴─────────┐                                                                                                                                                                                                                  
│  RIGHT_DELIM_JOIN │                                                                                                                                                                                                                  
│   ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                                  
│       RIGHT       │                                                                                                                                                                                                                  
│  p_partkey IS NOT │                                                                                                                                                                                                                  
│    DISTINCT FROM  ├──────────────────────────────────────────────────────────────────────────────────────────────┐                                                                                                                   
│      p_partkey    │                                                                                              │                                                                                                                   
│   ─ ─ ─ ─ ─ ─ ─   │                                                                                              │                                                                                                                   
│     EC: 400000    │                                                                                              │                                                                                                                   
└─────────┬─────────┘                                                                                              │                                                                                                                                        
┌─────────┴─────────┐                                                                                    ┌─────────┴─────────┐                                                                                                         
│     HASH_JOIN     │                                                                                    │     HASH_JOIN     │                                                                                                         
│   ─ ─ ─ ─ ─ ─ ─   │                                                                                    │   ─ ─ ─ ─ ─ ─ ─   │                                                                                                         
│       INNER       │                                                                                    │       RIGHT       │                                                                                                         
│    ps_suppkey =   │                                                                                    │  p_partkey IS NOT │                                                                                                         
│      s_suppkey    │                                                                                    │    DISTINCT FROM  │                                                                                                         
│   ─ ─ ─ ─ ─ ─ ─   ├───────────────────────────────┐                                                    │      p_partkey    ├──────────────────────────────────────────────────────────────────────────────────────────────┐          
│    Build Min: 1   │                               │                                                    │   ─ ─ ─ ─ ─ ─ ─   │                                                                                              │          
│  Build Max: 10000 │                               │                                                    │     EC: 400000    │                                                                                              │          
│   ─ ─ ─ ─ ─ ─ ─   │                               │                                                    │                   │                                                                                              │          
│      EC: 587      │                               │                                                    │                   │                                                                                              │          
└─────────┬─────────┘                               │                                                    └─────────┬─────────┘                                                                                              │                               
┌─────────┴─────────┐                     ┌─────────┴─────────┐                                          ┌─────────┴─────────┐                                                                                    ┌─────────┴─────────┐
│     HASH_JOIN     │                     │     HASH_JOIN     │                                          │     PROJECTION    │                                                                                    │     DUMMY_SCAN    │
│   ─ ─ ─ ─ ─ ─ ─   │                     │   ─ ─ ─ ─ ─ ─ ─   │                                          │   ─ ─ ─ ─ ─ ─ ─   │                                                                                    │                   │
│       INNER       │                     │       INNER       │                                          │ min(ps_supplycost)│                                                                                    │                   │
│    ps_partkey =   │                     │   s_nationkey =   │                                          │     p_partkey     │                                                                                    │                   │
│      p_partkey    │                     │     n_nationkey   │                                          │                   │                                                                                    │                   │
│   ─ ─ ─ ─ ─ ─ ─   ├──────────┐          │   ─ ─ ─ ─ ─ ─ ─   ├──────────┐                               │                   │                                                                                    │                   │
│    Build Min: 1   │          │          │    Build Min: 0   │          │                               │                   │                                                                                    │                   │
│ Build Max: 200000 │          │          │   Build Max: 24   │          │                               │                   │                                                                                    │                   │
│   ─ ─ ─ ─ ─ ─ ─   │          │          │   ─ ─ ─ ─ ─ ─ ─   │          │                               │                   │                                                                                    │                   │
│      EC: 3377     │          │          │      EC: 2000     │          │                               │                   │                                                                                    │                   │
└─────────┬─────────┘          │          └─────────┬─────────┘          │                               └─────────┬─────────┘                                                                                    └───────────────────┘                     
┌─────────┴─────────┐┌─────────┴─────────┐┌─────────┴─────────┐┌─────────┴─────────┐                     ┌─────────┴─────────┐                                                                                                         
│     SEQ_SCAN      ││       FILTER      ││     SEQ_SCAN      ││     HASH_JOIN     │                     │     PROJECTION    │                                                                                                         
│   ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─   │                     │   ─ ─ ─ ─ ─ ─ ─   │                                                                                                         
│      partsupp     ││  suffix(p_type,   ││      supplier     ││       INNER       │                     │__internal_decompre│                                                                                                         
│   ─ ─ ─ ─ ─ ─ ─   ││      'BRASS')     ││   ─ ─ ─ ─ ─ ─ ─   ││   n_regionkey =   │                     │ss_integral_bigint(│                                                                                                         
│     ps_partkey    ││   ─ ─ ─ ─ ─ ─ ─   ││     s_suppkey     ││     r_regionkey   │                     │       #0, 1)      │                                                                                                         
│     ps_suppkey    ││      EC: 800      ││    s_nationkey    ││   ─ ─ ─ ─ ─ ─ ─   │                     │         #1        │                                                                                                         
│   ps_supplycost   ││                   ││     s_acctbal     ││    Build Min: 0   ├──────────┐          │                   │                                                                                                         
│   ─ ─ ─ ─ ─ ─ ─   ││                   ││       s_name      ││    Build Max: 4   │          │          │                   │                                                                                                         
│     EC: 800000    ││                   ││     s_address     ││   ─ ─ ─ ─ ─ ─ ─   │          │          │                   │                                                                                                         
│                   ││                   ││      s_phone      ││       EC: 5       │          │          │                   │                                                                                                         
│                   ││                   ││     s_comment     ││                   │          │          │                   │                                                                                                         
│                   ││                   ││   ─ ─ ─ ─ ─ ─ ─   ││                   │          │          │                   │                                                                                                         
│                   ││                   ││     EC: 10000     ││                   │          │          │                   │                                                                                                         
└───────────────────┘└─────────┬─────────┘└───────────────────┘└─────────┬─────────┘          │          └─────────┬─────────┘                                                                                                                              
                     ┌─────────┴─────────┐                     ┌─────────┴─────────┐┌─────────┴─────────┐┌─────────┴─────────┐                                                                                                         
                     │     SEQ_SCAN      │                     │     SEQ_SCAN      ││     SEQ_SCAN      ││   HASH_GROUP_BY   │                                                                                                         
                     │   ─ ─ ─ ─ ─ ─ ─   │                     │   ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─   │                                                                                                         
                     │        part       │                     │       nation      ││       region      ││         #0        │                                                                                                         
                     │   ─ ─ ─ ─ ─ ─ ─   │                     │   ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─   ││      min(#1)      │                                                                                                         
                     │     p_partkey     │                     │    n_nationkey    ││    r_regionkey    ││                   │                                                                                                         
                     │       p_type      │                     │    n_regionkey    ││   ─ ─ ─ ─ ─ ─ ─   ││                   │                                                                                                         
                     │       p_mfgr      │                     │       n_name      ││  Filters: r_name= ││                   │                                                                                                         
                     │   ─ ─ ─ ─ ─ ─ ─   │                     │   ─ ─ ─ ─ ─ ─ ─   ││'EUROPE' AND r...  ││                   │                                                                                                         
                     │ Filters: p_size=15│                     │       EC: 25      ││      NOT NULL     ││                   │                                                                                                         
                     │  AND p_size IS NOT│                     │                   ││   ─ ─ ─ ─ ─ ─ ─   ││                   │                                                                                                         
                     │        NULL       │                     │                   ││       EC: 1       ││                   │                                                                                                         
                     │   ─ ─ ─ ─ ─ ─ ─   │                     │                   ││                   ││                   │                                                                                                         
                     │      EC: 800      │                     │                   ││                   ││                   │                                                                                                         
                     └───────────────────┘                     └───────────────────┘└───────────────────┘└─────────┬─────────┘                                                                                                                              
                                                                                                         ┌─────────┴─────────┐                                                                                                         
                                                                                                         │     PROJECTION    │                                                                                                         
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   │                                                                                                         
                                                                                                         │     p_partkey     │                                                                                                         
                                                                                                         │   ps_supplycost   │                                                                                                         
                                                                                                         └─────────┬─────────┘                                                                                                                              
                                                                                                         ┌─────────┴─────────┐                                                                                                         
                                                                                                         │     PROJECTION    │                                                                                                         
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   │                                                                                                         
                                                                                                         │__internal_compress│                                                                                                         
                                                                                                         │_integral_uinteger(│                                                                                                         
                                                                                                         │       #0, 1)      │                                                                                                         
                                                                                                         │__internal_compress│                                                                                                         
                                                                                                         │_integral_usmallint│                                                                                                         
                                                                                                         │      (#1, 1)      │                                                                                                         
                                                                                                         │         #2        │                                                                                                         
                                                                                                         │__internal_compress│                                                                                                         
                                                                                                         │_integral_usmallint│                                                                                                         
                                                                                                         │      (#3, 1)      │                                                                                                         
                                                                                                         │__internal_compress│                                                                                                         
                                                                                                         │_integral_utinyint(│                                                                                                         
                                                                                                         │       #4, 0)      │                                                                                                         
                                                                                                         │__internal_compress│                                                                                                         
                                                                                                         │_integral_utinyint(│                                                                                                         
                                                                                                         │       #5, 0)      │                                                                                                         
                                                                                                         │__internal_compress│                                                                                                         
                                                                                                         │_integral_utinyint(│                                                                                                         
                                                                                                         │       #6, 0)      │                                                                                                         
                                                                                                         │__internal_compress│                                                                                                         
                                                                                                         │_integral_utinyint(│                                                                                                         
                                                                                                         │       #7, 0)      │                                                                                                         
                                                                                                         │         #8        │                                                                                                         
                                                                                                         └─────────┬─────────┘                                                                                                                              
                                                                                                         ┌─────────┴─────────┐                                                                                                         
                                                                                                         │     HASH_JOIN     │                                                                                                         
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   │                                                                                                         
                                                                                                         │       INNER       │                                                                                                         
                                                                                                         │    ps_partkey =   ├─────────────────────────────────────────────────────────────────────────┐                               
                                                                                                         │      p_partkey    │                                                                         │                               
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   │                                                                         │                               
                                                                                                         │     EC: 800000    │                                                                         │                               
                                                                                                         └─────────┬─────────┘                                                                         │                                                    
                                                                                                         ┌─────────┴─────────┐                                                               ┌─────────┴─────────┐                     
                                                                                                         │     HASH_JOIN     │                                                               │     DELIM_SCAN    │                     
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   │                                                               │                   │                     
                                                                                                         │       INNER       │                                                               │                   │                     
                                                                                                         │   n_regionkey =   │                                                               │                   │                     
                                                                                                         │     r_regionkey   │                                                               │                   │                     
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   ├────────────────────────────────────────────────────┐          │                   │                     
                                                                                                         │    Build Min: 0   │                                                    │          │                   │                     
                                                                                                         │    Build Max: 4   │                                                    │          │                   │                     
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   │                                                    │          │                   │                     
                                                                                                         │     EC: 800000    │                                                    │          │                   │                     
                                                                                                         └─────────┬─────────┘                                                    │          └───────────────────┘                                          
                                                                                                         ┌─────────┴─────────┐                                          ┌─────────┴─────────┐                                          
                                                                                                         │     HASH_JOIN     │                                          │     SEQ_SCAN      │                                          
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   │                                          │   ─ ─ ─ ─ ─ ─ ─   │                                          
                                                                                                         │       INNER       │                                          │       region      │                                          
                                                                                                         │   s_nationkey =   │                                          │   ─ ─ ─ ─ ─ ─ ─   │                                          
                                                                                                         │     n_nationkey   │                                          │    r_regionkey    │                                          
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   ├───────────────────────────────┐          │   ─ ─ ─ ─ ─ ─ ─   │                                          
                                                                                                         │    Build Min: 0   │                               │          │  Filters: r_name= │                                          
                                                                                                         │   Build Max: 24   │                               │          │'EUROPE' AND r...  │                                          
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   │                               │          │      NOT NULL     │                                          
                                                                                                         │     EC: 800000    │                               │          │   ─ ─ ─ ─ ─ ─ ─   │                                          
                                                                                                         │                   │                               │          │       EC: 1       │                                          
                                                                                                         └─────────┬─────────┘                               │          └───────────────────┘                                                               
                                                                                                         ┌─────────┴─────────┐                     ┌─────────┴─────────┐                                                               
                                                                                                         │     HASH_JOIN     │                     │     SEQ_SCAN      │                                                               
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   │                     │   ─ ─ ─ ─ ─ ─ ─   │                                                               
                                                                                                         │       INNER       │                     │       nation      │                                                               
                                                                                                         │    ps_suppkey =   │                     │   ─ ─ ─ ─ ─ ─ ─   │                                                               
                                                                                                         │      s_suppkey    │                     │    n_nationkey    │                                                               
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   ├──────────┐          │    n_regionkey    │                                                               
                                                                                                         │    Build Min: 1   │          │          │   ─ ─ ─ ─ ─ ─ ─   │                                                               
                                                                                                         │  Build Max: 10000 │          │          │       EC: 25      │                                                               
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   │          │          │                   │                                                               
                                                                                                         │     EC: 800000    │          │          │                   │                                                               
                                                                                                         └─────────┬─────────┘          │          └───────────────────┘                                                                                    
                                                                                                         ┌─────────┴─────────┐┌─────────┴─────────┐                                                                                    
                                                                                                         │     SEQ_SCAN      ││     SEQ_SCAN      │                                                                                    
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─   │                                                                                    
                                                                                                         │      partsupp     ││      supplier     │                                                                                    
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─   │                                                                                    
                                                                                                         │     ps_partkey    ││     s_suppkey     │                                                                                    
                                                                                                         │     ps_suppkey    ││    s_nationkey    │                                                                                    
                                                                                                         │   ps_supplycost   ││   ─ ─ ─ ─ ─ ─ ─   │                                                                                    
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   ││     EC: 10000     │                                                                                    
                                                                                                         │     EC: 800000    ││                   │                                                                                    
                                                                                                         └───────────────────┘└───────────────────┘                                                                                                         

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

Run:  None SELECT s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment FROM part, supplier, partsupp, nation, region WHERE p_partkey = ps_partkey AND s_suppkey = ps_suppkey AND p_size = 15 AND p_type LIKE '%BRASS' AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'EUROPE' AND ps_supplycost = ( SELECT min(ps_supplycost) FROM partsupp, supplier, nation, region WHERE p_partkey = ps_partkey AND s_suppkey = ps_suppkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'EUROPE' ) ORDER BY s_acctbal DESC, n_name, s_name, p_partkey LIMIT 100;
Avg Time in sec:  0.07510117907077074  output size:  100
    s_acctbal  ...                                          s_comment
0     9938.53  ...                      l, ironic instructions cajole
1     9937.84  ...  es. furiously silent deposits among the deposi...
2     9936.22  ...  ar, regular requests nag blithely special acco...
3     9923.77  ...  s sleep according to the quick requests. caref...
4     9871.22  ...  against the slyly daring requests. unusual acc...
..        ...  ...                                                ...
95    7887.08  ...   the regular ideas. furiously bold deposits bo...
96    7871.50  ...  ording to the furious theodolites cajole caref...
97    7852.45  ...  egular, regular ideas. requests are carefully....
98    7850.66  ...                   ccounts. special, final deposits
99    7843.52  ...  sits. blithely regular requests above the pend...

[100 rows x 8 columns]
{'name': 'Query', 'result': 0.070097, 'timing': 0.070097, 'cardinality': 0, 'extra-info': "SELECT s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment FROM part, supplier, partsupp, nation, region WHERE p_partkey = ps_partkey AND s_suppkey = ps_suppkey AND p_size = 15 AND p_type LIKE '%BRASS' AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'EUROPE' AND ps_supplycost = ( SELECT min(ps_supplycost) FROM partsupp, supplier, nation, region WHERE p_partkey = ps_partkey AND s_suppkey = ps_suppkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'EUROPE' ) ORDER BY s_acctbal DESC, n_name, s_name, p_partkey LIMIT 100;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 4.4e-05, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'STREAMING_LIMIT', 'timing': 2e-06, 'cardinality': 100, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 3.1e-05, 'cardinality': 460, 'extra_info': '#0\n#1\n__internal_decompress_string(#2)\n__internal_decompress_integral_bigint(#3, 1)\n__internal_decompress_string(#4)\n#5\n__internal_decompress_string(#6)\n#7\n', 'children': [{'name': 'ORDER_BY', 'timing': 0.000246, 'cardinality': 460, 'extra_info': 'ORDERS:\nsupplier.s_acctbal DESC\nnation.n_name ASC\nsupplier.s_name ASC\npart.p_partkey ASC', 'children': [{'name': 'PROJECTION', 'timing': 3.9e-05, 'cardinality': 460, 'extra_info': '#0\n#1\n__internal_compress_string_hugeint(#2)\n__internal_compress_integral_uinteger(#3, 1)\n__internal_compress_string_hugeint(#4)\n#5\n__internal_compress_string_hugeint(#6)\n#7\n', 'children': [{'name': 'PROJECTION', 'timing': 2e-06, 'cardinality': 460, 'extra_info': 's_acctbal\ns_name\nn_name\np_partkey\np_mfgr\ns_address\ns_phone\ns_comment\n', 'children': [{'name': 'PROJECTION', 'timing': 3e-06, 'cardinality': 460, 'extra_info': '#0\n#2\n#4\n#6\n#8\n#9\n#10\n#11\n#12\n#13\n', 'children': [{'name': 'FILTER', 'timing': 8.5e-05, 'cardinality': 460, 'extra_info': '(ps_supplycost = SUBQUERY)\n[INFOSEPARATOR]\nEC: 400000', 'children': [{'name': 'RIGHT_DELIM_JOIN', 'timing': 0.001251, 'cardinality': 0, 'extra_info': 'RIGHT\np_partkey IS NOT DISTINCT FROM p_partkey\n\n[INFOSEPARATOR]\nEC: 400000\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.000809, 'cardinality': 642, 'extra_info': 'INNER\nps_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 587\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.005245, 'cardinality': 2988, 'extra_info': 'INNER\nps_partkey = p_partkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 3377\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.001846, 'cardinality': 800000, 'extra_info': 'partsupp\n[INFOSEPARATOR]\nps_partkey\nps_suppkey\nps_supplycost\n[INFOSEPARATOR]\nEC: 800000', 'children': []}, {'name': 'FILTER', 'timing': 0.000661, 'cardinality': 747, 'extra_info': "suffix(p_type, 'BRASS')\n[INFOSEPARATOR]\nEC: 800", 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.007485, 'cardinality': 3907, 'extra_info': 'part\n[INFOSEPARATOR]\np_partkey\np_type\np_mfgr\n[INFOSEPARATOR]\nFilters: p_size=15 AND p_size IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 800', 'children': []}]}]}, {'name': 'HASH_JOIN', 'timing': 0.00017, 'cardinality': 1987, 'extra_info': 'INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 2000\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.000783, 'cardinality': 10000, 'extra_info': 'supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\ns_acctbal\ns_name\ns_address\ns_phone\ns_comment\n[INFOSEPARATOR]\nEC: 10000', 'children': []}, {'name': 'HASH_JOIN', 'timing': 7.5e-05, 'cardinality': 5, 'extra_info': 'INNER\nn_regionkey = r_regionkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 4\n\n[INFOSEPARATOR]\nEC: 5\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 1.4e-05, 'cardinality': 25, 'extra_info': 'nation\n[INFOSEPARATOR]\nn_nationkey\nn_regionkey\nn_name\n[INFOSEPARATOR]\nEC: 25', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 3.1e-05, 'cardinality': 1, 'extra_info': "region\n[INFOSEPARATOR]\nr_regionkey\n[INFOSEPARATOR]\nFilters: r_name='EUROPE' AND r_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1", 'children': []}]}]}]}, {'name': 'HASH_JOIN', 'timing': 0.000222, 'cardinality': 642, 'extra_info': 'RIGHT\np_partkey IS NOT DISTINCT FROM p_partkey\n\n[INFOSEPARATOR]\nEC: 400000\n', 'children': [{'name': 'PROJECTION', 'timing': 0.0, 'cardinality': 460, 'extra_info': 'min(ps_supplycost)\np_partkey\n', 'children': [{'name': 'PROJECTION', 'timing': 7e-06, 'cardinality': 460, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n#1\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.000776, 'cardinality': 460, 'extra_info': '#0\nmin(#1)', 'children': [{'name': 'PROJECTION', 'timing': 1e-06, 'cardinality': 642, 'extra_info': 'p_partkey\nps_supplycost\n', 'children': [{'name': 'PROJECTION', 'timing': 2.7e-05, 'cardinality': 642, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n__internal_compress_integral_usmallint(#1, 1)\n#2\n__internal_compress_integral_usmallint(#3, 1)\n__internal_compress_integral_utinyint(#4, 0)\n__internal_compress_integral_utinyint(#5, 0)\n__internal_compress_integral_utinyint(#6, 0)\n__internal_compress_integral_utinyint(#7, 0)\n#8\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.007536, 'cardinality': 642, 'extra_info': 'INNER\nps_partkey = p_partkey\n\n[INFOSEPARATOR]\nEC: 800000\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.006862, 'cardinality': 158960, 'extra_info': 'INNER\nn_regionkey = r_regionkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 4\n\n[INFOSEPARATOR]\nEC: 800000\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.009096, 'cardinality': 800000, 'extra_info': 'INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 800000\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.01265, 'cardinality': 800000, 'extra_info': 'INNER\nps_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 800000\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.001564, 'cardinality': 800000, 'extra_info': 'partsupp\n[INFOSEPARATOR]\nps_partkey\nps_suppkey\nps_supplycost\n[INFOSEPARATOR]\nEC: 800000', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 4e-05, 'cardinality': 10000, 'extra_info': 'supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\n[INFOSEPARATOR]\nEC: 10000', 'children': []}]}, {'name': 'SEQ_SCAN ', 'timing': 8e-06, 'cardinality': 25, 'extra_info': 'nation\n[INFOSEPARATOR]\nn_nationkey\nn_regionkey\n[INFOSEPARATOR]\nEC: 25', 'children': []}]}, {'name': 'SEQ_SCAN ', 'timing': 1.6e-05, 'cardinality': 1, 'extra_info': "region\n[INFOSEPARATOR]\nr_regionkey\n[INFOSEPARATOR]\nFilters: r_name='EUROPE' AND r_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1", 'children': []}]}, {'name': 'DELIM_SCAN', 'timing': 0.0, 'cardinality': 0, 'extra_info': '', 'children': []}]}]}]}]}]}]}, {'name': 'DUMMY_SCAN', 'timing': 0.0, 'cardinality': 0, 'extra_info': '', 'children': []}]}, {'name': 'HASH_GROUP_BY', 'timing': 1.9e-05, 'cardinality': 460, 'extra_info': '#0', 'children': []}]}]}]}]}]}]}]}]}]}]}
X {'RESULT_COLLECTOR0': 4.4e-05, 'STREAMING_LIMIT1': 2e-06, 'PROJECTION2': 3.1e-05, 'ORDER_BY3': 0.000246, 'PROJECTION4': 3.9e-05, 'PROJECTION5': 2e-06, 'PROJECTION6': 3e-06, 'FILTER7': 8.5e-05, 'RIGHT_DELIM_JOIN8': 0.001251, 'HASH_JOIN9': 0.000809, 'HASH_JOIN10': 0.005245, 'SEQ_SCAN 11': 0.001846, 'FILTER12': 0.000661, 'SEQ_SCAN 13': 0.007485, 'HASH_JOIN14': 0.00017, 'SEQ_SCAN 15': 0.000783, 'HASH_JOIN16': 7.5e-05, 'SEQ_SCAN 17': 1.4e-05, 'SEQ_SCAN 18': 3.1e-05, 'HASH_JOIN19': 0.000222, 'PROJECTION20': 0.0, 'PROJECTION21': 7e-06, 'HASH_GROUP_BY22': 0.000776, 'PROJECTION23': 1e-06, 'PROJECTION24': 2.7e-05, 'HASH_JOIN25': 0.007536, 'HASH_JOIN26': 0.006862, 'HASH_JOIN27': 0.009096, 'HASH_JOIN28': 0.01265, 'SEQ_SCAN 29': 0.001564, 'SEQ_SCAN 30': 4e-05, 'SEQ_SCAN 31': 8e-06, 'SEQ_SCAN 32': 1.6e-05, 'DELIM_SCAN33': 0.0, 'DUMMY_SCAN34': 0.0, 'HASH_GROUP_BY35': 1.9e-05}
Physical operator output, input_left, input_right: 
**** output size:  100
LINEAGE_5_FILTER_2
LINEAGE_5_FILTER_28
LINEAGE_5_HASH_GROUP_BY_21
LINEAGE_5_HASH_GROUP_BY_26
LINEAGE_5_HASH_JOIN_12
LINEAGE_5_HASH_JOIN_14
LINEAGE_5_HASH_JOIN_16
LINEAGE_5_HASH_JOIN_18
LINEAGE_5_HASH_JOIN_25
LINEAGE_5_HASH_JOIN_3
LINEAGE_5_HASH_JOIN_7
LINEAGE_5_HASH_JOIN_8
LINEAGE_5_HASH_JOIN_9
LINEAGE_5_ORDER_BY_32
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_1
LINEAGE_5_SEQ_SCAN_10
LINEAGE_5_SEQ_SCAN_11
LINEAGE_5_SEQ_SCAN_13
LINEAGE_5_SEQ_SCAN_15
LINEAGE_5_SEQ_SCAN_4
LINEAGE_5_SEQ_SCAN_5
LINEAGE_5_SEQ_SCAN_6
LINEAGE_5_STREAMING_LIMIT_34
SELECT s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment FROM part, supplier, partsupp, nation, region WHERE p_partkey = ps_partkey AND s_suppkey = ps_suppkey AND p_size = 15 AND p_type LIKE '%BRASS' AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'EUROPE' AND ps_supplycost = ( SELECT min(ps_supplycost) FROM partsupp, supplier, nation, region WHERE p_partkey = ps_partkey AND s_suppkey = ps_suppkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'EUROPE' ) ORDER BY s_acctbal DESC, n_name, s_name, p_partkey LIMIT 100;
   query_id  ...                                               plan
0         5  ...  {"name": "STREAMING_LIMIT", "opid": "34", "chi...

[1 rows x 8 columns]
Query info:  query_id                                                            5
query               SELECT s_acctbal, s_name, n_name, p_partkey, p...
size_bytes_max                                                2256074
physical_op_size    [14402, 144, 0, 584, 0, 0, 0, 456, 3808, 18632...
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "STREAMING_LIMIT", "opid": "34", "chi...
Name: 0, dtype: object
physical op size is:
{"name": "STREAMING_LIMIT", "opid": "34", "children": [{"name": "PROJECTION", "opid": "33", "children": [{"name": "ORDER_BY", "opid": "32", "children": [{"name": "PROJECTION", "opid": "31", "children": [{"name": "PROJECTION", "opid": "30", "children": [{"name": "PROJECTION", "opid": "29", "children": [{"name": "FILTER", "opid": "28", "children": [{"name": "RIGHT_DELIM_JOIN", "opid": "27", "children": [{"name": "HASH_GROUP_BY", "opid": "26", "children": [],"table": "","extra": "#0"},{"name": "HASH_JOIN", "opid": "25", "children": [{"name": "PROJECTION", "opid": "23", "children": [{"name": "PROJECTION", "opid": "22", "children": [{"name": "HASH_GROUP_BY", "opid": "21", "children": [{"name": "PROJECTION", "opid": "20", "children": [{"name": "PROJECTION", "opid": "19", "children": [{"name": "HASH_JOIN", "opid": "18", "children": [{"name": "HASH_JOIN", "opid": "16", "children": [{"name": "HASH_JOIN", "opid": "14", "children": [{"name": "HASH_JOIN", "opid": "12", "children": [{"name": "SEQ_SCAN ", "opid": "10", "children": [],"table": "partsupp","extra": "partsupp\n[INFOSEPARATOR]\nps_partkey\nps_suppkey\nps_supplycost\n[INFOSEPARATOR]\nEC: 800000"},{"name": "SEQ_SCAN ", "opid": "11", "children": [],"table": "supplier","extra": "supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\n[INFOSEPARATOR]\nEC: 10000"}],"table": "","extra": "INNER\nps_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 800000\n"},{"name": "SEQ_SCAN ", "opid": "13", "children": [],"table": "nation","extra": "nation\n[INFOSEPARATOR]\nn_nationkey\nn_regionkey\n[INFOSEPARATOR]\nEC: 25"}],"table": "","extra": "INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 800000\n"},{"name": "SEQ_SCAN ", "opid": "15", "children": [],"table": "region","extra": "region\n[INFOSEPARATOR]\nr_regionkey\n[INFOSEPARATOR]\nFilters: r_name='EUROPE' AND r_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1"}],"table": "","extra": "INNER\nn_regionkey = r_regionkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 4\n\n[INFOSEPARATOR]\nEC: 800000\n"},{"name": "DELIM_SCAN", "opid": "17", "children": [],"table": "","extra": ""}],"table": "","extra": "INNER\nps_partkey = p_partkey\n\n[INFOSEPARATOR]\nEC: 800000\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n__internal_compress_integral_usmallint(#1, 1)\n#2\n__internal_compress_integral_usmallint(#3, 1)\n__internal_compress_integral_utinyint(#4, 0)\n__internal_compress_integral_utinyint(#5, 0)\n__internal_compress_integral_utinyint(#6, 0)\n__internal_compress_integral_utinyint(#7, 0)\n#8\n"}],"table": "","extra": "p_partkey\nps_supplycost\n"}],"table": "","extra": "#0\nmin(#1)"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n#1\n"}],"table": "","extra": "min(ps_supplycost)\np_partkey\n"},{"name": "DUMMY_SCAN", "opid": "24", "children": [],"table": "","extra": ""}],"table": "","extra": "RIGHT\np_partkey IS NOT DISTINCT FROM p_partkey\n\n[INFOSEPARATOR]\nEC: 400000\n"},{"name": "HASH_JOIN", "opid": "9", "children": [{"name": "HASH_JOIN", "opid": "3", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "partsupp","extra": "partsupp\n[INFOSEPARATOR]\nps_partkey\nps_suppkey\nps_supplycost\n[INFOSEPARATOR]\nEC: 800000"},{"name": "FILTER", "opid": "2", "children": [{"name": "SEQ_SCAN ", "opid": "1", "children": [],"table": "part","extra": "part\n[INFOSEPARATOR]\np_partkey\np_type\np_mfgr\n[INFOSEPARATOR]\nFilters: p_size=15 AND p_size IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 800"}],"table": "","extra": "suffix(p_type, 'BRASS')\n[INFOSEPARATOR]\nEC: 800"}],"table": "","extra": "INNER\nps_partkey = p_partkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 3377\n"},{"name": "HASH_JOIN", "opid": "8", "children": [{"name": "SEQ_SCAN ", "opid": "4", "children": [],"table": "supplier","extra": "supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\ns_acctbal\ns_name\ns_address\ns_phone\ns_comment\n[INFOSEPARATOR]\nEC: 10000"},{"name": "HASH_JOIN", "opid": "7", "children": [{"name": "SEQ_SCAN ", "opid": "5", "children": [],"table": "nation","extra": "nation\n[INFOSEPARATOR]\nn_nationkey\nn_regionkey\nn_name\n[INFOSEPARATOR]\nEC: 25"},{"name": "SEQ_SCAN ", "opid": "6", "children": [],"table": "region","extra": "region\n[INFOSEPARATOR]\nr_regionkey\n[INFOSEPARATOR]\nFilters: r_name='EUROPE' AND r_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1"}],"table": "","extra": "INNER\nn_regionkey = r_regionkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 4\n\n[INFOSEPARATOR]\nEC: 5\n"}],"table": "","extra": "INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 2000\n"}],"table": "","extra": "INNER\nps_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 587\n"}],"table": "","extra": "RIGHT\np_partkey IS NOT DISTINCT FROM p_partkey\n\n[INFOSEPARATOR]\nEC: 400000\n"}],"table": "","extra": "(ps_supplycost = SUBQUERY)\n[INFOSEPARATOR]\nEC: 400000"}],"table": "","extra": "#0\n#2\n#4\n#6\n#8\n#9\n#10\n#11\n#12\n#13\n"}],"table": "","extra": "s_acctbal\ns_name\nn_name\np_partkey\np_mfgr\ns_address\ns_phone\ns_comment\n"}],"table": "","extra": "#0\n#1\n__internal_compress_string_hugeint(#2)\n__internal_compress_integral_uinteger(#3, 1)\n__internal_compress_string_hugeint(#4)\n#5\n__internal_compress_string_hugeint(#6)\n#7\n"}],"table": "","extra": "ORDERS:\nsupplier.s_acctbal DESC\nnation.n_name ASC\nsupplier.s_name ASC\npart.p_partkey ASC"}],"table": "","extra": "#0\n#1\n__internal_decompress_string(#2)\n__internal_decompress_integral_bigint(#3, 1)\n__internal_decompress_string(#4)\n#5\n__internal_decompress_string(#6)\n#7\n"}],"table": "","extra": ""}
Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                                                          
│      STREAMING_LIMIT      │                                                          
└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          
│         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│__internal_decompress_integ│                                                          
│     ral_bigint(#0, 1)     │                                                          
│             #1            │                                                          
│             #2            │                                                          
│__internal_decompress_integ│                                                          
│     ral_integer(#3, 0)    │                                                          
└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          
│          ORDER_BY         │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│          ORDERS:          │                                                          
│       sum((lineitem       │                                                          
│.l_extendedprice * (1 ...  │                                                          
│    .l_discount))) DESC    │                                                          
│   orders.o_orderdate ASC  │                                                          
└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          
│         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│__internal_compress_integra│                                                          
│     l_uinteger(#0, 1)     │                                                          
│             #1            │                                                          
│             #2            │                                                          
│__internal_compress_integra│                                                          
│     l_utinyint(#3, 0)     │                                                          
└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          
│         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│         l_orderkey        │                                                          
│          revenue          │                                                          
│        o_orderdate        │                                                          
│       o_shippriority      │                                                          
└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          
│         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│__internal_decompress_integ│                                                          
│     ral_bigint(#0, 1)     │                                                          
│             #1            │                                                          
│__internal_decompress_integ│                                                          
│     ral_integer(#2, 0)    │                                                          
│             #3            │                                                          
└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          
│       HASH_GROUP_BY       │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│             #0            │                                                          
│             #1            │                                                          
│             #2            │                                                          
│          sum(#3)          │                                                          
└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          
│         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│         l_orderkey        │                                                          
│        o_orderdate        │                                                          
│       o_shippriority      │                                                          
│ (l_extendedprice * (1.00 -│                                                          
│        l_discount))       │                                                          
└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          
│         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│__internal_compress_integra│                                                          
│     l_uinteger(#0, 1)     │                                                          
│             #1            │                                                          
│             #2            │                                                          
│__internal_compress_integra│                                                          
│     l_uinteger(#3, 1)     │                                                          
│             #4            │                                                          
│__internal_compress_integra│                                                          
│     l_utinyint(#5, 0)     │                                                          
└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          
│         HASH_JOIN         │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│           INNER           │                                                          
│  l_orderkey = o_orderkey  ├──────────────┐                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                           
│         EC: 28949         │              │                                           
└─────────────┬─────────────┘              │                                                                        
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             
│         SEQ_SCAN          ││         HASH_JOIN         │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│          lineitem         ││           INNER           │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   o_custkey = c_custkey   │                             
│         l_orderkey        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│      l_extendedprice      ││        Build Min: 1       │                             
│         l_discount        ││     Build Max: 149999     ├──────────────┐              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              
│ Filters: l_shipdate>'1995 ││         EC: 36179         │              │              
│-03-15'::DATE AND l_sh...  ││                           │              │              
│         IS NOT NULL       ││                           │              │              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │              │              
│        EC: 1200243        ││                           │              │              
└───────────────────────────┘└─────────────┬─────────────┘              │                                           
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
                             │         SEQ_SCAN          ││           FILTER          │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                             │           orders          ││   (c_custkey <= 149999)   │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                             │         o_custkey         ││         EC: 30000         │
                             │         o_orderkey        ││                           │
                             │        o_orderdate        ││                           │
                             │       o_shippriority      ││                           │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │
                             │ Filters: o_orderdate<'1995││                           │
                             │     -03-15'::DATE AND     ││                           │
                             │   o_orderdate IS NOT NULL ││                           │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │
                             │         EC: 300000        ││                           │
                             └───────────────────────────┘└─────────────┬─────────────┘                             
                                                          ┌─────────────┴─────────────┐
                                                          │         SEQ_SCAN          │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │          customer         │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │         c_custkey         │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │   Filters: c_mktsegment=  │
                                                          │'BUILDING' AND c_mktse...  │
                                                          │          NOT NULL         │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │         EC: 30000         │
                                                          └───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

%%%%%%%%%%%%%%%% Running Query #  3  threads:  1
SELECT l_orderkey, sum(l_extendedprice * (1 - l_discount)) AS revenue, o_orderdate, o_shippriority FROM customer, orders, lineitem WHERE c_mktsegment = 'BUILDING' AND c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate < CAST('1995-03-15' AS date) AND l_shipdate > CAST('1995-03-15' AS date) GROUP BY l_orderkey, o_orderdate, o_shippriority ORDER BY revenue DESC, o_orderdate LIMIT 10;
Run:  None SELECT l_orderkey, sum(l_extendedprice * (1 - l_discount)) AS revenue, o_orderdate, o_shippriority FROM customer, orders, lineitem WHERE c_mktsegment = 'BUILDING' AND c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate < CAST('1995-03-15' AS date) AND l_shipdate > CAST('1995-03-15' AS date) GROUP BY l_orderkey, o_orderdate, o_shippriority ORDER BY revenue DESC, o_orderdate LIMIT 10;
Avg Time in sec:  0.1958004143089056  output size:  10
   l_orderkey      revenue o_orderdate  o_shippriority
0     2456423  406181.0111  1995-03-05               0
1     3459808  405838.6989  1995-03-04               0
2      492164  390324.0610  1995-02-19               0
3     1188320  384537.9359  1995-03-09               0
4     2435712  378673.0558  1995-02-26               0
5     4878020  378376.7952  1995-03-12               0
6     5521732  375153.9215  1995-03-13               0
7     2628192  373133.3094  1995-02-22               0
8      993600  371407.4595  1995-03-05               0
9     2300070  367371.1452  1995-03-13               0
{'name': 'Query', 'result': 0.191931, 'timing': 0.191931, 'cardinality': 0, 'extra-info': "SELECT l_orderkey, sum(l_extendedprice * (1 - l_discount)) AS revenue, o_orderdate, o_shippriority FROM customer, orders, lineitem WHERE c_mktsegment = 'BUILDING' AND c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate < CAST('1995-03-15' AS date) AND l_shipdate > CAST('1995-03-15' AS date) GROUP BY l_orderkey, o_orderdate, o_shippriority ORDER BY revenue DESC, o_orderdate LIMIT 10;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 6e-06, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'STREAMING_LIMIT', 'timing': 3e-06, 'cardinality': 10, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 1e-05, 'cardinality': 4096, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n#1\n#2\n__internal_decompress_integral_integer(#3, 0)\n', 'children': [{'name': 'ORDER_BY', 'timing': 0.000384, 'cardinality': 4096, 'extra_info': 'ORDERS:\nsum((lineitem.l_extendedprice * (1 - lineitem.l_discount))) DESC\norders.o_orderdate ASC', 'children': [{'name': 'PROJECTION', 'timing': 1.5e-05, 'cardinality': 11620, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n#1\n#2\n__internal_compress_integral_utinyint(#3, 0)\n', 'children': [{'name': 'PROJECTION', 'timing': 3e-06, 'cardinality': 11620, 'extra_info': 'l_orderkey\nrevenue\no_orderdate\no_shippriority\n', 'children': [{'name': 'PROJECTION', 'timing': 2.6e-05, 'cardinality': 11620, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n#1\n__internal_decompress_integral_integer(#2, 0)\n#3\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.003098, 'cardinality': 11620, 'extra_info': '#0\n#1\n#2\nsum(#3)', 'children': [{'name': 'PROJECTION', 'timing': 0.000138, 'cardinality': 30519, 'extra_info': 'l_orderkey\no_orderdate\no_shippriority\n(l_extendedprice * (1.00 - l_discount))\n', 'children': [{'name': 'PROJECTION', 'timing': 0.000178, 'cardinality': 30519, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n#1\n#2\n__internal_compress_integral_uinteger(#3, 1)\n#4\n__internal_compress_integral_utinyint(#5, 0)\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.094035, 'cardinality': 30519, 'extra_info': 'INNER\nl_orderkey = o_orderkey\n\n[INFOSEPARATOR]\nEC: 28949\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.045105, 'cardinality': 3241776, 'extra_info': "lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nFilters: l_shipdate>'1995-03-15'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243", 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.013579, 'cardinality': 147126, 'extra_info': 'INNER\no_custkey = c_custkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 149999\n\n[INFOSEPARATOR]\nEC: 36179\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.014693, 'cardinality': 727305, 'extra_info': "orders\n[INFOSEPARATOR]\no_custkey\no_orderkey\no_orderdate\no_shippriority\n[INFOSEPARATOR]\nFilters: o_orderdate<'1995-03-15'::DATE AND o_orderdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 300000", 'children': []}, {'name': 'FILTER', 'timing': 0.00032, 'cardinality': 30142, 'extra_info': '(c_custkey <= 149999)\n[INFOSEPARATOR]\nEC: 30000', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.003536, 'cardinality': 30142, 'extra_info': "customer\n[INFOSEPARATOR]\nc_custkey\n[INFOSEPARATOR]\nFilters: c_mktsegment='BUILDING' AND c_mktsegment IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 30000", 'children': []}]}]}]}]}]}]}]}]}]}]}]}]}]}]}
X {'RESULT_COLLECTOR0': 6e-06, 'STREAMING_LIMIT1': 3e-06, 'PROJECTION2': 1e-05, 'ORDER_BY3': 0.000384, 'PROJECTION4': 1.5e-05, 'PROJECTION5': 3e-06, 'PROJECTION6': 2.6e-05, 'HASH_GROUP_BY7': 0.003098, 'PROJECTION8': 0.000138, 'PROJECTION9': 0.000178, 'HASH_JOIN10': 0.094035, 'SEQ_SCAN 11': 0.045105, 'HASH_JOIN12': 0.013579, 'SEQ_SCAN 13': 0.014693, 'FILTER14': 0.00032, 'SEQ_SCAN 15': 0.003536}
Physical operator output, input_left, input_right: 
**** output size:  10
LINEAGE_5_FILTER_3
LINEAGE_5_HASH_GROUP_BY_8
LINEAGE_5_HASH_JOIN_4
LINEAGE_5_HASH_JOIN_5
LINEAGE_5_ORDER_BY_12
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_1
LINEAGE_5_SEQ_SCAN_2
LINEAGE_5_STREAMING_LIMIT_14
SELECT l_orderkey, sum(l_extendedprice * (1 - l_discount)) AS revenue, o_orderdate, o_shippriority FROM customer, orders, lineitem WHERE c_mktsegment = 'BUILDING' AND c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate < CAST('1995-03-15' AS date) AND l_shipdate > CAST('1995-03-15' AS date) GROUP BY l_orderkey, o_orderdate, o_shippriority ORDER BY revenue DESC, o_orderdate LIMIT 10;
   query_id  ...                                               plan
0         5  ...  {"name": "STREAMING_LIMIT", "opid": "14", "chi...

[1 rows x 8 columns]
Query info:  query_id                                                            5
query               SELECT l_orderkey, sum(l_extendedprice * (1 - ...
size_bytes_max                                                2798521
physical_op_size    [197403, 144, 0, 25093, 0, 0, 0, 30548, 0, 0, ...
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "STREAMING_LIMIT", "opid": "14", "chi...
Name: 0, dtype: object
physical op size is:
{"name": "STREAMING_LIMIT", "opid": "14", "children": [{"name": "PROJECTION", "opid": "13", "children": [{"name": "ORDER_BY", "opid": "12", "children": [{"name": "PROJECTION", "opid": "11", "children": [{"name": "PROJECTION", "opid": "10", "children": [{"name": "PROJECTION", "opid": "9", "children": [{"name": "HASH_GROUP_BY", "opid": "8", "children": [{"name": "PROJECTION", "opid": "7", "children": [{"name": "PROJECTION", "opid": "6", "children": [{"name": "HASH_JOIN", "opid": "5", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nFilters: l_shipdate>'1995-03-15'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243"},{"name": "HASH_JOIN", "opid": "4", "children": [{"name": "SEQ_SCAN ", "opid": "1", "children": [],"table": "orders","extra": "orders\n[INFOSEPARATOR]\no_custkey\no_orderkey\no_orderdate\no_shippriority\n[INFOSEPARATOR]\nFilters: o_orderdate<'1995-03-15'::DATE AND o_orderdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 300000"},{"name": "FILTER", "opid": "3", "children": [{"name": "SEQ_SCAN ", "opid": "2", "children": [],"table": "customer","extra": "customer\n[INFOSEPARATOR]\nc_custkey\n[INFOSEPARATOR]\nFilters: c_mktsegment='BUILDING' AND c_mktsegment IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 30000"}],"table": "","extra": "(c_custkey <= 149999)\n[INFOSEPARATOR]\nEC: 30000"}],"table": "","extra": "INNER\no_custkey = c_custkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 149999\n\n[INFOSEPARATOR]\nEC: 36179\n"}],"table": "","extra": "INNER\nl_orderkey = o_orderkey\n\n[INFOSEPARATOR]\nEC: 28949\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n#1\n#2\n__internal_compress_integral_uinteger(#3, 1)\n#4\n__internal_compress_integral_utinyint(#5, 0)\n"}],"table": "","extra": "l_orderkey\no_orderdate\no_shippriority\n(l_extendedprice * (1.00 - l_discount))\n"}],"table": "","extra": "#0\n#1\n#2\nsum(#3)"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n#1\n__internal_decompress_integral_integer(#2, 0)\n#3\n"}],"table": "","extra": "l_orderkey\nrevenue\no_orderdate\no_shippriority\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n#1\n#2\n__internal_compress_integral_utinyint(#3, 0)\n"}],"table": "","extra": "ORDERS:\nsum((lineitem.l_extendedprice * (1 - lineitem.l_discount))) DESC\norders.o_orderdate ASC"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n#1\n#2\n__internal_decompress_integral_integer(#3, 0)\n"}],"table": "","extra": ""}
Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│__internal_decompress_strin│                                                                                       
│           g(#0)           │                                                                                       
│             #1            │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│          ORDER_BY         │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│          ORDERS:          │                                                                                       
│ orders.o_orderpriority ASC│                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│__internal_compress_string_│                                                                                       
│        hugeint(#0)        │                                                                                       
│             #1            │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│__internal_decompress_strin│                                                                                       
│           g(#0)           │                                                                                       
│             #1            │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│       HASH_GROUP_BY       │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│             #0            │                                                                                       
│        count_star()       │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│      o_orderpriority      │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│__internal_compress_integra│                                                                                       
│     l_uinteger(#0, 1)     │                                                                                       
│__internal_compress_string_│                                                                                       
│        hugeint(#1)        │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│      RIGHT_DELIM_JOIN     │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│         RIGHT_SEMI        │                                                                                       
│ o_orderkey IS NOT DISTINCT├──────────────┐                                                                        
│       FROM o_orderkey     │              │                                                                        
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                                                        
│        EC: 1200243        │              │                                                                        
└─────────────┬─────────────┘              │                                                                                                     
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                          
│         SEQ_SCAN          ││         HASH_JOIN         │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│           orders          ││         RIGHT_SEMI        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││ o_orderkey IS NOT DISTINCT│                                                          
│         o_orderkey        ││       FROM o_orderkey     │                                                          
│      o_orderpriority      ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││        EC: 1200243        ├───────────────────────────────────────────┐              
│Filters: o_orderdate>='1993││                           │                                           │              
│     -07-01'::DATE AND     ││                           │                                           │              
│ o_orderdate<'1993-10-...  ││                           │                                           │              
│   o_orderdate IS NOT NULL ││                           │                                           │              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                           │              
│         EC: 300000        ││                           │                                           │              
└───────────────────────────┘└─────────────┬─────────────┘                                           │                                           
                             ┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐
                             │         PROJECTION        │                             │         DUMMY_SCAN        │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │                           │
                             │         o_orderkey        │                             │                           │
                             └─────────────┬─────────────┘                             └───────────────────────────┘                             
                             ┌─────────────┴─────────────┐                                                          
                             │         HASH_JOIN         │                                                          
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                             │           INNER           │                                                          
                             │  l_orderkey = o_orderkey  ├──────────────┐                                           
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                           
                             │        EC: 1200243        │              │                                           
                             └─────────────┬─────────────┘              │                                                                        
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             
                             │           FILTER          ││         DELIM_SCAN        │                             
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                             
                             │      (l_commitdate <      ││                           │                             
                             │       l_receiptdate)      ││                           │                             
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                             
                             │        EC: 6001215        ││                           │                             
                             └─────────────┬─────────────┘└───────────────────────────┘                                                          
                             ┌─────────────┴─────────────┐                                                          
                             │         SEQ_SCAN          │                                                          
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                             │          lineitem         │                                                          
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                             │         l_orderkey        │                                                          
                             │        l_commitdate       │                                                          
                             │       l_receiptdate       │                                                          
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                             │        EC: 6001215        │                                                          
                             └───────────────────────────┘                                                                                       

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

Clear Lineage

%%%%%%%%%%%%%%%% Running Query #  4  threads:  1
SELECT o_orderpriority, count(*) AS order_count FROM orders WHERE o_orderdate >= CAST('1993-07-01' AS date) AND o_orderdate < CAST('1993-10-01' AS date) AND EXISTS ( SELECT * FROM lineitem WHERE l_orderkey = o_orderkey AND l_commitdate < l_receiptdate) GROUP BY o_orderpriority ORDER BY o_orderpriority;
Run:  None SELECT o_orderpriority, count(*) AS order_count FROM orders WHERE o_orderdate >= CAST('1993-07-01' AS date) AND o_orderdate < CAST('1993-10-01' AS date) AND EXISTS ( SELECT * FROM lineitem WHERE l_orderkey = o_orderkey AND l_commitdate < l_receiptdate) GROUP BY o_orderpriority ORDER BY o_orderpriority;
Avg Time in sec:  0.2351117366924882  output size:  5
   o_orderpriority  order_count
0         1-URGENT        10594
1           2-HIGH        10476
2         3-MEDIUM        10410
3  4-NOT SPECIFIED        10556
4            5-LOW        10487
{'name': 'Query', 'result': 0.232227, 'timing': 0.232227, 'cardinality': 0, 'extra-info': "SELECT o_orderpriority, count(*) AS order_count FROM orders WHERE o_orderdate >= CAST('1993-07-01' AS date) AND o_orderdate < CAST('1993-10-01' AS date) AND EXISTS ( SELECT * FROM lineitem WHERE l_orderkey = o_orderkey AND l_commitdate < l_receiptdate) GROUP BY o_orderpriority ORDER BY o_orderpriority;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 9e-06, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 2e-06, 'cardinality': 5, 'extra_info': '__internal_decompress_string(#0)\n#1\n', 'children': [{'name': 'ORDER_BY', 'timing': 2.9e-05, 'cardinality': 5, 'extra_info': 'ORDERS:\norders.o_orderpriority ASC', 'children': [{'name': 'PROJECTION', 'timing': 1e-06, 'cardinality': 5, 'extra_info': '__internal_compress_string_hugeint(#0)\n#1\n', 'children': [{'name': 'PROJECTION', 'timing': 9e-06, 'cardinality': 5, 'extra_info': '__internal_decompress_string(#0)\n#1\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.002004, 'cardinality': 5, 'extra_info': '#0\ncount_star()', 'children': [{'name': 'PROJECTION', 'timing': 7e-06, 'cardinality': 52523, 'extra_info': 'o_orderpriority\n', 'children': [{'name': 'PROJECTION', 'timing': 0.000602, 'cardinality': 52523, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n__internal_compress_string_hugeint(#1)\n', 'children': [{'name': 'RIGHT_DELIM_JOIN', 'timing': 0.019973, 'cardinality': 0, 'extra_info': 'RIGHT_SEMI\no_orderkey IS NOT DISTINCT FROM o_orderkey\n\n[INFOSEPARATOR]\nEC: 1200243\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.042043, 'cardinality': 57218, 'extra_info': "orders\n[INFOSEPARATOR]\no_orderkey\no_orderpriority\n[INFOSEPARATOR]\nFilters: o_orderdate>='1993-07-01'::DATE AND o_orderdate<'1993-10-01'::DATE AND o_orderdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 300000", 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.011122, 'cardinality': 52523, 'extra_info': 'RIGHT_SEMI\no_orderkey IS NOT DISTINCT FROM o_orderkey\n\n[INFOSEPARATOR]\nEC: 1200243\n', 'children': [{'name': 'PROJECTION', 'timing': 0.000101, 'cardinality': 144869, 'extra_info': 'o_orderkey\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.098574, 'cardinality': 144869, 'extra_info': 'INNER\nl_orderkey = o_orderkey\n\n[INFOSEPARATOR]\nEC: 1200243\n', 'children': [{'name': 'FILTER', 'timing': 0.030519, 'cardinality': 3793296, 'extra_info': '(l_commitdate < l_receiptdate)\n[INFOSEPARATOR]\nEC: 6001215', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.012384, 'cardinality': 6001215, 'extra_info': 'lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_commitdate\nl_receiptdate\n[INFOSEPARATOR]\nEC: 6001215', 'children': []}]}, {'name': 'DELIM_SCAN', 'timing': 0.0, 'cardinality': 0, 'extra_info': '', 'children': []}]}]}, {'name': 'DUMMY_SCAN', 'timing': 0.0, 'cardinality': 0, 'extra_info': '', 'children': []}]}, {'name': 'HASH_GROUP_BY', 'timing': 0.000459, 'cardinality': 57218, 'extra_info': '#0', 'children': []}]}]}]}]}]}]}]}]}]}]}
X {'RESULT_COLLECTOR0': 9e-06, 'PROJECTION1': 2e-06, 'ORDER_BY2': 2.9e-05, 'PROJECTION3': 1e-06, 'PROJECTION4': 9e-06, 'HASH_GROUP_BY5': 0.002004, 'PROJECTION6': 7e-06, 'PROJECTION7': 0.000602, 'RIGHT_DELIM_JOIN8': 0.019973, 'SEQ_SCAN 9': 0.042043, 'HASH_JOIN10': 0.011122, 'PROJECTION11': 0.000101, 'HASH_JOIN12': 0.098574, 'FILTER13': 0.030519, 'SEQ_SCAN 14': 0.012384, 'DELIM_SCAN15': 0.0, 'DUMMY_SCAN16': 0.0, 'HASH_GROUP_BY17': 0.000459}
Physical operator output, input_left, input_right: 
**** output size:  5
LINEAGE_5_FILTER_2
LINEAGE_5_HASH_GROUP_BY_12
LINEAGE_5_HASH_GROUP_BY_8
LINEAGE_5_HASH_JOIN_4
LINEAGE_5_HASH_JOIN_7
LINEAGE_5_ORDER_BY_15
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_1
SELECT o_orderpriority, count(*) AS order_count FROM orders WHERE o_orderdate >= CAST('1993-07-01' AS date) AND o_orderdate < CAST('1993-10-01' AS date) AND EXISTS ( SELECT * FROM lineitem WHERE l_orderkey = o_orderkey AND l_commitdate < l_receiptdate) GROUP BY o_orderpriority ORDER BY o_orderpriority;
   query_id  ...                                               plan
0         5  ...  {"name": "PROJECTION", "opid": "16", "children...

[1 rows x 8 columns]
Query info:  query_id                                                            5
query               SELECT o_orderpriority, count(*) AS order_coun...
size_bytes_max                                                3092946
physical_op_size    [21654, 0, 64, 0, 0, 73864, 0, 0, 373305, 1422...
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "PROJECTION", "opid": "16", "children...
Name: 0, dtype: object
physical op size is:
{"name": "PROJECTION", "opid": "16", "children": [{"name": "ORDER_BY", "opid": "15", "children": [{"name": "PROJECTION", "opid": "14", "children": [{"name": "PROJECTION", "opid": "13", "children": [{"name": "HASH_GROUP_BY", "opid": "12", "children": [{"name": "PROJECTION", "opid": "11", "children": [{"name": "PROJECTION", "opid": "10", "children": [{"name": "RIGHT_DELIM_JOIN", "opid": "9", "children": [{"name": "HASH_GROUP_BY", "opid": "8", "children": [],"table": "","extra": "#0"},{"name": "HASH_JOIN", "opid": "7", "children": [{"name": "PROJECTION", "opid": "5", "children": [{"name": "HASH_JOIN", "opid": "4", "children": [{"name": "FILTER", "opid": "2", "children": [{"name": "SEQ_SCAN ", "opid": "1", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_commitdate\nl_receiptdate\n[INFOSEPARATOR]\nEC: 6001215"}],"table": "","extra": "(l_commitdate < l_receiptdate)\n[INFOSEPARATOR]\nEC: 6001215"},{"name": "DELIM_SCAN", "opid": "3", "children": [],"table": "","extra": ""}],"table": "","extra": "INNER\nl_orderkey = o_orderkey\n\n[INFOSEPARATOR]\nEC: 1200243\n"}],"table": "","extra": "o_orderkey\n"},{"name": "DUMMY_SCAN", "opid": "6", "children": [],"table": "","extra": ""}],"table": "","extra": "RIGHT_SEMI\no_orderkey IS NOT DISTINCT FROM o_orderkey\n\n[INFOSEPARATOR]\nEC: 1200243\n"},{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "orders","extra": "orders\n[INFOSEPARATOR]\no_orderkey\no_orderpriority\n[INFOSEPARATOR]\nFilters: o_orderdate>='1993-07-01'::DATE AND o_orderdate<'1993-10-01'::DATE AND o_orderdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 300000"}],"table": "","extra": "RIGHT_SEMI\no_orderkey IS NOT DISTINCT FROM o_orderkey\n\n[INFOSEPARATOR]\nEC: 1200243\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n__internal_compress_string_hugeint(#1)\n"}],"table": "","extra": "o_orderpriority\n"}],"table": "","extra": "#0\ncount_star()"}],"table": "","extra": "__internal_decompress_string(#0)\n#1\n"}],"table": "","extra": "__internal_compress_string_hugeint(#0)\n#1\n"}],"table": "","extra": "ORDERS:\norders.o_orderpriority ASC"}],"table": "","extra": "__internal_decompress_string(#0)\n#1\n"}
%%%%%%%%%%%%%%%% Running Query #  5  threads:  1
SELECT n_name, sum(l_extendedprice * (1 - l_discount)) AS revenue FROM customer, orders, lineitem, supplier, nation, region WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND l_suppkey = s_suppkey AND c_nationkey = s_nationkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'ASIA' AND o_orderdate >= CAST('1994-01-01' AS date) AND o_orderdate < CAST('1995-01-01' AS date) GROUP BY n_name ORDER BY revenue DESC;
Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│__internal_decompress_strin│                                                                                                                                                 
│           g(#0)           │                                                                                                                                                 
│             #1            │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│          ORDER_BY         │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│          ORDERS:          │                                                                                                                                                 
│       sum((lineitem       │                                                                                                                                                 
│.l_extendedprice * (1 ...  │                                                                                                                                                 
│    .l_discount))) DESC    │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│__internal_compress_string_│                                                                                                                                                 
│        hugeint(#0)        │                                                                                                                                                 
│             #1            │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│__internal_decompress_strin│                                                                                                                                                 
│           g(#0)           │                                                                                                                                                 
│             #1            │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│       HASH_GROUP_BY       │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│             #0            │                                                                                                                                                 
│          sum(#1)          │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│           n_name          │                                                                                                                                                 
│ (l_extendedprice * (1.00 -│                                                                                                                                                 
│        l_discount))       │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│__internal_compress_integra│                                                                                                                                                 
│     l_uinteger(#0, 1)     │                                                                                                                                                 
│__internal_compress_integra│                                                                                                                                                 
│     l_usmallint(#1, 1)    │                                                                                                                                                 
│             #2            │                                                                                                                                                 
│             #3            │                                                                                                                                                 
│__internal_compress_integra│                                                                                                                                                 
│     l_uinteger(#4, 1)     │                                                                                                                                                 
│__internal_compress_integra│                                                                                                                                                 
│     l_utinyint(#5, 0)     │                                                                                                                                                 
│__internal_compress_string_│                                                                                                                                                 
│        hugeint(#6)        │                                                                                                                                                 
│__internal_compress_integra│                                                                                                                                                 
│     l_usmallint(#7, 1)    │                                                                                                                                                 
│__internal_compress_integra│                                                                                                                                                 
│     l_utinyint(#8, 0)     │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         HASH_JOIN         │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│           INNER           │                                                                                                                                                 
│ n_nationkey = s_nationkey ├──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐              
│   l_suppkey = s_suppkey   │                                                                                                                                  │              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                  │              
│         EC: 143512        │                                                                                                                                  │              
└─────────────┬─────────────┘                                                                                                                                  │                                           
┌─────────────┴─────────────┐                                                                                                                    ┌─────────────┴─────────────┐
│         HASH_JOIN         │                                                                                                                    │         SEQ_SCAN          │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│           INNER           │                                                                                                                    │          supplier         │
│  l_orderkey = o_orderkey  │                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐                                                                                                     │         s_suppkey         │
│         EC: 144747        │              │                                                                                                     │        s_nationkey        │
│                           │              │                                                                                                     │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│                           │              │                                                                                                     │         EC: 10000         │
└─────────────┬─────────────┘              │                                                                                                     └───────────────────────────┘                             
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                                                    
│         SEQ_SCAN          ││         HASH_JOIN         │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│          lineitem         ││           INNER           │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   o_custkey = c_custkey   │                                                                                                                    
│         l_orderkey        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│         l_suppkey         ││        Build Min: 1       ├──────────────┐                                                                                                     
│      l_extendedprice      ││     Build Max: 149999     │              │                                                                                                     
│         l_discount        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                                                                                     
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││         EC: 36179         │              │                                                                                                     
│        EC: 6001215        ││                           │              │                                                                                                     
└───────────────────────────┘└─────────────┬─────────────┘              │                                                                                                                                  
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                       
                             │         SEQ_SCAN          ││         PROJECTION        │                                                                                       
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
                             │           orders          ││             #0            │                                                                                       
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││             #1            │                                                                                       
                             │         o_custkey         ││             #3            │                                                                                       
                             │         o_orderkey        ││                           │                                                                                       
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                                                                       
                             │Filters: o_orderdate>='1994││                           │                                                                                       
                             │     -01-01'::DATE AND     ││                           │                                                                                       
                             │ o_orderdate<'1995-01-...  ││                           │                                                                                       
                             │   o_orderdate IS NOT NULL ││                           │                                                                                       
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                                                                       
                             │         EC: 300000        ││                           │                                                                                       
                             └───────────────────────────┘└─────────────┬─────────────┘                                                                                                                    
                                                          ┌─────────────┴─────────────┐                                                                                       
                                                          │           FILTER          │                                                                                       
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
                                                          │   (c_custkey <= 149999)   │                                                                                       
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
                                                          │         EC: 30000         │                                                                                       
                                                          └─────────────┬─────────────┘                                                                                                                    
                                                          ┌─────────────┴─────────────┐                                                                                       
                                                          │         HASH_JOIN         │                                                                                       
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
                                                          │           INNER           │                                                                                       
                                                          │ c_nationkey = n_nationkey │                                                                                       
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐                                                                        
                                                          │        Build Min: 0       │              │                                                                        
                                                          │       Build Max: 24       │              │                                                                        
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                                                        
                                                          │         EC: 30000         │              │                                                                        
                                                          └─────────────┬─────────────┘              │                                                                                                     
                                                          ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                          
                                                          │         SEQ_SCAN          ││         HASH_JOIN         │                                                          
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                          │          customer         ││           INNER           │                                                          
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││ n_regionkey = r_regionkey │                                                          
                                                          │         c_custkey         ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐                                           
                                                          │        c_nationkey        ││           EC: 25          │              │                                           
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │              │                                           
                                                          │         EC: 150000        ││                           │              │                                           
                                                          └───────────────────────────┘└─────────────┬─────────────┘              │                                                                        
                                                                                       ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             
                                                                                       │         SEQ_SCAN          ││         SEQ_SCAN          │                             
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                                                                                       │           nation          ││           region          │                             
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                                                                                       │        n_nationkey        ││        r_regionkey        │                             
                                                                                       │        n_regionkey        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                                                                                       │           n_name          ││ Filters: r_name='ASIA' AND│                             
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││     r_name IS NOT NULL    │                             
                                                                                       │           EC: 25          ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                                                                                       │                           ││           EC: 1           │                             
                                                                                       └───────────────────────────┘└───────────────────────────┘                                                          

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

Run:  None SELECT n_name, sum(l_extendedprice * (1 - l_discount)) AS revenue FROM customer, orders, lineitem, supplier, nation, region WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND l_suppkey = s_suppkey AND c_nationkey = s_nationkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'ASIA' AND o_orderdate >= CAST('1994-01-01' AS date) AND o_orderdate < CAST('1995-01-01' AS date) GROUP BY n_name ORDER BY revenue DESC;
Avg Time in sec:  0.21897818986326456  output size:  5
      n_name       revenue
0  INDONESIA  5.550204e+07
1    VIETNAM  5.529509e+07
2      CHINA  5.372449e+07
3      INDIA  5.203551e+07
4      JAPAN  4.541018e+07
{'name': 'Query', 'result': 0.211895, 'timing': 0.211895, 'cardinality': 0, 'extra-info': "SELECT n_name, sum(l_extendedprice * (1 - l_discount)) AS revenue FROM customer, orders, lineitem, supplier, nation, region WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND l_suppkey = s_suppkey AND c_nationkey = s_nationkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'ASIA' AND o_orderdate >= CAST('1994-01-01' AS date) AND o_orderdate < CAST('1995-01-01' AS date) GROUP BY n_name ORDER BY revenue DESC;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 5e-06, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 1e-06, 'cardinality': 5, 'extra_info': '__internal_decompress_string(#0)\n#1\n', 'children': [{'name': 'ORDER_BY', 'timing': 3.1e-05, 'cardinality': 5, 'extra_info': 'ORDERS:\nsum((lineitem.l_extendedprice * (1 - lineitem.l_discount))) DESC', 'children': [{'name': 'PROJECTION', 'timing': 1e-06, 'cardinality': 5, 'extra_info': '__internal_compress_string_hugeint(#0)\n#1\n', 'children': [{'name': 'PROJECTION', 'timing': 2e-06, 'cardinality': 5, 'extra_info': '__internal_decompress_string(#0)\n#1\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.001146, 'cardinality': 5, 'extra_info': '#0\nsum(#1)', 'children': [{'name': 'PROJECTION', 'timing': 0.000208, 'cardinality': 7243, 'extra_info': 'n_name\n(l_extendedprice * (1.00 - l_discount))\n', 'children': [{'name': 'PROJECTION', 'timing': 0.000618, 'cardinality': 7243, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n__internal_compress_integral_usmallint(#1, 1)\n#2\n#3\n__internal_compress_integral_uinteger(#4, 1)\n__internal_compress_integral_utinyint(#5, 0)\n__internal_compress_string_hugeint(#6)\n__internal_compress_integral_usmallint(#7, 1)\n__internal_compress_integral_utinyint(#8, 0)\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.01863, 'cardinality': 7243, 'extra_info': 'INNER\nn_nationkey = s_nationkey\nl_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nEC: 143512\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.122526, 'cardinality': 184082, 'extra_info': 'INNER\nl_orderkey = o_orderkey\n\n[INFOSEPARATOR]\nEC: 144747\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.014801, 'cardinality': 6001215, 'extra_info': 'lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_suppkey\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nEC: 6001215', 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.011668, 'cardinality': 46008, 'extra_info': 'INNER\no_custkey = c_custkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 149999\n\n[INFOSEPARATOR]\nEC: 36179\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.016059, 'cardinality': 227597, 'extra_info': "orders\n[INFOSEPARATOR]\no_custkey\no_orderkey\n[INFOSEPARATOR]\nFilters: o_orderdate>='1994-01-01'::DATE AND o_orderdate<'1995-01-01'::DATE AND o_orderdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 300000", 'children': []}, {'name': 'PROJECTION', 'timing': 4e-05, 'cardinality': 30183, 'extra_info': '#0\n#1\n#3\n', 'children': [{'name': 'FILTER', 'timing': 0.000357, 'cardinality': 30183, 'extra_info': '(c_custkey <= 149999)\n[INFOSEPARATOR]\nEC: 30000', 'children': [{'name': 'HASH_JOIN', 'timing': 0.001597, 'cardinality': 30183, 'extra_info': 'INNER\nc_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 30000\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.000345, 'cardinality': 150000, 'extra_info': 'customer\n[INFOSEPARATOR]\nc_custkey\nc_nationkey\n[INFOSEPARATOR]\nEC: 150000', 'children': []}, {'name': 'HASH_JOIN', 'timing': 7.5e-05, 'cardinality': 5, 'extra_info': 'INNER\nn_regionkey = r_regionkey\n\n[INFOSEPARATOR]\nEC: 25\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 3.1e-05, 'cardinality': 25, 'extra_info': 'nation\n[INFOSEPARATOR]\nn_nationkey\nn_regionkey\nn_name\n[INFOSEPARATOR]\nEC: 25', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 4.4e-05, 'cardinality': 1, 'extra_info': "region\n[INFOSEPARATOR]\nr_regionkey\n[INFOSEPARATOR]\nFilters: r_name='ASIA' AND r_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1", 'children': []}]}]}]}]}]}]}, {'name': 'SEQ_SCAN ', 'timing': 8.8e-05, 'cardinality': 10000, 'extra_info': 'supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\n[INFOSEPARATOR]\nEC: 10000', 'children': []}]}]}]}]}]}]}]}]}]}]}
X {'RESULT_COLLECTOR0': 5e-06, 'PROJECTION1': 1e-06, 'ORDER_BY2': 3.1e-05, 'PROJECTION3': 1e-06, 'PROJECTION4': 2e-06, 'HASH_GROUP_BY5': 0.001146, 'PROJECTION6': 0.000208, 'PROJECTION7': 0.000618, 'HASH_JOIN8': 0.01863, 'HASH_JOIN9': 0.122526, 'SEQ_SCAN 10': 0.014801, 'HASH_JOIN11': 0.011668, 'SEQ_SCAN 12': 0.016059, 'PROJECTION13': 4e-05, 'FILTER14': 0.000357, 'HASH_JOIN15': 0.001597, 'SEQ_SCAN 16': 0.000345, 'HASH_JOIN17': 7.5e-05, 'SEQ_SCAN 18': 3.1e-05, 'SEQ_SCAN 19': 4.4e-05, 'SEQ_SCAN 20': 8.8e-05}
Physical operator output, input_left, input_right: 
**** output size:  5
LINEAGE_5_FILTER_7
LINEAGE_5_HASH_GROUP_BY_15
LINEAGE_5_HASH_JOIN_10
LINEAGE_5_HASH_JOIN_12
LINEAGE_5_HASH_JOIN_5
LINEAGE_5_HASH_JOIN_6
LINEAGE_5_HASH_JOIN_9
LINEAGE_5_ORDER_BY_18
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_1
LINEAGE_5_SEQ_SCAN_11
LINEAGE_5_SEQ_SCAN_2
LINEAGE_5_SEQ_SCAN_3
LINEAGE_5_SEQ_SCAN_4
SELECT n_name, sum(l_extendedprice * (1 - l_discount)) AS revenue FROM customer, orders, lineitem, supplier, nation, region WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND l_suppkey = s_suppkey AND c_nationkey = s_nationkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'ASIA' AND o_orderdate >= CAST('1994-01-01' AS date) AND o_orderdate < CAST('1995-01-01' AS date) GROUP BY n_name ORDER BY revenue DESC;
   query_id  ...                                               plan
0         5  ...  {"name": "PROJECTION", "opid": "19", "children...

[1 rows x 8 columns]
Query info:  query_id                                                            5
query               SELECT n_name, sum(l_extendedprice * (1 - l_di...
size_bytes_max                                                1980054
physical_op_size    [198571, 0, 64, 0, 0, 9877, 0, 0, 88907, 12198...
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "PROJECTION", "opid": "19", "children...
Name: 0, dtype: object
physical op size is:
{"name": "PROJECTION", "opid": "19", "children": [{"name": "ORDER_BY", "opid": "18", "children": [{"name": "PROJECTION", "opid": "17", "children": [{"name": "PROJECTION", "opid": "16", "children": [{"name": "HASH_GROUP_BY", "opid": "15", "children": [{"name": "PROJECTION", "opid": "14", "children": [{"name": "PROJECTION", "opid": "13", "children": [{"name": "HASH_JOIN", "opid": "12", "children": [{"name": "HASH_JOIN", "opid": "10", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_suppkey\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nEC: 6001215"},{"name": "HASH_JOIN", "opid": "9", "children": [{"name": "SEQ_SCAN ", "opid": "1", "children": [],"table": "orders","extra": "orders\n[INFOSEPARATOR]\no_custkey\no_orderkey\n[INFOSEPARATOR]\nFilters: o_orderdate>='1994-01-01'::DATE AND o_orderdate<'1995-01-01'::DATE AND o_orderdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 300000"},{"name": "PROJECTION", "opid": "8", "children": [{"name": "FILTER", "opid": "7", "children": [{"name": "HASH_JOIN", "opid": "6", "children": [{"name": "SEQ_SCAN ", "opid": "2", "children": [],"table": "customer","extra": "customer\n[INFOSEPARATOR]\nc_custkey\nc_nationkey\n[INFOSEPARATOR]\nEC: 150000"},{"name": "HASH_JOIN", "opid": "5", "children": [{"name": "SEQ_SCAN ", "opid": "3", "children": [],"table": "nation","extra": "nation\n[INFOSEPARATOR]\nn_nationkey\nn_regionkey\nn_name\n[INFOSEPARATOR]\nEC: 25"},{"name": "SEQ_SCAN ", "opid": "4", "children": [],"table": "region","extra": "region\n[INFOSEPARATOR]\nr_regionkey\n[INFOSEPARATOR]\nFilters: r_name='ASIA' AND r_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1"}],"table": "","extra": "INNER\nn_regionkey = r_regionkey\n\n[INFOSEPARATOR]\nEC: 25\n"}],"table": "","extra": "INNER\nc_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 30000\n"}],"table": "","extra": "(c_custkey <= 149999)\n[INFOSEPARATOR]\nEC: 30000"}],"table": "","extra": "#0\n#1\n#3\n"}],"table": "","extra": "INNER\no_custkey = c_custkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 149999\n\n[INFOSEPARATOR]\nEC: 36179\n"}],"table": "","extra": "INNER\nl_orderkey = o_orderkey\n\n[INFOSEPARATOR]\nEC: 144747\n"},{"name": "SEQ_SCAN ", "opid": "11", "children": [],"table": "supplier","extra": "supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\n[INFOSEPARATOR]\nEC: 10000"}],"table": "","extra": "INNER\nn_nationkey = s_nationkey\nl_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nEC: 143512\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n__internal_compress_integral_usmallint(#1, 1)\n#2\n#3\n__internal_compress_integral_uinteger(#4, 1)\n__internal_compress_integral_utinyint(#5, 0)\n__internal_compress_string_hugeint(#6)\n__internal_compress_integral_usmallint(#7, 1)\n__internal_compress_integral_utinyint(#8, 0)\n"}],"table": "","extra": "n_name\n(l_extendedprice * (1.00 - l_discount))\n"}],"table": "","extra": "#0\nsum(#1)"}],"table": "","extra": "__internal_decompress_string(#0)\n#1\n"}],"table": "","extra": "__internal_compress_string_hugeint(#0)\n#1\n"}],"table": "","extra": "ORDERS:\nsum((lineitem.l_extendedprice * (1 - lineitem.l_discount))) DESC"}],"table": "","extra": "__internal_decompress_string(#0)\n#1\n"}
Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐
│    UNGROUPED_AGGREGATE    │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│    sum_no_overflow(#0)    │
└─────────────┬─────────────┘                             
┌─────────────┴─────────────┐
│         PROJECTION        │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│     (l_extendedprice *    │
│         l_discount)       │
└─────────────┬─────────────┘                             
┌─────────────┴─────────────┐
│         SEQ_SCAN          │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│          lineitem         │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│         l_discount        │
│      l_extendedprice      │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│ Filters: l_shipdate>='1994│
│-01-01'::DATE AND l_sh...  │
│  <'1995-01-01'::DATE AND  │
│   l_shipdate IS NOT NULL  │
│    l_discount>=0.05 AND   │
│ l_discount<=0.07 AND ...  │
│         IS NOT NULL       │
│    l_quantity<24.00 AND   │
│   l_quantity IS NOT NULL  │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│        EC: 1200243        │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│__internal_decompress_strin│                                                                                                                                                 
│           g(#0)           │                                                                                                                                                 
│__internal_decompress_strin│                                                                                                                                                 
│           g(#1)           │                                                                                                                                                 
│__internal_decompress_integ│                                                                                                                                                 
│    ral_bigint(#2, 1992)   │                                                                                                                                                 
│             #3            │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│          ORDER_BY         │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│          ORDERS:          │                                                                                                                                                 
│  shipping.supp_nation ASC │                                                                                                                                                 
│  shipping.cust_nation ASC │                                                                                                                                                 
│    shipping.l_year ASC    │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│__internal_compress_string_│                                                                                                                                                 
│        hugeint(#0)        │                                                                                                                                                 
│__internal_compress_string_│                                                                                                                                                 
│        hugeint(#1)        │                                                                                                                                                 
│__internal_compress_integra│                                                                                                                                                 
│    l_utinyint(#2, 1992)   │                                                                                                                                                 
│             #3            │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│__internal_decompress_strin│                                                                                                                                                 
│           g(#0)           │                                                                                                                                                 
│__internal_decompress_strin│                                                                                                                                                 
│           g(#1)           │                                                                                                                                                 
│__internal_decompress_integ│                                                                                                                                                 
│    ral_bigint(#2, 1992)   │                                                                                                                                                 
│             #3            │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│       HASH_GROUP_BY       │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│             #0            │                                                                                                                                                 
│             #1            │                                                                                                                                                 
│             #2            │                                                                                                                                                 
│          sum(#3)          │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│        supp_nation        │                                                                                                                                                 
│        cust_nation        │                                                                                                                                                 
│           l_year          │                                                                                                                                                 
│           volume          │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│__internal_compress_string_│                                                                                                                                                 
│        hugeint(#0)        │                                                                                                                                                 
│__internal_compress_string_│                                                                                                                                                 
│        hugeint(#1)        │                                                                                                                                                 
│__internal_compress_integra│                                                                                                                                                 
│    l_utinyint(#2, 1992)   │                                                                                                                                                 
│             #3            │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│        supp_nation        │                                                                                                                                                 
│        cust_nation        │                                                                                                                                                 
│      year(l_shipdate)     │                                                                                                                                                 
│           volume          │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│             #2            │                                                                                                                                                 
│             #3            │                                                                                                                                                 
│             #4            │                                                                                                                                                 
│             #6            │                                                                                                                                                 
│             #8            │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│           FILTER          │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│ (((n_name = 'FRANCE') AND │                                                                                                                                                 
│ (n_name = 'GERMANY')) OR (│                                                                                                                                                 
│ (n_name = 'GERMANY') AND  │                                                                                                                                                 
│   (n_name = 'FRANCE')))   │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│         EC: 717564        │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         HASH_JOIN         │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│           INNER           │                                                                                                                                                 
│   l_suppkey = s_suppkey   │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├─────────────────────────────────────────────────────────────────────────────────────────────────────┐                                           
│        Build Min: 1       │                                                                                                     │                                           
│      Build Max: 10000     │                                                                                                     │                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                     │                                           
│         EC: 717564        │                                                                                                     │                                           
└─────────────┬─────────────┘                                                                                                     │                                                                        
┌─────────────┴─────────────┐                                                                                       ┌─────────────┴─────────────┐                             
│         HASH_JOIN         │                                                                                       │         HASH_JOIN         │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│           INNER           │                                                                                       │           INNER           │                             
│  l_orderkey = o_orderkey  │                                                                                       │ s_nationkey = n_nationkey │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐                                                                        │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐              
│         EC: 723735        │              │                                                                        │        Build Min: 0       │              │              
│                           │              │                                                                        │       Build Max: 24       │              │              
│                           │              │                                                                        │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              
│                           │              │                                                                        │         EC: 10000         │              │              
└─────────────┬─────────────┘              │                                                                        └─────────────┬─────────────┘              │                                           
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
│         SEQ_SCAN          ││         HASH_JOIN         │                                                          │         SEQ_SCAN          ││         SEQ_SCAN          │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│          lineitem         ││           INNER           │                                                          │          supplier         ││           nation          │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   o_custkey = c_custkey   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│         l_suppkey         ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │         s_suppkey         ││        n_nationkey        │
│         l_orderkey        ││        Build Min: 1       │                                                          │        s_nationkey        ││           n_name          │
│         l_shipdate        ││     Build Max: 149999     │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│      l_extendedprice      ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │         EC: 10000         ││           EC: 25          │
│         l_discount        ││         EC: 904486        ├──────────────┐                                           │                           ││                           │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │              │                                           │                           ││                           │
│ Filters: l_shipdate>='1995││                           │              │                                           │                           ││                           │
│-01-01'::DATE AND l_sh...  ││                           │              │                                           │                           ││                           │
│  <='1996-12-31'::DATE AND ││                           │              │                                           │                           ││                           │
│   l_shipdate IS NOT NULL  ││                           │              │                                           │                           ││                           │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │              │                                           │                           ││                           │
│        EC: 1200243        ││                           │              │                                           │                           ││                           │
└───────────────────────────┘└─────────────┬─────────────┘              │                                           └───────────────────────────┘└───────────────────────────┘                             
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                       
                             │         SEQ_SCAN          ││         HASH_JOIN         │                                                                                       
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
                             │           orders          ││           INNER           │                                                                                       
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││ c_nationkey = n_nationkey │                                                                                       
                             │         o_orderkey        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐                                                                        
                             │         o_custkey         ││         EC: 150000        │              │                                                                        
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │              │                                                                        
                             │        EC: 1500000        ││                           │              │                                                                        
                             └───────────────────────────┘└─────────────┬─────────────┘              │                                                                                                     
                                                          ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                          
                                                          │         SEQ_SCAN          ││         SEQ_SCAN          │                                                          
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                          │          customer         ││           nation          │                                                          
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                          │         c_custkey         ││        n_nationkey        │                                                          
                                                          │        c_nationkey        ││           n_name          │                                                          
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                          │ Filters: c_custkey<=149999││           EC: 25          │                                                          
                                                          │  AND c_custkey IS NOT NULL││                           │                                                          
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                                          
                                                          │         EC: 150000        ││                           │                                                          
                                                          └───────────────────────────┘└───────────────────────────┘                                                                                       

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

%%%%%%%%%%%%%%%% Running Query #  6  threads:  1
SELECT sum(l_extendedprice * l_discount) AS revenue FROM lineitem WHERE l_shipdate >= CAST('1994-01-01' AS date) AND l_shipdate < CAST('1995-01-01' AS date) AND l_discount BETWEEN 0.05 AND 0.07 AND l_quantity < 24;
Run:  None SELECT sum(l_extendedprice * l_discount) AS revenue FROM lineitem WHERE l_shipdate >= CAST('1994-01-01' AS date) AND l_shipdate < CAST('1995-01-01' AS date) AND l_discount BETWEEN 0.05 AND 0.07 AND l_quantity < 24;
Avg Time in sec:  0.0794462189078331  output size:  1
        revenue
0  1.231411e+08
{'name': 'Query', 'result': 0.078122, 'timing': 0.078122, 'cardinality': 0, 'extra-info': "SELECT sum(l_extendedprice * l_discount) AS revenue FROM lineitem WHERE l_shipdate >= CAST('1994-01-01' AS date) AND l_shipdate < CAST('1995-01-01' AS date) AND l_discount BETWEEN 0.05 AND 0.07 AND l_quantity < 24;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 6e-06, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'UNGROUPED_AGGREGATE', 'timing': 0.001799, 'cardinality': 1, 'extra_info': 'sum_no_overflow(#0)', 'children': [{'name': 'PROJECTION', 'timing': 0.004647, 'cardinality': 114160, 'extra_info': '(l_extendedprice * l_discount)\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.067811, 'cardinality': 114160, 'extra_info': "lineitem\n[INFOSEPARATOR]\nl_discount\nl_extendedprice\n[INFOSEPARATOR]\nFilters: l_shipdate>='1994-01-01'::DATE AND l_shipdate<'1995-01-01'::DATE AND l_shipdate IS NOT NULL\nl_discount>=0.05 AND l_discount<=0.07 AND l_discount IS NOT NULL\nl_quantity<24.00 AND l_quantity IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243", 'children': []}]}]}]}]}
X {'RESULT_COLLECTOR0': 6e-06, 'UNGROUPED_AGGREGATE1': 0.001799, 'PROJECTION2': 0.004647, 'SEQ_SCAN 3': 0.067811}
Physical operator output, input_left, input_right: 
**** output size:  1
LINEAGE_5_SEQ_SCAN_0
SELECT sum(l_extendedprice * l_discount) AS revenue FROM lineitem WHERE l_shipdate >= CAST('1994-01-01' AS date) AND l_shipdate < CAST('1995-01-01' AS date) AND l_discount BETWEEN 0.05 AND 0.07 AND l_quantity < 24;
   query_id  ...                                               plan
0         5  ...  {"name": "UNGROUPED_AGGREGATE", "opid": "2", "...

[1 rows x 8 columns]
Query info:  query_id                                                            5
query               SELECT sum(l_extendedprice * l_discount) AS re...
size_bytes_max                                                 396004
physical_op_size                                    [0, 0, 0, 396004]
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "UNGROUPED_AGGREGATE", "opid": "2", "...
Name: 0, dtype: object
physical op size is:
{"name": "UNGROUPED_AGGREGATE", "opid": "2", "children": [{"name": "PROJECTION", "opid": "1", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_discount\nl_extendedprice\n[INFOSEPARATOR]\nFilters: l_shipdate>='1994-01-01'::DATE AND l_shipdate<'1995-01-01'::DATE AND l_shipdate IS NOT NULL\nl_discount>=0.05 AND l_discount<=0.07 AND l_discount IS NOT NULL\nl_quantity<24.00 AND l_quantity IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243"}],"table": "","extra": "(l_extendedprice * l_discount)\n"}],"table": "","extra": "sum_no_overflow(#0)"}
%%%%%%%%%%%%%%%% Running Query #  7  threads:  1
SELECT supp_nation, cust_nation, l_year, sum(volume) AS revenue FROM ( SELECT n1.n_name AS supp_nation, n2.n_name AS cust_nation, extract(year FROM l_shipdate) AS l_year, l_extendedprice * (1 - l_discount) AS volume FROM supplier, lineitem, orders, customer, nation n1, nation n2 WHERE s_suppkey = l_suppkey AND o_orderkey = l_orderkey AND c_custkey = o_custkey AND s_nationkey = n1.n_nationkey AND c_nationkey = n2.n_nationkey AND ((n1.n_name = 'FRANCE' AND n2.n_name = 'GERMANY') OR (n1.n_name = 'GERMANY' AND n2.n_name = 'FRANCE')) AND l_shipdate BETWEEN CAST('1995-01-01' AS date) AND CAST('1996-12-31' AS date)) AS shipping GROUP BY supp_nation, cust_nation, l_year ORDER BY supp_nation, cust_nation, l_year;
Run:  None SELECT supp_nation, cust_nation, l_year, sum(volume) AS revenue FROM ( SELECT n1.n_name AS supp_nation, n2.n_name AS cust_nation, extract(year FROM l_shipdate) AS l_year, l_extendedprice * (1 - l_discount) AS volume FROM supplier, lineitem, orders, customer, nation n1, nation n2 WHERE s_suppkey = l_suppkey AND o_orderkey = l_orderkey AND c_custkey = o_custkey AND s_nationkey = n1.n_nationkey AND c_nationkey = n2.n_nationkey AND ((n1.n_name = 'FRANCE' AND n2.n_name = 'GERMANY') OR (n1.n_name = 'GERMANY' AND n2.n_name = 'FRANCE')) AND l_shipdate BETWEEN CAST('1995-01-01' AS date) AND CAST('1996-12-31' AS date)) AS shipping GROUP BY supp_nation, cust_nation, l_year ORDER BY supp_nation, cust_nation, l_year;
Avg Time in sec:  0.6528620906174183  output size:  4
  supp_nation cust_nation  l_year       revenue
0      FRANCE     GERMANY    1995  5.463973e+07
1      FRANCE     GERMANY    1996  5.463308e+07
2     GERMANY      FRANCE    1995  5.253175e+07
3     GERMANY      FRANCE    1996  5.252055e+07
{'name': 'Query', 'result': 0.64264, 'timing': 0.64264, 'cardinality': 0, 'extra-info': "SELECT supp_nation, cust_nation, l_year, sum(volume) AS revenue FROM ( SELECT n1.n_name AS supp_nation, n2.n_name AS cust_nation, extract(year FROM l_shipdate) AS l_year, l_extendedprice * (1 - l_discount) AS volume FROM supplier, lineitem, orders, customer, nation n1, nation n2 WHERE s_suppkey = l_suppkey AND o_orderkey = l_orderkey AND c_custkey = o_custkey AND s_nationkey = n1.n_nationkey AND c_nationkey = n2.n_nationkey AND ((n1.n_name = 'FRANCE' AND n2.n_name = 'GERMANY') OR (n1.n_name = 'GERMANY' AND n2.n_name = 'FRANCE')) AND l_shipdate BETWEEN CAST('1995-01-01' AS date) AND CAST('1996-12-31' AS date)) AS shipping GROUP BY supp_nation, cust_nation, l_year ORDER BY supp_nation, cust_nation, l_year;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 6e-06, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 3e-06, 'cardinality': 4, 'extra_info': '__internal_decompress_string(#0)\n__internal_decompress_string(#1)\n__internal_decompress_integral_bigint(#2, 1992)\n#3\n', 'children': [{'name': 'ORDER_BY', 'timing': 3.6e-05, 'cardinality': 4, 'extra_info': 'ORDERS:\nshipping.supp_nation ASC\nshipping.cust_nation ASC\nshipping.l_year ASC', 'children': [{'name': 'PROJECTION', 'timing': 3e-06, 'cardinality': 4, 'extra_info': '__internal_compress_string_hugeint(#0)\n__internal_compress_string_hugeint(#1)\n__internal_compress_integral_utinyint(#2, 1992)\n#3\n', 'children': [{'name': 'PROJECTION', 'timing': 5e-06, 'cardinality': 4, 'extra_info': '__internal_decompress_string(#0)\n__internal_decompress_string(#1)\n__internal_decompress_integral_bigint(#2, 1992)\n#3\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.001084, 'cardinality': 4, 'extra_info': '#0\n#1\n#2\nsum(#3)', 'children': [{'name': 'PROJECTION', 'timing': 3e-06, 'cardinality': 5924, 'extra_info': 'supp_nation\ncust_nation\nl_year\nvolume\n', 'children': [{'name': 'PROJECTION', 'timing': 0.000154, 'cardinality': 5924, 'extra_info': '__internal_compress_string_hugeint(#0)\n__internal_compress_string_hugeint(#1)\n__internal_compress_integral_utinyint(#2, 1992)\n#3\n', 'children': [{'name': 'PROJECTION', 'timing': 0.00015, 'cardinality': 5924, 'extra_info': 'supp_nation\ncust_nation\nyear(l_shipdate)\nvolume\n', 'children': [{'name': 'PROJECTION', 'timing': 7e-06, 'cardinality': 5924, 'extra_info': '#2\n#3\n#4\n#6\n#8\n', 'children': [{'name': 'FILTER', 'timing': 0.074848, 'cardinality': 5924, 'extra_info': "(((n_name = 'FRANCE') AND (n_name = 'GERMANY')) OR ((n_name = 'GERMANY') AND (n_name = 'FRANCE')))\n[INFOSEPARATOR]\nEC: 717564", 'children': [{'name': 'HASH_JOIN', 'timing': 0.05878, 'cardinality': 1828450, 'extra_info': 'INNER\nl_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 717564\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.297419, 'cardinality': 1828450, 'extra_info': 'INNER\nl_orderkey = o_orderkey\n\n[INFOSEPARATOR]\nEC: 723735\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.054611, 'cardinality': 1828450, 'extra_info': "lineitem\n[INFOSEPARATOR]\nl_suppkey\nl_orderkey\nl_shipdate\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nFilters: l_shipdate>='1995-01-01'::DATE AND l_shipdate<='1996-12-31'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243", 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.037053, 'cardinality': 1500000, 'extra_info': 'INNER\no_custkey = c_custkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 149999\n\n[INFOSEPARATOR]\nEC: 904486\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.003709, 'cardinality': 1500000, 'extra_info': 'orders\n[INFOSEPARATOR]\no_orderkey\no_custkey\n[INFOSEPARATOR]\nEC: 1500000', 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.005109, 'cardinality': 149999, 'extra_info': 'INNER\nc_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nEC: 150000\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.001071, 'cardinality': 149999, 'extra_info': 'customer\n[INFOSEPARATOR]\nc_custkey\nc_nationkey\n[INFOSEPARATOR]\nFilters: c_custkey<=149999 AND c_custkey IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 150000', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 8e-06, 'cardinality': 25, 'extra_info': 'nation\n[INFOSEPARATOR]\nn_nationkey\nn_name\n[INFOSEPARATOR]\nEC: 25', 'children': []}]}]}]}, {'name': 'HASH_JOIN', 'timing': 0.000216, 'cardinality': 10000, 'extra_info': 'INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 10000\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 3.8e-05, 'cardinality': 10000, 'extra_info': 'supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\n[INFOSEPARATOR]\nEC: 10000', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 1.8e-05, 'cardinality': 25, 'extra_info': 'nation\n[INFOSEPARATOR]\nn_nationkey\nn_name\n[INFOSEPARATOR]\nEC: 25', 'children': []}]}]}]}]}]}]}]}]}]}]}]}]}]}]}
Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                                                                                                                                                                                                           
│         PROJECTION        │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│__internal_decompress_integ│                                                                                                                                                                                                           
│    ral_bigint(#0, 1992)   │                                                                                                                                                                                                           
│             #1            │                                                                                                                                                                                                           
└─────────────┬─────────────┘                                                                                                                                                                                                                                        
┌─────────────┴─────────────┐                                                                                                                                                                                                           
│          ORDER_BY         │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│          ORDERS:          │                                                                                                                                                                                                           
│   all_nations.o_year ASC  │                                                                                                                                                                                                           
└─────────────┬─────────────┘                                                                                                                                                                                                                                        
┌─────────────┴─────────────┐                                                                                                                                                                                                           
│         PROJECTION        │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│__internal_compress_integra│                                                                                                                                                                                                           
│    l_utinyint(#0, 1992)   │                                                                                                                                                                                                           
│             #1            │                                                                                                                                                                                                           
└─────────────┬─────────────┘                                                                                                                                                                                                                                        
┌─────────────┴─────────────┐                                                                                                                                                                                                           
│         PROJECTION        │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│           o_year          │                                                                                                                                                                                                           
│         mkt_share         │                                                                                                                                                                                                           
└─────────────┬─────────────┘                                                                                                                                                                                                                                        
┌─────────────┴─────────────┐                                                                                                                                                                                                           
│         PROJECTION        │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│__internal_decompress_integ│                                                                                                                                                                                                           
│    ral_bigint(#0, 1992)   │                                                                                                                                                                                                           
│             #1            │                                                                                                                                                                                                           
│             #2            │                                                                                                                                                                                                           
└─────────────┬─────────────┘                                                                                                                                                                                                                                        
┌─────────────┴─────────────┐                                                                                                                                                                                                           
│   PERFECT_HASH_GROUP_BY   │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│             #0            │                                                                                                                                                                                                           
│          sum(#1)          │                                                                                                                                                                                                           
│          sum(#2)          │                                                                                                                                                                                                           
└─────────────┬─────────────┘                                                                                                                                                                                                                                        
┌─────────────┴─────────────┐                                                                                                                                                                                                           
│         PROJECTION        │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│           o_year          │                                                                                                                                                                                                           
│   CASE  WHEN ((nation =   │                                                                                                                                                                                                           
│'BRAZIL')) THEN (volum...  │                                                                                                                                                                                                           
│         .0000 END         │                                                                                                                                                                                                           
│           volume          │                                                                                                                                                                                                           
└─────────────┬─────────────┘                                                                                                                                                                                                                                        
┌─────────────┴─────────────┐                                                                                                                                                                                                           
│         PROJECTION        │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│__internal_compress_integra│                                                                                                                                                                                                           
│    l_utinyint(#0, 1992)   │                                                                                                                                                                                                           
│             #1            │                                                                                                                                                                                                           
│             #2            │                                                                                                                                                                                                           
└─────────────┬─────────────┘                                                                                                                                                                                                                                        
┌─────────────┴─────────────┐                                                                                                                                                                                                           
│         PROJECTION        │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│     year(o_orderdate)     │                                                                                                                                                                                                           
│           volume          │                                                                                                                                                                                                           
│           nation          │                                                                                                                                                                                                           
└─────────────┬─────────────┘                                                                                                                                                                                                                                        
┌─────────────┴─────────────┐                                                                                                                                                                                                           
│         HASH_JOIN         │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│           INNER           │                                                                                                                                                                                                           
│ s_nationkey = n_nationkey │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐              
│        Build Min: 0       │                                                                                                                                                                                            │              
│       Build Max: 24       │                                                                                                                                                                                            │              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                            │              
│          EC: 508          │                                                                                                                                                                                            │              
└─────────────┬─────────────┘                                                                                                                                                                                            │                                           
┌─────────────┴─────────────┐                                                                                                                                                                              ┌─────────────┴─────────────┐
│         HASH_JOIN         │                                                                                                                                                                              │         SEQ_SCAN          │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│           INNER           │                                                                                                                                                                              │           nation          │
│   s_suppkey = l_suppkey   │                                                                                                                                                                              │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐                                                                                                                                                               │        n_nationkey        │
│        Build Min: 1       │              │                                                                                                                                                               │           n_name          │
│      Build Max: 10000     │              │                                                                                                                                                               │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                                                                                                                                               │           EC: 25          │
│          EC: 508          │              │                                                                                                                                                               │                           │
└─────────────┬─────────────┘              │                                                                                                                                                               └───────────────────────────┘                             
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                                                                                                              
│         SEQ_SCAN          ││         HASH_JOIN         │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│          supplier         ││           INNER           │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││ c_nationkey = n_nationkey │                                                                                                                                                                              
│         s_suppkey         ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├─────────────────────────────────────────────────────────────────────────────────────────────────────┐                                                                        
│        s_nationkey        ││        Build Min: 0       │                                                                                                     │                                                                        
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││       Build Max: 24       │                                                                                                     │                                                                        
│         EC: 10000         ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                     │                                                                        
│                           ││          EC: 512          │                                                                                                     │                                                                        
└───────────────────────────┘└─────────────┬─────────────┘                                                                                                     │                                                                                                     
                             ┌─────────────┴─────────────┐                                                                                       ┌─────────────┴─────────────┐                                                          
                             │         HASH_JOIN         │                                                                                       │         HASH_JOIN         │                                                          
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                             │           INNER           │                                                                                       │           INNER           │                                                          
                             │   c_custkey = o_custkey   │                                                                                       │ n_regionkey = r_regionkey │                                                          
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐                                                                        │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐                                           
                             │        Build Min: 1       │              │                                                                        │        Build Min: 0       │              │                                           
                             │     Build Max: 149999     │              │                                                                        │        Build Max: 4       │              │                                           
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                                                        │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                           
                             │          EC: 2562         │              │                                                                        │           EC: 5           │              │                                           
                             └─────────────┬─────────────┘              │                                                                        └─────────────┬─────────────┘              │                                                                        
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             
                             │         SEQ_SCAN          ││         HASH_JOIN         │                                                          │         SEQ_SCAN          ││         SEQ_SCAN          │                             
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                             │          customer         ││           INNER           │                                                          │           nation          ││           region          │                             
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││  o_orderkey = l_orderkey  │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                             │         c_custkey         ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │        n_nationkey        ││        r_regionkey        │                             
                             │        c_nationkey        ││          EC: 4249         ├──────────────┐                                           │        n_regionkey        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │              │                                           │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││ Filters: r_name='AMERICA' │                             
                             │ Filters: c_custkey<=149999││                           │              │                                           │           EC: 25          ││   AND r_name IS NOT NULL  │                             
                             │  AND c_custkey IS NOT NULL││                           │              │                                           │                           ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │              │                                           │                           ││           EC: 1           │                             
                             │         EC: 150000        ││                           │              │                                           │                           ││                           │                             
                             └───────────────────────────┘└─────────────┬─────────────┘              │                                           └───────────────────────────┘└───────────────────────────┘                                                          
                                                          ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                                                    
                                                          │         SEQ_SCAN          ││         HASH_JOIN         │                                                                                                                    
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
                                                          │           orders          ││           INNER           │                                                                                                                    
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   l_partkey = p_partkey   │                                                                                                                    
                                                          │         o_orderkey        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
                                                          │         o_custkey         ││        Build Min: 1       │                                                                                                                    
                                                          │        o_orderdate        ││     Build Max: 200000     │                                                                                                                    
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐                                                                                                     
                                                          │Filters: o_orderdate>='1995││         EC: 21246         │              │                                                                                                     
                                                          │     -01-01'::DATE AND     ││                           │              │                                                                                                     
                                                          │ o_orderdate<='1996-12...  ││                           │              │                                                                                                     
                                                          │   o_orderdate IS NOT NULL ││                           │              │                                                                                                     
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │              │                                                                                                     
                                                          │         EC: 300000        ││                           │              │                                                                                                     
                                                          └───────────────────────────┘└─────────────┬─────────────┘              │                                                                                                                                  
                                                                                       ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                       
                                                                                       │         SEQ_SCAN          ││         SEQ_SCAN          │                                                                                       
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
                                                                                       │          lineitem         ││            part           │                                                                                       
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
                                                                                       │         l_partkey         ││         p_partkey         │                                                                                       
                                                                                       │         l_suppkey         ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
                                                                                       │         l_orderkey        ││  Filters: p_type='ECONOMY │                                                                                       
                                                                                       │      l_extendedprice      ││ ANODIZED STEEL' AND p...  │                                                                                       
                                                                                       │         l_discount        ││          NOT NULL         │                                                                                       
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
                                                                                       │        EC: 6001215        ││          EC: 1325         │                                                                                       
                                                                                       └───────────────────────────┘└───────────────────────────┘                                                                                                                    

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

X {'RESULT_COLLECTOR0': 6e-06, 'PROJECTION1': 3e-06, 'ORDER_BY2': 3.6e-05, 'PROJECTION3': 3e-06, 'PROJECTION4': 5e-06, 'HASH_GROUP_BY5': 0.001084, 'PROJECTION6': 3e-06, 'PROJECTION7': 0.000154, 'PROJECTION8': 0.00015, 'PROJECTION9': 7e-06, 'FILTER10': 0.074848, 'HASH_JOIN11': 0.05878, 'HASH_JOIN12': 0.297419, 'SEQ_SCAN 13': 0.054611, 'HASH_JOIN14': 0.037053, 'SEQ_SCAN 15': 0.003709, 'HASH_JOIN16': 0.005109, 'SEQ_SCAN 17': 0.001071, 'SEQ_SCAN 18': 8e-06, 'HASH_JOIN19': 0.000216, 'SEQ_SCAN 20': 3.8e-05, 'SEQ_SCAN 21': 1.8e-05}
Physical operator output, input_left, input_right: 
**** output size:  4
LINEAGE_5_FILTER_11
LINEAGE_5_HASH_GROUP_BY_16
LINEAGE_5_HASH_JOIN_10
LINEAGE_5_HASH_JOIN_4
LINEAGE_5_HASH_JOIN_5
LINEAGE_5_HASH_JOIN_6
LINEAGE_5_HASH_JOIN_9
LINEAGE_5_ORDER_BY_19
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_1
LINEAGE_5_SEQ_SCAN_2
LINEAGE_5_SEQ_SCAN_3
LINEAGE_5_SEQ_SCAN_7
LINEAGE_5_SEQ_SCAN_8
SELECT supp_nation, cust_nation, l_year, sum(volume) AS revenue FROM ( SELECT n1.n_name AS supp_nation, n2.n_name AS cust_nation, extract(year FROM l_shipdate) AS l_year, l_extendedprice * (1 - l_discount) AS volume FROM supplier, lineitem, orders, customer, nation n1, nation n2 WHERE s_suppkey = l_suppkey AND o_orderkey = l_orderkey AND c_custkey = o_custkey AND s_nationkey = n1.n_nationkey AND c_nationkey = n2.n_nationkey AND ((n1.n_name = 'FRANCE' AND n2.n_name = 'GERMANY') OR (n1.n_name = 'GERMANY' AND n2.n_name = 'FRANCE')) AND l_shipdate BETWEEN CAST('1995-01-01' AS date) AND CAST('1996-12-31' AS date)) AS shipping GROUP BY supp_nation, cust_nation, l_year ORDER BY supp_nation, cust_nation, l_year;
   query_id  ...                                               plan
0         5  ...  {"name": "PROJECTION", "opid": "20", "children...

[1 rows x 8 columns]
Query info:  query_id                                                            5
query               SELECT supp_nation, cust_nation, l_year, sum(v...
size_bytes_max                                               19711724
physical_op_size    [5339, 0, 64, 0, 0, 7085, 0, 0, 0, 0, 54705, 4...
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "PROJECTION", "opid": "20", "children...
Name: 0, dtype: object
physical op size is:
{"name": "PROJECTION", "opid": "20", "children": [{"name": "ORDER_BY", "opid": "19", "children": [{"name": "PROJECTION", "opid": "18", "children": [{"name": "PROJECTION", "opid": "17", "children": [{"name": "HASH_GROUP_BY", "opid": "16", "children": [{"name": "PROJECTION", "opid": "15", "children": [{"name": "PROJECTION", "opid": "14", "children": [{"name": "PROJECTION", "opid": "13", "children": [{"name": "PROJECTION", "opid": "12", "children": [{"name": "FILTER", "opid": "11", "children": [{"name": "HASH_JOIN", "opid": "10", "children": [{"name": "HASH_JOIN", "opid": "6", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_suppkey\nl_orderkey\nl_shipdate\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nFilters: l_shipdate>='1995-01-01'::DATE AND l_shipdate<='1996-12-31'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243"},{"name": "HASH_JOIN", "opid": "5", "children": [{"name": "SEQ_SCAN ", "opid": "1", "children": [],"table": "orders","extra": "orders\n[INFOSEPARATOR]\no_orderkey\no_custkey\n[INFOSEPARATOR]\nEC: 1500000"},{"name": "HASH_JOIN", "opid": "4", "children": [{"name": "SEQ_SCAN ", "opid": "2", "children": [],"table": "customer","extra": "customer\n[INFOSEPARATOR]\nc_custkey\nc_nationkey\n[INFOSEPARATOR]\nFilters: c_custkey<=149999 AND c_custkey IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 150000"},{"name": "SEQ_SCAN ", "opid": "3", "children": [],"table": "nation","extra": "nation\n[INFOSEPARATOR]\nn_nationkey\nn_name\n[INFOSEPARATOR]\nEC: 25"}],"table": "","extra": "INNER\nc_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nEC: 150000\n"}],"table": "","extra": "INNER\no_custkey = c_custkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 149999\n\n[INFOSEPARATOR]\nEC: 904486\n"}],"table": "","extra": "INNER\nl_orderkey = o_orderkey\n\n[INFOSEPARATOR]\nEC: 723735\n"},{"name": "HASH_JOIN", "opid": "9", "children": [{"name": "SEQ_SCAN ", "opid": "7", "children": [],"table": "supplier","extra": "supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\n[INFOSEPARATOR]\nEC: 10000"},{"name": "SEQ_SCAN ", "opid": "8", "children": [],"table": "nation","extra": "nation\n[INFOSEPARATOR]\nn_nationkey\nn_name\n[INFOSEPARATOR]\nEC: 25"}],"table": "","extra": "INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 10000\n"}],"table": "","extra": "INNER\nl_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 717564\n"}],"table": "","extra": "(((n_name = 'FRANCE') AND (n_name = 'GERMANY')) OR ((n_name = 'GERMANY') AND (n_name = 'FRANCE')))\n[INFOSEPARATOR]\nEC: 717564"}],"table": "","extra": "#2\n#3\n#4\n#6\n#8\n"}],"table": "","extra": "supp_nation\ncust_nation\nyear(l_shipdate)\nvolume\n"}],"table": "","extra": "__internal_compress_string_hugeint(#0)\n__internal_compress_string_hugeint(#1)\n__internal_compress_integral_utinyint(#2, 1992)\n#3\n"}],"table": "","extra": "supp_nation\ncust_nation\nl_year\nvolume\n"}],"table": "","extra": "#0\n#1\n#2\nsum(#3)"}],"table": "","extra": "__internal_decompress_string(#0)\n__internal_decompress_string(#1)\n__internal_decompress_integral_bigint(#2, 1992)\n#3\n"}],"table": "","extra": "__internal_compress_string_hugeint(#0)\n__internal_compress_string_hugeint(#1)\n__internal_compress_integral_utinyint(#2, 1992)\n#3\n"}],"table": "","extra": "ORDERS:\nshipping.supp_nation ASC\nshipping.cust_nation ASC\nshipping.l_year ASC"}],"table": "","extra": "__internal_decompress_string(#0)\n__internal_decompress_string(#1)\n__internal_decompress_integral_bigint(#2, 1992)\n#3\n"}
%%%%%%%%%%%%%%%% Running Query #  8  threads:  1
SELECT o_year, sum( CASE WHEN nation = 'BRAZIL' THEN volume ELSE 0 END) / sum(volume) AS mkt_share FROM ( SELECT extract(year FROM o_orderdate) AS o_year, l_extendedprice * (1 - l_discount) AS volume, n2.n_name AS nation FROM part, supplier, lineitem, orders, customer, nation n1, nation n2, region WHERE p_partkey = l_partkey AND s_suppkey = l_suppkey AND l_orderkey = o_orderkey AND o_custkey = c_custkey AND c_nationkey = n1.n_nationkey AND n1.n_regionkey = r_regionkey AND r_name = 'AMERICA' AND s_nationkey = n2.n_nationkey AND o_orderdate BETWEEN CAST('1995-01-01' AS date) AND CAST('1996-12-31' AS date) AND p_type = 'ECONOMY ANODIZED STEEL') AS all_nations GROUP BY o_year ORDER BY o_year;
Run:  None SELECT o_year, sum( CASE WHEN nation = 'BRAZIL' THEN volume ELSE 0 END) / sum(volume) AS mkt_share FROM ( SELECT extract(year FROM o_orderdate) AS o_year, l_extendedprice * (1 - l_discount) AS volume, n2.n_name AS nation FROM part, supplier, lineitem, orders, customer, nation n1, nation n2, region WHERE p_partkey = l_partkey AND s_suppkey = l_suppkey AND l_orderkey = o_orderkey AND o_custkey = c_custkey AND c_nationkey = n1.n_nationkey AND n1.n_regionkey = r_regionkey AND r_name = 'AMERICA' AND s_nationkey = n2.n_nationkey AND o_orderdate BETWEEN CAST('1995-01-01' AS date) AND CAST('1996-12-31' AS date) AND p_type = 'ECONOMY ANODIZED STEEL') AS all_nations GROUP BY o_year ORDER BY o_year;
Avg Time in sec:  0.14775601401925087  output size:  2
   o_year  mkt_share
0    1995   0.034436
1    1996   0.041486
{'name': 'Query', 'result': 0.143047, 'timing': 0.143047, 'cardinality': 0, 'extra-info': "SELECT o_year, sum( CASE WHEN nation = 'BRAZIL' THEN volume ELSE 0 END) / sum(volume) AS mkt_share FROM ( SELECT extract(year FROM o_orderdate) AS o_year, l_extendedprice * (1 - l_discount) AS volume, n2.n_name AS nation FROM part, supplier, lineitem, orders, customer, nation n1, nation n2, region WHERE p_partkey = l_partkey AND s_suppkey = l_suppkey AND l_orderkey = o_orderkey AND o_custkey = c_custkey AND c_nationkey = n1.n_nationkey AND n1.n_regionkey = r_regionkey AND r_name = 'AMERICA' AND s_nationkey = n2.n_nationkey AND o_orderdate BETWEEN CAST('1995-01-01' AS date) AND CAST('1996-12-31' AS date) AND p_type = 'ECONOMY ANODIZED STEEL') AS all_nations GROUP BY o_year ORDER BY o_year;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 5e-06, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 2e-06, 'cardinality': 2, 'extra_info': '__internal_decompress_integral_bigint(#0, 1992)\n#1\n', 'children': [{'name': 'ORDER_BY', 'timing': 3.2e-05, 'cardinality': 2, 'extra_info': 'ORDERS:\nall_nations.o_year ASC', 'children': [{'name': 'PROJECTION', 'timing': 2e-06, 'cardinality': 2, 'extra_info': '__internal_compress_integral_utinyint(#0, 1992)\n#1\n', 'children': [{'name': 'PROJECTION', 'timing': 1.8e-05, 'cardinality': 2, 'extra_info': 'o_year\nmkt_share\n', 'children': [{'name': 'PROJECTION', 'timing': 3e-06, 'cardinality': 2, 'extra_info': '__internal_decompress_integral_bigint(#0, 1992)\n#1\n#2\n', 'children': [{'name': 'PERFECT_HASH_GROUP_BY', 'timing': 6.2e-05, 'cardinality': 2, 'extra_info': '#0\nsum(#1)\nsum(#2)', 'children': [{'name': 'PROJECTION', 'timing': 4.8e-05, 'cardinality': 2603, 'extra_info': "o_year\nCASE  WHEN ((nation = 'BRAZIL')) THEN (volume) ELSE 0.0000 END\nvolume\n", 'children': [{'name': 'PROJECTION', 'timing': 1.5e-05, 'cardinality': 2603, 'extra_info': '__internal_compress_integral_utinyint(#0, 1992)\n#1\n#2\n', 'children': [{'name': 'PROJECTION', 'timing': 7.2e-05, 'cardinality': 2603, 'extra_info': 'year(o_orderdate)\nvolume\nnation\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.000181, 'cardinality': 2603, 'extra_info': 'INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 508\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.000684, 'cardinality': 2603, 'extra_info': 'INNER\ns_suppkey = l_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 508\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 4.4e-05, 'cardinality': 10000, 'extra_info': 'supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\n[INFOSEPARATOR]\nEC: 10000', 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.00079, 'cardinality': 2603, 'extra_info': 'INNER\nc_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 512\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.005442, 'cardinality': 13389, 'extra_info': 'INNER\nc_custkey = o_custkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 149999\n\n[INFOSEPARATOR]\nEC: 2562\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.001063, 'cardinality': 149999, 'extra_info': 'customer\n[INFOSEPARATOR]\nc_custkey\nc_nationkey\n[INFOSEPARATOR]\nFilters: c_custkey<=149999 AND c_custkey IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 150000', 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.024607, 'cardinality': 13389, 'extra_info': 'INNER\no_orderkey = l_orderkey\n\n[INFOSEPARATOR]\nEC: 4249\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.018436, 'cardinality': 457263, 'extra_info': "orders\n[INFOSEPARATOR]\no_orderkey\no_custkey\no_orderdate\n[INFOSEPARATOR]\nFilters: o_orderdate>='1995-01-01'::DATE AND o_orderdate<='1996-12-31'::DATE AND o_orderdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 300000", 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.053906, 'cardinality': 43693, 'extra_info': 'INNER\nl_partkey = p_partkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 21246\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.01918, 'cardinality': 6001215, 'extra_info': 'lineitem\n[INFOSEPARATOR]\nl_partkey\nl_suppkey\nl_orderkey\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nEC: 6001215', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 0.004288, 'cardinality': 1451, 'extra_info': "part\n[INFOSEPARATOR]\np_partkey\n[INFOSEPARATOR]\nFilters: p_type='ECONOMY ANODIZED STEEL' AND p_type IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1325", 'children': []}]}]}]}, {'name': 'HASH_JOIN', 'timing': 3.6e-05, 'cardinality': 5, 'extra_info': 'INNER\nn_regionkey = r_regionkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 4\n\n[INFOSEPARATOR]\nEC: 5\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 1.2e-05, 'cardinality': 25, 'extra_info': 'nation\n[INFOSEPARATOR]\nn_nationkey\nn_regionkey\n[INFOSEPARATOR]\nEC: 25', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 1.9e-05, 'cardinality': 1, 'extra_info': "region\n[INFOSEPARATOR]\nr_regionkey\n[INFOSEPARATOR]\nFilters: r_name='AMERICA' AND r_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1", 'children': []}]}]}]}, {'name': 'SEQ_SCAN ', 'timing': 2e-05, 'cardinality': 25, 'extra_info': 'nation\n[INFOSEPARATOR]\nn_nationkey\nn_name\n[INFOSEPARATOR]\nEC: 25', 'children': []}]}]}]}]}]}]}]}]}]}]}]}]}
Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│__internal_decompress_strin│                                                                                                                                                 
│           g(#0)           │                                                                                                                                                 
│__internal_decompress_integ│                                                                                                                                                 
│    ral_bigint(#1, 1992)   │                                                                                                                                                 
│             #2            │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│          ORDER_BY         │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│          ORDERS:          │                                                                                                                                                 
│     profit.nation ASC     │                                                                                                                                                 
│     profit.o_year DESC    │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│__internal_compress_string_│                                                                                                                                                 
│        hugeint(#0)        │                                                                                                                                                 
│__internal_compress_integra│                                                                                                                                                 
│    l_utinyint(#1, 1992)   │                                                                                                                                                 
│             #2            │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│__internal_decompress_strin│                                                                                                                                                 
│           g(#0)           │                                                                                                                                                 
│__internal_decompress_integ│                                                                                                                                                 
│    ral_bigint(#1, 1992)   │                                                                                                                                                 
│             #2            │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│       HASH_GROUP_BY       │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│             #0            │                                                                                                                                                 
│             #1            │                                                                                                                                                 
│          sum(#2)          │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│           nation          │                                                                                                                                                 
│           o_year          │                                                                                                                                                 
│           amount          │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│__internal_compress_string_│                                                                                                                                                 
│        hugeint(#0)        │                                                                                                                                                 
│__internal_compress_integra│                                                                                                                                                 
│    l_utinyint(#1, 1992)   │                                                                                                                                                 
│             #2            │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│           nation          │                                                                                                                                                 
│     year(o_orderdate)     │                                                                                                                                                 
│           amount          │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         HASH_JOIN         │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│           INNER           │                                                                                                                                                 
│  o_orderkey = l_orderkey  ├──────────────┐                                                                                                                                  
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                                                                                                                  
│        EC: 1191610        │              │                                                                                                                                  
└─────────────┬─────────────┘              │                                                                                                                                                               
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                                                    
│         SEQ_SCAN          ││         HASH_JOIN         │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│           orders          ││           INNER           │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   l_suppkey = ps_suppkey  │                                                                                                                    
│         o_orderkey        ││   l_partkey = ps_partkey  ├──────────────┐                                                                                                     
│        o_orderdate        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                                                                                     
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││        EC: 1191610        │              │                                                                                                     
│        EC: 1500000        ││                           │              │                                                                                                     
└───────────────────────────┘└─────────────┬─────────────┘              │                                                                                                                                  
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                       
                             │         SEQ_SCAN          ││         HASH_JOIN         │                                                                                       
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
                             │          lineitem         ││           INNER           │                                                                                       
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ps_suppkey = s_suppkey  │                                                                                       
                             │         l_suppkey         ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
                             │         l_partkey         ││        Build Min: 1       │                                                                                       
                             │         l_orderkey        ││      Build Max: 10000     ├───────────────────────────────────────────┐                                           
                             │      l_extendedprice      ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                           │                                           
                             │         l_discount        ││         EC: 74312         │                                           │                                           
                             │         l_quantity        ││                           │                                           │                                           
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                           │                                           
                             │        EC: 6001215        ││                           │                                           │                                           
                             └───────────────────────────┘└─────────────┬─────────────┘                                           │                                                                        
                                                          ┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐                             
                                                          │         HASH_JOIN         │                             │         HASH_JOIN         │                             
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                                                          │           INNER           │                             │           INNER           │                             
                                                          │   ps_partkey = p_partkey  │                             │ s_nationkey = n_nationkey │                             
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐              │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐              
                                                          │        Build Min: 1       │              │              │        Build Min: 0       │              │              
                                                          │     Build Max: 200000     │              │              │       Build Max: 24       │              │              
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              
                                                          │         EC: 85503         │              │              │         EC: 10000         │              │              
                                                          └─────────────┬─────────────┘              │              └─────────────┬─────────────┘              │                                           
                                                          ┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐
                                                          │         SEQ_SCAN          ││           FILTER          ││         SEQ_SCAN          ││         SEQ_SCAN          │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │          partsupp         ││ contains(p_name, 'green') ││          supplier         ││           nation          │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │         ps_suppkey        ││         EC: 40000         ││         s_suppkey         ││        n_nationkey        │
                                                          │         ps_partkey        ││                           ││        s_nationkey        ││           n_name          │
                                                          │       ps_supplycost       ││                           ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           ││         EC: 10000         ││           EC: 25          │
                                                          │         EC: 800000        ││                           ││                           ││                           │
                                                          └───────────────────────────┘└─────────────┬─────────────┘└───────────────────────────┘└───────────────────────────┘                             
                                                                                       ┌─────────────┴─────────────┐                                                          
                                                                                       │         SEQ_SCAN          │                                                          
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                                                       │            part           │                                                          
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                                                       │         p_partkey         │                                                          
                                                                                       │           p_name          │                                                          
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                                                       │         EC: 40000         │                                                          
                                                                                       └───────────────────────────┘                                                                                       

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

X {'RESULT_COLLECTOR0': 5e-06, 'PROJECTION1': 2e-06, 'ORDER_BY2': 3.2e-05, 'PROJECTION3': 2e-06, 'PROJECTION4': 1.8e-05, 'PROJECTION5': 3e-06, 'PERFECT_HASH_GROUP_BY6': 6.2e-05, 'PROJECTION7': 4.8e-05, 'PROJECTION8': 1.5e-05, 'PROJECTION9': 7.2e-05, 'HASH_JOIN10': 0.000181, 'HASH_JOIN11': 0.000684, 'SEQ_SCAN 12': 4.4e-05, 'HASH_JOIN13': 0.00079, 'HASH_JOIN14': 0.005442, 'SEQ_SCAN 15': 0.001063, 'HASH_JOIN16': 0.024607, 'SEQ_SCAN 17': 0.018436, 'HASH_JOIN18': 0.053906, 'SEQ_SCAN 19': 0.01918, 'SEQ_SCAN 20': 0.004288, 'HASH_JOIN21': 3.6e-05, 'SEQ_SCAN 22': 1.2e-05, 'SEQ_SCAN 23': 1.9e-05, 'SEQ_SCAN 24': 2e-05}
Physical operator output, input_left, input_right: 
**** output size:  2
LINEAGE_5_HASH_JOIN_10
LINEAGE_5_HASH_JOIN_11
LINEAGE_5_HASH_JOIN_12
LINEAGE_5_HASH_JOIN_14
LINEAGE_5_HASH_JOIN_5
LINEAGE_5_HASH_JOIN_6
LINEAGE_5_HASH_JOIN_7
LINEAGE_5_ORDER_BY_22
LINEAGE_5_PERFECT_HASH_GROUP_BY_18
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_1
LINEAGE_5_SEQ_SCAN_13
LINEAGE_5_SEQ_SCAN_2
LINEAGE_5_SEQ_SCAN_3
LINEAGE_5_SEQ_SCAN_4
LINEAGE_5_SEQ_SCAN_8
LINEAGE_5_SEQ_SCAN_9
SELECT o_year, sum( CASE WHEN nation = 'BRAZIL' THEN volume ELSE 0 END) / sum(volume) AS mkt_share FROM ( SELECT extract(year FROM o_orderdate) AS o_year, l_extendedprice * (1 - l_discount) AS volume, n2.n_name AS nation FROM part, supplier, lineitem, orders, customer, nation n1, nation n2, region WHERE p_partkey = l_partkey AND s_suppkey = l_suppkey AND l_orderkey = o_orderkey AND o_custkey = c_custkey AND c_nationkey = n1.n_nationkey AND n1.n_regionkey = r_regionkey AND r_name = 'AMERICA' AND s_nationkey = n2.n_nationkey AND o_orderdate BETWEEN CAST('1995-01-01' AS date) AND CAST('1996-12-31' AS date) AND p_type = 'ECONOMY ANODIZED STEEL') AS all_nations GROUP BY o_year ORDER BY o_year;
   query_id  ...                                               plan
0         5  ...  {"name": "PROJECTION", "opid": "23", "children...

[1 rows x 8 columns]
Query info:  query_id                                                            5
query               SELECT o_year, sum( CASE WHEN nation = 'BRAZIL...
size_bytes_max                                                1011478
physical_op_size    [1960, 0, 64, 0, 0, 0, 3604, 0, 0, 0, 3968, 17...
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "PROJECTION", "opid": "23", "children...
Name: 0, dtype: object
physical op size is:
{"name": "PROJECTION", "opid": "23", "children": [{"name": "ORDER_BY", "opid": "22", "children": [{"name": "PROJECTION", "opid": "21", "children": [{"name": "PROJECTION", "opid": "20", "children": [{"name": "PROJECTION", "opid": "19", "children": [{"name": "PERFECT_HASH_GROUP_BY", "opid": "18", "children": [{"name": "PROJECTION", "opid": "17", "children": [{"name": "PROJECTION", "opid": "16", "children": [{"name": "PROJECTION", "opid": "15", "children": [{"name": "HASH_JOIN", "opid": "14", "children": [{"name": "HASH_JOIN", "opid": "12", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "supplier","extra": "supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\n[INFOSEPARATOR]\nEC: 10000"},{"name": "HASH_JOIN", "opid": "11", "children": [{"name": "HASH_JOIN", "opid": "7", "children": [{"name": "SEQ_SCAN ", "opid": "1", "children": [],"table": "customer","extra": "customer\n[INFOSEPARATOR]\nc_custkey\nc_nationkey\n[INFOSEPARATOR]\nFilters: c_custkey<=149999 AND c_custkey IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 150000"},{"name": "HASH_JOIN", "opid": "6", "children": [{"name": "SEQ_SCAN ", "opid": "2", "children": [],"table": "orders","extra": "orders\n[INFOSEPARATOR]\no_orderkey\no_custkey\no_orderdate\n[INFOSEPARATOR]\nFilters: o_orderdate>='1995-01-01'::DATE AND o_orderdate<='1996-12-31'::DATE AND o_orderdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 300000"},{"name": "HASH_JOIN", "opid": "5", "children": [{"name": "SEQ_SCAN ", "opid": "3", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_partkey\nl_suppkey\nl_orderkey\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nEC: 6001215"},{"name": "SEQ_SCAN ", "opid": "4", "children": [],"table": "part","extra": "part\n[INFOSEPARATOR]\np_partkey\n[INFOSEPARATOR]\nFilters: p_type='ECONOMY ANODIZED STEEL' AND p_type IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1325"}],"table": "","extra": "INNER\nl_partkey = p_partkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 21246\n"}],"table": "","extra": "INNER\no_orderkey = l_orderkey\n\n[INFOSEPARATOR]\nEC: 4249\n"}],"table": "","extra": "INNER\nc_custkey = o_custkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 149999\n\n[INFOSEPARATOR]\nEC: 2562\n"},{"name": "HASH_JOIN", "opid": "10", "children": [{"name": "SEQ_SCAN ", "opid": "8", "children": [],"table": "nation","extra": "nation\n[INFOSEPARATOR]\nn_nationkey\nn_regionkey\n[INFOSEPARATOR]\nEC: 25"},{"name": "SEQ_SCAN ", "opid": "9", "children": [],"table": "region","extra": "region\n[INFOSEPARATOR]\nr_regionkey\n[INFOSEPARATOR]\nFilters: r_name='AMERICA' AND r_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1"}],"table": "","extra": "INNER\nn_regionkey = r_regionkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 4\n\n[INFOSEPARATOR]\nEC: 5\n"}],"table": "","extra": "INNER\nc_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 512\n"}],"table": "","extra": "INNER\ns_suppkey = l_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 508\n"},{"name": "SEQ_SCAN ", "opid": "13", "children": [],"table": "nation","extra": "nation\n[INFOSEPARATOR]\nn_nationkey\nn_name\n[INFOSEPARATOR]\nEC: 25"}],"table": "","extra": "INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 508\n"}],"table": "","extra": "year(o_orderdate)\nvolume\nnation\n"}],"table": "","extra": "__internal_compress_integral_utinyint(#0, 1992)\n#1\n#2\n"}],"table": "","extra": "o_year\nCASE  WHEN ((nation = 'BRAZIL')) THEN (volume) ELSE 0.0000 END\nvolume\n"}],"table": "","extra": "#0\nsum(#1)\nsum(#2)"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1992)\n#1\n#2\n"}],"table": "","extra": "o_year\nmkt_share\n"}],"table": "","extra": "__internal_compress_integral_utinyint(#0, 1992)\n#1\n"}],"table": "","extra": "ORDERS:\nall_nations.o_year ASC"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1992)\n#1\n"}
%%%%%%%%%%%%%%%% Running Query #  9  threads:  1
SELECT nation, o_year, sum(amount) AS sum_profit FROM ( SELECT n_name AS nation, extract(year FROM o_orderdate) AS o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity AS amount FROM part, supplier, lineitem, partsupp, orders, nation WHERE s_suppkey = l_suppkey AND ps_suppkey = l_suppkey AND ps_partkey = l_partkey AND p_partkey = l_partkey AND o_orderkey = l_orderkey AND s_nationkey = n_nationkey AND p_name LIKE '%green%') AS profit GROUP BY nation, o_year ORDER BY nation, o_year DESC;
Run:  None SELECT nation, o_year, sum(amount) AS sum_profit FROM ( SELECT n_name AS nation, extract(year FROM o_orderdate) AS o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity AS amount FROM part, supplier, lineitem, partsupp, orders, nation WHERE s_suppkey = l_suppkey AND ps_suppkey = l_suppkey AND ps_partkey = l_partkey AND p_partkey = l_partkey AND o_orderkey = l_orderkey AND s_nationkey = n_nationkey AND p_name LIKE '%green%') AS profit GROUP BY nation, o_year ORDER BY nation, o_year DESC;
Avg Time in sec:  0.5156128173694015  output size:  175
      nation  o_year    sum_profit
0    ALGERIA    1998  2.713690e+07
1    ALGERIA    1997  4.861183e+07
2    ALGERIA    1996  4.828548e+07
3    ALGERIA    1995  4.440227e+07
4    ALGERIA    1994  4.869401e+07
..       ...     ...           ...
170  VIETNAM    1996  4.782460e+07
171  VIETNAM    1995  4.823514e+07
172  VIETNAM    1994  4.772926e+07
173  VIETNAM    1993  4.535268e+07
174  VIETNAM    1992  4.784636e+07

[175 rows x 3 columns]
{'name': 'Query', 'result': 0.500478, 'timing': 0.500478, 'cardinality': 0, 'extra-info': "SELECT nation, o_year, sum(amount) AS sum_profit FROM ( SELECT n_name AS nation, extract(year FROM o_orderdate) AS o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity AS amount FROM part, supplier, lineitem, partsupp, orders, nation WHERE s_suppkey = l_suppkey AND ps_suppkey = l_suppkey AND ps_partkey = l_partkey AND p_partkey = l_partkey AND o_orderkey = l_orderkey AND s_nationkey = n_nationkey AND p_name LIKE '%green%') AS profit GROUP BY nation, o_year ORDER BY nation, o_year DESC;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 9e-06, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 7e-06, 'cardinality': 175, 'extra_info': '__internal_decompress_string(#0)\n__internal_decompress_integral_bigint(#1, 1992)\n#2\n', 'children': [{'name': 'ORDER_BY', 'timing': 4.8e-05, 'cardinality': 175, 'extra_info': 'ORDERS:\nprofit.nation ASC\nprofit.o_year DESC', 'children': [{'name': 'PROJECTION', 'timing': 5e-06, 'cardinality': 175, 'extra_info': '__internal_compress_string_hugeint(#0)\n__internal_compress_integral_utinyint(#1, 1992)\n#2\n', 'children': [{'name': 'PROJECTION', 'timing': 1.2e-05, 'cardinality': 175, 'extra_info': '__internal_decompress_string(#0)\n__internal_decompress_integral_bigint(#1, 1992)\n#2\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.016722, 'cardinality': 175, 'extra_info': '#0\n#1\nsum(#2)', 'children': [{'name': 'PROJECTION', 'timing': 0.000506, 'cardinality': 319404, 'extra_info': 'nation\no_year\namount\n', 'children': [{'name': 'PROJECTION', 'timing': 0.005248, 'cardinality': 319404, 'extra_info': '__internal_compress_string_hugeint(#0)\n__internal_compress_integral_utinyint(#1, 1992)\n#2\n', 'children': [{'name': 'PROJECTION', 'timing': 0.010914, 'cardinality': 319404, 'extra_info': 'nation\nyear(o_orderdate)\namount\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.174089, 'cardinality': 319404, 'extra_info': 'INNER\no_orderkey = l_orderkey\n\n[INFOSEPARATOR]\nEC: 1191610\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.003558, 'cardinality': 1500000, 'extra_info': 'orders\n[INFOSEPARATOR]\no_orderkey\no_orderdate\n[INFOSEPARATOR]\nEC: 1500000', 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.203608, 'cardinality': 319404, 'extra_info': 'INNER\nl_suppkey = ps_suppkey\nl_partkey = ps_partkey\n\n[INFOSEPARATOR]\nEC: 1191610\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.021479, 'cardinality': 6001215, 'extra_info': 'lineitem\n[INFOSEPARATOR]\nl_suppkey\nl_partkey\nl_orderkey\nl_extendedprice\nl_discount\nl_quantity\n[INFOSEPARATOR]\nEC: 6001215', 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.003144, 'cardinality': 42656, 'extra_info': 'INNER\nps_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 74312\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.005717, 'cardinality': 42656, 'extra_info': 'INNER\nps_partkey = p_partkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 85503\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.001754, 'cardinality': 800000, 'extra_info': 'partsupp\n[INFOSEPARATOR]\nps_suppkey\nps_partkey\nps_supplycost\n[INFOSEPARATOR]\nEC: 800000', 'children': []}, {'name': 'FILTER', 'timing': 0.006643, 'cardinality': 10664, 'extra_info': "contains(p_name, 'green')\n[INFOSEPARATOR]\nEC: 40000", 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.006198, 'cardinality': 200000, 'extra_info': 'part\n[INFOSEPARATOR]\np_partkey\np_name\n[INFOSEPARATOR]\nEC: 40000', 'children': []}]}]}, {'name': 'HASH_JOIN', 'timing': 0.000208, 'cardinality': 10000, 'extra_info': 'INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 10000\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 3.6e-05, 'cardinality': 10000, 'extra_info': 'supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\n[INFOSEPARATOR]\nEC: 10000', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 1.7e-05, 'cardinality': 25, 'extra_info': 'nation\n[INFOSEPARATOR]\nn_nationkey\nn_name\n[INFOSEPARATOR]\nEC: 25', 'children': []}]}]}]}]}]}]}]}]}]}]}]}]}]}]}
Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                                                                                       
│      STREAMING_LIMIT      │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│__internal_decompress_integ│                                                                                       
│     ral_bigint(#0, 1)     │                                                                                       
│             #1            │                                                                                       
│             #2            │                                                                                       
│             #3            │                                                                                       
│__internal_decompress_strin│                                                                                       
│           g(#4)           │                                                                                       
│             #5            │                                                                                       
│__internal_decompress_strin│                                                                                       
│           g(#6)           │                                                                                       
│             #7            │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│          ORDER_BY         │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│          ORDERS:          │                                                                                       
│       sum((lineitem       │                                                                                       
│.l_extendedprice * (1 ...  │                                                                                       
│    .l_discount))) DESC    │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│__internal_compress_integra│                                                                                       
│     l_uinteger(#0, 1)     │                                                                                       
│             #1            │                                                                                       
│             #2            │                                                                                       
│             #3            │                                                                                       
│__internal_compress_string_│                                                                                       
│        hugeint(#4)        │                                                                                       
│             #5            │                                                                                       
│__internal_compress_string_│                                                                                       
│        hugeint(#6)        │                                                                                       
│             #7            │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│         c_custkey         │                                                                                       
│           c_name          │                                                                                       
│          revenue          │                                                                                       
│         c_acctbal         │                                                                                       
│           n_name          │                                                                                       
│         c_address         │                                                                                       
│          c_phone          │                                                                                       
│         c_comment         │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│__internal_decompress_integ│                                                                                       
│     ral_bigint(#0, 1)     │                                                                                       
│             #1            │                                                                                       
│             #2            │                                                                                       
│__internal_decompress_strin│                                                                                       
│           g(#3)           │                                                                                       
│__internal_decompress_strin│                                                                                       
│           g(#4)           │                                                                                       
│             #5            │                                                                                       
│             #6            │                                                                                       
│             #7            │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│       HASH_GROUP_BY       │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│             #0            │                                                                                       
│             #1            │                                                                                       
│             #2            │                                                                                       
│             #3            │                                                                                       
│             #4            │                                                                                       
│             #5            │                                                                                       
│             #6            │                                                                                       
│          sum(#7)          │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│         c_custkey         │                                                                                       
│           c_name          │                                                                                       
│         c_acctbal         │                                                                                       
│          c_phone          │                                                                                       
│           n_name          │                                                                                       
│         c_address         │                                                                                       
│         c_comment         │                                                                                       
│ (l_extendedprice * (1.00 -│                                                                                       
│        l_discount))       │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│__internal_compress_integra│                                                                                       
│     l_uinteger(#0, 1)     │                                                                                       
│             #1            │                                                                                       
│             #2            │                                                                                       
│__internal_compress_integra│                                                                                       
│     l_uinteger(#3, 1)     │                                                                                       
│__internal_compress_integra│                                                                                       
│     l_uinteger(#4, 1)     │                                                                                       
│             #5            │                                                                                       
│             #6            │                                                                                       
│__internal_compress_string_│                                                                                       
│        hugeint(#7)        │                                                                                       
│             #8            │                                                                                       
│             #9            │                                                                                       
│__internal_compress_string_│                                                                                       
│        hugeint(#10)       │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         HASH_JOIN         │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│           INNER           │                                                                                       
│  l_orderkey = o_orderkey  ├──────────────┐                                                                        
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                                                        
│         EC: 241245        │              │                                                                        
└─────────────┬─────────────┘              │                                                                                                     
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                          
│         SEQ_SCAN          ││         HASH_JOIN         │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│          lineitem         ││           INNER           │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   o_custkey = c_custkey   │                                                          
│         l_orderkey        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│      l_extendedprice      ││        Build Min: 1       │                                                          
│         l_discount        ││     Build Max: 149999     ├──────────────┐                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                           
│ Filters: l_returnflag='R' ││         EC: 180897        │              │                                           
│ AND l_returnflag IS N...  ││                           │              │                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │              │                                           
│        EC: 2000405        ││                           │              │                                           
└───────────────────────────┘└─────────────┬─────────────┘              │                                                                        
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             
                             │         SEQ_SCAN          ││         HASH_JOIN         │                             
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                             │           orders          ││           INNER           │                             
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││ c_nationkey = n_nationkey │                             
                             │         o_custkey         ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                             │         o_orderkey        ││         EC: 150000        │                             
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           ├──────────────┐              
                             │Filters: o_orderdate>='1993││                           │              │              
                             │     -10-01'::DATE AND     ││                           │              │              
                             │ o_orderdate<'1994-01-...  ││                           │              │              
                             │   o_orderdate IS NOT NULL ││                           │              │              
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │              │              
                             │         EC: 300000        ││                           │              │              
                             └───────────────────────────┘└─────────────┬─────────────┘              │                                           
                                                          ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
                                                          │         SEQ_SCAN          ││         SEQ_SCAN          │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │          customer         ││           nation          │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │         c_custkey         ││        n_nationkey        │
                                                          │        c_nationkey        ││           n_name          │
                                                          │           c_name          ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │         c_acctbal         ││           EC: 25          │
                                                          │          c_phone          ││                           │
                                                          │         c_address         ││                           │
                                                          │         c_comment         ││                           │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │
                                                          │ Filters: c_custkey<=149999││                           │
                                                          │  AND c_custkey IS NOT NULL││                           │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │
                                                          │         EC: 150000        ││                           │
                                                          └───────────────────────────┘└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

X {'RESULT_COLLECTOR0': 9e-06, 'PROJECTION1': 7e-06, 'ORDER_BY2': 4.8e-05, 'PROJECTION3': 5e-06, 'PROJECTION4': 1.2e-05, 'HASH_GROUP_BY5': 0.016722, 'PROJECTION6': 0.000506, 'PROJECTION7': 0.005248, 'PROJECTION8': 0.010914, 'HASH_JOIN9': 0.174089, 'SEQ_SCAN 10': 0.003558, 'HASH_JOIN11': 0.203608, 'SEQ_SCAN 12': 0.021479, 'HASH_JOIN13': 0.003144, 'HASH_JOIN14': 0.005717, 'SEQ_SCAN 15': 0.001754, 'FILTER16': 0.006643, 'SEQ_SCAN 17': 0.006198, 'HASH_JOIN18': 0.000208, 'SEQ_SCAN 19': 3.6e-05, 'SEQ_SCAN 20': 1.7e-05}
Physical operator output, input_left, input_right: 
**** output size:  175
LINEAGE_5_FILTER_4
LINEAGE_5_HASH_GROUP_BY_15
LINEAGE_5_HASH_JOIN_10
LINEAGE_5_HASH_JOIN_11
LINEAGE_5_HASH_JOIN_5
LINEAGE_5_HASH_JOIN_8
LINEAGE_5_HASH_JOIN_9
LINEAGE_5_ORDER_BY_18
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_1
LINEAGE_5_SEQ_SCAN_2
LINEAGE_5_SEQ_SCAN_3
LINEAGE_5_SEQ_SCAN_6
LINEAGE_5_SEQ_SCAN_7
SELECT nation, o_year, sum(amount) AS sum_profit FROM ( SELECT n_name AS nation, extract(year FROM o_orderdate) AS o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity AS amount FROM part, supplier, lineitem, partsupp, orders, nation WHERE s_suppkey = l_suppkey AND ps_suppkey = l_suppkey AND ps_partkey = l_partkey AND p_partkey = l_partkey AND o_orderkey = l_orderkey AND s_nationkey = n_nationkey AND p_name LIKE '%green%') AS profit GROUP BY nation, o_year ORDER BY nation, o_year DESC;
   query_id  ...                                               plan
0         5  ...  {"name": "PROJECTION", "opid": "19", "children...

[1 rows x 8 columns]
Query info:  query_id                                                            5
query               SELECT nation, o_year, sum(amount) AS sum_prof...
size_bytes_max                                                6918971
physical_op_size    [21654, 0, 271, 0, 0, 714402, 0, 0, 0, 3219383...
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "PROJECTION", "opid": "19", "children...
Name: 0, dtype: object
physical op size is:
{"name": "PROJECTION", "opid": "19", "children": [{"name": "ORDER_BY", "opid": "18", "children": [{"name": "PROJECTION", "opid": "17", "children": [{"name": "PROJECTION", "opid": "16", "children": [{"name": "HASH_GROUP_BY", "opid": "15", "children": [{"name": "PROJECTION", "opid": "14", "children": [{"name": "PROJECTION", "opid": "13", "children": [{"name": "PROJECTION", "opid": "12", "children": [{"name": "HASH_JOIN", "opid": "11", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "orders","extra": "orders\n[INFOSEPARATOR]\no_orderkey\no_orderdate\n[INFOSEPARATOR]\nEC: 1500000"},{"name": "HASH_JOIN", "opid": "10", "children": [{"name": "SEQ_SCAN ", "opid": "1", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_suppkey\nl_partkey\nl_orderkey\nl_extendedprice\nl_discount\nl_quantity\n[INFOSEPARATOR]\nEC: 6001215"},{"name": "HASH_JOIN", "opid": "9", "children": [{"name": "HASH_JOIN", "opid": "5", "children": [{"name": "SEQ_SCAN ", "opid": "2", "children": [],"table": "partsupp","extra": "partsupp\n[INFOSEPARATOR]\nps_suppkey\nps_partkey\nps_supplycost\n[INFOSEPARATOR]\nEC: 800000"},{"name": "FILTER", "opid": "4", "children": [{"name": "SEQ_SCAN ", "opid": "3", "children": [],"table": "part","extra": "part\n[INFOSEPARATOR]\np_partkey\np_name\n[INFOSEPARATOR]\nEC: 40000"}],"table": "","extra": "contains(p_name, 'green')\n[INFOSEPARATOR]\nEC: 40000"}],"table": "","extra": "INNER\nps_partkey = p_partkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 85503\n"},{"name": "HASH_JOIN", "opid": "8", "children": [{"name": "SEQ_SCAN ", "opid": "6", "children": [],"table": "supplier","extra": "supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\n[INFOSEPARATOR]\nEC: 10000"},{"name": "SEQ_SCAN ", "opid": "7", "children": [],"table": "nation","extra": "nation\n[INFOSEPARATOR]\nn_nationkey\nn_name\n[INFOSEPARATOR]\nEC: 25"}],"table": "","extra": "INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 10000\n"}],"table": "","extra": "INNER\nps_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 74312\n"}],"table": "","extra": "INNER\nl_suppkey = ps_suppkey\nl_partkey = ps_partkey\n\n[INFOSEPARATOR]\nEC: 1191610\n"}],"table": "","extra": "INNER\no_orderkey = l_orderkey\n\n[INFOSEPARATOR]\nEC: 1191610\n"}],"table": "","extra": "nation\nyear(o_orderdate)\namount\n"}],"table": "","extra": "__internal_compress_string_hugeint(#0)\n__internal_compress_integral_utinyint(#1, 1992)\n#2\n"}],"table": "","extra": "nation\no_year\namount\n"}],"table": "","extra": "#0\n#1\nsum(#2)"}],"table": "","extra": "__internal_decompress_string(#0)\n__internal_decompress_integral_bigint(#1, 1992)\n#2\n"}],"table": "","extra": "__internal_compress_string_hugeint(#0)\n__internal_compress_integral_utinyint(#1, 1992)\n#2\n"}],"table": "","extra": "ORDERS:\nprofit.nation ASC\nprofit.o_year DESC"}],"table": "","extra": "__internal_decompress_string(#0)\n__internal_decompress_integral_bigint(#1, 1992)\n#2\n"}
%%%%%%%%%%%%%%%% Running Query #  10  threads:  1
SELECT c_custkey, c_name, sum(l_extendedprice * (1 - l_discount)) AS revenue, c_acctbal, n_name, c_address, c_phone, c_comment FROM customer, orders, lineitem, nation WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate >= CAST('1993-10-01' AS date) AND o_orderdate < CAST('1994-01-01' AS date) AND l_returnflag = 'R' AND c_nationkey = n_nationkey GROUP BY c_custkey, c_name, c_acctbal, c_phone, n_name, c_address, c_comment ORDER BY revenue DESC LIMIT 20;
Run:  None SELECT c_custkey, c_name, sum(l_extendedprice * (1 - l_discount)) AS revenue, c_acctbal, n_name, c_address, c_phone, c_comment FROM customer, orders, lineitem, nation WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate >= CAST('1993-10-01' AS date) AND o_orderdate < CAST('1994-01-01' AS date) AND l_returnflag = 'R' AND c_nationkey = n_nationkey GROUP BY c_custkey, c_name, c_acctbal, c_phone, n_name, c_address, c_comment ORDER BY revenue DESC LIMIT 20;
Avg Time in sec:  0.5185365546494722  output size:  20
    c_custkey  ...                                          c_comment
0       57040  ...  ep. blithely regular foxes promise slyly furio...
1      143347  ...  endencies sleep. slyly express deposits nag ca...
2       60838  ...   tes. final instructions nag quickly according to
3      101998  ...  ost carefully. slyly regular packages cajole a...
4      125341  ...  ly furiously brave packages. quickly regular d...
5       25501  ...  y ironic foxes hinder according to the furious...
6      115831  ...  unts nag carefully final packages. express the...
7       84223  ...  longside of the slyly final deposits. blithely...
8       54289  ...      cajole furiously after the quickly unusual fo
9       39922  ...  ironic deposits sublate furiously. carefully r...
10       6226  ...  nal packages are alongside of the quickly bold...
11        922  ...                cuses cajole carefully regular idea
12     147946  ...  ly pending platelets. ironic requests haggle a...
13     115640  ...             ffily ironic deposits. blithely specia
14      73606  ...                 uests cajole according to the foxe
15     110246  ...        ow carefully. blithely careful packages hag
16     142549  ...  . slyly bold packages nag quickly against the ...
17     146149  ...  nic, special instructions. multipliers run car...
18      52528  ...  olphins. blithely silent platelets affix caref...
19      23431  ...    the final sentiments. carefully ironic packages

[20 rows x 8 columns]
{'name': 'Query', 'result': 0.5116, 'timing': 0.5116, 'cardinality': 0, 'extra-info': "SELECT c_custkey, c_name, sum(l_extendedprice * (1 - l_discount)) AS revenue, c_acctbal, n_name, c_address, c_phone, c_comment FROM customer, orders, lineitem, nation WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate >= CAST('1993-10-01' AS date) AND o_orderdate < CAST('1994-01-01' AS date) AND l_returnflag = 'R' AND c_nationkey = n_nationkey GROUP BY c_custkey, c_name, c_acctbal, c_phone, n_name, c_address, c_comment ORDER BY revenue DESC LIMIT 20;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 3.4e-05, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'STREAMING_LIMIT', 'timing': 4e-06, 'cardinality': 20, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 0.000175, 'cardinality': 4096, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n#1\n#2\n#3\n__internal_decompress_string(#4)\n#5\n__internal_decompress_string(#6)\n#7\n', 'children': [{'name': 'ORDER_BY', 'timing': 0.004783, 'cardinality': 4096, 'extra_info': 'ORDERS:\nsum((lineitem.l_extendedprice * (1 - lineitem.l_discount))) DESC', 'children': [{'name': 'PROJECTION', 'timing': 0.00104, 'cardinality': 37967, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n#1\n#2\n#3\n__internal_compress_string_hugeint(#4)\n#5\n__internal_compress_string_hugeint(#6)\n#7\n', 'children': [{'name': 'PROJECTION', 'timing': 1.4e-05, 'cardinality': 37967, 'extra_info': 'c_custkey\nc_name\nrevenue\nc_acctbal\nn_name\nc_address\nc_phone\nc_comment\n', 'children': [{'name': 'PROJECTION', 'timing': 0.001179, 'cardinality': 37967, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n#1\n#2\n__internal_decompress_string(#3)\n__internal_decompress_string(#4)\n#5\n#6\n#7\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.029705, 'cardinality': 37967, 'extra_info': '#0\n#1\n#2\n#3\n#4\n#5\n#6\nsum(#7)', 'children': [{'name': 'PROJECTION', 'timing': 0.000449, 'cardinality': 114705, 'extra_info': 'c_custkey\nc_name\nc_acctbal\nc_phone\nn_name\nc_address\nc_comment\n(l_extendedprice * (1.00 - l_discount))\n', 'children': [{'name': 'PROJECTION', 'timing': 0.003778, 'cardinality': 114705, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n#1\n#2\n__internal_compress_integral_uinteger(#3, 1)\n__internal_compress_integral_uinteger(#4, 1)\n#5\n#6\n__internal_compress_string_hugeint(#7)\n#8\n#9\n__internal_compress_string_hugeint(#10)\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.173386, 'cardinality': 114705, 'extra_info': 'INNER\nl_orderkey = o_orderkey\n\n[INFOSEPARATOR]\nEC: 241245\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.158003, 'cardinality': 1478870, 'extra_info': "lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nFilters: l_returnflag='R' AND l_returnflag IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 2000405", 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.04045, 'cardinality': 57069, 'extra_info': 'INNER\no_custkey = c_custkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 149999\n\n[INFOSEPARATOR]\nEC: 180897\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.017176, 'cardinality': 57069, 'extra_info': "orders\n[INFOSEPARATOR]\no_custkey\no_orderkey\n[INFOSEPARATOR]\nFilters: o_orderdate>='1993-10-01'::DATE AND o_orderdate<'1994-01-01'::DATE AND o_orderdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 300000", 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.006225, 'cardinality': 149999, 'extra_info': 'INNER\nc_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nEC: 150000\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.015342, 'cardinality': 149999, 'extra_info': 'customer\n[INFOSEPARATOR]\nc_custkey\nc_nationkey\nc_name\nc_acctbal\nc_phone\nc_address\nc_comment\n[INFOSEPARATOR]\nFilters: c_custkey<=149999 AND c_custkey IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 150000', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 3e-05, 'cardinality': 25, 'extra_info': 'nation\n[INFOSEPARATOR]\nn_nationkey\nn_name\n[INFOSEPARATOR]\nEC: 25', 'children': []}]}]}]}]}]}]}]}]}]}]}]}]}]}]}
Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│__internal_decompress_integ│                                                                                                                                                 
│     ral_bigint(#0, 1)     │                                                                                                                                                 
│             #1            │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│          ORDER_BY         │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│          ORDERS:          │                                                                                                                                                 
│sum((partsupp.ps_supplycost│                                                                                                                                                 
│  * partsupp.ps_availqty)) │                                                                                                                                                 
│            DESC           │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│__internal_compress_integra│                                                                                                                                                 
│     l_uinteger(#0, 1)     │                                                                                                                                                 
│             #1            │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│         ps_partkey        │                                                                                                                                                 
│           value           │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│      NESTED_LOOP_JOIN     │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│           INNER           │                                                                                                                                                 
│       CAST(sum((CAST      │                                                                                                                                                 
│(ps_supplycost AS DECI...  │                                                                                                                                                 
│(ps_availqty AS DECIMA...  ├────────────────────────────────────────────────────────────────────────┐                                                                        
│ )))) AS DECIMAL(38,11)) > │                                                                        │                                                                        
│          SUBQUERY         │                                                                        │                                                                        
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                        │                                                                        
│           EC: 1           │                                                                        │                                                                        
└─────────────┬─────────────┘                                                                        │                                                                                                     
┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐                                                          
│         PROJECTION        │                                                          │    UNGROUPED_AGGREGATE    │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│__internal_decompress_integ│                                                          │         first(#0)         │                                                          
│     ral_bigint(#0, 1)     │                                                          │                           │                                                          
│             #1            │                                                          │                           │                                                          
└─────────────┬─────────────┘                                                          └─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐                                                          
│       HASH_GROUP_BY       │                                                          │         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│             #0            │                                                          │             #0            │                                                          
│          sum(#1)          │                                                          │                           │                                                          
└─────────────┬─────────────┘                                                          └─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐                                                          
│         PROJECTION        │                                                          │      STREAMING_LIMIT      │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │                           │                                                          
│         ps_partkey        │                                                          │                           │                                                          
│   (CAST(ps_supplycost AS  │                                                          │                           │                                                          
│    DECIMAL(34,2)) * CAST  │                                                          │                           │                                                          
│(ps_availqty AS DECIMA...  │                                                          │                           │                                                          
└─────────────┬─────────────┘                                                          └─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐                                                          
│         PROJECTION        │                                                          │         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│__internal_compress_integra│                                                          │(sum((CAST(ps_supplycost AS│                                                          
│     l_usmallint(#0, 1)    │                                                          │    DECIMAL(34,2)) * CAST  │                                                          
│__internal_compress_integra│                                                          │(ps_availqty AS DECIMA...  │                                                          
│     l_uinteger(#1, 1)     │                                                          │       * 0.000100000)      │                                                          
│             #2            │                                                          │                           │                                                          
│             #3            │                                                          │                           │                                                          
│__internal_compress_integra│                                                          │                           │                                                          
│     l_usmallint(#4, 1)    │                                                          │                           │                                                          
└─────────────┬─────────────┘                                                          └─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐                                                          
│         HASH_JOIN         │                                                          │    UNGROUPED_AGGREGATE    │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│           INNER           │                                                          │          sum(#0)          │                                                          
│   ps_suppkey = s_suppkey  │                                                          │                           │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐                                           │                           │                                                          
│        Build Min: 1       │              │                                           │                           │                                                          
│      Build Max: 10000     │              │                                           │                           │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                           │                           │                                                          
│         EC: 27811         │              │                                           │                           │                                                          
└─────────────┬─────────────┘              │                                           └─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐                                                          
│         SEQ_SCAN          ││         HASH_JOIN         │                             │         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│          partsupp         ││           INNER           │                             │   (CAST(ps_supplycost AS  │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││ s_nationkey = n_nationkey │                             │    DECIMAL(34,2)) * CAST  │                                                          
│         ps_suppkey        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │(ps_availqty AS DECIMA...  │                                                          
│         ps_partkey        ││        Build Min: 0       ├──────────────┐              │                           │                                                          
│       ps_supplycost       ││       Build Max: 24       │              │              │                           │                                                          
│        ps_availqty        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              │                           │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││          EC: 400          │              │              │                           │                                                          
│         EC: 800000        ││                           │              │              │                           │                                                          
└───────────────────────────┘└─────────────┬─────────────┘              │              └─────────────┬─────────────┘                                                                                       
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                          
                             │         SEQ_SCAN          ││         SEQ_SCAN          ││         HASH_JOIN         │                                                          
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                             │          supplier         ││           nation          ││           INNER           │                                                          
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ps_suppkey = s_suppkey  │                                                          
                             │         s_suppkey         ││        n_nationkey        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                             │        s_nationkey        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││        Build Min: 1       ├──────────────┐                                           
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││ Filters: n_name='GERMANY' ││      Build Max: 10000     │              │                                           
                             │         EC: 10000         ││   AND n_name IS NOT NULL  ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                           
                             │                           ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││         EC: 27811         │              │                                           
                             │                           ││           EC: 1           ││                           │              │                                           
                             └───────────────────────────┘└───────────────────────────┘└─────────────┬─────────────┘              │                                                                        
                                                                                       ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             
                                                                                       │         SEQ_SCAN          ││         HASH_JOIN         │                             
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                                                                                       │          partsupp         ││           INNER           │                             
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││ s_nationkey = n_nationkey │                             
                                                                                       │         ps_suppkey        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐              
                                                                                       │       ps_supplycost       ││        Build Min: 0       │              │              
                                                                                       │        ps_availqty        ││       Build Max: 24       │              │              
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              
                                                                                       │         EC: 800000        ││          EC: 400          │              │              
                                                                                       └───────────────────────────┘└─────────────┬─────────────┘              │                                           
                                                                                                                    ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
                                                                                                                    │         SEQ_SCAN          ││         SEQ_SCAN          │
                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                                                    │          supplier         ││           nation          │
                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                                                    │         s_suppkey         ││        n_nationkey        │
                                                                                                                    │        s_nationkey        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││ Filters: n_name='GERMANY' │
                                                                                                                    │         EC: 10000         ││   AND n_name IS NOT NULL  │
                                                                                                                    │                           ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                                                    │                           ││           EC: 1           │
                                                                                                                    └───────────────────────────┘└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

X {'RESULT_COLLECTOR0': 3.4e-05, 'STREAMING_LIMIT1': 4e-06, 'PROJECTION2': 0.000175, 'ORDER_BY3': 0.004783, 'PROJECTION4': 0.00104, 'PROJECTION5': 1.4e-05, 'PROJECTION6': 0.001179, 'HASH_GROUP_BY7': 0.029705, 'PROJECTION8': 0.000449, 'PROJECTION9': 0.003778, 'HASH_JOIN10': 0.173386, 'SEQ_SCAN 11': 0.158003, 'HASH_JOIN12': 0.04045, 'SEQ_SCAN 13': 0.017176, 'HASH_JOIN14': 0.006225, 'SEQ_SCAN 15': 0.015342, 'SEQ_SCAN 16': 3e-05}
Physical operator output, input_left, input_right: 
**** output size:  20
LINEAGE_5_HASH_GROUP_BY_9
LINEAGE_5_HASH_JOIN_4
LINEAGE_5_HASH_JOIN_5
LINEAGE_5_HASH_JOIN_6
LINEAGE_5_ORDER_BY_13
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_1
LINEAGE_5_SEQ_SCAN_2
LINEAGE_5_SEQ_SCAN_3
LINEAGE_5_STREAMING_LIMIT_15
SELECT c_custkey, c_name, sum(l_extendedprice * (1 - l_discount)) AS revenue, c_acctbal, n_name, c_address, c_phone, c_comment FROM customer, orders, lineitem, nation WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate >= CAST('1993-10-01' AS date) AND o_orderdate < CAST('1994-01-01' AS date) AND l_returnflag = 'R' AND c_nationkey = n_nationkey GROUP BY c_custkey, c_name, c_acctbal, c_phone, n_name, c_address, c_comment ORDER BY revenue DESC LIMIT 20;
   query_id  ...                                               plan
0         5  ...  {"name": "STREAMING_LIMIT", "opid": "15", "chi...

[1 rows x 8 columns]
Query info:  query_id                                                            5
query               SELECT c_custkey, c_name, sum(l_extendedprice ...
size_bytes_max                                                4327313
physical_op_size    [142439, 144, 0, 89704, 0, 0, 0, 379499, 0, 0,...
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "STREAMING_LIMIT", "opid": "15", "chi...
Name: 0, dtype: object
physical op size is:
{"name": "STREAMING_LIMIT", "opid": "15", "children": [{"name": "PROJECTION", "opid": "14", "children": [{"name": "ORDER_BY", "opid": "13", "children": [{"name": "PROJECTION", "opid": "12", "children": [{"name": "PROJECTION", "opid": "11", "children": [{"name": "PROJECTION", "opid": "10", "children": [{"name": "HASH_GROUP_BY", "opid": "9", "children": [{"name": "PROJECTION", "opid": "8", "children": [{"name": "PROJECTION", "opid": "7", "children": [{"name": "HASH_JOIN", "opid": "6", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nFilters: l_returnflag='R' AND l_returnflag IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 2000405"},{"name": "HASH_JOIN", "opid": "5", "children": [{"name": "SEQ_SCAN ", "opid": "1", "children": [],"table": "orders","extra": "orders\n[INFOSEPARATOR]\no_custkey\no_orderkey\n[INFOSEPARATOR]\nFilters: o_orderdate>='1993-10-01'::DATE AND o_orderdate<'1994-01-01'::DATE AND o_orderdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 300000"},{"name": "HASH_JOIN", "opid": "4", "children": [{"name": "SEQ_SCAN ", "opid": "2", "children": [],"table": "customer","extra": "customer\n[INFOSEPARATOR]\nc_custkey\nc_nationkey\nc_name\nc_acctbal\nc_phone\nc_address\nc_comment\n[INFOSEPARATOR]\nFilters: c_custkey<=149999 AND c_custkey IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 150000"},{"name": "SEQ_SCAN ", "opid": "3", "children": [],"table": "nation","extra": "nation\n[INFOSEPARATOR]\nn_nationkey\nn_name\n[INFOSEPARATOR]\nEC: 25"}],"table": "","extra": "INNER\nc_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nEC: 150000\n"}],"table": "","extra": "INNER\no_custkey = c_custkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 149999\n\n[INFOSEPARATOR]\nEC: 180897\n"}],"table": "","extra": "INNER\nl_orderkey = o_orderkey\n\n[INFOSEPARATOR]\nEC: 241245\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n#1\n#2\n__internal_compress_integral_uinteger(#3, 1)\n__internal_compress_integral_uinteger(#4, 1)\n#5\n#6\n__internal_compress_string_hugeint(#7)\n#8\n#9\n__internal_compress_string_hugeint(#10)\n"}],"table": "","extra": "c_custkey\nc_name\nc_acctbal\nc_phone\nn_name\nc_address\nc_comment\n(l_extendedprice * (1.00 - l_discount))\n"}],"table": "","extra": "#0\n#1\n#2\n#3\n#4\n#5\n#6\nsum(#7)"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n#1\n#2\n__internal_decompress_string(#3)\n__internal_decompress_string(#4)\n#5\n#6\n#7\n"}],"table": "","extra": "c_custkey\nc_name\nrevenue\nc_acctbal\nn_name\nc_address\nc_phone\nc_comment\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n#1\n#2\n#3\n__internal_compress_string_hugeint(#4)\n#5\n__internal_compress_string_hugeint(#6)\n#7\n"}],"table": "","extra": "ORDERS:\nsum((lineitem.l_extendedprice * (1 - lineitem.l_discount))) DESC"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n#1\n#2\n#3\n__internal_decompress_string(#4)\n#5\n__internal_decompress_string(#6)\n#7\n"}],"table": "","extra": ""}
%%%%%%%%%%%%%%%% Running Query #  11  threads:  1
SELECT ps_partkey, sum(ps_supplycost * ps_availqty) AS value FROM partsupp, supplier, nation WHERE ps_suppkey = s_suppkey AND s_nationkey = n_nationkey AND n_name = 'GERMANY' GROUP BY ps_partkey HAVING sum(ps_supplycost * ps_availqty) > ( SELECT sum(ps_supplycost * ps_availqty) * 0.000100000 FROM partsupp, supplier, nation WHERE ps_suppkey = s_suppkey AND s_nationkey = n_nationkey AND n_name = 'GERMANY') ORDER BY value DESC;
Run:  None SELECT ps_partkey, sum(ps_supplycost * ps_availqty) AS value FROM partsupp, supplier, nation WHERE ps_suppkey = s_suppkey AND s_nationkey = n_nationkey AND n_name = 'GERMANY' GROUP BY ps_partkey HAVING sum(ps_supplycost * ps_availqty) > ( SELECT sum(ps_supplycost * ps_availqty) * 0.000100000 FROM partsupp, supplier, nation WHERE ps_suppkey = s_suppkey AND s_nationkey = n_nationkey AND n_name = 'GERMANY') ORDER BY value DESC;
Avg Time in sec:  0.04547782614827156  output size:  1048
      ps_partkey        value
0         129760  17538456.86
1         166726  16503353.92
2         191287  16474801.97
3         161758  16101755.54
4          34452  15983844.72
...          ...          ...
1043      154731   7888301.33
1044      101674   7879324.60
1045       51968   7879102.21
1046       72073   7877736.11
1047        5182   7874521.73

[1048 rows x 2 columns]
{'name': 'Query', 'result': 0.041258, 'timing': 0.041258, 'cardinality': 0, 'extra-info': "SELECT ps_partkey, sum(ps_supplycost * ps_availqty) AS value FROM partsupp, supplier, nation WHERE ps_suppkey = s_suppkey AND s_nationkey = n_nationkey AND n_name = 'GERMANY' GROUP BY ps_partkey HAVING sum(ps_supplycost * ps_availqty) > ( SELECT sum(ps_supplycost * ps_availqty) * 0.000100000 FROM partsupp, supplier, nation WHERE ps_suppkey = s_suppkey AND s_nationkey = n_nationkey AND n_name = 'GERMANY') ORDER BY value DESC;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 7e-06, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 3e-06, 'cardinality': 1048, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n#1\n', 'children': [{'name': 'ORDER_BY', 'timing': 8.7e-05, 'cardinality': 1048, 'extra_info': 'ORDERS:\nsum((partsupp.ps_supplycost * partsupp.ps_availqty)) DESC', 'children': [{'name': 'PROJECTION', 'timing': 1.8e-05, 'cardinality': 1048, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n#1\n', 'children': [{'name': 'PROJECTION', 'timing': 6e-06, 'cardinality': 1048, 'extra_info': 'ps_partkey\nvalue\n', 'children': [{'name': 'NESTED_LOOP_JOIN', 'timing': 0.000973, 'cardinality': 1048, 'extra_info': 'INNER\nCAST(sum((CAST(ps_supplycost AS DECIMAL(34,2)) * CAST(ps_availqty AS DECIMAL(34,0)))) AS DECIMAL(38,11)) > SUBQUERY\n\n[INFOSEPARATOR]\nEC: 1\n', 'children': [{'name': 'PROJECTION', 'timing': 2.9e-05, 'cardinality': 29818, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n#1\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.00442, 'cardinality': 29818, 'extra_info': '#0\nsum(#1)', 'children': [{'name': 'PROJECTION', 'timing': 0.005408, 'cardinality': 31680, 'extra_info': 'ps_partkey\n(CAST(ps_supplycost AS DECIMAL(34,2)) * CAST(ps_availqty AS DECIMAL(34,0)))\n', 'children': [{'name': 'PROJECTION', 'timing': 0.00281, 'cardinality': 31680, 'extra_info': '__internal_compress_integral_usmallint(#0, 1)\n__internal_compress_integral_uinteger(#1, 1)\n#2\n#3\n__internal_compress_integral_usmallint(#4, 1)\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.00455, 'cardinality': 31680, 'extra_info': 'INNER\nps_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 27811\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.002121, 'cardinality': 800000, 'extra_info': 'partsupp\n[INFOSEPARATOR]\nps_suppkey\nps_partkey\nps_supplycost\nps_availqty\n[INFOSEPARATOR]\nEC: 800000', 'children': []}, {'name': 'HASH_JOIN', 'timing': 6.9e-05, 'cardinality': 396, 'extra_info': 'INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 400\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 3.3e-05, 'cardinality': 10000, 'extra_info': 'supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\n[INFOSEPARATOR]\nEC: 10000', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 1.1e-05, 'cardinality': 1, 'extra_info': "nation\n[INFOSEPARATOR]\nn_nationkey\n[INFOSEPARATOR]\nFilters: n_name='GERMANY' AND n_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1", 'children': []}]}]}]}]}]}]}, {'name': 'UNGROUPED_AGGREGATE', 'timing': 5e-06, 'cardinality': 1, 'extra_info': 'first(#0)', 'children': [{'name': 'PROJECTION', 'timing': 0.0, 'cardinality': 1, 'extra_info': '#0\n', 'children': [{'name': 'STREAMING_LIMIT', 'timing': 2e-06, 'cardinality': 1, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 3e-06, 'cardinality': 1, 'extra_info': '(sum((CAST(ps_supplycost AS DECIMAL(34,2)) * CAST(ps_availqty AS DECIMAL(34,0)))) * 0.000100000)\n', 'children': [{'name': 'UNGROUPED_AGGREGATE', 'timing': 0.000556, 'cardinality': 1, 'extra_info': 'sum(#0)', 'children': [{'name': 'PROJECTION', 'timing': 0.007482, 'cardinality': 31680, 'extra_info': '(CAST(ps_supplycost AS DECIMAL(34,2)) * CAST(ps_availqty AS DECIMAL(34,0)))\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.005521, 'cardinality': 31680, 'extra_info': 'INNER\nps_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 27811\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.002156, 'cardinality': 800000, 'extra_info': 'partsupp\n[INFOSEPARATOR]\nps_suppkey\nps_supplycost\nps_availqty\n[INFOSEPARATOR]\nEC: 800000', 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.0001, 'cardinality': 396, 'extra_info': 'INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 400\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 5.1e-05, 'cardinality': 10000, 'extra_info': 'supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\n[INFOSEPARATOR]\nEC: 10000', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 3.1e-05, 'cardinality': 1, 'extra_info': "nation\n[INFOSEPARATOR]\nn_nationkey\n[INFOSEPARATOR]\nFilters: n_name='GERMANY' AND n_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1", 'children': []}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}
Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│__internal_decompress_strin│                             
│           g(#0)           │                             
│             #1            │                             
│             #2            │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│          ORDER_BY         │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│          ORDERS:          │                             
│  lineitem.l_shipmode ASC  │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│__internal_compress_string_│                             
│        ubigint(#0)        │                             
│             #1            │                             
│             #2            │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│__internal_decompress_strin│                             
│           g(#0)           │                             
│             #1            │                             
│             #2            │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│       HASH_GROUP_BY       │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│             #0            │                             
│          sum(#1)          │                             
│          sum(#2)          │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│         l_shipmode        │                             
│       CASE  WHEN ((       │                             
│(o_orderpriority = '1-...  │                             
│(o_orderpriority = '2-...  │                             
│     THEN (1) ELSE 0 END   │                             
│       CASE  WHEN ((       │                             
│(o_orderpriority != '1...  │                             
│(o_orderpriority != '2...  │                             
│     THEN (1) ELSE 0 END   │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│__internal_compress_integra│                             
│     l_uinteger(#0, 1)     │                             
│             #1            │                             
│__internal_compress_integra│                             
│     l_uinteger(#2, 1)     │                             
│__internal_compress_string_│                             
│        ubigint(#3)        │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         HASH_JOIN         │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│           INNER           │                             
│  o_orderkey = l_orderkey  ├──────────────┐              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              
│         EC: 240048        │              │              
└─────────────┬─────────────┘              │                                           
┌─────────────┴─────────────┐┌─────────────┴─────────────┐
│         SEQ_SCAN          ││           FILTER          │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│           orders          ││      ((l_commitdate <     │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││ l_receiptdate) AND (l...  │
│         o_orderkey        ││ l_commitdate) AND ((l...  │
│      o_orderpriority      ││= 'MAIL') OR (l_shipmode = │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││         'SHIP')))         │
│        EC: 1500000        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│                           ││         EC: 240048        │
└───────────────────────────┘└─────────────┬─────────────┘                             
                             ┌─────────────┴─────────────┐
                             │         SEQ_SCAN          │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                             │          lineitem         │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                             │         l_orderkey        │
                             │         l_shipmode        │
                             │        l_commitdate       │
                             │       l_receiptdate       │
                             │         l_shipdate        │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                             │  Filters: l_receiptdate>= │
                             │   '1994-01-01'::DATE AND  │
                             │ l_receiptdate<'1995-0...  │
                             │  AND l_receiptdate IS NOT │
                             │            NULL           │
                             │ l_commitdate<'1995-01-01':│
                             │ :DATE AND l_commitdate IS │
                             │          NOT NULL         │
                             │  l_shipdate<'1995-01-01': │
                             │:DATE AND l_shipdate IS NOT│
                             │            NULL           │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                             │         EC: 240048        │
                             └───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

X {'RESULT_COLLECTOR0': 7e-06, 'PROJECTION1': 3e-06, 'ORDER_BY2': 8.7e-05, 'PROJECTION3': 1.8e-05, 'PROJECTION4': 6e-06, 'NESTED_LOOP_JOIN5': 0.000973, 'PROJECTION6': 2.9e-05, 'HASH_GROUP_BY7': 0.00442, 'PROJECTION8': 0.005408, 'PROJECTION9': 0.00281, 'HASH_JOIN10': 0.00455, 'SEQ_SCAN 11': 0.002121, 'HASH_JOIN12': 6.9e-05, 'SEQ_SCAN 13': 3.3e-05, 'SEQ_SCAN 14': 1.1e-05, 'UNGROUPED_AGGREGATE15': 5e-06, 'PROJECTION16': 0.0, 'STREAMING_LIMIT17': 2e-06, 'PROJECTION18': 3e-06, 'UNGROUPED_AGGREGATE19': 0.000556, 'PROJECTION20': 0.007482, 'HASH_JOIN21': 0.005521, 'SEQ_SCAN 22': 0.002156, 'HASH_JOIN23': 0.0001, 'SEQ_SCAN 24': 5.1e-05, 'SEQ_SCAN 25': 3.1e-05}
Physical operator output, input_left, input_right: 
**** output size:  1048
LINEAGE_5_HASH_GROUP_BY_7
LINEAGE_5_HASH_JOIN_12
LINEAGE_5_HASH_JOIN_13
LINEAGE_5_HASH_JOIN_3
LINEAGE_5_HASH_JOIN_4
LINEAGE_5_NESTED_LOOP_JOIN_20
LINEAGE_5_ORDER_BY_23
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_1
LINEAGE_5_SEQ_SCAN_10
LINEAGE_5_SEQ_SCAN_11
LINEAGE_5_SEQ_SCAN_2
LINEAGE_5_SEQ_SCAN_9
LINEAGE_5_STREAMING_LIMIT_17
SELECT ps_partkey, sum(ps_supplycost * ps_availqty) AS value FROM partsupp, supplier, nation WHERE ps_suppkey = s_suppkey AND s_nationkey = n_nationkey AND n_name = 'GERMANY' GROUP BY ps_partkey HAVING sum(ps_supplycost * ps_availqty) > ( SELECT sum(ps_supplycost * ps_availqty) * 0.000100000 FROM partsupp, supplier, nation WHERE ps_suppkey = s_suppkey AND s_nationkey = n_nationkey AND n_name = 'GERMANY') ORDER BY value DESC;
   query_id  ...                                               plan
0         5  ...  {"name": "PROJECTION", "opid": "24", "children...

[1 rows x 8 columns]
Query info:  query_id                                                            5
query               SELECT ps_partkey, sum(ps_supplycost * ps_avai...
size_bytes_max                                                 380595
physical_op_size    [361, 0, 1775, 0, 0, 3402, 0, 51922, 0, 0, 155...
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "PROJECTION", "opid": "24", "children...
Name: 0, dtype: object
physical op size is:
{"name": "PROJECTION", "opid": "24", "children": [{"name": "ORDER_BY", "opid": "23", "children": [{"name": "PROJECTION", "opid": "22", "children": [{"name": "PROJECTION", "opid": "21", "children": [{"name": "NESTED_LOOP_JOIN", "opid": "20", "children": [{"name": "PROJECTION", "opid": "8", "children": [{"name": "HASH_GROUP_BY", "opid": "7", "children": [{"name": "PROJECTION", "opid": "6", "children": [{"name": "PROJECTION", "opid": "5", "children": [{"name": "HASH_JOIN", "opid": "4", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "partsupp","extra": "partsupp\n[INFOSEPARATOR]\nps_suppkey\nps_partkey\nps_supplycost\nps_availqty\n[INFOSEPARATOR]\nEC: 800000"},{"name": "HASH_JOIN", "opid": "3", "children": [{"name": "SEQ_SCAN ", "opid": "1", "children": [],"table": "supplier","extra": "supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\n[INFOSEPARATOR]\nEC: 10000"},{"name": "SEQ_SCAN ", "opid": "2", "children": [],"table": "nation","extra": "nation\n[INFOSEPARATOR]\nn_nationkey\n[INFOSEPARATOR]\nFilters: n_name='GERMANY' AND n_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1"}],"table": "","extra": "INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 400\n"}],"table": "","extra": "INNER\nps_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 27811\n"}],"table": "","extra": "__internal_compress_integral_usmallint(#0, 1)\n__internal_compress_integral_uinteger(#1, 1)\n#2\n#3\n__internal_compress_integral_usmallint(#4, 1)\n"}],"table": "","extra": "ps_partkey\n(CAST(ps_supplycost AS DECIMAL(34,2)) * CAST(ps_availqty AS DECIMAL(34,0)))\n"}],"table": "","extra": "#0\nsum(#1)"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n#1\n"},{"name": "UNGROUPED_AGGREGATE", "opid": "19", "children": [{"name": "PROJECTION", "opid": "18", "children": [{"name": "STREAMING_LIMIT", "opid": "17", "children": [{"name": "PROJECTION", "opid": "16", "children": [{"name": "UNGROUPED_AGGREGATE", "opid": "15", "children": [{"name": "PROJECTION", "opid": "14", "children": [{"name": "HASH_JOIN", "opid": "13", "children": [{"name": "SEQ_SCAN ", "opid": "9", "children": [],"table": "partsupp","extra": "partsupp\n[INFOSEPARATOR]\nps_suppkey\nps_supplycost\nps_availqty\n[INFOSEPARATOR]\nEC: 800000"},{"name": "HASH_JOIN", "opid": "12", "children": [{"name": "SEQ_SCAN ", "opid": "10", "children": [],"table": "supplier","extra": "supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\n[INFOSEPARATOR]\nEC: 10000"},{"name": "SEQ_SCAN ", "opid": "11", "children": [],"table": "nation","extra": "nation\n[INFOSEPARATOR]\nn_nationkey\n[INFOSEPARATOR]\nFilters: n_name='GERMANY' AND n_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1"}],"table": "","extra": "INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 400\n"}],"table": "","extra": "INNER\nps_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 27811\n"}],"table": "","extra": "(CAST(ps_supplycost AS DECIMAL(34,2)) * CAST(ps_availqty AS DECIMAL(34,0)))\n"}],"table": "","extra": "sum(#0)"}],"table": "","extra": "(sum((CAST(ps_supplycost AS DECIMAL(34,2)) * CAST(ps_availqty AS DECIMAL(34,0)))) * 0.000100000)\n"}],"table": "","extra": ""}],"table": "","extra": "#0\n"}],"table": "","extra": "first(#0)"}],"table": "","extra": "INNER\nCAST(sum((CAST(ps_supplycost AS DECIMAL(34,2)) * CAST(ps_availqty AS DECIMAL(34,0)))) AS DECIMAL(38,11)) > SUBQUERY\n\n[INFOSEPARATOR]\nEC: 1\n"}],"table": "","extra": "ps_partkey\nvalue\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n#1\n"}],"table": "","extra": "ORDERS:\nsum((partsupp.ps_supplycost * partsupp.ps_availqty)) DESC"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n#1\n"}
%%%%%%%%%%%%%%%% Running Query #  12  threads:  1
SELECT l_shipmode, sum( CASE WHEN o_orderpriority = '1-URGENT' OR o_orderpriority = '2-HIGH' THEN 1 ELSE 0 END) AS high_line_count, sum( CASE WHEN o_orderpriority <> '1-URGENT' AND o_orderpriority <> '2-HIGH' THEN 1 ELSE 0 END) AS low_line_count FROM orders, lineitem WHERE o_orderkey = l_orderkey AND l_shipmode IN ('MAIL', 'SHIP') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= CAST('1994-01-01' AS date) AND l_receiptdate < CAST('1995-01-01' AS date) GROUP BY l_shipmode ORDER BY l_shipmode;
Run:  None SELECT l_shipmode, sum( CASE WHEN o_orderpriority = '1-URGENT' OR o_orderpriority = '2-HIGH' THEN 1 ELSE 0 END) AS high_line_count, sum( CASE WHEN o_orderpriority <> '1-URGENT' AND o_orderpriority <> '2-HIGH' THEN 1 ELSE 0 END) AS low_line_count FROM orders, lineitem WHERE o_orderkey = l_orderkey AND l_shipmode IN ('MAIL', 'SHIP') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= CAST('1994-01-01' AS date) AND l_receiptdate < CAST('1995-01-01' AS date) GROUP BY l_shipmode ORDER BY l_shipmode;
Avg Time in sec:  0.31922107096761465  output size:  2
  l_shipmode  high_line_count  low_line_count
0       MAIL           6202.0          9324.0
1       SHIP           6200.0          9262.0
{'name': 'Query', 'result': 0.316624, 'timing': 0.316624, 'cardinality': 0, 'extra-info': "SELECT l_shipmode, sum( CASE WHEN o_orderpriority = '1-URGENT' OR o_orderpriority = '2-HIGH' THEN 1 ELSE 0 END) AS high_line_count, sum( CASE WHEN o_orderpriority <> '1-URGENT' AND o_orderpriority <> '2-HIGH' THEN 1 ELSE 0 END) AS low_line_count FROM orders, lineitem WHERE o_orderkey = l_orderkey AND l_shipmode IN ('MAIL', 'SHIP') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= CAST('1994-01-01' AS date) AND l_receiptdate < CAST('1995-01-01' AS date) GROUP BY l_shipmode ORDER BY l_shipmode;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 6e-06, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 1e-06, 'cardinality': 2, 'extra_info': '__internal_decompress_string(#0)\n#1\n#2\n', 'children': [{'name': 'ORDER_BY', 'timing': 3.5e-05, 'cardinality': 2, 'extra_info': 'ORDERS:\nlineitem.l_shipmode ASC', 'children': [{'name': 'PROJECTION', 'timing': 1e-06, 'cardinality': 2, 'extra_info': '__internal_compress_string_ubigint(#0)\n#1\n#2\n', 'children': [{'name': 'PROJECTION', 'timing': 2e-06, 'cardinality': 2, 'extra_info': '__internal_decompress_string(#0)\n#1\n#2\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.001113, 'cardinality': 2, 'extra_info': '#0\nsum(#1)\nsum(#2)', 'children': [{'name': 'PROJECTION', 'timing': 0.000871, 'cardinality': 30988, 'extra_info': "l_shipmode\nCASE  WHEN (((o_orderpriority = '1-URGENT') OR (o_orderpriority = '2-HIGH'))) THEN (1) ELSE 0 END\nCASE  WHEN (((o_orderpriority != '1-URGENT') AND (o_orderpriority != '2-HIGH'))) THEN (1) ELSE 0 END\n", 'children': [{'name': 'PROJECTION', 'timing': 0.000249, 'cardinality': 30988, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n#1\n__internal_compress_integral_uinteger(#2, 1)\n__internal_compress_string_ubigint(#3)\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.041923, 'cardinality': 30988, 'extra_info': 'INNER\no_orderkey = l_orderkey\n\n[INFOSEPARATOR]\nEC: 240048\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.034793, 'cardinality': 1500000, 'extra_info': 'orders\n[INFOSEPARATOR]\no_orderkey\no_orderpriority\n[INFOSEPARATOR]\nEC: 1500000', 'children': []}, {'name': 'FILTER', 'timing': 0.038464, 'cardinality': 30988, 'extra_info': "((l_commitdate < l_receiptdate) AND (l_shipdate < l_commitdate) AND ((l_shipmode = 'MAIL') OR (l_shipmode = 'SHIP')))\n[INFOSEPARATOR]\nEC: 240048", 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.190145, 'cardinality': 885773, 'extra_info': "lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_shipmode\nl_commitdate\nl_receiptdate\nl_shipdate\n[INFOSEPARATOR]\nFilters: l_receiptdate>='1994-01-01'::DATE AND l_receiptdate<'1995-01-01'::DATE AND l_receiptdate IS NOT NULL\nl_commitdate<'1995-01-01'::DATE AND l_commitdate IS NOT NULL\nl_shipdate<'1995-01-01'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 240048", 'children': []}]}]}]}]}]}]}]}]}]}]}]}
Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                             
│          ORDER_BY         │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│          ORDERS:          │                             
│     count_star() DESC     │                             
│   c_orders.c_count DESC   │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│       HASH_GROUP_BY       │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│             #0            │                             
│        count_star()       │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│          c_count          │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│     count(o_orderkey)     │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│__internal_decompress_integ│                             
│     ral_bigint(#0, 1)     │                             
│             #1            │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│       HASH_GROUP_BY       │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│             #0            │                             
│         count(#1)         │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│         c_custkey         │                             
│         o_orderkey        │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│__internal_compress_integra│                             
│     l_uinteger(#0, 1)     │                             
│             #1            │                             
│             #2            │                             
│__internal_compress_integra│                             
│     l_uinteger(#3, 1)     │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         HASH_JOIN         │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│           RIGHT           │                             
│   o_custkey = c_custkey   ├──────────────┐              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              
│         EC: 300000        │              │              
└─────────────┬─────────────┘              │                                           
┌─────────────┴─────────────┐┌─────────────┴─────────────┐
│           FILTER          ││         SEQ_SCAN          │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│  (o_comment !~~ '%special ││          customer         │
│        %requests%')       ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││         c_custkey         │
│         EC: 300000        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│                           ││         EC: 150000        │
└─────────────┬─────────────┘└───────────────────────────┘                             
┌─────────────┴─────────────┐                             
│         SEQ_SCAN          │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│           orders          │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│         o_custkey         │                             
│         o_comment         │                             
│         o_orderkey        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│        EC: 1500000        │                             
└───────────────────────────┘                                                          

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

X {'RESULT_COLLECTOR0': 6e-06, 'PROJECTION1': 1e-06, 'ORDER_BY2': 3.5e-05, 'PROJECTION3': 1e-06, 'PROJECTION4': 2e-06, 'HASH_GROUP_BY5': 0.001113, 'PROJECTION6': 0.000871, 'PROJECTION7': 0.000249, 'HASH_JOIN8': 0.041923, 'SEQ_SCAN 9': 0.034793, 'FILTER10': 0.038464, 'SEQ_SCAN 11': 0.190145}
Physical operator output, input_left, input_right: 
**** output size:  2
LINEAGE_5_FILTER_2
LINEAGE_5_HASH_GROUP_BY_6
LINEAGE_5_HASH_JOIN_3
LINEAGE_5_ORDER_BY_9
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_1
SELECT l_shipmode, sum( CASE WHEN o_orderpriority = '1-URGENT' OR o_orderpriority = '2-HIGH' THEN 1 ELSE 0 END) AS high_line_count, sum( CASE WHEN o_orderpriority <> '1-URGENT' AND o_orderpriority <> '2-HIGH' THEN 1 ELSE 0 END) AS low_line_count FROM orders, lineitem WHERE o_orderkey = l_orderkey AND l_shipmode IN ('MAIL', 'SHIP') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= CAST('1994-01-01' AS date) AND l_receiptdate < CAST('1995-01-01' AS date) GROUP BY l_shipmode ORDER BY l_shipmode;
   query_id  ...                                               plan
0         5  ...  {"name": "PROJECTION", "opid": "10", "children...

[1 rows x 8 columns]
Query info:  query_id                                                            5
query               SELECT l_shipmode, sum( CASE WHEN o_orderprior...
size_bytes_max                                                1233847
physical_op_size    [676019, 0, 64, 0, 0, 39829, 0, 0, 356209, 533...
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "PROJECTION", "opid": "10", "children...
Name: 0, dtype: object
physical op size is:
{"name": "PROJECTION", "opid": "10", "children": [{"name": "ORDER_BY", "opid": "9", "children": [{"name": "PROJECTION", "opid": "8", "children": [{"name": "PROJECTION", "opid": "7", "children": [{"name": "HASH_GROUP_BY", "opid": "6", "children": [{"name": "PROJECTION", "opid": "5", "children": [{"name": "PROJECTION", "opid": "4", "children": [{"name": "HASH_JOIN", "opid": "3", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "orders","extra": "orders\n[INFOSEPARATOR]\no_orderkey\no_orderpriority\n[INFOSEPARATOR]\nEC: 1500000"},{"name": "FILTER", "opid": "2", "children": [{"name": "SEQ_SCAN ", "opid": "1", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_shipmode\nl_commitdate\nl_receiptdate\nl_shipdate\n[INFOSEPARATOR]\nFilters: l_receiptdate>='1994-01-01'::DATE AND l_receiptdate<'1995-01-01'::DATE AND l_receiptdate IS NOT NULL\nl_commitdate<'1995-01-01'::DATE AND l_commitdate IS NOT NULL\nl_shipdate<'1995-01-01'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 240048"}],"table": "","extra": "((l_commitdate < l_receiptdate) AND (l_shipdate < l_commitdate) AND ((l_shipmode = 'MAIL') OR (l_shipmode = 'SHIP')))\n[INFOSEPARATOR]\nEC: 240048"}],"table": "","extra": "INNER\no_orderkey = l_orderkey\n\n[INFOSEPARATOR]\nEC: 240048\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n#1\n__internal_compress_integral_uinteger(#2, 1)\n__internal_compress_string_ubigint(#3)\n"}],"table": "","extra": "l_shipmode\nCASE  WHEN (((o_orderpriority = '1-URGENT') OR (o_orderpriority = '2-HIGH'))) THEN (1) ELSE 0 END\nCASE  WHEN (((o_orderpriority != '1-URGENT') AND (o_orderpriority != '2-HIGH'))) THEN (1) ELSE 0 END\n"}],"table": "","extra": "#0\nsum(#1)\nsum(#2)"}],"table": "","extra": "__internal_decompress_string(#0)\n#1\n#2\n"}],"table": "","extra": "__internal_compress_string_ubigint(#0)\n#1\n#2\n"}],"table": "","extra": "ORDERS:\nlineitem.l_shipmode ASC"}],"table": "","extra": "__internal_decompress_string(#0)\n#1\n#2\n"}
%%%%%%%%%%%%%%%% Running Query #  13  threads:  1
SELECT c_count, count(*) AS custdist FROM ( SELECT c_custkey, count(o_orderkey) FROM customer LEFT OUTER JOIN orders ON c_custkey = o_custkey AND o_comment NOT LIKE '%special%requests%' GROUP BY c_custkey) AS c_orders (c_custkey, c_count) GROUP BY c_count ORDER BY custdist DESC, c_count DESC;
Run:  None SELECT c_count, count(*) AS custdist FROM ( SELECT c_custkey, count(o_orderkey) FROM customer LEFT OUTER JOIN orders ON c_custkey = o_custkey AND o_comment NOT LIKE '%special%requests%' GROUP BY c_custkey) AS c_orders (c_custkey, c_count) GROUP BY c_count ORDER BY custdist DESC, c_count DESC;
Avg Time in sec:  0.3727460512891412  output size:  42
    c_count  custdist
0         0     50004
1        10      6668
2         9      6563
3        11      6004
4         8      5890
5        12      5600
6        13      5029
7        19      4805
8         7      4680
9        18      4531
10       20      4507
11       14      4473
12       15      4463
13       17      4445
14       16      4410
15       21      4168
16       22      3742
17        6      3273
18       23      3189
19       24      2700
20       25      2090
21        5      1957
22       26      1653
23       27      1177
24        4      1010
25       28       901
26       29       564
27        3       408
28       30       378
29       31       242
30       32       133
31        2       128
32       33        72
33       34        52
34       35        32
35       36        20
36        1        20
37       37         8
38       38         4
39       41         3
40       40         3
41       39         1
{'name': 'Query', 'result': 0.369386, 'timing': 0.369386, 'cardinality': 0, 'extra-info': "SELECT c_count, count(*) AS custdist FROM ( SELECT c_custkey, count(o_orderkey) FROM customer LEFT OUTER JOIN orders ON c_custkey = o_custkey AND o_comment NOT LIKE '%special%requests%' GROUP BY c_custkey) AS c_orders (c_custkey, c_count) GROUP BY c_count ORDER BY custdist DESC, c_count DESC;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 1e-05, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'ORDER_BY', 'timing': 4.6e-05, 'cardinality': 42, 'extra_info': 'ORDERS:\ncount_star() DESC\nc_orders.c_count DESC', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.005274, 'cardinality': 42, 'extra_info': '#0\ncount_star()', 'children': [{'name': 'PROJECTION', 'timing': 1.8e-05, 'cardinality': 150000, 'extra_info': 'c_count\n', 'children': [{'name': 'PROJECTION', 'timing': 2.2e-05, 'cardinality': 150000, 'extra_info': 'count(o_orderkey)\n', 'children': [{'name': 'PROJECTION', 'timing': 0.000155, 'cardinality': 150000, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n#1\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.094216, 'cardinality': 150000, 'extra_info': '#0\ncount(#1)', 'children': [{'name': 'PROJECTION', 'timing': 0.000507, 'cardinality': 1534302, 'extra_info': 'c_custkey\no_orderkey\n', 'children': [{'name': 'PROJECTION', 'timing': 0.005566, 'cardinality': 1534302, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n#1\n#2\n__internal_compress_integral_uinteger(#3, 1)\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.11465, 'cardinality': 1534302, 'extra_info': 'RIGHT\no_custkey = c_custkey\n\n[INFOSEPARATOR]\nEC: 300000\n', 'children': [{'name': 'FILTER', 'timing': 0.083792, 'cardinality': 1484298, 'extra_info': "(o_comment !~~ '%special%requests%')\n[INFOSEPARATOR]\nEC: 300000", 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.053047, 'cardinality': 1500000, 'extra_info': 'orders\n[INFOSEPARATOR]\no_custkey\no_comment\no_orderkey\n[INFOSEPARATOR]\nEC: 1500000', 'children': []}]}, {'name': 'SEQ_SCAN ', 'timing': 0.000256, 'cardinality': 150000, 'extra_info': 'customer\n[INFOSEPARATOR]\nc_custkey\n[INFOSEPARATOR]\nEC: 150000', 'children': []}]}]}]}]}]}]}]}]}]}]}]}
X {'RESULT_COLLECTOR0': 1e-05, 'ORDER_BY1': 4.6e-05, 'HASH_GROUP_BY2': 0.005274, 'PROJECTION3': 1.8e-05, 'PROJECTION4': 2.2e-05, 'PROJECTION5': 0.000155, 'HASH_GROUP_BY6': 0.094216, 'PROJECTION7': 0.000507, 'PROJECTION8': 0.005566, 'HASH_JOIN9': 0.11465, 'FILTER10': 0.083792, 'SEQ_SCAN 11': 0.053047, 'SEQ_SCAN 12': 0.000256}
Physical operator output, input_left, input_right: 
**** output size:  42
LINEAGE_5_FILTER_1
LINEAGE_5_HASH_GROUP_BY_10
LINEAGE_5_HASH_GROUP_BY_6
Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│       promo_revenue       │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│    UNGROUPED_AGGREGATE    │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│          sum(#0)          │                             
│          sum(#1)          │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│CASE  WHEN (prefix(p_type, │                             
│      'PROMO')) THEN (     │                             
│(l_extendedprice * (1....  │                             
│     )) ELSE 0.0000 END    │                             
│ (l_extendedprice * (1.00 -│                             
│        l_discount))       │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         HASH_JOIN         │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│           INNER           │                             
│   l_partkey = p_partkey   │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐              
│        Build Min: 1       │              │              
│     Build Max: 200000     │              │              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              
│         EC: 641407        │              │              
└─────────────┬─────────────┘              │                                           
┌─────────────┴─────────────┐┌─────────────┴─────────────┐
│         SEQ_SCAN          ││         SEQ_SCAN          │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│          lineitem         ││            part           │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│         l_partkey         ││         p_partkey         │
│      l_extendedprice      ││           p_type          │
│         l_discount        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││         EC: 200000        │
│ Filters: l_shipdate>='1995││                           │
│-09-01'::DATE AND l_sh...  ││                           │
│  <'1995-10-01'::DATE AND  ││                           │
│   l_shipdate IS NOT NULL  ││                           │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │
│        EC: 1200243        ││                           │
└───────────────────────────┘└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

Clear Lineage

LINEAGE_5_HASH_JOIN_3
LINEAGE_5_ORDER_BY_11
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_2
SELECT c_count, count(*) AS custdist FROM ( SELECT c_custkey, count(o_orderkey) FROM customer LEFT OUTER JOIN orders ON c_custkey = o_custkey AND o_comment NOT LIKE '%special%requests%' GROUP BY c_custkey) AS c_orders (c_custkey, c_count) GROUP BY c_count ORDER BY custdist DESC, c_count DESC;
   query_id  ...                                               plan
0         5  ...  {"name": "ORDER_BY", "opid": "11", "children":...

[1 rows x 8 columns]
Query info:  query_id                                                            5
query               SELECT c_count, count(*) AS custdist FROM ( SE...
size_bytes_max                                               11687917
physical_op_size    [76290, 91, 161361, 0, 0, 0, 5718674, 0, 0, 57...
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "ORDER_BY", "opid": "11", "children":...
Name: 0, dtype: object
physical op size is:
{"name": "ORDER_BY", "opid": "11", "children": [{"name": "HASH_GROUP_BY", "opid": "10", "children": [{"name": "PROJECTION", "opid": "9", "children": [{"name": "PROJECTION", "opid": "8", "children": [{"name": "PROJECTION", "opid": "7", "children": [{"name": "HASH_GROUP_BY", "opid": "6", "children": [{"name": "PROJECTION", "opid": "5", "children": [{"name": "PROJECTION", "opid": "4", "children": [{"name": "HASH_JOIN", "opid": "3", "children": [{"name": "FILTER", "opid": "1", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "orders","extra": "orders\n[INFOSEPARATOR]\no_custkey\no_comment\no_orderkey\n[INFOSEPARATOR]\nEC: 1500000"}],"table": "","extra": "(o_comment !~~ '%special%requests%')\n[INFOSEPARATOR]\nEC: 300000"},{"name": "SEQ_SCAN ", "opid": "2", "children": [],"table": "customer","extra": "customer\n[INFOSEPARATOR]\nc_custkey\n[INFOSEPARATOR]\nEC: 150000"}],"table": "","extra": "RIGHT\no_custkey = c_custkey\n\n[INFOSEPARATOR]\nEC: 300000\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n#1\n#2\n__internal_compress_integral_uinteger(#3, 1)\n"}],"table": "","extra": "c_custkey\no_orderkey\n"}],"table": "","extra": "#0\ncount(#1)"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n#1\n"}],"table": "","extra": "count(o_orderkey)\n"}],"table": "","extra": "c_count\n"}],"table": "","extra": "#0\ncount_star()"}],"table": "","extra": "ORDERS:\ncount_star() DESC\nc_orders.c_count DESC"}
%%%%%%%%%%%%%%%% Running Query #  14  threads:  1
SELECT 100.00 * sum( CASE WHEN p_type LIKE 'PROMO%' THEN l_extendedprice * (1 - l_discount) ELSE 0 END) / sum(l_extendedprice * (1 - l_discount)) AS promo_revenue FROM lineitem, part WHERE l_partkey = p_partkey AND l_shipdate >= date '1995-09-01' AND l_shipdate < CAST('1995-10-01' AS date);
Run:  None SELECT 100.00 * sum( CASE WHEN p_type LIKE 'PROMO%' THEN l_extendedprice * (1 - l_discount) ELSE 0 END) / sum(l_extendedprice * (1 - l_discount)) AS promo_revenue FROM lineitem, part WHERE l_partkey = p_partkey AND l_shipdate >= date '1995-09-01' AND l_shipdate < CAST('1995-10-01' AS date);
Avg Time in sec:  0.1521179536357522  output size:  1
   promo_revenue
0      16.380779
{'name': 'Query', 'result': 0.149619, 'timing': 0.149619, 'cardinality': 0, 'extra-info': "SELECT 100.00 * sum( CASE WHEN p_type LIKE 'PROMO%' THEN l_extendedprice * (1 - l_discount) ELSE 0 END) / sum(l_extendedprice * (1 - l_discount)) AS promo_revenue FROM lineitem, part WHERE l_partkey = p_partkey AND l_shipdate >= date '1995-09-01' AND l_shipdate < CAST('1995-10-01' AS date);", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 6e-06, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 1.3e-05, 'cardinality': 1, 'extra_info': 'promo_revenue\n', 'children': [{'name': 'UNGROUPED_AGGREGATE', 'timing': 0.000254, 'cardinality': 1, 'extra_info': 'sum(#0)\nsum(#1)', 'children': [{'name': 'PROJECTION', 'timing': 0.001462, 'cardinality': 75983, 'extra_info': "CASE  WHEN (prefix(p_type, 'PROMO')) THEN ((l_extendedprice * (1.00 - l_discount))) ELSE 0.0000 END\n(l_extendedprice * (1.00 - l_discount))\n", 'children': [{'name': 'HASH_JOIN', 'timing': 0.067561, 'cardinality': 75983, 'extra_info': 'INNER\nl_partkey = p_partkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 641407\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.052197, 'cardinality': 75983, 'extra_info': "lineitem\n[INFOSEPARATOR]\nl_partkey\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nFilters: l_shipdate>='1995-09-01'::DATE AND l_shipdate<'1995-10-01'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243", 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 0.004713, 'cardinality': 200000, 'extra_info': 'part\n[INFOSEPARATOR]\np_partkey\np_type\n[INFOSEPARATOR]\nEC: 200000', 'children': []}]}]}]}]}]}]}
X {'RESULT_COLLECTOR0': 6e-06, 'PROJECTION1': 1.3e-05, 'UNGROUPED_AGGREGATE2': 0.000254, 'PROJECTION3': 0.001462, 'HASH_JOIN4': 0.067561, 'SEQ_SCAN 5': 0.052197, 'SEQ_SCAN 6': 0.004713}
Physical operator output, input_left, input_right: 
**** output size:  1
LINEAGE_5_HASH_JOIN_2
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_1
SELECT 100.00 * sum( CASE WHEN p_type LIKE 'PROMO%' THEN l_extendedprice * (1 - l_discount) ELSE 0 END) / sum(l_extendedprice * (1 - l_discount)) AS promo_revenue FROM lineitem, part WHERE l_partkey = p_partkey AND l_shipdate >= date '1995-09-01' AND l_shipdate < CAST('1995-10-01' AS date);
   query_id  ...                                               plan
0         5  ...  {"name": "PROJECTION", "opid": "5", "children"...

[1 rows x 8 columns]
Query info:  query_id                                                            5
query               SELECT 100.00 * sum( CASE WHEN p_type LIKE 'PR...
size_bytes_max                                                2041779
physical_op_size                   [967, 0, 0, 0, 1746552, 294260, 0]
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "PROJECTION", "opid": "5", "children"...
Name: 0, dtype: object
physical op size is:
{"name": "PROJECTION", "opid": "5", "children": [{"name": "UNGROUPED_AGGREGATE", "opid": "4", "children": [{"name": "PROJECTION", "opid": "3", "children": [{"name": "HASH_JOIN", "opid": "2", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_partkey\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nFilters: l_shipdate>='1995-09-01'::DATE AND l_shipdate<'1995-10-01'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243"},{"name": "SEQ_SCAN ", "opid": "1", "children": [],"table": "part","extra": "part\n[INFOSEPARATOR]\np_partkey\np_type\n[INFOSEPARATOR]\nEC: 200000"}],"table": "","extra": "INNER\nl_partkey = p_partkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 641407\n"}],"table": "","extra": "CASE  WHEN (prefix(p_type, 'PROMO')) THEN ((l_extendedprice * (1.00 - l_discount))) ELSE 0.0000 END\n(l_extendedprice * (1.00 - l_discount))\n"}],"table": "","extra": "sum(#0)\nsum(#1)"}],"table": "","extra": "promo_revenue\n"}
%%%%%%%%%%%%%%%% Running Query #  15  threads:  1
with revenue0 (supplier_no, total_revenue) as ( select l_suppkey, sum(l_extendedprice * (1 - l_discount)) from lineitem where l_shipdate >= date '1996-01-01' and l_shipdate < date '1996-01-01' + interval '3' month group by l_suppkey ) SELECT s_suppkey, s_name, s_address, s_phone, total_revenue FROM supplier, revenue0 WHERE s_suppkey = supplier_no AND total_revenue = ( SELECT max(total_revenue) FROM revenue0) ORDER BY s_suppkey;
Run:  None with revenue0 (supplier_no, total_revenue) as ( select l_suppkey, sum(l_extendedprice * (1 - l_discount)) from lineitem where l_shipdate >= date '1996-01-01' and l_shipdate < date '1996-01-01' + interval '3' month group by l_suppkey ) SELECT s_suppkey, s_name, s_address, s_phone, total_revenue FROM supplier, revenue0 WHERE s_suppkey = supplier_no AND total_revenue = ( SELECT max(total_revenue) FROM revenue0) ORDER BY s_suppkey;
Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                                                          
│         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│__internal_decompress_integ│                                                          
│     ral_bigint(#0, 1)     │                                                          
│             #1            │                                                          
│             #2            │                                                          
│__internal_decompress_strin│                                                          
│           g(#3)           │                                                          
│             #4            │                                                          
└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          
│          ORDER_BY         │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│          ORDERS:          │                                                          
│   supplier.s_suppkey ASC  │                                                          
└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          
│         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│__internal_compress_integra│                                                          
│     l_usmallint(#0, 1)    │                                                          
│             #1            │                                                          
│             #2            │                                                          
│__internal_compress_string_│                                                          
│        hugeint(#3)        │                                                          
│             #4            │                                                          
└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          
│         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│         s_suppkey         │                                                          
│           s_name          │                                                          
│         s_address         │                                                          
│          s_phone          │                                                          
│       total_revenue       │                                                          
└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          
│         HASH_JOIN         │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│           INNER           │                                                          
│  s_suppkey = supplier_no  │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐                                           
│        Build Min: 1       │              │                                           
│      Build Max: 10000     │              │                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                           
│           EC: 4           │              │                                           
└─────────────┬─────────────┘              │                                                                        
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             
│         SEQ_SCAN          ││         HASH_JOIN         │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│          supplier         ││           INNER           │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││  total_revenue = SUBQUERY │                             
│         s_suppkey         ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│           s_name          ││           EC: 3           ├──────────────┐              
│         s_address         ││                           │              │              
│          s_phone          ││                           │              │              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │              │              
│         EC: 10000         ││                           │              │              
└───────────────────────────┘└─────────────┬─────────────┘              │                                           
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
                             │         PROJECTION        ││    UNGROUPED_AGGREGATE    │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                             │__internal_decompress_integ││         first(#0)         │
                             │     ral_bigint(#0, 1)     ││                           │
                             │             #1            ││                           │
                             └─────────────┬─────────────┘└─────────────┬─────────────┘                             
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
                             │       HASH_GROUP_BY       ││         PROJECTION        │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                             │             #0            ││             #0            │
                             │    sum_no_overflow(#1)    ││                           │
                             └─────────────┬─────────────┘└─────────────┬─────────────┘                             
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
                             │         PROJECTION        ││      STREAMING_LIMIT      │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │
                             │         l_suppkey         ││                           │
                             │ (l_extendedprice * (1.00 -││                           │
                             │        l_discount))       ││                           │
                             └─────────────┬─────────────┘└─────────────┬─────────────┘                             
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
                             │         PROJECTION        ││    UNGROUPED_AGGREGATE    │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                             │__internal_compress_integra││          max(#0)          │
                             │     l_usmallint(#0, 1)    ││                           │
                             │             #1            ││                           │
                             │             #2            ││                           │
                             └─────────────┬─────────────┘└─────────────┬─────────────┘                             
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
                             │         SEQ_SCAN          ││         PROJECTION        │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                             │          lineitem         ││       total_revenue       │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │
                             │         l_suppkey         ││                           │
                             │      l_extendedprice      ││                           │
                             │         l_discount        ││                           │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │
                             │ Filters: l_shipdate>='1996││                           │
                             │-01-01'::DATE AND l_sh...  ││                           │
                             │  <'1996-04-01'::DATE AND  ││                           │
                             │   l_shipdate IS NOT NULL  ││                           │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │
                             │        EC: 1200243        ││                           │
                             └───────────────────────────┘└─────────────┬─────────────┘                             
                                                          ┌─────────────┴─────────────┐
                                                          │         PROJECTION        │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │  sum((l_extendedprice *   │
                                                          │(CAST(1 AS DECIMAL(16,2)) -│
                                                          │        l_discount)))      │
                                                          └─────────────┬─────────────┘                             
                                                          ┌─────────────┴─────────────┐
                                                          │         PROJECTION        │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │__internal_decompress_integ│
                                                          │     ral_bigint(#0, 1)     │
                                                          │             #1            │
                                                          └─────────────┬─────────────┘                             
                                                          ┌─────────────┴─────────────┐
                                                          │       HASH_GROUP_BY       │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │             #0            │
                                                          │    sum_no_overflow(#1)    │
                                                          └─────────────┬─────────────┘                             
                                                          ┌─────────────┴─────────────┐
                                                          │         PROJECTION        │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │         l_suppkey         │
                                                          │ (l_extendedprice * (1.00 -│
                                                          │        l_discount))       │
                                                          └─────────────┬─────────────┘                             
                                                          ┌─────────────┴─────────────┐
                                                          │         PROJECTION        │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │__internal_compress_integra│
                                                          │     l_usmallint(#0, 1)    │
                                                          │             #1            │
                                                          │             #2            │
                                                          └─────────────┬─────────────┘                             
                                                          ┌─────────────┴─────────────┐
                                                          │         SEQ_SCAN          │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │          lineitem         │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │         l_suppkey         │
                                                          │      l_extendedprice      │
                                                          │         l_discount        │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │ Filters: l_shipdate>='1996│
                                                          │-01-01'::DATE AND l_sh...  │
                                                          │  <'1996-04-01'::DATE AND  │
                                                          │   l_shipdate IS NOT NULL  │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │        EC: 1200243        │
                                                          └───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

Avg Time in sec:  0.2084683757275343  output size:  1
   s_suppkey              s_name  ...          s_phone total_revenue
0       8449  Supplier#000008449  ...  20-469-856-8873  1.772627e+06

[1 rows x 5 columns]
{'name': 'Query', 'result': 0.205036, 'timing': 0.205036, 'cardinality': 0, 'extra-info': "with revenue0 (supplier_no, total_revenue) as ( select l_suppkey, sum(l_extendedprice * (1 - l_discount)) from lineitem where l_shipdate >= date '1996-01-01' and l_shipdate < date '1996-01-01' + interval '3' month group by l_suppkey ) SELECT s_suppkey, s_name, s_address, s_phone, total_revenue FROM supplier, revenue0 WHERE s_suppkey = supplier_no AND total_revenue = ( SELECT max(total_revenue) FROM revenue0) ORDER BY s_suppkey;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 1.3e-05, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 4e-06, 'cardinality': 1, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n#1\n#2\n__internal_decompress_string(#3)\n#4\n', 'children': [{'name': 'ORDER_BY', 'timing': 3.8e-05, 'cardinality': 1, 'extra_info': 'ORDERS:\nsupplier.s_suppkey ASC', 'children': [{'name': 'PROJECTION', 'timing': 6e-06, 'cardinality': 1, 'extra_info': '__internal_compress_integral_usmallint(#0, 1)\n#1\n#2\n__internal_compress_string_hugeint(#3)\n#4\n', 'children': [{'name': 'PROJECTION', 'timing': 2e-06, 'cardinality': 1, 'extra_info': 's_suppkey\ns_name\ns_address\ns_phone\ntotal_revenue\n', 'children': [{'name': 'HASH_JOIN', 'timing': 9.5e-05, 'cardinality': 1, 'extra_info': 'INNER\ns_suppkey = supplier_no\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 4\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.00067, 'cardinality': 10000, 'extra_info': 'supplier\n[INFOSEPARATOR]\ns_suppkey\ns_name\ns_address\ns_phone\n[INFOSEPARATOR]\nEC: 10000', 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.00013, 'cardinality': 1, 'extra_info': 'INNER\ntotal_revenue = SUBQUERY\n\n[INFOSEPARATOR]\nEC: 3\n', 'children': [{'name': 'PROJECTION', 'timing': 1.1e-05, 'cardinality': 10000, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n#1\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.018983, 'cardinality': 10000, 'extra_info': '#0\nsum_no_overflow(#1)', 'children': [{'name': 'PROJECTION', 'timing': 0.010761, 'cardinality': 225954, 'extra_info': 'l_suppkey\n(l_extendedprice * (1.00 - l_discount))\n', 'children': [{'name': 'PROJECTION', 'timing': 0.006567, 'cardinality': 225954, 'extra_info': '__internal_compress_integral_usmallint(#0, 1)\n#1\n#2\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.049332, 'cardinality': 225954, 'extra_info': "lineitem\n[INFOSEPARATOR]\nl_suppkey\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nFilters: l_shipdate>='1996-01-01'::DATE AND l_shipdate<'1996-04-01'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243", 'children': []}]}]}]}]}, {'name': 'UNGROUPED_AGGREGATE', 'timing': 3e-06, 'cardinality': 1, 'extra_info': 'first(#0)', 'children': [{'name': 'PROJECTION', 'timing': 0.0, 'cardinality': 1, 'extra_info': '#0\n', 'children': [{'name': 'STREAMING_LIMIT', 'timing': 3e-06, 'cardinality': 1, 'extra_info': '', 'children': [{'name': 'UNGROUPED_AGGREGATE', 'timing': 1.6e-05, 'cardinality': 1, 'extra_info': 'max(#0)', 'children': [{'name': 'PROJECTION', 'timing': 1e-06, 'cardinality': 10000, 'extra_info': 'total_revenue\n', 'children': [{'name': 'PROJECTION', 'timing': 1e-06, 'cardinality': 10000, 'extra_info': 'sum((l_extendedprice * (CAST(1 AS DECIMAL(16,2)) - l_discount)))\n', 'children': [{'name': 'PROJECTION', 'timing': 1e-05, 'cardinality': 10000, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n#1\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.01947, 'cardinality': 10000, 'extra_info': '#0\nsum_no_overflow(#1)', 'children': [{'name': 'PROJECTION', 'timing': 0.014723, 'cardinality': 225954, 'extra_info': 'l_suppkey\n(l_extendedprice * (1.00 - l_discount))\n', 'children': [{'name': 'PROJECTION', 'timing': 0.015895, 'cardinality': 225954, 'extra_info': '__internal_compress_integral_usmallint(#0, 1)\n#1\n#2\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.052403, 'cardinality': 225954, 'extra_info': "lineitem\n[INFOSEPARATOR]\nl_suppkey\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nFilters: l_shipdate>='1996-01-01'::DATE AND l_shipdate<'1996-04-01'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243", 'children': []}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}
X {'RESULT_COLLECTOR0': 1.3e-05, 'PROJECTION1': 4e-06, 'ORDER_BY2': 3.8e-05, 'PROJECTION3': 6e-06, 'PROJECTION4': 2e-06, 'HASH_JOIN5': 9.5e-05, 'SEQ_SCAN 6': 0.00067, 'HASH_JOIN7': 0.00013, 'PROJECTION8': 1.1e-05, 'HASH_GROUP_BY9': 0.018983, 'PROJECTION10': 0.010761, 'PROJECTION11': 0.006567, 'SEQ_SCAN 12': 0.049332, 'UNGROUPED_AGGREGATE13': 3e-06, 'PROJECTION14': 0.0, 'STREAMING_LIMIT15': 3e-06, 'UNGROUPED_AGGREGATE16': 1.6e-05, 'PROJECTION17': 1e-06, 'PROJECTION18': 1e-06, 'PROJECTION19': 1e-05, 'HASH_GROUP_BY20': 0.01947, 'PROJECTION21': 0.014723, 'PROJECTION22': 0.015895, 'SEQ_SCAN 23': 0.052403}
Physical operator output, input_left, input_right: 
**** output size:  1
LINEAGE_5_HASH_GROUP_BY_4
LINEAGE_5_HASH_GROUP_BY_9
LINEAGE_5_HASH_JOIN_17
LINEAGE_5_HASH_JOIN_18
LINEAGE_5_ORDER_BY_21
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_1
LINEAGE_5_SEQ_SCAN_6
LINEAGE_5_STREAMING_LIMIT_14
with revenue0 (supplier_no, total_revenue) as ( select l_suppkey, sum(l_extendedprice * (1 - l_discount)) from lineitem where l_shipdate >= date '1996-01-01' and l_shipdate < date '1996-01-01' + interval '3' month group by l_suppkey ) SELECT s_suppkey, s_name, s_address, s_phone, total_revenue FROM supplier, revenue0 WHERE s_suppkey = supplier_no AND total_revenue = ( SELECT max(total_revenue) FROM revenue0) ORDER BY s_suppkey;
   query_id  ...                                               plan
0         5  ...  {"name": "PROJECTION", "opid": "22", "children...

[1 rows x 8 columns]
Query info:  query_id                                                            5
query               with revenue0 (supplier_no, total_revenue) as ...
size_bytes_max                                                2439958
physical_op_size    [434872, 0, 64, 0, 0, 1040, 361, 692, 0, 87330...
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "PROJECTION", "opid": "22", "children...
Name: 0, dtype: object
physical op size is:
{"name": "PROJECTION", "opid": "22", "children": [{"name": "ORDER_BY", "opid": "21", "children": [{"name": "PROJECTION", "opid": "20", "children": [{"name": "PROJECTION", "opid": "19", "children": [{"name": "HASH_JOIN", "opid": "18", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "supplier","extra": "supplier\n[INFOSEPARATOR]\ns_suppkey\ns_name\ns_address\ns_phone\n[INFOSEPARATOR]\nEC: 10000"},{"name": "HASH_JOIN", "opid": "17", "children": [{"name": "PROJECTION", "opid": "5", "children": [{"name": "HASH_GROUP_BY", "opid": "4", "children": [{"name": "PROJECTION", "opid": "3", "children": [{"name": "PROJECTION", "opid": "2", "children": [{"name": "SEQ_SCAN ", "opid": "1", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_suppkey\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nFilters: l_shipdate>='1996-01-01'::DATE AND l_shipdate<'1996-04-01'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243"}],"table": "","extra": "__internal_compress_integral_usmallint(#0, 1)\n#1\n#2\n"}],"table": "","extra": "l_suppkey\n(l_extendedprice * (1.00 - l_discount))\n"}],"table": "","extra": "#0\nsum_no_overflow(#1)"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n#1\n"},{"name": "UNGROUPED_AGGREGATE", "opid": "16", "children": [{"name": "PROJECTION", "opid": "15", "children": [{"name": "STREAMING_LIMIT", "opid": "14", "children": [{"name": "UNGROUPED_AGGREGATE", "opid": "13", "children": [{"name": "PROJECTION", "opid": "12", "children": [{"name": "PROJECTION", "opid": "11", "children": [{"name": "PROJECTION", "opid": "10", "children": [{"name": "HASH_GROUP_BY", "opid": "9", "children": [{"name": "PROJECTION", "opid": "8", "children": [{"name": "PROJECTION", "opid": "7", "children": [{"name": "SEQ_SCAN ", "opid": "6", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_suppkey\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nFilters: l_shipdate>='1996-01-01'::DATE AND l_shipdate<'1996-04-01'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243"}],"table": "","extra": "__internal_compress_integral_usmallint(#0, 1)\n#1\n#2\n"}],"table": "","extra": "l_suppkey\n(l_extendedprice * (1.00 - l_discount))\n"}],"table": "","extra": "#0\nsum_no_overflow(#1)"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n#1\n"}],"table": "","extra": "sum((l_extendedprice * (CAST(1 AS DECIMAL(16,2)) - l_discount)))\n"}],"table": "","extra": "total_revenue\n"}],"table": "","extra": "max(#0)"}],"table": "","extra": ""}],"table": "","extra": "#0\n"}],"table": "","extra": "first(#0)"}],"table": "","extra": "INNER\ntotal_revenue = SUBQUERY\n\n[INFOSEPARATOR]\nEC: 3\n"}],"table": "","extra": "INNER\ns_suppkey = supplier_no\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 4\n"}],"table": "","extra": "s_suppkey\ns_name\ns_address\ns_phone\ntotal_revenue\n"}],"table": "","extra": "__internal_compress_integral_usmallint(#0, 1)\n#1\n#2\n__internal_compress_string_hugeint(#3)\n#4\n"}],"table": "","extra": "ORDERS:\nsupplier.s_suppkey ASC"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n#1\n#2\n__internal_decompress_string(#3)\n#4\n"}
Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│__internal_decompress_strin│                                                                                       
│           g(#0)           │                                                                                       
│             #1            │                                                                                       
│__internal_decompress_integ│                                                                                       
│     ral_integer(#2, 1)    │                                                                                       
│             #3            │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│          ORDER_BY         │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│          ORDERS:          │                                                                                       
│  count(DISTINCT partsupp  │                                                                                       
│     .ps_suppkey) DESC     │                                                                                       
│      part.p_brand ASC     │                                                                                       
│      part.p_type ASC      │                                                                                       
│      part.p_size ASC      │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│__internal_compress_string_│                                                                                       
│        hugeint(#0)        │                                                                                       
│             #1            │                                                                                       
│__internal_compress_integra│                                                                                       
│     l_utinyint(#2, 1)     │                                                                                       
│             #3            │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│__internal_decompress_strin│                                                                                       
│           g(#0)           │                                                                                       
│             #1            │                                                                                       
│__internal_decompress_integ│                                                                                       
│     ral_integer(#2, 1)    │                                                                                       
│             #3            │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│       HASH_GROUP_BY       │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│             #0            │                                                                                       
│             #1            │                                                                                       
│             #2            │                                                                                       
│     count(DISTINCT #3)    │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│          p_brand          │                                                                                       
│           p_type          │                                                                                       
│           p_size          │                                                                                       
│         ps_suppkey        │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│             #0            │                                                                                       
│__internal_compress_string_│                                                                                       
│        hugeint(#1)        │                                                                                       
│             #2            │                                                                                       
│__internal_compress_integra│                                                                                       
│     l_utinyint(#3, 1)     │                                                                                       
│             #4            │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│             #1            │                                                                                       
│             #3            │                                                                                       
│             #4            │                                                                                       
│             #5            │                                                                                       
│             #6            │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│           FILTER          │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│       (NOT SUBQUERY)      │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│         EC: 33778         │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         HASH_JOIN         │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│            MARK           │                                                                                       
│      ps_suppkey = #0      ├────────────────────────────────────────────────────────────────────────┐              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                        │              
│         EC: 168893        │                                                                        │              
└─────────────┬─────────────┘                                                                        │                                           
┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐
│         HASH_JOIN         │                                                          │         PROJECTION        │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│           INNER           │                                                          │         s_suppkey         │
│   ps_partkey = p_partkey  │                                                          │                           │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐                                           │                           │
│        Build Min: 1       │              │                                           │                           │
│     Build Max: 200000     │              │                                           │                           │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                           │                           │
│         EC: 168893        │              │                                           │                           │
└─────────────┬─────────────┘              │                                           └─────────────┬─────────────┘                             
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐
│         SEQ_SCAN          ││           FILTER          │                             │           FILTER          │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│          partsupp         ││ (IN (...) AND (p_brand != │                             │  (s_comment ~~ '%Customer │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││'Brand#45') AND (NOT prefix│                             │       %Complaints%')      │
│         ps_partkey        ││(p_type, 'MEDIUM POLIS...  │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│         ps_suppkey        ││             )             │                             │          EC: 2000         │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │                           │
│         EC: 800000        ││         EC: 40000         │                             │                           │
└───────────────────────────┘└─────────────┬─────────────┘                             └─────────────┬─────────────┘                             
                             ┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐
                             │         HASH_JOIN         │                             │         SEQ_SCAN          │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                             │            MARK           │                             │          supplier         │
                             │        p_size = #0        │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐              │         s_comment         │
                             │         EC: 200000        │              │              │         s_suppkey         │
                             │                           │              │              │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                             │                           │              │              │         EC: 10000         │
                             └─────────────┬─────────────┘              │              └───────────────────────────┘                             
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             
                             │         SEQ_SCAN          ││      COLUMN_DATA_SCAN     │                             
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                             
                             │            part           ││                           │                             
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                             
                             │         p_partkey         ││                           │                             
                             │          p_brand          ││                           │                             
                             │           p_type          ││                           │                             
                             │           p_size          ││                           │                             
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                             
                             │         EC: 200000        ││                           │                             
                             └───────────────────────────┘└───────────────────────────┘                                                          

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

%%%%%%%%%%%%%%%% Running Query #  16  threads:  1
SELECT p_brand, p_type, p_size, count(DISTINCT ps_suppkey) AS supplier_cnt FROM partsupp, part WHERE p_partkey = ps_partkey AND p_brand <> 'Brand#45' AND p_type NOT LIKE 'MEDIUM POLISHED%' AND p_size IN (49, 14, 23, 45, 19, 3, 36, 9) AND ps_suppkey NOT IN ( SELECT s_suppkey FROM supplier WHERE s_comment LIKE '%Customer%Complaints%') GROUP BY p_brand, p_type, p_size ORDER BY supplier_cnt DESC, p_brand, p_type, p_size;
Run:  None SELECT p_brand, p_type, p_size, count(DISTINCT ps_suppkey) AS supplier_cnt FROM partsupp, part WHERE p_partkey = ps_partkey AND p_brand <> 'Brand#45' AND p_type NOT LIKE 'MEDIUM POLISHED%' AND p_size IN (49, 14, 23, 45, 19, 3, 36, 9) AND ps_suppkey NOT IN ( SELECT s_suppkey FROM supplier WHERE s_comment LIKE '%Customer%Complaints%') GROUP BY p_brand, p_type, p_size ORDER BY supplier_cnt DESC, p_brand, p_type, p_size;
Avg Time in sec:  0.09270177781581879  output size:  18314
        p_brand                    p_type  p_size  supplier_cnt
0      Brand#41        MEDIUM BRUSHED TIN       3            28
1      Brand#54   STANDARD BRUSHED COPPER      14            27
2      Brand#11      STANDARD BRUSHED TIN      23            24
3      Brand#11  STANDARD BURNISHED BRASS      36            24
4      Brand#15    MEDIUM ANODIZED NICKEL       3            24
...         ...                       ...     ...           ...
18309  Brand#52      MEDIUM BRUSHED BRASS      45             3
18310  Brand#53        MEDIUM BRUSHED TIN      45             3
18311  Brand#54    ECONOMY POLISHED BRASS       9             3
18312  Brand#55        PROMO PLATED BRASS      19             3
18313  Brand#55       STANDARD PLATED TIN      49             3

[18314 rows x 4 columns]
{'name': 'Query', 'result': 0.088124, 'timing': 0.088124, 'cardinality': 0, 'extra-info': "SELECT p_brand, p_type, p_size, count(DISTINCT ps_suppkey) AS supplier_cnt FROM partsupp, part WHERE p_partkey = ps_partkey AND p_brand <> 'Brand#45' AND p_type NOT LIKE 'MEDIUM POLISHED%' AND p_size IN (49, 14, 23, 45, 19, 3, 36, 9) AND ps_suppkey NOT IN ( SELECT s_suppkey FROM supplier WHERE s_comment LIKE '%Customer%Complaints%') GROUP BY p_brand, p_type, p_size ORDER BY supplier_cnt DESC, p_brand, p_type, p_size;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 0.001085, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 0.000355, 'cardinality': 18314, 'extra_info': '__internal_decompress_string(#0)\n#1\n__internal_decompress_integral_integer(#2, 1)\n#3\n', 'children': [{'name': 'ORDER_BY', 'timing': 0.001687, 'cardinality': 18314, 'extra_info': 'ORDERS:\ncount(DISTINCT partsupp.ps_suppkey) DESC\npart.p_brand ASC\npart.p_type ASC\npart.p_size ASC', 'children': [{'name': 'PROJECTION', 'timing': 0.000172, 'cardinality': 18314, 'extra_info': '__internal_compress_string_hugeint(#0)\n#1\n__internal_compress_integral_utinyint(#2, 1)\n#3\n', 'children': [{'name': 'PROJECTION', 'timing': 0.000362, 'cardinality': 18314, 'extra_info': '__internal_decompress_string(#0)\n#1\n__internal_decompress_integral_integer(#2, 1)\n#3\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.02102, 'cardinality': 18314, 'extra_info': '#0\n#1\n#2\ncount(DISTINCT #3)', 'children': [{'name': 'PROJECTION', 'timing': 0.000147, 'cardinality': 118274, 'extra_info': 'p_brand\np_type\np_size\nps_suppkey\n', 'children': [{'name': 'PROJECTION', 'timing': 0.004255, 'cardinality': 118274, 'extra_info': '#0\n__internal_compress_string_hugeint(#1)\n#2\n__internal_compress_integral_utinyint(#3, 1)\n#4\n', 'children': [{'name': 'PROJECTION', 'timing': 0.000207, 'cardinality': 118274, 'extra_info': '#1\n#3\n#4\n#5\n#6\n', 'children': [{'name': 'FILTER', 'timing': 0.001072, 'cardinality': 118274, 'extra_info': '(NOT SUBQUERY)\n[INFOSEPARATOR]\nEC: 33778', 'children': [{'name': 'HASH_JOIN', 'timing': 0.004782, 'cardinality': 118324, 'extra_info': 'MARK\nps_suppkey = #0\n\n[INFOSEPARATOR]\nEC: 168893\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.011062, 'cardinality': 118324, 'extra_info': 'INNER\nps_partkey = p_partkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 168893\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.001967, 'cardinality': 800000, 'extra_info': 'partsupp\n[INFOSEPARATOR]\nps_partkey\nps_suppkey\n[INFOSEPARATOR]\nEC: 800000', 'children': []}, {'name': 'FILTER', 'timing': 0.002033, 'cardinality': 29581, 'extra_info': "(IN (...) AND (p_brand != 'Brand#45') AND (NOT prefix(p_type, 'MEDIUM POLISHED')))\n[INFOSEPARATOR]\nEC: 40000", 'children': [{'name': 'HASH_JOIN', 'timing': 0.001724, 'cardinality': 200000, 'extra_info': 'MARK\np_size = #0\n\n[INFOSEPARATOR]\nEC: 200000\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.007925, 'cardinality': 200000, 'extra_info': 'part\n[INFOSEPARATOR]\np_partkey\np_brand\np_type\np_size\n[INFOSEPARATOR]\nEC: 200000', 'children': []}, {'name': 'COLUMN_DATA_SCAN', 'timing': 6e-06, 'cardinality': 8, 'extra_info': '', 'children': []}]}]}]}, {'name': 'PROJECTION', 'timing': 1e-06, 'cardinality': 4, 'extra_info': 's_suppkey\n', 'children': [{'name': 'FILTER', 'timing': 0.000257, 'cardinality': 4, 'extra_info': "(s_comment ~~ '%Customer%Complaints%')\n[INFOSEPARATOR]\nEC: 2000", 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.000401, 'cardinality': 10000, 'extra_info': 'supplier\n[INFOSEPARATOR]\ns_comment\ns_suppkey\n[INFOSEPARATOR]\nEC: 10000', 'children': []}]}]}]}]}]}]}]}]}]}]}]}]}]}]}
X {'RESULT_COLLECTOR0': 0.001085, 'PROJECTION1': 0.000355, 'ORDER_BY2': 0.001687, 'PROJECTION3': 0.000172, 'PROJECTION4': 0.000362, 'HASH_GROUP_BY5': 0.02102, 'PROJECTION6': 0.000147, 'PROJECTION7': 0.004255, 'PROJECTION8': 0.000207, 'FILTER9': 0.001072, 'HASH_JOIN10': 0.004782, 'HASH_JOIN11': 0.011062, 'SEQ_SCAN 12': 0.001967, 'FILTER13': 0.002033, 'HASH_JOIN14': 0.001724, 'SEQ_SCAN 15': 0.007925, 'COLUMN_DATA_SCAN16': 6e-06, 'PROJECTION17': 1e-06, 'FILTER18': 0.000257, 'SEQ_SCAN 19': 0.000401}
Physical operator output, input_left, input_right: 
**** output size:  18314
LINEAGE_5_COLUMN_DATA_SCAN_2
LINEAGE_5_FILTER_10
LINEAGE_5_FILTER_4
LINEAGE_5_FILTER_7
LINEAGE_5_HASH_GROUP_BY_14
LINEAGE_5_HASH_JOIN_3
LINEAGE_5_HASH_JOIN_5
LINEAGE_5_HASH_JOIN_9
LINEAGE_5_ORDER_BY_17
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_1
LINEAGE_5_SEQ_SCAN_6
SELECT p_brand, p_type, p_size, count(DISTINCT ps_suppkey) AS supplier_cnt FROM partsupp, part WHERE p_partkey = ps_partkey AND p_brand <> 'Brand#45' AND p_type NOT LIKE 'MEDIUM POLISHED%' AND p_size IN (49, 14, 23, 45, 19, 3, 36, 9) AND ps_suppkey NOT IN ( SELECT s_suppkey FROM supplier WHERE s_comment LIKE '%Customer%Complaints%') GROUP BY p_brand, p_type, p_size ORDER BY supplier_cnt DESC, p_brand, p_type, p_size;
   query_id  ...                                               plan
0         5  ...  {"name": "PROJECTION", "opid": "18", "children...

[1 rows x 8 columns]
Query info:  query_id                                                            5
query               SELECT p_brand, p_type, p_size, count(DISTINCT...
size_bytes_max                                                 564621
physical_op_size    [967, 0, 37875, 0, 0, 57055, 0, 0, 0, 3225, 28...
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "PROJECTION", "opid": "18", "children...
Name: 0, dtype: object
physical op size is:
{"name": "PROJECTION", "opid": "18", "children": [{"name": "ORDER_BY", "opid": "17", "children": [{"name": "PROJECTION", "opid": "16", "children": [{"name": "PROJECTION", "opid": "15", "children": [{"name": "HASH_GROUP_BY", "opid": "14", "children": [{"name": "PROJECTION", "opid": "13", "children": [{"name": "PROJECTION", "opid": "12", "children": [{"name": "PROJECTION", "opid": "11", "children": [{"name": "FILTER", "opid": "10", "children": [{"name": "HASH_JOIN", "opid": "9", "children": [{"name": "HASH_JOIN", "opid": "5", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "partsupp","extra": "partsupp\n[INFOSEPARATOR]\nps_partkey\nps_suppkey\n[INFOSEPARATOR]\nEC: 800000"},{"name": "FILTER", "opid": "4", "children": [{"name": "HASH_JOIN", "opid": "3", "children": [{"name": "SEQ_SCAN ", "opid": "1", "children": [],"table": "part","extra": "part\n[INFOSEPARATOR]\np_partkey\np_brand\np_type\np_size\n[INFOSEPARATOR]\nEC: 200000"},{"name": "COLUMN_DATA_SCAN", "opid": "2", "children": [],"table": "","extra": ""}],"table": "","extra": "MARK\np_size = #0\n\n[INFOSEPARATOR]\nEC: 200000\n"}],"table": "","extra": "(IN (...) AND (p_brand != 'Brand#45') AND (NOT prefix(p_type, 'MEDIUM POLISHED')))\n[INFOSEPARATOR]\nEC: 40000"}],"table": "","extra": "INNER\nps_partkey = p_partkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 168893\n"},{"name": "PROJECTION", "opid": "8", "children": [{"name": "FILTER", "opid": "7", "children": [{"name": "SEQ_SCAN ", "opid": "6", "children": [],"table": "supplier","extra": "supplier\n[INFOSEPARATOR]\ns_comment\ns_suppkey\n[INFOSEPARATOR]\nEC: 10000"}],"table": "","extra": "(s_comment ~~ '%Customer%Complaints%')\n[INFOSEPARATOR]\nEC: 2000"}],"table": "","extra": "s_suppkey\n"}],"table": "","extra": "MARK\nps_suppkey = #0\n\n[INFOSEPARATOR]\nEC: 168893\n"}],"table": "","extra": "(NOT SUBQUERY)\n[INFOSEPARATOR]\nEC: 33778"}],"table": "","extra": "#1\n#3\n#4\n#5\n#6\n"}],"table": "","extra": "#0\n__internal_compress_string_hugeint(#1)\n#2\n__internal_compress_integral_utinyint(#3, 1)\n#4\n"}],"table": "","extra": "p_brand\np_type\np_size\nps_suppkey\n"}],"table": "","extra": "#0\n#1\n#2\ncount(DISTINCT #3)"}],"table": "","extra": "__internal_decompress_string(#0)\n#1\n__internal_decompress_integral_integer(#2, 1)\n#3\n"}],"table": "","extra": "__internal_compress_string_hugeint(#0)\n#1\n__internal_compress_integral_utinyint(#2, 1)\n#3\n"}],"table": "","extra": "ORDERS:\ncount(DISTINCT partsupp.ps_suppkey) DESC\npart.p_brand ASC\npart.p_type ASC\npart.p_size ASC"}],"table": "","extra": "__internal_decompress_string(#0)\n#1\n__internal_decompress_integral_integer(#2, 1)\n#3\n"}
Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                                                                                                                    
│         PROJECTION        │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│         avg_yearly        │                                                                                                                    
└─────────────┬─────────────┘                                                                                                                                                 
┌─────────────┴─────────────┐                                                                                                                    
│    UNGROUPED_AGGREGATE    │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│          sum(#0)          │                                                                                                                    
└─────────────┬─────────────┘                                                                                                                                                 
┌─────────────┴─────────────┐                                                                                                                    
│         PROJECTION        │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│      l_extendedprice      │                                                                                                                    
└─────────────┬─────────────┘                                                                                                                                                 
┌─────────────┴─────────────┐                                                                                                                    
│         PROJECTION        │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│             #0            │                                                                                                                    
│             #3            │                                                                                                                    
│             #4            │                                                                                                                    
└─────────────┬─────────────┘                                                                                                                                                 
┌─────────────┴─────────────┐                                                                                                                    
│           FILTER          │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│(CAST(l_quantity AS DOUBLE)│                                                                                                                    
│         < SUBQUERY)       │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│        EC: 3000607        │                                                                                                                    
└─────────────┬─────────────┘                                                                                                                                                 
┌─────────────┴─────────────┐                                                                                                                    
│      RIGHT_DELIM_JOIN     │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│           RIGHT           │                                                                                                                    
│ p_partkey IS NOT DISTINCT ├───────────────────────────────────────────┐                                                                        
│       FROM p_partkey      │                                           │                                                                        
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                           │                                                                        
│        EC: 3000607        │                                           │                                                                        
└─────────────┬─────────────┘                                           │                                                                                                     
┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐                                                          
│         HASH_JOIN         │                             │         HASH_JOIN         │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│           INNER           │                             │           RIGHT           │                                                          
│   l_partkey = p_partkey   │                             │ p_partkey IS NOT DISTINCT │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐              │       FROM p_partkey      ├───────────────────────────────────────────┐              
│        Build Min: 1       │              │              │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                           │              
│     Build Max: 200000     │              │              │        EC: 3000607        │                                           │              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              │                           │                                           │              
│         EC: 80175         │              │              │                           │                                           │              
└─────────────┬─────────────┘              │              └─────────────┬─────────────┘                                           │                                           
┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐
│         SEQ_SCAN          ││         SEQ_SCAN          ││         PROJECTION        │                             │         DUMMY_SCAN        │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │                           │
│          lineitem         ││            part           ││  (0.2 * avg(l_quantity))  │                             │                           │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││         p_partkey         │                             │                           │
│         l_partkey         ││         p_partkey         ││                           │                             │                           │
│         l_quantity        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                             │                           │
│      l_extendedprice      ││Filters: p_brand='Brand#23'││                           │                             │                           │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   AND p_brand IS NOT NULL ││                           │                             │                           │
│        EC: 6001215        ││ p_container='MED BOX' AND ││                           │                             │                           │
│                           ││   p_container IS NOT NULL ││                           │                             │                           │
│                           ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                             │                           │
│                           ││          EC: 5000         ││                           │                             │                           │
└───────────────────────────┘└───────────────────────────┘└─────────────┬─────────────┘                             └───────────────────────────┘                             
                                                          ┌─────────────┴─────────────┐                                                          
                                                          │         PROJECTION        │                                                          
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                          │__internal_decompress_integ│                                                          
                                                          │     ral_bigint(#0, 1)     │                                                          
                                                          │             #1            │                                                          
                                                          └─────────────┬─────────────┘                                                                                       
                                                          ┌─────────────┴─────────────┐                                                          
                                                          │       HASH_GROUP_BY       │                                                          
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                          │             #0            │                                                          
                                                          │          avg(#1)          │                                                          
                                                          └─────────────┬─────────────┘                                                                                       
                                                          ┌─────────────┴─────────────┐                                                          
                                                          │         PROJECTION        │                                                          
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                          │         p_partkey         │                                                          
                                                          │         l_quantity        │                                                          
                                                          └─────────────┬─────────────┘                                                                                       
                                                          ┌─────────────┴─────────────┐                                                          
                                                          │         PROJECTION        │                                                          
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                          │__internal_compress_integra│                                                          
                                                          │     l_uinteger(#0, 1)     │                                                          
                                                          │             #1            │                                                          
                                                          │             #2            │                                                          
                                                          └─────────────┬─────────────┘                                                                                       
                                                          ┌─────────────┴─────────────┐                                                          
                                                          │         HASH_JOIN         │                                                          
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                          │           INNER           │                                                          
                                                          │   l_partkey = p_partkey   ├──────────────┐                                           
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                           
                                                          │        EC: 6001215        │              │                                           
                                                          └─────────────┬─────────────┘              │                                                                        
                                                          ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             
                                                          │         SEQ_SCAN          ││         DELIM_SCAN        │                             
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                             
                                                          │          lineitem         ││                           │                             
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                             
                                                          │         l_partkey         ││                           │                             
                                                          │         l_quantity        ││                           │                             
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                             
                                                          │        EC: 6001215        ││                           │                             
                                                          └───────────────────────────┘└───────────────────────────┘                                                          

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

%%%%%%%%%%%%%%%% Running Query #  17  threads:  1
SELECT sum(l_extendedprice) / 7.0 AS avg_yearly FROM lineitem, part WHERE p_partkey = l_partkey AND p_brand = 'Brand#23' AND p_container = 'MED BOX' AND l_quantity < ( SELECT 0.2 * avg(l_quantity) FROM lineitem WHERE l_partkey = p_partkey);
Run:  None SELECT sum(l_extendedprice) / 7.0 AS avg_yearly FROM lineitem, part WHERE p_partkey = l_partkey AND p_brand = 'Brand#23' AND p_container = 'MED BOX' AND l_quantity < ( SELECT 0.2 * avg(l_quantity) FROM lineitem WHERE l_partkey = p_partkey);
Avg Time in sec:  0.14719471987336874  output size:  1
      avg_yearly
0  348406.054286
{'name': 'Query', 'result': 0.143319, 'timing': 0.143319, 'cardinality': 0, 'extra-info': "SELECT sum(l_extendedprice) / 7.0 AS avg_yearly FROM lineitem, part WHERE p_partkey = l_partkey AND p_brand = 'Brand#23' AND p_container = 'MED BOX' AND l_quantity < ( SELECT 0.2 * avg(l_quantity) FROM lineitem WHERE l_partkey = p_partkey);", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 5e-06, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 4e-06, 'cardinality': 1, 'extra_info': 'avg_yearly\n', 'children': [{'name': 'UNGROUPED_AGGREGATE', 'timing': 6e-06, 'cardinality': 1, 'extra_info': 'sum(#0)', 'children': [{'name': 'PROJECTION', 'timing': 0.0, 'cardinality': 587, 'extra_info': 'l_extendedprice\n', 'children': [{'name': 'PROJECTION', 'timing': 1e-06, 'cardinality': 587, 'extra_info': '#0\n#3\n#4\n', 'children': [{'name': 'FILTER', 'timing': 0.000318, 'cardinality': 587, 'extra_info': '(CAST(l_quantity AS DOUBLE) < SUBQUERY)\n[INFOSEPARATOR]\nEC: 3000607', 'children': [{'name': 'RIGHT_DELIM_JOIN', 'timing': 0.001402, 'cardinality': 0, 'extra_info': 'RIGHT\np_partkey IS NOT DISTINCT FROM p_partkey\n\n[INFOSEPARATOR]\nEC: 3000607\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.03259, 'cardinality': 6088, 'extra_info': 'INNER\nl_partkey = p_partkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 80175\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.013592, 'cardinality': 6001215, 'extra_info': 'lineitem\n[INFOSEPARATOR]\nl_partkey\nl_quantity\nl_extendedprice\n[INFOSEPARATOR]\nEC: 6001215', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 0.008314, 'cardinality': 204, 'extra_info': "part\n[INFOSEPARATOR]\np_partkey\n[INFOSEPARATOR]\nFilters: p_brand='Brand#23' AND p_brand IS NOT NULL\np_container='MED BOX' AND p_container IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 5000", 'children': []}]}, {'name': 'HASH_JOIN', 'timing': 0.000476, 'cardinality': 6088, 'extra_info': 'RIGHT\np_partkey IS NOT DISTINCT FROM p_partkey\n\n[INFOSEPARATOR]\nEC: 3000607\n', 'children': [{'name': 'PROJECTION', 'timing': 3e-06, 'cardinality': 204, 'extra_info': '(0.2 * avg(l_quantity))\np_partkey\n', 'children': [{'name': 'PROJECTION', 'timing': 3e-06, 'cardinality': 204, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n#1\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.000814, 'cardinality': 204, 'extra_info': '#0\navg(#1)', 'children': [{'name': 'PROJECTION', 'timing': 2e-06, 'cardinality': 6088, 'extra_info': 'p_partkey\nl_quantity\n', 'children': [{'name': 'PROJECTION', 'timing': 2.4e-05, 'cardinality': 6088, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n#1\n#2\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.06573, 'cardinality': 6088, 'extra_info': 'INNER\nl_partkey = p_partkey\n\n[INFOSEPARATOR]\nEC: 6001215\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.009328, 'cardinality': 6001215, 'extra_info': 'lineitem\n[INFOSEPARATOR]\nl_partkey\nl_quantity\n[INFOSEPARATOR]\nEC: 6001215', 'children': []}, {'name': 'DELIM_SCAN', 'timing': 0.0, 'cardinality': 0, 'extra_info': '', 'children': []}]}]}]}]}]}]}, {'name': 'DUMMY_SCAN', 'timing': 0.0, 'cardinality': 0, 'extra_info': '', 'children': []}]}, {'name': 'HASH_GROUP_BY', 'timing': 1.8e-05, 'cardinality': 204, 'extra_info': '#0', 'children': []}]}]}]}]}]}]}]}]}
X {'RESULT_COLLECTOR0': 5e-06, 'PROJECTION1': 4e-06, 'UNGROUPED_AGGREGATE2': 6e-06, 'PROJECTION3': 0.0, 'PROJECTION4': 1e-06, 'FILTER5': 0.000318, 'RIGHT_DELIM_JOIN6': 0.001402, 'HASH_JOIN7': 0.03259, 'SEQ_SCAN 8': 0.013592, 'SEQ_SCAN 9': 0.008314, 'HASH_JOIN10': 0.000476, 'PROJECTION11': 3e-06, 'PROJECTION12': 3e-06, 'HASH_GROUP_BY13': 0.000814, 'PROJECTION14': 2e-06, 'PROJECTION15': 2.4e-05, 'HASH_JOIN16': 0.06573, 'SEQ_SCAN 17': 0.009328, 'DELIM_SCAN18': 0.0, 'DUMMY_SCAN19': 0.0, 'HASH_GROUP_BY20': 1.8e-05}
Physical operator output, input_left, input_right: 
**** output size:  1
LINEAGE_5_FILTER_15
LINEAGE_5_HASH_GROUP_BY_13
LINEAGE_5_HASH_GROUP_BY_8
LINEAGE_5_HASH_JOIN_12
LINEAGE_5_HASH_JOIN_2
LINEAGE_5_HASH_JOIN_5
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_1
LINEAGE_5_SEQ_SCAN_3
SELECT sum(l_extendedprice) / 7.0 AS avg_yearly FROM lineitem, part WHERE p_partkey = l_partkey AND p_brand = 'Brand#23' AND p_container = 'MED BOX' AND l_quantity < ( SELECT 0.2 * avg(l_quantity) FROM lineitem WHERE l_partkey = p_partkey);
   query_id  ...                                               plan
0         5  ...  {"name": "PROJECTION", "opid": "19", "children...

[1 rows x 8 columns]
Query info:  query_id                                                            5
query               SELECT sum(l_extendedprice) / 7.0 AS avg_yearl...
size_bytes_max                                                 327446
physical_op_size    [2101, 0, 0, 0, 0, 1922, 37311, 90145, 21654, ...
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "PROJECTION", "opid": "19", "children...
Name: 0, dtype: object
physical op size is:
{"name": "PROJECTION", "opid": "19", "children": [{"name": "UNGROUPED_AGGREGATE", "opid": "18", "children": [{"name": "PROJECTION", "opid": "17", "children": [{"name": "PROJECTION", "opid": "16", "children": [{"name": "FILTER", "opid": "15", "children": [{"name": "RIGHT_DELIM_JOIN", "opid": "14", "children": [{"name": "HASH_GROUP_BY", "opid": "13", "children": [],"table": "","extra": "#0"},{"name": "HASH_JOIN", "opid": "12", "children": [{"name": "PROJECTION", "opid": "10", "children": [{"name": "PROJECTION", "opid": "9", "children": [{"name": "HASH_GROUP_BY", "opid": "8", "children": [{"name": "PROJECTION", "opid": "7", "children": [{"name": "PROJECTION", "opid": "6", "children": [{"name": "HASH_JOIN", "opid": "5", "children": [{"name": "SEQ_SCAN ", "opid": "3", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_partkey\nl_quantity\n[INFOSEPARATOR]\nEC: 6001215"},{"name": "DELIM_SCAN", "opid": "4", "children": [],"table": "","extra": ""}],"table": "","extra": "INNER\nl_partkey = p_partkey\n\n[INFOSEPARATOR]\nEC: 6001215\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n#1\n#2\n"}],"table": "","extra": "p_partkey\nl_quantity\n"}],"table": "","extra": "#0\navg(#1)"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n#1\n"}],"table": "","extra": "(0.2 * avg(l_quantity))\np_partkey\n"},{"name": "DUMMY_SCAN", "opid": "11", "children": [],"table": "","extra": ""}],"table": "","extra": "RIGHT\np_partkey IS NOT DISTINCT FROM p_partkey\n\n[INFOSEPARATOR]\nEC: 3000607\n"},{"name": "HASH_JOIN", "opid": "2", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_partkey\nl_quantity\nl_extendedprice\n[INFOSEPARATOR]\nEC: 6001215"},{"name": "SEQ_SCAN ", "opid": "1", "children": [],"table": "part","extra": "part\n[INFOSEPARATOR]\np_partkey\n[INFOSEPARATOR]\nFilters: p_brand='Brand#23' AND p_brand IS NOT NULL\np_container='MED BOX' AND p_container IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 5000"}],"table": "","extra": "INNER\nl_partkey = p_partkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 80175\n"}],"table": "","extra": "RIGHT\np_partkey IS NOT DISTINCT FROM p_partkey\n\n[INFOSEPARATOR]\nEC: 3000607\n"}],"table": "","extra": "(CAST(l_quantity AS DOUBLE) < SUBQUERY)\n[INFOSEPARATOR]\nEC: 3000607"}],"table": "","extra": "#0\n#3\n#4\n"}],"table": "","extra": "l_extendedprice\n"}],"table": "","extra": "sum(#0)"}],"table": "","extra": "avg_yearly\n"}
Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                                                                                       
│      STREAMING_LIMIT      │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│             #0            │                                                                                       
│__internal_decompress_integ│                                                                                       
│     ral_bigint(#1, 1)     │                                                                                       
│__internal_decompress_integ│                                                                                       
│     ral_bigint(#2, 1)     │                                                                                       
│             #3            │                                                                                       
│             #4            │                                                                                       
│             #5            │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│          ORDER_BY         │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│          ORDERS:          │                                                                                       
│  orders.o_totalprice DESC │                                                                                       
│   orders.o_orderdate ASC  │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│             #0            │                                                                                       
│__internal_compress_integra│                                                                                       
│     l_uinteger(#1, 1)     │                                                                                       
│__internal_compress_integra│                                                                                       
│     l_uinteger(#2, 1)     │                                                                                       
│             #3            │                                                                                       
│             #4            │                                                                                       
│             #5            │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│             #0            │                                                                                       
│__internal_decompress_integ│                                                                                       
│     ral_bigint(#1, 1)     │                                                                                       
│__internal_decompress_integ│                                                                                       
│     ral_bigint(#2, 1)     │                                                                                       
│             #3            │                                                                                       
│             #4            │                                                                                       
│             #5            │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│       HASH_GROUP_BY       │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│             #0            │                                                                                       
│             #1            │                                                                                       
│             #2            │                                                                                       
│             #3            │                                                                                       
│             #4            │                                                                                       
│          sum(#5)          │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│           c_name          │                                                                                       
│         c_custkey         │                                                                                       
│         o_orderkey        │                                                                                       
│        o_orderdate        │                                                                                       
│        o_totalprice       │                                                                                       
│         l_quantity        │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│__internal_compress_integra│                                                                                       
│     l_uinteger(#0, 1)     │                                                                                       
│             #1            │                                                                                       
│__internal_compress_integra│                                                                                       
│     l_uinteger(#2, 1)     │                                                                                       
│__internal_compress_integra│                                                                                       
│     l_uinteger(#3, 1)     │                                                                                       
│             #4            │                                                                                       
│             #5            │                                                                                       
│             #6            │                                                                                       
│__internal_compress_integra│                                                                                       
│     l_uinteger(#7, 1)     │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         HASH_JOIN         │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│           INNER           │                                                                                       
│      o_orderkey = #0      ├────────────────────────────────────────────────────────────────────────┐              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                        │              
│        EC: 3618677        │                                                                        │              
└─────────────┬─────────────┘                                                                        │                                           
┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐
│         HASH_JOIN         │                                                          │         PROJECTION        │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│           INNER           │                                                          │__internal_decompress_integ│
│  l_orderkey = o_orderkey  ├──────────────┐                                           │     ral_bigint(#0, 1)     │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                           │                           │
│        EC: 3618677        │              │                                           │                           │
└─────────────┬─────────────┘              │                                           └─────────────┬─────────────┘                             
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐
│         SEQ_SCAN          ││         HASH_JOIN         │                             │       HASH_GROUP_BY       │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│          lineitem         ││           INNER           │                             │             #0            │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   o_custkey = c_custkey   │                             │                           │
│         l_orderkey        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐              │                           │
│         l_quantity        ││        Build Min: 1       │              │              │                           │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││     Build Max: 149999     │              │              │                           │
│        EC: 6001215        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              │                           │
│                           ││         EC: 904486        │              │              │                           │
└───────────────────────────┘└─────────────┬─────────────┘              │              └─────────────┬─────────────┘                             
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐
                             │         SEQ_SCAN          ││         SEQ_SCAN          ││         PROJECTION        │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                             │           orders          ││          customer         ││             #0            │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │
                             │         o_orderkey        ││         c_custkey         ││                           │
                             │         o_custkey         ││           c_name          ││                           │
                             │        o_orderdate        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │
                             │        o_totalprice       ││ Filters: c_custkey<=149999││                           │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││  AND c_custkey IS NOT NULL││                           │
                             │        EC: 1500000        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │
                             │                           ││         EC: 150000        ││                           │
                             └───────────────────────────┘└───────────────────────────┘└─────────────┬─────────────┘                             
                                                                                       ┌─────────────┴─────────────┐
                                                                                       │         PROJECTION        │
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                       │__internal_compress_integra│
                                                                                       │     l_uinteger(#0, 1)     │
                                                                                       └─────────────┬─────────────┘                             
                                                                                       ┌─────────────┴─────────────┐
                                                                                       │         PROJECTION        │
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                       │         l_orderkey        │
                                                                                       └─────────────┬─────────────┘                             
                                                                                       ┌─────────────┴─────────────┐
                                                                                       │           FILTER          │
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                       │ (sum(l_quantity) > 300.00)│
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                       │         EC: 47042         │
                                                                                       └─────────────┬─────────────┘                             
                                                                                       ┌─────────────┴─────────────┐
                                                                                       │         PROJECTION        │
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                       │__internal_decompress_integ│
                                                                                       │     ral_bigint(#0, 1)     │
                                                                                       │             #1            │
                                                                                       └─────────────┬─────────────┘                             
                                                                                       ┌─────────────┴─────────────┐
                                                                                       │       HASH_GROUP_BY       │
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                       │             #0            │
                                                                                       │    sum_no_overflow(#1)    │
                                                                                       └─────────────┬─────────────┘                             
                                                                                       ┌─────────────┴─────────────┐
                                                                                       │         PROJECTION        │
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                       │         l_orderkey        │
                                                                                       │         l_quantity        │
                                                                                       └─────────────┬─────────────┘                             
                                                                                       ┌─────────────┴─────────────┐
                                                                                       │         PROJECTION        │
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                       │__internal_compress_integra│
                                                                                       │     l_uinteger(#0, 1)     │
                                                                                       │             #1            │
                                                                                       └─────────────┬─────────────┘                             
                                                                                       ┌─────────────┴─────────────┐
                                                                                       │         SEQ_SCAN          │
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                       │          lineitem         │
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                       │         l_orderkey        │
                                                                                       │         l_quantity        │
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                       │        EC: 6001215        │
                                                                                       └───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

%%%%%%%%%%%%%%%% Running Query #  18  threads:  1
SELECT c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, sum(l_quantity) FROM customer, orders, lineitem WHERE o_orderkey IN ( SELECT l_orderkey FROM lineitem GROUP BY l_orderkey HAVING sum(l_quantity) > 300) AND c_custkey = o_custkey AND o_orderkey = l_orderkey GROUP BY c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice ORDER BY o_totalprice DESC, o_orderdate LIMIT 100;
Run:  None SELECT c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, sum(l_quantity) FROM customer, orders, lineitem WHERE o_orderkey IN ( SELECT l_orderkey FROM lineitem GROUP BY l_orderkey HAVING sum(l_quantity) > 300) AND c_custkey = o_custkey AND o_orderkey = l_orderkey GROUP BY c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice ORDER BY o_totalprice DESC, o_orderdate LIMIT 100;
Avg Time in sec:  1.3386287996545434  output size:  57
                c_name  c_custkey  ...  o_totalprice sum(l_quantity)
0   Customer#000128120     128120  ...     544089.09           323.0
1   Customer#000144617     144617  ...     530604.44           317.0
2   Customer#000013940      13940  ...     522720.61           304.0
3   Customer#000066790      66790  ...     515531.82           327.0
4   Customer#000046435      46435  ...     508047.99           309.0
5   Customer#000015272      15272  ...     500241.33           302.0
6   Customer#000146608     146608  ...     499794.58           303.0
7   Customer#000096103      96103  ...     494398.79           312.0
8   Customer#000024341      24341  ...     491348.26           302.0
9   Customer#000137446     137446  ...     487763.25           311.0
10  Customer#000107590     107590  ...     485141.38           301.0
11  Customer#000050008      50008  ...     483891.26           302.0
12  Customer#000015619      15619  ...     480083.96           318.0
13  Customer#000077260      77260  ...     479499.43           307.0
14  Customer#000109379     109379  ...     478064.11           302.0
15  Customer#000054602      54602  ...     471220.08           307.0
16  Customer#000105995     105995  ...     469692.58           307.0
17  Customer#000148885     148885  ...     469630.44           313.0
18  Customer#000114586     114586  ...     469605.59           308.0
19  Customer#000105260     105260  ...     469360.57           303.0
20  Customer#000147197     147197  ...     467149.67           320.0
21  Customer#000064483      64483  ...     466991.35           304.0
22  Customer#000136573     136573  ...     461282.73           301.0
23  Customer#000016384      16384  ...     458378.92           312.0
24  Customer#000117919     117919  ...     456815.92           317.0
25  Customer#000012251      12251  ...     455107.26           309.0
26  Customer#000120098     120098  ...     453451.23           308.0
27  Customer#000066098      66098  ...     453436.16           304.0
28  Customer#000117076     117076  ...     449545.85           301.0
29  Customer#000129379     129379  ...     448665.79           303.0
30  Customer#000126865     126865  ...     447606.65           320.0
31  Customer#000088876      88876  ...     446717.46           304.0
32  Customer#000036619      36619  ...     446704.09           328.0
33  Customer#000141823     141823  ...     446269.12           310.0
34  Customer#000053029      53029  ...     446144.49           302.0
35  Customer#000018188      18188  ...     443807.22           308.0
36  Customer#000066533      66533  ...     443576.50           305.0
37  Customer#000037729      37729  ...     441082.97           309.0
38  Customer#000003566       3566  ...     439803.36           304.0
39  Customer#000045538      45538  ...     436275.31           305.0
40  Customer#000081581      81581  ...     435405.90           305.0
41  Customer#000119989     119989  ...     434568.25           320.0
42  Customer#000003680       3680  ...     433525.97           301.0
43  Customer#000113131     113131  ...     432957.75           301.0
44  Customer#000141098     141098  ...     430986.69           301.0
45  Customer#000093392      93392  ...     425487.51           304.0
46  Customer#000015631      15631  ...     419879.59           302.0
47  Customer#000112987     112987  ...     418161.49           305.0
48  Customer#000012599      12599  ...     415200.61           304.0
49  Customer#000105410     105410  ...     412754.51           302.0
50  Customer#000149842     149842  ...     411329.35           302.0
51  Customer#000010129      10129  ...     409129.85           309.0
52  Customer#000069904      69904  ...     408513.00           305.0
53  Customer#000017746      17746  ...     408446.93           303.0
54  Customer#000013072      13072  ...     399195.47           301.0
55  Customer#000082441      82441  ...     382579.74           305.0
56  Customer#000088703      88703  ...     363812.12           302.0

[57 rows x 6 columns]
{'name': 'Query', 'result': 1.320925, 'timing': 1.320925, 'cardinality': 0, 'extra-info': 'SELECT c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, sum(l_quantity) FROM customer, orders, lineitem WHERE o_orderkey IN ( SELECT l_orderkey FROM lineitem GROUP BY l_orderkey HAVING sum(l_quantity) > 300) AND c_custkey = o_custkey AND o_orderkey = l_orderkey GROUP BY c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice ORDER BY o_totalprice DESC, o_orderdate LIMIT 100;', 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 2.1e-05, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'STREAMING_LIMIT', 'timing': 2e-06, 'cardinality': 57, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 3e-06, 'cardinality': 57, 'extra_info': '#0\n__internal_decompress_integral_bigint(#1, 1)\n__internal_decompress_integral_bigint(#2, 1)\n#3\n#4\n#5\n', 'children': [{'name': 'ORDER_BY', 'timing': 6.5e-05, 'cardinality': 57, 'extra_info': 'ORDERS:\norders.o_totalprice DESC\norders.o_orderdate ASC', 'children': [{'name': 'PROJECTION', 'timing': 3e-06, 'cardinality': 57, 'extra_info': '#0\n__internal_compress_integral_uinteger(#1, 1)\n__internal_compress_integral_uinteger(#2, 1)\n#3\n#4\n#5\n', 'children': [{'name': 'PROJECTION', 'timing': 7e-06, 'cardinality': 57, 'extra_info': '#0\n__internal_decompress_integral_bigint(#1, 1)\n__internal_decompress_integral_bigint(#2, 1)\n#3\n#4\n#5\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.000812, 'cardinality': 57, 'extra_info': '#0\n#1\n#2\n#3\n#4\nsum(#5)', 'children': [{'name': 'PROJECTION', 'timing': 9e-06, 'cardinality': 399, 'extra_info': 'c_name\nc_custkey\no_orderkey\no_orderdate\no_totalprice\nl_quantity\n', 'children': [{'name': 'PROJECTION', 'timing': 6e-05, 'cardinality': 399, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n#1\n__internal_compress_integral_uinteger(#2, 1)\n__internal_compress_integral_uinteger(#3, 1)\n#4\n#5\n#6\n__internal_compress_integral_uinteger(#7, 1)\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.062389, 'cardinality': 399, 'extra_info': 'INNER\no_orderkey = #0\n\n[INFOSEPARATOR]\nEC: 3618677\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.603488, 'cardinality': 6001215, 'extra_info': 'INNER\nl_orderkey = o_orderkey\n\n[INFOSEPARATOR]\nEC: 3618677\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.01315, 'cardinality': 6001215, 'extra_info': 'lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_quantity\n[INFOSEPARATOR]\nEC: 6001215', 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.043564, 'cardinality': 1500000, 'extra_info': 'INNER\no_custkey = c_custkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 149999\n\n[INFOSEPARATOR]\nEC: 904486\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.007006, 'cardinality': 1500000, 'extra_info': 'orders\n[INFOSEPARATOR]\no_orderkey\no_custkey\no_orderdate\no_totalprice\n[INFOSEPARATOR]\nEC: 1500000', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 0.004456, 'cardinality': 149999, 'extra_info': 'customer\n[INFOSEPARATOR]\nc_custkey\nc_name\n[INFOSEPARATOR]\nFilters: c_custkey<=149999 AND c_custkey IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 150000', 'children': []}]}]}, {'name': 'PROJECTION', 'timing': 6e-06, 'cardinality': 57, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.000317, 'cardinality': 57, 'extra_info': '#0', 'children': [{'name': 'PROJECTION', 'timing': 1e-06, 'cardinality': 57, 'extra_info': '#0\n', 'children': [{'name': 'PROJECTION', 'timing': 4e-06, 'cardinality': 57, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n', 'children': [{'name': 'PROJECTION', 'timing': 1e-06, 'cardinality': 57, 'extra_info': 'l_orderkey\n', 'children': [{'name': 'FILTER', 'timing': 0.004118, 'cardinality': 57, 'extra_info': '(sum(l_quantity) > 300.00)\n[INFOSEPARATOR]\nEC: 47042', 'children': [{'name': 'PROJECTION', 'timing': 0.001332, 'cardinality': 1500000, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n#1\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.413176, 'cardinality': 1500000, 'extra_info': '#0\nsum_no_overflow(#1)', 'children': [{'name': 'PROJECTION', 'timing': 0.0009, 'cardinality': 6001215, 'extra_info': 'l_orderkey\nl_quantity\n', 'children': [{'name': 'PROJECTION', 'timing': 0.018297, 'cardinality': 6001215, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n#1\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.012852, 'cardinality': 6001215, 'extra_info': 'lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_quantity\n[INFOSEPARATOR]\nEC: 6001215', 'children': []}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}
Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                             
│    UNGROUPED_AGGREGATE    │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│          sum(#0)          │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│ (l_extendedprice * (1.00 -│                             
│        l_discount))       │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│             #1            │                             
│             #2            │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│             #1            │                             
│             #3            │                             
│             #4            │                             
│             #6            │                             
│             #7            │                             
│             #8            │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│           FILTER          │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│(((l_quantity <= 11.00) AND│                             
│ (p_size <= 5) AND (p_brand│                             
│     = 'Brand#12') AND (   │                             
│(p_container = 'SM CAS...  │                             
│(p_container = 'SM BOX...  │                             
│(p_container = 'SM PAC...  │                             
│(p_container = 'SM PKG...  │                             
│ ((l_quantity >= 10.00) AND│                             
│ (l_quantity <= 20.00) AND │                             
│(p_size <= 10) AND (p_brand│                             
│     = 'Brand#23') AND (   │                             
│(p_container = 'MED BA...  │                             
│(p_container = 'MED BO...  │                             
│(p_container = 'MED PK...  │                             
│(p_container = 'MED PA...  │                             
│  OR ((l_quantity >= 20.00)│                             
│  AND (l_quantity <= 30.00)│                             
│   AND (p_size <= 15) AND  │                             
│(p_brand = 'Brand#34')...  │                             
│(p_container = 'LG CAS...  │                             
│(p_container = 'LG BOX...  │                             
│(p_container = 'LG PAC...  │                             
│ (p_container = 'LG PKG')))│                             
│             )             │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│         EC: 160351        │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         HASH_JOIN         │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│           INNER           │                             
│   l_partkey = p_partkey   │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐              
│        Build Min: 1       │              │              
│     Build Max: 200000     │              │              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              
│         EC: 160351        │              │              
└─────────────┬─────────────┘              │                                           
┌─────────────┴─────────────┐┌─────────────┴─────────────┐
│           FILTER          ││         SEQ_SCAN          │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│ ((l_shipmode = 'AIR') OR  ││            part           │
│ (l_shipmode = 'AIR REG')) ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││         p_partkey         │
│         EC: 300060        ││          p_brand          │
│                           ││        p_container        │
│                           ││           p_size          │
│                           ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│                           ││         EC: 200000        │
└─────────────┬─────────────┘└───────────────────────────┘                             
┌─────────────┴─────────────┐                             
│         SEQ_SCAN          │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│          lineitem         │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│         l_partkey         │                             
│         l_quantity        │                             
│         l_shipmode        │                             
│      l_extendedprice      │                             
│         l_discount        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│  Filters: l_shipinstruct= │                             
│  'DELIVER IN PERSON' AND  │                             
│ l_shipinstruct IS NOT NULL│                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│         EC: 300060        │                             
└───────────────────────────┘                                                          

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

X {'RESULT_COLLECTOR0': 2.1e-05, 'STREAMING_LIMIT1': 2e-06, 'PROJECTION2': 3e-06, 'ORDER_BY3': 6.5e-05, 'PROJECTION4': 3e-06, 'PROJECTION5': 7e-06, 'HASH_GROUP_BY6': 0.000812, 'PROJECTION7': 9e-06, 'PROJECTION8': 6e-05, 'HASH_JOIN9': 0.062389, 'HASH_JOIN10': 0.603488, 'SEQ_SCAN 11': 0.01315, 'HASH_JOIN12': 0.043564, 'SEQ_SCAN 13': 0.007006, 'SEQ_SCAN 14': 0.004456, 'PROJECTION15': 6e-06, 'HASH_GROUP_BY16': 0.000317, 'PROJECTION17': 1e-06, 'PROJECTION18': 4e-06, 'PROJECTION19': 1e-06, 'FILTER20': 0.004118, 'PROJECTION21': 0.001332, 'HASH_GROUP_BY22': 0.413176, 'PROJECTION23': 0.0009, 'PROJECTION24': 0.018297, 'SEQ_SCAN 25': 0.012852}
Physical operator output, input_left, input_right: 
**** output size:  57
LINEAGE_5_FILTER_10
LINEAGE_5_HASH_GROUP_BY_14
LINEAGE_5_HASH_GROUP_BY_19
LINEAGE_5_HASH_GROUP_BY_8
LINEAGE_5_HASH_JOIN_16
LINEAGE_5_HASH_JOIN_3
LINEAGE_5_HASH_JOIN_4
LINEAGE_5_ORDER_BY_22
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_1
LINEAGE_5_SEQ_SCAN_2
LINEAGE_5_SEQ_SCAN_5
LINEAGE_5_STREAMING_LIMIT_24
SELECT c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, sum(l_quantity) FROM customer, orders, lineitem WHERE o_orderkey IN ( SELECT l_orderkey FROM lineitem GROUP BY l_orderkey HAVING sum(l_quantity) > 300) AND c_custkey = o_custkey AND o_orderkey = l_orderkey GROUP BY c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice ORDER BY o_totalprice DESC, o_orderdate LIMIT 100;
   query_id  ...                                               plan
0         5  ...  {"name": "STREAMING_LIMIT", "opid": "24", "chi...

[1 rows x 8 columns]
Query info:  query_id                                                            5
query               SELECT c_name, c_custkey, o_orderkey, o_orderd...
size_bytes_max                                               23627341
physical_op_size    [5339, 144, 0, 100, 0, 0, 711, 0, 0, 4668, 142...
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "STREAMING_LIMIT", "opid": "24", "chi...
Name: 0, dtype: object
physical op size is:
{"name": "STREAMING_LIMIT", "opid": "24", "children": [{"name": "PROJECTION", "opid": "23", "children": [{"name": "ORDER_BY", "opid": "22", "children": [{"name": "PROJECTION", "opid": "21", "children": [{"name": "PROJECTION", "opid": "20", "children": [{"name": "HASH_GROUP_BY", "opid": "19", "children": [{"name": "PROJECTION", "opid": "18", "children": [{"name": "PROJECTION", "opid": "17", "children": [{"name": "HASH_JOIN", "opid": "16", "children": [{"name": "HASH_JOIN", "opid": "4", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_quantity\n[INFOSEPARATOR]\nEC: 6001215"},{"name": "HASH_JOIN", "opid": "3", "children": [{"name": "SEQ_SCAN ", "opid": "1", "children": [],"table": "orders","extra": "orders\n[INFOSEPARATOR]\no_orderkey\no_custkey\no_orderdate\no_totalprice\n[INFOSEPARATOR]\nEC: 1500000"},{"name": "SEQ_SCAN ", "opid": "2", "children": [],"table": "customer","extra": "customer\n[INFOSEPARATOR]\nc_custkey\nc_name\n[INFOSEPARATOR]\nFilters: c_custkey<=149999 AND c_custkey IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 150000"}],"table": "","extra": "INNER\no_custkey = c_custkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 149999\n\n[INFOSEPARATOR]\nEC: 904486\n"}],"table": "","extra": "INNER\nl_orderkey = o_orderkey\n\n[INFOSEPARATOR]\nEC: 3618677\n"},{"name": "PROJECTION", "opid": "15", "children": [{"name": "HASH_GROUP_BY", "opid": "14", "children": [{"name": "PROJECTION", "opid": "13", "children": [{"name": "PROJECTION", "opid": "12", "children": [{"name": "PROJECTION", "opid": "11", "children": [{"name": "FILTER", "opid": "10", "children": [{"name": "PROJECTION", "opid": "9", "children": [{"name": "HASH_GROUP_BY", "opid": "8", "children": [{"name": "PROJECTION", "opid": "7", "children": [{"name": "PROJECTION", "opid": "6", "children": [{"name": "SEQ_SCAN ", "opid": "5", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_quantity\n[INFOSEPARATOR]\nEC: 6001215"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n#1\n"}],"table": "","extra": "l_orderkey\nl_quantity\n"}],"table": "","extra": "#0\nsum_no_overflow(#1)"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n#1\n"}],"table": "","extra": "(sum(l_quantity) > 300.00)\n[INFOSEPARATOR]\nEC: 47042"}],"table": "","extra": "l_orderkey\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n"}],"table": "","extra": "#0\n"}],"table": "","extra": "#0"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n"}],"table": "","extra": "INNER\no_orderkey = #0\n\n[INFOSEPARATOR]\nEC: 3618677\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n#1\n__internal_compress_integral_uinteger(#2, 1)\n__internal_compress_integral_uinteger(#3, 1)\n#4\n#5\n#6\n__internal_compress_integral_uinteger(#7, 1)\n"}],"table": "","extra": "c_name\nc_custkey\no_orderkey\no_orderdate\no_totalprice\nl_quantity\n"}],"table": "","extra": "#0\n#1\n#2\n#3\n#4\nsum(#5)"}],"table": "","extra": "#0\n__internal_decompress_integral_bigint(#1, 1)\n__internal_decompress_integral_bigint(#2, 1)\n#3\n#4\n#5\n"}],"table": "","extra": "#0\n__internal_compress_integral_uinteger(#1, 1)\n__internal_compress_integral_uinteger(#2, 1)\n#3\n#4\n#5\n"}],"table": "","extra": "ORDERS:\norders.o_totalprice DESC\norders.o_orderdate ASC"}],"table": "","extra": "#0\n__internal_decompress_integral_bigint(#1, 1)\n__internal_decompress_integral_bigint(#2, 1)\n#3\n#4\n#5\n"}],"table": "","extra": ""}
%%%%%%%%%%%%%%%% Running Query #  19  threads:  1
SELECT sum(l_extendedprice * (1 - l_discount)) AS revenue FROM lineitem, part WHERE (p_partkey = l_partkey AND p_brand = 'Brand#12' AND p_container IN ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') AND l_quantity >= 1 AND l_quantity <= 1 + 10 AND p_size BETWEEN 1 AND 5 AND l_shipmode IN ('AIR', 'AIR REG') AND l_shipinstruct = 'DELIVER IN PERSON') OR (p_partkey = l_partkey AND p_brand = 'Brand#23' AND p_container IN ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') AND l_quantity >= 10 AND l_quantity <= 10 + 10 AND p_size BETWEEN 1 AND 10 AND l_shipmode IN ('AIR', 'AIR REG') AND l_shipinstruct = 'DELIVER IN PERSON') OR (p_partkey = l_partkey AND p_brand = 'Brand#34' AND p_container IN ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') AND l_quantity >= 20 AND l_quantity <= 20 + 10 AND p_size BETWEEN 1 AND 15 AND l_shipmode IN ('AIR', 'AIR REG') AND l_shipinstruct = 'DELIVER IN PERSON');
Run:  None SELECT sum(l_extendedprice * (1 - l_discount)) AS revenue FROM lineitem, part WHERE (p_partkey = l_partkey AND p_brand = 'Brand#12' AND p_container IN ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') AND l_quantity >= 1 AND l_quantity <= 1 + 10 AND p_size BETWEEN 1 AND 5 AND l_shipmode IN ('AIR', 'AIR REG') AND l_shipinstruct = 'DELIVER IN PERSON') OR (p_partkey = l_partkey AND p_brand = 'Brand#23' AND p_container IN ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') AND l_quantity >= 10 AND l_quantity <= 10 + 10 AND p_size BETWEEN 1 AND 10 AND l_shipmode IN ('AIR', 'AIR REG') AND l_shipinstruct = 'DELIVER IN PERSON') OR (p_partkey = l_partkey AND p_brand = 'Brand#34' AND p_container IN ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') AND l_quantity >= 20 AND l_quantity <= 20 + 10 AND p_size BETWEEN 1 AND 15 AND l_shipmode IN ('AIR', 'AIR REG') AND l_shipinstruct = 'DELIVER IN PERSON');
Avg Time in sec:  0.4957775380462408  output size:  1
        revenue
0  3.083843e+06
{'name': 'Query', 'result': 0.492266, 'timing': 0.492266, 'cardinality': 0, 'extra-info': "SELECT sum(l_extendedprice * (1 - l_discount)) AS revenue FROM lineitem, part WHERE (p_partkey = l_partkey AND p_brand = 'Brand#12' AND p_container IN ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') AND l_quantity >= 1 AND l_quantity <= 1 + 10 AND p_size BETWEEN 1 AND 5 AND l_shipmode IN ('AIR', 'AIR REG') AND l_shipinstruct = 'DELIVER IN PERSON') OR (p_partkey = l_partkey AND p_brand = 'Brand#23' AND p_container IN ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') AND l_quantity >= 10 AND l_quantity <= 10 + 10 AND p_size BETWEEN 1 AND 10 AND l_shipmode IN ('AIR', 'AIR REG') AND l_shipinstruct = 'DELIVER IN PERSON') OR (p_partkey = l_partkey AND p_brand = 'Brand#34' AND p_container IN ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') AND l_quantity >= 20 AND l_quantity <= 20 + 10 AND p_size BETWEEN 1 AND 15 AND l_shipmode IN ('AIR', 'AIR REG') AND l_shipinstruct = 'DELIVER IN PERSON');", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 5e-06, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'UNGROUPED_AGGREGATE', 'timing': 8e-06, 'cardinality': 1, 'extra_info': 'sum(#0)', 'children': [{'name': 'PROJECTION', 'timing': 8e-06, 'cardinality': 121, 'extra_info': '(l_extendedprice * (1.00 - l_discount))\n', 'children': [{'name': 'PROJECTION', 'timing': 1e-06, 'cardinality': 121, 'extra_info': '#1\n#2\n', 'children': [{'name': 'PROJECTION', 'timing': 2e-06, 'cardinality': 121, 'extra_info': '#1\n#3\n#4\n#6\n#7\n#8\n', 'children': [{'name': 'FILTER', 'timing': 0.06059, 'cardinality': 121, 'extra_info': "(((l_quantity <= 11.00) AND (p_size <= 5) AND (p_brand = 'Brand#12') AND ((p_container = 'SM CASE') OR (p_container = 'SM BOX') OR (p_container = 'SM PACK') OR (p_container = 'SM PKG'))) OR ((l_quantity >= 10.00) AND (l_quantity <= 20.00) AND (p_size <= 10) AND (p_brand = 'Brand#23') AND ((p_container = 'MED BAG') OR (p_container = 'MED BOX') OR (p_container = 'MED PKG') OR (p_container = 'MED PACK'))) OR ((l_quantity >= 20.00) AND (l_quantity <= 30.00) AND (p_size <= 15) AND (p_brand = 'Brand#34') AND ((p_container = 'LG CASE') OR (p_container = 'LG BOX') OR (p_container = 'LG PACK') OR (p_container = 'LG PKG'))))\n[INFOSEPARATOR]\nEC: 160351", 'children': [{'name': 'HASH_JOIN', 'timing': 0.039853, 'cardinality': 214377, 'extra_info': 'INNER\nl_partkey = p_partkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 160351\n', 'children': [{'name': 'FILTER', 'timing': 0.041942, 'cardinality': 214377, 'extra_info': "((l_shipmode = 'AIR') OR (l_shipmode = 'AIR REG'))\n[INFOSEPARATOR]\nEC: 300060", 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.304277, 'cardinality': 1500048, 'extra_info': "lineitem\n[INFOSEPARATOR]\nl_partkey\nl_quantity\nl_shipmode\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nFilters: l_shipinstruct='DELIVER IN PERSON' AND l_shipinstruct IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 300060", 'children': []}]}, {'name': 'SEQ_SCAN ', 'timing': 0.00837, 'cardinality': 200000, 'extra_info': 'part\n[INFOSEPARATOR]\np_partkey\np_brand\np_container\np_size\n[INFOSEPARATOR]\nEC: 200000', 'children': []}]}]}]}]}]}]}]}]}
Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                                                                                                                                                                              
│          ORDER_BY         │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│          ORDERS:          │                                                                                                                                                                              
│    supplier.s_name ASC    │                                                                                                                                                                              
└─────────────┬─────────────┘                                                                                                                                                                                                           
┌─────────────┴─────────────┐                                                                                                                                                                              
│         PROJECTION        │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│           s_name          │                                                                                                                                                                              
│         s_address         │                                                                                                                                                                              
└─────────────┬─────────────┘                                                                                                                                                                                                           
┌─────────────┴─────────────┐                                                                                                                                                                              
│         HASH_JOIN         │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│           INNER           │                                                                                                                                                                              
│       #0 = s_suppkey      │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐                                           
│        Build Min: 1       │                                                                                                                                  │                                           
│      Build Max: 10000     │                                                                                                                                  │                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                  │                                           
│          EC: 400          │                                                                                                                                  │                                           
└─────────────┬─────────────┘                                                                                                                                  │                                                                        
┌─────────────┴─────────────┐                                                                                                                    ┌─────────────┴─────────────┐                             
│         PROJECTION        │                                                                                                                    │         HASH_JOIN         │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│__internal_decompress_integ│                                                                                                                    │           INNER           │                             
│     ral_bigint(#0, 1)     │                                                                                                                    │ s_nationkey = n_nationkey │                             
│                           │                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐              
│                           │                                                                                                                    │        Build Min: 0       │              │              
│                           │                                                                                                                    │       Build Max: 24       │              │              
│                           │                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              
│                           │                                                                                                                    │          EC: 400          │              │              
└─────────────┬─────────────┘                                                                                                                    └─────────────┬─────────────┘              │                                           
┌─────────────┴─────────────┐                                                                                                                    ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
│       HASH_GROUP_BY       │                                                                                                                    │         SEQ_SCAN          ││         SEQ_SCAN          │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│             #0            │                                                                                                                    │          supplier         ││           nation          │
│                           │                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│                           │                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│                           │                                                                                                                    │         EC: 10000         ││  Filters: n_name='CANADA' │
│                           │                                                                                                                    │                           ││   AND n_name IS NOT NULL  │
│                           │                                                                                                                    │                           ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│                           │                                                                                                                    │                           ││           EC: 1           │
└─────────────┬─────────────┘                                                                                                                    └───────────────────────────┘└───────────────────────────┘                             
┌─────────────┴─────────────┐                                                                                                                                                                              
│         PROJECTION        │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│             #0            │                                                                                                                                                                              
└─────────────┬─────────────┘                                                                                                                                                                                                           
┌─────────────┴─────────────┐                                                                                                                                                                              
│         PROJECTION        │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│__internal_compress_integra│                                                                                                                                                                              
│     l_usmallint(#0, 1)    │                                                                                                                                                                              
└─────────────┬─────────────┘                                                                                                                                                                                                           
┌─────────────┴─────────────┐                                                                                                                                                                              
│         PROJECTION        │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│         ps_suppkey        │                                                                                                                                                                              
└─────────────┬─────────────┘                                                                                                                                                                                                           
┌─────────────┴─────────────┐                                                                                                                                                                              
│         PROJECTION        │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│             #0            │                                                                                                                                                                              
│             #4            │                                                                                                                                                                              
│             #5            │                                                                                                                                                                              
└─────────────┬─────────────┘                                                                                                                                                                                                           
┌─────────────┴─────────────┐                                                                                                                                                                              
│           FILTER          │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│    (CAST(ps_availqty AS   │                                                                                                                                                                              
│ DECIMAL(38,3)) > SUBQUERY)│                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│         EC: 800000        │                                                                                                                                                                              
└─────────────┬─────────────┘                                                                                                                                                                                                           
┌─────────────┴─────────────┐                                                                                                                                                                              
│      RIGHT_DELIM_JOIN     │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│           RIGHT           │                                                                                                                                                                              
│ ps_partkey IS NOT DISTINCT│                                                                                                                                                                              
│       FROM ps_partkey     ├───────────────────────────────────────────┐                                                                                                                                  
│ ps_suppkey IS NOT DISTINCT│                                           │                                                                                                                                  
│       FROM ps_suppkey     │                                           │                                                                                                                                  
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                           │                                                                                                                                  
│         EC: 800000        │                                           │                                                                                                                                  
└─────────────┬─────────────┘                                           │                                                                                                                                                               
┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐                                                                                                                    
│         HASH_JOIN         │                             │         HASH_JOIN         │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│           INNER           │                             │           RIGHT           │                                                                                                                    
│      ps_partkey = #0      │                             │ ps_partkey IS NOT DISTINCT│                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐              │       FROM ps_partkey     ├───────────────────────────────────────────┐                                                                        
│        Build Min: 1       │              │              │ ps_suppkey IS NOT DISTINCT│                                           │                                                                        
│     Build Max: 200000     │              │              │       FROM ps_suppkey     │                                           │                                                                        
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                           │                                                                        
│         EC: 800000        │              │              │         EC: 800000        │                                           │                                                                        
└─────────────┬─────────────┘              │              └─────────────┬─────────────┘                                           │                                                                                                     
┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐                                                          
│         SEQ_SCAN          ││         PROJECTION        ││         PROJECTION        │                             │         DUMMY_SCAN        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │                           │                                                          
│          partsupp         ││__internal_decompress_integ││  (0.5 * sum(l_quantity))  │                             │                           │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││     ral_bigint(#0, 1)     ││         ps_partkey        │                             │                           │                                                          
│         ps_partkey        ││                           ││         ps_suppkey        │                             │                           │                                                          
│        ps_availqty        ││                           ││                           │                             │                           │                                                          
│         ps_suppkey        ││                           ││                           │                             │                           │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           ││                           │                             │                           │                                                          
│         EC: 800000        ││                           ││                           │                             │                           │                                                          
└───────────────────────────┘└─────────────┬─────────────┘└─────────────┬─────────────┘                             └───────────────────────────┘                                                                                       
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                                                    
                             │       HASH_GROUP_BY       ││         PROJECTION        │                                                                                                                    
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
                             │             #0            ││__internal_decompress_integ│                                                                                                                    
                             │                           ││     ral_bigint(#0, 1)     │                                                                                                                    
                             │                           ││__internal_decompress_integ│                                                                                                                    
                             │                           ││     ral_bigint(#1, 1)     │                                                                                                                    
                             │                           ││             #2            │                                                                                                                    
                             └─────────────┬─────────────┘└─────────────┬─────────────┘                                                                                                                                                 
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                                                    
                             │         PROJECTION        ││       HASH_GROUP_BY       │                                                                                                                    
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
                             │             #0            ││             #0            │                                                                                                                    
                             │                           ││             #1            │                                                                                                                    
                             │                           ││          sum(#2)          │                                                                                                                    
                             └─────────────┬─────────────┘└─────────────┬─────────────┘                                                                                                                                                 
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                                                    
                             │         PROJECTION        ││         PROJECTION        │                                                                                                                    
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
                             │__internal_compress_integra││         ps_partkey        │                                                                                                                    
                             │     l_uinteger(#0, 1)     ││         ps_suppkey        │                                                                                                                    
                             │                           ││         l_quantity        │                                                                                                                    
                             └─────────────┬─────────────┘└─────────────┬─────────────┘                                                                                                                                                 
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                                                    
                             │         PROJECTION        ││         PROJECTION        │                                                                                                                    
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
                             │         p_partkey         ││__internal_compress_integra│                                                                                                                    
                             │                           ││     l_uinteger(#0, 1)     │                                                                                                                    
                             │                           ││__internal_compress_integra│                                                                                                                    
                             │                           ││     l_usmallint(#1, 1)    │                                                                                                                    
                             │                           ││             #2            │                                                                                                                    
                             │                           ││             #3            │                                                                                                                    
                             │                           ││             #4            │                                                                                                                    
                             └─────────────┬─────────────┘└─────────────┬─────────────┘                                                                                                                                                 
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                                                    
                             │           FILTER          ││         HASH_JOIN         │                                                                                                                    
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
                             │  prefix(p_name, 'forest') ││           INNER           │                                                                                                                    
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   l_partkey = ps_partkey  ├──────────────┐                                                                                                     
                             │          EC: 8000         ││   l_suppkey = ps_suppkey  │              │                                                                                                     
                             │                           ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                                                                                     
                             │                           ││        EC: 1200243        │              │                                                                                                     
                             └─────────────┬─────────────┘└─────────────┬─────────────┘              │                                                                                                                                  
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                       
                             │         SEQ_SCAN          ││         SEQ_SCAN          ││         DELIM_SCAN        │                                                                                       
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                                                                       
                             │            part           ││          lineitem         ││                           │                                                                                       
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                                                                       
                             │           p_name          ││         l_partkey         ││                           │                                                                                       
                             │         p_partkey         ││         l_suppkey         ││                           │                                                                                       
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││         l_quantity        ││                           │                                                                                       
                             │ Filters: p_name>='forest' ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                                                                       
                             │   AND p_name<'foresu' AND ││ Filters: l_shipdate>='1994││                           │                                                                                       
                             │     p_name IS NOT NULL    ││-01-01'::DATE AND l_sh...  ││                           │                                                                                       
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││  <'1995-01-01'::DATE AND  ││                           │                                                                                       
                             │         EC: 40000         ││   l_shipdate IS NOT NULL  ││                           │                                                                                       
                             │                           ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                                                                       
                             │                           ││        EC: 1200243        ││                           │                                                                                       
                             └───────────────────────────┘└───────────────────────────┘└───────────────────────────┘                                                                                                                    

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

X {'RESULT_COLLECTOR0': 5e-06, 'UNGROUPED_AGGREGATE1': 8e-06, 'PROJECTION2': 8e-06, 'PROJECTION3': 1e-06, 'PROJECTION4': 2e-06, 'FILTER5': 0.06059, 'HASH_JOIN6': 0.039853, 'FILTER7': 0.041942, 'SEQ_SCAN 8': 0.304277, 'SEQ_SCAN 9': 0.00837}
Physical operator output, input_left, input_right: 
**** output size:  1
LINEAGE_5_FILTER_1
LINEAGE_5_FILTER_4
LINEAGE_5_HASH_JOIN_3
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_2
SELECT sum(l_extendedprice * (1 - l_discount)) AS revenue FROM lineitem, part WHERE (p_partkey = l_partkey AND p_brand = 'Brand#12' AND p_container IN ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') AND l_quantity >= 1 AND l_quantity <= 1 + 10 AND p_size BETWEEN 1 AND 5 AND l_shipmode IN ('AIR', 'AIR REG') AND l_shipinstruct = 'DELIVER IN PERSON') OR (p_partkey = l_partkey AND p_brand = 'Brand#23' AND p_container IN ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') AND l_quantity >= 10 AND l_quantity <= 10 + 10 AND p_size BETWEEN 1 AND 10 AND l_shipmode IN ('AIR', 'AIR REG') AND l_shipinstruct = 'DELIVER IN PERSON') OR (p_partkey = l_partkey AND p_brand = 'Brand#34' AND p_container IN ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') AND l_quantity >= 20 AND l_quantity <= 20 + 10 AND p_size BETWEEN 1 AND 15 AND l_shipmode IN ('AIR', 'AIR REG') AND l_shipinstruct = 'DELIVER IN PERSON');
   query_id  ...                                               plan
0         5  ...  {"name": "UNGROUPED_AGGREGATE", "opid": "8", "...

[1 rows x 8 columns]
Query info:  query_id                                                            5
query               SELECT sum(l_extendedprice * (1 - l_discount))...
size_bytes_max                                                2818896
physical_op_size    [255778, 0, 0, 0, 0, 1734, 1765971, 0, 794446,...
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "UNGROUPED_AGGREGATE", "opid": "8", "...
Name: 0, dtype: object
physical op size is:
{"name": "UNGROUPED_AGGREGATE", "opid": "8", "children": [{"name": "PROJECTION", "opid": "7", "children": [{"name": "PROJECTION", "opid": "6", "children": [{"name": "PROJECTION", "opid": "5", "children": [{"name": "FILTER", "opid": "4", "children": [{"name": "HASH_JOIN", "opid": "3", "children": [{"name": "FILTER", "opid": "1", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_partkey\nl_quantity\nl_shipmode\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nFilters: l_shipinstruct='DELIVER IN PERSON' AND l_shipinstruct IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 300060"}],"table": "","extra": "((l_shipmode = 'AIR') OR (l_shipmode = 'AIR REG'))\n[INFOSEPARATOR]\nEC: 300060"},{"name": "SEQ_SCAN ", "opid": "2", "children": [],"table": "part","extra": "part\n[INFOSEPARATOR]\np_partkey\np_brand\np_container\np_size\n[INFOSEPARATOR]\nEC: 200000"}],"table": "","extra": "INNER\nl_partkey = p_partkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 160351\n"}],"table": "","extra": "(((l_quantity <= 11.00) AND (p_size <= 5) AND (p_brand = 'Brand#12') AND ((p_container = 'SM CASE') OR (p_container = 'SM BOX') OR (p_container = 'SM PACK') OR (p_container = 'SM PKG'))) OR ((l_quantity >= 10.00) AND (l_quantity <= 20.00) AND (p_size <= 10) AND (p_brand = 'Brand#23') AND ((p_container = 'MED BAG') OR (p_container = 'MED BOX') OR (p_container = 'MED PKG') OR (p_container = 'MED PACK'))) OR ((l_quantity >= 20.00) AND (l_quantity <= 30.00) AND (p_size <= 15) AND (p_brand = 'Brand#34') AND ((p_container = 'LG CASE') OR (p_container = 'LG BOX') OR (p_container = 'LG PACK') OR (p_container = 'LG PKG'))))\n[INFOSEPARATOR]\nEC: 160351"}],"table": "","extra": "#1\n#3\n#4\n#6\n#7\n#8\n"}],"table": "","extra": "#1\n#2\n"}],"table": "","extra": "(l_extendedprice * (1.00 - l_discount))\n"}],"table": "","extra": "sum(#0)"}
%%%%%%%%%%%%%%%% Running Query #  20  threads:  1
SELECT s_name, s_address FROM supplier, nation WHERE s_suppkey IN ( SELECT ps_suppkey FROM partsupp WHERE ps_partkey IN ( SELECT p_partkey FROM part WHERE p_name LIKE 'forest%') AND ps_availqty > ( SELECT 0.5 * sum(l_quantity) FROM lineitem WHERE l_partkey = ps_partkey AND l_suppkey = ps_suppkey AND l_shipdate >= CAST('1994-01-01' AS date) AND l_shipdate < CAST('1995-01-01' AS date))) AND s_nationkey = n_nationkey AND n_name = 'CANADA' ORDER BY s_name;
Run:  None SELECT s_name, s_address FROM supplier, nation WHERE s_suppkey IN ( SELECT ps_suppkey FROM partsupp WHERE ps_partkey IN ( SELECT p_partkey FROM part WHERE p_name LIKE 'forest%') AND ps_availqty > ( SELECT 0.5 * sum(l_quantity) FROM lineitem WHERE l_partkey = ps_partkey AND l_suppkey = ps_suppkey AND l_shipdate >= CAST('1994-01-01' AS date) AND l_shipdate < CAST('1995-01-01' AS date))) AND s_nationkey = n_nationkey AND n_name = 'CANADA' ORDER BY s_name;
Avg Time in sec:  0.16539778467267752  output size:  186
                 s_name                               s_address
0    Supplier#000000020               JtPqm19E7tF 152Rl1wQZ8j0H
1    Supplier#000000091    35WVnU7GLNbQDcc2TARavGtk6RB6ZCd46UAY
2    Supplier#000000205                            Alrx5TN,hdnG
3    Supplier#000000285           q TMZEDyZtv vUiFKBhT3NJlnIxpL
4    Supplier#000000287                       UQR8bUA4V2HxVbw9K
..                  ...                                     ...
181  Supplier#000009811                  nXIxtBT6D1v6TCb2iMYkyU
182  Supplier#000009812     rbl9euXFoPLlKQVYDVyRouslbbbKDHAkyXY
183  Supplier#000009846  WTzdvihXbyqnx0JfbbVaxBOcO9d93DYbtBhi J
184  Supplier#000009899                       U3NBqk s Zz06al2m
185  Supplier#000009974         Uvh0hWngOu96WgB,OafBQOqwpWqzwg8

[186 rows x 2 columns]
{'name': 'Query', 'result': 0.161491, 'timing': 0.161491, 'cardinality': 0, 'extra-info': "SELECT s_name, s_address FROM supplier, nation WHERE s_suppkey IN ( SELECT ps_suppkey FROM partsupp WHERE ps_partkey IN ( SELECT p_partkey FROM part WHERE p_name LIKE 'forest%') AND ps_availqty > ( SELECT 0.5 * sum(l_quantity) FROM lineitem WHERE l_partkey = ps_partkey AND l_suppkey = ps_suppkey AND l_shipdate >= CAST('1994-01-01' AS date) AND l_shipdate < CAST('1995-01-01' AS date))) AND s_nationkey = n_nationkey AND n_name = 'CANADA' ORDER BY s_name;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 1.8e-05, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'ORDER_BY', 'timing': 8.6e-05, 'cardinality': 186, 'extra_info': 'ORDERS:\nsupplier.s_name ASC', 'children': [{'name': 'PROJECTION', 'timing': 2e-06, 'cardinality': 186, 'extra_info': 's_name\ns_address\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.000296, 'cardinality': 186, 'extra_info': 'INNER\n#0 = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 400\n', 'children': [{'name': 'PROJECTION', 'timing': 8e-06, 'cardinality': 4397, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.000469, 'cardinality': 4397, 'extra_info': '#0', 'children': [{'name': 'PROJECTION', 'timing': 2e-06, 'cardinality': 5833, 'extra_info': '#0\n', 'children': [{'name': 'PROJECTION', 'timing': 1.6e-05, 'cardinality': 5833, 'extra_info': '__internal_compress_integral_usmallint(#0, 1)\n', 'children': [{'name': 'PROJECTION', 'timing': 2e-06, 'cardinality': 5833, 'extra_info': 'ps_suppkey\n', 'children': [{'name': 'PROJECTION', 'timing': 5e-06, 'cardinality': 5833, 'extra_info': '#0\n#4\n#5\n', 'children': [{'name': 'FILTER', 'timing': 0.000349, 'cardinality': 5833, 'extra_info': '(CAST(ps_availqty AS DECIMAL(38,3)) > SUBQUERY)\n[INFOSEPARATOR]\nEC: 800000', 'children': [{'name': 'RIGHT_DELIM_JOIN', 'timing': 0.001418, 'cardinality': 0, 'extra_info': 'RIGHT\nps_partkey IS NOT DISTINCT FROM ps_partkey\nps_suppkey IS NOT DISTINCT FROM ps_suppkey\n\n[INFOSEPARATOR]\nEC: 800000\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.00686, 'cardinality': 8508, 'extra_info': 'INNER\nps_partkey = #0\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 800000\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.002023, 'cardinality': 800000, 'extra_info': 'partsupp\n[INFOSEPARATOR]\nps_partkey\nps_availqty\nps_suppkey\n[INFOSEPARATOR]\nEC: 800000', 'children': []}, {'name': 'PROJECTION', 'timing': 6e-06, 'cardinality': 2127, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.000331, 'cardinality': 2127, 'extra_info': '#0', 'children': [{'name': 'PROJECTION', 'timing': 1e-06, 'cardinality': 2127, 'extra_info': '#0\n', 'children': [{'name': 'PROJECTION', 'timing': 7e-06, 'cardinality': 2127, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n', 'children': [{'name': 'PROJECTION', 'timing': 1e-06, 'cardinality': 2127, 'extra_info': 'p_partkey\n', 'children': [{'name': 'FILTER', 'timing': 0.000494, 'cardinality': 2127, 'extra_info': "prefix(p_name, 'forest')\n[INFOSEPARATOR]\nEC: 8000", 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.007402, 'cardinality': 2127, 'extra_info': "part\n[INFOSEPARATOR]\np_name\np_partkey\n[INFOSEPARATOR]\nFilters: p_name>='forest' AND p_name<'foresu' AND p_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 40000", 'children': []}]}]}]}]}]}]}]}, {'name': 'HASH_JOIN', 'timing': 0.000694, 'cardinality': 8508, 'extra_info': 'RIGHT\nps_partkey IS NOT DISTINCT FROM ps_partkey\nps_suppkey IS NOT DISTINCT FROM ps_suppkey\n\n[INFOSEPARATOR]\nEC: 800000\n', 'children': [{'name': 'PROJECTION', 'timing': 0.000149, 'cardinality': 5843, 'extra_info': '(0.5 * sum(l_quantity))\nps_partkey\nps_suppkey\n', 'children': [{'name': 'PROJECTION', 'timing': 1.8e-05, 'cardinality': 5843, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n__internal_decompress_integral_bigint(#1, 1)\n#2\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.001227, 'cardinality': 5843, 'extra_info': '#0\n#1\nsum(#2)', 'children': [{'name': 'PROJECTION', 'timing': 3e-06, 'cardinality': 9741, 'extra_info': 'ps_partkey\nps_suppkey\nl_quantity\n', 'children': [{'name': 'PROJECTION', 'timing': 4.8e-05, 'cardinality': 9741, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n__internal_compress_integral_usmallint(#1, 1)\n#2\n#3\n#4\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.066594, 'cardinality': 9741, 'extra_info': 'INNER\nl_partkey = ps_partkey\nl_suppkey = ps_suppkey\n\n[INFOSEPARATOR]\nEC: 1200243\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.060257, 'cardinality': 909455, 'extra_info': "lineitem\n[INFOSEPARATOR]\nl_partkey\nl_suppkey\nl_quantity\n[INFOSEPARATOR]\nFilters: l_shipdate>='1994-01-01'::DATE AND l_shipdate<'1995-01-01'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243", 'children': []}, {'name': 'DELIM_SCAN', 'timing': 0.0, 'cardinality': 0, 'extra_info': '', 'children': []}]}]}]}]}]}]}, {'name': 'DUMMY_SCAN', 'timing': 0.0, 'cardinality': 0, 'extra_info': '', 'children': []}]}, {'name': 'HASH_GROUP_BY', 'timing': 0.00011, 'cardinality': 8508, 'extra_info': '#0\n#2', 'children': []}]}]}]}]}]}]}]}]}, {'name': 'HASH_JOIN', 'timing': 0.000109, 'cardinality': 412, 'extra_info': 'INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 400\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.001856, 'cardinality': 10000, 'extra_info': 'supplier\n[INFOSEPARATOR]\n\n[INFOSEPARATOR]\nEC: 10000', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 3.5e-05, 'cardinality': 1, 'extra_info': "nation\n[INFOSEPARATOR]\n\n[INFOSEPARATOR]\nFilters: n_name='CANADA' AND n_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1", 'children': []}]}]}]}]}]}]}
Clear Lineage

X {'RESULT_COLLECTOR0': 1.8e-05, 'ORDER_BY1': 8.6e-05, 'PROJECTION2': 2e-06, 'HASH_JOIN3': 0.000296, 'PROJECTION4': 8e-06, 'HASH_GROUP_BY5': 0.000469, 'PROJECTION6': 2e-06, 'PROJECTION7': 1.6e-05, 'PROJECTION8': 2e-06, 'PROJECTION9': 5e-06, 'FILTER10': 0.000349, 'RIGHT_DELIM_JOIN11': 0.001418, 'HASH_JOIN12': 0.00686, 'SEQ_SCAN 13': 0.002023, 'PROJECTION14': 6e-06, 'HASH_GROUP_BY15': 0.000331, 'PROJECTION16': 1e-06, 'PROJECTION17': 7e-06, 'PROJECTION18': 1e-06, 'FILTER19': 0.000494, 'SEQ_SCAN 20': 0.007402, 'HASH_JOIN21': 0.000694, 'PROJECTION22': 0.000149, 'PROJECTION23': 1.8e-05, 'HASH_GROUP_BY24': 0.001227, 'PROJECTION25': 3e-06, 'PROJECTION26': 4.8e-05, 'HASH_JOIN27': 0.066594, 'SEQ_SCAN 28': 0.060257, 'DELIM_SCAN29': 0.0, 'DUMMY_SCAN30': 0.0, 'HASH_GROUP_BY31': 0.00011, 'HASH_JOIN32': 0.000109, 'SEQ_SCAN 33': 0.001856, 'SEQ_SCAN 34': 3.5e-05}
Physical operator output, input_left, input_right: 
**** output size:  186
LINEAGE_5_FILTER_2
LINEAGE_5_FILTER_21
LINEAGE_5_HASH_GROUP_BY_14
LINEAGE_5_HASH_GROUP_BY_19
LINEAGE_5_HASH_GROUP_BY_26
LINEAGE_5_HASH_GROUP_BY_6
LINEAGE_5_HASH_JOIN_11
LINEAGE_5_HASH_JOIN_18
LINEAGE_5_HASH_JOIN_30
LINEAGE_5_HASH_JOIN_31
LINEAGE_5_HASH_JOIN_8
LINEAGE_5_ORDER_BY_33
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_1
LINEAGE_5_SEQ_SCAN_28
LINEAGE_5_SEQ_SCAN_29
LINEAGE_5_SEQ_SCAN_9
SELECT s_name, s_address FROM supplier, nation WHERE s_suppkey IN ( SELECT ps_suppkey FROM partsupp WHERE ps_partkey IN ( SELECT p_partkey FROM part WHERE p_name LIKE 'forest%') AND ps_availqty > ( SELECT 0.5 * sum(l_quantity) FROM lineitem WHERE l_partkey = ps_partkey AND l_suppkey = ps_suppkey AND l_shipdate >= CAST('1994-01-01' AS date) AND l_shipdate < CAST('1995-01-01' AS date))) AND s_nationkey = n_nationkey AND n_name = 'CANADA' ORDER BY s_name;
   query_id  ...                                               plan
0         5  ...  {"name": "ORDER_BY", "opid": "33", "children":...

[1 rows x 8 columns]
Query info:  query_id                                                            5
query               SELECT s_name, s_address FROM supplier, nation...
size_bytes_max                                                1035411
physical_op_size    [10440, 271, 0, 5216, 0, 13171, 0, 0, 0, 0, 46...
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "ORDER_BY", "opid": "33", "children":...
Name: 0, dtype: object
physical op size is:
{"name": "ORDER_BY", "opid": "33", "children": [{"name": "PROJECTION", "opid": "32", "children": [{"name": "HASH_JOIN", "opid": "31", "children": [{"name": "PROJECTION", "opid": "27", "children": [{"name": "HASH_GROUP_BY", "opid": "26", "children": [{"name": "PROJECTION", "opid": "25", "children": [{"name": "PROJECTION", "opid": "24", "children": [{"name": "PROJECTION", "opid": "23", "children": [{"name": "PROJECTION", "opid": "22", "children": [{"name": "FILTER", "opid": "21", "children": [{"name": "RIGHT_DELIM_JOIN", "opid": "20", "children": [{"name": "HASH_GROUP_BY", "opid": "19", "children": [],"table": "","extra": "#0\n#2"},{"name": "HASH_JOIN", "opid": "18", "children": [{"name": "PROJECTION", "opid": "16", "children": [{"name": "PROJECTION", "opid": "15", "children": [{"name": "HASH_GROUP_BY", "opid": "14", "children": [{"name": "PROJECTION", "opid": "13", "children": [{"name": "PROJECTION", "opid": "12", "children": [{"name": "HASH_JOIN", "opid": "11", "children": [{"name": "SEQ_SCAN ", "opid": "9", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_partkey\nl_suppkey\nl_quantity\n[INFOSEPARATOR]\nFilters: l_shipdate>='1994-01-01'::DATE AND l_shipdate<'1995-01-01'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243"},{"name": "DELIM_SCAN", "opid": "10", "children": [],"table": "","extra": ""}],"table": "","extra": "INNER\nl_partkey = ps_partkey\nl_suppkey = ps_suppkey\n\n[INFOSEPARATOR]\nEC: 1200243\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n__internal_compress_integral_usmallint(#1, 1)\n#2\n#3\n#4\n"}],"table": "","extra": "ps_partkey\nps_suppkey\nl_quantity\n"}],"table": "","extra": "#0\n#1\nsum(#2)"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n__internal_decompress_integral_bigint(#1, 1)\n#2\n"}],"table": "","extra": "(0.5 * sum(l_quantity))\nps_partkey\nps_suppkey\n"},{"name": "DUMMY_SCAN", "opid": "17", "children": [],"table": "","extra": ""}],"table": "","extra": "RIGHT\nps_partkey IS NOT DISTINCT FROM ps_partkey\nps_suppkey IS NOT DISTINCT FROM ps_suppkey\n\n[INFOSEPARATOR]\nEC: 800000\n"},{"name": "HASH_JOIN", "opid": "8", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "partsupp","extra": "partsupp\n[INFOSEPARATOR]\nps_partkey\nps_availqty\nps_suppkey\n[INFOSEPARATOR]\nEC: 800000"},{"name": "PROJECTION", "opid": "7", "children": [{"name": "HASH_GROUP_BY", "opid": "6", "children": [{"name": "PROJECTION", "opid": "5", "children": [{"name": "PROJECTION", "opid": "4", "children": [{"name": "PROJECTION", "opid": "3", "children": [{"name": "FILTER", "opid": "2", "children": [{"name": "SEQ_SCAN ", "opid": "1", "children": [],"table": "part","extra": "part\n[INFOSEPARATOR]\np_name\np_partkey\n[INFOSEPARATOR]\nFilters: p_name>='forest' AND p_name<'foresu' AND p_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 40000"}],"table": "","extra": "prefix(p_name, 'forest')\n[INFOSEPARATOR]\nEC: 8000"}],"table": "","extra": "p_partkey\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n"}],"table": "","extra": "#0\n"}],"table": "","extra": "#0"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n"}],"table": "","extra": "INNER\nps_partkey = #0\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 800000\n"}],"table": "","extra": "RIGHT\nps_partkey IS NOT DISTINCT FROM ps_partkey\nps_suppkey IS NOT DISTINCT FROM ps_suppkey\n\n[INFOSEPARATOR]\nEC: 800000\n"}],"table": "","extra": "(CAST(ps_availqty AS DECIMAL(38,3)) > SUBQUERY)\n[INFOSEPARATOR]\nEC: 800000"}],"table": "","extra": "#0\n#4\n#5\n"}],"table": "","extra": "ps_suppkey\n"}],"table": "","extra": "__internal_compress_integral_usmallint(#0, 1)\n"}],"table": "","extra": "#0\n"}],"table": "","extra": "#0"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n"},{"name": "HASH_JOIN", "opid": "30", "children": [{"name": "SEQ_SCAN ", "opid": "28", "children": [],"table": "supplier","extra": "supplier\n[INFOSEPARATOR]\n\n[INFOSEPARATOR]\nEC: 10000"},{"name": "SEQ_SCAN ", "opid": "29", "children": [],"table": "nation","extra": "nation\n[INFOSEPARATOR]\n\n[INFOSEPARATOR]\nFilters: n_name='CANADA' AND n_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1"}],"table": "","extra": "INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 400\n"}],"table": "","extra": "INNER\n#0 = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 400\n"}],"table": "","extra": "s_name\ns_address\n"}],"table": "","extra": "ORDERS:\nsupplier.s_name ASC"}
%%%%%%%%%%%%%%%% Running Query #  21  threads:  1
SELECT s_name, count(*) AS numwait FROM supplier, lineitem l1, orders, nation WHERE s_suppkey = l1.l_suppkey AND o_orderkey = l1.l_orderkey AND o_orderstatus = 'F' AND l1.l_receiptdate > l1.l_commitdate AND EXISTS ( SELECT * FROM lineitem l2 WHERE l2.l_orderkey = l1.l_orderkey AND l2.l_suppkey <> l1.l_suppkey) AND NOT EXISTS ( SELECT * FROM lineitem l3 WHERE l3.l_orderkey = l1.l_orderkey AND l3.l_suppkey <> l1.l_suppkey AND l3.l_receiptdate > l3.l_commitdate) AND s_nationkey = n_nationkey AND n_name = 'SAUDI ARABIA' GROUP BY s_name ORDER BY numwait DESC, s_name LIMIT 100;
Run:  None SELECT s_name, count(*) AS numwait FROM supplier, lineitem l1, orders, nation WHERE s_suppkey = l1.l_suppkey AND o_orderkey = l1.l_orderkey AND o_orderstatus = 'F' AND l1.l_receiptdate > l1.l_commitdate AND EXISTS ( SELECT * FROM lineitem l2 WHERE l2.l_orderkey = l1.l_orderkey AND l2.l_suppkey <> l1.l_suppkey) AND NOT EXISTS ( SELECT * FROM lineitem l3 WHERE l3.l_orderkey = l1.l_orderkey AND l3.l_suppkey <> l1.l_suppkey AND l3.l_receiptdate > l3.l_commitdate) AND s_nationkey = n_nationkey AND n_name = 'SAUDI ARABIA' GROUP BY s_name ORDER BY numwait DESC, s_name LIMIT 100;
Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌─────────────────────┐                                                                                                                                                                                                               
│   STREAMING_LIMIT   │                                                                                                                                                                                                               
└──────────┬──────────┘                                                                                                                                                                                                                                      
┌──────────┴──────────┐                                                                                                                                                                                                               
│       ORDER_BY      │                                                                                                                                                                                                               
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                               
│       ORDERS:       │                                                                                                                                                                                                               
│  count_star() DESC  │                                                                                                                                                                                                               
│ supplier.s_name ASC │                                                                                                                                                                                                               
└──────────┬──────────┘                                                                                                                                                                                                                                      
┌──────────┴──────────┐                                                                                                                                                                                                               
│    HASH_GROUP_BY    │                                                                                                                                                                                                               
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                               
│          #0         │                                                                                                                                                                                                               
│     count_star()    │                                                                                                                                                                                                               
└──────────┬──────────┘                                                                                                                                                                                                                                      
┌──────────┴──────────┐                                                                                                                                                                                                               
│      PROJECTION     │                                                                                                                                                                                                               
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                               
│        s_name       │                                                                                                                                                                                                               
└──────────┬──────────┘                                                                                                                                                                                                                                      
┌──────────┴──────────┐                                                                                                                                                                                                               
│      PROJECTION     │                                                                                                                                                                                                               
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                               
│__internal_compress_i│                                                                                                                                                                                                               
│ ntegral_uinteger(#0,│                                                                                                                                                                                                               
│          1)         │                                                                                                                                                                                                               
│__internal_compress_i│                                                                                                                                                                                                               
│ntegral_usmallint(#1,│                                                                                                                                                                                                               
│          1)         │                                                                                                                                                                                                               
│__internal_compress_i│                                                                                                                                                                                                               
│ ntegral_uinteger(#2,│                                                                                                                                                                                                               
│          1)         │                                                                                                                                                                                                               
│          #3         │                                                                                                                                                                                                               
└──────────┬──────────┘                                                                                                                                                                                                                                      
┌──────────┴──────────┐                                                                                                                                                                                                               
│   RIGHT_DELIM_JOIN  │                                                                                                                                                                                                               
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                               
│      RIGHT_ANTI     │                                                                                                                                                                                                               
│  l_orderkey IS NOT  │                                                                                                                                                                                                               
│ DISTINCT FROM l...  ├─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐                                                         
│   l_suppkey IS NOT  │                                                                                                                                                     │                                                         
│ DISTINCT FROM l...  │                                                                                                                                                     │                                                         
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                     │                                                         
│     EC: 6001215     │                                                                                                                                                     │                                                         
└──────────┬──────────┘                                                                                                                                                     │                                                                                
┌──────────┴──────────┐                                                                                                                                          ┌──────────┴──────────┐                                              
│   RIGHT_DELIM_JOIN  │                                                                                                                                          │      HASH_JOIN      │                                              
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                          │   ─ ─ ─ ─ ─ ─ ─ ─   │                                              
│      RIGHT_SEMI     │                                                                                                                                          │      RIGHT_ANTI     │                                              
│  l_orderkey IS NOT  │                                                                                                                                          │  l_orderkey IS NOT  │                                              
│ DISTINCT FROM l...  ├────────────────────────────────────────────────────────────────────────────────┐                                                         │ DISTINCT FROM l...  ├──────────────────────────────────┐           
│   l_suppkey IS NOT  │                                                                                │                                                         │   l_suppkey IS NOT  │                                  │           
│ DISTINCT FROM l...  │                                                                                │                                                         │ DISTINCT FROM l...  │                                  │           
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                │                                                         │   ─ ─ ─ ─ ─ ─ ─ ─   │                                  │           
│     EC: 6001215     │                                                                                │                                                         │     EC: 6001215     │                                  │           
└──────────┬──────────┘                                                                                │                                                         └──────────┬──────────┘                                  │                                  
┌──────────┴──────────┐                                                                     ┌──────────┴──────────┐                                              ┌──────────┴──────────┐                       ┌──────────┴──────────┐
│      HASH_JOIN      │                                                                     │      HASH_JOIN      │                                              │      PROJECTION     │                       │      DUMMY_SCAN     │
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                     │   ─ ─ ─ ─ ─ ─ ─ ─   │                                              │   ─ ─ ─ ─ ─ ─ ─ ─   │                       │                     │
│        INNER        │                                                                     │      RIGHT_SEMI     │                                              │      l_orderkey     │                       │                     │
│     o_orderkey =    │                                                                     │  l_orderkey IS NOT  │                                              │      l_suppkey      │                       │                     │
│      l_orderkey     ├───────────┐                                                         │ DISTINCT FROM l...  ├──────────────────────────────────┐           │                     │                       │                     │
│   ─ ─ ─ ─ ─ ─ ─ ─   │           │                                                         │   l_suppkey IS NOT  │                                  │           │                     │                       │                     │
│      EC: 15866      │           │                                                         │ DISTINCT FROM l...  │                                  │           │                     │                       │                     │
│                     │           │                                                         │   ─ ─ ─ ─ ─ ─ ─ ─   │                                  │           │                     │                       │                     │
│                     │           │                                                         │     EC: 6001215     │                                  │           │                     │                       │                     │
└──────────┬──────────┘           │                                                         └──────────┬──────────┘                                  │           └──────────┬──────────┘                       └─────────────────────┘                       
┌──────────┴──────────┐┌──────────┴──────────┐                                              ┌──────────┴──────────┐                       ┌──────────┴──────────┐┌──────────┴──────────┐                                              
│      SEQ_SCAN       ││      HASH_JOIN      │                                              │      PROJECTION     │                       │      DUMMY_SCAN     ││      HASH_JOIN      │                                              
│   ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─   │                                              │   ─ ─ ─ ─ ─ ─ ─ ─   │                       │                     ││   ─ ─ ─ ─ ─ ─ ─ ─   │                                              
│        orders       ││        INNER        │                                              │      l_orderkey     │                       │                     ││        INNER        │                                              
│   ─ ─ ─ ─ ─ ─ ─ ─   ││l_suppkey = s_suppkey│                                              │      l_suppkey      │                       │                     ││     l_orderkey =    │                                              
│      o_orderkey     ││   ─ ─ ─ ─ ─ ─ ─ ─   │                                              │                     │                       │                     ││      l_orderkey     │                                              
│   ─ ─ ─ ─ ─ ─ ─ ─   ││     Build Min: 1    ├───────────┐                                  │                     │                       │                     ││     l_suppkey !=    ├───────────┐                                  
│Filters: o_orderstatu││   Build Max: 10000  │           │                                  │                     │                       │                     ││       l_suppkey     │           │                                  
│      s='F' AND      ││   ─ ─ ─ ─ ─ ─ ─ ─   │           │                                  │                     │                       │                     ││   ─ ─ ─ ─ ─ ─ ─ ─   │           │                                  
│ o_orderstatus I...  ││      EC: 47600      │           │                                  │                     │                       │                     ││     EC: 1200243     │           │                                  
│   ─ ─ ─ ─ ─ ─ ─ ─   ││                     │           │                                  │                     │                       │                     ││                     │           │                                  
│      EC: 500000     ││                     │           │                                  │                     │                       │                     ││                     │           │                                  
└─────────────────────┘└──────────┬──────────┘           │                                  └──────────┬──────────┘                       └─────────────────────┘└──────────┬──────────┘           │                                                         
                       ┌──────────┴──────────┐┌──────────┴──────────┐                       ┌──────────┴──────────┐                                              ┌──────────┴──────────┐┌──────────┴──────────┐                       
                       │        FILTER       ││      HASH_JOIN      │                       │      HASH_JOIN      │                                              │        FILTER       ││      DELIM_SCAN     │                       
                       │   ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─   │                       │   ─ ─ ─ ─ ─ ─ ─ ─   │                                              │   ─ ─ ─ ─ ─ ─ ─ ─   ││                     │                       
                       │   (l_receiptdate >  ││        INNER        │                       │        INNER        │                                              │   (l_receiptdate >  ││                     │                       
                       │     l_commitdate)   ││    s_nationkey =    │                       │     l_orderkey =    │                                              │     l_commitdate)   ││                     │                       
                       │   ─ ─ ─ ─ ─ ─ ─ ─   ││      n_nationkey    │                       │      l_orderkey     │                                              │   ─ ─ ─ ─ ─ ─ ─ ─   ││                     │                       
                       │     EC: 1200243     ││   ─ ─ ─ ─ ─ ─ ─ ─   ├───────────┐           │     l_suppkey !=    ├───────────┐                                  │     EC: 6001215     ││                     │                       
                       │                     ││     Build Min: 0    │           │           │       l_suppkey     │           │                                  │                     ││                     │                       
                       │                     ││    Build Max: 24    │           │           │   ─ ─ ─ ─ ─ ─ ─ ─   │           │                                  │                     ││                     │                       
                       │                     ││   ─ ─ ─ ─ ─ ─ ─ ─   │           │           │     EC: 6001215     │           │                                  │                     ││                     │                       
                       │                     ││       EC: 400       │           │           │                     │           │                                  │                     ││                     │                       
                       └──────────┬──────────┘└──────────┬──────────┘           │           └──────────┬──────────┘           │                                  └──────────┬──────────┘└─────────────────────┘                                              
                       ┌──────────┴──────────┐┌──────────┴──────────┐┌──────────┴──────────┐┌──────────┴──────────┐┌──────────┴──────────┐                       ┌──────────┴──────────┐                                              
                       │      SEQ_SCAN       ││      SEQ_SCAN       ││      SEQ_SCAN       ││      SEQ_SCAN       ││      DELIM_SCAN     │                       │      SEQ_SCAN       │                                              
                       │   ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─   ││                     │                       │   ─ ─ ─ ─ ─ ─ ─ ─   │                                              
                       │       lineitem      ││       supplier      ││        nation       ││       lineitem      ││                     │                       │       lineitem      │                                              
                       │   ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─   ││                     │                       │   ─ ─ ─ ─ ─ ─ ─ ─   │                                              
                       │      l_suppkey      ││      s_suppkey      ││     n_nationkey     ││      l_orderkey     ││                     │                       │      l_orderkey     │                                              
                       │      l_orderkey     ││     s_nationkey     ││   ─ ─ ─ ─ ─ ─ ─ ─   ││      l_suppkey      ││                     │                       │      l_suppkey      │                                              
                       │    l_receiptdate    ││        s_name       ││   Filters: n_name=  ││   ─ ─ ─ ─ ─ ─ ─ ─   ││                     │                       │    l_receiptdate    │                                              
                       │     l_commitdate    ││   ─ ─ ─ ─ ─ ─ ─ ─   ││'SAUDI ARABIA' A...  ││     EC: 6001215     ││                     │                       │     l_commitdate    │                                              
                       │   ─ ─ ─ ─ ─ ─ ─ ─   ││      EC: 10000      ││      IS NOT NULL    ││                     ││                     │                       │   ─ ─ ─ ─ ─ ─ ─ ─   │                                              
                       │     EC: 1200243     ││                     ││   ─ ─ ─ ─ ─ ─ ─ ─   ││                     ││                     │                       │     EC: 6001215     │                                              
                       │                     ││                     ││        EC: 1        ││                     ││                     │                       │                     │                                              
                       └─────────────────────┘└─────────────────────┘└─────────────────────┘└─────────────────────┘└─────────────────────┘                       └─────────────────────┘                                                                     

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

Avg Time in sec:  0.6583229834213853  output size:  100
                s_name  numwait
0   Supplier#000002829       20
1   Supplier#000005808       18
2   Supplier#000000262       17
3   Supplier#000000496       17
4   Supplier#000002160       17
..                 ...      ...
95  Supplier#000001916       12
96  Supplier#000001925       12
97  Supplier#000002039       12
98  Supplier#000002357       12
99  Supplier#000002483       12

[100 rows x 2 columns]
{'name': 'Query', 'result': 0.652016, 'timing': 0.652016, 'cardinality': 0, 'extra-info': "SELECT s_name, count(*) AS numwait FROM supplier, lineitem l1, orders, nation WHERE s_suppkey = l1.l_suppkey AND o_orderkey = l1.l_orderkey AND o_orderstatus = 'F' AND l1.l_receiptdate > l1.l_commitdate AND EXISTS ( SELECT * FROM lineitem l2 WHERE l2.l_orderkey = l1.l_orderkey AND l2.l_suppkey <> l1.l_suppkey) AND NOT EXISTS ( SELECT * FROM lineitem l3 WHERE l3.l_orderkey = l1.l_orderkey AND l3.l_suppkey <> l1.l_suppkey AND l3.l_receiptdate > l3.l_commitdate) AND s_nationkey = n_nationkey AND n_name = 'SAUDI ARABIA' GROUP BY s_name ORDER BY numwait DESC, s_name LIMIT 100;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 1.3e-05, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'STREAMING_LIMIT', 'timing': 3e-06, 'cardinality': 100, 'extra_info': '', 'children': [{'name': 'ORDER_BY', 'timing': 7.6e-05, 'cardinality': 411, 'extra_info': 'ORDERS:\ncount_star() DESC\nsupplier.s_name ASC', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.000674, 'cardinality': 411, 'extra_info': '#0\ncount_star()', 'children': [{'name': 'PROJECTION', 'timing': 1e-06, 'cardinality': 4141, 'extra_info': 's_name\n', 'children': [{'name': 'PROJECTION', 'timing': 3e-05, 'cardinality': 4141, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n__internal_compress_integral_usmallint(#1, 1)\n__internal_compress_integral_uinteger(#2, 1)\n#3\n', 'children': [{'name': 'RIGHT_DELIM_JOIN', 'timing': 0.009019, 'cardinality': 0, 'extra_info': 'RIGHT_ANTI\nl_orderkey IS NOT DISTINCT FROM l_orderkey\nl_suppkey IS NOT DISTINCT FROM l_suppkey\n\n[INFOSEPARATOR]\nEC: 6001215\n', 'children': [{'name': 'RIGHT_DELIM_JOIN', 'timing': 0.025606, 'cardinality': 0, 'extra_info': 'RIGHT_SEMI\nl_orderkey IS NOT DISTINCT FROM l_orderkey\nl_suppkey IS NOT DISTINCT FROM l_suppkey\n\n[INFOSEPARATOR]\nEC: 6001215\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.053065, 'cardinality': 75871, 'extra_info': 'INNER\no_orderkey = l_orderkey\n\n[INFOSEPARATOR]\nEC: 15866\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.040313, 'cardinality': 729413, 'extra_info': "orders\n[INFOSEPARATOR]\no_orderkey\n[INFOSEPARATOR]\nFilters: o_orderstatus='F' AND o_orderstatus IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 500000", 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.048466, 'cardinality': 156739, 'extra_info': 'INNER\nl_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 47600\n', 'children': [{'name': 'FILTER', 'timing': 0.033416, 'cardinality': 3793296, 'extra_info': '(l_receiptdate > l_commitdate)\n[INFOSEPARATOR]\nEC: 1200243', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.016117, 'cardinality': 6001215, 'extra_info': 'lineitem\n[INFOSEPARATOR]\nl_suppkey\nl_orderkey\nl_receiptdate\nl_commitdate\n[INFOSEPARATOR]\nEC: 1200243', 'children': []}]}, {'name': 'HASH_JOIN', 'timing': 8.7e-05, 'cardinality': 411, 'extra_info': 'INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 400\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.000195, 'cardinality': 10000, 'extra_info': 'supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\ns_name\n[INFOSEPARATOR]\nEC: 10000', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 2.6e-05, 'cardinality': 1, 'extra_info': "nation\n[INFOSEPARATOR]\nn_nationkey\n[INFOSEPARATOR]\nFilters: n_name='SAUDI ARABIA' AND n_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1", 'children': []}]}]}]}, {'name': 'HASH_JOIN', 'timing': 0.048511, 'cardinality': 73089, 'extra_info': 'RIGHT_SEMI\nl_orderkey IS NOT DISTINCT FROM l_orderkey\nl_suppkey IS NOT DISTINCT FROM l_suppkey\n\n[INFOSEPARATOR]\nEC: 6001215\n', 'children': [{'name': 'PROJECTION', 'timing': 0.001216, 'cardinality': 302356, 'extra_info': 'l_orderkey\nl_suppkey\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.127398, 'cardinality': 302356, 'extra_info': 'INNER\nl_orderkey = l_orderkey\nl_suppkey != l_suppkey\n\n[INFOSEPARATOR]\nEC: 6001215\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.011963, 'cardinality': 6001215, 'extra_info': 'lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_suppkey\n[INFOSEPARATOR]\nEC: 6001215', 'children': []}, {'name': 'DELIM_SCAN', 'timing': 0.0, 'cardinality': 0, 'extra_info': '', 'children': []}]}]}, {'name': 'DUMMY_SCAN', 'timing': 0.0, 'cardinality': 0, 'extra_info': '', 'children': []}]}, {'name': 'HASH_GROUP_BY', 'timing': 0.000912, 'cardinality': 75864, 'extra_info': '#0\n#1', 'children': []}]}, {'name': 'HASH_JOIN', 'timing': 0.021308, 'cardinality': 4141, 'extra_info': 'RIGHT_ANTI\nl_orderkey IS NOT DISTINCT FROM l_orderkey\nl_suppkey IS NOT DISTINCT FROM l_suppkey\n\n[INFOSEPARATOR]\nEC: 6001215\n', 'children': [{'name': 'PROJECTION', 'timing': 0.000379, 'cardinality': 190909, 'extra_info': 'l_orderkey\nl_suppkey\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.117344, 'cardinality': 190909, 'extra_info': 'INNER\nl_orderkey = l_orderkey\nl_suppkey != l_suppkey\n\n[INFOSEPARATOR]\nEC: 1200243\n', 'children': [{'name': 'FILTER', 'timing': 0.030699, 'cardinality': 3793296, 'extra_info': '(l_receiptdate > l_commitdate)\n[INFOSEPARATOR]\nEC: 6001215', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.015165, 'cardinality': 6001215, 'extra_info': 'lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_suppkey\nl_receiptdate\nl_commitdate\n[INFOSEPARATOR]\nEC: 6001215', 'children': []}]}, {'name': 'DELIM_SCAN', 'timing': 0.0, 'cardinality': 0, 'extra_info': '', 'children': []}]}]}, {'name': 'DUMMY_SCAN', 'timing': 0.0, 'cardinality': 0, 'extra_info': '', 'children': []}]}, {'name': 'HASH_GROUP_BY', 'timing': 0.000829, 'cardinality': 73082, 'extra_info': '#0\n#1', 'children': []}]}]}]}]}]}]}]}]}
X {'RESULT_COLLECTOR0': 1.3e-05, 'STREAMING_LIMIT1': 3e-06, 'ORDER_BY2': 7.6e-05, 'HASH_GROUP_BY3': 0.000674, 'PROJECTION4': 1e-06, 'PROJECTION5': 3e-05, 'RIGHT_DELIM_JOIN6': 0.009019, 'RIGHT_DELIM_JOIN7': 0.025606, 'HASH_JOIN8': 0.053065, 'SEQ_SCAN 9': 0.040313, 'HASH_JOIN10': 0.048466, 'FILTER11': 0.033416, 'SEQ_SCAN 12': 0.016117, 'HASH_JOIN13': 8.7e-05, 'SEQ_SCAN 14': 0.000195, 'SEQ_SCAN 15': 2.6e-05, 'HASH_JOIN16': 0.048511, 'PROJECTION17': 0.001216, 'HASH_JOIN18': 0.127398, 'SEQ_SCAN 19': 0.011963, 'DELIM_SCAN20': 0.0, 'DUMMY_SCAN21': 0.0, 'HASH_GROUP_BY22': 0.000912, 'HASH_JOIN23': 0.021308, 'PROJECTION24': 0.000379, 'HASH_JOIN25': 0.117344, 'FILTER26': 0.030699, 'SEQ_SCAN 27': 0.015165, 'DELIM_SCAN28': 0.0, 'DUMMY_SCAN29': 0.0, 'HASH_GROUP_BY30': 0.000829}
Physical operator output, input_left, input_right: 
**** output size:  100
LINEAGE_5_FILTER_17
LINEAGE_5_FILTER_2
LINEAGE_5_HASH_GROUP_BY_14
LINEAGE_5_HASH_GROUP_BY_23
LINEAGE_5_HASH_GROUP_BY_27
LINEAGE_5_HASH_JOIN_10
LINEAGE_5_HASH_JOIN_13
LINEAGE_5_HASH_JOIN_19
LINEAGE_5_HASH_JOIN_22
LINEAGE_5_HASH_JOIN_5
LINEAGE_5_HASH_JOIN_6
LINEAGE_5_HASH_JOIN_7
LINEAGE_5_ORDER_BY_28
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_1
LINEAGE_5_SEQ_SCAN_16
LINEAGE_5_SEQ_SCAN_3
LINEAGE_5_SEQ_SCAN_4
LINEAGE_5_SEQ_SCAN_8
LINEAGE_5_STREAMING_LIMIT_29
SELECT s_name, count(*) AS numwait FROM supplier, lineitem l1, orders, nation WHERE s_suppkey = l1.l_suppkey AND o_orderkey = l1.l_orderkey AND o_orderstatus = 'F' AND l1.l_receiptdate > l1.l_commitdate AND EXISTS ( SELECT * FROM lineitem l2 WHERE l2.l_orderkey = l1.l_orderkey AND l2.l_suppkey <> l1.l_suppkey) AND NOT EXISTS ( SELECT * FROM lineitem l3 WHERE l3.l_orderkey = l1.l_orderkey AND l3.l_suppkey <> l1.l_suppkey AND l3.l_receiptdate > l3.l_commitdate) AND s_nationkey = n_nationkey AND n_name = 'SAUDI ARABIA' GROUP BY s_name ORDER BY numwait DESC, s_name LIMIT 100;
   query_id  ...                                               plan
0         5  ...  {"name": "STREAMING_LIMIT", "opid": "29", "chi...

[1 rows x 8 columns]
Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                                                                                                                                                                              
│          ORDER_BY         │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│          ORDERS:          │                                                                                                                                                                              
│   custsale.cntrycode ASC  │                                                                                                                                                                              
└─────────────┬─────────────┘                                                                                                                                                                                                           
┌─────────────┴─────────────┐                                                                                                                                                                              
│       HASH_GROUP_BY       │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│             #0            │                                                                                                                                                                              
│        count_star()       │                                                                                                                                                                              
│          sum(#1)          │                                                                                                                                                                              
└─────────────┬─────────────┘                                                                                                                                                                                                           
┌─────────────┴─────────────┐                                                                                                                                                                              
│         PROJECTION        │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│         cntrycode         │                                                                                                                                                                              
│         c_acctbal         │                                                                                                                                                                              
└─────────────┬─────────────┘                                                                                                                                                                                                           
┌─────────────┴─────────────┐                                                                                                                                                                              
│         PROJECTION        │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│         cntrycode         │                                                                                                                                                                              
│         c_acctbal         │                                                                                                                                                                              
└─────────────┬─────────────┘                                                                                                                                                                                                           
┌─────────────┴─────────────┐                                                                                                                                                                              
│      RIGHT_DELIM_JOIN     │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│         RIGHT_ANTI        │                                                                                                                                                                              
│ c_custkey IS NOT DISTINCT ├─────────────────────────────────────────────────────────────────────────────────────────────────────┐                                                                        
│       FROM c_custkey      │                                                                                                     │                                                                        
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                     │                                                                        
│        EC: 1500000        │                                                                                                     │                                                                        
└─────────────┬─────────────┘                                                                                                     │                                                                                                     
┌─────────────┴─────────────┐                                                                                       ┌─────────────┴─────────────┐                                                          
│      NESTED_LOOP_JOIN     │                                                                                       │         HASH_JOIN         │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│           INNER           │                                                                                       │         RIGHT_ANTI        │                                                          
│CAST(c_acctbal AS DOUBLE) >├───────────────────────────────────────────┐                                           │ c_custkey IS NOT DISTINCT ├───────────────────────────────────────────┐              
│          SUBQUERY         │                                           │                                           │       FROM c_custkey      │                                           │              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                           │                                           │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                           │              
│           EC: 0           │                                           │                                           │        EC: 1500000        │                                           │              
└─────────────┬─────────────┘                                           │                                           └─────────────┬─────────────┘                                           │                                           
┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐
│           FILTER          │                             │    UNGROUPED_AGGREGATE    │                             │         PROJECTION        │                             │         DUMMY_SCAN        │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │                           │
│          IN (...)         │                             │         first(#0)         │                             │         c_custkey         │                             │                           │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │                           │                             │                           │                             │                           │
│         EC: 30000         │                             │                           │                             │                           │                             │                           │
└─────────────┬─────────────┘                             └─────────────┬─────────────┘                             └─────────────┬─────────────┘                             └───────────────────────────┘                             
┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐                                                          
│         HASH_JOIN         │                             │         PROJECTION        │                             │         HASH_JOIN         │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│            MARK           │                             │             #0            │                             │           INNER           │                                                          
│substring(c_phone, 1, 2) = ├──────────────┐              │                           │                             │   o_custkey = c_custkey   ├──────────────┐                                           
│             #0            │              │              │                           │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              │                           │                             │        EC: 1500000        │              │                                           
│         EC: 150000        │              │              │                           │                             │                           │              │                                           
└─────────────┬─────────────┘              │              └─────────────┬─────────────┘                             └─────────────┬─────────────┘              │                                                                        
┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             
│         SEQ_SCAN          ││      COLUMN_DATA_SCAN     ││      STREAMING_LIMIT      │                             │         SEQ_SCAN          ││         DELIM_SCAN        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           ││                           │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                             
│          customer         ││                           ││                           │                             │           orders          ││                           │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           ││                           │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                             
│          c_phone          ││                           ││                           │                             │         o_custkey         ││                           │                             
│         c_acctbal         ││                           ││                           │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                             
│         c_custkey         ││                           ││                           │                             │        EC: 1500000        ││                           │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           ││                           │                             │                           ││                           │                             
│         EC: 150000        ││                           ││                           │                             │                           ││                           │                             
└───────────────────────────┘└───────────────────────────┘└─────────────┬─────────────┘                             └───────────────────────────┘└───────────────────────────┘                                                          
                                                          ┌─────────────┴─────────────┐                                                                                                                    
                                                          │    UNGROUPED_AGGREGATE    │                                                                                                                    
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
                                                          │          avg(#0)          │                                                                                                                    
                                                          └─────────────┬─────────────┘                                                                                                                                                 
                                                          ┌─────────────┴─────────────┐                                                                                                                    
                                                          │         PROJECTION        │                                                                                                                    
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
                                                          │         c_acctbal         │                                                                                                                    
                                                          └─────────────┬─────────────┘                                                                                                                                                 
                                                          ┌─────────────┴─────────────┐                                                                                                                    
                                                          │         PROJECTION        │                                                                                                                    
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
                                                          │             #0            │                                                                                                                    
                                                          │             #2            │                                                                                                                    
                                                          └─────────────┬─────────────┘                                                                                                                                                 
                                                          ┌─────────────┴─────────────┐                                                                                                                    
                                                          │           FILTER          │                                                                                                                    
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
                                                          │          IN (...)         │                                                                                                                    
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
                                                          │          EC: 6000         │                                                                                                                    
                                                          └─────────────┬─────────────┘                                                                                                                                                 
                                                          ┌─────────────┴─────────────┐                                                                                                                    
                                                          │         HASH_JOIN         │                                                                                                                    
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
                                                          │            MARK           │                                                                                                                    
                                                          │substring(c_phone, 1, 2) = ├──────────────┐                                                                                                     
                                                          │             #0            │              │                                                                                                     
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                                                                                     
                                                          │         EC: 30000         │              │                                                                                                     
                                                          └─────────────┬─────────────┘              │                                                                                                                                  
                                                          ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                       
                                                          │         SEQ_SCAN          ││      COLUMN_DATA_SCAN     │                                                                                       
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                                                                       
                                                          │          customer         ││                           │                                                                                       
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                                                                       
                                                          │         c_acctbal         ││                           │                                                                                       
                                                          │          c_phone          ││                           │                                                                                       
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                                                                       
                                                          │Filters: c_acctbal>0.00 AND││                           │                                                                                       
                                                          │    c_acctbal IS NOT NULL  ││                           │                                                                                       
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                                                                       
                                                          │         EC: 30000         ││                           │                                                                                       
                                                          └───────────────────────────┘└───────────────────────────┘                                                                                                                    

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

Query info:  query_id                                                            5
query               SELECT s_name, count(*) AS numwait FROM suppli...
size_bytes_max                                                8817546
physical_op_size    [21654, 144, 584, 8208, 0, 0, 49970, 391804, 1...
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "STREAMING_LIMIT", "opid": "29", "chi...
Name: 0, dtype: object
physical op size is:
{"name": "STREAMING_LIMIT", "opid": "29", "children": [{"name": "ORDER_BY", "opid": "28", "children": [{"name": "HASH_GROUP_BY", "opid": "27", "children": [{"name": "PROJECTION", "opid": "26", "children": [{"name": "PROJECTION", "opid": "25", "children": [{"name": "RIGHT_DELIM_JOIN", "opid": "24", "children": [{"name": "HASH_GROUP_BY", "opid": "23", "children": [],"table": "","extra": "#0\n#1"},{"name": "HASH_JOIN", "opid": "22", "children": [{"name": "PROJECTION", "opid": "20", "children": [{"name": "HASH_JOIN", "opid": "19", "children": [{"name": "FILTER", "opid": "17", "children": [{"name": "SEQ_SCAN ", "opid": "16", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_suppkey\nl_receiptdate\nl_commitdate\n[INFOSEPARATOR]\nEC: 6001215"}],"table": "","extra": "(l_receiptdate > l_commitdate)\n[INFOSEPARATOR]\nEC: 6001215"},{"name": "DELIM_SCAN", "opid": "18", "children": [],"table": "","extra": ""}],"table": "","extra": "INNER\nl_orderkey = l_orderkey\nl_suppkey != l_suppkey\n\n[INFOSEPARATOR]\nEC: 1200243\n"}],"table": "","extra": "l_orderkey\nl_suppkey\n"},{"name": "DUMMY_SCAN", "opid": "21", "children": [],"table": "","extra": ""}],"table": "","extra": "RIGHT_ANTI\nl_orderkey IS NOT DISTINCT FROM l_orderkey\nl_suppkey IS NOT DISTINCT FROM l_suppkey\n\n[INFOSEPARATOR]\nEC: 6001215\n"},{"name": "RIGHT_DELIM_JOIN", "opid": "15", "children": [{"name": "HASH_GROUP_BY", "opid": "14", "children": [],"table": "","extra": "#0\n#1"},{"name": "HASH_JOIN", "opid": "13", "children": [{"name": "PROJECTION", "opid": "11", "children": [{"name": "HASH_JOIN", "opid": "10", "children": [{"name": "SEQ_SCAN ", "opid": "8", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_suppkey\n[INFOSEPARATOR]\nEC: 6001215"},{"name": "DELIM_SCAN", "opid": "9", "children": [],"table": "","extra": ""}],"table": "","extra": "INNER\nl_orderkey = l_orderkey\nl_suppkey != l_suppkey\n\n[INFOSEPARATOR]\nEC: 6001215\n"}],"table": "","extra": "l_orderkey\nl_suppkey\n"},{"name": "DUMMY_SCAN", "opid": "12", "children": [],"table": "","extra": ""}],"table": "","extra": "RIGHT_SEMI\nl_orderkey IS NOT DISTINCT FROM l_orderkey\nl_suppkey IS NOT DISTINCT FROM l_suppkey\n\n[INFOSEPARATOR]\nEC: 6001215\n"},{"name": "HASH_JOIN", "opid": "7", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "orders","extra": "orders\n[INFOSEPARATOR]\no_orderkey\n[INFOSEPARATOR]\nFilters: o_orderstatus='F' AND o_orderstatus IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 500000"},{"name": "HASH_JOIN", "opid": "6", "children": [{"name": "FILTER", "opid": "2", "children": [{"name": "SEQ_SCAN ", "opid": "1", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_suppkey\nl_orderkey\nl_receiptdate\nl_commitdate\n[INFOSEPARATOR]\nEC: 1200243"}],"table": "","extra": "(l_receiptdate > l_commitdate)\n[INFOSEPARATOR]\nEC: 1200243"},{"name": "HASH_JOIN", "opid": "5", "children": [{"name": "SEQ_SCAN ", "opid": "3", "children": [],"table": "supplier","extra": "supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\ns_name\n[INFOSEPARATOR]\nEC: 10000"},{"name": "SEQ_SCAN ", "opid": "4", "children": [],"table": "nation","extra": "nation\n[INFOSEPARATOR]\nn_nationkey\n[INFOSEPARATOR]\nFilters: n_name='SAUDI ARABIA' AND n_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1"}],"table": "","extra": "INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 400\n"}],"table": "","extra": "INNER\nl_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 47600\n"}],"table": "","extra": "INNER\no_orderkey = l_orderkey\n\n[INFOSEPARATOR]\nEC: 15866\n"}],"table": "","extra": "RIGHT_SEMI\nl_orderkey IS NOT DISTINCT FROM l_orderkey\nl_suppkey IS NOT DISTINCT FROM l_suppkey\n\n[INFOSEPARATOR]\nEC: 6001215\n"}],"table": "","extra": "RIGHT_ANTI\nl_orderkey IS NOT DISTINCT FROM l_orderkey\nl_suppkey IS NOT DISTINCT FROM l_suppkey\n\n[INFOSEPARATOR]\nEC: 6001215\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n__internal_compress_integral_usmallint(#1, 1)\n__internal_compress_integral_uinteger(#2, 1)\n#3\n"}],"table": "","extra": "s_name\n"}],"table": "","extra": "#0\ncount_star()"}],"table": "","extra": "ORDERS:\ncount_star() DESC\nsupplier.s_name ASC"}],"table": "","extra": ""}
%%%%%%%%%%%%%%%% Running Query #  22  threads:  1
SELECT cntrycode, count(*) AS numcust, sum(c_acctbal) AS totacctbal FROM ( SELECT substring(c_phone FROM 1 FOR 2) AS cntrycode, c_acctbal FROM customer WHERE substring(c_phone FROM 1 FOR 2) IN ('13', '31', '23', '29', '30', '18', '17') AND c_acctbal > ( SELECT avg(c_acctbal) FROM customer WHERE c_acctbal > 0.00 AND substring(c_phone FROM 1 FOR 2) IN ('13', '31', '23', '29', '30', '18', '17')) AND NOT EXISTS ( SELECT * FROM orders WHERE o_custkey = c_custkey)) AS custsale GROUP BY cntrycode ORDER BY cntrycode;
Run:  None SELECT cntrycode, count(*) AS numcust, sum(c_acctbal) AS totacctbal FROM ( SELECT substring(c_phone FROM 1 FOR 2) AS cntrycode, c_acctbal FROM customer WHERE substring(c_phone FROM 1 FOR 2) IN ('13', '31', '23', '29', '30', '18', '17') AND c_acctbal > ( SELECT avg(c_acctbal) FROM customer WHERE c_acctbal > 0.00 AND substring(c_phone FROM 1 FOR 2) IN ('13', '31', '23', '29', '30', '18', '17')) AND NOT EXISTS ( SELECT * FROM orders WHERE o_custkey = c_custkey)) AS custsale GROUP BY cntrycode ORDER BY cntrycode;
Avg Time in sec:  0.12544051371514797  output size:  7
  cntrycode  numcust  totacctbal
0        13      888  6737713.99
1        17      861  6460573.72
2        18      964  7236687.40
3        23      892  6701457.95
4        29      948  7158866.63
5        30      909  6808436.13
6        31      922  6806670.18
{'name': 'Query', 'result': 0.121145, 'timing': 0.121145, 'cardinality': 0, 'extra-info': "SELECT cntrycode, count(*) AS numcust, sum(c_acctbal) AS totacctbal FROM ( SELECT substring(c_phone FROM 1 FOR 2) AS cntrycode, c_acctbal FROM customer WHERE substring(c_phone FROM 1 FOR 2) IN ('13', '31', '23', '29', '30', '18', '17') AND c_acctbal > ( SELECT avg(c_acctbal) FROM customer WHERE c_acctbal > 0.00 AND substring(c_phone FROM 1 FOR 2) IN ('13', '31', '23', '29', '30', '18', '17')) AND NOT EXISTS ( SELECT * FROM orders WHERE o_custkey = c_custkey)) AS custsale GROUP BY cntrycode ORDER BY cntrycode;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 9e-06, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'ORDER_BY', 'timing': 6e-05, 'cardinality': 7, 'extra_info': 'ORDERS:\ncustsale.cntrycode ASC', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.000859, 'cardinality': 7, 'extra_info': '#0\ncount_star()\nsum(#1)', 'children': [{'name': 'PROJECTION', 'timing': 2e-06, 'cardinality': 6384, 'extra_info': 'cntrycode\nc_acctbal\n', 'children': [{'name': 'PROJECTION', 'timing': 0.000286, 'cardinality': 6384, 'extra_info': 'cntrycode\nc_acctbal\n', 'children': [{'name': 'RIGHT_DELIM_JOIN', 'timing': 0.008339, 'cardinality': 0, 'extra_info': 'RIGHT_ANTI\nc_custkey IS NOT DISTINCT FROM c_custkey\n\n[INFOSEPARATOR]\nEC: 1500000\n', 'children': [{'name': 'NESTED_LOOP_JOIN', 'timing': 0.002596, 'cardinality': 19000, 'extra_info': 'INNER\nCAST(c_acctbal AS DOUBLE) > SUBQUERY\n\n[INFOSEPARATOR]\nEC: 0\n', 'children': [{'name': 'FILTER', 'timing': 0.001076, 'cardinality': 42015, 'extra_info': 'IN (...)\n[INFOSEPARATOR]\nEC: 30000', 'children': [{'name': 'HASH_JOIN', 'timing': 0.008975, 'cardinality': 150000, 'extra_info': 'MARK\nsubstring(c_phone, 1, 2) = #0\n\n[INFOSEPARATOR]\nEC: 150000\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.003493, 'cardinality': 150000, 'extra_info': 'customer\n[INFOSEPARATOR]\nc_phone\nc_acctbal\nc_custkey\n[INFOSEPARATOR]\nEC: 150000', 'children': []}, {'name': 'COLUMN_DATA_SCAN', 'timing': 5e-06, 'cardinality': 7, 'extra_info': '', 'children': []}]}]}, {'name': 'UNGROUPED_AGGREGATE', 'timing': 6e-06, 'cardinality': 1, 'extra_info': 'first(#0)', 'children': [{'name': 'PROJECTION', 'timing': 1e-06, 'cardinality': 1, 'extra_info': '#0\n', 'children': [{'name': 'STREAMING_LIMIT', 'timing': 4e-06, 'cardinality': 1, 'extra_info': '', 'children': [{'name': 'UNGROUPED_AGGREGATE', 'timing': 0.000143, 'cardinality': 1, 'extra_info': 'avg(#0)', 'children': [{'name': 'PROJECTION', 'timing': 1.7e-05, 'cardinality': 38120, 'extra_info': 'c_acctbal\n', 'children': [{'name': 'PROJECTION', 'timing': 3.1e-05, 'cardinality': 38120, 'extra_info': '#0\n#2\n', 'children': [{'name': 'FILTER', 'timing': 0.000914, 'cardinality': 38120, 'extra_info': 'IN (...)\n[INFOSEPARATOR]\nEC: 6000', 'children': [{'name': 'HASH_JOIN', 'timing': 0.006827, 'cardinality': 136308, 'extra_info': 'MARK\nsubstring(c_phone, 1, 2) = #0\n\n[INFOSEPARATOR]\nEC: 30000\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.004536, 'cardinality': 136308, 'extra_info': 'customer\n[INFOSEPARATOR]\nc_acctbal\nc_phone\n[INFOSEPARATOR]\nFilters: c_acctbal>0.00 AND c_acctbal IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 30000', 'children': []}, {'name': 'COLUMN_DATA_SCAN', 'timing': 1e-05, 'cardinality': 7, 'extra_info': '', 'children': []}]}]}]}]}]}]}]}]}]}, {'name': 'HASH_JOIN', 'timing': 0.017934, 'cardinality': 6384, 'extra_info': 'RIGHT_ANTI\nc_custkey IS NOT DISTINCT FROM c_custkey\n\n[INFOSEPARATOR]\nEC: 1500000\n', 'children': [{'name': 'PROJECTION', 'timing': 0.000363, 'cardinality': 190069, 'extra_info': 'c_custkey\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.050502, 'cardinality': 190069, 'extra_info': 'INNER\no_custkey = c_custkey\n\n[INFOSEPARATOR]\nEC: 1500000\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.003261, 'cardinality': 1500000, 'extra_info': 'orders\n[INFOSEPARATOR]\no_custkey\n[INFOSEPARATOR]\nEC: 1500000', 'children': []}, {'name': 'DELIM_SCAN', 'timing': 0.0, 'cardinality': 0, 'extra_info': '', 'children': []}]}]}, {'name': 'DUMMY_SCAN', 'timing': 0.0, 'cardinality': 0, 'extra_info': '', 'children': []}]}, {'name': 'HASH_GROUP_BY', 'timing': 0.000243, 'cardinality': 19000, 'extra_info': '#2', 'children': []}]}]}]}]}]}]}]}
Clear Lineage

X {'RESULT_COLLECTOR0': 9e-06, 'ORDER_BY1': 6e-05, 'HASH_GROUP_BY2': 0.000859, 'PROJECTION3': 2e-06, 'PROJECTION4': 0.000286, 'RIGHT_DELIM_JOIN5': 0.008339, 'NESTED_LOOP_JOIN6': 0.002596, 'FILTER7': 0.001076, 'HASH_JOIN8': 0.008975, 'SEQ_SCAN 9': 0.003493, 'COLUMN_DATA_SCAN10': 5e-06, 'UNGROUPED_AGGREGATE11': 6e-06, 'PROJECTION12': 1e-06, 'STREAMING_LIMIT13': 4e-06, 'UNGROUPED_AGGREGATE14': 0.000143, 'PROJECTION15': 1.7e-05, 'PROJECTION16': 3.1e-05, 'FILTER17': 0.000914, 'HASH_JOIN18': 0.006827, 'SEQ_SCAN 19': 0.004536, 'COLUMN_DATA_SCAN20': 1e-05, 'HASH_JOIN21': 0.017934, 'PROJECTION22': 0.000363, 'HASH_JOIN23': 0.050502, 'SEQ_SCAN 24': 0.003261, 'DELIM_SCAN25': 0.0, 'DUMMY_SCAN26': 0.0, 'HASH_GROUP_BY27': 0.000243}
Physical operator output, input_left, input_right: 
**** output size:  7
LINEAGE_5_COLUMN_DATA_SCAN_1
LINEAGE_5_COLUMN_DATA_SCAN_5
LINEAGE_5_FILTER_3
LINEAGE_5_FILTER_7
LINEAGE_5_HASH_GROUP_BY_21
LINEAGE_5_HASH_GROUP_BY_25
LINEAGE_5_HASH_JOIN_17
LINEAGE_5_HASH_JOIN_2
LINEAGE_5_HASH_JOIN_20
LINEAGE_5_HASH_JOIN_6
LINEAGE_5_NESTED_LOOP_JOIN_14
LINEAGE_5_ORDER_BY_26
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_15
LINEAGE_5_SEQ_SCAN_4
LINEAGE_5_STREAMING_LIMIT_11
SELECT cntrycode, count(*) AS numcust, sum(c_acctbal) AS totacctbal FROM ( SELECT substring(c_phone FROM 1 FOR 2) AS cntrycode, c_acctbal FROM customer WHERE substring(c_phone FROM 1 FOR 2) IN ('13', '31', '23', '29', '30', '18', '17') AND c_acctbal > ( SELECT avg(c_acctbal) FROM customer WHERE c_acctbal > 0.00 AND substring(c_phone FROM 1 FOR 2) IN ('13', '31', '23', '29', '30', '18', '17')) AND NOT EXISTS ( SELECT * FROM orders WHERE o_custkey = c_custkey)) AS custsale GROUP BY cntrycode ORDER BY cntrycode;
   query_id  ...                                               plan
0         5  ...  {"name": "ORDER_BY", "opid": "26", "children":...

[1 rows x 8 columns]
Query info:  query_id                                                            5
query               SELECT cntrycode, count(*) AS numcust, sum(c_a...
size_bytes_max                                                1974619
physical_op_size    [0, 64, 10867, 0, 0, 52733, 8740, 19777, 324, ...
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "ORDER_BY", "opid": "26", "children":...
Name: 0, dtype: object
physical op size is:
{"name": "ORDER_BY", "opid": "26", "children": [{"name": "HASH_GROUP_BY", "opid": "25", "children": [{"name": "PROJECTION", "opid": "24", "children": [{"name": "PROJECTION", "opid": "23", "children": [{"name": "RIGHT_DELIM_JOIN", "opid": "22", "children": [{"name": "HASH_GROUP_BY", "opid": "21", "children": [],"table": "","extra": "#2"},{"name": "HASH_JOIN", "opid": "20", "children": [{"name": "PROJECTION", "opid": "18", "children": [{"name": "HASH_JOIN", "opid": "17", "children": [{"name": "SEQ_SCAN ", "opid": "15", "children": [],"table": "orders","extra": "orders\n[INFOSEPARATOR]\no_custkey\n[INFOSEPARATOR]\nEC: 1500000"},{"name": "DELIM_SCAN", "opid": "16", "children": [],"table": "","extra": ""}],"table": "","extra": "INNER\no_custkey = c_custkey\n\n[INFOSEPARATOR]\nEC: 1500000\n"}],"table": "","extra": "c_custkey\n"},{"name": "DUMMY_SCAN", "opid": "19", "children": [],"table": "","extra": ""}],"table": "","extra": "RIGHT_ANTI\nc_custkey IS NOT DISTINCT FROM c_custkey\n\n[INFOSEPARATOR]\nEC: 1500000\n"},{"name": "NESTED_LOOP_JOIN", "opid": "14", "children": [{"name": "FILTER", "opid": "3", "children": [{"name": "HASH_JOIN", "opid": "2", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "customer","extra": "customer\n[INFOSEPARATOR]\nc_phone\nc_acctbal\nc_custkey\n[INFOSEPARATOR]\nEC: 150000"},{"name": "COLUMN_DATA_SCAN", "opid": "1", "children": [],"table": "","extra": ""}],"table": "","extra": "MARK\nsubstring(c_phone, 1, 2) = #0\n\n[INFOSEPARATOR]\nEC: 150000\n"}],"table": "","extra": "IN (...)\n[INFOSEPARATOR]\nEC: 30000"},{"name": "UNGROUPED_AGGREGATE", "opid": "13", "children": [{"name": "PROJECTION", "opid": "12", "children": [{"name": "STREAMING_LIMIT", "opid": "11", "children": [{"name": "UNGROUPED_AGGREGATE", "opid": "10", "children": [{"name": "PROJECTION", "opid": "9", "children": [{"name": "PROJECTION", "opid": "8", "children": [{"name": "FILTER", "opid": "7", "children": [{"name": "HASH_JOIN", "opid": "6", "children": [{"name": "SEQ_SCAN ", "opid": "4", "children": [],"table": "customer","extra": "customer\n[INFOSEPARATOR]\nc_acctbal\nc_phone\n[INFOSEPARATOR]\nFilters: c_acctbal>0.00 AND c_acctbal IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 30000"},{"name": "COLUMN_DATA_SCAN", "opid": "5", "children": [],"table": "","extra": ""}],"table": "","extra": "MARK\nsubstring(c_phone, 1, 2) = #0\n\n[INFOSEPARATOR]\nEC: 30000\n"}],"table": "","extra": "IN (...)\n[INFOSEPARATOR]\nEC: 6000"}],"table": "","extra": "#0\n#2\n"}],"table": "","extra": "c_acctbal\n"}],"table": "","extra": "avg(#0)"}],"table": "","extra": ""}],"table": "","extra": "#0\n"}],"table": "","extra": "first(#0)"}],"table": "","extra": "INNER\nCAST(c_acctbal AS DOUBLE) > SUBQUERY\n\n[INFOSEPARATOR]\nEC: 0\n"}],"table": "","extra": "RIGHT_ANTI\nc_custkey IS NOT DISTINCT FROM c_custkey\n\n[INFOSEPARATOR]\nEC: 1500000\n"}],"table": "","extra": "cntrycode\nc_acctbal\n"}],"table": "","extra": "cntrycode\nc_acctbal\n"}],"table": "","extra": "#0\ncount_star()\nsum(#1)"}],"table": "","extra": "ORDERS:\ncustsale.cntrycode ASC"}
average 4.841853965412486
tpch_benchmark_capture_output_prefix_compress_1_test.csv
