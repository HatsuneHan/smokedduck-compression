
Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐
│         PROJECTION        │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│__internal_decompress_strin│
│           g(#0)           │
│__internal_decompress_strin│
│           g(#1)           │
│             #2            │
│             #3            │
│             #4            │
│             #5            │
│             #6            │
│             #7            │
│             #8            │
│             #9            │
└─────────────┬─────────────┘                             
┌─────────────┴─────────────┐
│          ORDER_BY         │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│          ORDERS:          │
│ lineitem.l_returnflag ASC │
│ lineitem.l_linestatus ASC │
└─────────────┬─────────────┘                             
┌─────────────┴─────────────┐
│         PROJECTION        │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│__internal_compress_string_│
│        utinyint(#0)       │
│__internal_compress_string_│
│        utinyint(#1)       │
│             #2            │
│             #3            │
│             #4            │
│             #5            │
│             #6            │
│             #7            │
│             #8            │
│             #9            │
└─────────────┬─────────────┘                             
┌─────────────┴─────────────┐
│         PROJECTION        │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│__internal_decompress_strin│
│           g(#0)           │
│__internal_decompress_strin│
│           g(#1)           │
│             #2            │
│             #3            │
│             #4            │
│             #5            │
│             #6            │
│             #7            │
│             #8            │
│             #9            │
└─────────────┬─────────────┘                             
┌─────────────┴─────────────┐
│   PERFECT_HASH_GROUP_BY   │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│             #0            │
│             #1            │
│    sum_no_overflow(#2)    │
│    sum_no_overflow(#3)    │
│    sum_no_overflow(#4)    │
│    sum_no_overflow(#5)    │
│          avg(#6)          │
│          avg(#7)          │
│          avg(#8)          │
│        count_star()       │
└─────────────┬─────────────┘                             
┌─────────────┴─────────────┐
│         PROJECTION        │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│        l_returnflag       │
│        l_linestatus       │
│         l_quantity        │
│      l_extendedprice      │
│             #4            │
│   (#4 * (1.00 + l_tax))   │
│         l_quantity        │
│      l_extendedprice      │
│         l_discount        │
└─────────────┬─────────────┘                             
┌─────────────┴─────────────┐
│         PROJECTION        │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│__internal_compress_string_│
│        utinyint(#0)       │
│__internal_compress_string_│
│        utinyint(#1)       │
│             #2            │
│             #3            │
│             #4            │
│             #5            │
│             #6            │
└─────────────┬─────────────┘                             
┌─────────────┴─────────────┐
│         PROJECTION        │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│        l_returnflag       │
│        l_linestatus       │
│         l_quantity        │
│      l_extendedprice      │
│ (l_extendedprice * (1.00 -│
│        l_discount))       │
│           l_tax           │
│         l_discount        │
└─────────────┬─────────────┘                             
┌─────────────┴─────────────┐
│         SEQ_SCAN          │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│          lineitem         │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│        l_returnflag       │
│        l_linestatus       │
│         l_quantity        │
│      l_extendedprice      │
│         l_discount        │
│           l_tax           │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│ Filters: l_shipdate<='1998│
│-09-02'::DATE AND l_sh...  │
│         IS NOT NULL       │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│        EC: 1200243        │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

compressed filter_log_size: 544
compressed filter_log_buffer_size: 0
compressed limit_offset_size: 544
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 544
compressed perfect_full_scan_ht_log_buffer_size: 0
compressed perfect_probe_ht_log_size: 544
compressed perfect_probe_ht_log_buffer_size: 0
compressed row_group_log_size: 265348
compressed row_group_log_buffer_size: 224597
compressed scatter_log_size: 12730183
compressed scatter_log_buffer_size: 12714717
compressed scatter_sel_log_size: 544
compressed scatter_sel_log_buffer_size: 0
compressed gather_log_size: 544
compressed gather_log_buffer_size: 0
compressed combine_log_size: 752
compressed combine_log_buffer_size: 64
compressed finalize_states_log_size: 758
compressed finalize_states_log_buffer_size: 70
compressed join_gather_log_size: 544
compressed join_gather_log_buffer_size: 0
compressed reorder_log_size: 896
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 544
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 544
compressed nlj_log_buffer_size: 0
compressed total_size: 13002833
compressed total_buffer_size: 12939448
compressed total_element_size: 63385

Clear Lineage
True
%%%%%%%%%%%%%%%% Running Query #  1  threads:  1
SELECT l_returnflag, l_linestatus, sum(l_quantity) AS sum_qty, sum(l_extendedprice) AS sum_base_price, sum(l_extendedprice * (1 - l_discount)) AS sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) AS sum_charge, avg(l_quantity) AS avg_qty, avg(l_extendedprice) AS avg_price, avg(l_discount) AS avg_disc, count(*) AS count_order FROM lineitem WHERE l_shipdate <= CAST('1998-09-02' AS date) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus
Run:  None SELECT l_returnflag, l_linestatus, sum(l_quantity) AS sum_qty, sum(l_extendedprice) AS sum_base_price, sum(l_extendedprice * (1 - l_discount)) AS sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) AS sum_charge, avg(l_quantity) AS avg_qty, avg(l_extendedprice) AS avg_price, avg(l_discount) AS avg_disc, count(*) AS count_order FROM lineitem WHERE l_shipdate <= CAST('1998-09-02' AS date) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus
Avg Time in sec:  0.6963695869781077  output size:  4
  l_returnflag l_linestatus     sum_qty  ...     avg_price  avg_disc  count_order
0            A            F  37734107.0  ...  38273.129735  0.049985      1478493
1            N            F    991417.0  ...  38284.467761  0.050093        38854
2            N            O  74476040.0  ...  38249.117989  0.049997      2920374
3            R            F  37719753.0  ...  38250.854626  0.050009      1478870

[4 rows x 10 columns]
{'name': 'Query', 'result': 0.690333, 'timing': 0.690333, 'cardinality': 0, 'extra-info': "SELECT l_returnflag, l_linestatus, sum(l_quantity) AS sum_qty, sum(l_extendedprice) AS sum_base_price, sum(l_extendedprice * (1 - l_discount)) AS sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) AS sum_charge, avg(l_quantity) AS avg_qty, avg(l_extendedprice) AS avg_price, avg(l_discount) AS avg_disc, count(*) AS count_order FROM lineitem WHERE l_shipdate <= CAST('1998-09-02' AS date) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 3.4e-05, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 2e-06, 'cardinality': 4, 'extra_info': '__internal_decompress_string(#0)\n__internal_decompress_string(#1)\n#2\n#3\n#4\n#5\n#6\n#7\n#8\n#9\n', 'children': [{'name': 'ORDER_BY', 'timing': 5.6e-05, 'cardinality': 4, 'extra_info': 'ORDERS:\nlineitem.l_returnflag ASC\nlineitem.l_linestatus ASC', 'children': [{'name': 'PROJECTION', 'timing': 1e-06, 'cardinality': 4, 'extra_info': '__internal_compress_string_utinyint(#0)\n__internal_compress_string_utinyint(#1)\n#2\n#3\n#4\n#5\n#6\n#7\n#8\n#9\n', 'children': [{'name': 'PROJECTION', 'timing': 4e-06, 'cardinality': 4, 'extra_info': '__internal_decompress_string(#0)\n__internal_decompress_string(#1)\n#2\n#3\n#4\n#5\n#6\n#7\n#8\n#9\n', 'children': [{'name': 'PERFECT_HASH_GROUP_BY', 'timing': 0.208084, 'cardinality': 4, 'extra_info': '#0\n#1\nsum_no_overflow(#2)\nsum_no_overflow(#3)\nsum_no_overflow(#4)\nsum_no_overflow(#5)\navg(#6)\navg(#7)\navg(#8)\ncount_star()', 'children': [{'name': 'PROJECTION', 'timing': 0.047662, 'cardinality': 5916591, 'extra_info': 'l_returnflag\nl_linestatus\nl_quantity\nl_extendedprice\n#4\n(#4 * (1.00 + l_tax))\nl_quantity\nl_extendedprice\nl_discount\n', 'children': [{'name': 'PROJECTION', 'timing': 0.028613, 'cardinality': 5916591, 'extra_info': '__internal_compress_string_utinyint(#0)\n__internal_compress_string_utinyint(#1)\n#2\n#3\n#4\n#5\n#6\n', 'children': [{'name': 'PROJECTION', 'timing': 0.068754, 'cardinality': 5916591, 'extra_info': 'l_returnflag\nl_linestatus\nl_quantity\nl_extendedprice\n(l_extendedprice * (1.00 - l_discount))\nl_tax\nl_discount\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.325409, 'cardinality': 5916591, 'extra_info': "lineitem\n[INFOSEPARATOR]\nl_returnflag\nl_linestatus\nl_quantity\nl_extendedprice\nl_discount\nl_tax\n[INFOSEPARATOR]\nFilters: l_shipdate<='1998-09-02'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243", 'children': []}]}]}]}]}]}]}]}]}]}]}
X {'RESULT_COLLECTOR0': 3.4e-05, 'PROJECTION1': 2e-06, 'ORDER_BY2': 5.6e-05, 'PROJECTION3': 1e-06, 'PROJECTION4': 4e-06, 'PERFECT_HASH_GROUP_BY5': 0.208084, 'PROJECTION6': 0.047662, 'PROJECTION7': 0.028613, 'PROJECTION8': 0.068754, 'SEQ_SCAN 9': 0.325409}
**** output size:  4
LINEAGE_5_ORDER_BY_7
LINEAGE_5_PERFECT_HASH_GROUP_BY_4
LINEAGE_5_SEQ_SCAN_0
SELECT l_returnflag, l_linestatus, sum(l_quantity) AS sum_qty, sum(l_extendedprice) AS sum_base_price, sum(l_extendedprice * (1 - l_discount)) AS sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) AS sum_charge, avg(l_quantity) AS avg_qty, avg(l_extendedprice) AS avg_price, avg(l_discount) AS avg_disc, count(*) AS count_order FROM lineitem WHERE l_shipdate <= CAST('1998-09-02' AS date) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus
   query_id  ...                                               plan
0         5  ...  {"name": "PROJECTION", "opid": "8", "children"...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               SELECT l_returnflag, l_linestatus, sum(l_quant...
size_bytes_max                                               13002833
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "PROJECTION", "opid": "8", "children"...
Name: 0, dtype: object
{"name": "PROJECTION", "opid": "8", "children": [{"name": "ORDER_BY", "opid": "7", "children": [{"name": "PROJECTION", "opid": "6", "children": [{"name": "PROJECTION", "opid": "5", "children": [{"name": "PERFECT_HASH_GROUP_BY", "opid": "4", "children": [{"name": "PROJECTION", "opid": "3", "children": [{"name": "PROJECTION", "opid": "2", "children": [{"name": "PROJECTION", "opid": "1", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_returnflag\nl_linestatus\nl_quantity\nl_extendedprice\nl_discount\nl_tax\n[INFOSEPARATOR]\nFilters: l_shipdate<='1998-09-02'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243"}],"table": "","extra": "l_returnflag\nl_linestatus\nl_quantity\nl_extendedprice\n(l_extendedprice * (1.00 - l_discount))\nl_tax\nl_discount\n"}],"table": "","extra": "__internal_compress_string_utinyint(#0)\n__internal_compress_string_utinyint(#1)\n#2\n#3\n#4\n#5\n#6\n"}],"table": "","extra": "l_returnflag\nl_linestatus\nl_quantity\nl_extendedprice\n#4\n(#4 * (1.00 + l_tax))\nl_quantity\nl_extendedprice\nl_discount\n"}],"table": "","extra": "#0\n#1\nsum_no_overflow(#2)\nsum_no_overflow(#3)\nsum_no_overflow(#4)\nsum_no_overflow(#5)\navg(#6)\navg(#7)\navg(#8)\ncount_star()"}],"table": "","extra": "__internal_decompress_string(#0)\n__internal_decompress_string(#1)\n#2\n#3\n#4\n#5\n#6\n#7\n#8\n#9\n"}],"table": "","extra": "__internal_compress_string_utinyint(#0)\n__internal_compress_string_utinyint(#1)\n#2\n#3\n#4\n#5\n#6\n#7\n#8\n#9\n"}],"table": "","extra": "ORDERS:\nlineitem.l_returnflag ASC\nlineitem.l_linestatus ASC"}],"table": "","extra": "__internal_decompress_string(#0)\n__internal_decompress_string(#1)\n#2\n#3\n#4\n#5\n#6\n#7\n#8\n#9\n"}
%%%%%%%%%%%%%%%% Running Query #  2  threads:  1
SELECT s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment FROM part, supplier, partsupp, nation, region WHERE p_partkey = ps_partkey AND s_suppkey = ps_suppkey AND p_size = 15 AND p_type LIKE '%BRASS' AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'EUROPE' AND ps_supplycost = ( SELECT min(ps_supplycost) FROM partsupp, supplier, nation, region WHERE p_partkey = ps_partkey AND s_suppkey = ps_suppkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'EUROPE' ) ORDER BY s_acctbal DESC, n_name, s_name, p_partkey LIMIT 100;
Run:  None SELECT s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment FROM part, supplier, partsupp, nation, region WHERE p_partkey = ps_partkey AND s_suppkey = ps_suppkey AND p_size = 15 AND p_type LIKE '%BRASS' AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'EUROPE' AND ps_supplycost = ( SELECT min(ps_supplycost) FROM partsupp, supplier, nation, region WHERE p_partkey = ps_partkey AND s_suppkey = ps_suppkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'EUROPE' ) ORDER BY s_acctbal DESC, n_name, s_name, p_partkey LIMIT 100;
Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────┐                                                                                                                                                                                                                  
│  STREAMING_LIMIT  │                                                                                                                                                                                                                  
└─────────┬─────────┘                                                                                                                                                                                                                                       
┌─────────┴─────────┐                                                                                                                                                                                                                  
│     PROJECTION    │                                                                                                                                                                                                                  
│   ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                                  
│         #0        │                                                                                                                                                                                                                  
│         #1        │                                                                                                                                                                                                                  
│__internal_decompre│                                                                                                                                                                                                                  
│   ss_string(#2)   │                                                                                                                                                                                                                  
│__internal_decompre│                                                                                                                                                                                                                  
│ss_integral_bigint(│                                                                                                                                                                                                                  
│       #3, 1)      │                                                                                                                                                                                                                  
│__internal_decompre│                                                                                                                                                                                                                  
│   ss_string(#4)   │                                                                                                                                                                                                                  
│         #5        │                                                                                                                                                                                                                  
│__internal_decompre│                                                                                                                                                                                                                  
│   ss_string(#6)   │                                                                                                                                                                                                                  
│         #7        │                                                                                                                                                                                                                  
└─────────┬─────────┘                                                                                                                                                                                                                                       
┌─────────┴─────────┐                                                                                                                                                                                                                  
│      ORDER_BY     │                                                                                                                                                                                                                  
│   ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                                  
│      ORDERS:      │                                                                                                                                                                                                                  
│ supplier.s_acctbal│                                                                                                                                                                                                                  
│        DESC       │                                                                                                                                                                                                                  
│ nation.n_name ASC │                                                                                                                                                                                                                  
│supplier.s_name ASC│                                                                                                                                                                                                                  
│ part.p_partkey ASC│                                                                                                                                                                                                                  
└─────────┬─────────┘                                                                                                                                                                                                                                       
┌─────────┴─────────┐                                                                                                                                                                                                                  
│     PROJECTION    │                                                                                                                                                                                                                  
│   ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                                  
│         #0        │                                                                                                                                                                                                                  
│         #1        │                                                                                                                                                                                                                  
│__internal_compress│                                                                                                                                                                                                                  
│_string_hugeint(#2)│                                                                                                                                                                                                                  
│__internal_compress│                                                                                                                                                                                                                  
│_integral_uinteger(│                                                                                                                                                                                                                  
│       #3, 1)      │                                                                                                                                                                                                                  
│__internal_compress│                                                                                                                                                                                                                  
│_string_hugeint(#4)│                                                                                                                                                                                                                  
│         #5        │                                                                                                                                                                                                                  
│__internal_compress│                                                                                                                                                                                                                  
│_string_hugeint(#6)│                                                                                                                                                                                                                  
│         #7        │                                                                                                                                                                                                                  
└─────────┬─────────┘                                                                                                                                                                                                                                       
┌─────────┴─────────┐                                                                                                                                                                                                                  
│     PROJECTION    │                                                                                                                                                                                                                  
│   ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                                  
│     s_acctbal     │                                                                                                                                                                                                                  
│       s_name      │                                                                                                                                                                                                                  
│       n_name      │                                                                                                                                                                                                                  
│     p_partkey     │                                                                                                                                                                                                                  
│       p_mfgr      │                                                                                                                                                                                                                  
│     s_address     │                                                                                                                                                                                                                  
│      s_phone      │                                                                                                                                                                                                                  
│     s_comment     │                                                                                                                                                                                                                  
└─────────┬─────────┘                                                                                                                                                                                                                                       
┌─────────┴─────────┐                                                                                                                                                                                                                  
│     PROJECTION    │                                                                                                                                                                                                                  
│   ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                                  
│         #0        │                                                                                                                                                                                                                  
│         #2        │                                                                                                                                                                                                                  
│         #4        │                                                                                                                                                                                                                  
│         #6        │                                                                                                                                                                                                                  
│         #8        │                                                                                                                                                                                                                  
│         #9        │                                                                                                                                                                                                                  
│        #10        │                                                                                                                                                                                                                  
│        #11        │                                                                                                                                                                                                                  
│        #12        │                                                                                                                                                                                                                  
│        #13        │                                                                                                                                                                                                                  
└─────────┬─────────┘                                                                                                                                                                                                                                       
┌─────────┴─────────┐                                                                                                                                                                                                                  
│       FILTER      │                                                                                                                                                                                                                  
│   ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                                  
│  (ps_supplycost = │                                                                                                                                                                                                                  
│      SUBQUERY)    │                                                                                                                                                                                                                  
│   ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                                  
│     EC: 400000    │                                                                                                                                                                                                                  
└─────────┬─────────┘                                                                                                                                                                                                                                       
┌─────────┴─────────┐                                                                                                                                                                                                                  
│  RIGHT_DELIM_JOIN │                                                                                                                                                                                                                  
│   ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                                  
│       RIGHT       │                                                                                                                                                                                                                  
│  p_partkey IS NOT │                                                                                                                                                                                                                  
│    DISTINCT FROM  ├──────────────────────────────────────────────────────────────────────────────────────────────┐                                                                                                                   
│      p_partkey    │                                                                                              │                                                                                                                   
│   ─ ─ ─ ─ ─ ─ ─   │                                                                                              │                                                                                                                   
│     EC: 400000    │                                                                                              │                                                                                                                   
└─────────┬─────────┘                                                                                              │                                                                                                                                        
┌─────────┴─────────┐                                                                                    ┌─────────┴─────────┐                                                                                                         
│     HASH_JOIN     │                                                                                    │     HASH_JOIN     │                                                                                                         
│   ─ ─ ─ ─ ─ ─ ─   │                                                                                    │   ─ ─ ─ ─ ─ ─ ─   │                                                                                                         
│       INNER       │                                                                                    │       RIGHT       │                                                                                                         
│    ps_suppkey =   │                                                                                    │  p_partkey IS NOT │                                                                                                         
│      s_suppkey    │                                                                                    │    DISTINCT FROM  │                                                                                                         
│   ─ ─ ─ ─ ─ ─ ─   ├───────────────────────────────┐                                                    │      p_partkey    ├──────────────────────────────────────────────────────────────────────────────────────────────┐          
│    Build Min: 1   │                               │                                                    │   ─ ─ ─ ─ ─ ─ ─   │                                                                                              │          
│  Build Max: 10000 │                               │                                                    │     EC: 400000    │                                                                                              │          
│   ─ ─ ─ ─ ─ ─ ─   │                               │                                                    │                   │                                                                                              │          
│      EC: 587      │                               │                                                    │                   │                                                                                              │          
└─────────┬─────────┘                               │                                                    └─────────┬─────────┘                                                                                              │                               
┌─────────┴─────────┐                     ┌─────────┴─────────┐                                          ┌─────────┴─────────┐                                                                                    ┌─────────┴─────────┐
│     HASH_JOIN     │                     │     HASH_JOIN     │                                          │     PROJECTION    │                                                                                    │     DUMMY_SCAN    │
│   ─ ─ ─ ─ ─ ─ ─   │                     │   ─ ─ ─ ─ ─ ─ ─   │                                          │   ─ ─ ─ ─ ─ ─ ─   │                                                                                    │                   │
│       INNER       │                     │       INNER       │                                          │ min(ps_supplycost)│                                                                                    │                   │
│    ps_partkey =   │                     │   s_nationkey =   │                                          │     p_partkey     │                                                                                    │                   │
│      p_partkey    │                     │     n_nationkey   │                                          │                   │                                                                                    │                   │
│   ─ ─ ─ ─ ─ ─ ─   ├──────────┐          │   ─ ─ ─ ─ ─ ─ ─   ├──────────┐                               │                   │                                                                                    │                   │
│    Build Min: 1   │          │          │    Build Min: 0   │          │                               │                   │                                                                                    │                   │
│ Build Max: 200000 │          │          │   Build Max: 24   │          │                               │                   │                                                                                    │                   │
│   ─ ─ ─ ─ ─ ─ ─   │          │          │   ─ ─ ─ ─ ─ ─ ─   │          │                               │                   │                                                                                    │                   │
│      EC: 3377     │          │          │      EC: 2000     │          │                               │                   │                                                                                    │                   │
└─────────┬─────────┘          │          └─────────┬─────────┘          │                               └─────────┬─────────┘                                                                                    └───────────────────┘                     
┌─────────┴─────────┐┌─────────┴─────────┐┌─────────┴─────────┐┌─────────┴─────────┐                     ┌─────────┴─────────┐                                                                                                         
│     SEQ_SCAN      ││       FILTER      ││     SEQ_SCAN      ││     HASH_JOIN     │                     │     PROJECTION    │                                                                                                         
│   ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─   │                     │   ─ ─ ─ ─ ─ ─ ─   │                                                                                                         
│      partsupp     ││  suffix(p_type,   ││      supplier     ││       INNER       │                     │__internal_decompre│                                                                                                         
│   ─ ─ ─ ─ ─ ─ ─   ││      'BRASS')     ││   ─ ─ ─ ─ ─ ─ ─   ││   n_regionkey =   │                     │ss_integral_bigint(│                                                                                                         
│     ps_partkey    ││   ─ ─ ─ ─ ─ ─ ─   ││     s_suppkey     ││     r_regionkey   │                     │       #0, 1)      │                                                                                                         
│     ps_suppkey    ││      EC: 800      ││    s_nationkey    ││   ─ ─ ─ ─ ─ ─ ─   │                     │         #1        │                                                                                                         
│   ps_supplycost   ││                   ││     s_acctbal     ││    Build Min: 0   ├──────────┐          │                   │                                                                                                         
│   ─ ─ ─ ─ ─ ─ ─   ││                   ││       s_name      ││    Build Max: 4   │          │          │                   │                                                                                                         
│     EC: 800000    ││                   ││     s_address     ││   ─ ─ ─ ─ ─ ─ ─   │          │          │                   │                                                                                                         
│                   ││                   ││      s_phone      ││       EC: 5       │          │          │                   │                                                                                                         
│                   ││                   ││     s_comment     ││                   │          │          │                   │                                                                                                         
│                   ││                   ││   ─ ─ ─ ─ ─ ─ ─   ││                   │          │          │                   │                                                                                                         
│                   ││                   ││     EC: 10000     ││                   │          │          │                   │                                                                                                         
└───────────────────┘└─────────┬─────────┘└───────────────────┘└─────────┬─────────┘          │          └─────────┬─────────┘                                                                                                                              
                     ┌─────────┴─────────┐                     ┌─────────┴─────────┐┌─────────┴─────────┐┌─────────┴─────────┐                                                                                                         
                     │     SEQ_SCAN      │                     │     SEQ_SCAN      ││     SEQ_SCAN      ││   HASH_GROUP_BY   │                                                                                                         
                     │   ─ ─ ─ ─ ─ ─ ─   │                     │   ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─   │                                                                                                         
                     │        part       │                     │       nation      ││       region      ││         #0        │                                                                                                         
                     │   ─ ─ ─ ─ ─ ─ ─   │                     │   ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─   ││      min(#1)      │                                                                                                         
                     │     p_partkey     │                     │    n_nationkey    ││    r_regionkey    ││                   │                                                                                                         
                     │       p_type      │                     │    n_regionkey    ││   ─ ─ ─ ─ ─ ─ ─   ││                   │                                                                                                         
                     │       p_mfgr      │                     │       n_name      ││  Filters: r_name= ││                   │                                                                                                         
                     │   ─ ─ ─ ─ ─ ─ ─   │                     │   ─ ─ ─ ─ ─ ─ ─   ││'EUROPE' AND r...  ││                   │                                                                                                         
                     │ Filters: p_size=15│                     │       EC: 25      ││      NOT NULL     ││                   │                                                                                                         
                     │  AND p_size IS NOT│                     │                   ││   ─ ─ ─ ─ ─ ─ ─   ││                   │                                                                                                         
                     │        NULL       │                     │                   ││       EC: 1       ││                   │                                                                                                         
                     │   ─ ─ ─ ─ ─ ─ ─   │                     │                   ││                   ││                   │                                                                                                         
                     │      EC: 800      │                     │                   ││                   ││                   │                                                                                                         
                     └───────────────────┘                     └───────────────────┘└───────────────────┘└─────────┬─────────┘                                                                                                                              
                                                                                                         ┌─────────┴─────────┐                                                                                                         
                                                                                                         │     PROJECTION    │                                                                                                         
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   │                                                                                                         
                                                                                                         │     p_partkey     │                                                                                                         
                                                                                                         │   ps_supplycost   │                                                                                                         
                                                                                                         └─────────┬─────────┘                                                                                                                              
                                                                                                         ┌─────────┴─────────┐                                                                                                         
                                                                                                         │     PROJECTION    │                                                                                                         
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   │                                                                                                         
                                                                                                         │__internal_compress│                                                                                                         
                                                                                                         │_integral_uinteger(│                                                                                                         
                                                                                                         │       #0, 1)      │                                                                                                         
                                                                                                         │__internal_compress│                                                                                                         
                                                                                                         │_integral_usmallint│                                                                                                         
                                                                                                         │      (#1, 1)      │                                                                                                         
                                                                                                         │         #2        │                                                                                                         
                                                                                                         │__internal_compress│                                                                                                         
                                                                                                         │_integral_usmallint│                                                                                                         
                                                                                                         │      (#3, 1)      │                                                                                                         
                                                                                                         │__internal_compress│                                                                                                         
                                                                                                         │_integral_utinyint(│                                                                                                         
                                                                                                         │       #4, 0)      │                                                                                                         
                                                                                                         │__internal_compress│                                                                                                         
                                                                                                         │_integral_utinyint(│                                                                                                         
                                                                                                         │       #5, 0)      │                                                                                                         
                                                                                                         │__internal_compress│                                                                                                         
                                                                                                         │_integral_utinyint(│                                                                                                         
                                                                                                         │       #6, 0)      │                                                                                                         
                                                                                                         │__internal_compress│                                                                                                         
                                                                                                         │_integral_utinyint(│                                                                                                         
                                                                                                         │       #7, 0)      │                                                                                                         
                                                                                                         │         #8        │                                                                                                         
                                                                                                         └─────────┬─────────┘                                                                                                                              
                                                                                                         ┌─────────┴─────────┐                                                                                                         
                                                                                                         │     HASH_JOIN     │                                                                                                         
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   │                                                                                                         
                                                                                                         │       INNER       │                                                                                                         
                                                                                                         │    ps_partkey =   ├─────────────────────────────────────────────────────────────────────────┐                               
                                                                                                         │      p_partkey    │                                                                         │                               
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   │                                                                         │                               
                                                                                                         │     EC: 800000    │                                                                         │                               
                                                                                                         └─────────┬─────────┘                                                                         │                                                    
                                                                                                         ┌─────────┴─────────┐                                                               ┌─────────┴─────────┐                     
                                                                                                         │     HASH_JOIN     │                                                               │     DELIM_SCAN    │                     
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   │                                                               │                   │                     
                                                                                                         │       INNER       │                                                               │                   │                     
                                                                                                         │   n_regionkey =   │                                                               │                   │                     
                                                                                                         │     r_regionkey   │                                                               │                   │                     
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   ├────────────────────────────────────────────────────┐          │                   │                     
                                                                                                         │    Build Min: 0   │                                                    │          │                   │                     
                                                                                                         │    Build Max: 4   │                                                    │          │                   │                     
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   │                                                    │          │                   │                     
                                                                                                         │     EC: 800000    │                                                    │          │                   │                     
                                                                                                         └─────────┬─────────┘                                                    │          └───────────────────┘                                          
                                                                                                         ┌─────────┴─────────┐                                          ┌─────────┴─────────┐                                          
                                                                                                         │     HASH_JOIN     │                                          │     SEQ_SCAN      │                                          
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   │                                          │   ─ ─ ─ ─ ─ ─ ─   │                                          
                                                                                                         │       INNER       │                                          │       region      │                                          
                                                                                                         │   s_nationkey =   │                                          │   ─ ─ ─ ─ ─ ─ ─   │                                          
                                                                                                         │     n_nationkey   │                                          │    r_regionkey    │                                          
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   ├───────────────────────────────┐          │   ─ ─ ─ ─ ─ ─ ─   │                                          
                                                                                                         │    Build Min: 0   │                               │          │  Filters: r_name= │                                          
                                                                                                         │   Build Max: 24   │                               │          │'EUROPE' AND r...  │                                          
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   │                               │          │      NOT NULL     │                                          
                                                                                                         │     EC: 800000    │                               │          │   ─ ─ ─ ─ ─ ─ ─   │                                          
                                                                                                         │                   │                               │          │       EC: 1       │                                          
                                                                                                         └─────────┬─────────┘                               │          └───────────────────┘                                                               
                                                                                                         ┌─────────┴─────────┐                     ┌─────────┴─────────┐                                                               
                                                                                                         │     HASH_JOIN     │                     │     SEQ_SCAN      │                                                               
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   │                     │   ─ ─ ─ ─ ─ ─ ─   │                                                               
                                                                                                         │       INNER       │                     │       nation      │                                                               
                                                                                                         │    ps_suppkey =   │                     │   ─ ─ ─ ─ ─ ─ ─   │                                                               
                                                                                                         │      s_suppkey    │                     │    n_nationkey    │                                                               
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   ├──────────┐          │    n_regionkey    │                                                               
                                                                                                         │    Build Min: 1   │          │          │   ─ ─ ─ ─ ─ ─ ─   │                                                               
                                                                                                         │  Build Max: 10000 │          │          │       EC: 25      │                                                               
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   │          │          │                   │                                                               
                                                                                                         │     EC: 800000    │          │          │                   │                                                               
                                                                                                         └─────────┬─────────┘          │          └───────────────────┘                                                                                    
                                                                                                         ┌─────────┴─────────┐┌─────────┴─────────┐                                                                                    
                                                                                                         │     SEQ_SCAN      ││     SEQ_SCAN      │                                                                                    
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─   │                                                                                    
                                                                                                         │      partsupp     ││      supplier     │                                                                                    
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─   │                                                                                    
                                                                                                         │     ps_partkey    ││     s_suppkey     │                                                                                    
                                                                                                         │     ps_suppkey    ││    s_nationkey    │                                                                                    
                                                                                                         │   ps_supplycost   ││   ─ ─ ─ ─ ─ ─ ─   │                                                                                    
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   ││     EC: 10000     │                                                                                    
                                                                                                         │     EC: 800000    ││                   │                                                                                    
                                                                                                         └───────────────────┘└───────────────────┘                                                                                                         

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

Avg Time in sec:  0.08765834663063288  output size:  100
    s_acctbal  ...                                          s_comment
0     9938.53  ...                      l, ironic instructions cajole
1     9937.84  ...  es. furiously silent deposits among the deposi...
2     9936.22  ...  ar, regular requests nag blithely special acco...
3     9923.77  ...  s sleep according to the quick requests. caref...
4     9871.22  ...  against the slyly daring requests. unusual acc...
..        ...  ...                                                ...
95    7887.08  ...   the regular ideas. furiously bold deposits bo...
96    7871.50  ...  ording to the furious theodolites cajole caref...
97    7852.45  ...  egular, regular ideas. requests are carefully....
98    7850.66  ...                   ccounts. special, final deposits
99    7843.52  ...  sits. blithely regular requests above the pend...

[100 rows x 8 columns]
{'name': 'Query', 'result': 0.081686, 'timing': 0.081686, 'cardinality': 0, 'extra-info': "SELECT s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment FROM part, supplier, partsupp, nation, region WHERE p_partkey = ps_partkey AND s_suppkey = ps_suppkey AND p_size = 15 AND p_type LIKE '%BRASS' AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'EUROPE' AND ps_supplycost = ( SELECT min(ps_supplycost) FROM partsupp, supplier, nation, region WHERE p_partkey = ps_partkey AND s_suppkey = ps_suppkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'EUROPE' ) ORDER BY s_acctbal DESC, n_name, s_name, p_partkey LIMIT 100;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 6.2e-05, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'STREAMING_LIMIT', 'timing': 2e-06, 'cardinality': 100, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 3.7e-05, 'cardinality': 460, 'extra_info': '#0\n#1\n__internal_decompress_string(#2)\n__internal_decompress_integral_bigint(#3, 1)\n__internal_decompress_string(#4)\n#5\n__internal_decompress_string(#6)\n#7\n', 'children': [{'name': 'ORDER_BY', 'timing': 0.000333, 'cardinality': 460, 'extra_info': 'ORDERS:\nsupplier.s_acctbal DESC\nnation.n_name ASC\nsupplier.s_name ASC\npart.p_partkey ASC', 'children': [{'name': 'PROJECTION', 'timing': 7.8e-05, 'cardinality': 460, 'extra_info': '#0\n#1\n__internal_compress_string_hugeint(#2)\n__internal_compress_integral_uinteger(#3, 1)\n__internal_compress_string_hugeint(#4)\n#5\n__internal_compress_string_hugeint(#6)\n#7\n', 'children': [{'name': 'PROJECTION', 'timing': 3e-06, 'cardinality': 460, 'extra_info': 's_acctbal\ns_name\nn_name\np_partkey\np_mfgr\ns_address\ns_phone\ns_comment\n', 'children': [{'name': 'PROJECTION', 'timing': 5e-06, 'cardinality': 460, 'extra_info': '#0\n#2\n#4\n#6\n#8\n#9\n#10\n#11\n#12\n#13\n', 'children': [{'name': 'FILTER', 'timing': 0.000139, 'cardinality': 460, 'extra_info': '(ps_supplycost = SUBQUERY)\n[INFOSEPARATOR]\nEC: 400000', 'children': [{'name': 'RIGHT_DELIM_JOIN', 'timing': 0.001337, 'cardinality': 0, 'extra_info': 'RIGHT\np_partkey IS NOT DISTINCT FROM p_partkey\n\n[INFOSEPARATOR]\nEC: 400000\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.000975, 'cardinality': 642, 'extra_info': 'INNER\nps_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 587\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.006011, 'cardinality': 2988, 'extra_info': 'INNER\nps_partkey = p_partkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 3377\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.001755, 'cardinality': 800000, 'extra_info': 'partsupp\n[INFOSEPARATOR]\nps_partkey\nps_suppkey\nps_supplycost\n[INFOSEPARATOR]\nEC: 800000', 'children': []}, {'name': 'FILTER', 'timing': 0.00055, 'cardinality': 747, 'extra_info': "suffix(p_type, 'BRASS')\n[INFOSEPARATOR]\nEC: 800", 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.007929, 'cardinality': 3907, 'extra_info': 'part\n[INFOSEPARATOR]\np_partkey\np_type\np_mfgr\n[INFOSEPARATOR]\nFilters: p_size=15 AND p_size IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 800', 'children': []}]}]}, {'name': 'HASH_JOIN', 'timing': 0.000181, 'cardinality': 1987, 'extra_info': 'INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 2000\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.001143, 'cardinality': 10000, 'extra_info': 'supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\ns_acctbal\ns_name\ns_address\ns_phone\ns_comment\n[INFOSEPARATOR]\nEC: 10000', 'children': []}, {'name': 'HASH_JOIN', 'timing': 8.9e-05, 'cardinality': 5, 'extra_info': 'INNER\nn_regionkey = r_regionkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 4\n\n[INFOSEPARATOR]\nEC: 5\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 1.5e-05, 'cardinality': 25, 'extra_info': 'nation\n[INFOSEPARATOR]\nn_nationkey\nn_regionkey\nn_name\n[INFOSEPARATOR]\nEC: 25', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 3e-05, 'cardinality': 1, 'extra_info': "region\n[INFOSEPARATOR]\nr_regionkey\n[INFOSEPARATOR]\nFilters: r_name='EUROPE' AND r_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1", 'children': []}]}]}]}, {'name': 'HASH_JOIN', 'timing': 0.000351, 'cardinality': 642, 'extra_info': 'RIGHT\np_partkey IS NOT DISTINCT FROM p_partkey\n\n[INFOSEPARATOR]\nEC: 400000\n', 'children': [{'name': 'PROJECTION', 'timing': 0.0, 'cardinality': 460, 'extra_info': 'min(ps_supplycost)\np_partkey\n', 'children': [{'name': 'PROJECTION', 'timing': 5e-06, 'cardinality': 460, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n#1\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.000973, 'cardinality': 460, 'extra_info': '#0\nmin(#1)', 'children': [{'name': 'PROJECTION', 'timing': 1e-06, 'cardinality': 642, 'extra_info': 'p_partkey\nps_supplycost\n', 'children': [{'name': 'PROJECTION', 'timing': 4e-05, 'cardinality': 642, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n__internal_compress_integral_usmallint(#1, 1)\n#2\n__internal_compress_integral_usmallint(#3, 1)\n__internal_compress_integral_utinyint(#4, 0)\n__internal_compress_integral_utinyint(#5, 0)\n__internal_compress_integral_utinyint(#6, 0)\n__internal_compress_integral_utinyint(#7, 0)\n#8\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.008378, 'cardinality': 642, 'extra_info': 'INNER\nps_partkey = p_partkey\n\n[INFOSEPARATOR]\nEC: 800000\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.008004, 'cardinality': 158960, 'extra_info': 'INNER\nn_regionkey = r_regionkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 4\n\n[INFOSEPARATOR]\nEC: 800000\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.011335, 'cardinality': 800000, 'extra_info': 'INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 800000\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.016421, 'cardinality': 800000, 'extra_info': 'INNER\nps_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 800000\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.001395, 'cardinality': 800000, 'extra_info': 'partsupp\n[INFOSEPARATOR]\nps_partkey\nps_suppkey\nps_supplycost\n[INFOSEPARATOR]\nEC: 800000', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 4.1e-05, 'cardinality': 10000, 'extra_info': 'supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\n[INFOSEPARATOR]\nEC: 10000', 'children': []}]}, {'name': 'SEQ_SCAN ', 'timing': 7e-06, 'cardinality': 25, 'extra_info': 'nation\n[INFOSEPARATOR]\nn_nationkey\nn_regionkey\n[INFOSEPARATOR]\nEC: 25', 'children': []}]}, {'name': 'SEQ_SCAN ', 'timing': 1.5e-05, 'cardinality': 1, 'extra_info': "region\n[INFOSEPARATOR]\nr_regionkey\n[INFOSEPARATOR]\nFilters: r_name='EUROPE' AND r_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1", 'children': []}]}, {'name': 'DELIM_SCAN', 'timing': 0.0, 'cardinality': 0, 'extra_info': '', 'children': []}]}]}]}]}]}]}, {'name': 'DUMMY_SCAN', 'timing': 0.0, 'cardinality': 0, 'extra_info': '', 'children': []}]}, {'name': 'HASH_GROUP_BY', 'timing': 2.1e-05, 'cardinality': 460, 'extra_info': '#0', 'children': []}]}]}]}]}]}]}]}]}]}]}
X {'RESULT_COLLECTOR0': 6.2e-05, 'STREAMING_LIMIT1': 2e-06, 'PROJECTION2': 3.7e-05, 'ORDER_BY3': 0.000333, 'PROJECTION4': 7.8e-05, 'PROJECTION5': 3e-06, 'PROJECTION6': 5e-06, 'FILTER7': 0.000139, 'RIGHT_DELIM_JOIN8': 0.001337, 'HASH_JOIN9': 0.000975, 'HASH_JOIN10': 0.006011, 'SEQ_SCAN 11': 0.001755, 'FILTER12': 0.00055, 'SEQ_SCAN 13': 0.007929, 'HASH_JOIN14': 0.000181, 'SEQ_SCAN 15': 0.001143, 'HASH_JOIN16': 8.9e-05, 'SEQ_SCAN 17': 1.5e-05, 'SEQ_SCAN 18': 3e-05, 'HASH_JOIN19': 0.000351, 'PROJECTION20': 0.0, 'PROJECTION21': 5e-06, 'HASH_GROUP_BY22': 0.000973, 'PROJECTION23': 1e-06, 'PROJECTION24': 4e-05, 'HASH_JOIN25': 0.008378, 'HASH_JOIN26': 0.008004, 'HASH_JOIN27': 0.011335, 'HASH_JOIN28': 0.016421, 'SEQ_SCAN 29': 0.001395, 'SEQ_SCAN 30': 4.1e-05, 'SEQ_SCAN 31': 7e-06, 'SEQ_SCAN 32': 1.5e-05, 'DELIM_SCAN33': 0.0, 'DUMMY_SCAN34': 0.0, 'HASH_GROUP_BY35': 2.1e-05}
compressed filter_log_size: 5828
compressed filter_log_buffer_size: 3103
compressed limit_offset_size: 1504
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 35016
compressed perfect_full_scan_ht_log_buffer_size: 30968
compressed perfect_probe_ht_log_size: 2116015
compressed perfect_probe_ht_log_buffer_size: 2096278
compressed row_group_log_size: 23800
compressed row_group_log_buffer_size: 12964
compressed scatter_log_size: 2722
compressed scatter_log_buffer_size: 1074
compressed scatter_sel_log_size: 60372
compressed scatter_sel_log_buffer_size: 56835
compressed gather_log_size: 1360
compressed gather_log_buffer_size: 0
compressed combine_log_size: 1360
compressed combine_log_buffer_size: 0
compressed finalize_states_log_size: 1892
compressed finalize_states_log_buffer_size: 244
compressed join_gather_log_size: 16107
compressed join_gather_log_buffer_size: 10308
compressed reorder_log_size: 2640
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 1360
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 1360
compressed nlj_log_buffer_size: 0
compressed total_size: 2271336
compressed total_buffer_size: 2211774
compressed total_element_size: 59562

Clear Lineage

**** output size:  100
LINEAGE_5_FILTER_19
LINEAGE_5_FILTER_28
LINEAGE_5_HASH_GROUP_BY_11
LINEAGE_5_HASH_GROUP_BY_16
LINEAGE_5_HASH_JOIN_15
LINEAGE_5_HASH_JOIN_2
LINEAGE_5_HASH_JOIN_20
LINEAGE_5_HASH_JOIN_24
LINEAGE_5_HASH_JOIN_25
LINEAGE_5_HASH_JOIN_26
LINEAGE_5_HASH_JOIN_4
LINEAGE_5_HASH_JOIN_6
LINEAGE_5_HASH_JOIN_8
LINEAGE_5_ORDER_BY_32
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_1
LINEAGE_5_SEQ_SCAN_17
LINEAGE_5_SEQ_SCAN_18
LINEAGE_5_SEQ_SCAN_21
LINEAGE_5_SEQ_SCAN_22
LINEAGE_5_SEQ_SCAN_23
LINEAGE_5_SEQ_SCAN_3
LINEAGE_5_SEQ_SCAN_5
LINEAGE_5_STREAMING_LIMIT_34
SELECT s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment FROM part, supplier, partsupp, nation, region WHERE p_partkey = ps_partkey AND s_suppkey = ps_suppkey AND p_size = 15 AND p_type LIKE '%BRASS' AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'EUROPE' AND ps_supplycost = ( SELECT min(ps_supplycost) FROM partsupp, supplier, nation, region WHERE p_partkey = ps_partkey AND s_suppkey = ps_suppkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'EUROPE' ) ORDER BY s_acctbal DESC, n_name, s_name, p_partkey LIMIT 100;
   query_id  ...                                               plan
0         5  ...  {"name": "STREAMING_LIMIT", "opid": "34", "chi...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               SELECT s_acctbal, s_name, n_name, p_partkey, p...
size_bytes_max                                                2271336
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "STREAMING_LIMIT", "opid": "34", "chi...
Name: 0, dtype: object
{"name": "STREAMING_LIMIT", "opid": "34", "children": [{"name": "PROJECTION", "opid": "33", "children": [{"name": "ORDER_BY", "opid": "32", "children": [{"name": "PROJECTION", "opid": "31", "children": [{"name": "PROJECTION", "opid": "30", "children": [{"name": "PROJECTION", "opid": "29", "children": [{"name": "FILTER", "opid": "28", "children": [{"name": "RIGHT_DELIM_JOIN", "opid": "27", "children": [{"name": "HASH_GROUP_BY", "opid": "16", "children": [],"table": "","extra": "#0"},{"name": "HASH_JOIN", "opid": "15", "children": [{"name": "PROJECTION", "opid": "13", "children": [{"name": "PROJECTION", "opid": "12", "children": [{"name": "HASH_GROUP_BY", "opid": "11", "children": [{"name": "PROJECTION", "opid": "10", "children": [{"name": "PROJECTION", "opid": "9", "children": [{"name": "HASH_JOIN", "opid": "8", "children": [{"name": "HASH_JOIN", "opid": "6", "children": [{"name": "HASH_JOIN", "opid": "4", "children": [{"name": "HASH_JOIN", "opid": "2", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "partsupp","extra": "partsupp\n[INFOSEPARATOR]\nps_partkey\nps_suppkey\nps_supplycost\n[INFOSEPARATOR]\nEC: 800000"},{"name": "SEQ_SCAN ", "opid": "1", "children": [],"table": "supplier","extra": "supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\n[INFOSEPARATOR]\nEC: 10000"}],"table": "","extra": "INNER\nps_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 800000\n"},{"name": "SEQ_SCAN ", "opid": "3", "children": [],"table": "nation","extra": "nation\n[INFOSEPARATOR]\nn_nationkey\nn_regionkey\n[INFOSEPARATOR]\nEC: 25"}],"table": "","extra": "INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 800000\n"},{"name": "SEQ_SCAN ", "opid": "5", "children": [],"table": "region","extra": "region\n[INFOSEPARATOR]\nr_regionkey\n[INFOSEPARATOR]\nFilters: r_name='EUROPE' AND r_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1"}],"table": "","extra": "INNER\nn_regionkey = r_regionkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 4\n\n[INFOSEPARATOR]\nEC: 800000\n"},{"name": "DELIM_SCAN", "opid": "7", "children": [],"table": "","extra": ""}],"table": "","extra": "INNER\nps_partkey = p_partkey\n\n[INFOSEPARATOR]\nEC: 800000\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n__internal_compress_integral_usmallint(#1, 1)\n#2\n__internal_compress_integral_usmallint(#3, 1)\n__internal_compress_integral_utinyint(#4, 0)\n__internal_compress_integral_utinyint(#5, 0)\n__internal_compress_integral_utinyint(#6, 0)\n__internal_compress_integral_utinyint(#7, 0)\n#8\n"}],"table": "","extra": "p_partkey\nps_supplycost\n"}],"table": "","extra": "#0\nmin(#1)"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n#1\n"}],"table": "","extra": "min(ps_supplycost)\np_partkey\n"},{"name": "DUMMY_SCAN", "opid": "14", "children": [],"table": "","extra": ""}],"table": "","extra": "RIGHT\np_partkey IS NOT DISTINCT FROM p_partkey\n\n[INFOSEPARATOR]\nEC: 400000\n"},{"name": "HASH_JOIN", "opid": "26", "children": [{"name": "HASH_JOIN", "opid": "20", "children": [{"name": "SEQ_SCAN ", "opid": "17", "children": [],"table": "partsupp","extra": "partsupp\n[INFOSEPARATOR]\nps_partkey\nps_suppkey\nps_supplycost\n[INFOSEPARATOR]\nEC: 800000"},{"name": "FILTER", "opid": "19", "children": [{"name": "SEQ_SCAN ", "opid": "18", "children": [],"table": "part","extra": "part\n[INFOSEPARATOR]\np_partkey\np_type\np_mfgr\n[INFOSEPARATOR]\nFilters: p_size=15 AND p_size IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 800"}],"table": "","extra": "suffix(p_type, 'BRASS')\n[INFOSEPARATOR]\nEC: 800"}],"table": "","extra": "INNER\nps_partkey = p_partkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 3377\n"},{"name": "HASH_JOIN", "opid": "25", "children": [{"name": "SEQ_SCAN ", "opid": "21", "children": [],"table": "supplier","extra": "supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\ns_acctbal\ns_name\ns_address\ns_phone\ns_comment\n[INFOSEPARATOR]\nEC: 10000"},{"name": "HASH_JOIN", "opid": "24", "children": [{"name": "SEQ_SCAN ", "opid": "22", "children": [],"table": "nation","extra": "nation\n[INFOSEPARATOR]\nn_nationkey\nn_regionkey\nn_name\n[INFOSEPARATOR]\nEC: 25"},{"name": "SEQ_SCAN ", "opid": "23", "children": [],"table": "region","extra": "region\n[INFOSEPARATOR]\nr_regionkey\n[INFOSEPARATOR]\nFilters: r_name='EUROPE' AND r_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1"}],"table": "","extra": "INNER\nn_regionkey = r_regionkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 4\n\n[INFOSEPARATOR]\nEC: 5\n"}],"table": "","extra": "INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 2000\n"}],"table": "","extra": "INNER\nps_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 587\n"}],"table": "","extra": "RIGHT\np_partkey IS NOT DISTINCT FROM p_partkey\n\n[INFOSEPARATOR]\nEC: 400000\n"}],"table": "","extra": "(ps_supplycost = SUBQUERY)\n[INFOSEPARATOR]\nEC: 400000"}],"table": "","extra": "#0\n#2\n#4\n#6\n#8\n#9\n#10\n#11\n#12\n#13\n"}],"table": "","extra": "s_acctbal\ns_name\nn_name\np_partkey\np_mfgr\ns_address\ns_phone\ns_comment\n"}],"table": "","extra": "#0\n#1\n__internal_compress_string_hugeint(#2)\n__internal_compress_integral_uinteger(#3, 1)\n__internal_compress_string_hugeint(#4)\n#5\n__internal_compress_string_hugeint(#6)\n#7\n"}],"table": "","extra": "ORDERS:\nsupplier.s_acctbal DESC\nnation.n_name ASC\nsupplier.s_name ASC\npart.p_partkey ASC"}],"table": "","extra": "#0\n#1\n__internal_decompress_string(#2)\n__internal_decompress_integral_bigint(#3, 1)\n__internal_decompress_string(#4)\n#5\n__internal_decompress_string(#6)\n#7\n"}],"table": "","extra": ""}
%%%%%%%%%%%%%%%% Running Query #  3  threads:  1
SELECT l_orderkey, sum(l_extendedprice * (1 - l_discount)) AS revenue, o_orderdate, o_shippriority FROM customer, orders, lineitem WHERE c_mktsegment = 'BUILDING' AND c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate < CAST('1995-03-15' AS date) AND l_shipdate > CAST('1995-03-15' AS date) GROUP BY l_orderkey, o_orderdate, o_shippriority ORDER BY revenue DESC, o_orderdate LIMIT 10;
Run:  None SELECT l_orderkey, sum(l_extendedprice * (1 - l_discount)) AS revenue, o_orderdate, o_shippriority FROM customer, orders, lineitem WHERE c_mktsegment = 'BUILDING' AND c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate < CAST('1995-03-15' AS date) AND l_shipdate > CAST('1995-03-15' AS date) GROUP BY l_orderkey, o_orderdate, o_shippriority ORDER BY revenue DESC, o_orderdate LIMIT 10;
Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                                                          
│      STREAMING_LIMIT      │                                                          
└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          
│         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│__internal_decompress_integ│                                                          
│     ral_bigint(#0, 1)     │                                                          
│             #1            │                                                          
│             #2            │                                                          
│__internal_decompress_integ│                                                          
│     ral_integer(#3, 0)    │                                                          
└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          
│          ORDER_BY         │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│          ORDERS:          │                                                          
│       sum((lineitem       │                                                          
│.l_extendedprice * (1 ...  │                                                          
│    .l_discount))) DESC    │                                                          
│   orders.o_orderdate ASC  │                                                          
└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          
│         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│__internal_compress_integra│                                                          
│     l_uinteger(#0, 1)     │                                                          
│             #1            │                                                          
│             #2            │                                                          
│__internal_compress_integra│                                                          
│     l_utinyint(#3, 0)     │                                                          
└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          
│         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│         l_orderkey        │                                                          
│          revenue          │                                                          
│        o_orderdate        │                                                          
│       o_shippriority      │                                                          
└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          
│         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│__internal_decompress_integ│                                                          
│     ral_bigint(#0, 1)     │                                                          
│             #1            │                                                          
│__internal_decompress_integ│                                                          
│     ral_integer(#2, 0)    │                                                          
│             #3            │                                                          
└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          
│       HASH_GROUP_BY       │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│             #0            │                                                          
│             #1            │                                                          
│             #2            │                                                          
│          sum(#3)          │                                                          
└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          
│         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│         l_orderkey        │                                                          
│        o_orderdate        │                                                          
│       o_shippriority      │                                                          
│ (l_extendedprice * (1.00 -│                                                          
│        l_discount))       │                                                          
└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          
│         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│__internal_compress_integra│                                                          
│     l_uinteger(#0, 1)     │                                                          
│             #1            │                                                          
│             #2            │                                                          
│__internal_compress_integra│                                                          
│     l_uinteger(#3, 1)     │                                                          
│             #4            │                                                          
│__internal_compress_integra│                                                          
│     l_utinyint(#5, 0)     │                                                          
└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          
│         HASH_JOIN         │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│           INNER           │                                                          
│  l_orderkey = o_orderkey  ├──────────────┐                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                           
│         EC: 28949         │              │                                           
└─────────────┬─────────────┘              │                                                                        
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             
│         SEQ_SCAN          ││         HASH_JOIN         │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│          lineitem         ││           INNER           │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   o_custkey = c_custkey   │                             
│         l_orderkey        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│      l_extendedprice      ││        Build Min: 1       │                             
│         l_discount        ││     Build Max: 149999     ├──────────────┐              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              
│ Filters: l_shipdate>'1995 ││         EC: 36179         │              │              
│-03-15'::DATE AND l_sh...  ││                           │              │              
│         IS NOT NULL       ││                           │              │              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │              │              
│        EC: 1200243        ││                           │              │              
└───────────────────────────┘└─────────────┬─────────────┘              │                                           
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
                             │         SEQ_SCAN          ││           FILTER          │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                             │           orders          ││   (c_custkey <= 149999)   │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                             │         o_custkey         ││         EC: 30000         │
                             │         o_orderkey        ││                           │
                             │        o_orderdate        ││                           │
                             │       o_shippriority      ││                           │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │
                             │ Filters: o_orderdate<'1995││                           │
                             │     -03-15'::DATE AND     ││                           │
                             │   o_orderdate IS NOT NULL ││                           │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │
                             │         EC: 300000        ││                           │
                             └───────────────────────────┘└─────────────┬─────────────┘                             
                                                          ┌─────────────┴─────────────┐
                                                          │         SEQ_SCAN          │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │          customer         │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │         c_custkey         │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │   Filters: c_mktsegment=  │
                                                          │'BUILDING' AND c_mktse...  │
                                                          │          NOT NULL         │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │         EC: 30000         │
                                                          └───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

compressed filter_log_size: 1246
compressed filter_log_buffer_size: 0
compressed limit_offset_size: 848
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 73863
compressed perfect_full_scan_ht_log_buffer_size: 72775
compressed perfect_probe_ht_log_size: 477838
compressed perfect_probe_ht_log_buffer_size: 466901
compressed row_group_log_size: 1008596
compressed row_group_log_buffer_size: 956586
compressed scatter_log_size: 30645
compressed scatter_log_buffer_size: 29736
compressed scatter_sel_log_size: 745214
compressed scatter_sel_log_buffer_size: 735086
compressed gather_log_size: 704
compressed gather_log_buffer_size: 0
compressed combine_log_size: 704
compressed combine_log_buffer_size: 0
compressed finalize_states_log_size: 10169
compressed finalize_states_log_buffer_size: 9306
compressed join_gather_log_size: 346954
compressed join_gather_log_buffer_size: 284932
compressed reorder_log_size: 26165
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 704
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 704
compressed nlj_log_buffer_size: 0
compressed total_size: 2724354
compressed total_buffer_size: 2555322
compressed total_element_size: 169032

Avg Time in sec:  0.22380243381485343  output size:  10
   l_orderkey      revenue o_orderdate  o_shippriority
0     2456423  406181.0111  1995-03-05               0
1     3459808  405838.6989  1995-03-04               0
2      492164  390324.0610  1995-02-19               0
3     1188320  384537.9359  1995-03-09               0
4     2435712  378673.0558  1995-02-26               0
5     4878020  378376.7952  1995-03-12               0
6     5521732  375153.9215  1995-03-13               0
7     2628192  373133.3094  1995-02-22               0
8      993600  371407.4595  1995-03-05               0
9     2300070  367371.1452  1995-03-13               0
{'name': 'Query', 'result': 0.22027, 'timing': 0.22027, 'cardinality': 0, 'extra-info': "SELECT l_orderkey, sum(l_extendedprice * (1 - l_discount)) AS revenue, o_orderdate, o_shippriority FROM customer, orders, lineitem WHERE c_mktsegment = 'BUILDING' AND c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate < CAST('1995-03-15' AS date) AND l_shipdate > CAST('1995-03-15' AS date) GROUP BY l_orderkey, o_orderdate, o_shippriority ORDER BY revenue DESC, o_orderdate LIMIT 10;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 5e-06, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'STREAMING_LIMIT', 'timing': 3e-06, 'cardinality': 10, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 1e-05, 'cardinality': 4096, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n#1\n#2\n__internal_decompress_integral_integer(#3, 0)\n', 'children': [{'name': 'ORDER_BY', 'timing': 0.000475, 'cardinality': 4096, 'extra_info': 'ORDERS:\nsum((lineitem.l_extendedprice * (1 - lineitem.l_discount))) DESC\norders.o_orderdate ASC', 'children': [{'name': 'PROJECTION', 'timing': 1.4e-05, 'cardinality': 11620, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n#1\n#2\n__internal_compress_integral_utinyint(#3, 0)\n', 'children': [{'name': 'PROJECTION', 'timing': 3e-06, 'cardinality': 11620, 'extra_info': 'l_orderkey\nrevenue\no_orderdate\no_shippriority\n', 'children': [{'name': 'PROJECTION', 'timing': 3.1e-05, 'cardinality': 11620, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n#1\n__internal_decompress_integral_integer(#2, 0)\n#3\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.003739, 'cardinality': 11620, 'extra_info': '#0\n#1\n#2\nsum(#3)', 'children': [{'name': 'PROJECTION', 'timing': 0.000224, 'cardinality': 30519, 'extra_info': 'l_orderkey\no_orderdate\no_shippriority\n(l_extendedprice * (1.00 - l_discount))\n', 'children': [{'name': 'PROJECTION', 'timing': 0.000318, 'cardinality': 30519, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n#1\n#2\n__internal_compress_integral_uinteger(#3, 1)\n#4\n__internal_compress_integral_utinyint(#5, 0)\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.116428, 'cardinality': 30519, 'extra_info': 'INNER\nl_orderkey = o_orderkey\n\n[INFOSEPARATOR]\nEC: 28949\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.04192, 'cardinality': 3241776, 'extra_info': "lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nFilters: l_shipdate>'1995-03-15'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243", 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.017141, 'cardinality': 147126, 'extra_info': 'INNER\no_custkey = c_custkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 149999\n\n[INFOSEPARATOR]\nEC: 36179\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.016331, 'cardinality': 727305, 'extra_info': "orders\n[INFOSEPARATOR]\no_custkey\no_orderkey\no_orderdate\no_shippriority\n[INFOSEPARATOR]\nFilters: o_orderdate<'1995-03-15'::DATE AND o_orderdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 300000", 'children': []}, {'name': 'FILTER', 'timing': 0.000495, 'cardinality': 30142, 'extra_info': '(c_custkey <= 149999)\n[INFOSEPARATOR]\nEC: 30000', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.005218, 'cardinality': 30142, 'extra_info': "customer\n[INFOSEPARATOR]\nc_custkey\n[INFOSEPARATOR]\nFilters: c_mktsegment='BUILDING' AND c_mktsegment IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 30000", 'children': []}]}]}]}]}]}]}]}]}]}]}]}]}]}]}
X {'RESULT_COLLECTOR0': 5e-06, 'STREAMING_LIMIT1': 3e-06, 'PROJECTION2': 1e-05, 'ORDER_BY3': 0.000475, 'PROJECTION4': 1.4e-05, 'PROJECTION5': 3e-06, 'PROJECTION6': 3.1e-05, 'HASH_GROUP_BY7': 0.003739, 'PROJECTION8': 0.000224, 'PROJECTION9': 0.000318, 'HASH_JOIN10': 0.116428, 'SEQ_SCAN 11': 0.04192, 'HASH_JOIN12': 0.017141, 'SEQ_SCAN 13': 0.016331, 'FILTER14': 0.000495, 'SEQ_SCAN 15': 0.005218}
**** output size:  10
LINEAGE_5_FILTER_3
LINEAGE_5_HASH_GROUP_BY_8
LINEAGE_5_HASH_JOIN_4
LINEAGE_5_HASH_JOIN_5
LINEAGE_5_ORDER_BY_12
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_1
LINEAGE_5_SEQ_SCAN_2
LINEAGE_5_STREAMING_LIMIT_14
SELECT l_orderkey, sum(l_extendedprice * (1 - l_discount)) AS revenue, o_orderdate, o_shippriority FROM customer, orders, lineitem WHERE c_mktsegment = 'BUILDING' AND c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate < CAST('1995-03-15' AS date) AND l_shipdate > CAST('1995-03-15' AS date) GROUP BY l_orderkey, o_orderdate, o_shippriority ORDER BY revenue DESC, o_orderdate LIMIT 10;
   query_id  ...                                               plan
0         5  ...  {"name": "STREAMING_LIMIT", "opid": "14", "chi...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               SELECT l_orderkey, sum(l_extendedprice * (1 - ...
size_bytes_max                                                2724354
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "STREAMING_LIMIT", "opid": "14", "chi...
Name: 0, dtype: object
{"name": "STREAMING_LIMIT", "opid": "14", "children": [{"name": "PROJECTION", "opid": "13", "children": [{"name": "ORDER_BY", "opid": "12", "children": [{"name": "PROJECTION", "opid": "11", "children": [{"name": "PROJECTION", "opid": "10", "children": [{"name": "PROJECTION", "opid": "9", "children": [{"name": "HASH_GROUP_BY", "opid": "8", "children": [{"name": "PROJECTION", "opid": "7", "children": [{"name": "PROJECTION", "opid": "6", "children": [{"name": "HASH_JOIN", "opid": "5", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nFilters: l_shipdate>'1995-03-15'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243"},{"name": "HASH_JOIN", "opid": "4", "children": [{"name": "SEQ_SCAN ", "opid": "1", "children": [],"table": "orders","extra": "orders\n[INFOSEPARATOR]\no_custkey\no_orderkey\no_orderdate\no_shippriority\n[INFOSEPARATOR]\nFilters: o_orderdate<'1995-03-15'::DATE AND o_orderdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 300000"},{"name": "FILTER", "opid": "3", "children": [{"name": "SEQ_SCAN ", "opid": "2", "children": [],"table": "customer","extra": "customer\n[INFOSEPARATOR]\nc_custkey\n[INFOSEPARATOR]\nFilters: c_mktsegment='BUILDING' AND c_mktsegment IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 30000"}],"table": "","extra": "(c_custkey <= 149999)\n[INFOSEPARATOR]\nEC: 30000"}],"table": "","extra": "INNER\no_custkey = c_custkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 149999\n\n[INFOSEPARATOR]\nEC: 36179\n"}],"table": "","extra": "INNER\nl_orderkey = o_orderkey\n\n[INFOSEPARATOR]\nEC: 28949\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n#1\n#2\n__internal_compress_integral_uinteger(#3, 1)\n#4\n__internal_compress_integral_utinyint(#5, 0)\n"}],"table": "","extra": "l_orderkey\no_orderdate\no_shippriority\n(l_extendedprice * (1.00 - l_discount))\n"}],"table": "","extra": "#0\n#1\n#2\nsum(#3)"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n#1\n__internal_decompress_integral_integer(#2, 0)\n#3\n"}],"table": "","extra": "l_orderkey\nrevenue\no_orderdate\no_shippriority\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n#1\n#2\n__internal_compress_integral_utinyint(#3, 0)\n"}],"table": "","extra": "ORDERS:\nsum((lineitem.l_extendedprice * (1 - lineitem.l_discount))) DESC\norders.o_orderdate ASC"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n#1\n#2\n__internal_decompress_integral_integer(#3, 0)\n"}],"table": "","extra": ""}
Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│__internal_decompress_strin│                                                                                       
│           g(#0)           │                                                                                       
│             #1            │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│          ORDER_BY         │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│          ORDERS:          │                                                                                       
│ orders.o_orderpriority ASC│                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│__internal_compress_string_│                                                                                       
│        hugeint(#0)        │                                                                                       
│             #1            │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│__internal_decompress_strin│                                                                                       
│           g(#0)           │                                                                                       
│             #1            │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│       HASH_GROUP_BY       │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│             #0            │                                                                                       
│        count_star()       │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│      o_orderpriority      │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│__internal_compress_integra│                                                                                       
│     l_uinteger(#0, 1)     │                                                                                       
│__internal_compress_string_│                                                                                       
│        hugeint(#1)        │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│      RIGHT_DELIM_JOIN     │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│         RIGHT_SEMI        │                                                                                       
│ o_orderkey IS NOT DISTINCT├──────────────┐                                                                        
│       FROM o_orderkey     │              │                                                                        
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                                                        
│        EC: 1200243        │              │                                                                        
└─────────────┬─────────────┘              │                                                                                                     
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                          
│         SEQ_SCAN          ││         HASH_JOIN         │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│           orders          ││         RIGHT_SEMI        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││ o_orderkey IS NOT DISTINCT│                                                          
│         o_orderkey        ││       FROM o_orderkey     │                                                          
│      o_orderpriority      ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││        EC: 1200243        ├───────────────────────────────────────────┐              
│Filters: o_orderdate>='1993││                           │                                           │              
│     -07-01'::DATE AND     ││                           │                                           │              
│ o_orderdate<'1993-10-...  ││                           │                                           │              
│   o_orderdate IS NOT NULL ││                           │                                           │              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                           │              
│         EC: 300000        ││                           │                                           │              
└───────────────────────────┘└─────────────┬─────────────┘                                           │                                           
                             ┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐
                             │         PROJECTION        │                             │         DUMMY_SCAN        │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │                           │
                             │         o_orderkey        │                             │                           │
                             └─────────────┬─────────────┘                             └───────────────────────────┘                             
                             ┌─────────────┴─────────────┐                                                          
                             │         HASH_JOIN         │                                                          
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                             │           INNER           │                                                          
                             │  l_orderkey = o_orderkey  ├──────────────┐                                           
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                           
                             │        EC: 1200243        │              │                                           
                             └─────────────┬─────────────┘              │                                                                        
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             
                             │           FILTER          ││         DELIM_SCAN        │                             
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                             
                             │      (l_commitdate <      ││                           │                             
                             │       l_receiptdate)      ││                           │                             
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                             
                             │        EC: 6001215        ││                           │                             
                             └─────────────┬─────────────┘└───────────────────────────┘                                                          
                             ┌─────────────┴─────────────┐                                                          
                             │         SEQ_SCAN          │                                                          
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                             │          lineitem         │                                                          
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                             │         l_orderkey        │                                                          
                             │        l_commitdate       │                                                          
                             │       l_receiptdate       │                                                          
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                             │        EC: 6001215        │                                                          
                             └───────────────────────────┘                                                                                       

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

compressed filter_log_size: 783193
compressed filter_log_buffer_size: 750165
compressed limit_offset_size: 672
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 672
compressed perfect_full_scan_ht_log_buffer_size: 0
compressed perfect_probe_ht_log_size: 672
compressed perfect_probe_ht_log_buffer_size: 0
compressed row_group_log_size: 164604
compressed row_group_log_buffer_size: 133120
compressed scatter_log_size: 113163
compressed scatter_log_buffer_size: 108719
compressed scatter_sel_log_size: 578858
compressed scatter_sel_log_buffer_size: 571285
compressed gather_log_size: 672
compressed gather_log_buffer_size: 0
compressed combine_log_size: 672
compressed combine_log_buffer_size: 0
compressed finalize_states_log_size: 21927
compressed finalize_states_log_buffer_size: 20847
compressed join_gather_log_size: 2013212
compressed join_gather_log_buffer_size: 1908408
compressed reorder_log_size: 1088
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 672
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 672
compressed nlj_log_buffer_size: 0
compressed total_size: 3680749
compressed total_buffer_size: 3492544
compressed total_element_size: 188205

Clear Lineage

%%%%%%%%%%%%%%%% Running Query #  4  threads:  1
SELECT o_orderpriority, count(*) AS order_count FROM orders WHERE o_orderdate >= CAST('1993-07-01' AS date) AND o_orderdate < CAST('1993-10-01' AS date) AND EXISTS ( SELECT * FROM lineitem WHERE l_orderkey = o_orderkey AND l_commitdate < l_receiptdate) GROUP BY o_orderpriority ORDER BY o_orderpriority;
Run:  None SELECT o_orderpriority, count(*) AS order_count FROM orders WHERE o_orderdate >= CAST('1993-07-01' AS date) AND o_orderdate < CAST('1993-10-01' AS date) AND EXISTS ( SELECT * FROM lineitem WHERE l_orderkey = o_orderkey AND l_commitdate < l_receiptdate) GROUP BY o_orderpriority ORDER BY o_orderpriority;
Avg Time in sec:  0.2433659159578383  output size:  5
   o_orderpriority  order_count
0         1-URGENT        10594
1           2-HIGH        10476
2         3-MEDIUM        10410
3  4-NOT SPECIFIED        10556
4            5-LOW        10487
{'name': 'Query', 'result': 0.240471, 'timing': 0.240471, 'cardinality': 0, 'extra-info': "SELECT o_orderpriority, count(*) AS order_count FROM orders WHERE o_orderdate >= CAST('1993-07-01' AS date) AND o_orderdate < CAST('1993-10-01' AS date) AND EXISTS ( SELECT * FROM lineitem WHERE l_orderkey = o_orderkey AND l_commitdate < l_receiptdate) GROUP BY o_orderpriority ORDER BY o_orderpriority;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 1e-05, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 1e-06, 'cardinality': 5, 'extra_info': '__internal_decompress_string(#0)\n#1\n', 'children': [{'name': 'ORDER_BY', 'timing': 6.1e-05, 'cardinality': 5, 'extra_info': 'ORDERS:\norders.o_orderpriority ASC', 'children': [{'name': 'PROJECTION', 'timing': 1e-06, 'cardinality': 5, 'extra_info': '__internal_compress_string_hugeint(#0)\n#1\n', 'children': [{'name': 'PROJECTION', 'timing': 6e-06, 'cardinality': 5, 'extra_info': '__internal_decompress_string(#0)\n#1\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.001767, 'cardinality': 5, 'extra_info': '#0\ncount_star()', 'children': [{'name': 'PROJECTION', 'timing': 6e-06, 'cardinality': 52523, 'extra_info': 'o_orderpriority\n', 'children': [{'name': 'PROJECTION', 'timing': 0.000599, 'cardinality': 52523, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n__internal_compress_string_hugeint(#1)\n', 'children': [{'name': 'RIGHT_DELIM_JOIN', 'timing': 0.019533, 'cardinality': 0, 'extra_info': 'RIGHT_SEMI\no_orderkey IS NOT DISTINCT FROM o_orderkey\n\n[INFOSEPARATOR]\nEC: 1200243\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.049801, 'cardinality': 57218, 'extra_info': "orders\n[INFOSEPARATOR]\no_orderkey\no_orderpriority\n[INFOSEPARATOR]\nFilters: o_orderdate>='1993-07-01'::DATE AND o_orderdate<'1993-10-01'::DATE AND o_orderdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 300000", 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.013612, 'cardinality': 52523, 'extra_info': 'RIGHT_SEMI\no_orderkey IS NOT DISTINCT FROM o_orderkey\n\n[INFOSEPARATOR]\nEC: 1200243\n', 'children': [{'name': 'PROJECTION', 'timing': 6.5e-05, 'cardinality': 144869, 'extra_info': 'o_orderkey\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.096744, 'cardinality': 144869, 'extra_info': 'INNER\nl_orderkey = o_orderkey\n\n[INFOSEPARATOR]\nEC: 1200243\n', 'children': [{'name': 'FILTER', 'timing': 0.036048, 'cardinality': 3793296, 'extra_info': '(l_commitdate < l_receiptdate)\n[INFOSEPARATOR]\nEC: 6001215', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.009737, 'cardinality': 6001215, 'extra_info': 'lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_commitdate\nl_receiptdate\n[INFOSEPARATOR]\nEC: 6001215', 'children': []}]}, {'name': 'DELIM_SCAN', 'timing': 0.0, 'cardinality': 0, 'extra_info': '', 'children': []}]}]}, {'name': 'DUMMY_SCAN', 'timing': 0.0, 'cardinality': 0, 'extra_info': '', 'children': []}]}, {'name': 'HASH_GROUP_BY', 'timing': 0.001092, 'cardinality': 57218, 'extra_info': '#0', 'children': []}]}]}]}]}]}]}]}]}]}]}
X {'RESULT_COLLECTOR0': 1e-05, 'PROJECTION1': 1e-06, 'ORDER_BY2': 6.1e-05, 'PROJECTION3': 1e-06, 'PROJECTION4': 6e-06, 'HASH_GROUP_BY5': 0.001767, 'PROJECTION6': 6e-06, 'PROJECTION7': 0.000599, 'RIGHT_DELIM_JOIN8': 0.019533, 'SEQ_SCAN 9': 0.049801, 'HASH_JOIN10': 0.013612, 'PROJECTION11': 6.5e-05, 'HASH_JOIN12': 0.096744, 'FILTER13': 0.036048, 'SEQ_SCAN 14': 0.009737, 'DELIM_SCAN15': 0.0, 'DUMMY_SCAN16': 0.0, 'HASH_GROUP_BY17': 0.001092}
**** output size:  5
LINEAGE_5_FILTER_1
LINEAGE_5_HASH_GROUP_BY_12
LINEAGE_5_HASH_GROUP_BY_7
LINEAGE_5_HASH_JOIN_3
LINEAGE_5_HASH_JOIN_6
LINEAGE_5_ORDER_BY_15
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_8
SELECT o_orderpriority, count(*) AS order_count FROM orders WHERE o_orderdate >= CAST('1993-07-01' AS date) AND o_orderdate < CAST('1993-10-01' AS date) AND EXISTS ( SELECT * FROM lineitem WHERE l_orderkey = o_orderkey AND l_commitdate < l_receiptdate) GROUP BY o_orderpriority ORDER BY o_orderpriority;
   query_id  ...                                               plan
0         5  ...  {"name": "PROJECTION", "opid": "16", "children...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               SELECT o_orderpriority, count(*) AS order_coun...
size_bytes_max                                                3680749
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "PROJECTION", "opid": "16", "children...
Name: 0, dtype: object
{"name": "PROJECTION", "opid": "16", "children": [{"name": "ORDER_BY", "opid": "15", "children": [{"name": "PROJECTION", "opid": "14", "children": [{"name": "PROJECTION", "opid": "13", "children": [{"name": "HASH_GROUP_BY", "opid": "12", "children": [{"name": "PROJECTION", "opid": "11", "children": [{"name": "PROJECTION", "opid": "10", "children": [{"name": "RIGHT_DELIM_JOIN", "opid": "9", "children": [{"name": "HASH_GROUP_BY", "opid": "7", "children": [],"table": "","extra": "#0"},{"name": "HASH_JOIN", "opid": "6", "children": [{"name": "PROJECTION", "opid": "4", "children": [{"name": "HASH_JOIN", "opid": "3", "children": [{"name": "FILTER", "opid": "1", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_commitdate\nl_receiptdate\n[INFOSEPARATOR]\nEC: 6001215"}],"table": "","extra": "(l_commitdate < l_receiptdate)\n[INFOSEPARATOR]\nEC: 6001215"},{"name": "DELIM_SCAN", "opid": "2", "children": [],"table": "","extra": ""}],"table": "","extra": "INNER\nl_orderkey = o_orderkey\n\n[INFOSEPARATOR]\nEC: 1200243\n"}],"table": "","extra": "o_orderkey\n"},{"name": "DUMMY_SCAN", "opid": "5", "children": [],"table": "","extra": ""}],"table": "","extra": "RIGHT_SEMI\no_orderkey IS NOT DISTINCT FROM o_orderkey\n\n[INFOSEPARATOR]\nEC: 1200243\n"},{"name": "SEQ_SCAN ", "opid": "8", "children": [],"table": "orders","extra": "orders\n[INFOSEPARATOR]\no_orderkey\no_orderpriority\n[INFOSEPARATOR]\nFilters: o_orderdate>='1993-07-01'::DATE AND o_orderdate<'1993-10-01'::DATE AND o_orderdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 300000"}],"table": "","extra": "RIGHT_SEMI\no_orderkey IS NOT DISTINCT FROM o_orderkey\n\n[INFOSEPARATOR]\nEC: 1200243\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n__internal_compress_string_hugeint(#1)\n"}],"table": "","extra": "o_orderpriority\n"}],"table": "","extra": "#0\ncount_star()"}],"table": "","extra": "__internal_decompress_string(#0)\n#1\n"}],"table": "","extra": "__internal_compress_string_hugeint(#0)\n#1\n"}],"table": "","extra": "ORDERS:\norders.o_orderpriority ASC"}],"table": "","extra": "__internal_decompress_string(#0)\n#1\n"}
%%%%%%%%%%%%%%%% Running Query #  5  threads:  1
SELECT n_name, sum(l_extendedprice * (1 - l_discount)) AS revenue FROM customer, orders, lineitem, supplier, nation, region WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND l_suppkey = s_suppkey AND c_nationkey = s_nationkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'ASIA' AND o_orderdate >= CAST('1994-01-01' AS date) AND o_orderdate < CAST('1995-01-01' AS date) GROUP BY n_name ORDER BY revenue DESC;
Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│__internal_decompress_strin│                                                                                                                                                 
│           g(#0)           │                                                                                                                                                 
│             #1            │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│          ORDER_BY         │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│          ORDERS:          │                                                                                                                                                 
│       sum((lineitem       │                                                                                                                                                 
│.l_extendedprice * (1 ...  │                                                                                                                                                 
│    .l_discount))) DESC    │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│__internal_compress_string_│                                                                                                                                                 
│        hugeint(#0)        │                                                                                                                                                 
│             #1            │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│__internal_decompress_strin│                                                                                                                                                 
│           g(#0)           │                                                                                                                                                 
│             #1            │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│       HASH_GROUP_BY       │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│             #0            │                                                                                                                                                 
│          sum(#1)          │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│           n_name          │                                                                                                                                                 
│ (l_extendedprice * (1.00 -│                                                                                                                                                 
│        l_discount))       │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│__internal_compress_integra│                                                                                                                                                 
│     l_uinteger(#0, 1)     │                                                                                                                                                 
│__internal_compress_integra│                                                                                                                                                 
│     l_usmallint(#1, 1)    │                                                                                                                                                 
│             #2            │                                                                                                                                                 
│             #3            │                                                                                                                                                 
│__internal_compress_integra│                                                                                                                                                 
│     l_uinteger(#4, 1)     │                                                                                                                                                 
│__internal_compress_integra│                                                                                                                                                 
│     l_utinyint(#5, 0)     │                                                                                                                                                 
│__internal_compress_string_│                                                                                                                                                 
│        hugeint(#6)        │                                                                                                                                                 
│__internal_compress_integra│                                                                                                                                                 
│     l_usmallint(#7, 1)    │                                                                                                                                                 
│__internal_compress_integra│                                                                                                                                                 
│     l_utinyint(#8, 0)     │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         HASH_JOIN         │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│           INNER           │                                                                                                                                                 
│ n_nationkey = s_nationkey ├──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐              
│   l_suppkey = s_suppkey   │                                                                                                                                  │              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                  │              
│         EC: 143512        │                                                                                                                                  │              
└─────────────┬─────────────┘                                                                                                                                  │                                           
┌─────────────┴─────────────┐                                                                                                                    ┌─────────────┴─────────────┐
│         HASH_JOIN         │                                                                                                                    │         SEQ_SCAN          │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│           INNER           │                                                                                                                    │          supplier         │
│  l_orderkey = o_orderkey  │                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐                                                                                                     │         s_suppkey         │
│         EC: 144747        │              │                                                                                                     │        s_nationkey        │
│                           │              │                                                                                                     │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│                           │              │                                                                                                     │         EC: 10000         │
└─────────────┬─────────────┘              │                                                                                                     └───────────────────────────┘                             
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                                                    
│         SEQ_SCAN          ││         HASH_JOIN         │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│          lineitem         ││           INNER           │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   o_custkey = c_custkey   │                                                                                                                    
│         l_orderkey        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│         l_suppkey         ││        Build Min: 1       ├──────────────┐                                                                                                     
│      l_extendedprice      ││     Build Max: 149999     │              │                                                                                                     
│         l_discount        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                                                                                     
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││         EC: 36179         │              │                                                                                                     
│        EC: 6001215        ││                           │              │                                                                                                     
└───────────────────────────┘└─────────────┬─────────────┘              │                                                                                                                                  
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                       
                             │         SEQ_SCAN          ││         PROJECTION        │                                                                                       
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
                             │           orders          ││             #0            │                                                                                       
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││             #1            │                                                                                       
                             │         o_custkey         ││             #3            │                                                                                       
                             │         o_orderkey        ││                           │                                                                                       
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                                                                       
                             │Filters: o_orderdate>='1994││                           │                                                                                       
                             │     -01-01'::DATE AND     ││                           │                                                                                       
                             │ o_orderdate<'1995-01-...  ││                           │                                                                                       
                             │   o_orderdate IS NOT NULL ││                           │                                                                                       
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                                                                       
                             │         EC: 300000        ││                           │                                                                                       
                             └───────────────────────────┘└─────────────┬─────────────┘                                                                                                                    
                                                          ┌─────────────┴─────────────┐                                                                                       
                                                          │           FILTER          │                                                                                       
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
                                                          │   (c_custkey <= 149999)   │                                                                                       
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
                                                          │         EC: 30000         │                                                                                       
                                                          └─────────────┬─────────────┘                                                                                                                    
                                                          ┌─────────────┴─────────────┐                                                                                       
                                                          │         HASH_JOIN         │                                                                                       
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
                                                          │           INNER           │                                                                                       
                                                          │ c_nationkey = n_nationkey │                                                                                       
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐                                                                        
                                                          │        Build Min: 0       │              │                                                                        
                                                          │       Build Max: 24       │              │                                                                        
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                                                        
                                                          │         EC: 30000         │              │                                                                        
                                                          └─────────────┬─────────────┘              │                                                                                                     
                                                          ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                          
                                                          │         SEQ_SCAN          ││         HASH_JOIN         │                                                          
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                          │          customer         ││           INNER           │                                                          
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││ n_regionkey = r_regionkey │                                                          
                                                          │         c_custkey         ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐                                           
                                                          │        c_nationkey        ││           EC: 25          │              │                                           
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │              │                                           
                                                          │         EC: 150000        ││                           │              │                                           
                                                          └───────────────────────────┘└─────────────┬─────────────┘              │                                                                        
                                                                                       ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             
                                                                                       │         SEQ_SCAN          ││         SEQ_SCAN          │                             
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                                                                                       │           nation          ││           region          │                             
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                                                                                       │        n_nationkey        ││        r_regionkey        │                             
                                                                                       │        n_regionkey        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                                                                                       │           n_name          ││ Filters: r_name='ASIA' AND│                             
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││     r_name IS NOT NULL    │                             
                                                                                       │           EC: 25          ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                                                                                       │                           ││           EC: 1           │                             
                                                                                       └───────────────────────────┘└───────────────────────────┘                                                          

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

compressed filter_log_size: 1401
compressed filter_log_buffer_size: 0
compressed limit_offset_size: 864
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 79588
compressed perfect_full_scan_ht_log_buffer_size: 77956
compressed perfect_probe_ht_log_size: 229986
compressed perfect_probe_ht_log_buffer_size: 217545
compressed row_group_log_size: 222675
compressed row_group_log_buffer_size: 188793
compressed scatter_log_size: 16076
compressed scatter_log_buffer_size: 14850
compressed scatter_sel_log_size: 372668
compressed scatter_sel_log_buffer_size: 365939
compressed gather_log_size: 864
compressed gather_log_buffer_size: 0
compressed combine_log_size: 864
compressed combine_log_buffer_size: 0
compressed finalize_states_log_size: 1073
compressed finalize_states_log_buffer_size: 65
compressed join_gather_log_size: 1205782
compressed join_gather_log_buffer_size: 1089729
compressed reorder_log_size: 1376
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 864
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 864
compressed nlj_log_buffer_size: 0
compressed total_size: 2134945
compressed total_buffer_size: 1954877
compressed total_element_size: 180068

Run:  None SELECT n_name, sum(l_extendedprice * (1 - l_discount)) AS revenue FROM customer, orders, lineitem, supplier, nation, region WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND l_suppkey = s_suppkey AND c_nationkey = s_nationkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'ASIA' AND o_orderdate >= CAST('1994-01-01' AS date) AND o_orderdate < CAST('1995-01-01' AS date) GROUP BY n_name ORDER BY revenue DESC;
Avg Time in sec:  0.2575604929588735  output size:  5
      n_name       revenue
0  INDONESIA  5.550204e+07
1    VIETNAM  5.529509e+07
2      CHINA  5.372449e+07
3      INDIA  5.203551e+07
4      JAPAN  4.541018e+07
{'name': 'Query', 'result': 0.252134, 'timing': 0.252134, 'cardinality': 0, 'extra-info': "SELECT n_name, sum(l_extendedprice * (1 - l_discount)) AS revenue FROM customer, orders, lineitem, supplier, nation, region WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND l_suppkey = s_suppkey AND c_nationkey = s_nationkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'ASIA' AND o_orderdate >= CAST('1994-01-01' AS date) AND o_orderdate < CAST('1995-01-01' AS date) GROUP BY n_name ORDER BY revenue DESC;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 4e-06, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 1e-06, 'cardinality': 5, 'extra_info': '__internal_decompress_string(#0)\n#1\n', 'children': [{'name': 'ORDER_BY', 'timing': 2.5e-05, 'cardinality': 5, 'extra_info': 'ORDERS:\nsum((lineitem.l_extendedprice * (1 - lineitem.l_discount))) DESC', 'children': [{'name': 'PROJECTION', 'timing': 1e-06, 'cardinality': 5, 'extra_info': '__internal_compress_string_hugeint(#0)\n#1\n', 'children': [{'name': 'PROJECTION', 'timing': 2e-06, 'cardinality': 5, 'extra_info': '__internal_decompress_string(#0)\n#1\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.001427, 'cardinality': 5, 'extra_info': '#0\nsum(#1)', 'children': [{'name': 'PROJECTION', 'timing': 0.000249, 'cardinality': 7243, 'extra_info': 'n_name\n(l_extendedprice * (1.00 - l_discount))\n', 'children': [{'name': 'PROJECTION', 'timing': 0.000789, 'cardinality': 7243, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n__internal_compress_integral_usmallint(#1, 1)\n#2\n#3\n__internal_compress_integral_uinteger(#4, 1)\n__internal_compress_integral_utinyint(#5, 0)\n__internal_compress_string_hugeint(#6)\n__internal_compress_integral_usmallint(#7, 1)\n__internal_compress_integral_utinyint(#8, 0)\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.02187, 'cardinality': 7243, 'extra_info': 'INNER\nn_nationkey = s_nationkey\nl_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nEC: 143512\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.152967, 'cardinality': 184082, 'extra_info': 'INNER\nl_orderkey = o_orderkey\n\n[INFOSEPARATOR]\nEC: 144747\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.01402, 'cardinality': 6001215, 'extra_info': 'lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_suppkey\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nEC: 6001215', 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.01583, 'cardinality': 46008, 'extra_info': 'INNER\no_custkey = c_custkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 149999\n\n[INFOSEPARATOR]\nEC: 36179\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.020087, 'cardinality': 227597, 'extra_info': "orders\n[INFOSEPARATOR]\no_custkey\no_orderkey\n[INFOSEPARATOR]\nFilters: o_orderdate>='1994-01-01'::DATE AND o_orderdate<'1995-01-01'::DATE AND o_orderdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 300000", 'children': []}, {'name': 'PROJECTION', 'timing': 4.4e-05, 'cardinality': 30183, 'extra_info': '#0\n#1\n#3\n', 'children': [{'name': 'FILTER', 'timing': 0.000518, 'cardinality': 30183, 'extra_info': '(c_custkey <= 149999)\n[INFOSEPARATOR]\nEC: 30000', 'children': [{'name': 'HASH_JOIN', 'timing': 0.001943, 'cardinality': 30183, 'extra_info': 'INNER\nc_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 30000\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.000314, 'cardinality': 150000, 'extra_info': 'customer\n[INFOSEPARATOR]\nc_custkey\nc_nationkey\n[INFOSEPARATOR]\nEC: 150000', 'children': []}, {'name': 'HASH_JOIN', 'timing': 5.8e-05, 'cardinality': 5, 'extra_info': 'INNER\nn_regionkey = r_regionkey\n\n[INFOSEPARATOR]\nEC: 25\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 1.6e-05, 'cardinality': 25, 'extra_info': 'nation\n[INFOSEPARATOR]\nn_nationkey\nn_regionkey\nn_name\n[INFOSEPARATOR]\nEC: 25', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 2.1e-05, 'cardinality': 1, 'extra_info': "region\n[INFOSEPARATOR]\nr_regionkey\n[INFOSEPARATOR]\nFilters: r_name='ASIA' AND r_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1", 'children': []}]}]}]}]}]}]}, {'name': 'SEQ_SCAN ', 'timing': 5.8e-05, 'cardinality': 10000, 'extra_info': 'supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\n[INFOSEPARATOR]\nEC: 10000', 'children': []}]}]}]}]}]}]}]}]}]}]}
X {'RESULT_COLLECTOR0': 4e-06, 'PROJECTION1': 1e-06, 'ORDER_BY2': 2.5e-05, 'PROJECTION3': 1e-06, 'PROJECTION4': 2e-06, 'HASH_GROUP_BY5': 0.001427, 'PROJECTION6': 0.000249, 'PROJECTION7': 0.000789, 'HASH_JOIN8': 0.02187, 'HASH_JOIN9': 0.152967, 'SEQ_SCAN 10': 0.01402, 'HASH_JOIN11': 0.01583, 'SEQ_SCAN 12': 0.020087, 'PROJECTION13': 4.4e-05, 'FILTER14': 0.000518, 'HASH_JOIN15': 0.001943, 'SEQ_SCAN 16': 0.000314, 'HASH_JOIN17': 5.8e-05, 'SEQ_SCAN 18': 1.6e-05, 'SEQ_SCAN 19': 2.1e-05, 'SEQ_SCAN 20': 5.8e-05}
**** output size:  5
LINEAGE_5_FILTER_7
LINEAGE_5_HASH_GROUP_BY_15
LINEAGE_5_HASH_JOIN_10
LINEAGE_5_HASH_JOIN_12
LINEAGE_5_HASH_JOIN_5
LINEAGE_5_HASH_JOIN_6
LINEAGE_5_HASH_JOIN_9
LINEAGE_5_ORDER_BY_18
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_1
LINEAGE_5_SEQ_SCAN_11
LINEAGE_5_SEQ_SCAN_2
LINEAGE_5_SEQ_SCAN_3
LINEAGE_5_SEQ_SCAN_4
SELECT n_name, sum(l_extendedprice * (1 - l_discount)) AS revenue FROM customer, orders, lineitem, supplier, nation, region WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND l_suppkey = s_suppkey AND c_nationkey = s_nationkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'ASIA' AND o_orderdate >= CAST('1994-01-01' AS date) AND o_orderdate < CAST('1995-01-01' AS date) GROUP BY n_name ORDER BY revenue DESC;
   query_id  ...                                               plan
0         5  ...  {"name": "PROJECTION", "opid": "19", "children...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               SELECT n_name, sum(l_extendedprice * (1 - l_di...
size_bytes_max                                                2134945
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "PROJECTION", "opid": "19", "children...
Name: 0, dtype: object
{"name": "PROJECTION", "opid": "19", "children": [{"name": "ORDER_BY", "opid": "18", "children": [{"name": "PROJECTION", "opid": "17", "children": [{"name": "PROJECTION", "opid": "16", "children": [{"name": "HASH_GROUP_BY", "opid": "15", "children": [{"name": "PROJECTION", "opid": "14", "children": [{"name": "PROJECTION", "opid": "13", "children": [{"name": "HASH_JOIN", "opid": "12", "children": [{"name": "HASH_JOIN", "opid": "10", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_suppkey\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nEC: 6001215"},{"name": "HASH_JOIN", "opid": "9", "children": [{"name": "SEQ_SCAN ", "opid": "1", "children": [],"table": "orders","extra": "orders\n[INFOSEPARATOR]\no_custkey\no_orderkey\n[INFOSEPARATOR]\nFilters: o_orderdate>='1994-01-01'::DATE AND o_orderdate<'1995-01-01'::DATE AND o_orderdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 300000"},{"name": "PROJECTION", "opid": "8", "children": [{"name": "FILTER", "opid": "7", "children": [{"name": "HASH_JOIN", "opid": "6", "children": [{"name": "SEQ_SCAN ", "opid": "2", "children": [],"table": "customer","extra": "customer\n[INFOSEPARATOR]\nc_custkey\nc_nationkey\n[INFOSEPARATOR]\nEC: 150000"},{"name": "HASH_JOIN", "opid": "5", "children": [{"name": "SEQ_SCAN ", "opid": "3", "children": [],"table": "nation","extra": "nation\n[INFOSEPARATOR]\nn_nationkey\nn_regionkey\nn_name\n[INFOSEPARATOR]\nEC: 25"},{"name": "SEQ_SCAN ", "opid": "4", "children": [],"table": "region","extra": "region\n[INFOSEPARATOR]\nr_regionkey\n[INFOSEPARATOR]\nFilters: r_name='ASIA' AND r_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1"}],"table": "","extra": "INNER\nn_regionkey = r_regionkey\n\n[INFOSEPARATOR]\nEC: 25\n"}],"table": "","extra": "INNER\nc_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 30000\n"}],"table": "","extra": "(c_custkey <= 149999)\n[INFOSEPARATOR]\nEC: 30000"}],"table": "","extra": "#0\n#1\n#3\n"}],"table": "","extra": "INNER\no_custkey = c_custkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 149999\n\n[INFOSEPARATOR]\nEC: 36179\n"}],"table": "","extra": "INNER\nl_orderkey = o_orderkey\n\n[INFOSEPARATOR]\nEC: 144747\n"},{"name": "SEQ_SCAN ", "opid": "11", "children": [],"table": "supplier","extra": "supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\n[INFOSEPARATOR]\nEC: 10000"}],"table": "","extra": "INNER\nn_nationkey = s_nationkey\nl_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nEC: 143512\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n__internal_compress_integral_usmallint(#1, 1)\n#2\n#3\n__internal_compress_integral_uinteger(#4, 1)\n__internal_compress_integral_utinyint(#5, 0)\n__internal_compress_string_hugeint(#6)\n__internal_compress_integral_usmallint(#7, 1)\n__internal_compress_integral_utinyint(#8, 0)\n"}],"table": "","extra": "n_name\n(l_extendedprice * (1.00 - l_discount))\n"}],"table": "","extra": "#0\nsum(#1)"}],"table": "","extra": "__internal_decompress_string(#0)\n#1\n"}],"table": "","extra": "__internal_compress_string_hugeint(#0)\n#1\n"}],"table": "","extra": "ORDERS:\nsum((lineitem.l_extendedprice * (1 - lineitem.l_discount))) DESC"}],"table": "","extra": "__internal_decompress_string(#0)\n#1\n"}
Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐
│    UNGROUPED_AGGREGATE    │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│    sum_no_overflow(#0)    │
└─────────────┬─────────────┘                             
┌─────────────┴─────────────┐
│         PROJECTION        │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│     (l_extendedprice *    │
│         l_discount)       │
└─────────────┬─────────────┘                             
┌─────────────┴─────────────┐
│         SEQ_SCAN          │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│          lineitem         │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│         l_discount        │
│      l_extendedprice      │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│ Filters: l_shipdate>='1994│
│-01-01'::DATE AND l_sh...  │
│  <'1995-01-01'::DATE AND  │
│   l_shipdate IS NOT NULL  │
│    l_discount>=0.05 AND   │
│ l_discount<=0.07 AND ...  │
│         IS NOT NULL       │
│    l_quantity<24.00 AND   │
│   l_quantity IS NOT NULL  │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│        EC: 1200243        │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

compressed filter_log_size: 288
compressed filter_log_buffer_size: 0
compressed limit_offset_size: 288
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 288
compressed perfect_full_scan_ht_log_buffer_size: 0
compressed perfect_probe_ht_log_size: 288
compressed perfect_probe_ht_log_buffer_size: 0
compressed row_group_log_size: 396128
compressed row_group_log_buffer_size: 357694
compressed scatter_log_size: 288
compressed scatter_log_buffer_size: 0
compressed scatter_sel_log_size: 288
compressed scatter_sel_log_buffer_size: 0
compressed gather_log_size: 288
compressed gather_log_buffer_size: 0
compressed combine_log_size: 288
compressed combine_log_buffer_size: 0
compressed finalize_states_log_size: 288
compressed finalize_states_log_buffer_size: 0
compressed join_gather_log_size: 288
compressed join_gather_log_buffer_size: 0
compressed reorder_log_size: 432
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 288
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 288
compressed nlj_log_buffer_size: 0
compressed total_size: 400016
compressed total_buffer_size: 357694
compressed total_element_size: 42322

Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│__internal_decompress_strin│                                                                                                                                                 
│           g(#0)           │                                                                                                                                                 
│__internal_decompress_strin│                                                                                                                                                 
│           g(#1)           │                                                                                                                                                 
│__internal_decompress_integ│                                                                                                                                                 
│    ral_bigint(#2, 1992)   │                                                                                                                                                 
│             #3            │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│          ORDER_BY         │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│          ORDERS:          │                                                                                                                                                 
│  shipping.supp_nation ASC │                                                                                                                                                 
│  shipping.cust_nation ASC │                                                                                                                                                 
│    shipping.l_year ASC    │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│__internal_compress_string_│                                                                                                                                                 
│        hugeint(#0)        │                                                                                                                                                 
│__internal_compress_string_│                                                                                                                                                 
│        hugeint(#1)        │                                                                                                                                                 
│__internal_compress_integra│                                                                                                                                                 
│    l_utinyint(#2, 1992)   │                                                                                                                                                 
│             #3            │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│__internal_decompress_strin│                                                                                                                                                 
│           g(#0)           │                                                                                                                                                 
│__internal_decompress_strin│                                                                                                                                                 
│           g(#1)           │                                                                                                                                                 
│__internal_decompress_integ│                                                                                                                                                 
│    ral_bigint(#2, 1992)   │                                                                                                                                                 
│             #3            │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│       HASH_GROUP_BY       │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│             #0            │                                                                                                                                                 
│             #1            │                                                                                                                                                 
│             #2            │                                                                                                                                                 
│          sum(#3)          │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│        supp_nation        │                                                                                                                                                 
│        cust_nation        │                                                                                                                                                 
│           l_year          │                                                                                                                                                 
│           volume          │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│__internal_compress_string_│                                                                                                                                                 
│        hugeint(#0)        │                                                                                                                                                 
│__internal_compress_string_│                                                                                                                                                 
│        hugeint(#1)        │                                                                                                                                                 
│__internal_compress_integra│                                                                                                                                                 
│    l_utinyint(#2, 1992)   │                                                                                                                                                 
│             #3            │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│        supp_nation        │                                                                                                                                                 
│        cust_nation        │                                                                                                                                                 
│      year(l_shipdate)     │                                                                                                                                                 
│           volume          │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│             #2            │                                                                                                                                                 
│             #3            │                                                                                                                                                 
│             #4            │                                                                                                                                                 
│             #6            │                                                                                                                                                 
│             #8            │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│           FILTER          │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│ (((n_name = 'FRANCE') AND │                                                                                                                                                 
│ (n_name = 'GERMANY')) OR (│                                                                                                                                                 
│ (n_name = 'GERMANY') AND  │                                                                                                                                                 
│   (n_name = 'FRANCE')))   │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│         EC: 717564        │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         HASH_JOIN         │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│           INNER           │                                                                                                                                                 
│   l_suppkey = s_suppkey   │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├─────────────────────────────────────────────────────────────────────────────────────────────────────┐                                           
│        Build Min: 1       │                                                                                                     │                                           
│      Build Max: 10000     │                                                                                                     │                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                     │                                           
│         EC: 717564        │                                                                                                     │                                           
└─────────────┬─────────────┘                                                                                                     │                                                                        
┌─────────────┴─────────────┐                                                                                       ┌─────────────┴─────────────┐                             
│         HASH_JOIN         │                                                                                       │         HASH_JOIN         │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│           INNER           │                                                                                       │           INNER           │                             
│  l_orderkey = o_orderkey  │                                                                                       │ s_nationkey = n_nationkey │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐                                                                        │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐              
│         EC: 723735        │              │                                                                        │        Build Min: 0       │              │              
│                           │              │                                                                        │       Build Max: 24       │              │              
│                           │              │                                                                        │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              
│                           │              │                                                                        │         EC: 10000         │              │              
└─────────────┬─────────────┘              │                                                                        └─────────────┬─────────────┘              │                                           
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
│         SEQ_SCAN          ││         HASH_JOIN         │                                                          │         SEQ_SCAN          ││         SEQ_SCAN          │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│          lineitem         ││           INNER           │                                                          │          supplier         ││           nation          │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   o_custkey = c_custkey   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│         l_suppkey         ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │         s_suppkey         ││        n_nationkey        │
│         l_orderkey        ││        Build Min: 1       │                                                          │        s_nationkey        ││           n_name          │
│         l_shipdate        ││     Build Max: 149999     │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│      l_extendedprice      ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │         EC: 10000         ││           EC: 25          │
│         l_discount        ││         EC: 904486        ├──────────────┐                                           │                           ││                           │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │              │                                           │                           ││                           │
│ Filters: l_shipdate>='1995││                           │              │                                           │                           ││                           │
│-01-01'::DATE AND l_sh...  ││                           │              │                                           │                           ││                           │
│  <='1996-12-31'::DATE AND ││                           │              │                                           │                           ││                           │
│   l_shipdate IS NOT NULL  ││                           │              │                                           │                           ││                           │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │              │                                           │                           ││                           │
│        EC: 1200243        ││                           │              │                                           │                           ││                           │
└───────────────────────────┘└─────────────┬─────────────┘              │                                           └───────────────────────────┘└───────────────────────────┘                             
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                       
                             │         SEQ_SCAN          ││         HASH_JOIN         │                                                                                       
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
                             │           orders          ││           INNER           │                                                                                       
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││ c_nationkey = n_nationkey │                                                                                       
                             │         o_orderkey        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐                                                                        
                             │         o_custkey         ││         EC: 150000        │              │                                                                        
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │              │                                                                        
                             │        EC: 1500000        ││                           │              │                                                                        
                             └───────────────────────────┘└─────────────┬─────────────┘              │                                                                                                     
                                                          ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                          
                                                          │         SEQ_SCAN          ││         SEQ_SCAN          │                                                          
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                          │          customer         ││           nation          │                                                          
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                          │         c_custkey         ││        n_nationkey        │                                                          
                                                          │        c_nationkey        ││           n_name          │                                                          
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                          │ Filters: c_custkey<=149999││           EC: 25          │                                                          
                                                          │  AND c_custkey IS NOT NULL││                           │                                                          
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                                          
                                                          │         EC: 150000        ││                           │                                                          
                                                          └───────────────────────────┘└───────────────────────────┘                                                                                       

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

%%%%%%%%%%%%%%%% Running Query #  6  threads:  1
SELECT sum(l_extendedprice * l_discount) AS revenue FROM lineitem WHERE l_shipdate >= CAST('1994-01-01' AS date) AND l_shipdate < CAST('1995-01-01' AS date) AND l_discount BETWEEN 0.05 AND 0.07 AND l_quantity < 24;
Run:  None SELECT sum(l_extendedprice * l_discount) AS revenue FROM lineitem WHERE l_shipdate >= CAST('1994-01-01' AS date) AND l_shipdate < CAST('1995-01-01' AS date) AND l_discount BETWEEN 0.05 AND 0.07 AND l_quantity < 24;
Avg Time in sec:  0.07478430168703198  output size:  1
        revenue
0  1.231411e+08
{'name': 'Query', 'result': 0.073323, 'timing': 0.073323, 'cardinality': 0, 'extra-info': "SELECT sum(l_extendedprice * l_discount) AS revenue FROM lineitem WHERE l_shipdate >= CAST('1994-01-01' AS date) AND l_shipdate < CAST('1995-01-01' AS date) AND l_discount BETWEEN 0.05 AND 0.07 AND l_quantity < 24;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 8e-06, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'UNGROUPED_AGGREGATE', 'timing': 0.000971, 'cardinality': 1, 'extra_info': 'sum_no_overflow(#0)', 'children': [{'name': 'PROJECTION', 'timing': 0.004011, 'cardinality': 114160, 'extra_info': '(l_extendedprice * l_discount)\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.06536, 'cardinality': 114160, 'extra_info': "lineitem\n[INFOSEPARATOR]\nl_discount\nl_extendedprice\n[INFOSEPARATOR]\nFilters: l_shipdate>='1994-01-01'::DATE AND l_shipdate<'1995-01-01'::DATE AND l_shipdate IS NOT NULL\nl_discount>=0.05 AND l_discount<=0.07 AND l_discount IS NOT NULL\nl_quantity<24.00 AND l_quantity IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243", 'children': []}]}]}]}]}
X {'RESULT_COLLECTOR0': 8e-06, 'UNGROUPED_AGGREGATE1': 0.000971, 'PROJECTION2': 0.004011, 'SEQ_SCAN 3': 0.06536}
**** output size:  1
LINEAGE_5_SEQ_SCAN_0
SELECT sum(l_extendedprice * l_discount) AS revenue FROM lineitem WHERE l_shipdate >= CAST('1994-01-01' AS date) AND l_shipdate < CAST('1995-01-01' AS date) AND l_discount BETWEEN 0.05 AND 0.07 AND l_quantity < 24;
   query_id  ...                                               plan
0         5  ...  {"name": "UNGROUPED_AGGREGATE", "opid": "2", "...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               SELECT sum(l_extendedprice * l_discount) AS re...
size_bytes_max                                                 400016
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "UNGROUPED_AGGREGATE", "opid": "2", "...
Name: 0, dtype: object
{"name": "UNGROUPED_AGGREGATE", "opid": "2", "children": [{"name": "PROJECTION", "opid": "1", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_discount\nl_extendedprice\n[INFOSEPARATOR]\nFilters: l_shipdate>='1994-01-01'::DATE AND l_shipdate<'1995-01-01'::DATE AND l_shipdate IS NOT NULL\nl_discount>=0.05 AND l_discount<=0.07 AND l_discount IS NOT NULL\nl_quantity<24.00 AND l_quantity IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243"}],"table": "","extra": "(l_extendedprice * l_discount)\n"}],"table": "","extra": "sum_no_overflow(#0)"}
%%%%%%%%%%%%%%%% Running Query #  7  threads:  1
SELECT supp_nation, cust_nation, l_year, sum(volume) AS revenue FROM ( SELECT n1.n_name AS supp_nation, n2.n_name AS cust_nation, extract(year FROM l_shipdate) AS l_year, l_extendedprice * (1 - l_discount) AS volume FROM supplier, lineitem, orders, customer, nation n1, nation n2 WHERE s_suppkey = l_suppkey AND o_orderkey = l_orderkey AND c_custkey = o_custkey AND s_nationkey = n1.n_nationkey AND c_nationkey = n2.n_nationkey AND ((n1.n_name = 'FRANCE' AND n2.n_name = 'GERMANY') OR (n1.n_name = 'GERMANY' AND n2.n_name = 'FRANCE')) AND l_shipdate BETWEEN CAST('1995-01-01' AS date) AND CAST('1996-12-31' AS date)) AS shipping GROUP BY supp_nation, cust_nation, l_year ORDER BY supp_nation, cust_nation, l_year;
Run:  None SELECT supp_nation, cust_nation, l_year, sum(volume) AS revenue FROM ( SELECT n1.n_name AS supp_nation, n2.n_name AS cust_nation, extract(year FROM l_shipdate) AS l_year, l_extendedprice * (1 - l_discount) AS volume FROM supplier, lineitem, orders, customer, nation n1, nation n2 WHERE s_suppkey = l_suppkey AND o_orderkey = l_orderkey AND c_custkey = o_custkey AND s_nationkey = n1.n_nationkey AND c_nationkey = n2.n_nationkey AND ((n1.n_name = 'FRANCE' AND n2.n_name = 'GERMANY') OR (n1.n_name = 'GERMANY' AND n2.n_name = 'FRANCE')) AND l_shipdate BETWEEN CAST('1995-01-01' AS date) AND CAST('1996-12-31' AS date)) AS shipping GROUP BY supp_nation, cust_nation, l_year ORDER BY supp_nation, cust_nation, l_year;
Avg Time in sec:  0.6405165530741215  output size:  4
  supp_nation cust_nation  l_year       revenue
0      FRANCE     GERMANY    1995  5.463973e+07
1      FRANCE     GERMANY    1996  5.463308e+07
2     GERMANY      FRANCE    1995  5.253175e+07
3     GERMANY      FRANCE    1996  5.252055e+07
{'name': 'Query', 'result': 0.629823, 'timing': 0.629823, 'cardinality': 0, 'extra-info': "SELECT supp_nation, cust_nation, l_year, sum(volume) AS revenue FROM ( SELECT n1.n_name AS supp_nation, n2.n_name AS cust_nation, extract(year FROM l_shipdate) AS l_year, l_extendedprice * (1 - l_discount) AS volume FROM supplier, lineitem, orders, customer, nation n1, nation n2 WHERE s_suppkey = l_suppkey AND o_orderkey = l_orderkey AND c_custkey = o_custkey AND s_nationkey = n1.n_nationkey AND c_nationkey = n2.n_nationkey AND ((n1.n_name = 'FRANCE' AND n2.n_name = 'GERMANY') OR (n1.n_name = 'GERMANY' AND n2.n_name = 'FRANCE')) AND l_shipdate BETWEEN CAST('1995-01-01' AS date) AND CAST('1996-12-31' AS date)) AS shipping GROUP BY supp_nation, cust_nation, l_year ORDER BY supp_nation, cust_nation, l_year;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 7e-06, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 2e-06, 'cardinality': 4, 'extra_info': '__internal_decompress_string(#0)\n__internal_decompress_string(#1)\n__internal_decompress_integral_bigint(#2, 1992)\n#3\n', 'children': [{'name': 'ORDER_BY', 'timing': 3.2e-05, 'cardinality': 4, 'extra_info': 'ORDERS:\nshipping.supp_nation ASC\nshipping.cust_nation ASC\nshipping.l_year ASC', 'children': [{'name': 'PROJECTION', 'timing': 4e-06, 'cardinality': 4, 'extra_info': '__internal_compress_string_hugeint(#0)\n__internal_compress_string_hugeint(#1)\n__internal_compress_integral_utinyint(#2, 1992)\n#3\n', 'children': [{'name': 'PROJECTION', 'timing': 7e-06, 'cardinality': 4, 'extra_info': '__internal_decompress_string(#0)\n__internal_decompress_string(#1)\n__internal_decompress_integral_bigint(#2, 1992)\n#3\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.000985, 'cardinality': 4, 'extra_info': '#0\n#1\n#2\nsum(#3)', 'children': [{'name': 'PROJECTION', 'timing': 3e-06, 'cardinality': 5924, 'extra_info': 'supp_nation\ncust_nation\nl_year\nvolume\n', 'children': [{'name': 'PROJECTION', 'timing': 0.000153, 'cardinality': 5924, 'extra_info': '__internal_compress_string_hugeint(#0)\n__internal_compress_string_hugeint(#1)\n__internal_compress_integral_utinyint(#2, 1992)\n#3\n', 'children': [{'name': 'PROJECTION', 'timing': 0.000142, 'cardinality': 5924, 'extra_info': 'supp_nation\ncust_nation\nyear(l_shipdate)\nvolume\n', 'children': [{'name': 'PROJECTION', 'timing': 6e-06, 'cardinality': 5924, 'extra_info': '#2\n#3\n#4\n#6\n#8\n', 'children': [{'name': 'FILTER', 'timing': 0.06628, 'cardinality': 5924, 'extra_info': "(((n_name = 'FRANCE') AND (n_name = 'GERMANY')) OR ((n_name = 'GERMANY') AND (n_name = 'FRANCE')))\n[INFOSEPARATOR]\nEC: 717564", 'children': [{'name': 'HASH_JOIN', 'timing': 0.055264, 'cardinality': 1828450, 'extra_info': 'INNER\nl_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 717564\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.299332, 'cardinality': 1828450, 'extra_info': 'INNER\nl_orderkey = o_orderkey\n\n[INFOSEPARATOR]\nEC: 723735\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.050486, 'cardinality': 1828450, 'extra_info': "lineitem\n[INFOSEPARATOR]\nl_suppkey\nl_orderkey\nl_shipdate\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nFilters: l_shipdate>='1995-01-01'::DATE AND l_shipdate<='1996-12-31'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243", 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.037526, 'cardinality': 1500000, 'extra_info': 'INNER\no_custkey = c_custkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 149999\n\n[INFOSEPARATOR]\nEC: 904486\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.002513, 'cardinality': 1500000, 'extra_info': 'orders\n[INFOSEPARATOR]\no_orderkey\no_custkey\n[INFOSEPARATOR]\nEC: 1500000', 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.005037, 'cardinality': 149999, 'extra_info': 'INNER\nc_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nEC: 150000\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.000877, 'cardinality': 149999, 'extra_info': 'customer\n[INFOSEPARATOR]\nc_custkey\nc_nationkey\n[INFOSEPARATOR]\nFilters: c_custkey<=149999 AND c_custkey IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 150000', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 8e-06, 'cardinality': 25, 'extra_info': 'nation\n[INFOSEPARATOR]\nn_nationkey\nn_name\n[INFOSEPARATOR]\nEC: 25', 'children': []}]}]}]}, {'name': 'HASH_JOIN', 'timing': 0.00022, 'cardinality': 10000, 'extra_info': 'INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 10000\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 2.9e-05, 'cardinality': 10000, 'extra_info': 'supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\n[INFOSEPARATOR]\nEC: 10000', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 1.6e-05, 'cardinality': 25, 'extra_info': 'nation\n[INFOSEPARATOR]\nn_nationkey\nn_name\n[INFOSEPARATOR]\nEC: 25', 'children': []}]}]}]}]}]}]}]}]}]}]}]}]}]}]}
compressed filter_log_size: 53823
compressed filter_log_buffer_size: 23696
compressed limit_offset_size: 896
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 370381
compressed perfect_full_scan_ht_log_buffer_size: 368333
compressed perfect_probe_ht_log_size: 7498130
compressed perfect_probe_ht_log_buffer_size: 7403312
compressed row_group_log_size: 801037
compressed row_group_log_buffer_size: 750855
compressed scatter_log_size: 10072
compressed scatter_log_buffer_size: 9031
compressed scatter_sel_log_size: 6860185
compressed scatter_sel_log_buffer_size: 6848643
compressed gather_log_size: 896
compressed gather_log_buffer_size: 0
compressed combine_log_size: 896
compressed combine_log_buffer_size: 0
compressed finalize_states_log_size: 1105
compressed finalize_states_log_buffer_size: 65
compressed join_gather_log_size: 7641854
compressed join_gather_log_buffer_size: 7490522
compressed reorder_log_size: 1424
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 896
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 896
compressed nlj_log_buffer_size: 0
compressed total_size: 23242491
compressed total_buffer_size: 22894457
compressed total_element_size: 348034

Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                                                                                                                                                                                                           
│         PROJECTION        │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│__internal_decompress_integ│                                                                                                                                                                                                           
│    ral_bigint(#0, 1992)   │                                                                                                                                                                                                           
│             #1            │                                                                                                                                                                                                           
└─────────────┬─────────────┘                                                                                                                                                                                                                                        
┌─────────────┴─────────────┐                                                                                                                                                                                                           
│          ORDER_BY         │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│          ORDERS:          │                                                                                                                                                                                                           
│   all_nations.o_year ASC  │                                                                                                                                                                                                           
└─────────────┬─────────────┘                                                                                                                                                                                                                                        
┌─────────────┴─────────────┐                                                                                                                                                                                                           
│         PROJECTION        │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│__internal_compress_integra│                                                                                                                                                                                                           
│    l_utinyint(#0, 1992)   │                                                                                                                                                                                                           
│             #1            │                                                                                                                                                                                                           
└─────────────┬─────────────┘                                                                                                                                                                                                                                        
┌─────────────┴─────────────┐                                                                                                                                                                                                           
│         PROJECTION        │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│           o_year          │                                                                                                                                                                                                           
│         mkt_share         │                                                                                                                                                                                                           
└─────────────┬─────────────┘                                                                                                                                                                                                                                        
┌─────────────┴─────────────┐                                                                                                                                                                                                           
│         PROJECTION        │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│__internal_decompress_integ│                                                                                                                                                                                                           
│    ral_bigint(#0, 1992)   │                                                                                                                                                                                                           
│             #1            │                                                                                                                                                                                                           
│             #2            │                                                                                                                                                                                                           
└─────────────┬─────────────┘                                                                                                                                                                                                                                        
┌─────────────┴─────────────┐                                                                                                                                                                                                           
│   PERFECT_HASH_GROUP_BY   │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│             #0            │                                                                                                                                                                                                           
│          sum(#1)          │                                                                                                                                                                                                           
│          sum(#2)          │                                                                                                                                                                                                           
└─────────────┬─────────────┘                                                                                                                                                                                                                                        
┌─────────────┴─────────────┐                                                                                                                                                                                                           
│         PROJECTION        │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│           o_year          │                                                                                                                                                                                                           
│   CASE  WHEN ((nation =   │                                                                                                                                                                                                           
│'BRAZIL')) THEN (volum...  │                                                                                                                                                                                                           
│         .0000 END         │                                                                                                                                                                                                           
│           volume          │                                                                                                                                                                                                           
└─────────────┬─────────────┘                                                                                                                                                                                                                                        
┌─────────────┴─────────────┐                                                                                                                                                                                                           
│         PROJECTION        │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│__internal_compress_integra│                                                                                                                                                                                                           
│    l_utinyint(#0, 1992)   │                                                                                                                                                                                                           
│             #1            │                                                                                                                                                                                                           
│             #2            │                                                                                                                                                                                                           
└─────────────┬─────────────┘                                                                                                                                                                                                                                        
┌─────────────┴─────────────┐                                                                                                                                                                                                           
│         PROJECTION        │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│     year(o_orderdate)     │                                                                                                                                                                                                           
│           volume          │                                                                                                                                                                                                           
│           nation          │                                                                                                                                                                                                           
└─────────────┬─────────────┘                                                                                                                                                                                                                                        
┌─────────────┴─────────────┐                                                                                                                                                                                                           
│         HASH_JOIN         │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│           INNER           │                                                                                                                                                                                                           
│ s_nationkey = n_nationkey │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐              
│        Build Min: 0       │                                                                                                                                                                                            │              
│       Build Max: 24       │                                                                                                                                                                                            │              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                            │              
│          EC: 508          │                                                                                                                                                                                            │              
└─────────────┬─────────────┘                                                                                                                                                                                            │                                           
┌─────────────┴─────────────┐                                                                                                                                                                              ┌─────────────┴─────────────┐
│         HASH_JOIN         │                                                                                                                                                                              │         SEQ_SCAN          │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│           INNER           │                                                                                                                                                                              │           nation          │
│   s_suppkey = l_suppkey   │                                                                                                                                                                              │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐                                                                                                                                                               │        n_nationkey        │
│        Build Min: 1       │              │                                                                                                                                                               │           n_name          │
│      Build Max: 10000     │              │                                                                                                                                                               │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                                                                                                                                               │           EC: 25          │
│          EC: 508          │              │                                                                                                                                                               │                           │
└─────────────┬─────────────┘              │                                                                                                                                                               └───────────────────────────┘                             
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                                                                                                              
│         SEQ_SCAN          ││         HASH_JOIN         │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│          supplier         ││           INNER           │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││ c_nationkey = n_nationkey │                                                                                                                                                                              
│         s_suppkey         ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├─────────────────────────────────────────────────────────────────────────────────────────────────────┐                                                                        
│        s_nationkey        ││        Build Min: 0       │                                                                                                     │                                                                        
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││       Build Max: 24       │                                                                                                     │                                                                        
│         EC: 10000         ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                     │                                                                        
│                           ││          EC: 512          │                                                                                                     │                                                                        
└───────────────────────────┘└─────────────┬─────────────┘                                                                                                     │                                                                                                     
                             ┌─────────────┴─────────────┐                                                                                       ┌─────────────┴─────────────┐                                                          
                             │         HASH_JOIN         │                                                                                       │         HASH_JOIN         │                                                          
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                             │           INNER           │                                                                                       │           INNER           │                                                          
                             │   c_custkey = o_custkey   │                                                                                       │ n_regionkey = r_regionkey │                                                          
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐                                                                        │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐                                           
                             │        Build Min: 1       │              │                                                                        │        Build Min: 0       │              │                                           
                             │     Build Max: 149999     │              │                                                                        │        Build Max: 4       │              │                                           
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                                                        │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                           
                             │          EC: 2562         │              │                                                                        │           EC: 5           │              │                                           
                             └─────────────┬─────────────┘              │                                                                        └─────────────┬─────────────┘              │                                                                        
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             
                             │         SEQ_SCAN          ││         HASH_JOIN         │                                                          │         SEQ_SCAN          ││         SEQ_SCAN          │                             
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                             │          customer         ││           INNER           │                                                          │           nation          ││           region          │                             
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││  o_orderkey = l_orderkey  │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                             │         c_custkey         ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │        n_nationkey        ││        r_regionkey        │                             
                             │        c_nationkey        ││          EC: 4249         ├──────────────┐                                           │        n_regionkey        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │              │                                           │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││ Filters: r_name='AMERICA' │                             
                             │ Filters: c_custkey<=149999││                           │              │                                           │           EC: 25          ││   AND r_name IS NOT NULL  │                             
                             │  AND c_custkey IS NOT NULL││                           │              │                                           │                           ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │              │                                           │                           ││           EC: 1           │                             
                             │         EC: 150000        ││                           │              │                                           │                           ││                           │                             
                             └───────────────────────────┘└─────────────┬─────────────┘              │                                           └───────────────────────────┘└───────────────────────────┘                                                          
                                                          ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                                                    
                                                          │         SEQ_SCAN          ││         HASH_JOIN         │                                                                                                                    
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
                                                          │           orders          ││           INNER           │                                                                                                                    
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   l_partkey = p_partkey   │                                                                                                                    
                                                          │         o_orderkey        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
                                                          │         o_custkey         ││        Build Min: 1       │                                                                                                                    
                                                          │        o_orderdate        ││     Build Max: 200000     │                                                                                                                    
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐                                                                                                     
                                                          │Filters: o_orderdate>='1995││         EC: 21246         │              │                                                                                                     
                                                          │     -01-01'::DATE AND     ││                           │              │                                                                                                     
                                                          │ o_orderdate<='1996-12...  ││                           │              │                                                                                                     
                                                          │   o_orderdate IS NOT NULL ││                           │              │                                                                                                     
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │              │                                                                                                     
                                                          │         EC: 300000        ││                           │              │                                                                                                     
                                                          └───────────────────────────┘└─────────────┬─────────────┘              │                                                                                                                                  
                                                                                       ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                       
                                                                                       │         SEQ_SCAN          ││         SEQ_SCAN          │                                                                                       
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
                                                                                       │          lineitem         ││            part           │                                                                                       
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
                                                                                       │         l_partkey         ││         p_partkey         │                                                                                       
                                                                                       │         l_suppkey         ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
                                                                                       │         l_orderkey        ││  Filters: p_type='ECONOMY │                                                                                       
                                                                                       │      l_extendedprice      ││ ANODIZED STEEL' AND p...  │                                                                                       
                                                                                       │         l_discount        ││          NOT NULL         │                                                                                       
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
                                                                                       │        EC: 6001215        ││          EC: 1325         │                                                                                       
                                                                                       └───────────────────────────┘└───────────────────────────┘                                                                                                                    

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

X {'RESULT_COLLECTOR0': 7e-06, 'PROJECTION1': 2e-06, 'ORDER_BY2': 3.2e-05, 'PROJECTION3': 4e-06, 'PROJECTION4': 7e-06, 'HASH_GROUP_BY5': 0.000985, 'PROJECTION6': 3e-06, 'PROJECTION7': 0.000153, 'PROJECTION8': 0.000142, 'PROJECTION9': 6e-06, 'FILTER10': 0.06628, 'HASH_JOIN11': 0.055264, 'HASH_JOIN12': 0.299332, 'SEQ_SCAN 13': 0.050486, 'HASH_JOIN14': 0.037526, 'SEQ_SCAN 15': 0.002513, 'HASH_JOIN16': 0.005037, 'SEQ_SCAN 17': 0.000877, 'SEQ_SCAN 18': 8e-06, 'HASH_JOIN19': 0.00022, 'SEQ_SCAN 20': 2.9e-05, 'SEQ_SCAN 21': 1.6e-05}
**** output size:  4
LINEAGE_5_FILTER_11
LINEAGE_5_HASH_GROUP_BY_16
LINEAGE_5_HASH_JOIN_10
LINEAGE_5_HASH_JOIN_4
LINEAGE_5_HASH_JOIN_5
LINEAGE_5_HASH_JOIN_6
LINEAGE_5_HASH_JOIN_9
LINEAGE_5_ORDER_BY_19
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_1
LINEAGE_5_SEQ_SCAN_2
LINEAGE_5_SEQ_SCAN_3
LINEAGE_5_SEQ_SCAN_7
LINEAGE_5_SEQ_SCAN_8
SELECT supp_nation, cust_nation, l_year, sum(volume) AS revenue FROM ( SELECT n1.n_name AS supp_nation, n2.n_name AS cust_nation, extract(year FROM l_shipdate) AS l_year, l_extendedprice * (1 - l_discount) AS volume FROM supplier, lineitem, orders, customer, nation n1, nation n2 WHERE s_suppkey = l_suppkey AND o_orderkey = l_orderkey AND c_custkey = o_custkey AND s_nationkey = n1.n_nationkey AND c_nationkey = n2.n_nationkey AND ((n1.n_name = 'FRANCE' AND n2.n_name = 'GERMANY') OR (n1.n_name = 'GERMANY' AND n2.n_name = 'FRANCE')) AND l_shipdate BETWEEN CAST('1995-01-01' AS date) AND CAST('1996-12-31' AS date)) AS shipping GROUP BY supp_nation, cust_nation, l_year ORDER BY supp_nation, cust_nation, l_year;
   query_id  ...                                               plan
0         5  ...  {"name": "PROJECTION", "opid": "20", "children...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               SELECT supp_nation, cust_nation, l_year, sum(v...
size_bytes_max                                               23242491
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "PROJECTION", "opid": "20", "children...
Name: 0, dtype: object
{"name": "PROJECTION", "opid": "20", "children": [{"name": "ORDER_BY", "opid": "19", "children": [{"name": "PROJECTION", "opid": "18", "children": [{"name": "PROJECTION", "opid": "17", "children": [{"name": "HASH_GROUP_BY", "opid": "16", "children": [{"name": "PROJECTION", "opid": "15", "children": [{"name": "PROJECTION", "opid": "14", "children": [{"name": "PROJECTION", "opid": "13", "children": [{"name": "PROJECTION", "opid": "12", "children": [{"name": "FILTER", "opid": "11", "children": [{"name": "HASH_JOIN", "opid": "10", "children": [{"name": "HASH_JOIN", "opid": "6", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_suppkey\nl_orderkey\nl_shipdate\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nFilters: l_shipdate>='1995-01-01'::DATE AND l_shipdate<='1996-12-31'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243"},{"name": "HASH_JOIN", "opid": "5", "children": [{"name": "SEQ_SCAN ", "opid": "1", "children": [],"table": "orders","extra": "orders\n[INFOSEPARATOR]\no_orderkey\no_custkey\n[INFOSEPARATOR]\nEC: 1500000"},{"name": "HASH_JOIN", "opid": "4", "children": [{"name": "SEQ_SCAN ", "opid": "2", "children": [],"table": "customer","extra": "customer\n[INFOSEPARATOR]\nc_custkey\nc_nationkey\n[INFOSEPARATOR]\nFilters: c_custkey<=149999 AND c_custkey IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 150000"},{"name": "SEQ_SCAN ", "opid": "3", "children": [],"table": "nation","extra": "nation\n[INFOSEPARATOR]\nn_nationkey\nn_name\n[INFOSEPARATOR]\nEC: 25"}],"table": "","extra": "INNER\nc_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nEC: 150000\n"}],"table": "","extra": "INNER\no_custkey = c_custkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 149999\n\n[INFOSEPARATOR]\nEC: 904486\n"}],"table": "","extra": "INNER\nl_orderkey = o_orderkey\n\n[INFOSEPARATOR]\nEC: 723735\n"},{"name": "HASH_JOIN", "opid": "9", "children": [{"name": "SEQ_SCAN ", "opid": "7", "children": [],"table": "supplier","extra": "supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\n[INFOSEPARATOR]\nEC: 10000"},{"name": "SEQ_SCAN ", "opid": "8", "children": [],"table": "nation","extra": "nation\n[INFOSEPARATOR]\nn_nationkey\nn_name\n[INFOSEPARATOR]\nEC: 25"}],"table": "","extra": "INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 10000\n"}],"table": "","extra": "INNER\nl_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 717564\n"}],"table": "","extra": "(((n_name = 'FRANCE') AND (n_name = 'GERMANY')) OR ((n_name = 'GERMANY') AND (n_name = 'FRANCE')))\n[INFOSEPARATOR]\nEC: 717564"}],"table": "","extra": "#2\n#3\n#4\n#6\n#8\n"}],"table": "","extra": "supp_nation\ncust_nation\nyear(l_shipdate)\nvolume\n"}],"table": "","extra": "__internal_compress_string_hugeint(#0)\n__internal_compress_string_hugeint(#1)\n__internal_compress_integral_utinyint(#2, 1992)\n#3\n"}],"table": "","extra": "supp_nation\ncust_nation\nl_year\nvolume\n"}],"table": "","extra": "#0\n#1\n#2\nsum(#3)"}],"table": "","extra": "__internal_decompress_string(#0)\n__internal_decompress_string(#1)\n__internal_decompress_integral_bigint(#2, 1992)\n#3\n"}],"table": "","extra": "__internal_compress_string_hugeint(#0)\n__internal_compress_string_hugeint(#1)\n__internal_compress_integral_utinyint(#2, 1992)\n#3\n"}],"table": "","extra": "ORDERS:\nshipping.supp_nation ASC\nshipping.cust_nation ASC\nshipping.l_year ASC"}],"table": "","extra": "__internal_decompress_string(#0)\n__internal_decompress_string(#1)\n__internal_decompress_integral_bigint(#2, 1992)\n#3\n"}
%%%%%%%%%%%%%%%% Running Query #  8  threads:  1
SELECT o_year, sum( CASE WHEN nation = 'BRAZIL' THEN volume ELSE 0 END) / sum(volume) AS mkt_share FROM ( SELECT extract(year FROM o_orderdate) AS o_year, l_extendedprice * (1 - l_discount) AS volume, n2.n_name AS nation FROM part, supplier, lineitem, orders, customer, nation n1, nation n2, region WHERE p_partkey = l_partkey AND s_suppkey = l_suppkey AND l_orderkey = o_orderkey AND o_custkey = c_custkey AND c_nationkey = n1.n_nationkey AND n1.n_regionkey = r_regionkey AND r_name = 'AMERICA' AND s_nationkey = n2.n_nationkey AND o_orderdate BETWEEN CAST('1995-01-01' AS date) AND CAST('1996-12-31' AS date) AND p_type = 'ECONOMY ANODIZED STEEL') AS all_nations GROUP BY o_year ORDER BY o_year;
Run:  None SELECT o_year, sum( CASE WHEN nation = 'BRAZIL' THEN volume ELSE 0 END) / sum(volume) AS mkt_share FROM ( SELECT extract(year FROM o_orderdate) AS o_year, l_extendedprice * (1 - l_discount) AS volume, n2.n_name AS nation FROM part, supplier, lineitem, orders, customer, nation n1, nation n2, region WHERE p_partkey = l_partkey AND s_suppkey = l_suppkey AND l_orderkey = o_orderkey AND o_custkey = c_custkey AND c_nationkey = n1.n_nationkey AND n1.n_regionkey = r_regionkey AND r_name = 'AMERICA' AND s_nationkey = n2.n_nationkey AND o_orderdate BETWEEN CAST('1995-01-01' AS date) AND CAST('1996-12-31' AS date) AND p_type = 'ECONOMY ANODIZED STEEL') AS all_nations GROUP BY o_year ORDER BY o_year;
Avg Time in sec:  0.15271367179229856  output size:  2
   o_year  mkt_share
0    1995   0.034436
1    1996   0.041486
{'name': 'Query', 'result': 0.14852, 'timing': 0.14852, 'cardinality': 0, 'extra-info': "SELECT o_year, sum( CASE WHEN nation = 'BRAZIL' THEN volume ELSE 0 END) / sum(volume) AS mkt_share FROM ( SELECT extract(year FROM o_orderdate) AS o_year, l_extendedprice * (1 - l_discount) AS volume, n2.n_name AS nation FROM part, supplier, lineitem, orders, customer, nation n1, nation n2, region WHERE p_partkey = l_partkey AND s_suppkey = l_suppkey AND l_orderkey = o_orderkey AND o_custkey = c_custkey AND c_nationkey = n1.n_nationkey AND n1.n_regionkey = r_regionkey AND r_name = 'AMERICA' AND s_nationkey = n2.n_nationkey AND o_orderdate BETWEEN CAST('1995-01-01' AS date) AND CAST('1996-12-31' AS date) AND p_type = 'ECONOMY ANODIZED STEEL') AS all_nations GROUP BY o_year ORDER BY o_year;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 3e-06, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 1e-06, 'cardinality': 2, 'extra_info': '__internal_decompress_integral_bigint(#0, 1992)\n#1\n', 'children': [{'name': 'ORDER_BY', 'timing': 2.4e-05, 'cardinality': 2, 'extra_info': 'ORDERS:\nall_nations.o_year ASC', 'children': [{'name': 'PROJECTION', 'timing': 1e-06, 'cardinality': 2, 'extra_info': '__internal_compress_integral_utinyint(#0, 1992)\n#1\n', 'children': [{'name': 'PROJECTION', 'timing': 5e-06, 'cardinality': 2, 'extra_info': 'o_year\nmkt_share\n', 'children': [{'name': 'PROJECTION', 'timing': 2e-06, 'cardinality': 2, 'extra_info': '__internal_decompress_integral_bigint(#0, 1992)\n#1\n#2\n', 'children': [{'name': 'PERFECT_HASH_GROUP_BY', 'timing': 6.7e-05, 'cardinality': 2, 'extra_info': '#0\nsum(#1)\nsum(#2)', 'children': [{'name': 'PROJECTION', 'timing': 3.8e-05, 'cardinality': 2603, 'extra_info': "o_year\nCASE  WHEN ((nation = 'BRAZIL')) THEN (volume) ELSE 0.0000 END\nvolume\n", 'children': [{'name': 'PROJECTION', 'timing': 1.1e-05, 'cardinality': 2603, 'extra_info': '__internal_compress_integral_utinyint(#0, 1992)\n#1\n#2\n', 'children': [{'name': 'PROJECTION', 'timing': 5.7e-05, 'cardinality': 2603, 'extra_info': 'year(o_orderdate)\nvolume\nnation\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.000153, 'cardinality': 2603, 'extra_info': 'INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 508\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.000702, 'cardinality': 2603, 'extra_info': 'INNER\ns_suppkey = l_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 508\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 4.1e-05, 'cardinality': 10000, 'extra_info': 'supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\n[INFOSEPARATOR]\nEC: 10000', 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.000764, 'cardinality': 2603, 'extra_info': 'INNER\nc_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 512\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.005288, 'cardinality': 13389, 'extra_info': 'INNER\nc_custkey = o_custkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 149999\n\n[INFOSEPARATOR]\nEC: 2562\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.001103, 'cardinality': 149999, 'extra_info': 'customer\n[INFOSEPARATOR]\nc_custkey\nc_nationkey\n[INFOSEPARATOR]\nFilters: c_custkey<=149999 AND c_custkey IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 150000', 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.025762, 'cardinality': 13389, 'extra_info': 'INNER\no_orderkey = l_orderkey\n\n[INFOSEPARATOR]\nEC: 4249\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.017088, 'cardinality': 457263, 'extra_info': "orders\n[INFOSEPARATOR]\no_orderkey\no_custkey\no_orderdate\n[INFOSEPARATOR]\nFilters: o_orderdate>='1995-01-01'::DATE AND o_orderdate<='1996-12-31'::DATE AND o_orderdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 300000", 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.061538, 'cardinality': 43693, 'extra_info': 'INNER\nl_partkey = p_partkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 21246\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.016573, 'cardinality': 6001215, 'extra_info': 'lineitem\n[INFOSEPARATOR]\nl_partkey\nl_suppkey\nl_orderkey\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nEC: 6001215', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 0.005595, 'cardinality': 1451, 'extra_info': "part\n[INFOSEPARATOR]\np_partkey\n[INFOSEPARATOR]\nFilters: p_type='ECONOMY ANODIZED STEEL' AND p_type IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1325", 'children': []}]}]}]}, {'name': 'HASH_JOIN', 'timing': 3.1e-05, 'cardinality': 5, 'extra_info': 'INNER\nn_regionkey = r_regionkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 4\n\n[INFOSEPARATOR]\nEC: 5\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 1e-05, 'cardinality': 25, 'extra_info': 'nation\n[INFOSEPARATOR]\nn_nationkey\nn_regionkey\n[INFOSEPARATOR]\nEC: 25', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 1.5e-05, 'cardinality': 1, 'extra_info': "region\n[INFOSEPARATOR]\nr_regionkey\n[INFOSEPARATOR]\nFilters: r_name='AMERICA' AND r_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1", 'children': []}]}]}]}, {'name': 'SEQ_SCAN ', 'timing': 1.9e-05, 'cardinality': 25, 'extra_info': 'nation\n[INFOSEPARATOR]\nn_nationkey\nn_name\n[INFOSEPARATOR]\nEC: 25', 'children': []}]}]}]}]}]}]}]}]}]}]}]}]}
compressed filter_log_size: 1040
compressed filter_log_buffer_size: 0
compressed limit_offset_size: 1040
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 7317
compressed perfect_full_scan_ht_log_buffer_size: 4741
compressed perfect_probe_ht_log_size: 423859
compressed perfect_probe_ht_log_buffer_size: 376706
compressed row_group_log_size: 231005
compressed row_group_log_buffer_size: 194577
compressed scatter_log_size: 3710
compressed scatter_log_buffer_size: 2485
compressed scatter_sel_log_size: 224569
compressed scatter_sel_log_buffer_size: 220680
compressed gather_log_size: 1040
compressed gather_log_buffer_size: 0
compressed combine_log_size: 1216
compressed combine_log_buffer_size: 32
compressed finalize_states_log_size: 1200
compressed finalize_states_log_buffer_size: 16
compressed join_gather_log_size: 263373
compressed join_gather_log_buffer_size: 234763
compressed reorder_log_size: 1640
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 1040
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 1040
compressed nlj_log_buffer_size: 0
compressed total_size: 1163089
compressed total_buffer_size: 1034000
compressed total_element_size: 129089

Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│__internal_decompress_strin│                                                                                                                                                 
│           g(#0)           │                                                                                                                                                 
│__internal_decompress_integ│                                                                                                                                                 
│    ral_bigint(#1, 1992)   │                                                                                                                                                 
│             #2            │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│          ORDER_BY         │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│          ORDERS:          │                                                                                                                                                 
│     profit.nation ASC     │                                                                                                                                                 
│     profit.o_year DESC    │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│__internal_compress_string_│                                                                                                                                                 
│        hugeint(#0)        │                                                                                                                                                 
│__internal_compress_integra│                                                                                                                                                 
│    l_utinyint(#1, 1992)   │                                                                                                                                                 
│             #2            │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│__internal_decompress_strin│                                                                                                                                                 
│           g(#0)           │                                                                                                                                                 
│__internal_decompress_integ│                                                                                                                                                 
│    ral_bigint(#1, 1992)   │                                                                                                                                                 
│             #2            │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│       HASH_GROUP_BY       │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│             #0            │                                                                                                                                                 
│             #1            │                                                                                                                                                 
│          sum(#2)          │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│           nation          │                                                                                                                                                 
│           o_year          │                                                                                                                                                 
│           amount          │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│__internal_compress_string_│                                                                                                                                                 
│        hugeint(#0)        │                                                                                                                                                 
│__internal_compress_integra│                                                                                                                                                 
│    l_utinyint(#1, 1992)   │                                                                                                                                                 
│             #2            │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│           nation          │                                                                                                                                                 
│     year(o_orderdate)     │                                                                                                                                                 
│           amount          │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         HASH_JOIN         │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│           INNER           │                                                                                                                                                 
│  o_orderkey = l_orderkey  ├──────────────┐                                                                                                                                  
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                                                                                                                  
│        EC: 1191610        │              │                                                                                                                                  
└─────────────┬─────────────┘              │                                                                                                                                                               
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                                                    
│         SEQ_SCAN          ││         HASH_JOIN         │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│           orders          ││           INNER           │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   l_suppkey = ps_suppkey  │                                                                                                                    
│         o_orderkey        ││   l_partkey = ps_partkey  ├──────────────┐                                                                                                     
│        o_orderdate        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                                                                                     
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││        EC: 1191610        │              │                                                                                                     
│        EC: 1500000        ││                           │              │                                                                                                     
└───────────────────────────┘└─────────────┬─────────────┘              │                                                                                                                                  
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                       
                             │         SEQ_SCAN          ││         HASH_JOIN         │                                                                                       
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
                             │          lineitem         ││           INNER           │                                                                                       
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ps_suppkey = s_suppkey  │                                                                                       
                             │         l_suppkey         ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
                             │         l_partkey         ││        Build Min: 1       │                                                                                       
                             │         l_orderkey        ││      Build Max: 10000     ├───────────────────────────────────────────┐                                           
                             │      l_extendedprice      ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                           │                                           
                             │         l_discount        ││         EC: 74312         │                                           │                                           
                             │         l_quantity        ││                           │                                           │                                           
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                           │                                           
                             │        EC: 6001215        ││                           │                                           │                                           
                             └───────────────────────────┘└─────────────┬─────────────┘                                           │                                                                        
                                                          ┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐                             
                                                          │         HASH_JOIN         │                             │         HASH_JOIN         │                             
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                                                          │           INNER           │                             │           INNER           │                             
                                                          │   ps_partkey = p_partkey  │                             │ s_nationkey = n_nationkey │                             
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐              │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐              
                                                          │        Build Min: 1       │              │              │        Build Min: 0       │              │              
                                                          │     Build Max: 200000     │              │              │       Build Max: 24       │              │              
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              
                                                          │         EC: 85503         │              │              │         EC: 10000         │              │              
                                                          └─────────────┬─────────────┘              │              └─────────────┬─────────────┘              │                                           
                                                          ┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐
                                                          │         SEQ_SCAN          ││           FILTER          ││         SEQ_SCAN          ││         SEQ_SCAN          │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │          partsupp         ││ contains(p_name, 'green') ││          supplier         ││           nation          │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │         ps_suppkey        ││         EC: 40000         ││         s_suppkey         ││        n_nationkey        │
                                                          │         ps_partkey        ││                           ││        s_nationkey        ││           n_name          │
                                                          │       ps_supplycost       ││                           ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           ││         EC: 10000         ││           EC: 25          │
                                                          │         EC: 800000        ││                           ││                           ││                           │
                                                          └───────────────────────────┘└─────────────┬─────────────┘└───────────────────────────┘└───────────────────────────┘                             
                                                                                       ┌─────────────┴─────────────┐                                                          
                                                                                       │         SEQ_SCAN          │                                                          
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                                                       │            part           │                                                          
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                                                       │         p_partkey         │                                                          
                                                                                       │           p_name          │                                                          
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                                                       │         EC: 40000         │                                                          
                                                                                       └───────────────────────────┘                                                                                       

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

X {'RESULT_COLLECTOR0': 3e-06, 'PROJECTION1': 1e-06, 'ORDER_BY2': 2.4e-05, 'PROJECTION3': 1e-06, 'PROJECTION4': 5e-06, 'PROJECTION5': 2e-06, 'PERFECT_HASH_GROUP_BY6': 6.7e-05, 'PROJECTION7': 3.8e-05, 'PROJECTION8': 1.1e-05, 'PROJECTION9': 5.7e-05, 'HASH_JOIN10': 0.000153, 'HASH_JOIN11': 0.000702, 'SEQ_SCAN 12': 4.1e-05, 'HASH_JOIN13': 0.000764, 'HASH_JOIN14': 0.005288, 'SEQ_SCAN 15': 0.001103, 'HASH_JOIN16': 0.025762, 'SEQ_SCAN 17': 0.017088, 'HASH_JOIN18': 0.061538, 'SEQ_SCAN 19': 0.016573, 'SEQ_SCAN 20': 0.005595, 'HASH_JOIN21': 3.1e-05, 'SEQ_SCAN 22': 1e-05, 'SEQ_SCAN 23': 1.5e-05, 'SEQ_SCAN 24': 1.9e-05}
**** output size:  2
LINEAGE_5_HASH_JOIN_10
LINEAGE_5_HASH_JOIN_11
LINEAGE_5_HASH_JOIN_12
LINEAGE_5_HASH_JOIN_14
LINEAGE_5_HASH_JOIN_5
LINEAGE_5_HASH_JOIN_6
LINEAGE_5_HASH_JOIN_7
LINEAGE_5_ORDER_BY_22
LINEAGE_5_PERFECT_HASH_GROUP_BY_18
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_1
LINEAGE_5_SEQ_SCAN_13
LINEAGE_5_SEQ_SCAN_2
LINEAGE_5_SEQ_SCAN_3
LINEAGE_5_SEQ_SCAN_4
LINEAGE_5_SEQ_SCAN_8
LINEAGE_5_SEQ_SCAN_9
SELECT o_year, sum( CASE WHEN nation = 'BRAZIL' THEN volume ELSE 0 END) / sum(volume) AS mkt_share FROM ( SELECT extract(year FROM o_orderdate) AS o_year, l_extendedprice * (1 - l_discount) AS volume, n2.n_name AS nation FROM part, supplier, lineitem, orders, customer, nation n1, nation n2, region WHERE p_partkey = l_partkey AND s_suppkey = l_suppkey AND l_orderkey = o_orderkey AND o_custkey = c_custkey AND c_nationkey = n1.n_nationkey AND n1.n_regionkey = r_regionkey AND r_name = 'AMERICA' AND s_nationkey = n2.n_nationkey AND o_orderdate BETWEEN CAST('1995-01-01' AS date) AND CAST('1996-12-31' AS date) AND p_type = 'ECONOMY ANODIZED STEEL') AS all_nations GROUP BY o_year ORDER BY o_year;
   query_id  ...                                               plan
0         5  ...  {"name": "PROJECTION", "opid": "23", "children...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               SELECT o_year, sum( CASE WHEN nation = 'BRAZIL...
size_bytes_max                                                1163089
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "PROJECTION", "opid": "23", "children...
Name: 0, dtype: object
{"name": "PROJECTION", "opid": "23", "children": [{"name": "ORDER_BY", "opid": "22", "children": [{"name": "PROJECTION", "opid": "21", "children": [{"name": "PROJECTION", "opid": "20", "children": [{"name": "PROJECTION", "opid": "19", "children": [{"name": "PERFECT_HASH_GROUP_BY", "opid": "18", "children": [{"name": "PROJECTION", "opid": "17", "children": [{"name": "PROJECTION", "opid": "16", "children": [{"name": "PROJECTION", "opid": "15", "children": [{"name": "HASH_JOIN", "opid": "14", "children": [{"name": "HASH_JOIN", "opid": "12", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "supplier","extra": "supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\n[INFOSEPARATOR]\nEC: 10000"},{"name": "HASH_JOIN", "opid": "11", "children": [{"name": "HASH_JOIN", "opid": "7", "children": [{"name": "SEQ_SCAN ", "opid": "1", "children": [],"table": "customer","extra": "customer\n[INFOSEPARATOR]\nc_custkey\nc_nationkey\n[INFOSEPARATOR]\nFilters: c_custkey<=149999 AND c_custkey IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 150000"},{"name": "HASH_JOIN", "opid": "6", "children": [{"name": "SEQ_SCAN ", "opid": "2", "children": [],"table": "orders","extra": "orders\n[INFOSEPARATOR]\no_orderkey\no_custkey\no_orderdate\n[INFOSEPARATOR]\nFilters: o_orderdate>='1995-01-01'::DATE AND o_orderdate<='1996-12-31'::DATE AND o_orderdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 300000"},{"name": "HASH_JOIN", "opid": "5", "children": [{"name": "SEQ_SCAN ", "opid": "3", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_partkey\nl_suppkey\nl_orderkey\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nEC: 6001215"},{"name": "SEQ_SCAN ", "opid": "4", "children": [],"table": "part","extra": "part\n[INFOSEPARATOR]\np_partkey\n[INFOSEPARATOR]\nFilters: p_type='ECONOMY ANODIZED STEEL' AND p_type IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1325"}],"table": "","extra": "INNER\nl_partkey = p_partkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 21246\n"}],"table": "","extra": "INNER\no_orderkey = l_orderkey\n\n[INFOSEPARATOR]\nEC: 4249\n"}],"table": "","extra": "INNER\nc_custkey = o_custkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 149999\n\n[INFOSEPARATOR]\nEC: 2562\n"},{"name": "HASH_JOIN", "opid": "10", "children": [{"name": "SEQ_SCAN ", "opid": "8", "children": [],"table": "nation","extra": "nation\n[INFOSEPARATOR]\nn_nationkey\nn_regionkey\n[INFOSEPARATOR]\nEC: 25"},{"name": "SEQ_SCAN ", "opid": "9", "children": [],"table": "region","extra": "region\n[INFOSEPARATOR]\nr_regionkey\n[INFOSEPARATOR]\nFilters: r_name='AMERICA' AND r_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1"}],"table": "","extra": "INNER\nn_regionkey = r_regionkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 4\n\n[INFOSEPARATOR]\nEC: 5\n"}],"table": "","extra": "INNER\nc_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 512\n"}],"table": "","extra": "INNER\ns_suppkey = l_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 508\n"},{"name": "SEQ_SCAN ", "opid": "13", "children": [],"table": "nation","extra": "nation\n[INFOSEPARATOR]\nn_nationkey\nn_name\n[INFOSEPARATOR]\nEC: 25"}],"table": "","extra": "INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 508\n"}],"table": "","extra": "year(o_orderdate)\nvolume\nnation\n"}],"table": "","extra": "__internal_compress_integral_utinyint(#0, 1992)\n#1\n#2\n"}],"table": "","extra": "o_year\nCASE  WHEN ((nation = 'BRAZIL')) THEN (volume) ELSE 0.0000 END\nvolume\n"}],"table": "","extra": "#0\nsum(#1)\nsum(#2)"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1992)\n#1\n#2\n"}],"table": "","extra": "o_year\nmkt_share\n"}],"table": "","extra": "__internal_compress_integral_utinyint(#0, 1992)\n#1\n"}],"table": "","extra": "ORDERS:\nall_nations.o_year ASC"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1992)\n#1\n"}
%%%%%%%%%%%%%%%% Running Query #  9  threads:  1
SELECT nation, o_year, sum(amount) AS sum_profit FROM ( SELECT n_name AS nation, extract(year FROM o_orderdate) AS o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity AS amount FROM part, supplier, lineitem, partsupp, orders, nation WHERE s_suppkey = l_suppkey AND ps_suppkey = l_suppkey AND ps_partkey = l_partkey AND p_partkey = l_partkey AND o_orderkey = l_orderkey AND s_nationkey = n_nationkey AND p_name LIKE '%green%') AS profit GROUP BY nation, o_year ORDER BY nation, o_year DESC;
Run:  None SELECT nation, o_year, sum(amount) AS sum_profit FROM ( SELECT n_name AS nation, extract(year FROM o_orderdate) AS o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity AS amount FROM part, supplier, lineitem, partsupp, orders, nation WHERE s_suppkey = l_suppkey AND ps_suppkey = l_suppkey AND ps_partkey = l_partkey AND p_partkey = l_partkey AND o_orderkey = l_orderkey AND s_nationkey = n_nationkey AND p_name LIKE '%green%') AS profit GROUP BY nation, o_year ORDER BY nation, o_year DESC;
Avg Time in sec:  0.5213694931007922  output size:  175
      nation  o_year    sum_profit
0    ALGERIA    1998  2.713690e+07
1    ALGERIA    1997  4.861183e+07
2    ALGERIA    1996  4.828548e+07
3    ALGERIA    1995  4.440227e+07
4    ALGERIA    1994  4.869401e+07
..       ...     ...           ...
170  VIETNAM    1996  4.782460e+07
171  VIETNAM    1995  4.823514e+07
172  VIETNAM    1994  4.772926e+07
173  VIETNAM    1993  4.535268e+07
174  VIETNAM    1992  4.784636e+07

[175 rows x 3 columns]
{'name': 'Query', 'result': 0.511138, 'timing': 0.511138, 'cardinality': 0, 'extra-info': "SELECT nation, o_year, sum(amount) AS sum_profit FROM ( SELECT n_name AS nation, extract(year FROM o_orderdate) AS o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity AS amount FROM part, supplier, lineitem, partsupp, orders, nation WHERE s_suppkey = l_suppkey AND ps_suppkey = l_suppkey AND ps_partkey = l_partkey AND p_partkey = l_partkey AND o_orderkey = l_orderkey AND s_nationkey = n_nationkey AND p_name LIKE '%green%') AS profit GROUP BY nation, o_year ORDER BY nation, o_year DESC;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 1.4e-05, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 7e-06, 'cardinality': 175, 'extra_info': '__internal_decompress_string(#0)\n__internal_decompress_integral_bigint(#1, 1992)\n#2\n', 'children': [{'name': 'ORDER_BY', 'timing': 4.9e-05, 'cardinality': 175, 'extra_info': 'ORDERS:\nprofit.nation ASC\nprofit.o_year DESC', 'children': [{'name': 'PROJECTION', 'timing': 4e-06, 'cardinality': 175, 'extra_info': '__internal_compress_string_hugeint(#0)\n__internal_compress_integral_utinyint(#1, 1992)\n#2\n', 'children': [{'name': 'PROJECTION', 'timing': 7e-06, 'cardinality': 175, 'extra_info': '__internal_decompress_string(#0)\n__internal_decompress_integral_bigint(#1, 1992)\n#2\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.017915, 'cardinality': 175, 'extra_info': '#0\n#1\nsum(#2)', 'children': [{'name': 'PROJECTION', 'timing': 0.000528, 'cardinality': 319404, 'extra_info': 'nation\no_year\namount\n', 'children': [{'name': 'PROJECTION', 'timing': 0.005254, 'cardinality': 319404, 'extra_info': '__internal_compress_string_hugeint(#0)\n__internal_compress_integral_utinyint(#1, 1992)\n#2\n', 'children': [{'name': 'PROJECTION', 'timing': 0.010909, 'cardinality': 319404, 'extra_info': 'nation\nyear(o_orderdate)\namount\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.180003, 'cardinality': 319404, 'extra_info': 'INNER\no_orderkey = l_orderkey\n\n[INFOSEPARATOR]\nEC: 1191610\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.003129, 'cardinality': 1500000, 'extra_info': 'orders\n[INFOSEPARATOR]\no_orderkey\no_orderdate\n[INFOSEPARATOR]\nEC: 1500000', 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.211986, 'cardinality': 319404, 'extra_info': 'INNER\nl_suppkey = ps_suppkey\nl_partkey = ps_partkey\n\n[INFOSEPARATOR]\nEC: 1191610\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.018425, 'cardinality': 6001215, 'extra_info': 'lineitem\n[INFOSEPARATOR]\nl_suppkey\nl_partkey\nl_orderkey\nl_extendedprice\nl_discount\nl_quantity\n[INFOSEPARATOR]\nEC: 6001215', 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.004056, 'cardinality': 42656, 'extra_info': 'INNER\nps_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 74312\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.006506, 'cardinality': 42656, 'extra_info': 'INNER\nps_partkey = p_partkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 85503\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.001678, 'cardinality': 800000, 'extra_info': 'partsupp\n[INFOSEPARATOR]\nps_suppkey\nps_partkey\nps_supplycost\n[INFOSEPARATOR]\nEC: 800000', 'children': []}, {'name': 'FILTER', 'timing': 0.007263, 'cardinality': 10664, 'extra_info': "contains(p_name, 'green')\n[INFOSEPARATOR]\nEC: 40000", 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.005759, 'cardinality': 200000, 'extra_info': 'part\n[INFOSEPARATOR]\np_partkey\np_name\n[INFOSEPARATOR]\nEC: 40000', 'children': []}]}]}, {'name': 'HASH_JOIN', 'timing': 0.000174, 'cardinality': 10000, 'extra_info': 'INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 10000\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 2.9e-05, 'cardinality': 10000, 'extra_info': 'supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\n[INFOSEPARATOR]\nEC: 10000', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 1.4e-05, 'cardinality': 25, 'extra_info': 'nation\n[INFOSEPARATOR]\nn_nationkey\nn_name\n[INFOSEPARATOR]\nEC: 25', 'children': []}]}]}]}]}]}]}]}]}]}]}]}]}]}]}
compressed filter_log_size: 22274
compressed filter_log_buffer_size: 20249
compressed limit_offset_size: 864
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 53942
compressed perfect_full_scan_ht_log_buffer_size: 51926
compressed perfect_probe_ht_log_size: 223689
compressed perfect_probe_ht_log_buffer_size: 210750
compressed row_group_log_size: 32455
compressed row_group_log_buffer_size: 0
compressed scatter_log_size: 675801
compressed scatter_log_buffer_size: 667657
compressed scatter_sel_log_size: 1958300
compressed scatter_sel_log_buffer_size: 1915777
compressed gather_log_size: 864
compressed gather_log_buffer_size: 0
compressed combine_log_size: 864
compressed combine_log_buffer_size: 0
compressed finalize_states_log_size: 1094
compressed finalize_states_log_buffer_size: 86
compressed join_gather_log_size: 3879368
compressed join_gather_log_buffer_size: 3697177
compressed reorder_log_size: 1583
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 864
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 864
compressed nlj_log_buffer_size: 0
compressed total_size: 6852826
compressed total_buffer_size: 6563622
compressed total_element_size: 289204

Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                                                                                       
│      STREAMING_LIMIT      │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│__internal_decompress_integ│                                                                                       
│     ral_bigint(#0, 1)     │                                                                                       
│             #1            │                                                                                       
│             #2            │                                                                                       
│             #3            │                                                                                       
│__internal_decompress_strin│                                                                                       
│           g(#4)           │                                                                                       
│             #5            │                                                                                       
│__internal_decompress_strin│                                                                                       
│           g(#6)           │                                                                                       
│             #7            │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│          ORDER_BY         │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│          ORDERS:          │                                                                                       
│       sum((lineitem       │                                                                                       
│.l_extendedprice * (1 ...  │                                                                                       
│    .l_discount))) DESC    │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│__internal_compress_integra│                                                                                       
│     l_uinteger(#0, 1)     │                                                                                       
│             #1            │                                                                                       
│             #2            │                                                                                       
│             #3            │                                                                                       
│__internal_compress_string_│                                                                                       
│        hugeint(#4)        │                                                                                       
│             #5            │                                                                                       
│__internal_compress_string_│                                                                                       
│        hugeint(#6)        │                                                                                       
│             #7            │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│         c_custkey         │                                                                                       
│           c_name          │                                                                                       
│          revenue          │                                                                                       
│         c_acctbal         │                                                                                       
│           n_name          │                                                                                       
│         c_address         │                                                                                       
│          c_phone          │                                                                                       
│         c_comment         │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│__internal_decompress_integ│                                                                                       
│     ral_bigint(#0, 1)     │                                                                                       
│             #1            │                                                                                       
│             #2            │                                                                                       
│__internal_decompress_strin│                                                                                       
│           g(#3)           │                                                                                       
│__internal_decompress_strin│                                                                                       
│           g(#4)           │                                                                                       
│             #5            │                                                                                       
│             #6            │                                                                                       
│             #7            │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│       HASH_GROUP_BY       │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│             #0            │                                                                                       
│             #1            │                                                                                       
│             #2            │                                                                                       
│             #3            │                                                                                       
│             #4            │                                                                                       
│             #5            │                                                                                       
│             #6            │                                                                                       
│          sum(#7)          │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│         c_custkey         │                                                                                       
│           c_name          │                                                                                       
│         c_acctbal         │                                                                                       
│          c_phone          │                                                                                       
│           n_name          │                                                                                       
│         c_address         │                                                                                       
│         c_comment         │                                                                                       
│ (l_extendedprice * (1.00 -│                                                                                       
│        l_discount))       │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│__internal_compress_integra│                                                                                       
│     l_uinteger(#0, 1)     │                                                                                       
│             #1            │                                                                                       
│             #2            │                                                                                       
│__internal_compress_integra│                                                                                       
│     l_uinteger(#3, 1)     │                                                                                       
│__internal_compress_integra│                                                                                       
│     l_uinteger(#4, 1)     │                                                                                       
│             #5            │                                                                                       
│             #6            │                                                                                       
│__internal_compress_string_│                                                                                       
│        hugeint(#7)        │                                                                                       
│             #8            │                                                                                       
│             #9            │                                                                                       
│__internal_compress_string_│                                                                                       
│        hugeint(#10)       │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         HASH_JOIN         │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│           INNER           │                                                                                       
│  l_orderkey = o_orderkey  ├──────────────┐                                                                        
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                                                        
│         EC: 241245        │              │                                                                        
└─────────────┬─────────────┘              │                                                                                                     
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                          
│         SEQ_SCAN          ││         HASH_JOIN         │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│          lineitem         ││           INNER           │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   o_custkey = c_custkey   │                                                          
│         l_orderkey        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│      l_extendedprice      ││        Build Min: 1       │                                                          
│         l_discount        ││     Build Max: 149999     ├──────────────┐                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                           
│ Filters: l_returnflag='R' ││         EC: 180897        │              │                                           
│ AND l_returnflag IS N...  ││                           │              │                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │              │                                           
│        EC: 2000405        ││                           │              │                                           
└───────────────────────────┘└─────────────┬─────────────┘              │                                                                        
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             
                             │         SEQ_SCAN          ││         HASH_JOIN         │                             
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                             │           orders          ││           INNER           │                             
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││ c_nationkey = n_nationkey │                             
                             │         o_custkey         ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                             │         o_orderkey        ││         EC: 150000        │                             
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           ├──────────────┐              
                             │Filters: o_orderdate>='1993││                           │              │              
                             │     -10-01'::DATE AND     ││                           │              │              
                             │ o_orderdate<'1994-01-...  ││                           │              │              
                             │   o_orderdate IS NOT NULL ││                           │              │              
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │              │              
                             │         EC: 300000        ││                           │              │              
                             └───────────────────────────┘└─────────────┬─────────────┘              │                                           
                                                          ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
                                                          │         SEQ_SCAN          ││         SEQ_SCAN          │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │          customer         ││           nation          │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │         c_custkey         ││        n_nationkey        │
                                                          │        c_nationkey        ││           n_name          │
                                                          │           c_name          ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │         c_acctbal         ││           EC: 25          │
                                                          │          c_phone          ││                           │
                                                          │         c_address         ││                           │
                                                          │         c_comment         ││                           │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │
                                                          │ Filters: c_custkey<=149999││                           │
                                                          │  AND c_custkey IS NOT NULL││                           │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │
                                                          │         EC: 150000        ││                           │
                                                          └───────────────────────────┘└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

X {'RESULT_COLLECTOR0': 1.4e-05, 'PROJECTION1': 7e-06, 'ORDER_BY2': 4.9e-05, 'PROJECTION3': 4e-06, 'PROJECTION4': 7e-06, 'HASH_GROUP_BY5': 0.017915, 'PROJECTION6': 0.000528, 'PROJECTION7': 0.005254, 'PROJECTION8': 0.010909, 'HASH_JOIN9': 0.180003, 'SEQ_SCAN 10': 0.003129, 'HASH_JOIN11': 0.211986, 'SEQ_SCAN 12': 0.018425, 'HASH_JOIN13': 0.004056, 'HASH_JOIN14': 0.006506, 'SEQ_SCAN 15': 0.001678, 'FILTER16': 0.007263, 'SEQ_SCAN 17': 0.005759, 'HASH_JOIN18': 0.000174, 'SEQ_SCAN 19': 2.9e-05, 'SEQ_SCAN 20': 1.4e-05}
**** output size:  175
LINEAGE_5_FILTER_4
LINEAGE_5_HASH_GROUP_BY_15
LINEAGE_5_HASH_JOIN_10
LINEAGE_5_HASH_JOIN_11
LINEAGE_5_HASH_JOIN_5
LINEAGE_5_HASH_JOIN_8
LINEAGE_5_HASH_JOIN_9
LINEAGE_5_ORDER_BY_18
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_1
LINEAGE_5_SEQ_SCAN_2
LINEAGE_5_SEQ_SCAN_3
LINEAGE_5_SEQ_SCAN_6
LINEAGE_5_SEQ_SCAN_7
SELECT nation, o_year, sum(amount) AS sum_profit FROM ( SELECT n_name AS nation, extract(year FROM o_orderdate) AS o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity AS amount FROM part, supplier, lineitem, partsupp, orders, nation WHERE s_suppkey = l_suppkey AND ps_suppkey = l_suppkey AND ps_partkey = l_partkey AND p_partkey = l_partkey AND o_orderkey = l_orderkey AND s_nationkey = n_nationkey AND p_name LIKE '%green%') AS profit GROUP BY nation, o_year ORDER BY nation, o_year DESC;
   query_id  ...                                               plan
0         5  ...  {"name": "PROJECTION", "opid": "19", "children...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               SELECT nation, o_year, sum(amount) AS sum_prof...
size_bytes_max                                                6852826
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "PROJECTION", "opid": "19", "children...
Name: 0, dtype: object
{"name": "PROJECTION", "opid": "19", "children": [{"name": "ORDER_BY", "opid": "18", "children": [{"name": "PROJECTION", "opid": "17", "children": [{"name": "PROJECTION", "opid": "16", "children": [{"name": "HASH_GROUP_BY", "opid": "15", "children": [{"name": "PROJECTION", "opid": "14", "children": [{"name": "PROJECTION", "opid": "13", "children": [{"name": "PROJECTION", "opid": "12", "children": [{"name": "HASH_JOIN", "opid": "11", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "orders","extra": "orders\n[INFOSEPARATOR]\no_orderkey\no_orderdate\n[INFOSEPARATOR]\nEC: 1500000"},{"name": "HASH_JOIN", "opid": "10", "children": [{"name": "SEQ_SCAN ", "opid": "1", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_suppkey\nl_partkey\nl_orderkey\nl_extendedprice\nl_discount\nl_quantity\n[INFOSEPARATOR]\nEC: 6001215"},{"name": "HASH_JOIN", "opid": "9", "children": [{"name": "HASH_JOIN", "opid": "5", "children": [{"name": "SEQ_SCAN ", "opid": "2", "children": [],"table": "partsupp","extra": "partsupp\n[INFOSEPARATOR]\nps_suppkey\nps_partkey\nps_supplycost\n[INFOSEPARATOR]\nEC: 800000"},{"name": "FILTER", "opid": "4", "children": [{"name": "SEQ_SCAN ", "opid": "3", "children": [],"table": "part","extra": "part\n[INFOSEPARATOR]\np_partkey\np_name\n[INFOSEPARATOR]\nEC: 40000"}],"table": "","extra": "contains(p_name, 'green')\n[INFOSEPARATOR]\nEC: 40000"}],"table": "","extra": "INNER\nps_partkey = p_partkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 85503\n"},{"name": "HASH_JOIN", "opid": "8", "children": [{"name": "SEQ_SCAN ", "opid": "6", "children": [],"table": "supplier","extra": "supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\n[INFOSEPARATOR]\nEC: 10000"},{"name": "SEQ_SCAN ", "opid": "7", "children": [],"table": "nation","extra": "nation\n[INFOSEPARATOR]\nn_nationkey\nn_name\n[INFOSEPARATOR]\nEC: 25"}],"table": "","extra": "INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 10000\n"}],"table": "","extra": "INNER\nps_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 74312\n"}],"table": "","extra": "INNER\nl_suppkey = ps_suppkey\nl_partkey = ps_partkey\n\n[INFOSEPARATOR]\nEC: 1191610\n"}],"table": "","extra": "INNER\no_orderkey = l_orderkey\n\n[INFOSEPARATOR]\nEC: 1191610\n"}],"table": "","extra": "nation\nyear(o_orderdate)\namount\n"}],"table": "","extra": "__internal_compress_string_hugeint(#0)\n__internal_compress_integral_utinyint(#1, 1992)\n#2\n"}],"table": "","extra": "nation\no_year\namount\n"}],"table": "","extra": "#0\n#1\nsum(#2)"}],"table": "","extra": "__internal_decompress_string(#0)\n__internal_decompress_integral_bigint(#1, 1992)\n#2\n"}],"table": "","extra": "__internal_compress_string_hugeint(#0)\n__internal_compress_integral_utinyint(#1, 1992)\n#2\n"}],"table": "","extra": "ORDERS:\nprofit.nation ASC\nprofit.o_year DESC"}],"table": "","extra": "__internal_decompress_string(#0)\n__internal_decompress_integral_bigint(#1, 1992)\n#2\n"}
%%%%%%%%%%%%%%%% Running Query #  10  threads:  1
SELECT c_custkey, c_name, sum(l_extendedprice * (1 - l_discount)) AS revenue, c_acctbal, n_name, c_address, c_phone, c_comment FROM customer, orders, lineitem, nation WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate >= CAST('1993-10-01' AS date) AND o_orderdate < CAST('1994-01-01' AS date) AND l_returnflag = 'R' AND c_nationkey = n_nationkey GROUP BY c_custkey, c_name, c_acctbal, c_phone, n_name, c_address, c_comment ORDER BY revenue DESC LIMIT 20;
Run:  None SELECT c_custkey, c_name, sum(l_extendedprice * (1 - l_discount)) AS revenue, c_acctbal, n_name, c_address, c_phone, c_comment FROM customer, orders, lineitem, nation WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate >= CAST('1993-10-01' AS date) AND o_orderdate < CAST('1994-01-01' AS date) AND l_returnflag = 'R' AND c_nationkey = n_nationkey GROUP BY c_custkey, c_name, c_acctbal, c_phone, n_name, c_address, c_comment ORDER BY revenue DESC LIMIT 20;
Avg Time in sec:  0.5323630394414067  output size:  20
    c_custkey  ...                                          c_comment
0       57040  ...  ep. blithely regular foxes promise slyly furio...
1      143347  ...  endencies sleep. slyly express deposits nag ca...
2       60838  ...   tes. final instructions nag quickly according to
3      101998  ...  ost carefully. slyly regular packages cajole a...
4      125341  ...  ly furiously brave packages. quickly regular d...
5       25501  ...  y ironic foxes hinder according to the furious...
6      115831  ...  unts nag carefully final packages. express the...
7       84223  ...  longside of the slyly final deposits. blithely...
8       54289  ...      cajole furiously after the quickly unusual fo
9       39922  ...  ironic deposits sublate furiously. carefully r...
10       6226  ...  nal packages are alongside of the quickly bold...
11        922  ...                cuses cajole carefully regular idea
12     147946  ...  ly pending platelets. ironic requests haggle a...
13     115640  ...             ffily ironic deposits. blithely specia
14      73606  ...                 uests cajole according to the foxe
15     110246  ...        ow carefully. blithely careful packages hag
16     142549  ...  . slyly bold packages nag quickly against the ...
17     146149  ...  nic, special instructions. multipliers run car...
18      52528  ...  olphins. blithely silent platelets affix caref...
19      23431  ...    the final sentiments. carefully ironic packages

[20 rows x 8 columns]
{'name': 'Query', 'result': 0.526502, 'timing': 0.526502, 'cardinality': 0, 'extra-info': "SELECT c_custkey, c_name, sum(l_extendedprice * (1 - l_discount)) AS revenue, c_acctbal, n_name, c_address, c_phone, c_comment FROM customer, orders, lineitem, nation WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate >= CAST('1993-10-01' AS date) AND o_orderdate < CAST('1994-01-01' AS date) AND l_returnflag = 'R' AND c_nationkey = n_nationkey GROUP BY c_custkey, c_name, c_acctbal, c_phone, n_name, c_address, c_comment ORDER BY revenue DESC LIMIT 20;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 3.3e-05, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'STREAMING_LIMIT', 'timing': 3e-06, 'cardinality': 20, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 0.000189, 'cardinality': 4096, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n#1\n#2\n#3\n__internal_decompress_string(#4)\n#5\n__internal_decompress_string(#6)\n#7\n', 'children': [{'name': 'ORDER_BY', 'timing': 0.004886, 'cardinality': 4096, 'extra_info': 'ORDERS:\nsum((lineitem.l_extendedprice * (1 - lineitem.l_discount))) DESC', 'children': [{'name': 'PROJECTION', 'timing': 0.001067, 'cardinality': 37967, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n#1\n#2\n#3\n__internal_compress_string_hugeint(#4)\n#5\n__internal_compress_string_hugeint(#6)\n#7\n', 'children': [{'name': 'PROJECTION', 'timing': 1.4e-05, 'cardinality': 37967, 'extra_info': 'c_custkey\nc_name\nrevenue\nc_acctbal\nn_name\nc_address\nc_phone\nc_comment\n', 'children': [{'name': 'PROJECTION', 'timing': 0.0012, 'cardinality': 37967, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n#1\n#2\n__internal_decompress_string(#3)\n__internal_decompress_string(#4)\n#5\n#6\n#7\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.032086, 'cardinality': 37967, 'extra_info': '#0\n#1\n#2\n#3\n#4\n#5\n#6\nsum(#7)', 'children': [{'name': 'PROJECTION', 'timing': 0.000498, 'cardinality': 114705, 'extra_info': 'c_custkey\nc_name\nc_acctbal\nc_phone\nn_name\nc_address\nc_comment\n(l_extendedprice * (1.00 - l_discount))\n', 'children': [{'name': 'PROJECTION', 'timing': 0.00414, 'cardinality': 114705, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n#1\n#2\n__internal_compress_integral_uinteger(#3, 1)\n__internal_compress_integral_uinteger(#4, 1)\n#5\n#6\n__internal_compress_string_hugeint(#7)\n#8\n#9\n__internal_compress_string_hugeint(#10)\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.170396, 'cardinality': 114705, 'extra_info': 'INNER\nl_orderkey = o_orderkey\n\n[INFOSEPARATOR]\nEC: 241245\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.16453, 'cardinality': 1478870, 'extra_info': "lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nFilters: l_returnflag='R' AND l_returnflag IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 2000405", 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.045887, 'cardinality': 57069, 'extra_info': 'INNER\no_custkey = c_custkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 149999\n\n[INFOSEPARATOR]\nEC: 180897\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.015406, 'cardinality': 57069, 'extra_info': "orders\n[INFOSEPARATOR]\no_custkey\no_orderkey\n[INFOSEPARATOR]\nFilters: o_orderdate>='1993-10-01'::DATE AND o_orderdate<'1994-01-01'::DATE AND o_orderdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 300000", 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.008325, 'cardinality': 149999, 'extra_info': 'INNER\nc_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nEC: 150000\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.018655, 'cardinality': 149999, 'extra_info': 'customer\n[INFOSEPARATOR]\nc_custkey\nc_nationkey\nc_name\nc_acctbal\nc_phone\nc_address\nc_comment\n[INFOSEPARATOR]\nFilters: c_custkey<=149999 AND c_custkey IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 150000', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 2.9e-05, 'cardinality': 25, 'extra_info': 'nation\n[INFOSEPARATOR]\nn_nationkey\nn_name\n[INFOSEPARATOR]\nEC: 25', 'children': []}]}]}]}]}]}]}]}]}]}]}]}]}]}]}
compressed filter_log_size: 736
compressed filter_log_buffer_size: 0
compressed limit_offset_size: 880
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 403521
compressed perfect_full_scan_ht_log_buffer_size: 402401
compressed perfect_probe_ht_log_size: 185924
compressed perfect_probe_ht_log_buffer_size: 175492
compressed row_group_log_size: 940487
compressed row_group_log_buffer_size: 886993
compressed scatter_log_size: 363548
compressed scatter_log_buffer_size: 362356
compressed scatter_sel_log_size: 911573
compressed scatter_sel_log_buffer_size: 901023
compressed gather_log_size: 736
compressed gather_log_buffer_size: 0
compressed combine_log_size: 736
compressed combine_log_buffer_size: 0
compressed finalize_states_log_size: 8161
compressed finalize_states_log_buffer_size: 7190
compressed join_gather_log_size: 1576049
compressed join_gather_log_buffer_size: 1475790
compressed reorder_log_size: 90824
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 736
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 736
compressed nlj_log_buffer_size: 0
compressed total_size: 4484647
compressed total_buffer_size: 4211245
compressed total_element_size: 273402

Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│__internal_decompress_integ│                                                                                                                                                 
│     ral_bigint(#0, 1)     │                                                                                                                                                 
│             #1            │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│          ORDER_BY         │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│          ORDERS:          │                                                                                                                                                 
│sum((partsupp.ps_supplycost│                                                                                                                                                 
│  * partsupp.ps_availqty)) │                                                                                                                                                 
│            DESC           │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│__internal_compress_integra│                                                                                                                                                 
│     l_uinteger(#0, 1)     │                                                                                                                                                 
│             #1            │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│         ps_partkey        │                                                                                                                                                 
│           value           │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│      NESTED_LOOP_JOIN     │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│           INNER           │                                                                                                                                                 
│       CAST(sum((CAST      │                                                                                                                                                 
│(ps_supplycost AS DECI...  │                                                                                                                                                 
│(ps_availqty AS DECIMA...  ├────────────────────────────────────────────────────────────────────────┐                                                                        
│ )))) AS DECIMAL(38,11)) > │                                                                        │                                                                        
│          SUBQUERY         │                                                                        │                                                                        
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                        │                                                                        
│           EC: 1           │                                                                        │                                                                        
└─────────────┬─────────────┘                                                                        │                                                                                                     
┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐                                                          
│         PROJECTION        │                                                          │    UNGROUPED_AGGREGATE    │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│__internal_decompress_integ│                                                          │         first(#0)         │                                                          
│     ral_bigint(#0, 1)     │                                                          │                           │                                                          
│             #1            │                                                          │                           │                                                          
└─────────────┬─────────────┘                                                          └─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐                                                          
│       HASH_GROUP_BY       │                                                          │         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│             #0            │                                                          │             #0            │                                                          
│          sum(#1)          │                                                          │                           │                                                          
└─────────────┬─────────────┘                                                          └─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐                                                          
│         PROJECTION        │                                                          │      STREAMING_LIMIT      │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │                           │                                                          
│         ps_partkey        │                                                          │                           │                                                          
│   (CAST(ps_supplycost AS  │                                                          │                           │                                                          
│    DECIMAL(34,2)) * CAST  │                                                          │                           │                                                          
│(ps_availqty AS DECIMA...  │                                                          │                           │                                                          
└─────────────┬─────────────┘                                                          └─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐                                                          
│         PROJECTION        │                                                          │         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│__internal_compress_integra│                                                          │(sum((CAST(ps_supplycost AS│                                                          
│     l_usmallint(#0, 1)    │                                                          │    DECIMAL(34,2)) * CAST  │                                                          
│__internal_compress_integra│                                                          │(ps_availqty AS DECIMA...  │                                                          
│     l_uinteger(#1, 1)     │                                                          │       * 0.000100000)      │                                                          
│             #2            │                                                          │                           │                                                          
│             #3            │                                                          │                           │                                                          
│__internal_compress_integra│                                                          │                           │                                                          
│     l_usmallint(#4, 1)    │                                                          │                           │                                                          
└─────────────┬─────────────┘                                                          └─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐                                                          
│         HASH_JOIN         │                                                          │    UNGROUPED_AGGREGATE    │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│           INNER           │                                                          │          sum(#0)          │                                                          
│   ps_suppkey = s_suppkey  │                                                          │                           │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐                                           │                           │                                                          
│        Build Min: 1       │              │                                           │                           │                                                          
│      Build Max: 10000     │              │                                           │                           │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                           │                           │                                                          
│         EC: 27811         │              │                                           │                           │                                                          
└─────────────┬─────────────┘              │                                           └─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐                                                          
│         SEQ_SCAN          ││         HASH_JOIN         │                             │         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│          partsupp         ││           INNER           │                             │   (CAST(ps_supplycost AS  │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││ s_nationkey = n_nationkey │                             │    DECIMAL(34,2)) * CAST  │                                                          
│         ps_suppkey        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │(ps_availqty AS DECIMA...  │                                                          
│         ps_partkey        ││        Build Min: 0       ├──────────────┐              │                           │                                                          
│       ps_supplycost       ││       Build Max: 24       │              │              │                           │                                                          
│        ps_availqty        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              │                           │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││          EC: 400          │              │              │                           │                                                          
│         EC: 800000        ││                           │              │              │                           │                                                          
└───────────────────────────┘└─────────────┬─────────────┘              │              └─────────────┬─────────────┘                                                                                       
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                          
                             │         SEQ_SCAN          ││         SEQ_SCAN          ││         HASH_JOIN         │                                                          
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                             │          supplier         ││           nation          ││           INNER           │                                                          
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ps_suppkey = s_suppkey  │                                                          
                             │         s_suppkey         ││        n_nationkey        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                             │        s_nationkey        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││        Build Min: 1       ├──────────────┐                                           
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││ Filters: n_name='GERMANY' ││      Build Max: 10000     │              │                                           
                             │         EC: 10000         ││   AND n_name IS NOT NULL  ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                           
                             │                           ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││         EC: 27811         │              │                                           
                             │                           ││           EC: 1           ││                           │              │                                           
                             └───────────────────────────┘└───────────────────────────┘└─────────────┬─────────────┘              │                                                                        
                                                                                       ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             
                                                                                       │         SEQ_SCAN          ││         HASH_JOIN         │                             
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                                                                                       │          partsupp         ││           INNER           │                             
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││ s_nationkey = n_nationkey │                             
                                                                                       │         ps_suppkey        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐              
                                                                                       │       ps_supplycost       ││        Build Min: 0       │              │              
                                                                                       │        ps_availqty        ││       Build Max: 24       │              │              
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              
                                                                                       │         EC: 800000        ││          EC: 400          │              │              
                                                                                       └───────────────────────────┘└─────────────┬─────────────┘              │                                           
                                                                                                                    ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
                                                                                                                    │         SEQ_SCAN          ││         SEQ_SCAN          │
                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                                                    │          supplier         ││           nation          │
                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                                                    │         s_suppkey         ││        n_nationkey        │
                                                                                                                    │        s_nationkey        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││ Filters: n_name='GERMANY' │
                                                                                                                    │         EC: 10000         ││   AND n_name IS NOT NULL  │
                                                                                                                    │                           ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                                                    │                           ││           EC: 1           │
                                                                                                                    └───────────────────────────┘└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

X {'RESULT_COLLECTOR0': 3.3e-05, 'STREAMING_LIMIT1': 3e-06, 'PROJECTION2': 0.000189, 'ORDER_BY3': 0.004886, 'PROJECTION4': 0.001067, 'PROJECTION5': 1.4e-05, 'PROJECTION6': 0.0012, 'HASH_GROUP_BY7': 0.032086, 'PROJECTION8': 0.000498, 'PROJECTION9': 0.00414, 'HASH_JOIN10': 0.170396, 'SEQ_SCAN 11': 0.16453, 'HASH_JOIN12': 0.045887, 'SEQ_SCAN 13': 0.015406, 'HASH_JOIN14': 0.008325, 'SEQ_SCAN 15': 0.018655, 'SEQ_SCAN 16': 2.9e-05}
**** output size:  20
LINEAGE_5_HASH_GROUP_BY_9
LINEAGE_5_HASH_JOIN_4
LINEAGE_5_HASH_JOIN_5
LINEAGE_5_HASH_JOIN_6
LINEAGE_5_ORDER_BY_13
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_1
LINEAGE_5_SEQ_SCAN_2
LINEAGE_5_SEQ_SCAN_3
LINEAGE_5_STREAMING_LIMIT_15
SELECT c_custkey, c_name, sum(l_extendedprice * (1 - l_discount)) AS revenue, c_acctbal, n_name, c_address, c_phone, c_comment FROM customer, orders, lineitem, nation WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate >= CAST('1993-10-01' AS date) AND o_orderdate < CAST('1994-01-01' AS date) AND l_returnflag = 'R' AND c_nationkey = n_nationkey GROUP BY c_custkey, c_name, c_acctbal, c_phone, n_name, c_address, c_comment ORDER BY revenue DESC LIMIT 20;
   query_id  ...                                               plan
0         5  ...  {"name": "STREAMING_LIMIT", "opid": "15", "chi...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               SELECT c_custkey, c_name, sum(l_extendedprice ...
size_bytes_max                                                4484647
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "STREAMING_LIMIT", "opid": "15", "chi...
Name: 0, dtype: object
{"name": "STREAMING_LIMIT", "opid": "15", "children": [{"name": "PROJECTION", "opid": "14", "children": [{"name": "ORDER_BY", "opid": "13", "children": [{"name": "PROJECTION", "opid": "12", "children": [{"name": "PROJECTION", "opid": "11", "children": [{"name": "PROJECTION", "opid": "10", "children": [{"name": "HASH_GROUP_BY", "opid": "9", "children": [{"name": "PROJECTION", "opid": "8", "children": [{"name": "PROJECTION", "opid": "7", "children": [{"name": "HASH_JOIN", "opid": "6", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nFilters: l_returnflag='R' AND l_returnflag IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 2000405"},{"name": "HASH_JOIN", "opid": "5", "children": [{"name": "SEQ_SCAN ", "opid": "1", "children": [],"table": "orders","extra": "orders\n[INFOSEPARATOR]\no_custkey\no_orderkey\n[INFOSEPARATOR]\nFilters: o_orderdate>='1993-10-01'::DATE AND o_orderdate<'1994-01-01'::DATE AND o_orderdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 300000"},{"name": "HASH_JOIN", "opid": "4", "children": [{"name": "SEQ_SCAN ", "opid": "2", "children": [],"table": "customer","extra": "customer\n[INFOSEPARATOR]\nc_custkey\nc_nationkey\nc_name\nc_acctbal\nc_phone\nc_address\nc_comment\n[INFOSEPARATOR]\nFilters: c_custkey<=149999 AND c_custkey IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 150000"},{"name": "SEQ_SCAN ", "opid": "3", "children": [],"table": "nation","extra": "nation\n[INFOSEPARATOR]\nn_nationkey\nn_name\n[INFOSEPARATOR]\nEC: 25"}],"table": "","extra": "INNER\nc_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nEC: 150000\n"}],"table": "","extra": "INNER\no_custkey = c_custkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 149999\n\n[INFOSEPARATOR]\nEC: 180897\n"}],"table": "","extra": "INNER\nl_orderkey = o_orderkey\n\n[INFOSEPARATOR]\nEC: 241245\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n#1\n#2\n__internal_compress_integral_uinteger(#3, 1)\n__internal_compress_integral_uinteger(#4, 1)\n#5\n#6\n__internal_compress_string_hugeint(#7)\n#8\n#9\n__internal_compress_string_hugeint(#10)\n"}],"table": "","extra": "c_custkey\nc_name\nc_acctbal\nc_phone\nn_name\nc_address\nc_comment\n(l_extendedprice * (1.00 - l_discount))\n"}],"table": "","extra": "#0\n#1\n#2\n#3\n#4\n#5\n#6\nsum(#7)"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n#1\n#2\n__internal_decompress_string(#3)\n__internal_decompress_string(#4)\n#5\n#6\n#7\n"}],"table": "","extra": "c_custkey\nc_name\nrevenue\nc_acctbal\nn_name\nc_address\nc_phone\nc_comment\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n#1\n#2\n#3\n__internal_compress_string_hugeint(#4)\n#5\n__internal_compress_string_hugeint(#6)\n#7\n"}],"table": "","extra": "ORDERS:\nsum((lineitem.l_extendedprice * (1 - lineitem.l_discount))) DESC"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n#1\n#2\n#3\n__internal_decompress_string(#4)\n#5\n__internal_decompress_string(#6)\n#7\n"}],"table": "","extra": ""}
%%%%%%%%%%%%%%%% Running Query #  11  threads:  1
SELECT ps_partkey, sum(ps_supplycost * ps_availqty) AS value FROM partsupp, supplier, nation WHERE ps_suppkey = s_suppkey AND s_nationkey = n_nationkey AND n_name = 'GERMANY' GROUP BY ps_partkey HAVING sum(ps_supplycost * ps_availqty) > ( SELECT sum(ps_supplycost * ps_availqty) * 0.000100000 FROM partsupp, supplier, nation WHERE ps_suppkey = s_suppkey AND s_nationkey = n_nationkey AND n_name = 'GERMANY') ORDER BY value DESC;
Run:  None SELECT ps_partkey, sum(ps_supplycost * ps_availqty) AS value FROM partsupp, supplier, nation WHERE ps_suppkey = s_suppkey AND s_nationkey = n_nationkey AND n_name = 'GERMANY' GROUP BY ps_partkey HAVING sum(ps_supplycost * ps_availqty) > ( SELECT sum(ps_supplycost * ps_availqty) * 0.000100000 FROM partsupp, supplier, nation WHERE ps_suppkey = s_suppkey AND s_nationkey = n_nationkey AND n_name = 'GERMANY') ORDER BY value DESC;
Avg Time in sec:  0.041086834855377674  output size:  1048
      ps_partkey        value
0         129760  17538456.86
1         166726  16503353.92
2         191287  16474801.97
3         161758  16101755.54
4          34452  15983844.72
...          ...          ...
1043      154731   7888301.33
1044      101674   7879324.60
1045       51968   7879102.21
1046       72073   7877736.11
1047        5182   7874521.73

[1048 rows x 2 columns]
{'name': 'Query', 'result': 0.037382, 'timing': 0.037382, 'cardinality': 0, 'extra-info': "SELECT ps_partkey, sum(ps_supplycost * ps_availqty) AS value FROM partsupp, supplier, nation WHERE ps_suppkey = s_suppkey AND s_nationkey = n_nationkey AND n_name = 'GERMANY' GROUP BY ps_partkey HAVING sum(ps_supplycost * ps_availqty) > ( SELECT sum(ps_supplycost * ps_availqty) * 0.000100000 FROM partsupp, supplier, nation WHERE ps_suppkey = s_suppkey AND s_nationkey = n_nationkey AND n_name = 'GERMANY') ORDER BY value DESC;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 1.2e-05, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 5e-06, 'cardinality': 1048, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n#1\n', 'children': [{'name': 'ORDER_BY', 'timing': 9.7e-05, 'cardinality': 1048, 'extra_info': 'ORDERS:\nsum((partsupp.ps_supplycost * partsupp.ps_availqty)) DESC', 'children': [{'name': 'PROJECTION', 'timing': 1.4e-05, 'cardinality': 1048, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n#1\n', 'children': [{'name': 'PROJECTION', 'timing': 4e-06, 'cardinality': 1048, 'extra_info': 'ps_partkey\nvalue\n', 'children': [{'name': 'NESTED_LOOP_JOIN', 'timing': 0.000973, 'cardinality': 1048, 'extra_info': 'INNER\nCAST(sum((CAST(ps_supplycost AS DECIMAL(34,2)) * CAST(ps_availqty AS DECIMAL(34,0)))) AS DECIMAL(38,11)) > SUBQUERY\n\n[INFOSEPARATOR]\nEC: 1\n', 'children': [{'name': 'PROJECTION', 'timing': 2.6e-05, 'cardinality': 29818, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n#1\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.004029, 'cardinality': 29818, 'extra_info': '#0\nsum(#1)', 'children': [{'name': 'PROJECTION', 'timing': 0.005124, 'cardinality': 31680, 'extra_info': 'ps_partkey\n(CAST(ps_supplycost AS DECIMAL(34,2)) * CAST(ps_availqty AS DECIMAL(34,0)))\n', 'children': [{'name': 'PROJECTION', 'timing': 0.002593, 'cardinality': 31680, 'extra_info': '__internal_compress_integral_usmallint(#0, 1)\n__internal_compress_integral_uinteger(#1, 1)\n#2\n#3\n__internal_compress_integral_usmallint(#4, 1)\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.004393, 'cardinality': 31680, 'extra_info': 'INNER\nps_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 27811\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.001626, 'cardinality': 800000, 'extra_info': 'partsupp\n[INFOSEPARATOR]\nps_suppkey\nps_partkey\nps_supplycost\nps_availqty\n[INFOSEPARATOR]\nEC: 800000', 'children': []}, {'name': 'HASH_JOIN', 'timing': 5.5e-05, 'cardinality': 396, 'extra_info': 'INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 400\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 2.8e-05, 'cardinality': 10000, 'extra_info': 'supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\n[INFOSEPARATOR]\nEC: 10000', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 8e-06, 'cardinality': 1, 'extra_info': "nation\n[INFOSEPARATOR]\nn_nationkey\n[INFOSEPARATOR]\nFilters: n_name='GERMANY' AND n_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1", 'children': []}]}]}]}]}]}]}, {'name': 'UNGROUPED_AGGREGATE', 'timing': 2e-06, 'cardinality': 1, 'extra_info': 'first(#0)', 'children': [{'name': 'PROJECTION', 'timing': 0.0, 'cardinality': 1, 'extra_info': '#0\n', 'children': [{'name': 'STREAMING_LIMIT', 'timing': 1e-06, 'cardinality': 1, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 1e-05, 'cardinality': 1, 'extra_info': '(sum((CAST(ps_supplycost AS DECIMAL(34,2)) * CAST(ps_availqty AS DECIMAL(34,0)))) * 0.000100000)\n', 'children': [{'name': 'UNGROUPED_AGGREGATE', 'timing': 0.00039, 'cardinality': 1, 'extra_info': 'sum(#0)', 'children': [{'name': 'PROJECTION', 'timing': 0.007185, 'cardinality': 31680, 'extra_info': '(CAST(ps_supplycost AS DECIMAL(34,2)) * CAST(ps_availqty AS DECIMAL(34,0)))\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.005254, 'cardinality': 31680, 'extra_info': 'INNER\nps_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 27811\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.001666, 'cardinality': 800000, 'extra_info': 'partsupp\n[INFOSEPARATOR]\nps_suppkey\nps_supplycost\nps_availqty\n[INFOSEPARATOR]\nEC: 800000', 'children': []}, {'name': 'HASH_JOIN', 'timing': 8.2e-05, 'cardinality': 396, 'extra_info': 'INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 400\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 5.3e-05, 'cardinality': 10000, 'extra_info': 'supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\n[INFOSEPARATOR]\nEC: 10000', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 2.3e-05, 'cardinality': 1, 'extra_info': "nation\n[INFOSEPARATOR]\nn_nationkey\n[INFOSEPARATOR]\nFilters: n_name='GERMANY' AND n_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1", 'children': []}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}
compressed filter_log_size: 992
compressed filter_log_buffer_size: 0
compressed limit_offset_size: 1136
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 4949
compressed perfect_full_scan_ht_log_buffer_size: 2421
compressed perfect_probe_ht_log_size: 307864
compressed perfect_probe_ht_log_buffer_size: 294442
compressed row_group_log_size: 8310
compressed row_group_log_buffer_size: 8
compressed scatter_log_size: 51863
compressed scatter_log_buffer_size: 48711
compressed scatter_sel_log_size: 7264
compressed scatter_sel_log_buffer_size: 5274
compressed gather_log_size: 992
compressed gather_log_buffer_size: 0
compressed combine_log_size: 992
compressed combine_log_buffer_size: 0
compressed finalize_states_log_size: 17662
compressed finalize_states_log_buffer_size: 16460
compressed join_gather_log_size: 992
compressed join_gather_log_buffer_size: 0
compressed reorder_log_size: 3279
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 992
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 4392
compressed nlj_log_buffer_size: 2840
compressed total_size: 411679
compressed total_buffer_size: 370156
compressed total_element_size: 41523

Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│__internal_decompress_strin│                             
│           g(#0)           │                             
│             #1            │                             
│             #2            │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│          ORDER_BY         │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│          ORDERS:          │                             
│  lineitem.l_shipmode ASC  │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│__internal_compress_string_│                             
│        ubigint(#0)        │                             
│             #1            │                             
│             #2            │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│__internal_decompress_strin│                             
│           g(#0)           │                             
│             #1            │                             
│             #2            │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│       HASH_GROUP_BY       │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│             #0            │                             
│          sum(#1)          │                             
│          sum(#2)          │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│         l_shipmode        │                             
│       CASE  WHEN ((       │                             
│(o_orderpriority = '1-...  │                             
│(o_orderpriority = '2-...  │                             
│     THEN (1) ELSE 0 END   │                             
│       CASE  WHEN ((       │                             
│(o_orderpriority != '1...  │                             
│(o_orderpriority != '2...  │                             
│     THEN (1) ELSE 0 END   │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│__internal_compress_integra│                             
│     l_uinteger(#0, 1)     │                             
│             #1            │                             
│__internal_compress_integra│                             
│     l_uinteger(#2, 1)     │                             
│__internal_compress_string_│                             
│        ubigint(#3)        │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         HASH_JOIN         │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│           INNER           │                             
│  o_orderkey = l_orderkey  ├──────────────┐              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              
│         EC: 240048        │              │              
└─────────────┬─────────────┘              │                                           
┌─────────────┴─────────────┐┌─────────────┴─────────────┐
│         SEQ_SCAN          ││           FILTER          │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│           orders          ││      ((l_commitdate <     │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││ l_receiptdate) AND (l...  │
│         o_orderkey        ││ l_commitdate) AND ((l...  │
│      o_orderpriority      ││= 'MAIL') OR (l_shipmode = │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││         'SHIP')))         │
│        EC: 1500000        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│                           ││         EC: 240048        │
└───────────────────────────┘└─────────────┬─────────────┘                             
                             ┌─────────────┴─────────────┐
                             │         SEQ_SCAN          │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                             │          lineitem         │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                             │         l_orderkey        │
                             │         l_shipmode        │
                             │        l_commitdate       │
                             │       l_receiptdate       │
                             │         l_shipdate        │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                             │  Filters: l_receiptdate>= │
                             │   '1994-01-01'::DATE AND  │
                             │ l_receiptdate<'1995-0...  │
                             │  AND l_receiptdate IS NOT │
                             │            NULL           │
                             │ l_commitdate<'1995-01-01':│
                             │ :DATE AND l_commitdate IS │
                             │          NOT NULL         │
                             │  l_shipdate<'1995-01-01': │
                             │:DATE AND l_shipdate IS NOT│
                             │            NULL           │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                             │         EC: 240048        │
                             └───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

X {'RESULT_COLLECTOR0': 1.2e-05, 'PROJECTION1': 5e-06, 'ORDER_BY2': 9.7e-05, 'PROJECTION3': 1.4e-05, 'PROJECTION4': 4e-06, 'NESTED_LOOP_JOIN5': 0.000973, 'PROJECTION6': 2.6e-05, 'HASH_GROUP_BY7': 0.004029, 'PROJECTION8': 0.005124, 'PROJECTION9': 0.002593, 'HASH_JOIN10': 0.004393, 'SEQ_SCAN 11': 0.001626, 'HASH_JOIN12': 5.5e-05, 'SEQ_SCAN 13': 2.8e-05, 'SEQ_SCAN 14': 8e-06, 'UNGROUPED_AGGREGATE15': 2e-06, 'PROJECTION16': 0.0, 'STREAMING_LIMIT17': 1e-06, 'PROJECTION18': 1e-05, 'UNGROUPED_AGGREGATE19': 0.00039, 'PROJECTION20': 0.007185, 'HASH_JOIN21': 0.005254, 'SEQ_SCAN 22': 0.001666, 'HASH_JOIN23': 8.2e-05, 'SEQ_SCAN 24': 5.3e-05, 'SEQ_SCAN 25': 2.3e-05}
**** output size:  1048
LINEAGE_5_HASH_GROUP_BY_7
LINEAGE_5_HASH_JOIN_12
LINEAGE_5_HASH_JOIN_13
LINEAGE_5_HASH_JOIN_3
LINEAGE_5_HASH_JOIN_4
LINEAGE_5_NESTED_LOOP_JOIN_20
LINEAGE_5_ORDER_BY_23
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_1
LINEAGE_5_SEQ_SCAN_10
LINEAGE_5_SEQ_SCAN_11
LINEAGE_5_SEQ_SCAN_2
LINEAGE_5_SEQ_SCAN_9
LINEAGE_5_STREAMING_LIMIT_17
SELECT ps_partkey, sum(ps_supplycost * ps_availqty) AS value FROM partsupp, supplier, nation WHERE ps_suppkey = s_suppkey AND s_nationkey = n_nationkey AND n_name = 'GERMANY' GROUP BY ps_partkey HAVING sum(ps_supplycost * ps_availqty) > ( SELECT sum(ps_supplycost * ps_availqty) * 0.000100000 FROM partsupp, supplier, nation WHERE ps_suppkey = s_suppkey AND s_nationkey = n_nationkey AND n_name = 'GERMANY') ORDER BY value DESC;
   query_id  ...                                               plan
0         5  ...  {"name": "PROJECTION", "opid": "24", "children...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               SELECT ps_partkey, sum(ps_supplycost * ps_avai...
size_bytes_max                                                 411679
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "PROJECTION", "opid": "24", "children...
Name: 0, dtype: object
{"name": "PROJECTION", "opid": "24", "children": [{"name": "ORDER_BY", "opid": "23", "children": [{"name": "PROJECTION", "opid": "22", "children": [{"name": "PROJECTION", "opid": "21", "children": [{"name": "NESTED_LOOP_JOIN", "opid": "20", "children": [{"name": "PROJECTION", "opid": "8", "children": [{"name": "HASH_GROUP_BY", "opid": "7", "children": [{"name": "PROJECTION", "opid": "6", "children": [{"name": "PROJECTION", "opid": "5", "children": [{"name": "HASH_JOIN", "opid": "4", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "partsupp","extra": "partsupp\n[INFOSEPARATOR]\nps_suppkey\nps_partkey\nps_supplycost\nps_availqty\n[INFOSEPARATOR]\nEC: 800000"},{"name": "HASH_JOIN", "opid": "3", "children": [{"name": "SEQ_SCAN ", "opid": "1", "children": [],"table": "supplier","extra": "supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\n[INFOSEPARATOR]\nEC: 10000"},{"name": "SEQ_SCAN ", "opid": "2", "children": [],"table": "nation","extra": "nation\n[INFOSEPARATOR]\nn_nationkey\n[INFOSEPARATOR]\nFilters: n_name='GERMANY' AND n_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1"}],"table": "","extra": "INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 400\n"}],"table": "","extra": "INNER\nps_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 27811\n"}],"table": "","extra": "__internal_compress_integral_usmallint(#0, 1)\n__internal_compress_integral_uinteger(#1, 1)\n#2\n#3\n__internal_compress_integral_usmallint(#4, 1)\n"}],"table": "","extra": "ps_partkey\n(CAST(ps_supplycost AS DECIMAL(34,2)) * CAST(ps_availqty AS DECIMAL(34,0)))\n"}],"table": "","extra": "#0\nsum(#1)"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n#1\n"},{"name": "UNGROUPED_AGGREGATE", "opid": "19", "children": [{"name": "PROJECTION", "opid": "18", "children": [{"name": "STREAMING_LIMIT", "opid": "17", "children": [{"name": "PROJECTION", "opid": "16", "children": [{"name": "UNGROUPED_AGGREGATE", "opid": "15", "children": [{"name": "PROJECTION", "opid": "14", "children": [{"name": "HASH_JOIN", "opid": "13", "children": [{"name": "SEQ_SCAN ", "opid": "9", "children": [],"table": "partsupp","extra": "partsupp\n[INFOSEPARATOR]\nps_suppkey\nps_supplycost\nps_availqty\n[INFOSEPARATOR]\nEC: 800000"},{"name": "HASH_JOIN", "opid": "12", "children": [{"name": "SEQ_SCAN ", "opid": "10", "children": [],"table": "supplier","extra": "supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\n[INFOSEPARATOR]\nEC: 10000"},{"name": "SEQ_SCAN ", "opid": "11", "children": [],"table": "nation","extra": "nation\n[INFOSEPARATOR]\nn_nationkey\n[INFOSEPARATOR]\nFilters: n_name='GERMANY' AND n_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1"}],"table": "","extra": "INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 400\n"}],"table": "","extra": "INNER\nps_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 27811\n"}],"table": "","extra": "(CAST(ps_supplycost AS DECIMAL(34,2)) * CAST(ps_availqty AS DECIMAL(34,0)))\n"}],"table": "","extra": "sum(#0)"}],"table": "","extra": "(sum((CAST(ps_supplycost AS DECIMAL(34,2)) * CAST(ps_availqty AS DECIMAL(34,0)))) * 0.000100000)\n"}],"table": "","extra": ""}],"table": "","extra": "#0\n"}],"table": "","extra": "first(#0)"}],"table": "","extra": "INNER\nCAST(sum((CAST(ps_supplycost AS DECIMAL(34,2)) * CAST(ps_availqty AS DECIMAL(34,0)))) AS DECIMAL(38,11)) > SUBQUERY\n\n[INFOSEPARATOR]\nEC: 1\n"}],"table": "","extra": "ps_partkey\nvalue\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n#1\n"}],"table": "","extra": "ORDERS:\nsum((partsupp.ps_supplycost * partsupp.ps_availqty)) DESC"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n#1\n"}
%%%%%%%%%%%%%%%% Running Query #  12  threads:  1
SELECT l_shipmode, sum( CASE WHEN o_orderpriority = '1-URGENT' OR o_orderpriority = '2-HIGH' THEN 1 ELSE 0 END) AS high_line_count, sum( CASE WHEN o_orderpriority <> '1-URGENT' AND o_orderpriority <> '2-HIGH' THEN 1 ELSE 0 END) AS low_line_count FROM orders, lineitem WHERE o_orderkey = l_orderkey AND l_shipmode IN ('MAIL', 'SHIP') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= CAST('1994-01-01' AS date) AND l_receiptdate < CAST('1995-01-01' AS date) GROUP BY l_shipmode ORDER BY l_shipmode;
Run:  None SELECT l_shipmode, sum( CASE WHEN o_orderpriority = '1-URGENT' OR o_orderpriority = '2-HIGH' THEN 1 ELSE 0 END) AS high_line_count, sum( CASE WHEN o_orderpriority <> '1-URGENT' AND o_orderpriority <> '2-HIGH' THEN 1 ELSE 0 END) AS low_line_count FROM orders, lineitem WHERE o_orderkey = l_orderkey AND l_shipmode IN ('MAIL', 'SHIP') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= CAST('1994-01-01' AS date) AND l_receiptdate < CAST('1995-01-01' AS date) GROUP BY l_shipmode ORDER BY l_shipmode;
Avg Time in sec:  0.31619487004354596  output size:  2
  l_shipmode  high_line_count  low_line_count
0       MAIL           6202.0          9324.0
1       SHIP           6200.0          9262.0
{'name': 'Query', 'result': 0.313803, 'timing': 0.313803, 'cardinality': 0, 'extra-info': "SELECT l_shipmode, sum( CASE WHEN o_orderpriority = '1-URGENT' OR o_orderpriority = '2-HIGH' THEN 1 ELSE 0 END) AS high_line_count, sum( CASE WHEN o_orderpriority <> '1-URGENT' AND o_orderpriority <> '2-HIGH' THEN 1 ELSE 0 END) AS low_line_count FROM orders, lineitem WHERE o_orderkey = l_orderkey AND l_shipmode IN ('MAIL', 'SHIP') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= CAST('1994-01-01' AS date) AND l_receiptdate < CAST('1995-01-01' AS date) GROUP BY l_shipmode ORDER BY l_shipmode;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 8e-06, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 1e-06, 'cardinality': 2, 'extra_info': '__internal_decompress_string(#0)\n#1\n#2\n', 'children': [{'name': 'ORDER_BY', 'timing': 3.1e-05, 'cardinality': 2, 'extra_info': 'ORDERS:\nlineitem.l_shipmode ASC', 'children': [{'name': 'PROJECTION', 'timing': 1e-06, 'cardinality': 2, 'extra_info': '__internal_compress_string_ubigint(#0)\n#1\n#2\n', 'children': [{'name': 'PROJECTION', 'timing': 2e-06, 'cardinality': 2, 'extra_info': '__internal_decompress_string(#0)\n#1\n#2\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.001077, 'cardinality': 2, 'extra_info': '#0\nsum(#1)\nsum(#2)', 'children': [{'name': 'PROJECTION', 'timing': 0.000804, 'cardinality': 30988, 'extra_info': "l_shipmode\nCASE  WHEN (((o_orderpriority = '1-URGENT') OR (o_orderpriority = '2-HIGH'))) THEN (1) ELSE 0 END\nCASE  WHEN (((o_orderpriority != '1-URGENT') AND (o_orderpriority != '2-HIGH'))) THEN (1) ELSE 0 END\n", 'children': [{'name': 'PROJECTION', 'timing': 0.000248, 'cardinality': 30988, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n#1\n__internal_compress_integral_uinteger(#2, 1)\n__internal_compress_string_ubigint(#3)\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.04103, 'cardinality': 30988, 'extra_info': 'INNER\no_orderkey = l_orderkey\n\n[INFOSEPARATOR]\nEC: 240048\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.035798, 'cardinality': 1500000, 'extra_info': 'orders\n[INFOSEPARATOR]\no_orderkey\no_orderpriority\n[INFOSEPARATOR]\nEC: 1500000', 'children': []}, {'name': 'FILTER', 'timing': 0.036143, 'cardinality': 30988, 'extra_info': "((l_commitdate < l_receiptdate) AND (l_shipdate < l_commitdate) AND ((l_shipmode = 'MAIL') OR (l_shipmode = 'SHIP')))\n[INFOSEPARATOR]\nEC: 240048", 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.191784, 'cardinality': 885773, 'extra_info': "lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_shipmode\nl_commitdate\nl_receiptdate\nl_shipdate\n[INFOSEPARATOR]\nFilters: l_receiptdate>='1994-01-01'::DATE AND l_receiptdate<'1995-01-01'::DATE AND l_receiptdate IS NOT NULL\nl_commitdate<'1995-01-01'::DATE AND l_commitdate IS NOT NULL\nl_shipdate<'1995-01-01'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 240048", 'children': []}]}]}]}]}]}]}]}]}]}]}]}
compressed filter_log_size: 157604
compressed filter_log_buffer_size: 125456
compressed limit_offset_size: 560
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 560
compressed perfect_full_scan_ht_log_buffer_size: 0
compressed perfect_probe_ht_log_size: 560
compressed perfect_probe_ht_log_buffer_size: 0
compressed row_group_log_size: 681918
compressed row_group_log_buffer_size: 635605
compressed scatter_log_size: 28643
compressed scatter_log_buffer_size: 27888
compressed scatter_sel_log_size: 140007
compressed scatter_sel_log_buffer_size: 139079
compressed gather_log_size: 560
compressed gather_log_buffer_size: 0
compressed combine_log_size: 560
compressed combine_log_buffer_size: 0
compressed finalize_states_log_size: 720
compressed finalize_states_log_buffer_size: 16
compressed join_gather_log_size: 326380
compressed join_gather_log_buffer_size: 292804
compressed reorder_log_size: 920
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 560
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 560
compressed nlj_log_buffer_size: 0
compressed total_size: 1340112
compressed total_buffer_size: 1220848
compressed total_element_size: 119264

Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                             
│          ORDER_BY         │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│          ORDERS:          │                             
│     count_star() DESC     │                             
│   c_orders.c_count DESC   │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│       HASH_GROUP_BY       │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│             #0            │                             
│        count_star()       │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│          c_count          │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│     count(o_orderkey)     │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│__internal_decompress_integ│                             
│     ral_bigint(#0, 1)     │                             
│             #1            │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│       HASH_GROUP_BY       │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│             #0            │                             
│         count(#1)         │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│         c_custkey         │                             
│         o_orderkey        │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│__internal_compress_integra│                             
│     l_uinteger(#0, 1)     │                             
│             #1            │                             
│             #2            │                             
│__internal_compress_integra│                             
│     l_uinteger(#3, 1)     │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         HASH_JOIN         │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│           RIGHT           │                             
│   o_custkey = c_custkey   ├──────────────┐              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              
│         EC: 300000        │              │              
└─────────────┬─────────────┘              │                                           
┌─────────────┴─────────────┐┌─────────────┴─────────────┐
│           FILTER          ││         SEQ_SCAN          │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│  (o_comment !~~ '%special ││          customer         │
│        %requests%')       ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││         c_custkey         │
│         EC: 300000        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│                           ││         EC: 150000        │
└─────────────┬─────────────┘└───────────────────────────┘                             
┌─────────────┴─────────────┐                             
│         SEQ_SCAN          │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│           orders          │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│         o_custkey         │                             
│         o_comment         │                             
│         o_orderkey        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│        EC: 1500000        │                             
└───────────────────────────┘                                                          

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

X {'RESULT_COLLECTOR0': 8e-06, 'PROJECTION1': 1e-06, 'ORDER_BY2': 3.1e-05, 'PROJECTION3': 1e-06, 'PROJECTION4': 2e-06, 'HASH_GROUP_BY5': 0.001077, 'PROJECTION6': 0.000804, 'PROJECTION7': 0.000248, 'HASH_JOIN8': 0.04103, 'SEQ_SCAN 9': 0.035798, 'FILTER10': 0.036143, 'SEQ_SCAN 11': 0.191784}
**** output size:  2
LINEAGE_5_FILTER_2
LINEAGE_5_HASH_GROUP_BY_6
LINEAGE_5_HASH_JOIN_3
LINEAGE_5_ORDER_BY_9
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_1
SELECT l_shipmode, sum( CASE WHEN o_orderpriority = '1-URGENT' OR o_orderpriority = '2-HIGH' THEN 1 ELSE 0 END) AS high_line_count, sum( CASE WHEN o_orderpriority <> '1-URGENT' AND o_orderpriority <> '2-HIGH' THEN 1 ELSE 0 END) AS low_line_count FROM orders, lineitem WHERE o_orderkey = l_orderkey AND l_shipmode IN ('MAIL', 'SHIP') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= CAST('1994-01-01' AS date) AND l_receiptdate < CAST('1995-01-01' AS date) GROUP BY l_shipmode ORDER BY l_shipmode;
   query_id  ...                                               plan
0         5  ...  {"name": "PROJECTION", "opid": "10", "children...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               SELECT l_shipmode, sum( CASE WHEN o_orderprior...
size_bytes_max                                                1340112
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "PROJECTION", "opid": "10", "children...
Name: 0, dtype: object
{"name": "PROJECTION", "opid": "10", "children": [{"name": "ORDER_BY", "opid": "9", "children": [{"name": "PROJECTION", "opid": "8", "children": [{"name": "PROJECTION", "opid": "7", "children": [{"name": "HASH_GROUP_BY", "opid": "6", "children": [{"name": "PROJECTION", "opid": "5", "children": [{"name": "PROJECTION", "opid": "4", "children": [{"name": "HASH_JOIN", "opid": "3", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "orders","extra": "orders\n[INFOSEPARATOR]\no_orderkey\no_orderpriority\n[INFOSEPARATOR]\nEC: 1500000"},{"name": "FILTER", "opid": "2", "children": [{"name": "SEQ_SCAN ", "opid": "1", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_shipmode\nl_commitdate\nl_receiptdate\nl_shipdate\n[INFOSEPARATOR]\nFilters: l_receiptdate>='1994-01-01'::DATE AND l_receiptdate<'1995-01-01'::DATE AND l_receiptdate IS NOT NULL\nl_commitdate<'1995-01-01'::DATE AND l_commitdate IS NOT NULL\nl_shipdate<'1995-01-01'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 240048"}],"table": "","extra": "((l_commitdate < l_receiptdate) AND (l_shipdate < l_commitdate) AND ((l_shipmode = 'MAIL') OR (l_shipmode = 'SHIP')))\n[INFOSEPARATOR]\nEC: 240048"}],"table": "","extra": "INNER\no_orderkey = l_orderkey\n\n[INFOSEPARATOR]\nEC: 240048\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n#1\n__internal_compress_integral_uinteger(#2, 1)\n__internal_compress_string_ubigint(#3)\n"}],"table": "","extra": "l_shipmode\nCASE  WHEN (((o_orderpriority = '1-URGENT') OR (o_orderpriority = '2-HIGH'))) THEN (1) ELSE 0 END\nCASE  WHEN (((o_orderpriority != '1-URGENT') AND (o_orderpriority != '2-HIGH'))) THEN (1) ELSE 0 END\n"}],"table": "","extra": "#0\nsum(#1)\nsum(#2)"}],"table": "","extra": "__internal_decompress_string(#0)\n#1\n#2\n"}],"table": "","extra": "__internal_compress_string_ubigint(#0)\n#1\n#2\n"}],"table": "","extra": "ORDERS:\nlineitem.l_shipmode ASC"}],"table": "","extra": "__internal_decompress_string(#0)\n#1\n#2\n"}
%%%%%%%%%%%%%%%% Running Query #  13  threads:  1
SELECT c_count, count(*) AS custdist FROM ( SELECT c_custkey, count(o_orderkey) FROM customer LEFT OUTER JOIN orders ON c_custkey = o_custkey AND o_comment NOT LIKE '%special%requests%' GROUP BY c_custkey) AS c_orders (c_custkey, c_count) GROUP BY c_count ORDER BY custdist DESC, c_count DESC;
Run:  None SELECT c_count, count(*) AS custdist FROM ( SELECT c_custkey, count(o_orderkey) FROM customer LEFT OUTER JOIN orders ON c_custkey = o_custkey AND o_comment NOT LIKE '%special%requests%' GROUP BY c_custkey) AS c_orders (c_custkey, c_count) GROUP BY c_count ORDER BY custdist DESC, c_count DESC;
Avg Time in sec:  0.41783896181732416  output size:  42
    c_count  custdist
0         0     50004
1        10      6668
2         9      6563
3        11      6004
4         8      5890
5        12      5600
6        13      5029
7        19      4805
8         7      4680
9        18      4531
10       20      4507
11       14      4473
12       15      4463
13       17      4445
14       16      4410
15       21      4168
16       22      3742
17        6      3273
18       23      3189
19       24      2700
20       25      2090
21        5      1957
22       26      1653
23       27      1177
24        4      1010
25       28       901
26       29       564
27        3       408
28       30       378
29       31       242
30       32       133
31        2       128
32       33        72
33       34        52
34       35        32
35       36        20
36        1        20
37       37         8
38       38         4
39       41         3
40       40         3
41       39         1
{'name': 'Query', 'result': 0.415046, 'timing': 0.415046, 'cardinality': 0, 'extra-info': "SELECT c_count, count(*) AS custdist FROM ( SELECT c_custkey, count(o_orderkey) FROM customer LEFT OUTER JOIN orders ON c_custkey = o_custkey AND o_comment NOT LIKE '%special%requests%' GROUP BY c_custkey) AS c_orders (c_custkey, c_count) GROUP BY c_count ORDER BY custdist DESC, c_count DESC;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 9e-06, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'ORDER_BY', 'timing': 3.8e-05, 'cardinality': 42, 'extra_info': 'ORDERS:\ncount_star() DESC\nc_orders.c_count DESC', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.003752, 'cardinality': 42, 'extra_info': '#0\ncount_star()', 'children': [{'name': 'PROJECTION', 'timing': 1.4e-05, 'cardinality': 150000, 'extra_info': 'c_count\n', 'children': [{'name': 'PROJECTION', 'timing': 1.6e-05, 'cardinality': 150000, 'extra_info': 'count(o_orderkey)\n', 'children': [{'name': 'PROJECTION', 'timing': 0.000126, 'cardinality': 150000, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n#1\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.114056, 'cardinality': 150000, 'extra_info': '#0\ncount(#1)', 'children': [{'name': 'PROJECTION', 'timing': 0.000535, 'cardinality': 1534302, 'extra_info': 'c_custkey\no_orderkey\n', 'children': [{'name': 'PROJECTION', 'timing': 0.006138, 'cardinality': 1534302, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n#1\n#2\n__internal_compress_integral_uinteger(#3, 1)\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.12678, 'cardinality': 1534302, 'extra_info': 'RIGHT\no_custkey = c_custkey\n\n[INFOSEPARATOR]\nEC: 300000\n', 'children': [{'name': 'FILTER', 'timing': 0.099838, 'cardinality': 1484298, 'extra_info': "(o_comment !~~ '%special%requests%')\n[INFOSEPARATOR]\nEC: 300000", 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.053567, 'cardinality': 1500000, 'extra_info': 'orders\n[INFOSEPARATOR]\no_custkey\no_comment\no_orderkey\n[INFOSEPARATOR]\nEC: 1500000', 'children': []}]}, {'name': 'SEQ_SCAN ', 'timing': 0.000159, 'cardinality': 150000, 'extra_info': 'customer\n[INFOSEPARATOR]\nc_custkey\n[INFOSEPARATOR]\nEC: 150000', 'children': []}]}]}]}]}]}]}]}]}]}]}]}
X {'RESULT_COLLECTOR0': 9e-06, 'ORDER_BY1': 3.8e-05, 'HASH_GROUP_BY2': 0.003752, 'PROJECTION3': 1.4e-05, 'PROJECTION4': 1.6e-05, 'PROJECTION5': 0.000126, 'HASH_GROUP_BY6': 0.114056, 'PROJECTION7': 0.000535, 'PROJECTION8': 0.006138, 'HASH_JOIN9': 0.12678, 'FILTER10': 0.099838, 'SEQ_SCAN 11': 0.053567, 'SEQ_SCAN 12': 0.000159}
**** output size:  42
LINEAGE_5_FILTER_1
LINEAGE_5_HASH_GROUP_BY_10
LINEAGE_5_HASH_GROUP_BY_6
LINEAGE_5_HASH_JOIN_3
LINEAGE_5_ORDER_BY_11
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_2
SELECT c_count, count(*) AS custdist FROM ( SELECT c_custkey, count(o_orderkey) FROM customer LEFT OUTER JOIN orders ON c_custkey = o_custkey AND o_comment NOT LIKE '%special%requests%' GROUP BY c_custkey) AS c_orders (c_custkey, c_count) GROUP BY c_count ORDER BY custdist DESC, c_count DESC;
compressed filter_log_size: 76866
compressed filter_log_buffer_size: 68140
compressed limit_offset_size: 576
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 576
compressed perfect_full_scan_ht_log_buffer_size: 0
compressed perfect_probe_ht_log_size: 576
compressed perfect_probe_ht_log_buffer_size: 0
compressed row_group_log_size: 6704
compressed row_group_log_buffer_size: 0
compressed scatter_log_size: 5453661
compressed scatter_log_buffer_size: 5444219
compressed scatter_sel_log_size: 606479
compressed scatter_sel_log_buffer_size: 604860
compressed gather_log_size: 576
compressed gather_log_buffer_size: 0
compressed combine_log_size: 10567
compressed combine_log_buffer_size: 9248
compressed finalize_states_log_size: 61331
compressed finalize_states_log_buffer_size: 60088
compressed join_gather_log_size: 5934588
compressed join_gather_log_buffer_size: 5886173
compressed reorder_log_size: 971
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 576
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 576
compressed nlj_log_buffer_size: 0
compressed total_size: 12154623
compressed total_buffer_size: 12072728
compressed total_element_size: 81895

Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│       promo_revenue       │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│    UNGROUPED_AGGREGATE    │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│          sum(#0)          │                             
│          sum(#1)          │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│CASE  WHEN (prefix(p_type, │                             
│      'PROMO')) THEN (     │                             
│(l_extendedprice * (1....  │                             
│     )) ELSE 0.0000 END    │                             
│ (l_extendedprice * (1.00 -│                             
│        l_discount))       │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         HASH_JOIN         │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│           INNER           │                             
│   l_partkey = p_partkey   │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐              
│        Build Min: 1       │              │              
│     Build Max: 200000     │              │              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              
│         EC: 641407        │              │              
└─────────────┬─────────────┘              │                                           
┌─────────────┴─────────────┐┌─────────────┴─────────────┐
│         SEQ_SCAN          ││         SEQ_SCAN          │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│          lineitem         ││            part           │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│         l_partkey         ││         p_partkey         │
│      l_extendedprice      ││           p_type          │
│         l_discount        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││         EC: 200000        │
│ Filters: l_shipdate>='1995││                           │
│-09-01'::DATE AND l_sh...  ││                           │
│  <'1995-10-01'::DATE AND  ││                           │
│   l_shipdate IS NOT NULL  ││                           │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │
│        EC: 1200243        ││                           │
└───────────────────────────┘└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

compressed filter_log_size: 384
compressed filter_log_buffer_size: 0
compressed limit_offset_size: 384
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 460618
compressed perfect_full_scan_ht_log_buffer_size: 459850
compressed perfect_probe_ht_log_size: 382794
compressed perfect_probe_ht_log_buffer_size: 343598
compressed row_group_log_size: 296464
compressed row_group_log_buffer_size: 255158
compressed scatter_log_size: 384
compressed scatter_log_buffer_size: 0
compressed scatter_sel_log_size: 857302
compressed scatter_sel_log_buffer_size: 855625
compressed gather_log_size: 384
compressed gather_log_buffer_size: 0
compressed combine_log_size: 384
compressed combine_log_buffer_size: 0
compressed finalize_states_log_size: 384
compressed finalize_states_log_buffer_size: 0
compressed join_gather_log_size: 384
compressed join_gather_log_buffer_size: 0
compressed reorder_log_size: 576
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 384
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 384
compressed nlj_log_buffer_size: 0
compressed total_size: 2001210
compressed total_buffer_size: 1914231
compressed total_element_size: 86979

Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                                                          
│         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│__internal_decompress_integ│                                                          
│     ral_bigint(#0, 1)     │                                                          
│             #1            │                                                          
│             #2            │                                                          
│__internal_decompress_strin│                                                          
│           g(#3)           │                                                          
│             #4            │                                                          
└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          
│          ORDER_BY         │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│          ORDERS:          │                                                          
│   supplier.s_suppkey ASC  │                                                          
└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          
│         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│__internal_compress_integra│                                                          
│     l_usmallint(#0, 1)    │                                                          
│             #1            │                                                          
│             #2            │                                                          
│__internal_compress_string_│                                                          
│        hugeint(#3)        │                                                          
│             #4            │                                                          
└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          
│         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│         s_suppkey         │                                                          
│           s_name          │                                                          
│         s_address         │                                                          
│          s_phone          │                                                          
│       total_revenue       │                                                          
└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          
│         HASH_JOIN         │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│           INNER           │                                                          
│  s_suppkey = supplier_no  │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐                                           
│        Build Min: 1       │              │                                           
│      Build Max: 10000     │              │                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                           
│           EC: 4           │              │                                           
└─────────────┬─────────────┘              │                                                                        
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             
│         SEQ_SCAN          ││         HASH_JOIN         │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│          supplier         ││           INNER           │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││  total_revenue = SUBQUERY │                             
│         s_suppkey         ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│           s_name          ││           EC: 3           ├──────────────┐              
│         s_address         ││                           │              │              
│          s_phone          ││                           │              │              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │              │              
│         EC: 10000         ││                           │              │              
└───────────────────────────┘└─────────────┬─────────────┘              │                                           
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
                             │         PROJECTION        ││    UNGROUPED_AGGREGATE    │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                             │__internal_decompress_integ││         first(#0)         │
                             │     ral_bigint(#0, 1)     ││                           │
                             │             #1            ││                           │
                             └─────────────┬─────────────┘└─────────────┬─────────────┘                             
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
                             │       HASH_GROUP_BY       ││         PROJECTION        │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                             │             #0            ││             #0            │
                             │    sum_no_overflow(#1)    ││                           │
                             └─────────────┬─────────────┘└─────────────┬─────────────┘                             
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
                             │         PROJECTION        ││      STREAMING_LIMIT      │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │
                             │         l_suppkey         ││                           │
                             │ (l_extendedprice * (1.00 -││                           │
                             │        l_discount))       ││                           │
                             └─────────────┬─────────────┘└─────────────┬─────────────┘                             
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
                             │         PROJECTION        ││    UNGROUPED_AGGREGATE    │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                             │__internal_compress_integra││          max(#0)          │
                             │     l_usmallint(#0, 1)    ││                           │
                             │             #1            ││                           │
                             │             #2            ││                           │
                             └─────────────┬─────────────┘└─────────────┬─────────────┘                             
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
                             │         SEQ_SCAN          ││         PROJECTION        │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                             │          lineitem         ││       total_revenue       │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │
                             │         l_suppkey         ││                           │
                             │      l_extendedprice      ││                           │
                             │         l_discount        ││                           │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │
                             │ Filters: l_shipdate>='1996││                           │
                             │-01-01'::DATE AND l_sh...  ││                           │
                             │  <'1996-04-01'::DATE AND  ││                           │
                             │   l_shipdate IS NOT NULL  ││                           │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │
                             │        EC: 1200243        ││                           │
                             └───────────────────────────┘└─────────────┬─────────────┘                             
                                                          ┌─────────────┴─────────────┐
                                                          │         PROJECTION        │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │  sum((l_extendedprice *   │
                                                          │(CAST(1 AS DECIMAL(16,2)) -│
                                                          │        l_discount)))      │
                                                          └─────────────┬─────────────┘                             
                                                          ┌─────────────┴─────────────┐
                                                          │         PROJECTION        │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │__internal_decompress_integ│
                                                          │     ral_bigint(#0, 1)     │
                                                          │             #1            │
                                                          └─────────────┬─────────────┘                             
                                                          ┌─────────────┴─────────────┐
                                                          │       HASH_GROUP_BY       │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │             #0            │
                                                          │    sum_no_overflow(#1)    │
                                                          └─────────────┬─────────────┘                             
                                                          ┌─────────────┴─────────────┐
                                                          │         PROJECTION        │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │         l_suppkey         │
                                                          │ (l_extendedprice * (1.00 -│
                                                          │        l_discount))       │
                                                          └─────────────┬─────────────┘                             
                                                          ┌─────────────┴─────────────┐
                                                          │         PROJECTION        │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │__internal_compress_integra│
                                                          │     l_usmallint(#0, 1)    │
                                                          │             #1            │
                                                          │             #2            │
                                                          └─────────────┬─────────────┘                             
                                                          ┌─────────────┴─────────────┐
                                                          │         SEQ_SCAN          │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │          lineitem         │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │         l_suppkey         │
                                                          │      l_extendedprice      │
                                                          │         l_discount        │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │ Filters: l_shipdate>='1996│
                                                          │-01-01'::DATE AND l_sh...  │
                                                          │  <'1996-04-01'::DATE AND  │
                                                          │   l_shipdate IS NOT NULL  │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │        EC: 1200243        │
                                                          └───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

   query_id  ...                                               plan
0         5  ...  {"name": "ORDER_BY", "opid": "11", "children":...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               SELECT c_count, count(*) AS custdist FROM ( SE...
size_bytes_max                                               12154623
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "ORDER_BY", "opid": "11", "children":...
Name: 0, dtype: object
{"name": "ORDER_BY", "opid": "11", "children": [{"name": "HASH_GROUP_BY", "opid": "10", "children": [{"name": "PROJECTION", "opid": "9", "children": [{"name": "PROJECTION", "opid": "8", "children": [{"name": "PROJECTION", "opid": "7", "children": [{"name": "HASH_GROUP_BY", "opid": "6", "children": [{"name": "PROJECTION", "opid": "5", "children": [{"name": "PROJECTION", "opid": "4", "children": [{"name": "HASH_JOIN", "opid": "3", "children": [{"name": "FILTER", "opid": "1", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "orders","extra": "orders\n[INFOSEPARATOR]\no_custkey\no_comment\no_orderkey\n[INFOSEPARATOR]\nEC: 1500000"}],"table": "","extra": "(o_comment !~~ '%special%requests%')\n[INFOSEPARATOR]\nEC: 300000"},{"name": "SEQ_SCAN ", "opid": "2", "children": [],"table": "customer","extra": "customer\n[INFOSEPARATOR]\nc_custkey\n[INFOSEPARATOR]\nEC: 150000"}],"table": "","extra": "RIGHT\no_custkey = c_custkey\n\n[INFOSEPARATOR]\nEC: 300000\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n#1\n#2\n__internal_compress_integral_uinteger(#3, 1)\n"}],"table": "","extra": "c_custkey\no_orderkey\n"}],"table": "","extra": "#0\ncount(#1)"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n#1\n"}],"table": "","extra": "count(o_orderkey)\n"}],"table": "","extra": "c_count\n"}],"table": "","extra": "#0\ncount_star()"}],"table": "","extra": "ORDERS:\ncount_star() DESC\nc_orders.c_count DESC"}
%%%%%%%%%%%%%%%% Running Query #  14  threads:  1
SELECT 100.00 * sum( CASE WHEN p_type LIKE 'PROMO%' THEN l_extendedprice * (1 - l_discount) ELSE 0 END) / sum(l_extendedprice * (1 - l_discount)) AS promo_revenue FROM lineitem, part WHERE l_partkey = p_partkey AND l_shipdate >= date '1995-09-01' AND l_shipdate < CAST('1995-10-01' AS date);
Run:  None SELECT 100.00 * sum( CASE WHEN p_type LIKE 'PROMO%' THEN l_extendedprice * (1 - l_discount) ELSE 0 END) / sum(l_extendedprice * (1 - l_discount)) AS promo_revenue FROM lineitem, part WHERE l_partkey = p_partkey AND l_shipdate >= date '1995-09-01' AND l_shipdate < CAST('1995-10-01' AS date);
Avg Time in sec:  0.15453707100823522  output size:  1
   promo_revenue
0      16.380779
{'name': 'Query', 'result': 0.151363, 'timing': 0.151363, 'cardinality': 0, 'extra-info': "SELECT 100.00 * sum( CASE WHEN p_type LIKE 'PROMO%' THEN l_extendedprice * (1 - l_discount) ELSE 0 END) / sum(l_extendedprice * (1 - l_discount)) AS promo_revenue FROM lineitem, part WHERE l_partkey = p_partkey AND l_shipdate >= date '1995-09-01' AND l_shipdate < CAST('1995-10-01' AS date);", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 3e-06, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 8e-06, 'cardinality': 1, 'extra_info': 'promo_revenue\n', 'children': [{'name': 'UNGROUPED_AGGREGATE', 'timing': 0.000238, 'cardinality': 1, 'extra_info': 'sum(#0)\nsum(#1)', 'children': [{'name': 'PROJECTION', 'timing': 0.001301, 'cardinality': 75983, 'extra_info': "CASE  WHEN (prefix(p_type, 'PROMO')) THEN ((l_extendedprice * (1.00 - l_discount))) ELSE 0.0000 END\n(l_extendedprice * (1.00 - l_discount))\n", 'children': [{'name': 'HASH_JOIN', 'timing': 0.073254, 'cardinality': 75983, 'extra_info': 'INNER\nl_partkey = p_partkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 641407\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.04909, 'cardinality': 75983, 'extra_info': "lineitem\n[INFOSEPARATOR]\nl_partkey\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nFilters: l_shipdate>='1995-09-01'::DATE AND l_shipdate<'1995-10-01'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243", 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 0.004854, 'cardinality': 200000, 'extra_info': 'part\n[INFOSEPARATOR]\np_partkey\np_type\n[INFOSEPARATOR]\nEC: 200000', 'children': []}]}]}]}]}]}]}
X {'RESULT_COLLECTOR0': 3e-06, 'PROJECTION1': 8e-06, 'UNGROUPED_AGGREGATE2': 0.000238, 'PROJECTION3': 0.001301, 'HASH_JOIN4': 0.073254, 'SEQ_SCAN 5': 0.04909, 'SEQ_SCAN 6': 0.004854}
**** output size:  1
LINEAGE_5_HASH_JOIN_2
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_1
SELECT 100.00 * sum( CASE WHEN p_type LIKE 'PROMO%' THEN l_extendedprice * (1 - l_discount) ELSE 0 END) / sum(l_extendedprice * (1 - l_discount)) AS promo_revenue FROM lineitem, part WHERE l_partkey = p_partkey AND l_shipdate >= date '1995-09-01' AND l_shipdate < CAST('1995-10-01' AS date);
   query_id  ...                                               plan
0         5  ...  {"name": "PROJECTION", "opid": "5", "children"...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               SELECT 100.00 * sum( CASE WHEN p_type LIKE 'PR...
size_bytes_max                                                2001210
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "PROJECTION", "opid": "5", "children"...
Name: 0, dtype: object
{"name": "PROJECTION", "opid": "5", "children": [{"name": "UNGROUPED_AGGREGATE", "opid": "4", "children": [{"name": "PROJECTION", "opid": "3", "children": [{"name": "HASH_JOIN", "opid": "2", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_partkey\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nFilters: l_shipdate>='1995-09-01'::DATE AND l_shipdate<'1995-10-01'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243"},{"name": "SEQ_SCAN ", "opid": "1", "children": [],"table": "part","extra": "part\n[INFOSEPARATOR]\np_partkey\np_type\n[INFOSEPARATOR]\nEC: 200000"}],"table": "","extra": "INNER\nl_partkey = p_partkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 641407\n"}],"table": "","extra": "CASE  WHEN (prefix(p_type, 'PROMO')) THEN ((l_extendedprice * (1.00 - l_discount))) ELSE 0.0000 END\n(l_extendedprice * (1.00 - l_discount))\n"}],"table": "","extra": "sum(#0)\nsum(#1)"}],"table": "","extra": "promo_revenue\n"}
%%%%%%%%%%%%%%%% Running Query #  15  threads:  1
with revenue0 (supplier_no, total_revenue) as ( select l_suppkey, sum(l_extendedprice * (1 - l_discount)) from lineitem where l_shipdate >= date '1996-01-01' and l_shipdate < date '1996-01-01' + interval '3' month group by l_suppkey ) SELECT s_suppkey, s_name, s_address, s_phone, total_revenue FROM supplier, revenue0 WHERE s_suppkey = supplier_no AND total_revenue = ( SELECT max(total_revenue) FROM revenue0) ORDER BY s_suppkey;
Run:  None with revenue0 (supplier_no, total_revenue) as ( select l_suppkey, sum(l_extendedprice * (1 - l_discount)) from lineitem where l_shipdate >= date '1996-01-01' and l_shipdate < date '1996-01-01' + interval '3' month group by l_suppkey ) SELECT s_suppkey, s_name, s_address, s_phone, total_revenue FROM supplier, revenue0 WHERE s_suppkey = supplier_no AND total_revenue = ( SELECT max(total_revenue) FROM revenue0) ORDER BY s_suppkey;
Avg Time in sec:  0.17740426631644368  output size:  1
   s_suppkey              s_name  ...          s_phone total_revenue
0       8449  Supplier#000008449  ...  20-469-856-8873  1.772627e+06

[1 rows x 5 columns]
{'name': 'Query', 'result': 0.174226, 'timing': 0.174226, 'cardinality': 0, 'extra-info': "with revenue0 (supplier_no, total_revenue) as ( select l_suppkey, sum(l_extendedprice * (1 - l_discount)) from lineitem where l_shipdate >= date '1996-01-01' and l_shipdate < date '1996-01-01' + interval '3' month group by l_suppkey ) SELECT s_suppkey, s_name, s_address, s_phone, total_revenue FROM supplier, revenue0 WHERE s_suppkey = supplier_no AND total_revenue = ( SELECT max(total_revenue) FROM revenue0) ORDER BY s_suppkey;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 1e-05, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 3e-06, 'cardinality': 1, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n#1\n#2\n__internal_decompress_string(#3)\n#4\n', 'children': [{'name': 'ORDER_BY', 'timing': 3.3e-05, 'cardinality': 1, 'extra_info': 'ORDERS:\nsupplier.s_suppkey ASC', 'children': [{'name': 'PROJECTION', 'timing': 2e-05, 'cardinality': 1, 'extra_info': '__internal_compress_integral_usmallint(#0, 1)\n#1\n#2\n__internal_compress_string_hugeint(#3)\n#4\n', 'children': [{'name': 'PROJECTION', 'timing': 2e-06, 'cardinality': 1, 'extra_info': 's_suppkey\ns_name\ns_address\ns_phone\ntotal_revenue\n', 'children': [{'name': 'HASH_JOIN', 'timing': 8.8e-05, 'cardinality': 1, 'extra_info': 'INNER\ns_suppkey = supplier_no\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 4\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.000722, 'cardinality': 10000, 'extra_info': 'supplier\n[INFOSEPARATOR]\ns_suppkey\ns_name\ns_address\ns_phone\n[INFOSEPARATOR]\nEC: 10000', 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.000117, 'cardinality': 1, 'extra_info': 'INNER\ntotal_revenue = SUBQUERY\n\n[INFOSEPARATOR]\nEC: 3\n', 'children': [{'name': 'PROJECTION', 'timing': 9e-06, 'cardinality': 10000, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n#1\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.018116, 'cardinality': 10000, 'extra_info': '#0\nsum_no_overflow(#1)', 'children': [{'name': 'PROJECTION', 'timing': 0.010052, 'cardinality': 225954, 'extra_info': 'l_suppkey\n(l_extendedprice * (1.00 - l_discount))\n', 'children': [{'name': 'PROJECTION', 'timing': 0.004881, 'cardinality': 225954, 'extra_info': '__internal_compress_integral_usmallint(#0, 1)\n#1\n#2\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.043411, 'cardinality': 225954, 'extra_info': "lineitem\n[INFOSEPARATOR]\nl_suppkey\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nFilters: l_shipdate>='1996-01-01'::DATE AND l_shipdate<'1996-04-01'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243", 'children': []}]}]}]}]}, {'name': 'UNGROUPED_AGGREGATE', 'timing': 2e-06, 'cardinality': 1, 'extra_info': 'first(#0)', 'children': [{'name': 'PROJECTION', 'timing': 0.0, 'cardinality': 1, 'extra_info': '#0\n', 'children': [{'name': 'STREAMING_LIMIT', 'timing': 2e-06, 'cardinality': 1, 'extra_info': '', 'children': [{'name': 'UNGROUPED_AGGREGATE', 'timing': 2.3e-05, 'cardinality': 1, 'extra_info': 'max(#0)', 'children': [{'name': 'PROJECTION', 'timing': 1e-06, 'cardinality': 10000, 'extra_info': 'total_revenue\n', 'children': [{'name': 'PROJECTION', 'timing': 1e-06, 'cardinality': 10000, 'extra_info': 'sum((l_extendedprice * (CAST(1 AS DECIMAL(16,2)) - l_discount)))\n', 'children': [{'name': 'PROJECTION', 'timing': 8e-06, 'cardinality': 10000, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n#1\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.016979, 'cardinality': 10000, 'extra_info': '#0\nsum_no_overflow(#1)', 'children': [{'name': 'PROJECTION', 'timing': 0.010231, 'cardinality': 225954, 'extra_info': 'l_suppkey\n(l_extendedprice * (1.00 - l_discount))\n', 'children': [{'name': 'PROJECTION', 'timing': 0.014554, 'cardinality': 225954, 'extra_info': '__internal_compress_integral_usmallint(#0, 1)\n#1\n#2\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.0448, 'cardinality': 225954, 'extra_info': "lineitem\n[INFOSEPARATOR]\nl_suppkey\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nFilters: l_shipdate>='1996-01-01'::DATE AND l_shipdate<'1996-04-01'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243", 'children': []}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}
compressed filter_log_size: 928
compressed filter_log_buffer_size: 0
compressed limit_offset_size: 1072
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 1328
compressed perfect_full_scan_ht_log_buffer_size: 16
compressed perfect_probe_ht_log_size: 1320
compressed perfect_probe_ht_log_buffer_size: 8
compressed row_group_log_size: 874164
compressed row_group_log_buffer_size: 792972
compressed scatter_log_size: 1464535
compressed scatter_log_buffer_size: 1432966
compressed scatter_sel_log_size: 1424
compressed scatter_sel_log_buffer_size: 16
compressed gather_log_size: 928
compressed gather_log_buffer_size: 0
compressed combine_log_size: 928
compressed combine_log_buffer_size: 0
compressed finalize_states_log_size: 10516
compressed finalize_states_log_buffer_size: 9282
compressed join_gather_log_size: 1372
compressed join_gather_log_buffer_size: 12
compressed reorder_log_size: 1472
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 928
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 928
compressed nlj_log_buffer_size: 0
compressed total_size: 2361843
compressed total_buffer_size: 2235272
compressed total_element_size: 126571

Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│__internal_decompress_strin│                                                                                       
│           g(#0)           │                                                                                       
│             #1            │                                                                                       
│__internal_decompress_integ│                                                                                       
│     ral_integer(#2, 1)    │                                                                                       
│             #3            │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│          ORDER_BY         │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│          ORDERS:          │                                                                                       
│  count(DISTINCT partsupp  │                                                                                       
│     .ps_suppkey) DESC     │                                                                                       
│      part.p_brand ASC     │                                                                                       
│      part.p_type ASC      │                                                                                       
│      part.p_size ASC      │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│__internal_compress_string_│                                                                                       
│        hugeint(#0)        │                                                                                       
│             #1            │                                                                                       
│__internal_compress_integra│                                                                                       
│     l_utinyint(#2, 1)     │                                                                                       
│             #3            │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│__internal_decompress_strin│                                                                                       
│           g(#0)           │                                                                                       
│             #1            │                                                                                       
│__internal_decompress_integ│                                                                                       
│     ral_integer(#2, 1)    │                                                                                       
│             #3            │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│       HASH_GROUP_BY       │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│             #0            │                                                                                       
│             #1            │                                                                                       
│             #2            │                                                                                       
│     count(DISTINCT #3)    │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│          p_brand          │                                                                                       
│           p_type          │                                                                                       
│           p_size          │                                                                                       
│         ps_suppkey        │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│             #0            │                                                                                       
│__internal_compress_string_│                                                                                       
│        hugeint(#1)        │                                                                                       
│             #2            │                                                                                       
│__internal_compress_integra│                                                                                       
│     l_utinyint(#3, 1)     │                                                                                       
│             #4            │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│             #1            │                                                                                       
│             #3            │                                                                                       
│             #4            │                                                                                       
│             #5            │                                                                                       
│             #6            │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│           FILTER          │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│       (NOT SUBQUERY)      │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│         EC: 33778         │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         HASH_JOIN         │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│            MARK           │                                                                                       
│      ps_suppkey = #0      ├────────────────────────────────────────────────────────────────────────┐              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                        │              
│         EC: 168893        │                                                                        │              
└─────────────┬─────────────┘                                                                        │                                           
┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐
│         HASH_JOIN         │                                                          │         PROJECTION        │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│           INNER           │                                                          │         s_suppkey         │
│   ps_partkey = p_partkey  │                                                          │                           │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐                                           │                           │
│        Build Min: 1       │              │                                           │                           │
│     Build Max: 200000     │              │                                           │                           │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                           │                           │
│         EC: 168893        │              │                                           │                           │
└─────────────┬─────────────┘              │                                           └─────────────┬─────────────┘                             
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐
│         SEQ_SCAN          ││           FILTER          │                             │           FILTER          │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│          partsupp         ││ (IN (...) AND (p_brand != │                             │  (s_comment ~~ '%Customer │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││'Brand#45') AND (NOT prefix│                             │       %Complaints%')      │
│         ps_partkey        ││(p_type, 'MEDIUM POLIS...  │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│         ps_suppkey        ││             )             │                             │          EC: 2000         │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │                           │
│         EC: 800000        ││         EC: 40000         │                             │                           │
└───────────────────────────┘└─────────────┬─────────────┘                             └─────────────┬─────────────┘                             
                             ┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐
                             │         HASH_JOIN         │                             │         SEQ_SCAN          │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                             │            MARK           │                             │          supplier         │
                             │        p_size = #0        │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐              │         s_comment         │
                             │         EC: 200000        │              │              │         s_suppkey         │
                             │                           │              │              │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                             │                           │              │              │         EC: 10000         │
                             └─────────────┬─────────────┘              │              └───────────────────────────┘                             
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             
                             │         SEQ_SCAN          ││      COLUMN_DATA_SCAN     │                             
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                             
                             │            part           ││                           │                             
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                             
                             │         p_partkey         ││                           │                             
                             │          p_brand          ││                           │                             
                             │           p_type          ││                           │                             
                             │           p_size          ││                           │                             
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                             
                             │         EC: 200000        ││                           │                             
                             └───────────────────────────┘└───────────────────────────┘                                                          

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

X {'RESULT_COLLECTOR0': 1e-05, 'PROJECTION1': 3e-06, 'ORDER_BY2': 3.3e-05, 'PROJECTION3': 2e-05, 'PROJECTION4': 2e-06, 'HASH_JOIN5': 8.8e-05, 'SEQ_SCAN 6': 0.000722, 'HASH_JOIN7': 0.000117, 'PROJECTION8': 9e-06, 'HASH_GROUP_BY9': 0.018116, 'PROJECTION10': 0.010052, 'PROJECTION11': 0.004881, 'SEQ_SCAN 12': 0.043411, 'UNGROUPED_AGGREGATE13': 2e-06, 'PROJECTION14': 0.0, 'STREAMING_LIMIT15': 2e-06, 'UNGROUPED_AGGREGATE16': 2.3e-05, 'PROJECTION17': 1e-06, 'PROJECTION18': 1e-06, 'PROJECTION19': 8e-06, 'HASH_GROUP_BY20': 0.016979, 'PROJECTION21': 0.010231, 'PROJECTION22': 0.014554, 'SEQ_SCAN 23': 0.0448}
**** output size:  1
LINEAGE_5_HASH_GROUP_BY_4
LINEAGE_5_HASH_GROUP_BY_9
LINEAGE_5_HASH_JOIN_17
LINEAGE_5_HASH_JOIN_18
LINEAGE_5_ORDER_BY_21
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_1
LINEAGE_5_SEQ_SCAN_6
LINEAGE_5_STREAMING_LIMIT_14
with revenue0 (supplier_no, total_revenue) as ( select l_suppkey, sum(l_extendedprice * (1 - l_discount)) from lineitem where l_shipdate >= date '1996-01-01' and l_shipdate < date '1996-01-01' + interval '3' month group by l_suppkey ) SELECT s_suppkey, s_name, s_address, s_phone, total_revenue FROM supplier, revenue0 WHERE s_suppkey = supplier_no AND total_revenue = ( SELECT max(total_revenue) FROM revenue0) ORDER BY s_suppkey;
   query_id  ...                                               plan
0         5  ...  {"name": "PROJECTION", "opid": "22", "children...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               with revenue0 (supplier_no, total_revenue) as ...
size_bytes_max                                                2361843
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "PROJECTION", "opid": "22", "children...
Name: 0, dtype: object
{"name": "PROJECTION", "opid": "22", "children": [{"name": "ORDER_BY", "opid": "21", "children": [{"name": "PROJECTION", "opid": "20", "children": [{"name": "PROJECTION", "opid": "19", "children": [{"name": "HASH_JOIN", "opid": "18", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "supplier","extra": "supplier\n[INFOSEPARATOR]\ns_suppkey\ns_name\ns_address\ns_phone\n[INFOSEPARATOR]\nEC: 10000"},{"name": "HASH_JOIN", "opid": "17", "children": [{"name": "PROJECTION", "opid": "5", "children": [{"name": "HASH_GROUP_BY", "opid": "4", "children": [{"name": "PROJECTION", "opid": "3", "children": [{"name": "PROJECTION", "opid": "2", "children": [{"name": "SEQ_SCAN ", "opid": "1", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_suppkey\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nFilters: l_shipdate>='1996-01-01'::DATE AND l_shipdate<'1996-04-01'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243"}],"table": "","extra": "__internal_compress_integral_usmallint(#0, 1)\n#1\n#2\n"}],"table": "","extra": "l_suppkey\n(l_extendedprice * (1.00 - l_discount))\n"}],"table": "","extra": "#0\nsum_no_overflow(#1)"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n#1\n"},{"name": "UNGROUPED_AGGREGATE", "opid": "16", "children": [{"name": "PROJECTION", "opid": "15", "children": [{"name": "STREAMING_LIMIT", "opid": "14", "children": [{"name": "UNGROUPED_AGGREGATE", "opid": "13", "children": [{"name": "PROJECTION", "opid": "12", "children": [{"name": "PROJECTION", "opid": "11", "children": [{"name": "PROJECTION", "opid": "10", "children": [{"name": "HASH_GROUP_BY", "opid": "9", "children": [{"name": "PROJECTION", "opid": "8", "children": [{"name": "PROJECTION", "opid": "7", "children": [{"name": "SEQ_SCAN ", "opid": "6", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_suppkey\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nFilters: l_shipdate>='1996-01-01'::DATE AND l_shipdate<'1996-04-01'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243"}],"table": "","extra": "__internal_compress_integral_usmallint(#0, 1)\n#1\n#2\n"}],"table": "","extra": "l_suppkey\n(l_extendedprice * (1.00 - l_discount))\n"}],"table": "","extra": "#0\nsum_no_overflow(#1)"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n#1\n"}],"table": "","extra": "sum((l_extendedprice * (CAST(1 AS DECIMAL(16,2)) - l_discount)))\n"}],"table": "","extra": "total_revenue\n"}],"table": "","extra": "max(#0)"}],"table": "","extra": ""}],"table": "","extra": "#0\n"}],"table": "","extra": "first(#0)"}],"table": "","extra": "INNER\ntotal_revenue = SUBQUERY\n\n[INFOSEPARATOR]\nEC: 3\n"}],"table": "","extra": "INNER\ns_suppkey = supplier_no\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 4\n"}],"table": "","extra": "s_suppkey\ns_name\ns_address\ns_phone\ntotal_revenue\n"}],"table": "","extra": "__internal_compress_integral_usmallint(#0, 1)\n#1\n#2\n__internal_compress_string_hugeint(#3)\n#4\n"}],"table": "","extra": "ORDERS:\nsupplier.s_suppkey ASC"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n#1\n#2\n__internal_decompress_string(#3)\n#4\n"}
%%%%%%%%%%%%%%%% Running Query #  16  threads:  1
SELECT p_brand, p_type, p_size, count(DISTINCT ps_suppkey) AS supplier_cnt FROM partsupp, part WHERE p_partkey = ps_partkey AND p_brand <> 'Brand#45' AND p_type NOT LIKE 'MEDIUM POLISHED%' AND p_size IN (49, 14, 23, 45, 19, 3, 36, 9) AND ps_suppkey NOT IN ( SELECT s_suppkey FROM supplier WHERE s_comment LIKE '%Customer%Complaints%') GROUP BY p_brand, p_type, p_size ORDER BY supplier_cnt DESC, p_brand, p_type, p_size;
Run:  None SELECT p_brand, p_type, p_size, count(DISTINCT ps_suppkey) AS supplier_cnt FROM partsupp, part WHERE p_partkey = ps_partkey AND p_brand <> 'Brand#45' AND p_type NOT LIKE 'MEDIUM POLISHED%' AND p_size IN (49, 14, 23, 45, 19, 3, 36, 9) AND ps_suppkey NOT IN ( SELECT s_suppkey FROM supplier WHERE s_comment LIKE '%Customer%Complaints%') GROUP BY p_brand, p_type, p_size ORDER BY supplier_cnt DESC, p_brand, p_type, p_size;
Avg Time in sec:  0.09611404407769442  output size:  18314
        p_brand                    p_type  p_size  supplier_cnt
0      Brand#41        MEDIUM BRUSHED TIN       3            28
1      Brand#54   STANDARD BRUSHED COPPER      14            27
2      Brand#11      STANDARD BRUSHED TIN      23            24
3      Brand#11  STANDARD BURNISHED BRASS      36            24
4      Brand#15    MEDIUM ANODIZED NICKEL       3            24
...         ...                       ...     ...           ...
18309  Brand#52      MEDIUM BRUSHED BRASS      45             3
18310  Brand#53        MEDIUM BRUSHED TIN      45             3
18311  Brand#54    ECONOMY POLISHED BRASS       9             3
18312  Brand#55        PROMO PLATED BRASS      19             3
18313  Brand#55       STANDARD PLATED TIN      49             3

[18314 rows x 4 columns]
{'name': 'Query', 'result': 0.092158, 'timing': 0.092158, 'cardinality': 0, 'extra-info': "SELECT p_brand, p_type, p_size, count(DISTINCT ps_suppkey) AS supplier_cnt FROM partsupp, part WHERE p_partkey = ps_partkey AND p_brand <> 'Brand#45' AND p_type NOT LIKE 'MEDIUM POLISHED%' AND p_size IN (49, 14, 23, 45, 19, 3, 36, 9) AND ps_suppkey NOT IN ( SELECT s_suppkey FROM supplier WHERE s_comment LIKE '%Customer%Complaints%') GROUP BY p_brand, p_type, p_size ORDER BY supplier_cnt DESC, p_brand, p_type, p_size;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 0.001333, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 0.000401, 'cardinality': 18314, 'extra_info': '__internal_decompress_string(#0)\n#1\n__internal_decompress_integral_integer(#2, 1)\n#3\n', 'children': [{'name': 'ORDER_BY', 'timing': 0.001821, 'cardinality': 18314, 'extra_info': 'ORDERS:\ncount(DISTINCT partsupp.ps_suppkey) DESC\npart.p_brand ASC\npart.p_type ASC\npart.p_size ASC', 'children': [{'name': 'PROJECTION', 'timing': 0.000174, 'cardinality': 18314, 'extra_info': '__internal_compress_string_hugeint(#0)\n#1\n__internal_compress_integral_utinyint(#2, 1)\n#3\n', 'children': [{'name': 'PROJECTION', 'timing': 0.000371, 'cardinality': 18314, 'extra_info': '__internal_decompress_string(#0)\n#1\n__internal_decompress_integral_integer(#2, 1)\n#3\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.023795, 'cardinality': 18314, 'extra_info': '#0\n#1\n#2\ncount(DISTINCT #3)', 'children': [{'name': 'PROJECTION', 'timing': 0.000162, 'cardinality': 118274, 'extra_info': 'p_brand\np_type\np_size\nps_suppkey\n', 'children': [{'name': 'PROJECTION', 'timing': 0.002573, 'cardinality': 118274, 'extra_info': '#0\n__internal_compress_string_hugeint(#1)\n#2\n__internal_compress_integral_utinyint(#3, 1)\n#4\n', 'children': [{'name': 'PROJECTION', 'timing': 0.000221, 'cardinality': 118274, 'extra_info': '#1\n#3\n#4\n#5\n#6\n', 'children': [{'name': 'FILTER', 'timing': 0.001007, 'cardinality': 118274, 'extra_info': '(NOT SUBQUERY)\n[INFOSEPARATOR]\nEC: 33778', 'children': [{'name': 'HASH_JOIN', 'timing': 0.005037, 'cardinality': 118324, 'extra_info': 'MARK\nps_suppkey = #0\n\n[INFOSEPARATOR]\nEC: 168893\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.012031, 'cardinality': 118324, 'extra_info': 'INNER\nps_partkey = p_partkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 168893\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.00167, 'cardinality': 800000, 'extra_info': 'partsupp\n[INFOSEPARATOR]\nps_partkey\nps_suppkey\n[INFOSEPARATOR]\nEC: 800000', 'children': []}, {'name': 'FILTER', 'timing': 0.00194, 'cardinality': 29581, 'extra_info': "(IN (...) AND (p_brand != 'Brand#45') AND (NOT prefix(p_type, 'MEDIUM POLISHED')))\n[INFOSEPARATOR]\nEC: 40000", 'children': [{'name': 'HASH_JOIN', 'timing': 0.001751, 'cardinality': 200000, 'extra_info': 'MARK\np_size = #0\n\n[INFOSEPARATOR]\nEC: 200000\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.008213, 'cardinality': 200000, 'extra_info': 'part\n[INFOSEPARATOR]\np_partkey\np_brand\np_type\np_size\n[INFOSEPARATOR]\nEC: 200000', 'children': []}, {'name': 'COLUMN_DATA_SCAN', 'timing': 5e-06, 'cardinality': 8, 'extra_info': '', 'children': []}]}]}]}, {'name': 'PROJECTION', 'timing': 1e-06, 'cardinality': 4, 'extra_info': 's_suppkey\n', 'children': [{'name': 'FILTER', 'timing': 0.000256, 'cardinality': 4, 'extra_info': "(s_comment ~~ '%Customer%Complaints%')\n[INFOSEPARATOR]\nEC: 2000", 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.000399, 'cardinality': 10000, 'extra_info': 'supplier\n[INFOSEPARATOR]\ns_comment\ns_suppkey\n[INFOSEPARATOR]\nEC: 10000', 'children': []}]}]}]}]}]}]}]}]}]}]}]}]}]}]}
compressed filter_log_size: 30831
compressed filter_log_buffer_size: 26242
compressed limit_offset_size: 832
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 84061
compressed perfect_full_scan_ht_log_buffer_size: 82845
compressed perfect_probe_ht_log_size: 222443
compressed perfect_probe_ht_log_buffer_size: 215058
compressed row_group_log_size: 5070
compressed row_group_log_buffer_size: 0
compressed scatter_log_size: 56765
compressed scatter_log_buffer_size: 53568
compressed scatter_sel_log_size: 132052
compressed scatter_sel_log_buffer_size: 129512
compressed gather_log_size: 832
compressed gather_log_buffer_size: 0
compressed combine_log_size: 832
compressed combine_log_buffer_size: 0
compressed finalize_states_log_size: 17440
compressed finalize_states_log_buffer_size: 16428
compressed join_gather_log_size: 832
compressed join_gather_log_buffer_size: 0
compressed reorder_log_size: 39139
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 832
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 832
compressed nlj_log_buffer_size: 0
compressed total_size: 592793
compressed total_buffer_size: 523653
compressed total_element_size: 69140

Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                                                                                                                    
│         PROJECTION        │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│         avg_yearly        │                                                                                                                    
└─────────────┬─────────────┘                                                                                                                                                 
┌─────────────┴─────────────┐                                                                                                                    
│    UNGROUPED_AGGREGATE    │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│          sum(#0)          │                                                                                                                    
└─────────────┬─────────────┘                                                                                                                                                 
┌─────────────┴─────────────┐                                                                                                                    
│         PROJECTION        │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│      l_extendedprice      │                                                                                                                    
└─────────────┬─────────────┘                                                                                                                                                 
┌─────────────┴─────────────┐                                                                                                                    
│         PROJECTION        │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│             #0            │                                                                                                                    
│             #3            │                                                                                                                    
│             #4            │                                                                                                                    
└─────────────┬─────────────┘                                                                                                                                                 
┌─────────────┴─────────────┐                                                                                                                    
│           FILTER          │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│(CAST(l_quantity AS DOUBLE)│                                                                                                                    
│         < SUBQUERY)       │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│        EC: 3000607        │                                                                                                                    
└─────────────┬─────────────┘                                                                                                                                                 
┌─────────────┴─────────────┐                                                                                                                    
│      RIGHT_DELIM_JOIN     │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│           RIGHT           │                                                                                                                    
│ p_partkey IS NOT DISTINCT ├───────────────────────────────────────────┐                                                                        
│       FROM p_partkey      │                                           │                                                                        
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                           │                                                                        
│        EC: 3000607        │                                           │                                                                        
└─────────────┬─────────────┘                                           │                                                                                                     
┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐                                                          
│         HASH_JOIN         │                             │         HASH_JOIN         │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│           INNER           │                             │           RIGHT           │                                                          
│   l_partkey = p_partkey   │                             │ p_partkey IS NOT DISTINCT │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐              │       FROM p_partkey      ├───────────────────────────────────────────┐              
│        Build Min: 1       │              │              │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                           │              
│     Build Max: 200000     │              │              │        EC: 3000607        │                                           │              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              │                           │                                           │              
│         EC: 80175         │              │              │                           │                                           │              
└─────────────┬─────────────┘              │              └─────────────┬─────────────┘                                           │                                           
┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐
│         SEQ_SCAN          ││         SEQ_SCAN          ││         PROJECTION        │                             │         DUMMY_SCAN        │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │                           │
│          lineitem         ││            part           ││  (0.2 * avg(l_quantity))  │                             │                           │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││         p_partkey         │                             │                           │
│         l_partkey         ││         p_partkey         ││                           │                             │                           │
│         l_quantity        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                             │                           │
│      l_extendedprice      ││Filters: p_brand='Brand#23'││                           │                             │                           │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   AND p_brand IS NOT NULL ││                           │                             │                           │
│        EC: 6001215        ││ p_container='MED BOX' AND ││                           │                             │                           │
│                           ││   p_container IS NOT NULL ││                           │                             │                           │
│                           ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                             │                           │
│                           ││          EC: 5000         ││                           │                             │                           │
└───────────────────────────┘└───────────────────────────┘└─────────────┬─────────────┘                             └───────────────────────────┘                             
                                                          ┌─────────────┴─────────────┐                                                          
                                                          │         PROJECTION        │                                                          
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                          │__internal_decompress_integ│                                                          
                                                          │     ral_bigint(#0, 1)     │                                                          
                                                          │             #1            │                                                          
                                                          └─────────────┬─────────────┘                                                                                       
                                                          ┌─────────────┴─────────────┐                                                          
                                                          │       HASH_GROUP_BY       │                                                          
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                          │             #0            │                                                          
                                                          │          avg(#1)          │                                                          
                                                          └─────────────┬─────────────┘                                                                                       
                                                          ┌─────────────┴─────────────┐                                                          
                                                          │         PROJECTION        │                                                          
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                          │         p_partkey         │                                                          
                                                          │         l_quantity        │                                                          
                                                          └─────────────┬─────────────┘                                                                                       
                                                          ┌─────────────┴─────────────┐                                                          
                                                          │         PROJECTION        │                                                          
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                          │__internal_compress_integra│                                                          
                                                          │     l_uinteger(#0, 1)     │                                                          
                                                          │             #1            │                                                          
                                                          │             #2            │                                                          
                                                          └─────────────┬─────────────┘                                                                                       
                                                          ┌─────────────┴─────────────┐                                                          
                                                          │         HASH_JOIN         │                                                          
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                          │           INNER           │                                                          
                                                          │   l_partkey = p_partkey   ├──────────────┐                                           
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                           
                                                          │        EC: 6001215        │              │                                           
                                                          └─────────────┬─────────────┘              │                                                                        
                                                          ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             
                                                          │         SEQ_SCAN          ││         DELIM_SCAN        │                             
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                             
                                                          │          lineitem         ││                           │                             
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                             
                                                          │         l_partkey         ││                           │                             
                                                          │         l_quantity        ││                           │                             
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                             
                                                          │        EC: 6001215        ││                           │                             
                                                          └───────────────────────────┘└───────────────────────────┘                                                          

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

X {'RESULT_COLLECTOR0': 0.001333, 'PROJECTION1': 0.000401, 'ORDER_BY2': 0.001821, 'PROJECTION3': 0.000174, 'PROJECTION4': 0.000371, 'HASH_GROUP_BY5': 0.023795, 'PROJECTION6': 0.000162, 'PROJECTION7': 0.002573, 'PROJECTION8': 0.000221, 'FILTER9': 0.001007, 'HASH_JOIN10': 0.005037, 'HASH_JOIN11': 0.012031, 'SEQ_SCAN 12': 0.00167, 'FILTER13': 0.00194, 'HASH_JOIN14': 0.001751, 'SEQ_SCAN 15': 0.008213, 'COLUMN_DATA_SCAN16': 5e-06, 'PROJECTION17': 1e-06, 'FILTER18': 0.000256, 'SEQ_SCAN 19': 0.000399}
**** output size:  18314
LINEAGE_5_COLUMN_DATA_SCAN_2
LINEAGE_5_FILTER_10
LINEAGE_5_FILTER_4
LINEAGE_5_FILTER_7
LINEAGE_5_HASH_GROUP_BY_14
LINEAGE_5_HASH_JOIN_3
LINEAGE_5_HASH_JOIN_5
LINEAGE_5_HASH_JOIN_9
LINEAGE_5_ORDER_BY_17
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_1
LINEAGE_5_SEQ_SCAN_6
SELECT p_brand, p_type, p_size, count(DISTINCT ps_suppkey) AS supplier_cnt FROM partsupp, part WHERE p_partkey = ps_partkey AND p_brand <> 'Brand#45' AND p_type NOT LIKE 'MEDIUM POLISHED%' AND p_size IN (49, 14, 23, 45, 19, 3, 36, 9) AND ps_suppkey NOT IN ( SELECT s_suppkey FROM supplier WHERE s_comment LIKE '%Customer%Complaints%') GROUP BY p_brand, p_type, p_size ORDER BY supplier_cnt DESC, p_brand, p_type, p_size;
   query_id  ...                                               plan
0         5  ...  {"name": "PROJECTION", "opid": "18", "children...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               SELECT p_brand, p_type, p_size, count(DISTINCT...
size_bytes_max                                                 592793
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "PROJECTION", "opid": "18", "children...
Name: 0, dtype: object
{"name": "PROJECTION", "opid": "18", "children": [{"name": "ORDER_BY", "opid": "17", "children": [{"name": "PROJECTION", "opid": "16", "children": [{"name": "PROJECTION", "opid": "15", "children": [{"name": "HASH_GROUP_BY", "opid": "14", "children": [{"name": "PROJECTION", "opid": "13", "children": [{"name": "PROJECTION", "opid": "12", "children": [{"name": "PROJECTION", "opid": "11", "children": [{"name": "FILTER", "opid": "10", "children": [{"name": "HASH_JOIN", "opid": "9", "children": [{"name": "HASH_JOIN", "opid": "5", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "partsupp","extra": "partsupp\n[INFOSEPARATOR]\nps_partkey\nps_suppkey\n[INFOSEPARATOR]\nEC: 800000"},{"name": "FILTER", "opid": "4", "children": [{"name": "HASH_JOIN", "opid": "3", "children": [{"name": "SEQ_SCAN ", "opid": "1", "children": [],"table": "part","extra": "part\n[INFOSEPARATOR]\np_partkey\np_brand\np_type\np_size\n[INFOSEPARATOR]\nEC: 200000"},{"name": "COLUMN_DATA_SCAN", "opid": "2", "children": [],"table": "","extra": ""}],"table": "","extra": "MARK\np_size = #0\n\n[INFOSEPARATOR]\nEC: 200000\n"}],"table": "","extra": "(IN (...) AND (p_brand != 'Brand#45') AND (NOT prefix(p_type, 'MEDIUM POLISHED')))\n[INFOSEPARATOR]\nEC: 40000"}],"table": "","extra": "INNER\nps_partkey = p_partkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 168893\n"},{"name": "PROJECTION", "opid": "8", "children": [{"name": "FILTER", "opid": "7", "children": [{"name": "SEQ_SCAN ", "opid": "6", "children": [],"table": "supplier","extra": "supplier\n[INFOSEPARATOR]\ns_comment\ns_suppkey\n[INFOSEPARATOR]\nEC: 10000"}],"table": "","extra": "(s_comment ~~ '%Customer%Complaints%')\n[INFOSEPARATOR]\nEC: 2000"}],"table": "","extra": "s_suppkey\n"}],"table": "","extra": "MARK\nps_suppkey = #0\n\n[INFOSEPARATOR]\nEC: 168893\n"}],"table": "","extra": "(NOT SUBQUERY)\n[INFOSEPARATOR]\nEC: 33778"}],"table": "","extra": "#1\n#3\n#4\n#5\n#6\n"}],"table": "","extra": "#0\n__internal_compress_string_hugeint(#1)\n#2\n__internal_compress_integral_utinyint(#3, 1)\n#4\n"}],"table": "","extra": "p_brand\np_type\np_size\nps_suppkey\n"}],"table": "","extra": "#0\n#1\n#2\ncount(DISTINCT #3)"}],"table": "","extra": "__internal_decompress_string(#0)\n#1\n__internal_decompress_integral_integer(#2, 1)\n#3\n"}],"table": "","extra": "__internal_compress_string_hugeint(#0)\n#1\n__internal_compress_integral_utinyint(#2, 1)\n#3\n"}],"table": "","extra": "ORDERS:\ncount(DISTINCT partsupp.ps_suppkey) DESC\npart.p_brand ASC\npart.p_type ASC\npart.p_size ASC"}],"table": "","extra": "__internal_decompress_string(#0)\n#1\n__internal_decompress_integral_integer(#2, 1)\n#3\n"}
%%%%%%%%%%%%%%%% Running Query #  17  threads:  1
SELECT sum(l_extendedprice) / 7.0 AS avg_yearly FROM lineitem, part WHERE p_partkey = l_partkey AND p_brand = 'Brand#23' AND p_container = 'MED BOX' AND l_quantity < ( SELECT 0.2 * avg(l_quantity) FROM lineitem WHERE l_partkey = p_partkey);
Run:  None SELECT sum(l_extendedprice) / 7.0 AS avg_yearly FROM lineitem, part WHERE p_partkey = l_partkey AND p_brand = 'Brand#23' AND p_container = 'MED BOX' AND l_quantity < ( SELECT 0.2 * avg(l_quantity) FROM lineitem WHERE l_partkey = p_partkey);
Avg Time in sec:  0.13574869418516755  output size:  1
      avg_yearly
0  348406.054286
{'name': 'Query', 'result': 0.13205, 'timing': 0.13205, 'cardinality': 0, 'extra-info': "SELECT sum(l_extendedprice) / 7.0 AS avg_yearly FROM lineitem, part WHERE p_partkey = l_partkey AND p_brand = 'Brand#23' AND p_container = 'MED BOX' AND l_quantity < ( SELECT 0.2 * avg(l_quantity) FROM lineitem WHERE l_partkey = p_partkey);", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 3e-06, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 3e-06, 'cardinality': 1, 'extra_info': 'avg_yearly\n', 'children': [{'name': 'UNGROUPED_AGGREGATE', 'timing': 4e-06, 'cardinality': 1, 'extra_info': 'sum(#0)', 'children': [{'name': 'PROJECTION', 'timing': 0.0, 'cardinality': 587, 'extra_info': 'l_extendedprice\n', 'children': [{'name': 'PROJECTION', 'timing': 1e-06, 'cardinality': 587, 'extra_info': '#0\n#3\n#4\n', 'children': [{'name': 'FILTER', 'timing': 0.000299, 'cardinality': 587, 'extra_info': '(CAST(l_quantity AS DOUBLE) < SUBQUERY)\n[INFOSEPARATOR]\nEC: 3000607', 'children': [{'name': 'RIGHT_DELIM_JOIN', 'timing': 0.001034, 'cardinality': 0, 'extra_info': 'RIGHT\np_partkey IS NOT DISTINCT FROM p_partkey\n\n[INFOSEPARATOR]\nEC: 3000607\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.028115, 'cardinality': 6088, 'extra_info': 'INNER\nl_partkey = p_partkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 80175\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.010175, 'cardinality': 6001215, 'extra_info': 'lineitem\n[INFOSEPARATOR]\nl_partkey\nl_quantity\nl_extendedprice\n[INFOSEPARATOR]\nEC: 6001215', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 0.00887, 'cardinality': 204, 'extra_info': "part\n[INFOSEPARATOR]\np_partkey\n[INFOSEPARATOR]\nFilters: p_brand='Brand#23' AND p_brand IS NOT NULL\np_container='MED BOX' AND p_container IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 5000", 'children': []}]}, {'name': 'HASH_JOIN', 'timing': 0.00049, 'cardinality': 6088, 'extra_info': 'RIGHT\np_partkey IS NOT DISTINCT FROM p_partkey\n\n[INFOSEPARATOR]\nEC: 3000607\n', 'children': [{'name': 'PROJECTION', 'timing': 3e-06, 'cardinality': 204, 'extra_info': '(0.2 * avg(l_quantity))\np_partkey\n', 'children': [{'name': 'PROJECTION', 'timing': 2e-06, 'cardinality': 204, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n#1\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.000902, 'cardinality': 204, 'extra_info': '#0\navg(#1)', 'children': [{'name': 'PROJECTION', 'timing': 4e-06, 'cardinality': 6088, 'extra_info': 'p_partkey\nl_quantity\n', 'children': [{'name': 'PROJECTION', 'timing': 3.8e-05, 'cardinality': 6088, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n#1\n#2\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.067593, 'cardinality': 6088, 'extra_info': 'INNER\nl_partkey = p_partkey\n\n[INFOSEPARATOR]\nEC: 6001215\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.00662, 'cardinality': 6001215, 'extra_info': 'lineitem\n[INFOSEPARATOR]\nl_partkey\nl_quantity\n[INFOSEPARATOR]\nEC: 6001215', 'children': []}, {'name': 'DELIM_SCAN', 'timing': 0.0, 'cardinality': 0, 'extra_info': '', 'children': []}]}]}]}]}]}]}, {'name': 'DUMMY_SCAN', 'timing': 0.0, 'cardinality': 0, 'extra_info': '', 'children': []}]}, {'name': 'HASH_GROUP_BY', 'timing': 2.1e-05, 'cardinality': 204, 'extra_info': '#0', 'children': []}]}]}]}]}]}]}]}]}
compressed filter_log_size: 2723
compressed filter_log_buffer_size: 1390
compressed limit_offset_size: 800
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 2058
compressed perfect_full_scan_ht_log_buffer_size: 874
compressed perfect_probe_ht_log_size: 90486
compressed perfect_probe_ht_log_buffer_size: 48704
compressed row_group_log_size: 46240
compressed row_group_log_buffer_size: 816
compressed scatter_log_size: 25837
compressed scatter_log_buffer_size: 24739
compressed scatter_sel_log_size: 35504
compressed scatter_sel_log_buffer_size: 32907
compressed gather_log_size: 800
compressed gather_log_buffer_size: 0
compressed combine_log_size: 800
compressed combine_log_buffer_size: 0
compressed finalize_states_log_size: 1268
compressed finalize_states_log_buffer_size: 180
compressed join_gather_log_size: 145419
compressed join_gather_log_buffer_size: 97480
compressed reorder_log_size: 1200
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 800
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 800
compressed nlj_log_buffer_size: 0
compressed total_size: 354735
compressed total_buffer_size: 207090
compressed total_element_size: 147645

Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                                                                                       
│      STREAMING_LIMIT      │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│             #0            │                                                                                       
│__internal_decompress_integ│                                                                                       
│     ral_bigint(#1, 1)     │                                                                                       
│__internal_decompress_integ│                                                                                       
│     ral_bigint(#2, 1)     │                                                                                       
│             #3            │                                                                                       
│             #4            │                                                                                       
│             #5            │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│          ORDER_BY         │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│          ORDERS:          │                                                                                       
│  orders.o_totalprice DESC │                                                                                       
│   orders.o_orderdate ASC  │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│             #0            │                                                                                       
│__internal_compress_integra│                                                                                       
│     l_uinteger(#1, 1)     │                                                                                       
│__internal_compress_integra│                                                                                       
│     l_uinteger(#2, 1)     │                                                                                       
│             #3            │                                                                                       
│             #4            │                                                                                       
│             #5            │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│             #0            │                                                                                       
│__internal_decompress_integ│                                                                                       
│     ral_bigint(#1, 1)     │                                                                                       
│__internal_decompress_integ│                                                                                       
│     ral_bigint(#2, 1)     │                                                                                       
│             #3            │                                                                                       
│             #4            │                                                                                       
│             #5            │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│       HASH_GROUP_BY       │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│             #0            │                                                                                       
│             #1            │                                                                                       
│             #2            │                                                                                       
│             #3            │                                                                                       
│             #4            │                                                                                       
│          sum(#5)          │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│           c_name          │                                                                                       
│         c_custkey         │                                                                                       
│         o_orderkey        │                                                                                       
│        o_orderdate        │                                                                                       
│        o_totalprice       │                                                                                       
│         l_quantity        │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│__internal_compress_integra│                                                                                       
│     l_uinteger(#0, 1)     │                                                                                       
│             #1            │                                                                                       
│__internal_compress_integra│                                                                                       
│     l_uinteger(#2, 1)     │                                                                                       
│__internal_compress_integra│                                                                                       
│     l_uinteger(#3, 1)     │                                                                                       
│             #4            │                                                                                       
│             #5            │                                                                                       
│             #6            │                                                                                       
│__internal_compress_integra│                                                                                       
│     l_uinteger(#7, 1)     │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         HASH_JOIN         │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│           INNER           │                                                                                       
│      o_orderkey = #0      ├────────────────────────────────────────────────────────────────────────┐              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                        │              
│        EC: 3618677        │                                                                        │              
└─────────────┬─────────────┘                                                                        │                                           
┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐
│         HASH_JOIN         │                                                          │         PROJECTION        │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│           INNER           │                                                          │__internal_decompress_integ│
│  l_orderkey = o_orderkey  ├──────────────┐                                           │     ral_bigint(#0, 1)     │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                           │                           │
│        EC: 3618677        │              │                                           │                           │
└─────────────┬─────────────┘              │                                           └─────────────┬─────────────┘                             
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐
│         SEQ_SCAN          ││         HASH_JOIN         │                             │       HASH_GROUP_BY       │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│          lineitem         ││           INNER           │                             │             #0            │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   o_custkey = c_custkey   │                             │                           │
│         l_orderkey        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐              │                           │
│         l_quantity        ││        Build Min: 1       │              │              │                           │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││     Build Max: 149999     │              │              │                           │
│        EC: 6001215        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              │                           │
│                           ││         EC: 904486        │              │              │                           │
└───────────────────────────┘└─────────────┬─────────────┘              │              └─────────────┬─────────────┘                             
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐
                             │         SEQ_SCAN          ││         SEQ_SCAN          ││         PROJECTION        │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                             │           orders          ││          customer         ││             #0            │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │
                             │         o_orderkey        ││         c_custkey         ││                           │
                             │         o_custkey         ││           c_name          ││                           │
                             │        o_orderdate        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │
                             │        o_totalprice       ││ Filters: c_custkey<=149999││                           │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││  AND c_custkey IS NOT NULL││                           │
                             │        EC: 1500000        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │
                             │                           ││         EC: 150000        ││                           │
                             └───────────────────────────┘└───────────────────────────┘└─────────────┬─────────────┘                             
                                                                                       ┌─────────────┴─────────────┐
                                                                                       │         PROJECTION        │
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                       │__internal_compress_integra│
                                                                                       │     l_uinteger(#0, 1)     │
                                                                                       └─────────────┬─────────────┘                             
                                                                                       ┌─────────────┴─────────────┐
                                                                                       │         PROJECTION        │
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                       │         l_orderkey        │
                                                                                       └─────────────┬─────────────┘                             
                                                                                       ┌─────────────┴─────────────┐
                                                                                       │           FILTER          │
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                       │ (sum(l_quantity) > 300.00)│
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                       │         EC: 47042         │
                                                                                       └─────────────┬─────────────┘                             
                                                                                       ┌─────────────┴─────────────┐
                                                                                       │         PROJECTION        │
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                       │__internal_decompress_integ│
                                                                                       │     ral_bigint(#0, 1)     │
                                                                                       │             #1            │
                                                                                       └─────────────┬─────────────┘                             
                                                                                       ┌─────────────┴─────────────┐
                                                                                       │       HASH_GROUP_BY       │
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                       │             #0            │
                                                                                       │    sum_no_overflow(#1)    │
                                                                                       └─────────────┬─────────────┘                             
                                                                                       ┌─────────────┴─────────────┐
                                                                                       │         PROJECTION        │
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                       │         l_orderkey        │
                                                                                       │         l_quantity        │
                                                                                       └─────────────┬─────────────┘                             
                                                                                       ┌─────────────┴─────────────┐
                                                                                       │         PROJECTION        │
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                       │__internal_compress_integra│
                                                                                       │     l_uinteger(#0, 1)     │
                                                                                       │             #1            │
                                                                                       └─────────────┬─────────────┘                             
                                                                                       ┌─────────────┴─────────────┐
                                                                                       │         SEQ_SCAN          │
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                       │          lineitem         │
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                       │         l_orderkey        │
                                                                                       │         l_quantity        │
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                       │        EC: 6001215        │
                                                                                       └───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

X {'RESULT_COLLECTOR0': 3e-06, 'PROJECTION1': 3e-06, 'UNGROUPED_AGGREGATE2': 4e-06, 'PROJECTION3': 0.0, 'PROJECTION4': 1e-06, 'FILTER5': 0.000299, 'RIGHT_DELIM_JOIN6': 0.001034, 'HASH_JOIN7': 0.028115, 'SEQ_SCAN 8': 0.010175, 'SEQ_SCAN 9': 0.00887, 'HASH_JOIN10': 0.00049, 'PROJECTION11': 3e-06, 'PROJECTION12': 2e-06, 'HASH_GROUP_BY13': 0.000902, 'PROJECTION14': 4e-06, 'PROJECTION15': 3.8e-05, 'HASH_JOIN16': 0.067593, 'SEQ_SCAN 17': 0.00662, 'DELIM_SCAN18': 0.0, 'DUMMY_SCAN19': 0.0, 'HASH_GROUP_BY20': 2.1e-05}
**** output size:  1
LINEAGE_5_FILTER_15
LINEAGE_5_HASH_GROUP_BY_10
LINEAGE_5_HASH_GROUP_BY_5
LINEAGE_5_HASH_JOIN_13
LINEAGE_5_HASH_JOIN_2
LINEAGE_5_HASH_JOIN_9
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_11
LINEAGE_5_SEQ_SCAN_12
SELECT sum(l_extendedprice) / 7.0 AS avg_yearly FROM lineitem, part WHERE p_partkey = l_partkey AND p_brand = 'Brand#23' AND p_container = 'MED BOX' AND l_quantity < ( SELECT 0.2 * avg(l_quantity) FROM lineitem WHERE l_partkey = p_partkey);
   query_id  ...                                               plan
0         5  ...  {"name": "PROJECTION", "opid": "19", "children...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               SELECT sum(l_extendedprice) / 7.0 AS avg_yearl...
size_bytes_max                                                 354735
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "PROJECTION", "opid": "19", "children...
Name: 0, dtype: object
{"name": "PROJECTION", "opid": "19", "children": [{"name": "UNGROUPED_AGGREGATE", "opid": "18", "children": [{"name": "PROJECTION", "opid": "17", "children": [{"name": "PROJECTION", "opid": "16", "children": [{"name": "FILTER", "opid": "15", "children": [{"name": "RIGHT_DELIM_JOIN", "opid": "14", "children": [{"name": "HASH_GROUP_BY", "opid": "10", "children": [],"table": "","extra": "#0"},{"name": "HASH_JOIN", "opid": "9", "children": [{"name": "PROJECTION", "opid": "7", "children": [{"name": "PROJECTION", "opid": "6", "children": [{"name": "HASH_GROUP_BY", "opid": "5", "children": [{"name": "PROJECTION", "opid": "4", "children": [{"name": "PROJECTION", "opid": "3", "children": [{"name": "HASH_JOIN", "opid": "2", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_partkey\nl_quantity\n[INFOSEPARATOR]\nEC: 6001215"},{"name": "DELIM_SCAN", "opid": "1", "children": [],"table": "","extra": ""}],"table": "","extra": "INNER\nl_partkey = p_partkey\n\n[INFOSEPARATOR]\nEC: 6001215\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n#1\n#2\n"}],"table": "","extra": "p_partkey\nl_quantity\n"}],"table": "","extra": "#0\navg(#1)"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n#1\n"}],"table": "","extra": "(0.2 * avg(l_quantity))\np_partkey\n"},{"name": "DUMMY_SCAN", "opid": "8", "children": [],"table": "","extra": ""}],"table": "","extra": "RIGHT\np_partkey IS NOT DISTINCT FROM p_partkey\n\n[INFOSEPARATOR]\nEC: 3000607\n"},{"name": "HASH_JOIN", "opid": "13", "children": [{"name": "SEQ_SCAN ", "opid": "11", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_partkey\nl_quantity\nl_extendedprice\n[INFOSEPARATOR]\nEC: 6001215"},{"name": "SEQ_SCAN ", "opid": "12", "children": [],"table": "part","extra": "part\n[INFOSEPARATOR]\np_partkey\n[INFOSEPARATOR]\nFilters: p_brand='Brand#23' AND p_brand IS NOT NULL\np_container='MED BOX' AND p_container IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 5000"}],"table": "","extra": "INNER\nl_partkey = p_partkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 80175\n"}],"table": "","extra": "RIGHT\np_partkey IS NOT DISTINCT FROM p_partkey\n\n[INFOSEPARATOR]\nEC: 3000607\n"}],"table": "","extra": "(CAST(l_quantity AS DOUBLE) < SUBQUERY)\n[INFOSEPARATOR]\nEC: 3000607"}],"table": "","extra": "#0\n#3\n#4\n"}],"table": "","extra": "l_extendedprice\n"}],"table": "","extra": "sum(#0)"}],"table": "","extra": "avg_yearly\n"}
%%%%%%%%%%%%%%%% Running Query #  18  threads:  1
SELECT c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, sum(l_quantity) FROM customer, orders, lineitem WHERE o_orderkey IN ( SELECT l_orderkey FROM lineitem GROUP BY l_orderkey HAVING sum(l_quantity) > 300) AND c_custkey = o_custkey AND o_orderkey = l_orderkey GROUP BY c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice ORDER BY o_totalprice DESC, o_orderdate LIMIT 100;
Run:  None SELECT c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, sum(l_quantity) FROM customer, orders, lineitem WHERE o_orderkey IN ( SELECT l_orderkey FROM lineitem GROUP BY l_orderkey HAVING sum(l_quantity) > 300) AND c_custkey = o_custkey AND o_orderkey = l_orderkey GROUP BY c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice ORDER BY o_totalprice DESC, o_orderdate LIMIT 100;
Avg Time in sec:  1.4105567820370197  output size:  57
                c_name  c_custkey  ...  o_totalprice sum(l_quantity)
0   Customer#000128120     128120  ...     544089.09           323.0
1   Customer#000144617     144617  ...     530604.44           317.0
2   Customer#000013940      13940  ...     522720.61           304.0
3   Customer#000066790      66790  ...     515531.82           327.0
4   Customer#000046435      46435  ...     508047.99           309.0
5   Customer#000015272      15272  ...     500241.33           302.0
6   Customer#000146608     146608  ...     499794.58           303.0
7   Customer#000096103      96103  ...     494398.79           312.0
8   Customer#000024341      24341  ...     491348.26           302.0
9   Customer#000137446     137446  ...     487763.25           311.0
10  Customer#000107590     107590  ...     485141.38           301.0
11  Customer#000050008      50008  ...     483891.26           302.0
12  Customer#000015619      15619  ...     480083.96           318.0
13  Customer#000077260      77260  ...     479499.43           307.0
14  Customer#000109379     109379  ...     478064.11           302.0
15  Customer#000054602      54602  ...     471220.08           307.0
16  Customer#000105995     105995  ...     469692.58           307.0
17  Customer#000148885     148885  ...     469630.44           313.0
18  Customer#000114586     114586  ...     469605.59           308.0
19  Customer#000105260     105260  ...     469360.57           303.0
20  Customer#000147197     147197  ...     467149.67           320.0
21  Customer#000064483      64483  ...     466991.35           304.0
22  Customer#000136573     136573  ...     461282.73           301.0
23  Customer#000016384      16384  ...     458378.92           312.0
24  Customer#000117919     117919  ...     456815.92           317.0
25  Customer#000012251      12251  ...     455107.26           309.0
26  Customer#000120098     120098  ...     453451.23           308.0
27  Customer#000066098      66098  ...     453436.16           304.0
28  Customer#000117076     117076  ...     449545.85           301.0
29  Customer#000129379     129379  ...     448665.79           303.0
30  Customer#000126865     126865  ...     447606.65           320.0
31  Customer#000088876      88876  ...     446717.46           304.0
32  Customer#000036619      36619  ...     446704.09           328.0
33  Customer#000141823     141823  ...     446269.12           310.0
34  Customer#000053029      53029  ...     446144.49           302.0
35  Customer#000018188      18188  ...     443807.22           308.0
36  Customer#000066533      66533  ...     443576.50           305.0
37  Customer#000037729      37729  ...     441082.97           309.0
38  Customer#000003566       3566  ...     439803.36           304.0
39  Customer#000045538      45538  ...     436275.31           305.0
40  Customer#000081581      81581  ...     435405.90           305.0
41  Customer#000119989     119989  ...     434568.25           320.0
42  Customer#000003680       3680  ...     433525.97           301.0
43  Customer#000113131     113131  ...     432957.75           301.0
44  Customer#000141098     141098  ...     430986.69           301.0
45  Customer#000093392      93392  ...     425487.51           304.0
46  Customer#000015631      15631  ...     419879.59           302.0
47  Customer#000112987     112987  ...     418161.49           305.0
48  Customer#000012599      12599  ...     415200.61           304.0
49  Customer#000105410     105410  ...     412754.51           302.0
50  Customer#000149842     149842  ...     411329.35           302.0
51  Customer#000010129      10129  ...     409129.85           309.0
52  Customer#000069904      69904  ...     408513.00           305.0
53  Customer#000017746      17746  ...     408446.93           303.0
54  Customer#000013072      13072  ...     399195.47           301.0
55  Customer#000082441      82441  ...     382579.74           305.0
56  Customer#000088703      88703  ...     363812.12           302.0

[57 rows x 6 columns]
compressed filter_log_size: 1945
compressed filter_log_buffer_size: 228
compressed limit_offset_size: 1136
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 346238
compressed perfect_full_scan_ht_log_buffer_size: 344862
compressed perfect_probe_ht_log_size: 3419002
compressed perfect_probe_ht_log_buffer_size: 3410440
compressed row_group_log_size: 51704
compressed row_group_log_buffer_size: 820
compressed scatter_log_size: 4807327
compressed scatter_log_buffer_size: 4787706
compressed scatter_sel_log_size: 6901639
compressed scatter_sel_log_buffer_size: 6888917
compressed gather_log_size: 992
compressed gather_log_buffer_size: 0
compressed combine_log_size: 992
compressed combine_log_buffer_size: 0
compressed finalize_states_log_size: 341640
compressed finalize_states_log_buffer_size: 335481
compressed join_gather_log_size: 19634899
compressed join_gather_log_buffer_size: 19449466
compressed reorder_log_size: 1604
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 992
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 992
compressed nlj_log_buffer_size: 0
compressed total_size: 35511102
compressed total_buffer_size: 35217920
compressed total_element_size: 293182

{'name': 'Query', 'result': 1.39661, 'timing': 1.39661, 'cardinality': 0, 'extra-info': 'SELECT c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, sum(l_quantity) FROM customer, orders, lineitem WHERE o_orderkey IN ( SELECT l_orderkey FROM lineitem GROUP BY l_orderkey HAVING sum(l_quantity) > 300) AND c_custkey = o_custkey AND o_orderkey = l_orderkey GROUP BY c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice ORDER BY o_totalprice DESC, o_orderdate LIMIT 100;', 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 1.8e-05, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'STREAMING_LIMIT', 'timing': 2e-06, 'cardinality': 57, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 4e-06, 'cardinality': 57, 'extra_info': '#0\n__internal_decompress_integral_bigint(#1, 1)\n__internal_decompress_integral_bigint(#2, 1)\n#3\n#4\n#5\n', 'children': [{'name': 'ORDER_BY', 'timing': 4.4e-05, 'cardinality': 57, 'extra_info': 'ORDERS:\norders.o_totalprice DESC\norders.o_orderdate ASC', 'children': [{'name': 'PROJECTION', 'timing': 2e-06, 'cardinality': 57, 'extra_info': '#0\n__internal_compress_integral_uinteger(#1, 1)\n__internal_compress_integral_uinteger(#2, 1)\n#3\n#4\n#5\n', 'children': [{'name': 'PROJECTION', 'timing': 6e-06, 'cardinality': 57, 'extra_info': '#0\n__internal_decompress_integral_bigint(#1, 1)\n__internal_decompress_integral_bigint(#2, 1)\n#3\n#4\n#5\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.000813, 'cardinality': 57, 'extra_info': '#0\n#1\n#2\n#3\n#4\nsum(#5)', 'children': [{'name': 'PROJECTION', 'timing': 9e-06, 'cardinality': 399, 'extra_info': 'c_name\nc_custkey\no_orderkey\no_orderdate\no_totalprice\nl_quantity\n', 'children': [{'name': 'PROJECTION', 'timing': 6.5e-05, 'cardinality': 399, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n#1\n__internal_compress_integral_uinteger(#2, 1)\n__internal_compress_integral_uinteger(#3, 1)\n#4\n#5\n#6\n__internal_compress_integral_uinteger(#7, 1)\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.065367, 'cardinality': 399, 'extra_info': 'INNER\no_orderkey = #0\n\n[INFOSEPARATOR]\nEC: 3618677\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.651175, 'cardinality': 6001215, 'extra_info': 'INNER\nl_orderkey = o_orderkey\n\n[INFOSEPARATOR]\nEC: 3618677\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.010704, 'cardinality': 6001215, 'extra_info': 'lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_quantity\n[INFOSEPARATOR]\nEC: 6001215', 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.045849, 'cardinality': 1500000, 'extra_info': 'INNER\no_custkey = c_custkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 149999\n\n[INFOSEPARATOR]\nEC: 904486\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.005391, 'cardinality': 1500000, 'extra_info': 'orders\n[INFOSEPARATOR]\no_orderkey\no_custkey\no_orderdate\no_totalprice\n[INFOSEPARATOR]\nEC: 1500000', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 0.004283, 'cardinality': 149999, 'extra_info': 'customer\n[INFOSEPARATOR]\nc_custkey\nc_name\n[INFOSEPARATOR]\nFilters: c_custkey<=149999 AND c_custkey IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 150000', 'children': []}]}]}, {'name': 'PROJECTION', 'timing': 5e-06, 'cardinality': 57, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.000281, 'cardinality': 57, 'extra_info': '#0', 'children': [{'name': 'PROJECTION', 'timing': 1e-06, 'cardinality': 57, 'extra_info': '#0\n', 'children': [{'name': 'PROJECTION', 'timing': 3e-06, 'cardinality': 57, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n', 'children': [{'name': 'PROJECTION', 'timing': 1e-06, 'cardinality': 57, 'extra_info': 'l_orderkey\n', 'children': [{'name': 'FILTER', 'timing': 0.003949, 'cardinality': 57, 'extra_info': '(sum(l_quantity) > 300.00)\n[INFOSEPARATOR]\nEC: 47042', 'children': [{'name': 'PROJECTION', 'timing': 0.001117, 'cardinality': 1500000, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n#1\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.455165, 'cardinality': 1500000, 'extra_info': '#0\nsum_no_overflow(#1)', 'children': [{'name': 'PROJECTION', 'timing': 0.000829, 'cardinality': 6001215, 'extra_info': 'l_orderkey\nl_quantity\n', 'children': [{'name': 'PROJECTION', 'timing': 0.016339, 'cardinality': 6001215, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n#1\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.009299, 'cardinality': 6001215, 'extra_info': 'lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_quantity\n[INFOSEPARATOR]\nEC: 6001215', 'children': []}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}
X {'RESULT_COLLECTOR0': 1.8e-05, 'STREAMING_LIMIT1': 2e-06, 'PROJECTION2': 4e-06, 'ORDER_BY3': 4.4e-05, 'PROJECTION4': 2e-06, 'PROJECTION5': 6e-06, 'HASH_GROUP_BY6': 0.000813, 'PROJECTION7': 9e-06, 'PROJECTION8': 6.5e-05, 'HASH_JOIN9': 0.065367, 'HASH_JOIN10': 0.651175, 'SEQ_SCAN 11': 0.010704, 'HASH_JOIN12': 0.045849, 'SEQ_SCAN 13': 0.005391, 'SEQ_SCAN 14': 0.004283, 'PROJECTION15': 5e-06, 'HASH_GROUP_BY16': 0.000281, 'PROJECTION17': 1e-06, 'PROJECTION18': 3e-06, 'PROJECTION19': 1e-06, 'FILTER20': 0.003949, 'PROJECTION21': 0.001117, 'HASH_GROUP_BY22': 0.455165, 'PROJECTION23': 0.000829, 'PROJECTION24': 0.016339, 'SEQ_SCAN 25': 0.009299}
**** output size:  57
LINEAGE_5_FILTER_10
LINEAGE_5_HASH_GROUP_BY_14
LINEAGE_5_HASH_GROUP_BY_19
LINEAGE_5_HASH_GROUP_BY_8
LINEAGE_5_HASH_JOIN_16
LINEAGE_5_HASH_JOIN_3
LINEAGE_5_HASH_JOIN_4
LINEAGE_5_ORDER_BY_22
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_1
LINEAGE_5_SEQ_SCAN_2
LINEAGE_5_SEQ_SCAN_5
LINEAGE_5_STREAMING_LIMIT_24
SELECT c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, sum(l_quantity) FROM customer, orders, lineitem WHERE o_orderkey IN ( SELECT l_orderkey FROM lineitem GROUP BY l_orderkey HAVING sum(l_quantity) > 300) AND c_custkey = o_custkey AND o_orderkey = l_orderkey GROUP BY c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice ORDER BY o_totalprice DESC, o_orderdate LIMIT 100;
   query_id  ...                                               plan
0         5  ...  {"name": "STREAMING_LIMIT", "opid": "24", "chi...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               SELECT c_name, c_custkey, o_orderkey, o_orderd...
size_bytes_max                                               35511102
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "STREAMING_LIMIT", "opid": "24", "chi...
Name: 0, dtype: object
{"name": "STREAMING_LIMIT", "opid": "24", "children": [{"name": "PROJECTION", "opid": "23", "children": [{"name": "ORDER_BY", "opid": "22", "children": [{"name": "PROJECTION", "opid": "21", "children": [{"name": "PROJECTION", "opid": "20", "children": [{"name": "HASH_GROUP_BY", "opid": "19", "children": [{"name": "PROJECTION", "opid": "18", "children": [{"name": "PROJECTION", "opid": "17", "children": [{"name": "HASH_JOIN", "opid": "16", "children": [{"name": "HASH_JOIN", "opid": "4", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_quantity\n[INFOSEPARATOR]\nEC: 6001215"},{"name": "HASH_JOIN", "opid": "3", "children": [{"name": "SEQ_SCAN ", "opid": "1", "children": [],"table": "orders","extra": "orders\n[INFOSEPARATOR]\no_orderkey\no_custkey\no_orderdate\no_totalprice\n[INFOSEPARATOR]\nEC: 1500000"},{"name": "SEQ_SCAN ", "opid": "2", "children": [],"table": "customer","extra": "customer\n[INFOSEPARATOR]\nc_custkey\nc_name\n[INFOSEPARATOR]\nFilters: c_custkey<=149999 AND c_custkey IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 150000"}],"table": "","extra": "INNER\no_custkey = c_custkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 149999\n\n[INFOSEPARATOR]\nEC: 904486\n"}],"table": "","extra": "INNER\nl_orderkey = o_orderkey\n\n[INFOSEPARATOR]\nEC: 3618677\n"},{"name": "PROJECTION", "opid": "15", "children": [{"name": "HASH_GROUP_BY", "opid": "14", "children": [{"name": "PROJECTION", "opid": "13", "children": [{"name": "PROJECTION", "opid": "12", "children": [{"name": "PROJECTION", "opid": "11", "children": [{"name": "FILTER", "opid": "10", "children": [{"name": "PROJECTION", "opid": "9", "children": [{"name": "HASH_GROUP_BY", "opid": "8", "children": [{"name": "PROJECTION", "opid": "7", "children": [{"name": "PROJECTION", "opid": "6", "children": [{"name": "SEQ_SCAN ", "opid": "5", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_quantity\n[INFOSEPARATOR]\nEC: 6001215"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n#1\n"}],"table": "","extra": "l_orderkey\nl_quantity\n"}],"table": "","extra": "#0\nsum_no_overflow(#1)"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n#1\n"}],"table": "","extra": "(sum(l_quantity) > 300.00)\n[INFOSEPARATOR]\nEC: 47042"}],"table": "","extra": "l_orderkey\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n"}],"table": "","extra": "#0\n"}],"table": "","extra": "#0"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n"}],"table": "","extra": "INNER\no_orderkey = #0\n\n[INFOSEPARATOR]\nEC: 3618677\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n#1\n__internal_compress_integral_uinteger(#2, 1)\n__internal_compress_integral_uinteger(#3, 1)\n#4\n#5\n#6\n__internal_compress_integral_uinteger(#7, 1)\n"}],"table": "","extra": "c_name\nc_custkey\no_orderkey\no_orderdate\no_totalprice\nl_quantity\n"}],"table": "","extra": "#0\n#1\n#2\n#3\n#4\nsum(#5)"}],"table": "","extra": "#0\n__internal_decompress_integral_bigint(#1, 1)\n__internal_decompress_integral_bigint(#2, 1)\n#3\n#4\n#5\n"}],"table": "","extra": "#0\n__internal_compress_integral_uinteger(#1, 1)\n__internal_compress_integral_uinteger(#2, 1)\n#3\n#4\n#5\n"}],"table": "","extra": "ORDERS:\norders.o_totalprice DESC\norders.o_orderdate ASC"}],"table": "","extra": "#0\n__internal_decompress_integral_bigint(#1, 1)\n__internal_decompress_integral_bigint(#2, 1)\n#3\n#4\n#5\n"}],"table": "","extra": ""}
Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                             
│    UNGROUPED_AGGREGATE    │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│          sum(#0)          │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│ (l_extendedprice * (1.00 -│                             
│        l_discount))       │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│             #1            │                             
│             #2            │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│             #1            │                             
│             #3            │                             
│             #4            │                             
│             #6            │                             
│             #7            │                             
│             #8            │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│           FILTER          │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│(((l_quantity <= 11.00) AND│                             
│ (p_size <= 5) AND (p_brand│                             
│     = 'Brand#12') AND (   │                             
│(p_container = 'SM CAS...  │                             
│(p_container = 'SM BOX...  │                             
│(p_container = 'SM PAC...  │                             
│(p_container = 'SM PKG...  │                             
│ ((l_quantity >= 10.00) AND│                             
│ (l_quantity <= 20.00) AND │                             
│(p_size <= 10) AND (p_brand│                             
│     = 'Brand#23') AND (   │                             
│(p_container = 'MED BA...  │                             
│(p_container = 'MED BO...  │                             
│(p_container = 'MED PK...  │                             
│(p_container = 'MED PA...  │                             
│  OR ((l_quantity >= 20.00)│                             
│  AND (l_quantity <= 30.00)│                             
│   AND (p_size <= 15) AND  │                             
│(p_brand = 'Brand#34')...  │                             
│(p_container = 'LG CAS...  │                             
│(p_container = 'LG BOX...  │                             
│(p_container = 'LG PAC...  │                             
│ (p_container = 'LG PKG')))│                             
│             )             │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│         EC: 160351        │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         HASH_JOIN         │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│           INNER           │                             
│   l_partkey = p_partkey   │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐              
│        Build Min: 1       │              │              
│     Build Max: 200000     │              │              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              
│         EC: 160351        │              │              
└─────────────┬─────────────┘              │                                           
┌─────────────┴─────────────┐┌─────────────┴─────────────┐
│           FILTER          ││         SEQ_SCAN          │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│ ((l_shipmode = 'AIR') OR  ││            part           │
│ (l_shipmode = 'AIR REG')) ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││         p_partkey         │
│         EC: 300060        ││          p_brand          │
│                           ││        p_container        │
│                           ││           p_size          │
│                           ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│                           ││         EC: 200000        │
└─────────────┬─────────────┘└───────────────────────────┘                             
┌─────────────┴─────────────┐                             
│         SEQ_SCAN          │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│          lineitem         │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│         l_partkey         │                             
│         l_quantity        │                             
│         l_shipmode        │                             
│      l_extendedprice      │                             
│         l_discount        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│  Filters: l_shipinstruct= │                             
│  'DELIVER IN PERSON' AND  │                             
│ l_shipinstruct IS NOT NULL│                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│         EC: 300060        │                             
└───────────────────────────┘                                                          

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

compressed filter_log_size: 257225
compressed filter_log_buffer_size: 223760
compressed limit_offset_size: 512
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 485140
compressed perfect_full_scan_ht_log_buffer_size: 484244
compressed perfect_probe_ht_log_size: 691072
compressed perfect_probe_ht_log_buffer_size: 647998
compressed row_group_log_size: 797440
compressed row_group_log_buffer_size: 753113
compressed scatter_log_size: 512
compressed scatter_log_buffer_size: 0
compressed scatter_sel_log_size: 787663
compressed scatter_sel_log_buffer_size: 785636
compressed gather_log_size: 512
compressed gather_log_buffer_size: 0
compressed combine_log_size: 512
compressed combine_log_buffer_size: 0
compressed finalize_states_log_size: 512
compressed finalize_states_log_buffer_size: 0
compressed join_gather_log_size: 512
compressed join_gather_log_buffer_size: 0
compressed reorder_log_size: 768
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 512
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 512
compressed nlj_log_buffer_size: 0
compressed total_size: 3023404
compressed total_buffer_size: 2894751
compressed total_element_size: 128653

%%%%%%%%%%%%%%%% Running Query #  19  threads:  1
SELECT sum(l_extendedprice * (1 - l_discount)) AS revenue FROM lineitem, part WHERE (p_partkey = l_partkey AND p_brand = 'Brand#12' AND p_container IN ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') AND l_quantity >= 1 AND l_quantity <= 1 + 10 AND p_size BETWEEN 1 AND 5 AND l_shipmode IN ('AIR', 'AIR REG') AND l_shipinstruct = 'DELIVER IN PERSON') OR (p_partkey = l_partkey AND p_brand = 'Brand#23' AND p_container IN ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') AND l_quantity >= 10 AND l_quantity <= 10 + 10 AND p_size BETWEEN 1 AND 10 AND l_shipmode IN ('AIR', 'AIR REG') AND l_shipinstruct = 'DELIVER IN PERSON') OR (p_partkey = l_partkey AND p_brand = 'Brand#34' AND p_container IN ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') AND l_quantity >= 20 AND l_quantity <= 20 + 10 AND p_size BETWEEN 1 AND 15 AND l_shipmode IN ('AIR', 'AIR REG') AND l_shipinstruct = 'DELIVER IN PERSON');
Run:  None SELECT sum(l_extendedprice * (1 - l_discount)) AS revenue FROM lineitem, part WHERE (p_partkey = l_partkey AND p_brand = 'Brand#12' AND p_container IN ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') AND l_quantity >= 1 AND l_quantity <= 1 + 10 AND p_size BETWEEN 1 AND 5 AND l_shipmode IN ('AIR', 'AIR REG') AND l_shipinstruct = 'DELIVER IN PERSON') OR (p_partkey = l_partkey AND p_brand = 'Brand#23' AND p_container IN ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') AND l_quantity >= 10 AND l_quantity <= 10 + 10 AND p_size BETWEEN 1 AND 10 AND l_shipmode IN ('AIR', 'AIR REG') AND l_shipinstruct = 'DELIVER IN PERSON') OR (p_partkey = l_partkey AND p_brand = 'Brand#34' AND p_container IN ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') AND l_quantity >= 20 AND l_quantity <= 20 + 10 AND p_size BETWEEN 1 AND 15 AND l_shipmode IN ('AIR', 'AIR REG') AND l_shipinstruct = 'DELIVER IN PERSON');
Avg Time in sec:  0.5022064023651183  output size:  1
        revenue
0  3.083843e+06
{'name': 'Query', 'result': 0.499074, 'timing': 0.499074, 'cardinality': 0, 'extra-info': "SELECT sum(l_extendedprice * (1 - l_discount)) AS revenue FROM lineitem, part WHERE (p_partkey = l_partkey AND p_brand = 'Brand#12' AND p_container IN ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') AND l_quantity >= 1 AND l_quantity <= 1 + 10 AND p_size BETWEEN 1 AND 5 AND l_shipmode IN ('AIR', 'AIR REG') AND l_shipinstruct = 'DELIVER IN PERSON') OR (p_partkey = l_partkey AND p_brand = 'Brand#23' AND p_container IN ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') AND l_quantity >= 10 AND l_quantity <= 10 + 10 AND p_size BETWEEN 1 AND 10 AND l_shipmode IN ('AIR', 'AIR REG') AND l_shipinstruct = 'DELIVER IN PERSON') OR (p_partkey = l_partkey AND p_brand = 'Brand#34' AND p_container IN ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') AND l_quantity >= 20 AND l_quantity <= 20 + 10 AND p_size BETWEEN 1 AND 15 AND l_shipmode IN ('AIR', 'AIR REG') AND l_shipinstruct = 'DELIVER IN PERSON');", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 4e-06, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'UNGROUPED_AGGREGATE', 'timing': 6e-06, 'cardinality': 1, 'extra_info': 'sum(#0)', 'children': [{'name': 'PROJECTION', 'timing': 7e-06, 'cardinality': 121, 'extra_info': '(l_extendedprice * (1.00 - l_discount))\n', 'children': [{'name': 'PROJECTION', 'timing': 1e-06, 'cardinality': 121, 'extra_info': '#1\n#2\n', 'children': [{'name': 'PROJECTION', 'timing': 2e-06, 'cardinality': 121, 'extra_info': '#1\n#3\n#4\n#6\n#7\n#8\n', 'children': [{'name': 'FILTER', 'timing': 0.055361, 'cardinality': 121, 'extra_info': "(((l_quantity <= 11.00) AND (p_size <= 5) AND (p_brand = 'Brand#12') AND ((p_container = 'SM CASE') OR (p_container = 'SM BOX') OR (p_container = 'SM PACK') OR (p_container = 'SM PKG'))) OR ((l_quantity >= 10.00) AND (l_quantity <= 20.00) AND (p_size <= 10) AND (p_brand = 'Brand#23') AND ((p_container = 'MED BAG') OR (p_container = 'MED BOX') OR (p_container = 'MED PKG') OR (p_container = 'MED PACK'))) OR ((l_quantity >= 20.00) AND (l_quantity <= 30.00) AND (p_size <= 15) AND (p_brand = 'Brand#34') AND ((p_container = 'LG CASE') OR (p_container = 'LG BOX') OR (p_container = 'LG PACK') OR (p_container = 'LG PKG'))))\n[INFOSEPARATOR]\nEC: 160351", 'children': [{'name': 'HASH_JOIN', 'timing': 0.038688, 'cardinality': 214377, 'extra_info': 'INNER\nl_partkey = p_partkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 160351\n', 'children': [{'name': 'FILTER', 'timing': 0.038244, 'cardinality': 214377, 'extra_info': "((l_shipmode = 'AIR') OR (l_shipmode = 'AIR REG'))\n[INFOSEPARATOR]\nEC: 300060", 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.322254, 'cardinality': 1500048, 'extra_info': "lineitem\n[INFOSEPARATOR]\nl_partkey\nl_quantity\nl_shipmode\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nFilters: l_shipinstruct='DELIVER IN PERSON' AND l_shipinstruct IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 300060", 'children': []}]}, {'name': 'SEQ_SCAN ', 'timing': 0.009004, 'cardinality': 200000, 'extra_info': 'part\n[INFOSEPARATOR]\np_partkey\np_brand\np_container\np_size\n[INFOSEPARATOR]\nEC: 200000', 'children': []}]}]}]}]}]}]}]}]}
X {'RESULT_COLLECTOR0': 4e-06, 'UNGROUPED_AGGREGATE1': 6e-06, 'PROJECTION2': 7e-06, 'PROJECTION3': 1e-06, 'PROJECTION4': 2e-06, 'FILTER5': 0.055361, 'HASH_JOIN6': 0.038688, 'FILTER7': 0.038244, 'SEQ_SCAN 8': 0.322254, 'SEQ_SCAN 9': 0.009004}
**** output size:  1
LINEAGE_5_FILTER_1
LINEAGE_5_FILTER_4
LINEAGE_5_HASH_JOIN_3
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_2
SELECT sum(l_extendedprice * (1 - l_discount)) AS revenue FROM lineitem, part WHERE (p_partkey = l_partkey AND p_brand = 'Brand#12' AND p_container IN ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') AND l_quantity >= 1 AND l_quantity <= 1 + 10 AND p_size BETWEEN 1 AND 5 AND l_shipmode IN ('AIR', 'AIR REG') AND l_shipinstruct = 'DELIVER IN PERSON') OR (p_partkey = l_partkey AND p_brand = 'Brand#23' AND p_container IN ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') AND l_quantity >= 10 AND l_quantity <= 10 + 10 AND p_size BETWEEN 1 AND 10 AND l_shipmode IN ('AIR', 'AIR REG') AND l_shipinstruct = 'DELIVER IN PERSON') OR (p_partkey = l_partkey AND p_brand = 'Brand#34' AND p_container IN ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') AND l_quantity >= 20 AND l_quantity <= 20 + 10 AND p_size BETWEEN 1 AND 15 AND l_shipmode IN ('AIR', 'AIR REG') AND l_shipinstruct = 'DELIVER IN PERSON');
   query_id  ...                                               plan
0         5  ...  {"name": "UNGROUPED_AGGREGATE", "opid": "8", "...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               SELECT sum(l_extendedprice * (1 - l_discount))...
size_bytes_max                                                3023404
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "UNGROUPED_AGGREGATE", "opid": "8", "...
Name: 0, dtype: object
{"name": "UNGROUPED_AGGREGATE", "opid": "8", "children": [{"name": "PROJECTION", "opid": "7", "children": [{"name": "PROJECTION", "opid": "6", "children": [{"name": "PROJECTION", "opid": "5", "children": [{"name": "FILTER", "opid": "4", "children": [{"name": "HASH_JOIN", "opid": "3", "children": [{"name": "FILTER", "opid": "1", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_partkey\nl_quantity\nl_shipmode\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nFilters: l_shipinstruct='DELIVER IN PERSON' AND l_shipinstruct IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 300060"}],"table": "","extra": "((l_shipmode = 'AIR') OR (l_shipmode = 'AIR REG'))\n[INFOSEPARATOR]\nEC: 300060"},{"name": "SEQ_SCAN ", "opid": "2", "children": [],"table": "part","extra": "part\n[INFOSEPARATOR]\np_partkey\np_brand\np_container\np_size\n[INFOSEPARATOR]\nEC: 200000"}],"table": "","extra": "INNER\nl_partkey = p_partkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 160351\n"}],"table": "","extra": "(((l_quantity <= 11.00) AND (p_size <= 5) AND (p_brand = 'Brand#12') AND ((p_container = 'SM CASE') OR (p_container = 'SM BOX') OR (p_container = 'SM PACK') OR (p_container = 'SM PKG'))) OR ((l_quantity >= 10.00) AND (l_quantity <= 20.00) AND (p_size <= 10) AND (p_brand = 'Brand#23') AND ((p_container = 'MED BAG') OR (p_container = 'MED BOX') OR (p_container = 'MED PKG') OR (p_container = 'MED PACK'))) OR ((l_quantity >= 20.00) AND (l_quantity <= 30.00) AND (p_size <= 15) AND (p_brand = 'Brand#34') AND ((p_container = 'LG CASE') OR (p_container = 'LG BOX') OR (p_container = 'LG PACK') OR (p_container = 'LG PKG'))))\n[INFOSEPARATOR]\nEC: 160351"}],"table": "","extra": "#1\n#3\n#4\n#6\n#7\n#8\n"}],"table": "","extra": "#1\n#2\n"}],"table": "","extra": "(l_extendedprice * (1.00 - l_discount))\n"}],"table": "","extra": "sum(#0)"}
Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                                                                                                                                                                              
│          ORDER_BY         │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│          ORDERS:          │                                                                                                                                                                              
│    supplier.s_name ASC    │                                                                                                                                                                              
└─────────────┬─────────────┘                                                                                                                                                                                                           
┌─────────────┴─────────────┐                                                                                                                                                                              
│         PROJECTION        │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│           s_name          │                                                                                                                                                                              
│         s_address         │                                                                                                                                                                              
└─────────────┬─────────────┘                                                                                                                                                                                                           
┌─────────────┴─────────────┐                                                                                                                                                                              
│         HASH_JOIN         │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│           INNER           │                                                                                                                                                                              
│       #0 = s_suppkey      │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐                                           
│        Build Min: 1       │                                                                                                                                  │                                           
│      Build Max: 10000     │                                                                                                                                  │                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                  │                                           
│          EC: 400          │                                                                                                                                  │                                           
└─────────────┬─────────────┘                                                                                                                                  │                                                                        
┌─────────────┴─────────────┐                                                                                                                    ┌─────────────┴─────────────┐                             
│         PROJECTION        │                                                                                                                    │         HASH_JOIN         │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│__internal_decompress_integ│                                                                                                                    │           INNER           │                             
│     ral_bigint(#0, 1)     │                                                                                                                    │ s_nationkey = n_nationkey │                             
│                           │                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐              
│                           │                                                                                                                    │        Build Min: 0       │              │              
│                           │                                                                                                                    │       Build Max: 24       │              │              
│                           │                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              
│                           │                                                                                                                    │          EC: 400          │              │              
└─────────────┬─────────────┘                                                                                                                    └─────────────┬─────────────┘              │                                           
┌─────────────┴─────────────┐                                                                                                                    ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
│       HASH_GROUP_BY       │                                                                                                                    │         SEQ_SCAN          ││         SEQ_SCAN          │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│             #0            │                                                                                                                    │          supplier         ││           nation          │
│                           │                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│                           │                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│                           │                                                                                                                    │         EC: 10000         ││  Filters: n_name='CANADA' │
│                           │                                                                                                                    │                           ││   AND n_name IS NOT NULL  │
│                           │                                                                                                                    │                           ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│                           │                                                                                                                    │                           ││           EC: 1           │
└─────────────┬─────────────┘                                                                                                                    └───────────────────────────┘└───────────────────────────┘                             
┌─────────────┴─────────────┐                                                                                                                                                                              
│         PROJECTION        │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│             #0            │                                                                                                                                                                              
└─────────────┬─────────────┘                                                                                                                                                                                                           
┌─────────────┴─────────────┐                                                                                                                                                                              
│         PROJECTION        │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│__internal_compress_integra│                                                                                                                                                                              
│     l_usmallint(#0, 1)    │                                                                                                                                                                              
└─────────────┬─────────────┘                                                                                                                                                                                                           
┌─────────────┴─────────────┐                                                                                                                                                                              
│         PROJECTION        │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│         ps_suppkey        │                                                                                                                                                                              
└─────────────┬─────────────┘                                                                                                                                                                                                           
┌─────────────┴─────────────┐                                                                                                                                                                              
│         PROJECTION        │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│             #0            │                                                                                                                                                                              
│             #4            │                                                                                                                                                                              
│             #5            │                                                                                                                                                                              
└─────────────┬─────────────┘                                                                                                                                                                                                           
┌─────────────┴─────────────┐                                                                                                                                                                              
│           FILTER          │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│    (CAST(ps_availqty AS   │                                                                                                                                                                              
│ DECIMAL(38,3)) > SUBQUERY)│                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│         EC: 800000        │                                                                                                                                                                              
└─────────────┬─────────────┘                                                                                                                                                                                                           
┌─────────────┴─────────────┐                                                                                                                                                                              
│      RIGHT_DELIM_JOIN     │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│           RIGHT           │                                                                                                                                                                              
│ ps_partkey IS NOT DISTINCT│                                                                                                                                                                              
│       FROM ps_partkey     ├───────────────────────────────────────────┐                                                                                                                                  
│ ps_suppkey IS NOT DISTINCT│                                           │                                                                                                                                  
│       FROM ps_suppkey     │                                           │                                                                                                                                  
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                           │                                                                                                                                  
│         EC: 800000        │                                           │                                                                                                                                  
└─────────────┬─────────────┘                                           │                                                                                                                                                               
┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐                                                                                                                    
│         HASH_JOIN         │                             │         HASH_JOIN         │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│           INNER           │                             │           RIGHT           │                                                                                                                    
│      ps_partkey = #0      │                             │ ps_partkey IS NOT DISTINCT│                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐              │       FROM ps_partkey     ├───────────────────────────────────────────┐                                                                        
│        Build Min: 1       │              │              │ ps_suppkey IS NOT DISTINCT│                                           │                                                                        
│     Build Max: 200000     │              │              │       FROM ps_suppkey     │                                           │                                                                        
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                           │                                                                        
│         EC: 800000        │              │              │         EC: 800000        │                                           │                                                                        
└─────────────┬─────────────┘              │              └─────────────┬─────────────┘                                           │                                                                                                     
┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐                                                          
│         SEQ_SCAN          ││         PROJECTION        ││         PROJECTION        │                             │         DUMMY_SCAN        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │                           │                                                          
│          partsupp         ││__internal_decompress_integ││  (0.5 * sum(l_quantity))  │                             │                           │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││     ral_bigint(#0, 1)     ││         ps_partkey        │                             │                           │                                                          
│         ps_partkey        ││                           ││         ps_suppkey        │                             │                           │                                                          
│        ps_availqty        ││                           ││                           │                             │                           │                                                          
│         ps_suppkey        ││                           ││                           │                             │                           │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           ││                           │                             │                           │                                                          
│         EC: 800000        ││                           ││                           │                             │                           │                                                          
└───────────────────────────┘└─────────────┬─────────────┘└─────────────┬─────────────┘                             └───────────────────────────┘                                                                                       
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                                                    
                             │       HASH_GROUP_BY       ││         PROJECTION        │                                                                                                                    
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
                             │             #0            ││__internal_decompress_integ│                                                                                                                    
                             │                           ││     ral_bigint(#0, 1)     │                                                                                                                    
                             │                           ││__internal_decompress_integ│                                                                                                                    
                             │                           ││     ral_bigint(#1, 1)     │                                                                                                                    
                             │                           ││             #2            │                                                                                                                    
                             └─────────────┬─────────────┘└─────────────┬─────────────┘                                                                                                                                                 
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                                                    
                             │         PROJECTION        ││       HASH_GROUP_BY       │                                                                                                                    
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
                             │             #0            ││             #0            │                                                                                                                    
                             │                           ││             #1            │                                                                                                                    
                             │                           ││          sum(#2)          │                                                                                                                    
                             └─────────────┬─────────────┘└─────────────┬─────────────┘                                                                                                                                                 
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                                                    
                             │         PROJECTION        ││         PROJECTION        │                                                                                                                    
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
                             │__internal_compress_integra││         ps_partkey        │                                                                                                                    
                             │     l_uinteger(#0, 1)     ││         ps_suppkey        │                                                                                                                    
                             │                           ││         l_quantity        │                                                                                                                    
                             └─────────────┬─────────────┘└─────────────┬─────────────┘                                                                                                                                                 
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                                                    
                             │         PROJECTION        ││         PROJECTION        │                                                                                                                    
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
                             │         p_partkey         ││__internal_compress_integra│                                                                                                                    
                             │                           ││     l_uinteger(#0, 1)     │                                                                                                                    
                             │                           ││__internal_compress_integra│                                                                                                                    
                             │                           ││     l_usmallint(#1, 1)    │                                                                                                                    
                             │                           ││             #2            │                                                                                                                    
                             │                           ││             #3            │                                                                                                                    
                             │                           ││             #4            │                                                                                                                    
                             └─────────────┬─────────────┘└─────────────┬─────────────┘                                                                                                                                                 
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                                                    
                             │           FILTER          ││         HASH_JOIN         │                                                                                                                    
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
                             │  prefix(p_name, 'forest') ││           INNER           │                                                                                                                    
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   l_partkey = ps_partkey  ├──────────────┐                                                                                                     
                             │          EC: 8000         ││   l_suppkey = ps_suppkey  │              │                                                                                                     
                             │                           ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                                                                                     
                             │                           ││        EC: 1200243        │              │                                                                                                     
                             └─────────────┬─────────────┘└─────────────┬─────────────┘              │                                                                                                                                  
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                       
                             │         SEQ_SCAN          ││         SEQ_SCAN          ││         DELIM_SCAN        │                                                                                       
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                                                                       
                             │            part           ││          lineitem         ││                           │                                                                                       
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                                                                       
                             │           p_name          ││         l_partkey         ││                           │                                                                                       
                             │         p_partkey         ││         l_suppkey         ││                           │                                                                                       
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││         l_quantity        ││                           │                                                                                       
                             │ Filters: p_name>='forest' ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                                                                       
                             │   AND p_name<'foresu' AND ││ Filters: l_shipdate>='1994││                           │                                                                                       
                             │     p_name IS NOT NULL    ││-01-01'::DATE AND l_sh...  ││                           │                                                                                       
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││  <'1995-01-01'::DATE AND  ││                           │                                                                                       
                             │         EC: 40000         ││   l_shipdate IS NOT NULL  ││                           │                                                                                       
                             │                           ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                                                                       
                             │                           ││        EC: 1200243        ││                           │                                                                                       
                             └───────────────────────────┘└───────────────────────────┘└───────────────────────────┘                                                                                                                    

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

%%%%%%%%%%%%%%%% Running Query #  20  threads:  1
SELECT s_name, s_address FROM supplier, nation WHERE s_suppkey IN ( SELECT ps_suppkey FROM partsupp WHERE ps_partkey IN ( SELECT p_partkey FROM part WHERE p_name LIKE 'forest%') AND ps_availqty > ( SELECT 0.5 * sum(l_quantity) FROM lineitem WHERE l_partkey = ps_partkey AND l_suppkey = ps_suppkey AND l_shipdate >= CAST('1994-01-01' AS date) AND l_shipdate < CAST('1995-01-01' AS date))) AND s_nationkey = n_nationkey AND n_name = 'CANADA' ORDER BY s_name;
Run:  None SELECT s_name, s_address FROM supplier, nation WHERE s_suppkey IN ( SELECT ps_suppkey FROM partsupp WHERE ps_partkey IN ( SELECT p_partkey FROM part WHERE p_name LIKE 'forest%') AND ps_availqty > ( SELECT 0.5 * sum(l_quantity) FROM lineitem WHERE l_partkey = ps_partkey AND l_suppkey = ps_suppkey AND l_shipdate >= CAST('1994-01-01' AS date) AND l_shipdate < CAST('1995-01-01' AS date))) AND s_nationkey = n_nationkey AND n_name = 'CANADA' ORDER BY s_name;
Avg Time in sec:  0.15469417721033096  output size:  186
                 s_name                               s_address
0    Supplier#000000020               JtPqm19E7tF 152Rl1wQZ8j0H
1    Supplier#000000091    35WVnU7GLNbQDcc2TARavGtk6RB6ZCd46UAY
2    Supplier#000000205                            Alrx5TN,hdnG
3    Supplier#000000285           q TMZEDyZtv vUiFKBhT3NJlnIxpL
4    Supplier#000000287                       UQR8bUA4V2HxVbw9K
..                  ...                                     ...
181  Supplier#000009811                  nXIxtBT6D1v6TCb2iMYkyU
182  Supplier#000009812     rbl9euXFoPLlKQVYDVyRouslbbbKDHAkyXY
183  Supplier#000009846  WTzdvihXbyqnx0JfbbVaxBOcO9d93DYbtBhi J
184  Supplier#000009899                       U3NBqk s Zz06al2m
185  Supplier#000009974         Uvh0hWngOu96WgB,OafBQOqwpWqzwg8

[186 rows x 2 columns]
{'name': 'Query', 'result': 0.150991, 'timing': 0.150991, 'cardinality': 0, 'extra-info': "SELECT s_name, s_address FROM supplier, nation WHERE s_suppkey IN ( SELECT ps_suppkey FROM partsupp WHERE ps_partkey IN ( SELECT p_partkey FROM part WHERE p_name LIKE 'forest%') AND ps_availqty > ( SELECT 0.5 * sum(l_quantity) FROM lineitem WHERE l_partkey = ps_partkey AND l_suppkey = ps_suppkey AND l_shipdate >= CAST('1994-01-01' AS date) AND l_shipdate < CAST('1995-01-01' AS date))) AND s_nationkey = n_nationkey AND n_name = 'CANADA' ORDER BY s_name;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 1.8e-05, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'ORDER_BY', 'timing': 7.5e-05, 'cardinality': 186, 'extra_info': 'ORDERS:\nsupplier.s_name ASC', 'children': [{'name': 'PROJECTION', 'timing': 2e-06, 'cardinality': 186, 'extra_info': 's_name\ns_address\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.000279, 'cardinality': 186, 'extra_info': 'INNER\n#0 = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 400\n', 'children': [{'name': 'PROJECTION', 'timing': 6e-06, 'cardinality': 4397, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.000537, 'cardinality': 4397, 'extra_info': '#0', 'children': [{'name': 'PROJECTION', 'timing': 2e-06, 'cardinality': 5833, 'extra_info': '#0\n', 'children': [{'name': 'PROJECTION', 'timing': 1.4e-05, 'cardinality': 5833, 'extra_info': '__internal_compress_integral_usmallint(#0, 1)\n', 'children': [{'name': 'PROJECTION', 'timing': 1e-06, 'cardinality': 5833, 'extra_info': 'ps_suppkey\n', 'children': [{'name': 'PROJECTION', 'timing': 4e-06, 'cardinality': 5833, 'extra_info': '#0\n#4\n#5\n', 'children': [{'name': 'FILTER', 'timing': 0.000341, 'cardinality': 5833, 'extra_info': '(CAST(ps_availqty AS DECIMAL(38,3)) > SUBQUERY)\n[INFOSEPARATOR]\nEC: 800000', 'children': [{'name': 'RIGHT_DELIM_JOIN', 'timing': 0.00187, 'cardinality': 0, 'extra_info': 'RIGHT\nps_partkey IS NOT DISTINCT FROM ps_partkey\nps_suppkey IS NOT DISTINCT FROM ps_suppkey\n\n[INFOSEPARATOR]\nEC: 800000\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.007002, 'cardinality': 8508, 'extra_info': 'INNER\nps_partkey = #0\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 800000\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.00174, 'cardinality': 800000, 'extra_info': 'partsupp\n[INFOSEPARATOR]\nps_partkey\nps_availqty\nps_suppkey\n[INFOSEPARATOR]\nEC: 800000', 'children': []}, {'name': 'PROJECTION', 'timing': 6e-06, 'cardinality': 2127, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.000364, 'cardinality': 2127, 'extra_info': '#0', 'children': [{'name': 'PROJECTION', 'timing': 1e-06, 'cardinality': 2127, 'extra_info': '#0\n', 'children': [{'name': 'PROJECTION', 'timing': 6e-06, 'cardinality': 2127, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n', 'children': [{'name': 'PROJECTION', 'timing': 1e-06, 'cardinality': 2127, 'extra_info': 'p_partkey\n', 'children': [{'name': 'FILTER', 'timing': 0.000388, 'cardinality': 2127, 'extra_info': "prefix(p_name, 'forest')\n[INFOSEPARATOR]\nEC: 8000", 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.007925, 'cardinality': 2127, 'extra_info': "part\n[INFOSEPARATOR]\np_name\np_partkey\n[INFOSEPARATOR]\nFilters: p_name>='forest' AND p_name<'foresu' AND p_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 40000", 'children': []}]}]}]}]}]}]}]}, {'name': 'HASH_JOIN', 'timing': 0.000772, 'cardinality': 8508, 'extra_info': 'RIGHT\nps_partkey IS NOT DISTINCT FROM ps_partkey\nps_suppkey IS NOT DISTINCT FROM ps_suppkey\n\n[INFOSEPARATOR]\nEC: 800000\n', 'children': [{'name': 'PROJECTION', 'timing': 0.000167, 'cardinality': 5843, 'extra_info': '(0.5 * sum(l_quantity))\nps_partkey\nps_suppkey\n', 'children': [{'name': 'PROJECTION', 'timing': 2e-05, 'cardinality': 5843, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n__internal_decompress_integral_bigint(#1, 1)\n#2\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.001484, 'cardinality': 5843, 'extra_info': '#0\n#1\nsum(#2)', 'children': [{'name': 'PROJECTION', 'timing': 7e-06, 'cardinality': 9741, 'extra_info': 'ps_partkey\nps_suppkey\nl_quantity\n', 'children': [{'name': 'PROJECTION', 'timing': 7.9e-05, 'cardinality': 9741, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n__internal_compress_integral_usmallint(#1, 1)\n#2\n#3\n#4\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.061633, 'cardinality': 9741, 'extra_info': 'INNER\nl_partkey = ps_partkey\nl_suppkey = ps_suppkey\n\n[INFOSEPARATOR]\nEC: 1200243\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.056388, 'cardinality': 909455, 'extra_info': "lineitem\n[INFOSEPARATOR]\nl_partkey\nl_suppkey\nl_quantity\n[INFOSEPARATOR]\nFilters: l_shipdate>='1994-01-01'::DATE AND l_shipdate<'1995-01-01'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243", 'children': []}, {'name': 'DELIM_SCAN', 'timing': 0.0, 'cardinality': 0, 'extra_info': '', 'children': []}]}]}]}]}]}]}, {'name': 'DUMMY_SCAN', 'timing': 0.0, 'cardinality': 0, 'extra_info': '', 'children': []}]}, {'name': 'HASH_GROUP_BY', 'timing': 0.000191, 'cardinality': 8508, 'extra_info': '#0\n#2', 'children': []}]}]}]}]}]}]}]}]}, {'name': 'HASH_JOIN', 'timing': 9.3e-05, 'cardinality': 412, 'extra_info': 'INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 400\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.000519, 'cardinality': 10000, 'extra_info': 'supplier\n[INFOSEPARATOR]\n\n[INFOSEPARATOR]\nEC: 10000', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 4e-05, 'cardinality': 1, 'extra_info': "nation\n[INFOSEPARATOR]\n\n[INFOSEPARATOR]\nFilters: n_name='CANADA' AND n_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1", 'children': []}]}]}]}]}]}]}
X {'RESULT_COLLECTOR0': 1.8e-05, 'ORDER_BY1': 7.5e-05, 'PROJECTION2': 2e-06, 'HASH_JOIN3': 0.000279, 'PROJECTION4': 6e-06, 'HASH_GROUP_BY5': 0.000537, 'PROJECTION6': 2e-06, 'PROJECTION7': 1.4e-05, 'PROJECTION8': 1e-06, 'PROJECTION9': 4e-06, 'FILTER10': 0.000341, 'RIGHT_DELIM_JOIN11': 0.00187, 'HASH_JOIN12': 0.007002, 'SEQ_SCAN 13': 0.00174, 'PROJECTION14': 6e-06, 'HASH_GROUP_BY15': 0.000364, 'PROJECTION16': 1e-06, 'PROJECTION17': 6e-06, 'PROJECTION18': 1e-06, 'FILTER19': 0.000388, 'SEQ_SCAN 20': 0.007925, 'HASH_JOIN21': 0.000772, 'PROJECTION22': 0.000167, 'PROJECTION23': 2e-05, 'HASH_GROUP_BY24': 0.001484, 'PROJECTION25': 7e-06, 'PROJECTION26': 7.9e-05, 'HASH_JOIN27': 0.061633, 'SEQ_SCAN 28': 0.056388, 'DELIM_SCAN29': 0.0, 'DUMMY_SCAN30': 0.0, 'HASH_GROUP_BY31': 0.000191, 'HASH_JOIN32': 9.3e-05, 'SEQ_SCAN 33': 0.000519, 'SEQ_SCAN 34': 4e-05}
compressed filter_log_size: 2282
compressed filter_log_buffer_size: 121
compressed limit_offset_size: 1248
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 10186
compressed perfect_full_scan_ht_log_buffer_size: 7786
compressed perfect_probe_ht_log_size: 56164
compressed perfect_probe_ht_log_buffer_size: 47984
compressed row_group_log_size: 700179
compressed row_group_log_buffer_size: 653359
compressed scatter_log_size: 38511
compressed scatter_log_buffer_size: 36646
compressed scatter_sel_log_size: 71861
compressed scatter_sel_log_buffer_size: 69354
compressed gather_log_size: 1248
compressed gather_log_buffer_size: 0
compressed combine_log_size: 1248
compressed combine_log_buffer_size: 0
compressed finalize_states_log_size: 8100
compressed finalize_states_log_buffer_size: 6258
compressed join_gather_log_size: 207937
compressed join_gather_log_buffer_size: 149385
compressed reorder_log_size: 2159
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 1248
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 1248
compressed nlj_log_buffer_size: 0
compressed total_size: 1103619
compressed total_buffer_size: 970893
compressed total_element_size: 132726

Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌─────────────────────┐                                                                                                                                                                                                               
│   STREAMING_LIMIT   │                                                                                                                                                                                                               
└──────────┬──────────┘                                                                                                                                                                                                                                      
┌──────────┴──────────┐                                                                                                                                                                                                               
│       ORDER_BY      │                                                                                                                                                                                                               
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                               
│       ORDERS:       │                                                                                                                                                                                                               
│  count_star() DESC  │                                                                                                                                                                                                               
│ supplier.s_name ASC │                                                                                                                                                                                                               
└──────────┬──────────┘                                                                                                                                                                                                                                      
┌──────────┴──────────┐                                                                                                                                                                                                               
│    HASH_GROUP_BY    │                                                                                                                                                                                                               
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                               
│          #0         │                                                                                                                                                                                                               
│     count_star()    │                                                                                                                                                                                                               
└──────────┬──────────┘                                                                                                                                                                                                                                      
┌──────────┴──────────┐                                                                                                                                                                                                               
│      PROJECTION     │                                                                                                                                                                                                               
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                               
│        s_name       │                                                                                                                                                                                                               
└──────────┬──────────┘                                                                                                                                                                                                                                      
┌──────────┴──────────┐                                                                                                                                                                                                               
│      PROJECTION     │                                                                                                                                                                                                               
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                               
│__internal_compress_i│                                                                                                                                                                                                               
│ ntegral_uinteger(#0,│                                                                                                                                                                                                               
│          1)         │                                                                                                                                                                                                               
│__internal_compress_i│                                                                                                                                                                                                               
│ntegral_usmallint(#1,│                                                                                                                                                                                                               
│          1)         │                                                                                                                                                                                                               
│__internal_compress_i│                                                                                                                                                                                                               
│ ntegral_uinteger(#2,│                                                                                                                                                                                                               
│          1)         │                                                                                                                                                                                                               
│          #3         │                                                                                                                                                                                                               
└──────────┬──────────┘                                                                                                                                                                                                                                      
┌──────────┴──────────┐                                                                                                                                                                                                               
│   RIGHT_DELIM_JOIN  │                                                                                                                                                                                                               
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                               
│      RIGHT_ANTI     │                                                                                                                                                                                                               
│  l_orderkey IS NOT  │                                                                                                                                                                                                               
│ DISTINCT FROM l...  ├─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐                                                         
│   l_suppkey IS NOT  │                                                                                                                                                     │                                                         
│ DISTINCT FROM l...  │                                                                                                                                                     │                                                         
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                     │                                                         
│     EC: 6001215     │                                                                                                                                                     │                                                         
└──────────┬──────────┘                                                                                                                                                     │                                                                                
┌──────────┴──────────┐                                                                                                                                          ┌──────────┴──────────┐                                              
│   RIGHT_DELIM_JOIN  │                                                                                                                                          │      HASH_JOIN      │                                              
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                          │   ─ ─ ─ ─ ─ ─ ─ ─   │                                              
│      RIGHT_SEMI     │                                                                                                                                          │      RIGHT_ANTI     │                                              
│  l_orderkey IS NOT  │                                                                                                                                          │  l_orderkey IS NOT  │                                              
│ DISTINCT FROM l...  ├────────────────────────────────────────────────────────────────────────────────┐                                                         │ DISTINCT FROM l...  ├──────────────────────────────────┐           
│   l_suppkey IS NOT  │                                                                                │                                                         │   l_suppkey IS NOT  │                                  │           
│ DISTINCT FROM l...  │                                                                                │                                                         │ DISTINCT FROM l...  │                                  │           
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                │                                                         │   ─ ─ ─ ─ ─ ─ ─ ─   │                                  │           
│     EC: 6001215     │                                                                                │                                                         │     EC: 6001215     │                                  │           
└──────────┬──────────┘                                                                                │                                                         └──────────┬──────────┘                                  │                                  
┌──────────┴──────────┐                                                                     ┌──────────┴──────────┐                                              ┌──────────┴──────────┐                       ┌──────────┴──────────┐
│      HASH_JOIN      │                                                                     │      HASH_JOIN      │                                              │      PROJECTION     │                       │      DUMMY_SCAN     │
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                     │   ─ ─ ─ ─ ─ ─ ─ ─   │                                              │   ─ ─ ─ ─ ─ ─ ─ ─   │                       │                     │
│        INNER        │                                                                     │      RIGHT_SEMI     │                                              │      l_orderkey     │                       │                     │
│     o_orderkey =    │                                                                     │  l_orderkey IS NOT  │                                              │      l_suppkey      │                       │                     │
│      l_orderkey     ├───────────┐                                                         │ DISTINCT FROM l...  ├──────────────────────────────────┐           │                     │                       │                     │
│   ─ ─ ─ ─ ─ ─ ─ ─   │           │                                                         │   l_suppkey IS NOT  │                                  │           │                     │                       │                     │
│      EC: 15866      │           │                                                         │ DISTINCT FROM l...  │                                  │           │                     │                       │                     │
│                     │           │                                                         │   ─ ─ ─ ─ ─ ─ ─ ─   │                                  │           │                     │                       │                     │
│                     │           │                                                         │     EC: 6001215     │                                  │           │                     │                       │                     │
└──────────┬──────────┘           │                                                         └──────────┬──────────┘                                  │           └──────────┬──────────┘                       └─────────────────────┘                       
┌──────────┴──────────┐┌──────────┴──────────┐                                              ┌──────────┴──────────┐                       ┌──────────┴──────────┐┌──────────┴──────────┐                                              
│      SEQ_SCAN       ││      HASH_JOIN      │                                              │      PROJECTION     │                       │      DUMMY_SCAN     ││      HASH_JOIN      │                                              
│   ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─   │                                              │   ─ ─ ─ ─ ─ ─ ─ ─   │                       │                     ││   ─ ─ ─ ─ ─ ─ ─ ─   │                                              
│        orders       ││        INNER        │                                              │      l_orderkey     │                       │                     ││        INNER        │                                              
│   ─ ─ ─ ─ ─ ─ ─ ─   ││l_suppkey = s_suppkey│                                              │      l_suppkey      │                       │                     ││     l_orderkey =    │                                              
│      o_orderkey     ││   ─ ─ ─ ─ ─ ─ ─ ─   │                                              │                     │                       │                     ││      l_orderkey     │                                              
│   ─ ─ ─ ─ ─ ─ ─ ─   ││     Build Min: 1    ├───────────┐                                  │                     │                       │                     ││     l_suppkey !=    ├───────────┐                                  
│Filters: o_orderstatu││   Build Max: 10000  │           │                                  │                     │                       │                     ││       l_suppkey     │           │                                  
│      s='F' AND      ││   ─ ─ ─ ─ ─ ─ ─ ─   │           │                                  │                     │                       │                     ││   ─ ─ ─ ─ ─ ─ ─ ─   │           │                                  
│ o_orderstatus I...  ││      EC: 47600      │           │                                  │                     │                       │                     ││     EC: 1200243     │           │                                  
│   ─ ─ ─ ─ ─ ─ ─ ─   ││                     │           │                                  │                     │                       │                     ││                     │           │                                  
│      EC: 500000     ││                     │           │                                  │                     │                       │                     ││                     │           │                                  
└─────────────────────┘└──────────┬──────────┘           │                                  └──────────┬──────────┘                       └─────────────────────┘└──────────┬──────────┘           │                                                         
                       ┌──────────┴──────────┐┌──────────┴──────────┐                       ┌──────────┴──────────┐                                              ┌──────────┴──────────┐┌──────────┴──────────┐                       
                       │        FILTER       ││      HASH_JOIN      │                       │      HASH_JOIN      │                                              │        FILTER       ││      DELIM_SCAN     │                       
                       │   ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─   │                       │   ─ ─ ─ ─ ─ ─ ─ ─   │                                              │   ─ ─ ─ ─ ─ ─ ─ ─   ││                     │                       
                       │   (l_receiptdate >  ││        INNER        │                       │        INNER        │                                              │   (l_receiptdate >  ││                     │                       
                       │     l_commitdate)   ││    s_nationkey =    │                       │     l_orderkey =    │                                              │     l_commitdate)   ││                     │                       
                       │   ─ ─ ─ ─ ─ ─ ─ ─   ││      n_nationkey    │                       │      l_orderkey     │                                              │   ─ ─ ─ ─ ─ ─ ─ ─   ││                     │                       
                       │     EC: 1200243     ││   ─ ─ ─ ─ ─ ─ ─ ─   ├───────────┐           │     l_suppkey !=    ├───────────┐                                  │     EC: 6001215     ││                     │                       
                       │                     ││     Build Min: 0    │           │           │       l_suppkey     │           │                                  │                     ││                     │                       
                       │                     ││    Build Max: 24    │           │           │   ─ ─ ─ ─ ─ ─ ─ ─   │           │                                  │                     ││                     │                       
                       │                     ││   ─ ─ ─ ─ ─ ─ ─ ─   │           │           │     EC: 6001215     │           │                                  │                     ││                     │                       
                       │                     ││       EC: 400       │           │           │                     │           │                                  │                     ││                     │                       
                       └──────────┬──────────┘└──────────┬──────────┘           │           └──────────┬──────────┘           │                                  └──────────┬──────────┘└─────────────────────┘                                              
                       ┌──────────┴──────────┐┌──────────┴──────────┐┌──────────┴──────────┐┌──────────┴──────────┐┌──────────┴──────────┐                       ┌──────────┴──────────┐                                              
                       │      SEQ_SCAN       ││      SEQ_SCAN       ││      SEQ_SCAN       ││      SEQ_SCAN       ││      DELIM_SCAN     │                       │      SEQ_SCAN       │                                              
                       │   ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─   ││                     │                       │   ─ ─ ─ ─ ─ ─ ─ ─   │                                              
                       │       lineitem      ││       supplier      ││        nation       ││       lineitem      ││                     │                       │       lineitem      │                                              
                       │   ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─   ││                     │                       │   ─ ─ ─ ─ ─ ─ ─ ─   │                                              
                       │      l_suppkey      ││      s_suppkey      ││     n_nationkey     ││      l_orderkey     ││                     │                       │      l_orderkey     │                                              
                       │      l_orderkey     ││     s_nationkey     ││   ─ ─ ─ ─ ─ ─ ─ ─   ││      l_suppkey      ││                     │                       │      l_suppkey      │                                              
                       │    l_receiptdate    ││        s_name       ││   Filters: n_name=  ││   ─ ─ ─ ─ ─ ─ ─ ─   ││                     │                       │    l_receiptdate    │                                              
                       │     l_commitdate    ││   ─ ─ ─ ─ ─ ─ ─ ─   ││'SAUDI ARABIA' A...  ││     EC: 6001215     ││                     │                       │     l_commitdate    │                                              
                       │   ─ ─ ─ ─ ─ ─ ─ ─   ││      EC: 10000      ││      IS NOT NULL    ││                     ││                     │                       │   ─ ─ ─ ─ ─ ─ ─ ─   │                                              
                       │     EC: 1200243     ││                     ││   ─ ─ ─ ─ ─ ─ ─ ─   ││                     ││                     │                       │     EC: 6001215     │                                              
                       │                     ││                     ││        EC: 1        ││                     ││                     │                       │                     │                                              
                       └─────────────────────┘└─────────────────────┘└─────────────────────┘└─────────────────────┘└─────────────────────┘                       └─────────────────────┘                                                                     

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

**** output size:  186
LINEAGE_5_FILTER_13
LINEAGE_5_FILTER_21
LINEAGE_5_HASH_GROUP_BY_10
LINEAGE_5_HASH_GROUP_BY_17
LINEAGE_5_HASH_GROUP_BY_26
LINEAGE_5_HASH_GROUP_BY_5
LINEAGE_5_HASH_JOIN_19
LINEAGE_5_HASH_JOIN_2
LINEAGE_5_HASH_JOIN_30
LINEAGE_5_HASH_JOIN_31
LINEAGE_5_HASH_JOIN_9
LINEAGE_5_ORDER_BY_33
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_11
LINEAGE_5_SEQ_SCAN_12
LINEAGE_5_SEQ_SCAN_28
LINEAGE_5_SEQ_SCAN_29
SELECT s_name, s_address FROM supplier, nation WHERE s_suppkey IN ( SELECT ps_suppkey FROM partsupp WHERE ps_partkey IN ( SELECT p_partkey FROM part WHERE p_name LIKE 'forest%') AND ps_availqty > ( SELECT 0.5 * sum(l_quantity) FROM lineitem WHERE l_partkey = ps_partkey AND l_suppkey = ps_suppkey AND l_shipdate >= CAST('1994-01-01' AS date) AND l_shipdate < CAST('1995-01-01' AS date))) AND s_nationkey = n_nationkey AND n_name = 'CANADA' ORDER BY s_name;
   query_id  ...                                               plan
0         5  ...  {"name": "ORDER_BY", "opid": "33", "children":...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               SELECT s_name, s_address FROM supplier, nation...
size_bytes_max                                                1103619
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "ORDER_BY", "opid": "33", "children":...
Name: 0, dtype: object
{"name": "ORDER_BY", "opid": "33", "children": [{"name": "PROJECTION", "opid": "32", "children": [{"name": "HASH_JOIN", "opid": "31", "children": [{"name": "PROJECTION", "opid": "27", "children": [{"name": "HASH_GROUP_BY", "opid": "26", "children": [{"name": "PROJECTION", "opid": "25", "children": [{"name": "PROJECTION", "opid": "24", "children": [{"name": "PROJECTION", "opid": "23", "children": [{"name": "PROJECTION", "opid": "22", "children": [{"name": "FILTER", "opid": "21", "children": [{"name": "RIGHT_DELIM_JOIN", "opid": "20", "children": [{"name": "HASH_GROUP_BY", "opid": "10", "children": [],"table": "","extra": "#0\n#2"},{"name": "HASH_JOIN", "opid": "9", "children": [{"name": "PROJECTION", "opid": "7", "children": [{"name": "PROJECTION", "opid": "6", "children": [{"name": "HASH_GROUP_BY", "opid": "5", "children": [{"name": "PROJECTION", "opid": "4", "children": [{"name": "PROJECTION", "opid": "3", "children": [{"name": "HASH_JOIN", "opid": "2", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_partkey\nl_suppkey\nl_quantity\n[INFOSEPARATOR]\nFilters: l_shipdate>='1994-01-01'::DATE AND l_shipdate<'1995-01-01'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243"},{"name": "DELIM_SCAN", "opid": "1", "children": [],"table": "","extra": ""}],"table": "","extra": "INNER\nl_partkey = ps_partkey\nl_suppkey = ps_suppkey\n\n[INFOSEPARATOR]\nEC: 1200243\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n__internal_compress_integral_usmallint(#1, 1)\n#2\n#3\n#4\n"}],"table": "","extra": "ps_partkey\nps_suppkey\nl_quantity\n"}],"table": "","extra": "#0\n#1\nsum(#2)"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n__internal_decompress_integral_bigint(#1, 1)\n#2\n"}],"table": "","extra": "(0.5 * sum(l_quantity))\nps_partkey\nps_suppkey\n"},{"name": "DUMMY_SCAN", "opid": "8", "children": [],"table": "","extra": ""}],"table": "","extra": "RIGHT\nps_partkey IS NOT DISTINCT FROM ps_partkey\nps_suppkey IS NOT DISTINCT FROM ps_suppkey\n\n[INFOSEPARATOR]\nEC: 800000\n"},{"name": "HASH_JOIN", "opid": "19", "children": [{"name": "SEQ_SCAN ", "opid": "11", "children": [],"table": "partsupp","extra": "partsupp\n[INFOSEPARATOR]\nps_partkey\nps_availqty\nps_suppkey\n[INFOSEPARATOR]\nEC: 800000"},{"name": "PROJECTION", "opid": "18", "children": [{"name": "HASH_GROUP_BY", "opid": "17", "children": [{"name": "PROJECTION", "opid": "16", "children": [{"name": "PROJECTION", "opid": "15", "children": [{"name": "PROJECTION", "opid": "14", "children": [{"name": "FILTER", "opid": "13", "children": [{"name": "SEQ_SCAN ", "opid": "12", "children": [],"table": "part","extra": "part\n[INFOSEPARATOR]\np_name\np_partkey\n[INFOSEPARATOR]\nFilters: p_name>='forest' AND p_name<'foresu' AND p_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 40000"}],"table": "","extra": "prefix(p_name, 'forest')\n[INFOSEPARATOR]\nEC: 8000"}],"table": "","extra": "p_partkey\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n"}],"table": "","extra": "#0\n"}],"table": "","extra": "#0"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n"}],"table": "","extra": "INNER\nps_partkey = #0\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 800000\n"}],"table": "","extra": "RIGHT\nps_partkey IS NOT DISTINCT FROM ps_partkey\nps_suppkey IS NOT DISTINCT FROM ps_suppkey\n\n[INFOSEPARATOR]\nEC: 800000\n"}],"table": "","extra": "(CAST(ps_availqty AS DECIMAL(38,3)) > SUBQUERY)\n[INFOSEPARATOR]\nEC: 800000"}],"table": "","extra": "#0\n#4\n#5\n"}],"table": "","extra": "ps_suppkey\n"}],"table": "","extra": "__internal_compress_integral_usmallint(#0, 1)\n"}],"table": "","extra": "#0\n"}],"table": "","extra": "#0"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n"},{"name": "HASH_JOIN", "opid": "30", "children": [{"name": "SEQ_SCAN ", "opid": "28", "children": [],"table": "supplier","extra": "supplier\n[INFOSEPARATOR]\n\n[INFOSEPARATOR]\nEC: 10000"},{"name": "SEQ_SCAN ", "opid": "29", "children": [],"table": "nation","extra": "nation\n[INFOSEPARATOR]\n\n[INFOSEPARATOR]\nFilters: n_name='CANADA' AND n_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1"}],"table": "","extra": "INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 400\n"}],"table": "","extra": "INNER\n#0 = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 400\n"}],"table": "","extra": "s_name\ns_address\n"}],"table": "","extra": "ORDERS:\nsupplier.s_name ASC"}
%%%%%%%%%%%%%%%% Running Query #  21  threads:  1
SELECT s_name, count(*) AS numwait FROM supplier, lineitem l1, orders, nation WHERE s_suppkey = l1.l_suppkey AND o_orderkey = l1.l_orderkey AND o_orderstatus = 'F' AND l1.l_receiptdate > l1.l_commitdate AND EXISTS ( SELECT * FROM lineitem l2 WHERE l2.l_orderkey = l1.l_orderkey AND l2.l_suppkey <> l1.l_suppkey) AND NOT EXISTS ( SELECT * FROM lineitem l3 WHERE l3.l_orderkey = l1.l_orderkey AND l3.l_suppkey <> l1.l_suppkey AND l3.l_receiptdate > l3.l_commitdate) AND s_nationkey = n_nationkey AND n_name = 'SAUDI ARABIA' GROUP BY s_name ORDER BY numwait DESC, s_name LIMIT 100;
Run:  None SELECT s_name, count(*) AS numwait FROM supplier, lineitem l1, orders, nation WHERE s_suppkey = l1.l_suppkey AND o_orderkey = l1.l_orderkey AND o_orderstatus = 'F' AND l1.l_receiptdate > l1.l_commitdate AND EXISTS ( SELECT * FROM lineitem l2 WHERE l2.l_orderkey = l1.l_orderkey AND l2.l_suppkey <> l1.l_suppkey) AND NOT EXISTS ( SELECT * FROM lineitem l3 WHERE l3.l_orderkey = l1.l_orderkey AND l3.l_suppkey <> l1.l_suppkey AND l3.l_receiptdate > l3.l_commitdate) AND s_nationkey = n_nationkey AND n_name = 'SAUDI ARABIA' GROUP BY s_name ORDER BY numwait DESC, s_name LIMIT 100;
Avg Time in sec:  0.6126370588317513  output size:  100
                s_name  numwait
0   Supplier#000002829       20
1   Supplier#000005808       18
2   Supplier#000000262       17
3   Supplier#000000496       17
4   Supplier#000002160       17
..                 ...      ...
95  Supplier#000001916       12
96  Supplier#000001925       12
97  Supplier#000002039       12
98  Supplier#000002357       12
99  Supplier#000002483       12

[100 rows x 2 columns]
{'name': 'Query', 'result': 0.606451, 'timing': 0.606451, 'cardinality': 0, 'extra-info': "SELECT s_name, count(*) AS numwait FROM supplier, lineitem l1, orders, nation WHERE s_suppkey = l1.l_suppkey AND o_orderkey = l1.l_orderkey AND o_orderstatus = 'F' AND l1.l_receiptdate > l1.l_commitdate AND EXISTS ( SELECT * FROM lineitem l2 WHERE l2.l_orderkey = l1.l_orderkey AND l2.l_suppkey <> l1.l_suppkey) AND NOT EXISTS ( SELECT * FROM lineitem l3 WHERE l3.l_orderkey = l1.l_orderkey AND l3.l_suppkey <> l1.l_suppkey AND l3.l_receiptdate > l3.l_commitdate) AND s_nationkey = n_nationkey AND n_name = 'SAUDI ARABIA' GROUP BY s_name ORDER BY numwait DESC, s_name LIMIT 100;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 1e-05, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'STREAMING_LIMIT', 'timing': 2e-06, 'cardinality': 100, 'extra_info': '', 'children': [{'name': 'ORDER_BY', 'timing': 5.1e-05, 'cardinality': 411, 'extra_info': 'ORDERS:\ncount_star() DESC\nsupplier.s_name ASC', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.001038, 'cardinality': 411, 'extra_info': '#0\ncount_star()', 'children': [{'name': 'PROJECTION', 'timing': 1e-06, 'cardinality': 4141, 'extra_info': 's_name\n', 'children': [{'name': 'PROJECTION', 'timing': 2.1e-05, 'cardinality': 4141, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n__internal_compress_integral_usmallint(#1, 1)\n__internal_compress_integral_uinteger(#2, 1)\n#3\n', 'children': [{'name': 'RIGHT_DELIM_JOIN', 'timing': 0.012481, 'cardinality': 0, 'extra_info': 'RIGHT_ANTI\nl_orderkey IS NOT DISTINCT FROM l_orderkey\nl_suppkey IS NOT DISTINCT FROM l_suppkey\n\n[INFOSEPARATOR]\nEC: 6001215\n', 'children': [{'name': 'RIGHT_DELIM_JOIN', 'timing': 0.028623, 'cardinality': 0, 'extra_info': 'RIGHT_SEMI\nl_orderkey IS NOT DISTINCT FROM l_orderkey\nl_suppkey IS NOT DISTINCT FROM l_suppkey\n\n[INFOSEPARATOR]\nEC: 6001215\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.057698, 'cardinality': 75871, 'extra_info': 'INNER\no_orderkey = l_orderkey\n\n[INFOSEPARATOR]\nEC: 15866\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.043134, 'cardinality': 729413, 'extra_info': "orders\n[INFOSEPARATOR]\no_orderkey\n[INFOSEPARATOR]\nFilters: o_orderstatus='F' AND o_orderstatus IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 500000", 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.043712, 'cardinality': 156739, 'extra_info': 'INNER\nl_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 47600\n', 'children': [{'name': 'FILTER', 'timing': 0.031917, 'cardinality': 3793296, 'extra_info': '(l_receiptdate > l_commitdate)\n[INFOSEPARATOR]\nEC: 1200243', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.013387, 'cardinality': 6001215, 'extra_info': 'lineitem\n[INFOSEPARATOR]\nl_suppkey\nl_orderkey\nl_receiptdate\nl_commitdate\n[INFOSEPARATOR]\nEC: 1200243', 'children': []}]}, {'name': 'HASH_JOIN', 'timing': 0.000109, 'cardinality': 411, 'extra_info': 'INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 400\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.000246, 'cardinality': 10000, 'extra_info': 'supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\ns_name\n[INFOSEPARATOR]\nEC: 10000', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 2.6e-05, 'cardinality': 1, 'extra_info': "nation\n[INFOSEPARATOR]\nn_nationkey\n[INFOSEPARATOR]\nFilters: n_name='SAUDI ARABIA' AND n_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1", 'children': []}]}]}]}, {'name': 'HASH_JOIN', 'timing': 0.044104, 'cardinality': 73089, 'extra_info': 'RIGHT_SEMI\nl_orderkey IS NOT DISTINCT FROM l_orderkey\nl_suppkey IS NOT DISTINCT FROM l_suppkey\n\n[INFOSEPARATOR]\nEC: 6001215\n', 'children': [{'name': 'PROJECTION', 'timing': 0.000769, 'cardinality': 302356, 'extra_info': 'l_orderkey\nl_suppkey\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.114614, 'cardinality': 302356, 'extra_info': 'INNER\nl_orderkey = l_orderkey\nl_suppkey != l_suppkey\n\n[INFOSEPARATOR]\nEC: 6001215\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.007658, 'cardinality': 6001215, 'extra_info': 'lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_suppkey\n[INFOSEPARATOR]\nEC: 6001215', 'children': []}, {'name': 'DELIM_SCAN', 'timing': 0.0, 'cardinality': 0, 'extra_info': '', 'children': []}]}]}, {'name': 'DUMMY_SCAN', 'timing': 0.0, 'cardinality': 0, 'extra_info': '', 'children': []}]}, {'name': 'HASH_GROUP_BY', 'timing': 0.0016, 'cardinality': 75864, 'extra_info': '#0\n#1', 'children': []}]}, {'name': 'HASH_JOIN', 'timing': 0.020312, 'cardinality': 4141, 'extra_info': 'RIGHT_ANTI\nl_orderkey IS NOT DISTINCT FROM l_orderkey\nl_suppkey IS NOT DISTINCT FROM l_suppkey\n\n[INFOSEPARATOR]\nEC: 6001215\n', 'children': [{'name': 'PROJECTION', 'timing': 0.00023, 'cardinality': 190909, 'extra_info': 'l_orderkey\nl_suppkey\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.106039, 'cardinality': 190909, 'extra_info': 'INNER\nl_orderkey = l_orderkey\nl_suppkey != l_suppkey\n\n[INFOSEPARATOR]\nEC: 1200243\n', 'children': [{'name': 'FILTER', 'timing': 0.026513, 'cardinality': 3793296, 'extra_info': '(l_receiptdate > l_commitdate)\n[INFOSEPARATOR]\nEC: 6001215', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.010592, 'cardinality': 6001215, 'extra_info': 'lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_suppkey\nl_receiptdate\nl_commitdate\n[INFOSEPARATOR]\nEC: 6001215', 'children': []}]}, {'name': 'DELIM_SCAN', 'timing': 0.0, 'cardinality': 0, 'extra_info': '', 'children': []}]}]}, {'name': 'DUMMY_SCAN', 'timing': 0.0, 'cardinality': 0, 'extra_info': '', 'children': []}]}, {'name': 'HASH_GROUP_BY', 'timing': 0.00141, 'cardinality': 73082, 'extra_info': '#0\n#1', 'children': []}]}]}]}]}]}]}]}]}
compressed filter_log_size: 1569496
compressed filter_log_buffer_size: 1500330
compressed limit_offset_size: 1232
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 3279
compressed perfect_full_scan_ht_log_buffer_size: 1423
compressed perfect_probe_ht_log_size: 848532
compressed perfect_probe_ht_log_buffer_size: 799990
compressed row_group_log_size: 263934
compressed row_group_log_buffer_size: 187517
compressed scatter_log_size: 102626
compressed scatter_log_buffer_size: 96515
compressed scatter_sel_log_size: 1750966
compressed scatter_sel_log_buffer_size: 1735396
compressed gather_log_size: 1088
compressed gather_log_buffer_size: 0
compressed combine_log_size: 1088
compressed combine_log_buffer_size: 0
compressed finalize_states_log_size: 26495
compressed finalize_states_log_buffer_size: 24569
compressed join_gather_log_size: 6039017
compressed join_gather_log_buffer_size: 5646936
compressed reorder_log_size: 2232
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 1088
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 1088
compressed nlj_log_buffer_size: 0
compressed total_size: 10612161
compressed total_buffer_size: 9992676
compressed total_element_size: 619485

Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                                                                                                                                                                              
│          ORDER_BY         │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│          ORDERS:          │                                                                                                                                                                              
│   custsale.cntrycode ASC  │                                                                                                                                                                              
└─────────────┬─────────────┘                                                                                                                                                                                                           
┌─────────────┴─────────────┐                                                                                                                                                                              
│       HASH_GROUP_BY       │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│             #0            │                                                                                                                                                                              
│        count_star()       │                                                                                                                                                                              
│          sum(#1)          │                                                                                                                                                                              
└─────────────┬─────────────┘                                                                                                                                                                                                           
┌─────────────┴─────────────┐                                                                                                                                                                              
│         PROJECTION        │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│         cntrycode         │                                                                                                                                                                              
│         c_acctbal         │                                                                                                                                                                              
└─────────────┬─────────────┘                                                                                                                                                                                                           
┌─────────────┴─────────────┐                                                                                                                                                                              
│         PROJECTION        │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│         cntrycode         │                                                                                                                                                                              
│         c_acctbal         │                                                                                                                                                                              
└─────────────┬─────────────┘                                                                                                                                                                                                           
┌─────────────┴─────────────┐                                                                                                                                                                              
│      RIGHT_DELIM_JOIN     │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│         RIGHT_ANTI        │                                                                                                                                                                              
│ c_custkey IS NOT DISTINCT ├─────────────────────────────────────────────────────────────────────────────────────────────────────┐                                                                        
│       FROM c_custkey      │                                                                                                     │                                                                        
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                     │                                                                        
│        EC: 1500000        │                                                                                                     │                                                                        
└─────────────┬─────────────┘                                                                                                     │                                                                                                     
┌─────────────┴─────────────┐                                                                                       ┌─────────────┴─────────────┐                                                          
│      NESTED_LOOP_JOIN     │                                                                                       │         HASH_JOIN         │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│           INNER           │                                                                                       │         RIGHT_ANTI        │                                                          
│CAST(c_acctbal AS DOUBLE) >├───────────────────────────────────────────┐                                           │ c_custkey IS NOT DISTINCT ├───────────────────────────────────────────┐              
│          SUBQUERY         │                                           │                                           │       FROM c_custkey      │                                           │              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                           │                                           │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                           │              
│           EC: 0           │                                           │                                           │        EC: 1500000        │                                           │              
└─────────────┬─────────────┘                                           │                                           └─────────────┬─────────────┘                                           │                                           
┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐
│           FILTER          │                             │    UNGROUPED_AGGREGATE    │                             │         PROJECTION        │                             │         DUMMY_SCAN        │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │                           │
│          IN (...)         │                             │         first(#0)         │                             │         c_custkey         │                             │                           │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │                           │                             │                           │                             │                           │
│         EC: 30000         │                             │                           │                             │                           │                             │                           │
└─────────────┬─────────────┘                             └─────────────┬─────────────┘                             └─────────────┬─────────────┘                             └───────────────────────────┘                             
┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐                                                          
│         HASH_JOIN         │                             │         PROJECTION        │                             │         HASH_JOIN         │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│            MARK           │                             │             #0            │                             │           INNER           │                                                          
│substring(c_phone, 1, 2) = ├──────────────┐              │                           │                             │   o_custkey = c_custkey   ├──────────────┐                                           
│             #0            │              │              │                           │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              │                           │                             │        EC: 1500000        │              │                                           
│         EC: 150000        │              │              │                           │                             │                           │              │                                           
└─────────────┬─────────────┘              │              └─────────────┬─────────────┘                             └─────────────┬─────────────┘              │                                                                        
┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             
│         SEQ_SCAN          ││      COLUMN_DATA_SCAN     ││      STREAMING_LIMIT      │                             │         SEQ_SCAN          ││         DELIM_SCAN        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           ││                           │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                             
│          customer         ││                           ││                           │                             │           orders          ││                           │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           ││                           │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                             
│          c_phone          ││                           ││                           │                             │         o_custkey         ││                           │                             
│         c_acctbal         ││                           ││                           │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                             
│         c_custkey         ││                           ││                           │                             │        EC: 1500000        ││                           │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           ││                           │                             │                           ││                           │                             
│         EC: 150000        ││                           ││                           │                             │                           ││                           │                             
└───────────────────────────┘└───────────────────────────┘└─────────────┬─────────────┘                             └───────────────────────────┘└───────────────────────────┘                                                          
                                                          ┌─────────────┴─────────────┐                                                                                                                    
                                                          │    UNGROUPED_AGGREGATE    │                                                                                                                    
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
                                                          │          avg(#0)          │                                                                                                                    
                                                          └─────────────┬─────────────┘                                                                                                                                                 
                                                          ┌─────────────┴─────────────┐                                                                                                                    
                                                          │         PROJECTION        │                                                                                                                    
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
                                                          │         c_acctbal         │                                                                                                                    
                                                          └─────────────┬─────────────┘                                                                                                                                                 
                                                          ┌─────────────┴─────────────┐                                                                                                                    
                                                          │         PROJECTION        │                                                                                                                    
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
                                                          │             #0            │                                                                                                                    
                                                          │             #2            │                                                                                                                    
                                                          └─────────────┬─────────────┘                                                                                                                                                 
                                                          ┌─────────────┴─────────────┐                                                                                                                    
                                                          │           FILTER          │                                                                                                                    
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
                                                          │          IN (...)         │                                                                                                                    
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
                                                          │          EC: 6000         │                                                                                                                    
                                                          └─────────────┬─────────────┘                                                                                                                                                 
                                                          ┌─────────────┴─────────────┐                                                                                                                    
                                                          │         HASH_JOIN         │                                                                                                                    
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
                                                          │            MARK           │                                                                                                                    
                                                          │substring(c_phone, 1, 2) = ├──────────────┐                                                                                                     
                                                          │             #0            │              │                                                                                                     
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                                                                                     
                                                          │         EC: 30000         │              │                                                                                                     
                                                          └─────────────┬─────────────┘              │                                                                                                                                  
                                                          ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                       
                                                          │         SEQ_SCAN          ││      COLUMN_DATA_SCAN     │                                                                                       
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                                                                       
                                                          │          customer         ││                           │                                                                                       
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                                                                       
                                                          │         c_acctbal         ││                           │                                                                                       
                                                          │          c_phone          ││                           │                                                                                       
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                                                                       
                                                          │Filters: c_acctbal>0.00 AND││                           │                                                                                       
                                                          │    c_acctbal IS NOT NULL  ││                           │                                                                                       
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                                                                       
                                                          │         EC: 30000         ││                           │                                                                                       
                                                          └───────────────────────────┘└───────────────────────────┘                                                                                                                    

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

X {'RESULT_COLLECTOR0': 1e-05, 'STREAMING_LIMIT1': 2e-06, 'ORDER_BY2': 5.1e-05, 'HASH_GROUP_BY3': 0.001038, 'PROJECTION4': 1e-06, 'PROJECTION5': 2.1e-05, 'RIGHT_DELIM_JOIN6': 0.012481, 'RIGHT_DELIM_JOIN7': 0.028623, 'HASH_JOIN8': 0.057698, 'SEQ_SCAN 9': 0.043134, 'HASH_JOIN10': 0.043712, 'FILTER11': 0.031917, 'SEQ_SCAN 12': 0.013387, 'HASH_JOIN13': 0.000109, 'SEQ_SCAN 14': 0.000246, 'SEQ_SCAN 15': 2.6e-05, 'HASH_JOIN16': 0.044104, 'PROJECTION17': 0.000769, 'HASH_JOIN18': 0.114614, 'SEQ_SCAN 19': 0.007658, 'DELIM_SCAN20': 0.0, 'DUMMY_SCAN21': 0.0, 'HASH_GROUP_BY22': 0.0016, 'HASH_JOIN23': 0.020312, 'PROJECTION24': 0.00023, 'HASH_JOIN25': 0.106039, 'FILTER26': 0.026513, 'SEQ_SCAN 27': 0.010592, 'DELIM_SCAN28': 0.0, 'DUMMY_SCAN29': 0.0, 'HASH_GROUP_BY30': 0.00141}
**** output size:  100
LINEAGE_5_FILTER_1
LINEAGE_5_FILTER_17
LINEAGE_5_HASH_GROUP_BY_14
LINEAGE_5_HASH_GROUP_BY_27
LINEAGE_5_HASH_GROUP_BY_7
LINEAGE_5_HASH_JOIN_10
LINEAGE_5_HASH_JOIN_13
LINEAGE_5_HASH_JOIN_20
LINEAGE_5_HASH_JOIN_21
LINEAGE_5_HASH_JOIN_22
LINEAGE_5_HASH_JOIN_3
LINEAGE_5_HASH_JOIN_6
LINEAGE_5_ORDER_BY_28
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_15
LINEAGE_5_SEQ_SCAN_16
LINEAGE_5_SEQ_SCAN_18
LINEAGE_5_SEQ_SCAN_19
LINEAGE_5_SEQ_SCAN_8
LINEAGE_5_STREAMING_LIMIT_29
SELECT s_name, count(*) AS numwait FROM supplier, lineitem l1, orders, nation WHERE s_suppkey = l1.l_suppkey AND o_orderkey = l1.l_orderkey AND o_orderstatus = 'F' AND l1.l_receiptdate > l1.l_commitdate AND EXISTS ( SELECT * FROM lineitem l2 WHERE l2.l_orderkey = l1.l_orderkey AND l2.l_suppkey <> l1.l_suppkey) AND NOT EXISTS ( SELECT * FROM lineitem l3 WHERE l3.l_orderkey = l1.l_orderkey AND l3.l_suppkey <> l1.l_suppkey AND l3.l_receiptdate > l3.l_commitdate) AND s_nationkey = n_nationkey AND n_name = 'SAUDI ARABIA' GROUP BY s_name ORDER BY numwait DESC, s_name LIMIT 100;
   query_id  ...                                               plan
0         5  ...  {"name": "STREAMING_LIMIT", "opid": "29", "chi...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               SELECT s_name, count(*) AS numwait FROM suppli...
size_bytes_max                                               10612161
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "STREAMING_LIMIT", "opid": "29", "chi...
Name: 0, dtype: object
{"name": "STREAMING_LIMIT", "opid": "29", "children": [{"name": "ORDER_BY", "opid": "28", "children": [{"name": "HASH_GROUP_BY", "opid": "27", "children": [{"name": "PROJECTION", "opid": "26", "children": [{"name": "PROJECTION", "opid": "25", "children": [{"name": "RIGHT_DELIM_JOIN", "opid": "24", "children": [{"name": "HASH_GROUP_BY", "opid": "7", "children": [],"table": "","extra": "#0\n#1"},{"name": "HASH_JOIN", "opid": "6", "children": [{"name": "PROJECTION", "opid": "4", "children": [{"name": "HASH_JOIN", "opid": "3", "children": [{"name": "FILTER", "opid": "1", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_suppkey\nl_receiptdate\nl_commitdate\n[INFOSEPARATOR]\nEC: 6001215"}],"table": "","extra": "(l_receiptdate > l_commitdate)\n[INFOSEPARATOR]\nEC: 6001215"},{"name": "DELIM_SCAN", "opid": "2", "children": [],"table": "","extra": ""}],"table": "","extra": "INNER\nl_orderkey = l_orderkey\nl_suppkey != l_suppkey\n\n[INFOSEPARATOR]\nEC: 1200243\n"}],"table": "","extra": "l_orderkey\nl_suppkey\n"},{"name": "DUMMY_SCAN", "opid": "5", "children": [],"table": "","extra": ""}],"table": "","extra": "RIGHT_ANTI\nl_orderkey IS NOT DISTINCT FROM l_orderkey\nl_suppkey IS NOT DISTINCT FROM l_suppkey\n\n[INFOSEPARATOR]\nEC: 6001215\n"},{"name": "RIGHT_DELIM_JOIN", "opid": "23", "children": [{"name": "HASH_GROUP_BY", "opid": "14", "children": [],"table": "","extra": "#0\n#1"},{"name": "HASH_JOIN", "opid": "13", "children": [{"name": "PROJECTION", "opid": "11", "children": [{"name": "HASH_JOIN", "opid": "10", "children": [{"name": "SEQ_SCAN ", "opid": "8", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_suppkey\n[INFOSEPARATOR]\nEC: 6001215"},{"name": "DELIM_SCAN", "opid": "9", "children": [],"table": "","extra": ""}],"table": "","extra": "INNER\nl_orderkey = l_orderkey\nl_suppkey != l_suppkey\n\n[INFOSEPARATOR]\nEC: 6001215\n"}],"table": "","extra": "l_orderkey\nl_suppkey\n"},{"name": "DUMMY_SCAN", "opid": "12", "children": [],"table": "","extra": ""}],"table": "","extra": "RIGHT_SEMI\nl_orderkey IS NOT DISTINCT FROM l_orderkey\nl_suppkey IS NOT DISTINCT FROM l_suppkey\n\n[INFOSEPARATOR]\nEC: 6001215\n"},{"name": "HASH_JOIN", "opid": "22", "children": [{"name": "SEQ_SCAN ", "opid": "15", "children": [],"table": "orders","extra": "orders\n[INFOSEPARATOR]\no_orderkey\n[INFOSEPARATOR]\nFilters: o_orderstatus='F' AND o_orderstatus IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 500000"},{"name": "HASH_JOIN", "opid": "21", "children": [{"name": "FILTER", "opid": "17", "children": [{"name": "SEQ_SCAN ", "opid": "16", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_suppkey\nl_orderkey\nl_receiptdate\nl_commitdate\n[INFOSEPARATOR]\nEC: 1200243"}],"table": "","extra": "(l_receiptdate > l_commitdate)\n[INFOSEPARATOR]\nEC: 1200243"},{"name": "HASH_JOIN", "opid": "20", "children": [{"name": "SEQ_SCAN ", "opid": "18", "children": [],"table": "supplier","extra": "supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\ns_name\n[INFOSEPARATOR]\nEC: 10000"},{"name": "SEQ_SCAN ", "opid": "19", "children": [],"table": "nation","extra": "nation\n[INFOSEPARATOR]\nn_nationkey\n[INFOSEPARATOR]\nFilters: n_name='SAUDI ARABIA' AND n_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1"}],"table": "","extra": "INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 400\n"}],"table": "","extra": "INNER\nl_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 47600\n"}],"table": "","extra": "INNER\no_orderkey = l_orderkey\n\n[INFOSEPARATOR]\nEC: 15866\n"}],"table": "","extra": "RIGHT_SEMI\nl_orderkey IS NOT DISTINCT FROM l_orderkey\nl_suppkey IS NOT DISTINCT FROM l_suppkey\n\n[INFOSEPARATOR]\nEC: 6001215\n"}],"table": "","extra": "RIGHT_ANTI\nl_orderkey IS NOT DISTINCT FROM l_orderkey\nl_suppkey IS NOT DISTINCT FROM l_suppkey\n\n[INFOSEPARATOR]\nEC: 6001215\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n__internal_compress_integral_usmallint(#1, 1)\n__internal_compress_integral_uinteger(#2, 1)\n#3\n"}],"table": "","extra": "s_name\n"}],"table": "","extra": "#0\ncount_star()"}],"table": "","extra": "ORDERS:\ncount_star() DESC\nsupplier.s_name ASC"}],"table": "","extra": ""}
%%%%%%%%%%%%%%%% Running Query #  22  threads:  1
SELECT cntrycode, count(*) AS numcust, sum(c_acctbal) AS totacctbal FROM ( SELECT substring(c_phone FROM 1 FOR 2) AS cntrycode, c_acctbal FROM customer WHERE substring(c_phone FROM 1 FOR 2) IN ('13', '31', '23', '29', '30', '18', '17') AND c_acctbal > ( SELECT avg(c_acctbal) FROM customer WHERE c_acctbal > 0.00 AND substring(c_phone FROM 1 FOR 2) IN ('13', '31', '23', '29', '30', '18', '17')) AND NOT EXISTS ( SELECT * FROM orders WHERE o_custkey = c_custkey)) AS custsale GROUP BY cntrycode ORDER BY cntrycode;
Run:  None SELECT cntrycode, count(*) AS numcust, sum(c_acctbal) AS totacctbal FROM ( SELECT substring(c_phone FROM 1 FOR 2) AS cntrycode, c_acctbal FROM customer WHERE substring(c_phone FROM 1 FOR 2) IN ('13', '31', '23', '29', '30', '18', '17') AND c_acctbal > ( SELECT avg(c_acctbal) FROM customer WHERE c_acctbal > 0.00 AND substring(c_phone FROM 1 FOR 2) IN ('13', '31', '23', '29', '30', '18', '17')) AND NOT EXISTS ( SELECT * FROM orders WHERE o_custkey = c_custkey)) AS custsale GROUP BY cntrycode ORDER BY cntrycode;
Avg Time in sec:  0.0991759062744677  output size:  7
  cntrycode  numcust  totacctbal
0        13      888  6737713.99
1        17      861  6460573.72
2        18      964  7236687.40
3        23      892  6701457.95
4        29      948  7158866.63
5        30      909  6808436.13
6        31      922  6806670.18
compressed filter_log_size: 40481
compressed filter_log_buffer_size: 37254
compressed limit_offset_size: 1200
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 1056
compressed perfect_full_scan_ht_log_buffer_size: 0
compressed perfect_probe_ht_log_size: 1056
compressed perfect_probe_ht_log_buffer_size: 0
compressed row_group_log_size: 26350
compressed row_group_log_buffer_size: 17936
compressed scatter_log_size: 16582
compressed scatter_log_buffer_size: 14852
compressed scatter_sel_log_size: 164569
compressed scatter_sel_log_buffer_size: 161725
compressed gather_log_size: 1056
compressed gather_log_buffer_size: 0
compressed combine_log_size: 1056
compressed combine_log_buffer_size: 0
compressed finalize_states_log_size: 7286
compressed finalize_states_log_buffer_size: 5895
compressed join_gather_log_size: 1867488
compressed join_gather_log_buffer_size: 1815018
compressed reorder_log_size: 1664
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 1056
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 9911
compressed nlj_log_buffer_size: 7419
compressed total_size: 2140811
compressed total_buffer_size: 2060099
compressed total_element_size: 80712

{'name': 'Query', 'result': 0.094001, 'timing': 0.094001, 'cardinality': 0, 'extra-info': "SELECT cntrycode, count(*) AS numcust, sum(c_acctbal) AS totacctbal FROM ( SELECT substring(c_phone FROM 1 FOR 2) AS cntrycode, c_acctbal FROM customer WHERE substring(c_phone FROM 1 FOR 2) IN ('13', '31', '23', '29', '30', '18', '17') AND c_acctbal > ( SELECT avg(c_acctbal) FROM customer WHERE c_acctbal > 0.00 AND substring(c_phone FROM 1 FOR 2) IN ('13', '31', '23', '29', '30', '18', '17')) AND NOT EXISTS ( SELECT * FROM orders WHERE o_custkey = c_custkey)) AS custsale GROUP BY cntrycode ORDER BY cntrycode;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 5e-06, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'ORDER_BY', 'timing': 4e-05, 'cardinality': 7, 'extra_info': 'ORDERS:\ncustsale.cntrycode ASC', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.000609, 'cardinality': 7, 'extra_info': '#0\ncount_star()\nsum(#1)', 'children': [{'name': 'PROJECTION', 'timing': 1e-06, 'cardinality': 6384, 'extra_info': 'cntrycode\nc_acctbal\n', 'children': [{'name': 'PROJECTION', 'timing': 0.000246, 'cardinality': 6384, 'extra_info': 'cntrycode\nc_acctbal\n', 'children': [{'name': 'RIGHT_DELIM_JOIN', 'timing': 0.006166, 'cardinality': 0, 'extra_info': 'RIGHT_ANTI\nc_custkey IS NOT DISTINCT FROM c_custkey\n\n[INFOSEPARATOR]\nEC: 1500000\n', 'children': [{'name': 'NESTED_LOOP_JOIN', 'timing': 0.001742, 'cardinality': 19000, 'extra_info': 'INNER\nCAST(c_acctbal AS DOUBLE) > SUBQUERY\n\n[INFOSEPARATOR]\nEC: 0\n', 'children': [{'name': 'FILTER', 'timing': 0.000834, 'cardinality': 42015, 'extra_info': 'IN (...)\n[INFOSEPARATOR]\nEC: 30000', 'children': [{'name': 'HASH_JOIN', 'timing': 0.007344, 'cardinality': 150000, 'extra_info': 'MARK\nsubstring(c_phone, 1, 2) = #0\n\n[INFOSEPARATOR]\nEC: 150000\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.002689, 'cardinality': 150000, 'extra_info': 'customer\n[INFOSEPARATOR]\nc_phone\nc_acctbal\nc_custkey\n[INFOSEPARATOR]\nEC: 150000', 'children': []}, {'name': 'COLUMN_DATA_SCAN', 'timing': 3e-06, 'cardinality': 7, 'extra_info': '', 'children': []}]}]}, {'name': 'UNGROUPED_AGGREGATE', 'timing': 2e-06, 'cardinality': 1, 'extra_info': 'first(#0)', 'children': [{'name': 'PROJECTION', 'timing': 0.0, 'cardinality': 1, 'extra_info': '#0\n', 'children': [{'name': 'STREAMING_LIMIT', 'timing': 2e-06, 'cardinality': 1, 'extra_info': '', 'children': [{'name': 'UNGROUPED_AGGREGATE', 'timing': 0.000108, 'cardinality': 1, 'extra_info': 'avg(#0)', 'children': [{'name': 'PROJECTION', 'timing': 1.4e-05, 'cardinality': 38120, 'extra_info': 'c_acctbal\n', 'children': [{'name': 'PROJECTION', 'timing': 2.2e-05, 'cardinality': 38120, 'extra_info': '#0\n#2\n', 'children': [{'name': 'FILTER', 'timing': 0.000841, 'cardinality': 38120, 'extra_info': 'IN (...)\n[INFOSEPARATOR]\nEC: 6000', 'children': [{'name': 'HASH_JOIN', 'timing': 0.006542, 'cardinality': 136308, 'extra_info': 'MARK\nsubstring(c_phone, 1, 2) = #0\n\n[INFOSEPARATOR]\nEC: 30000\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.004261, 'cardinality': 136308, 'extra_info': 'customer\n[INFOSEPARATOR]\nc_acctbal\nc_phone\n[INFOSEPARATOR]\nFilters: c_acctbal>0.00 AND c_acctbal IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 30000', 'children': []}, {'name': 'COLUMN_DATA_SCAN', 'timing': 8e-06, 'cardinality': 7, 'extra_info': '', 'children': []}]}]}]}]}]}]}]}]}]}, {'name': 'HASH_JOIN', 'timing': 0.014403, 'cardinality': 6384, 'extra_info': 'RIGHT_ANTI\nc_custkey IS NOT DISTINCT FROM c_custkey\n\n[INFOSEPARATOR]\nEC: 1500000\n', 'children': [{'name': 'PROJECTION', 'timing': 0.000179, 'cardinality': 190069, 'extra_info': 'c_custkey\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.04033, 'cardinality': 190069, 'extra_info': 'INNER\no_custkey = c_custkey\n\n[INFOSEPARATOR]\nEC: 1500000\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.001844, 'cardinality': 1500000, 'extra_info': 'orders\n[INFOSEPARATOR]\no_custkey\n[INFOSEPARATOR]\nEC: 1500000', 'children': []}, {'name': 'DELIM_SCAN', 'timing': 0.0, 'cardinality': 0, 'extra_info': '', 'children': []}]}]}, {'name': 'DUMMY_SCAN', 'timing': 0.0, 'cardinality': 0, 'extra_info': '', 'children': []}]}, {'name': 'HASH_GROUP_BY', 'timing': 0.000327, 'cardinality': 19000, 'extra_info': '#2', 'children': []}]}]}]}]}]}]}]}
X {'RESULT_COLLECTOR0': 5e-06, 'ORDER_BY1': 4e-05, 'HASH_GROUP_BY2': 0.000609, 'PROJECTION3': 1e-06, 'PROJECTION4': 0.000246, 'RIGHT_DELIM_JOIN5': 0.006166, 'NESTED_LOOP_JOIN6': 0.001742, 'FILTER7': 0.000834, 'HASH_JOIN8': 0.007344, 'SEQ_SCAN 9': 0.002689, 'COLUMN_DATA_SCAN10': 3e-06, 'UNGROUPED_AGGREGATE11': 2e-06, 'PROJECTION12': 0.0, 'STREAMING_LIMIT13': 2e-06, 'UNGROUPED_AGGREGATE14': 0.000108, 'PROJECTION15': 1.4e-05, 'PROJECTION16': 2.2e-05, 'FILTER17': 0.000841, 'HASH_JOIN18': 0.006542, 'SEQ_SCAN 19': 0.004261, 'COLUMN_DATA_SCAN20': 8e-06, 'HASH_JOIN21': 0.014403, 'PROJECTION22': 0.000179, 'HASH_JOIN23': 0.04033, 'SEQ_SCAN 24': 0.001844, 'DELIM_SCAN25': 0.0, 'DUMMY_SCAN26': 0.0, 'HASH_GROUP_BY27': 0.000327}
**** output size:  7
LINEAGE_5_COLUMN_DATA_SCAN_12
LINEAGE_5_COLUMN_DATA_SCAN_8
LINEAGE_5_FILTER_10
LINEAGE_5_FILTER_14
LINEAGE_5_HASH_GROUP_BY_25
LINEAGE_5_HASH_GROUP_BY_6
LINEAGE_5_HASH_JOIN_13
LINEAGE_5_HASH_JOIN_2
LINEAGE_5_HASH_JOIN_5
LINEAGE_5_HASH_JOIN_9
LINEAGE_5_NESTED_LOOP_JOIN_21
LINEAGE_5_ORDER_BY_26
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_11
LINEAGE_5_SEQ_SCAN_7
LINEAGE_5_STREAMING_LIMIT_18
SELECT cntrycode, count(*) AS numcust, sum(c_acctbal) AS totacctbal FROM ( SELECT substring(c_phone FROM 1 FOR 2) AS cntrycode, c_acctbal FROM customer WHERE substring(c_phone FROM 1 FOR 2) IN ('13', '31', '23', '29', '30', '18', '17') AND c_acctbal > ( SELECT avg(c_acctbal) FROM customer WHERE c_acctbal > 0.00 AND substring(c_phone FROM 1 FOR 2) IN ('13', '31', '23', '29', '30', '18', '17')) AND NOT EXISTS ( SELECT * FROM orders WHERE o_custkey = c_custkey)) AS custsale GROUP BY cntrycode ORDER BY cntrycode;
   query_id  ...                                               plan
0         5  ...  {"name": "ORDER_BY", "opid": "26", "children":...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               SELECT cntrycode, count(*) AS numcust, sum(c_a...
size_bytes_max                                                2140811
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "ORDER_BY", "opid": "26", "children":...
Name: 0, dtype: object
{"name": "ORDER_BY", "opid": "26", "children": [{"name": "HASH_GROUP_BY", "opid": "25", "children": [{"name": "PROJECTION", "opid": "24", "children": [{"name": "PROJECTION", "opid": "23", "children": [{"name": "RIGHT_DELIM_JOIN", "opid": "22", "children": [{"name": "HASH_GROUP_BY", "opid": "6", "children": [],"table": "","extra": "#2"},{"name": "HASH_JOIN", "opid": "5", "children": [{"name": "PROJECTION", "opid": "3", "children": [{"name": "HASH_JOIN", "opid": "2", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "orders","extra": "orders\n[INFOSEPARATOR]\no_custkey\n[INFOSEPARATOR]\nEC: 1500000"},{"name": "DELIM_SCAN", "opid": "1", "children": [],"table": "","extra": ""}],"table": "","extra": "INNER\no_custkey = c_custkey\n\n[INFOSEPARATOR]\nEC: 1500000\n"}],"table": "","extra": "c_custkey\n"},{"name": "DUMMY_SCAN", "opid": "4", "children": [],"table": "","extra": ""}],"table": "","extra": "RIGHT_ANTI\nc_custkey IS NOT DISTINCT FROM c_custkey\n\n[INFOSEPARATOR]\nEC: 1500000\n"},{"name": "NESTED_LOOP_JOIN", "opid": "21", "children": [{"name": "FILTER", "opid": "10", "children": [{"name": "HASH_JOIN", "opid": "9", "children": [{"name": "SEQ_SCAN ", "opid": "7", "children": [],"table": "customer","extra": "customer\n[INFOSEPARATOR]\nc_phone\nc_acctbal\nc_custkey\n[INFOSEPARATOR]\nEC: 150000"},{"name": "COLUMN_DATA_SCAN", "opid": "8", "children": [],"table": "","extra": ""}],"table": "","extra": "MARK\nsubstring(c_phone, 1, 2) = #0\n\n[INFOSEPARATOR]\nEC: 150000\n"}],"table": "","extra": "IN (...)\n[INFOSEPARATOR]\nEC: 30000"},{"name": "UNGROUPED_AGGREGATE", "opid": "20", "children": [{"name": "PROJECTION", "opid": "19", "children": [{"name": "STREAMING_LIMIT", "opid": "18", "children": [{"name": "UNGROUPED_AGGREGATE", "opid": "17", "children": [{"name": "PROJECTION", "opid": "16", "children": [{"name": "PROJECTION", "opid": "15", "children": [{"name": "FILTER", "opid": "14", "children": [{"name": "HASH_JOIN", "opid": "13", "children": [{"name": "SEQ_SCAN ", "opid": "11", "children": [],"table": "customer","extra": "customer\n[INFOSEPARATOR]\nc_acctbal\nc_phone\n[INFOSEPARATOR]\nFilters: c_acctbal>0.00 AND c_acctbal IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 30000"},{"name": "COLUMN_DATA_SCAN", "opid": "12", "children": [],"table": "","extra": ""}],"table": "","extra": "MARK\nsubstring(c_phone, 1, 2) = #0\n\n[INFOSEPARATOR]\nEC: 30000\n"}],"table": "","extra": "IN (...)\n[INFOSEPARATOR]\nEC: 6000"}],"table": "","extra": "#0\n#2\n"}],"table": "","extra": "c_acctbal\n"}],"table": "","extra": "avg(#0)"}],"table": "","extra": ""}],"table": "","extra": "#0\n"}],"table": "","extra": "first(#0)"}],"table": "","extra": "INNER\nCAST(c_acctbal AS DOUBLE) > SUBQUERY\n\n[INFOSEPARATOR]\nEC: 0\n"}],"table": "","extra": "RIGHT_ANTI\nc_custkey IS NOT DISTINCT FROM c_custkey\n\n[INFOSEPARATOR]\nEC: 1500000\n"}],"table": "","extra": "cntrycode\nc_acctbal\n"}],"table": "","extra": "cntrycode\nc_acctbal\n"}],"table": "","extra": "#0\ncount_star()\nsum(#1)"}],"table": "","extra": "ORDERS:\ncustsale.cntrycode ASC"}
Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐
│         PROJECTION        │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│__internal_decompress_strin│
│           g(#0)           │
│__internal_decompress_strin│
│           g(#1)           │
│             #2            │
│             #3            │
│             #4            │
│             #5            │
│             #6            │
│             #7            │
│             #8            │
│             #9            │
└─────────────┬─────────────┘                             
┌─────────────┴─────────────┐
│          ORDER_BY         │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│          ORDERS:          │
│ lineitem.l_returnflag ASC │
│ lineitem.l_linestatus ASC │
└─────────────┬─────────────┘                             
┌─────────────┴─────────────┐
│         PROJECTION        │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│__internal_compress_string_│
│        utinyint(#0)       │
│__internal_compress_string_│
│        utinyint(#1)       │
│             #2            │
│             #3            │
│             #4            │
│             #5            │
│             #6            │
│             #7            │
│             #8            │
│             #9            │
└─────────────┬─────────────┘                             
┌─────────────┴─────────────┐
│         PROJECTION        │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│__internal_decompress_strin│
│           g(#0)           │
│__internal_decompress_strin│
│           g(#1)           │
│             #2            │
│             #3            │
│             #4            │
│             #5            │
│             #6            │
│             #7            │
│             #8            │
│             #9            │
└─────────────┬─────────────┘                             
┌─────────────┴─────────────┐
│   PERFECT_HASH_GROUP_BY   │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│             #0            │
│             #1            │
│    sum_no_overflow(#2)    │
│    sum_no_overflow(#3)    │
│    sum_no_overflow(#4)    │
│    sum_no_overflow(#5)    │
│          avg(#6)          │
│          avg(#7)          │
│          avg(#8)          │
│        count_star()       │
└─────────────┬─────────────┘                             
┌─────────────┴─────────────┐
│         PROJECTION        │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│        l_returnflag       │
│        l_linestatus       │
│         l_quantity        │
│      l_extendedprice      │
│             #4            │
│   (#4 * (1.00 + l_tax))   │
│         l_quantity        │
│      l_extendedprice      │
│         l_discount        │
└─────────────┬─────────────┘                             
┌─────────────┴─────────────┐
│         PROJECTION        │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│__internal_compress_string_│
│        utinyint(#0)       │
│__internal_compress_string_│
│        utinyint(#1)       │
│             #2            │
│             #3            │
│             #4            │
│             #5            │
│             #6            │
└─────────────┬─────────────┘                             
┌─────────────┴─────────────┐
│         PROJECTION        │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│        l_returnflag       │
│        l_linestatus       │
│         l_quantity        │
│      l_extendedprice      │
│ (l_extendedprice * (1.00 -│
│        l_discount))       │
│           l_tax           │
│         l_discount        │
└─────────────┬─────────────┘                             
┌─────────────┴─────────────┐
│         SEQ_SCAN          │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│          lineitem         │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│        l_returnflag       │
│        l_linestatus       │
│         l_quantity        │
│      l_extendedprice      │
│         l_discount        │
│           l_tax           │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│ Filters: l_shipdate<='1998│
│-09-02'::DATE AND l_sh...  │
│         IS NOT NULL       │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│        EC: 1200243        │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

compressed filter_log_size: 768
compressed filter_log_buffer_size: 0
compressed limit_offset_size: 768
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 768
compressed perfect_full_scan_ht_log_buffer_size: 0
compressed perfect_probe_ht_log_size: 768
compressed perfect_probe_ht_log_buffer_size: 0
compressed row_group_log_size: 264862
compressed row_group_log_buffer_size: 224597
compressed scatter_log_size: 12728847
compressed scatter_log_buffer_size: 12714717
compressed scatter_sel_log_size: 768
compressed scatter_sel_log_buffer_size: 0
compressed gather_log_size: 768
compressed gather_log_buffer_size: 0
compressed combine_log_size: 1600
compressed combine_log_buffer_size: 256
compressed finalize_states_log_size: 982
compressed finalize_states_log_buffer_size: 70
compressed join_gather_log_size: 768
compressed join_gather_log_buffer_size: 0
compressed reorder_log_size: 1232
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 768
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 768
compressed nlj_log_buffer_size: 0
compressed total_size: 13004435
compressed total_buffer_size: 12939640
compressed total_element_size: 64795

Clear Lineage

%%%%%%%%%%%%%%%% Running Query #  1  threads:  4
SELECT l_returnflag, l_linestatus, sum(l_quantity) AS sum_qty, sum(l_extendedprice) AS sum_base_price, sum(l_extendedprice * (1 - l_discount)) AS sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) AS sum_charge, avg(l_quantity) AS avg_qty, avg(l_extendedprice) AS avg_price, avg(l_discount) AS avg_disc, count(*) AS count_order FROM lineitem WHERE l_shipdate <= CAST('1998-09-02' AS date) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus
Run:  None SELECT l_returnflag, l_linestatus, sum(l_quantity) AS sum_qty, sum(l_extendedprice) AS sum_base_price, sum(l_extendedprice * (1 - l_discount)) AS sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) AS sum_charge, avg(l_quantity) AS avg_qty, avg(l_extendedprice) AS avg_price, avg(l_discount) AS avg_disc, count(*) AS count_order FROM lineitem WHERE l_shipdate <= CAST('1998-09-02' AS date) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus
Avg Time in sec:  0.20032082218676805  output size:  4
  l_returnflag l_linestatus     sum_qty  ...     avg_price  avg_disc  count_order
0            A            F  37734107.0  ...  38273.129735  0.049985      1478493
1            N            F    991417.0  ...  38284.467761  0.050093        38854
2            N            O  74476040.0  ...  38249.117989  0.049997      2920374
3            R            F  37719753.0  ...  38250.854626  0.050009      1478870

[4 rows x 10 columns]
{'name': 'Query', 'result': 0.192298, 'timing': 0.192298, 'cardinality': 0, 'extra-info': "SELECT l_returnflag, l_linestatus, sum(l_quantity) AS sum_qty, sum(l_extendedprice) AS sum_base_price, sum(l_extendedprice * (1 - l_discount)) AS sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) AS sum_charge, avg(l_quantity) AS avg_qty, avg(l_extendedprice) AS avg_price, avg(l_discount) AS avg_disc, count(*) AS count_order FROM lineitem WHERE l_shipdate <= CAST('1998-09-02' AS date) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 1.4e-05, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 7e-06, 'cardinality': 4, 'extra_info': '__internal_decompress_string(#0)\n__internal_decompress_string(#1)\n#2\n#3\n#4\n#5\n#6\n#7\n#8\n#9\n', 'children': [{'name': 'ORDER_BY', 'timing': 6.5e-05, 'cardinality': 4, 'extra_info': 'ORDERS:\nlineitem.l_returnflag ASC\nlineitem.l_linestatus ASC', 'children': [{'name': 'PROJECTION', 'timing': 5e-06, 'cardinality': 4, 'extra_info': '__internal_compress_string_utinyint(#0)\n__internal_compress_string_utinyint(#1)\n#2\n#3\n#4\n#5\n#6\n#7\n#8\n#9\n', 'children': [{'name': 'PROJECTION', 'timing': 6e-06, 'cardinality': 4, 'extra_info': '__internal_decompress_string(#0)\n__internal_decompress_string(#1)\n#2\n#3\n#4\n#5\n#6\n#7\n#8\n#9\n', 'children': [{'name': 'PERFECT_HASH_GROUP_BY', 'timing': 0.212448, 'cardinality': 4, 'extra_info': '#0\n#1\nsum_no_overflow(#2)\nsum_no_overflow(#3)\nsum_no_overflow(#4)\nsum_no_overflow(#5)\navg(#6)\navg(#7)\navg(#8)\ncount_star()', 'children': [{'name': 'PROJECTION', 'timing': 0.056614, 'cardinality': 5916591, 'extra_info': 'l_returnflag\nl_linestatus\nl_quantity\nl_extendedprice\n#4\n(#4 * (1.00 + l_tax))\nl_quantity\nl_extendedprice\nl_discount\n', 'children': [{'name': 'PROJECTION', 'timing': 0.029186, 'cardinality': 5916591, 'extra_info': '__internal_compress_string_utinyint(#0)\n__internal_compress_string_utinyint(#1)\n#2\n#3\n#4\n#5\n#6\n', 'children': [{'name': 'PROJECTION', 'timing': 0.082827, 'cardinality': 5916591, 'extra_info': 'l_returnflag\nl_linestatus\nl_quantity\nl_extendedprice\n(l_extendedprice * (1.00 - l_discount))\nl_tax\nl_discount\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.35221, 'cardinality': 5916591, 'extra_info': "lineitem\n[INFOSEPARATOR]\nl_returnflag\nl_linestatus\nl_quantity\nl_extendedprice\nl_discount\nl_tax\n[INFOSEPARATOR]\nFilters: l_shipdate<='1998-09-02'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243", 'children': []}]}]}]}]}]}]}]}]}]}]}
X {'RESULT_COLLECTOR0': 1.4e-05, 'PROJECTION1': 7e-06, 'ORDER_BY2': 6.5e-05, 'PROJECTION3': 5e-06, 'PROJECTION4': 6e-06, 'PERFECT_HASH_GROUP_BY5': 0.212448, 'PROJECTION6': 0.056614, 'PROJECTION7': 0.029186, 'PROJECTION8': 0.082827, 'SEQ_SCAN 9': 0.35221}
**** output size:  4
LINEAGE_5_ORDER_BY_7
LINEAGE_5_PERFECT_HASH_GROUP_BY_4
LINEAGE_5_SEQ_SCAN_0
SELECT l_returnflag, l_linestatus, sum(l_quantity) AS sum_qty, sum(l_extendedprice) AS sum_base_price, sum(l_extendedprice * (1 - l_discount)) AS sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) AS sum_charge, avg(l_quantity) AS avg_qty, avg(l_extendedprice) AS avg_price, avg(l_discount) AS avg_disc, count(*) AS count_order FROM lineitem WHERE l_shipdate <= CAST('1998-09-02' AS date) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus
   query_id  ...                                               plan
0         5  ...  {"name": "PROJECTION", "opid": "8", "children"...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               SELECT l_returnflag, l_linestatus, sum(l_quant...
size_bytes_max                                               13004435
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "PROJECTION", "opid": "8", "children"...
Name: 0, dtype: object
{"name": "PROJECTION", "opid": "8", "children": [{"name": "ORDER_BY", "opid": "7", "children": [{"name": "PROJECTION", "opid": "6", "children": [{"name": "PROJECTION", "opid": "5", "children": [{"name": "PERFECT_HASH_GROUP_BY", "opid": "4", "children": [{"name": "PROJECTION", "opid": "3", "children": [{"name": "PROJECTION", "opid": "2", "children": [{"name": "PROJECTION", "opid": "1", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_returnflag\nl_linestatus\nl_quantity\nl_extendedprice\nl_discount\nl_tax\n[INFOSEPARATOR]\nFilters: l_shipdate<='1998-09-02'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243"}],"table": "","extra": "l_returnflag\nl_linestatus\nl_quantity\nl_extendedprice\n(l_extendedprice * (1.00 - l_discount))\nl_tax\nl_discount\n"}],"table": "","extra": "__internal_compress_string_utinyint(#0)\n__internal_compress_string_utinyint(#1)\n#2\n#3\n#4\n#5\n#6\n"}],"table": "","extra": "l_returnflag\nl_linestatus\nl_quantity\nl_extendedprice\n#4\n(#4 * (1.00 + l_tax))\nl_quantity\nl_extendedprice\nl_discount\n"}],"table": "","extra": "#0\n#1\nsum_no_overflow(#2)\nsum_no_overflow(#3)\nsum_no_overflow(#4)\nsum_no_overflow(#5)\navg(#6)\navg(#7)\navg(#8)\ncount_star()"}],"table": "","extra": "__internal_decompress_string(#0)\n__internal_decompress_string(#1)\n#2\n#3\n#4\n#5\n#6\n#7\n#8\n#9\n"}],"table": "","extra": "__internal_compress_string_utinyint(#0)\n__internal_compress_string_utinyint(#1)\n#2\n#3\n#4\n#5\n#6\n#7\n#8\n#9\n"}],"table": "","extra": "ORDERS:\nlineitem.l_returnflag ASC\nlineitem.l_linestatus ASC"}],"table": "","extra": "__internal_decompress_string(#0)\n__internal_decompress_string(#1)\n#2\n#3\n#4\n#5\n#6\n#7\n#8\n#9\n"}
%%%%%%%%%%%%%%%% Running Query #  2  threads:  4
SELECT s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment FROM part, supplier, partsupp, nation, region WHERE p_partkey = ps_partkey AND s_suppkey = ps_suppkey AND p_size = 15 AND p_type LIKE '%BRASS' AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'EUROPE' AND ps_supplycost = ( SELECT min(ps_supplycost) FROM partsupp, supplier, nation, region WHERE p_partkey = ps_partkey AND s_suppkey = ps_suppkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'EUROPE' ) ORDER BY s_acctbal DESC, n_name, s_name, p_partkey LIMIT 100;
Run:  None SELECT s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment FROM part, supplier, partsupp, nation, region WHERE p_partkey = ps_partkey AND s_suppkey = ps_suppkey AND p_size = 15 AND p_type LIKE '%BRASS' AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'EUROPE' AND ps_supplycost = ( SELECT min(ps_supplycost) FROM partsupp, supplier, nation, region WHERE p_partkey = ps_partkey AND s_suppkey = ps_suppkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'EUROPE' ) ORDER BY s_acctbal DESC, n_name, s_name, p_partkey LIMIT 100;
Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────┐                                                                                                                                                                                                                  
│       LIMIT       │                                                                                                                                                                                                                  
└─────────┬─────────┘                                                                                                                                                                                                                                       
┌─────────┴─────────┐                                                                                                                                                                                                                  
│     PROJECTION    │                                                                                                                                                                                                                  
│   ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                                  
│         #0        │                                                                                                                                                                                                                  
│         #1        │                                                                                                                                                                                                                  
│__internal_decompre│                                                                                                                                                                                                                  
│   ss_string(#2)   │                                                                                                                                                                                                                  
│__internal_decompre│                                                                                                                                                                                                                  
│ss_integral_bigint(│                                                                                                                                                                                                                  
│       #3, 1)      │                                                                                                                                                                                                                  
│__internal_decompre│                                                                                                                                                                                                                  
│   ss_string(#4)   │                                                                                                                                                                                                                  
│         #5        │                                                                                                                                                                                                                  
│__internal_decompre│                                                                                                                                                                                                                  
│   ss_string(#6)   │                                                                                                                                                                                                                  
│         #7        │                                                                                                                                                                                                                  
└─────────┬─────────┘                                                                                                                                                                                                                                       
┌─────────┴─────────┐                                                                                                                                                                                                                  
│      ORDER_BY     │                                                                                                                                                                                                                  
│   ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                                  
│      ORDERS:      │                                                                                                                                                                                                                  
│ supplier.s_acctbal│                                                                                                                                                                                                                  
│        DESC       │                                                                                                                                                                                                                  
│ nation.n_name ASC │                                                                                                                                                                                                                  
│supplier.s_name ASC│                                                                                                                                                                                                                  
│ part.p_partkey ASC│                                                                                                                                                                                                                  
└─────────┬─────────┘                                                                                                                                                                                                                                       
┌─────────┴─────────┐                                                                                                                                                                                                                  
│     PROJECTION    │                                                                                                                                                                                                                  
│   ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                                  
│         #0        │                                                                                                                                                                                                                  
│         #1        │                                                                                                                                                                                                                  
│__internal_compress│                                                                                                                                                                                                                  
│_string_hugeint(#2)│                                                                                                                                                                                                                  
│__internal_compress│                                                                                                                                                                                                                  
│_integral_uinteger(│                                                                                                                                                                                                                  
│       #3, 1)      │                                                                                                                                                                                                                  
│__internal_compress│                                                                                                                                                                                                                  
│_string_hugeint(#4)│                                                                                                                                                                                                                  
│         #5        │                                                                                                                                                                                                                  
│__internal_compress│                                                                                                                                                                                                                  
│_string_hugeint(#6)│                                                                                                                                                                                                                  
│         #7        │                                                                                                                                                                                                                  
└─────────┬─────────┘                                                                                                                                                                                                                                       
┌─────────┴─────────┐                                                                                                                                                                                                                  
│     PROJECTION    │                                                                                                                                                                                                                  
│   ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                                  
│     s_acctbal     │                                                                                                                                                                                                                  
│       s_name      │                                                                                                                                                                                                                  
│       n_name      │                                                                                                                                                                                                                  
│     p_partkey     │                                                                                                                                                                                                                  
│       p_mfgr      │                                                                                                                                                                                                                  
│     s_address     │                                                                                                                                                                                                                  
│      s_phone      │                                                                                                                                                                                                                  
│     s_comment     │                                                                                                                                                                                                                  
└─────────┬─────────┘                                                                                                                                                                                                                                       
┌─────────┴─────────┐                                                                                                                                                                                                                  
│     PROJECTION    │                                                                                                                                                                                                                  
│   ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                                  
│         #0        │                                                                                                                                                                                                                  
│         #2        │                                                                                                                                                                                                                  
│         #4        │                                                                                                                                                                                                                  
│         #6        │                                                                                                                                                                                                                  
│         #8        │                                                                                                                                                                                                                  
│         #9        │                                                                                                                                                                                                                  
│        #10        │                                                                                                                                                                                                                  
│        #11        │                                                                                                                                                                                                                  
│        #12        │                                                                                                                                                                                                                  
│        #13        │                                                                                                                                                                                                                  
└─────────┬─────────┘                                                                                                                                                                                                                                       
┌─────────┴─────────┐                                                                                                                                                                                                                  
│       FILTER      │                                                                                                                                                                                                                  
│   ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                                  
│  (ps_supplycost = │                                                                                                                                                                                                                  
│      SUBQUERY)    │                                                                                                                                                                                                                  
│   ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                                  
│     EC: 400000    │                                                                                                                                                                                                                  
└─────────┬─────────┘                                                                                                                                                                                                                                       
┌─────────┴─────────┐                                                                                                                                                                                                                  
│  RIGHT_DELIM_JOIN │                                                                                                                                                                                                                  
│   ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                                  
│       RIGHT       │                                                                                                                                                                                                                  
│  p_partkey IS NOT │                                                                                                                                                                                                                  
│    DISTINCT FROM  ├──────────────────────────────────────────────────────────────────────────────────────────────┐                                                                                                                   
│      p_partkey    │                                                                                              │                                                                                                                   
│   ─ ─ ─ ─ ─ ─ ─   │                                                                                              │                                                                                                                   
│     EC: 400000    │                                                                                              │                                                                                                                   
└─────────┬─────────┘                                                                                              │                                                                                                                                        
┌─────────┴─────────┐                                                                                    ┌─────────┴─────────┐                                                                                                         
│     HASH_JOIN     │                                                                                    │     HASH_JOIN     │                                                                                                         
│   ─ ─ ─ ─ ─ ─ ─   │                                                                                    │   ─ ─ ─ ─ ─ ─ ─   │                                                                                                         
│       INNER       │                                                                                    │       RIGHT       │                                                                                                         
│    ps_suppkey =   │                                                                                    │  p_partkey IS NOT │                                                                                                         
│      s_suppkey    │                                                                                    │    DISTINCT FROM  │                                                                                                         
│   ─ ─ ─ ─ ─ ─ ─   ├───────────────────────────────┐                                                    │      p_partkey    ├──────────────────────────────────────────────────────────────────────────────────────────────┐          
│    Build Min: 1   │                               │                                                    │   ─ ─ ─ ─ ─ ─ ─   │                                                                                              │          
│  Build Max: 10000 │                               │                                                    │     EC: 400000    │                                                                                              │          
│   ─ ─ ─ ─ ─ ─ ─   │                               │                                                    │                   │                                                                                              │          
│      EC: 587      │                               │                                                    │                   │                                                                                              │          
└─────────┬─────────┘                               │                                                    └─────────┬─────────┘                                                                                              │                               
┌─────────┴─────────┐                     ┌─────────┴─────────┐                                          ┌─────────┴─────────┐                                                                                    ┌─────────┴─────────┐
│     HASH_JOIN     │                     │     HASH_JOIN     │                                          │     PROJECTION    │                                                                                    │     DUMMY_SCAN    │
│   ─ ─ ─ ─ ─ ─ ─   │                     │   ─ ─ ─ ─ ─ ─ ─   │                                          │   ─ ─ ─ ─ ─ ─ ─   │                                                                                    │                   │
│       INNER       │                     │       INNER       │                                          │ min(ps_supplycost)│                                                                                    │                   │
│    ps_partkey =   │                     │   s_nationkey =   │                                          │     p_partkey     │                                                                                    │                   │
│      p_partkey    │                     │     n_nationkey   │                                          │                   │                                                                                    │                   │
│   ─ ─ ─ ─ ─ ─ ─   ├──────────┐          │   ─ ─ ─ ─ ─ ─ ─   ├──────────┐                               │                   │                                                                                    │                   │
│    Build Min: 1   │          │          │    Build Min: 0   │          │                               │                   │                                                                                    │                   │
│ Build Max: 200000 │          │          │   Build Max: 24   │          │                               │                   │                                                                                    │                   │
│   ─ ─ ─ ─ ─ ─ ─   │          │          │   ─ ─ ─ ─ ─ ─ ─   │          │                               │                   │                                                                                    │                   │
│      EC: 3377     │          │          │      EC: 2000     │          │                               │                   │                                                                                    │                   │
└─────────┬─────────┘          │          └─────────┬─────────┘          │                               └─────────┬─────────┘                                                                                    └───────────────────┘                     
┌─────────┴─────────┐┌─────────┴─────────┐┌─────────┴─────────┐┌─────────┴─────────┐                     ┌─────────┴─────────┐                                                                                                         
│     SEQ_SCAN      ││       FILTER      ││     SEQ_SCAN      ││     HASH_JOIN     │                     │     PROJECTION    │                                                                                                         
│   ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─   │                     │   ─ ─ ─ ─ ─ ─ ─   │                                                                                                         
│      partsupp     ││  suffix(p_type,   ││      supplier     ││       INNER       │                     │__internal_decompre│                                                                                                         
│   ─ ─ ─ ─ ─ ─ ─   ││      'BRASS')     ││   ─ ─ ─ ─ ─ ─ ─   ││   n_regionkey =   │                     │ss_integral_bigint(│                                                                                                         
│     ps_partkey    ││   ─ ─ ─ ─ ─ ─ ─   ││     s_suppkey     ││     r_regionkey   │                     │       #0, 1)      │                                                                                                         
│     ps_suppkey    ││      EC: 800      ││    s_nationkey    ││   ─ ─ ─ ─ ─ ─ ─   │                     │         #1        │                                                                                                         
│   ps_supplycost   ││                   ││     s_acctbal     ││    Build Min: 0   ├──────────┐          │                   │                                                                                                         
│   ─ ─ ─ ─ ─ ─ ─   ││                   ││       s_name      ││    Build Max: 4   │          │          │                   │                                                                                                         
│     EC: 800000    ││                   ││     s_address     ││   ─ ─ ─ ─ ─ ─ ─   │          │          │                   │                                                                                                         
│                   ││                   ││      s_phone      ││       EC: 5       │          │          │                   │                                                                                                         
│                   ││                   ││     s_comment     ││                   │          │          │                   │                                                                                                         
│                   ││                   ││   ─ ─ ─ ─ ─ ─ ─   ││                   │          │          │                   │                                                                                                         
│                   ││                   ││     EC: 10000     ││                   │          │          │                   │                                                                                                         
└───────────────────┘└─────────┬─────────┘└───────────────────┘└─────────┬─────────┘          │          └─────────┬─────────┘                                                                                                                              
                     ┌─────────┴─────────┐                     ┌─────────┴─────────┐┌─────────┴─────────┐┌─────────┴─────────┐                                                                                                         
                     │     SEQ_SCAN      │                     │     SEQ_SCAN      ││     SEQ_SCAN      ││   HASH_GROUP_BY   │                                                                                                         
                     │   ─ ─ ─ ─ ─ ─ ─   │                     │   ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─   │                                                                                                         
                     │        part       │                     │       nation      ││       region      ││         #0        │                                                                                                         
                     │   ─ ─ ─ ─ ─ ─ ─   │                     │   ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─   ││      min(#1)      │                                                                                                         
                     │     p_partkey     │                     │    n_nationkey    ││    r_regionkey    ││                   │                                                                                                         
                     │       p_type      │                     │    n_regionkey    ││   ─ ─ ─ ─ ─ ─ ─   ││                   │                                                                                                         
                     │       p_mfgr      │                     │       n_name      ││  Filters: r_name= ││                   │                                                                                                         
                     │   ─ ─ ─ ─ ─ ─ ─   │                     │   ─ ─ ─ ─ ─ ─ ─   ││'EUROPE' AND r...  ││                   │                                                                                                         
                     │ Filters: p_size=15│                     │       EC: 25      ││      NOT NULL     ││                   │                                                                                                         
                     │  AND p_size IS NOT│                     │                   ││   ─ ─ ─ ─ ─ ─ ─   ││                   │                                                                                                         
                     │        NULL       │                     │                   ││       EC: 1       ││                   │                                                                                                         
                     │   ─ ─ ─ ─ ─ ─ ─   │                     │                   ││                   ││                   │                                                                                                         
                     │      EC: 800      │                     │                   ││                   ││                   │                                                                                                         
                     └───────────────────┘                     └───────────────────┘└───────────────────┘└─────────┬─────────┘                                                                                                                              
                                                                                                         ┌─────────┴─────────┐                                                                                                         
                                                                                                         │     PROJECTION    │                                                                                                         
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   │                                                                                                         
                                                                                                         │     p_partkey     │                                                                                                         
                                                                                                         │   ps_supplycost   │                                                                                                         
                                                                                                         └─────────┬─────────┘                                                                                                                              
                                                                                                         ┌─────────┴─────────┐                                                                                                         
                                                                                                         │     PROJECTION    │                                                                                                         
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   │                                                                                                         
                                                                                                         │__internal_compress│                                                                                                         
                                                                                                         │_integral_uinteger(│                                                                                                         
                                                                                                         │       #0, 1)      │                                                                                                         
                                                                                                         │__internal_compress│                                                                                                         
                                                                                                         │_integral_usmallint│                                                                                                         
                                                                                                         │      (#1, 1)      │                                                                                                         
                                                                                                         │         #2        │                                                                                                         
                                                                                                         │__internal_compress│                                                                                                         
                                                                                                         │_integral_usmallint│                                                                                                         
                                                                                                         │      (#3, 1)      │                                                                                                         
                                                                                                         │__internal_compress│                                                                                                         
                                                                                                         │_integral_utinyint(│                                                                                                         
                                                                                                         │       #4, 0)      │                                                                                                         
                                                                                                         │__internal_compress│                                                                                                         
                                                                                                         │_integral_utinyint(│                                                                                                         
                                                                                                         │       #5, 0)      │                                                                                                         
                                                                                                         │__internal_compress│                                                                                                         
                                                                                                         │_integral_utinyint(│                                                                                                         
                                                                                                         │       #6, 0)      │                                                                                                         
                                                                                                         │__internal_compress│                                                                                                         
                                                                                                         │_integral_utinyint(│                                                                                                         
                                                                                                         │       #7, 0)      │                                                                                                         
                                                                                                         │         #8        │                                                                                                         
                                                                                                         └─────────┬─────────┘                                                                                                                              
                                                                                                         ┌─────────┴─────────┐                                                                                                         
                                                                                                         │     HASH_JOIN     │                                                                                                         
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   │                                                                                                         
                                                                                                         │       INNER       │                                                                                                         
                                                                                                         │    ps_partkey =   ├─────────────────────────────────────────────────────────────────────────┐                               
                                                                                                         │      p_partkey    │                                                                         │                               
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   │                                                                         │                               
                                                                                                         │     EC: 800000    │                                                                         │                               
                                                                                                         └─────────┬─────────┘                                                                         │                                                    
                                                                                                         ┌─────────┴─────────┐                                                               ┌─────────┴─────────┐                     
                                                                                                         │     HASH_JOIN     │                                                               │     DELIM_SCAN    │                     
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   │                                                               │                   │                     
                                                                                                         │       INNER       │                                                               │                   │                     
                                                                                                         │   n_regionkey =   │                                                               │                   │                     
                                                                                                         │     r_regionkey   │                                                               │                   │                     
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   ├────────────────────────────────────────────────────┐          │                   │                     
                                                                                                         │    Build Min: 0   │                                                    │          │                   │                     
                                                                                                         │    Build Max: 4   │                                                    │          │                   │                     
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   │                                                    │          │                   │                     
                                                                                                         │     EC: 800000    │                                                    │          │                   │                     
                                                                                                         └─────────┬─────────┘                                                    │          └───────────────────┘                                          
                                                                                                         ┌─────────┴─────────┐                                          ┌─────────┴─────────┐                                          
                                                                                                         │     HASH_JOIN     │                                          │     SEQ_SCAN      │                                          
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   │                                          │   ─ ─ ─ ─ ─ ─ ─   │                                          
                                                                                                         │       INNER       │                                          │       region      │                                          
                                                                                                         │   s_nationkey =   │                                          │   ─ ─ ─ ─ ─ ─ ─   │                                          
                                                                                                         │     n_nationkey   │                                          │    r_regionkey    │                                          
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   ├───────────────────────────────┐          │   ─ ─ ─ ─ ─ ─ ─   │                                          
                                                                                                         │    Build Min: 0   │                               │          │  Filters: r_name= │                                          
                                                                                                         │   Build Max: 24   │                               │          │'EUROPE' AND r...  │                                          
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   │                               │          │      NOT NULL     │                                          
                                                                                                         │     EC: 800000    │                               │          │   ─ ─ ─ ─ ─ ─ ─   │                                          
                                                                                                         │                   │                               │          │       EC: 1       │                                          
                                                                                                         └─────────┬─────────┘                               │          └───────────────────┘                                                               
                                                                                                         ┌─────────┴─────────┐                     ┌─────────┴─────────┐                                                               
                                                                                                         │     HASH_JOIN     │                     │     SEQ_SCAN      │                                                               
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   │                     │   ─ ─ ─ ─ ─ ─ ─   │                                                               
                                                                                                         │       INNER       │                     │       nation      │                                                               
                                                                                                         │    ps_suppkey =   │                     │   ─ ─ ─ ─ ─ ─ ─   │                                                               
                                                                                                         │      s_suppkey    │                     │    n_nationkey    │                                                               
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   ├──────────┐          │    n_regionkey    │                                                               
                                                                                                         │    Build Min: 1   │          │          │   ─ ─ ─ ─ ─ ─ ─   │                                                               
                                                                                                         │  Build Max: 10000 │          │          │       EC: 25      │                                                               
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   │          │          │                   │                                                               
                                                                                                         │     EC: 800000    │          │          │                   │                                                               
                                                                                                         └─────────┬─────────┘          │          └───────────────────┘                                                                                    
                                                                                                         ┌─────────┴─────────┐┌─────────┴─────────┐                                                                                    
                                                                                                         │     SEQ_SCAN      ││     SEQ_SCAN      │                                                                                    
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─   │                                                                                    
                                                                                                         │      partsupp     ││      supplier     │                                                                                    
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─   │                                                                                    
                                                                                                         │     ps_partkey    ││     s_suppkey     │                                                                                    
                                                                                                         │     ps_suppkey    ││    s_nationkey    │                                                                                    
                                                                                                         │   ps_supplycost   ││   ─ ─ ─ ─ ─ ─ ─   │                                                                                    
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   ││     EC: 10000     │                                                                                    
                                                                                                         │     EC: 800000    ││                   │                                                                                    
                                                                                                         └───────────────────┘└───────────────────┘                                                                                                         

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

Avg Time in sec:  0.05342602776363492  output size:  100
    s_acctbal  ...                                          s_comment
0     9938.53  ...                      l, ironic instructions cajole
1     9937.84  ...  es. furiously silent deposits among the deposi...
2     9936.22  ...  ar, regular requests nag blithely special acco...
3     9923.77  ...  s sleep according to the quick requests. caref...
4     9871.22  ...  against the slyly daring requests. unusual acc...
..        ...  ...                                                ...
95    7887.08  ...   the regular ideas. furiously bold deposits bo...
96    7871.50  ...  ording to the furious theodolites cajole caref...
97    7852.45  ...  egular, regular ideas. requests are carefully....
98    7850.66  ...                   ccounts. special, final deposits
99    7843.52  ...  sits. blithely regular requests above the pend...

[100 rows x 8 columns]
{'name': 'Query', 'result': 0.045052, 'timing': 0.045052, 'cardinality': 0, 'extra-info': "SELECT s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment FROM part, supplier, partsupp, nation, region WHERE p_partkey = ps_partkey AND s_suppkey = ps_suppkey AND p_size = 15 AND p_type LIKE '%BRASS' AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'EUROPE' AND ps_supplycost = ( SELECT min(ps_supplycost) FROM partsupp, supplier, nation, region WHERE p_partkey = ps_partkey AND s_suppkey = ps_suppkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'EUROPE' ) ORDER BY s_acctbal DESC, n_name, s_name, p_partkey LIMIT 100;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 5.3e-05, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'LIMIT', 'timing': 0.000316, 'cardinality': 100, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 8.2e-05, 'cardinality': 460, 'extra_info': '#0\n#1\n__internal_decompress_string(#2)\n__internal_decompress_integral_bigint(#3, 1)\n__internal_decompress_string(#4)\n#5\n__internal_decompress_string(#6)\n#7\n', 'children': [{'name': 'ORDER_BY', 'timing': 0.000703, 'cardinality': 460, 'extra_info': 'ORDERS:\nsupplier.s_acctbal DESC\nnation.n_name ASC\nsupplier.s_name ASC\npart.p_partkey ASC', 'children': [{'name': 'PROJECTION', 'timing': 0.000141, 'cardinality': 460, 'extra_info': '#0\n#1\n__internal_compress_string_hugeint(#2)\n__internal_compress_integral_uinteger(#3, 1)\n__internal_compress_string_hugeint(#4)\n#5\n__internal_compress_string_hugeint(#6)\n#7\n', 'children': [{'name': 'PROJECTION', 'timing': 1e-05, 'cardinality': 460, 'extra_info': 's_acctbal\ns_name\nn_name\np_partkey\np_mfgr\ns_address\ns_phone\ns_comment\n', 'children': [{'name': 'PROJECTION', 'timing': 1.3e-05, 'cardinality': 460, 'extra_info': '#0\n#2\n#4\n#6\n#8\n#9\n#10\n#11\n#12\n#13\n', 'children': [{'name': 'FILTER', 'timing': 0.000396, 'cardinality': 460, 'extra_info': '(ps_supplycost = SUBQUERY)\n[INFOSEPARATOR]\nEC: 400000', 'children': [{'name': 'RIGHT_DELIM_JOIN', 'timing': 0.00649, 'cardinality': 0, 'extra_info': 'RIGHT\np_partkey IS NOT DISTINCT FROM p_partkey\n\n[INFOSEPARATOR]\nEC: 400000\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.002228, 'cardinality': 642, 'extra_info': 'INNER\nps_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 587\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.007292, 'cardinality': 2988, 'extra_info': 'INNER\nps_partkey = p_partkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 3377\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.002141, 'cardinality': 800000, 'extra_info': 'partsupp\n[INFOSEPARATOR]\nps_partkey\nps_suppkey\nps_supplycost\n[INFOSEPARATOR]\nEC: 800000', 'children': []}, {'name': 'FILTER', 'timing': 0.001457, 'cardinality': 747, 'extra_info': "suffix(p_type, 'BRASS')\n[INFOSEPARATOR]\nEC: 800", 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.022821, 'cardinality': 3907, 'extra_info': 'part\n[INFOSEPARATOR]\np_partkey\np_type\np_mfgr\n[INFOSEPARATOR]\nFilters: p_size=15 AND p_size IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 800', 'children': []}]}]}, {'name': 'HASH_JOIN', 'timing': 0.000455, 'cardinality': 1987, 'extra_info': 'INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 2000\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.002754, 'cardinality': 10000, 'extra_info': 'supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\ns_acctbal\ns_name\ns_address\ns_phone\ns_comment\n[INFOSEPARATOR]\nEC: 10000', 'children': []}, {'name': 'HASH_JOIN', 'timing': 8.8e-05, 'cardinality': 5, 'extra_info': 'INNER\nn_regionkey = r_regionkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 4\n\n[INFOSEPARATOR]\nEC: 5\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 4.1e-05, 'cardinality': 25, 'extra_info': 'nation\n[INFOSEPARATOR]\nn_nationkey\nn_regionkey\nn_name\n[INFOSEPARATOR]\nEC: 25', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 4.9e-05, 'cardinality': 1, 'extra_info': "region\n[INFOSEPARATOR]\nr_regionkey\n[INFOSEPARATOR]\nFilters: r_name='EUROPE' AND r_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1", 'children': []}]}]}]}, {'name': 'HASH_JOIN', 'timing': 0.001602, 'cardinality': 642, 'extra_info': 'RIGHT\np_partkey IS NOT DISTINCT FROM p_partkey\n\n[INFOSEPARATOR]\nEC: 400000\n', 'children': [{'name': 'PROJECTION', 'timing': 2e-06, 'cardinality': 460, 'extra_info': 'min(ps_supplycost)\np_partkey\n', 'children': [{'name': 'PROJECTION', 'timing': 1.8e-05, 'cardinality': 460, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n#1\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.004075, 'cardinality': 460, 'extra_info': '#0\nmin(#1)', 'children': [{'name': 'PROJECTION', 'timing': 4e-06, 'cardinality': 642, 'extra_info': 'p_partkey\nps_supplycost\n', 'children': [{'name': 'PROJECTION', 'timing': 8.4e-05, 'cardinality': 642, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n__internal_compress_integral_usmallint(#1, 1)\n#2\n__internal_compress_integral_usmallint(#3, 1)\n__internal_compress_integral_utinyint(#4, 0)\n__internal_compress_integral_utinyint(#5, 0)\n__internal_compress_integral_utinyint(#6, 0)\n__internal_compress_integral_utinyint(#7, 0)\n#8\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.009166, 'cardinality': 642, 'extra_info': 'INNER\nps_partkey = p_partkey\n\n[INFOSEPARATOR]\nEC: 800000\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.008325, 'cardinality': 158960, 'extra_info': 'INNER\nn_regionkey = r_regionkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 4\n\n[INFOSEPARATOR]\nEC: 800000\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.012018, 'cardinality': 800000, 'extra_info': 'INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 800000\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.016864, 'cardinality': 800000, 'extra_info': 'INNER\nps_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 800000\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.00165, 'cardinality': 800000, 'extra_info': 'partsupp\n[INFOSEPARATOR]\nps_partkey\nps_suppkey\nps_supplycost\n[INFOSEPARATOR]\nEC: 800000', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 4.9e-05, 'cardinality': 10000, 'extra_info': 'supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\n[INFOSEPARATOR]\nEC: 10000', 'children': []}]}, {'name': 'SEQ_SCAN ', 'timing': 3.1e-05, 'cardinality': 25, 'extra_info': 'nation\n[INFOSEPARATOR]\nn_nationkey\nn_regionkey\n[INFOSEPARATOR]\nEC: 25', 'children': []}]}, {'name': 'SEQ_SCAN ', 'timing': 4.5e-05, 'cardinality': 1, 'extra_info': "region\n[INFOSEPARATOR]\nr_regionkey\n[INFOSEPARATOR]\nFilters: r_name='EUROPE' AND r_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1", 'children': []}]}, {'name': 'DELIM_SCAN', 'timing': 0.0, 'cardinality': 0, 'extra_info': '', 'children': []}]}]}]}]}]}]}, {'name': 'DUMMY_SCAN', 'timing': 0.0, 'cardinality': 0, 'extra_info': '', 'children': []}]}, {'name': 'HASH_GROUP_BY', 'timing': 0.000668, 'cardinality': 460, 'extra_info': '#0', 'children': []}]}]}]}]}]}]}]}]}]}]}
X {'RESULT_COLLECTOR0': 5.3e-05, 'LIMIT1': 0.000316, 'PROJECTION2': 8.2e-05, 'ORDER_BY3': 0.000703, 'PROJECTION4': 0.000141, 'PROJECTION5': 1e-05, 'PROJECTION6': 1.3e-05, 'FILTER7': 0.000396, 'RIGHT_DELIM_JOIN8': 0.00649, 'HASH_JOIN9': 0.002228, 'HASH_JOIN10': 0.007292, 'SEQ_SCAN 11': 0.002141, 'FILTER12': 0.001457, 'SEQ_SCAN 13': 0.022821, 'HASH_JOIN14': 0.000455, 'SEQ_SCAN 15': 0.002754, 'HASH_JOIN16': 8.8e-05, 'SEQ_SCAN 17': 4.1e-05, 'SEQ_SCAN 18': 4.9e-05, 'HASH_JOIN19': 0.001602, 'PROJECTION20': 2e-06, 'PROJECTION21': 1.8e-05, 'HASH_GROUP_BY22': 0.004075, 'PROJECTION23': 4e-06, 'PROJECTION24': 8.4e-05, 'HASH_JOIN25': 0.009166, 'HASH_JOIN26': 0.008325, 'HASH_JOIN27': 0.012018, 'HASH_JOIN28': 0.016864, 'SEQ_SCAN 29': 0.00165, 'SEQ_SCAN 30': 4.9e-05, 'SEQ_SCAN 31': 3.1e-05, 'SEQ_SCAN 32': 4.5e-05, 'DELIM_SCAN33': 0.0, 'DUMMY_SCAN34': 0.0, 'HASH_GROUP_BY35': 0.000668}
compressed filter_log_size: 8486
compressed filter_log_buffer_size: 3162
compressed limit_offset_size: 2640
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 36437
compressed perfect_full_scan_ht_log_buffer_size: 31253
compressed perfect_probe_ht_log_size: 2120541
compressed perfect_probe_ht_log_buffer_size: 2096403
compressed row_group_log_size: 25962
compressed row_group_log_buffer_size: 12964
compressed scatter_log_size: 8450
compressed scatter_log_buffer_size: 4802
compressed scatter_sel_log_size: 61622
compressed scatter_sel_log_buffer_size: 55247
compressed gather_log_size: 2496
compressed gather_log_buffer_size: 0
compressed combine_log_size: 7395
compressed combine_log_buffer_size: 3682
compressed finalize_states_log_size: 4278
compressed finalize_states_log_buffer_size: 630
compressed join_gather_log_size: 20429
compressed join_gather_log_buffer_size: 11058
compressed reorder_log_size: 4496
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 2496
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 2496
compressed nlj_log_buffer_size: 0
compressed total_size: 2308224
compressed total_buffer_size: 2219201
compressed total_element_size: 89023

Clear Lineage

**** output size:  100
LINEAGE_5_FILTER_19
LINEAGE_5_FILTER_28
LINEAGE_5_HASH_GROUP_BY_11
LINEAGE_5_HASH_GROUP_BY_16
LINEAGE_5_HASH_JOIN_15
LINEAGE_5_HASH_JOIN_2
LINEAGE_5_HASH_JOIN_20
LINEAGE_5_HASH_JOIN_24
LINEAGE_5_HASH_JOIN_25
LINEAGE_5_HASH_JOIN_26
LINEAGE_5_HASH_JOIN_4
LINEAGE_5_HASH_JOIN_6
LINEAGE_5_HASH_JOIN_8
LINEAGE_5_LIMIT_34
LINEAGE_5_ORDER_BY_32
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_1
LINEAGE_5_SEQ_SCAN_17
LINEAGE_5_SEQ_SCAN_18
LINEAGE_5_SEQ_SCAN_21
LINEAGE_5_SEQ_SCAN_22
LINEAGE_5_SEQ_SCAN_23
LINEAGE_5_SEQ_SCAN_3
LINEAGE_5_SEQ_SCAN_5
SELECT s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment FROM part, supplier, partsupp, nation, region WHERE p_partkey = ps_partkey AND s_suppkey = ps_suppkey AND p_size = 15 AND p_type LIKE '%BRASS' AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'EUROPE' AND ps_supplycost = ( SELECT min(ps_supplycost) FROM partsupp, supplier, nation, region WHERE p_partkey = ps_partkey AND s_suppkey = ps_suppkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'EUROPE' ) ORDER BY s_acctbal DESC, n_name, s_name, p_partkey LIMIT 100;
   query_id  ...                                               plan
0         5  ...  {"name": "LIMIT", "opid": "34", "children": [{...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               SELECT s_acctbal, s_name, n_name, p_partkey, p...
size_bytes_max                                                2308224
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "LIMIT", "opid": "34", "children": [{...
Name: 0, dtype: object
{"name": "LIMIT", "opid": "34", "children": [{"name": "PROJECTION", "opid": "33", "children": [{"name": "ORDER_BY", "opid": "32", "children": [{"name": "PROJECTION", "opid": "31", "children": [{"name": "PROJECTION", "opid": "30", "children": [{"name": "PROJECTION", "opid": "29", "children": [{"name": "FILTER", "opid": "28", "children": [{"name": "RIGHT_DELIM_JOIN", "opid": "27", "children": [{"name": "HASH_GROUP_BY", "opid": "16", "children": [],"table": "","extra": "#0"},{"name": "HASH_JOIN", "opid": "15", "children": [{"name": "PROJECTION", "opid": "13", "children": [{"name": "PROJECTION", "opid": "12", "children": [{"name": "HASH_GROUP_BY", "opid": "11", "children": [{"name": "PROJECTION", "opid": "10", "children": [{"name": "PROJECTION", "opid": "9", "children": [{"name": "HASH_JOIN", "opid": "8", "children": [{"name": "HASH_JOIN", "opid": "6", "children": [{"name": "HASH_JOIN", "opid": "4", "children": [{"name": "HASH_JOIN", "opid": "2", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "partsupp","extra": "partsupp\n[INFOSEPARATOR]\nps_partkey\nps_suppkey\nps_supplycost\n[INFOSEPARATOR]\nEC: 800000"},{"name": "SEQ_SCAN ", "opid": "1", "children": [],"table": "supplier","extra": "supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\n[INFOSEPARATOR]\nEC: 10000"}],"table": "","extra": "INNER\nps_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 800000\n"},{"name": "SEQ_SCAN ", "opid": "3", "children": [],"table": "nation","extra": "nation\n[INFOSEPARATOR]\nn_nationkey\nn_regionkey\n[INFOSEPARATOR]\nEC: 25"}],"table": "","extra": "INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 800000\n"},{"name": "SEQ_SCAN ", "opid": "5", "children": [],"table": "region","extra": "region\n[INFOSEPARATOR]\nr_regionkey\n[INFOSEPARATOR]\nFilters: r_name='EUROPE' AND r_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1"}],"table": "","extra": "INNER\nn_regionkey = r_regionkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 4\n\n[INFOSEPARATOR]\nEC: 800000\n"},{"name": "DELIM_SCAN", "opid": "7", "children": [],"table": "","extra": ""}],"table": "","extra": "INNER\nps_partkey = p_partkey\n\n[INFOSEPARATOR]\nEC: 800000\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n__internal_compress_integral_usmallint(#1, 1)\n#2\n__internal_compress_integral_usmallint(#3, 1)\n__internal_compress_integral_utinyint(#4, 0)\n__internal_compress_integral_utinyint(#5, 0)\n__internal_compress_integral_utinyint(#6, 0)\n__internal_compress_integral_utinyint(#7, 0)\n#8\n"}],"table": "","extra": "p_partkey\nps_supplycost\n"}],"table": "","extra": "#0\nmin(#1)"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n#1\n"}],"table": "","extra": "min(ps_supplycost)\np_partkey\n"},{"name": "DUMMY_SCAN", "opid": "14", "children": [],"table": "","extra": ""}],"table": "","extra": "RIGHT\np_partkey IS NOT DISTINCT FROM p_partkey\n\n[INFOSEPARATOR]\nEC: 400000\n"},{"name": "HASH_JOIN", "opid": "26", "children": [{"name": "HASH_JOIN", "opid": "20", "children": [{"name": "SEQ_SCAN ", "opid": "17", "children": [],"table": "partsupp","extra": "partsupp\n[INFOSEPARATOR]\nps_partkey\nps_suppkey\nps_supplycost\n[INFOSEPARATOR]\nEC: 800000"},{"name": "FILTER", "opid": "19", "children": [{"name": "SEQ_SCAN ", "opid": "18", "children": [],"table": "part","extra": "part\n[INFOSEPARATOR]\np_partkey\np_type\np_mfgr\n[INFOSEPARATOR]\nFilters: p_size=15 AND p_size IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 800"}],"table": "","extra": "suffix(p_type, 'BRASS')\n[INFOSEPARATOR]\nEC: 800"}],"table": "","extra": "INNER\nps_partkey = p_partkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 3377\n"},{"name": "HASH_JOIN", "opid": "25", "children": [{"name": "SEQ_SCAN ", "opid": "21", "children": [],"table": "supplier","extra": "supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\ns_acctbal\ns_name\ns_address\ns_phone\ns_comment\n[INFOSEPARATOR]\nEC: 10000"},{"name": "HASH_JOIN", "opid": "24", "children": [{"name": "SEQ_SCAN ", "opid": "22", "children": [],"table": "nation","extra": "nation\n[INFOSEPARATOR]\nn_nationkey\nn_regionkey\nn_name\n[INFOSEPARATOR]\nEC: 25"},{"name": "SEQ_SCAN ", "opid": "23", "children": [],"table": "region","extra": "region\n[INFOSEPARATOR]\nr_regionkey\n[INFOSEPARATOR]\nFilters: r_name='EUROPE' AND r_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1"}],"table": "","extra": "INNER\nn_regionkey = r_regionkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 4\n\n[INFOSEPARATOR]\nEC: 5\n"}],"table": "","extra": "INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 2000\n"}],"table": "","extra": "INNER\nps_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 587\n"}],"table": "","extra": "RIGHT\np_partkey IS NOT DISTINCT FROM p_partkey\n\n[INFOSEPARATOR]\nEC: 400000\n"}],"table": "","extra": "(ps_supplycost = SUBQUERY)\n[INFOSEPARATOR]\nEC: 400000"}],"table": "","extra": "#0\n#2\n#4\n#6\n#8\n#9\n#10\n#11\n#12\n#13\n"}],"table": "","extra": "s_acctbal\ns_name\nn_name\np_partkey\np_mfgr\ns_address\ns_phone\ns_comment\n"}],"table": "","extra": "#0\n#1\n__internal_compress_string_hugeint(#2)\n__internal_compress_integral_uinteger(#3, 1)\n__internal_compress_string_hugeint(#4)\n#5\n__internal_compress_string_hugeint(#6)\n#7\n"}],"table": "","extra": "ORDERS:\nsupplier.s_acctbal DESC\nnation.n_name ASC\nsupplier.s_name ASC\npart.p_partkey ASC"}],"table": "","extra": "#0\n#1\n__internal_decompress_string(#2)\n__internal_decompress_integral_bigint(#3, 1)\n__internal_decompress_string(#4)\n#5\n__internal_decompress_string(#6)\n#7\n"}],"table": "","extra": ""}
%%%%%%%%%%%%%%%% Running Query #  3  threads:  4
SELECT l_orderkey, sum(l_extendedprice * (1 - l_discount)) AS revenue, o_orderdate, o_shippriority FROM customer, orders, lineitem WHERE c_mktsegment = 'BUILDING' AND c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate < CAST('1995-03-15' AS date) AND l_shipdate > CAST('1995-03-15' AS date) GROUP BY l_orderkey, o_orderdate, o_shippriority ORDER BY revenue DESC, o_orderdate LIMIT 10;
Run:  None SELECT l_orderkey, sum(l_extendedprice * (1 - l_discount)) AS revenue, o_orderdate, o_shippriority FROM customer, orders, lineitem WHERE c_mktsegment = 'BUILDING' AND c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate < CAST('1995-03-15' AS date) AND l_shipdate > CAST('1995-03-15' AS date) GROUP BY l_orderkey, o_orderdate, o_shippriority ORDER BY revenue DESC, o_orderdate LIMIT 10;
Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                                                          
│           LIMIT           │                                                          
└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          
│         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│__internal_decompress_integ│                                                          
│     ral_bigint(#0, 1)     │                                                          
│             #1            │                                                          
│             #2            │                                                          
│__internal_decompress_integ│                                                          
│     ral_integer(#3, 0)    │                                                          
└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          
│          ORDER_BY         │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│          ORDERS:          │                                                          
│       sum((lineitem       │                                                          
│.l_extendedprice * (1 ...  │                                                          
│    .l_discount))) DESC    │                                                          
│   orders.o_orderdate ASC  │                                                          
└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          
│         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│__internal_compress_integra│                                                          
│     l_uinteger(#0, 1)     │                                                          
│             #1            │                                                          
│             #2            │                                                          
│__internal_compress_integra│                                                          
│     l_utinyint(#3, 0)     │                                                          
└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          
│         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│         l_orderkey        │                                                          
│          revenue          │                                                          
│        o_orderdate        │                                                          
│       o_shippriority      │                                                          
└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          
│         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│__internal_decompress_integ│                                                          
│     ral_bigint(#0, 1)     │                                                          
│             #1            │                                                          
│__internal_decompress_integ│                                                          
│     ral_integer(#2, 0)    │                                                          
│             #3            │                                                          
└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          
│       HASH_GROUP_BY       │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│             #0            │                                                          
│             #1            │                                                          
│             #2            │                                                          
│          sum(#3)          │                                                          
└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          
│         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│         l_orderkey        │                                                          
│        o_orderdate        │                                                          
│       o_shippriority      │                                                          
│ (l_extendedprice * (1.00 -│                                                          
│        l_discount))       │                                                          
└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          
│         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│__internal_compress_integra│                                                          
│     l_uinteger(#0, 1)     │                                                          
│             #1            │                                                          
│             #2            │                                                          
│__internal_compress_integra│                                                          
│     l_uinteger(#3, 1)     │                                                          
│             #4            │                                                          
│__internal_compress_integra│                                                          
│     l_utinyint(#5, 0)     │                                                          
└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          
│         HASH_JOIN         │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│           INNER           │                                                          
│  l_orderkey = o_orderkey  ├──────────────┐                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                           
│         EC: 28949         │              │                                           
└─────────────┬─────────────┘              │                                                                        
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             
│         SEQ_SCAN          ││         HASH_JOIN         │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│          lineitem         ││           INNER           │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   o_custkey = c_custkey   │                             
│         l_orderkey        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│      l_extendedprice      ││        Build Min: 1       │                             
│         l_discount        ││     Build Max: 149999     ├──────────────┐              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              
│ Filters: l_shipdate>'1995 ││         EC: 36179         │              │              
│-03-15'::DATE AND l_sh...  ││                           │              │              
│         IS NOT NULL       ││                           │              │              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │              │              
│        EC: 1200243        ││                           │              │              
└───────────────────────────┘└─────────────┬─────────────┘              │                                           
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
                             │         SEQ_SCAN          ││           FILTER          │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                             │           orders          ││   (c_custkey <= 149999)   │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                             │         o_custkey         ││         EC: 30000         │
                             │         o_orderkey        ││                           │
                             │        o_orderdate        ││                           │
                             │       o_shippriority      ││                           │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │
                             │ Filters: o_orderdate<'1995││                           │
                             │     -03-15'::DATE AND     ││                           │
                             │   o_orderdate IS NOT NULL ││                           │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │
                             │         EC: 300000        ││                           │
                             └───────────────────────────┘└─────────────┬─────────────┘                             
                                                          ┌─────────────┴─────────────┐
                                                          │         SEQ_SCAN          │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │          customer         │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │         c_custkey         │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │   Filters: c_mktsegment=  │
                                                          │'BUILDING' AND c_mktse...  │
                                                          │          NOT NULL         │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │         EC: 30000         │
                                                          └───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

compressed filter_log_size: 2230
compressed filter_log_buffer_size: 0
compressed limit_offset_size: 1552
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 101050
compressed perfect_full_scan_ht_log_buffer_size: 99258
compressed perfect_probe_ht_log_size: 479339
compressed perfect_probe_ht_log_buffer_size: 466901
compressed row_group_log_size: 1008994
compressed row_group_log_buffer_size: 956586
compressed scatter_log_size: 107713
compressed scatter_log_buffer_size: 105709
compressed scatter_sel_log_size: 804305
compressed scatter_sel_log_buffer_size: 792915
compressed gather_log_size: 1408
compressed gather_log_buffer_size: 0
compressed combine_log_size: 3907
compressed combine_log_buffer_size: 1888
compressed finalize_states_log_size: 3954
compressed finalize_states_log_buffer_size: 1966
compressed join_gather_log_size: 345532
compressed join_gather_log_buffer_size: 285190
compressed reorder_log_size: 22112
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 1408
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 1408
compressed nlj_log_buffer_size: 0
compressed total_size: 2884912
compressed total_buffer_size: 2710413
compressed total_element_size: 174499

Avg Time in sec:  0.08894307492300868  output size:  10
   l_orderkey      revenue o_orderdate  o_shippriority
0     2456423  406181.0111  1995-03-05               0
1     3459808  405838.6989  1995-03-04               0
2      492164  390324.0610  1995-02-19               0
3     1188320  384537.9359  1995-03-09               0
4     2435712  378673.0558  1995-02-26               0
5     4878020  378376.7952  1995-03-12               0
6     5521732  375153.9215  1995-03-13               0
7     2628192  373133.3094  1995-02-22               0
8      993600  371407.4595  1995-03-05               0
9     2300070  367371.1452  1995-03-13               0
{'name': 'Query', 'result': 0.081712, 'timing': 0.081712, 'cardinality': 0, 'extra-info': "SELECT l_orderkey, sum(l_extendedprice * (1 - l_discount)) AS revenue, o_orderdate, o_shippriority FROM customer, orders, lineitem WHERE c_mktsegment = 'BUILDING' AND c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate < CAST('1995-03-15' AS date) AND l_shipdate > CAST('1995-03-15' AS date) GROUP BY l_orderkey, o_orderdate, o_shippriority ORDER BY revenue DESC, o_orderdate LIMIT 10;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 9e-06, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'LIMIT', 'timing': 0.000173, 'cardinality': 10, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 5.8e-05, 'cardinality': 8192, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n#1\n#2\n__internal_decompress_integral_integer(#3, 0)\n', 'children': [{'name': 'ORDER_BY', 'timing': 0.000715, 'cardinality': 8192, 'extra_info': 'ORDERS:\nsum((lineitem.l_extendedprice * (1 - lineitem.l_discount))) DESC\norders.o_orderdate ASC', 'children': [{'name': 'PROJECTION', 'timing': 3.4e-05, 'cardinality': 11620, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n#1\n#2\n__internal_compress_integral_utinyint(#3, 0)\n', 'children': [{'name': 'PROJECTION', 'timing': 6e-06, 'cardinality': 11620, 'extra_info': 'l_orderkey\nrevenue\no_orderdate\no_shippriority\n', 'children': [{'name': 'PROJECTION', 'timing': 5.5e-05, 'cardinality': 11620, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n#1\n__internal_decompress_integral_integer(#2, 0)\n#3\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.007266, 'cardinality': 11620, 'extra_info': '#0\n#1\n#2\nsum(#3)', 'children': [{'name': 'PROJECTION', 'timing': 0.000235, 'cardinality': 30519, 'extra_info': 'l_orderkey\no_orderdate\no_shippriority\n(l_extendedprice * (1.00 - l_discount))\n', 'children': [{'name': 'PROJECTION', 'timing': 0.000264, 'cardinality': 30519, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n#1\n#2\n__internal_compress_integral_uinteger(#3, 1)\n#4\n__internal_compress_integral_utinyint(#5, 0)\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.1229, 'cardinality': 30519, 'extra_info': 'INNER\nl_orderkey = o_orderkey\n\n[INFOSEPARATOR]\nEC: 28949\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.044865, 'cardinality': 3241776, 'extra_info': "lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nFilters: l_shipdate>'1995-03-15'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243", 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.024867, 'cardinality': 147126, 'extra_info': 'INNER\no_custkey = c_custkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 149999\n\n[INFOSEPARATOR]\nEC: 36179\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.027371, 'cardinality': 727305, 'extra_info': "orders\n[INFOSEPARATOR]\no_custkey\no_orderkey\no_orderdate\no_shippriority\n[INFOSEPARATOR]\nFilters: o_orderdate<'1995-03-15'::DATE AND o_orderdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 300000", 'children': []}, {'name': 'FILTER', 'timing': 0.000411, 'cardinality': 30142, 'extra_info': '(c_custkey <= 149999)\n[INFOSEPARATOR]\nEC: 30000', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.005822, 'cardinality': 30142, 'extra_info': "customer\n[INFOSEPARATOR]\nc_custkey\n[INFOSEPARATOR]\nFilters: c_mktsegment='BUILDING' AND c_mktsegment IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 30000", 'children': []}]}]}]}]}]}]}]}]}]}]}]}]}]}]}
X {'RESULT_COLLECTOR0': 9e-06, 'LIMIT1': 0.000173, 'PROJECTION2': 5.8e-05, 'ORDER_BY3': 0.000715, 'PROJECTION4': 3.4e-05, 'PROJECTION5': 6e-06, 'PROJECTION6': 5.5e-05, 'HASH_GROUP_BY7': 0.007266, 'PROJECTION8': 0.000235, 'PROJECTION9': 0.000264, 'HASH_JOIN10': 0.1229, 'SEQ_SCAN 11': 0.044865, 'HASH_JOIN12': 0.024867, 'SEQ_SCAN 13': 0.027371, 'FILTER14': 0.000411, 'SEQ_SCAN 15': 0.005822}
**** output size:  10
LINEAGE_5_FILTER_3
LINEAGE_5_HASH_GROUP_BY_8
LINEAGE_5_HASH_JOIN_4
LINEAGE_5_HASH_JOIN_5
LINEAGE_5_LIMIT_14
LINEAGE_5_ORDER_BY_12
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_1
LINEAGE_5_SEQ_SCAN_2
SELECT l_orderkey, sum(l_extendedprice * (1 - l_discount)) AS revenue, o_orderdate, o_shippriority FROM customer, orders, lineitem WHERE c_mktsegment = 'BUILDING' AND c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate < CAST('1995-03-15' AS date) AND l_shipdate > CAST('1995-03-15' AS date) GROUP BY l_orderkey, o_orderdate, o_shippriority ORDER BY revenue DESC, o_orderdate LIMIT 10;
   query_id  ...                                               plan
0         5  ...  {"name": "LIMIT", "opid": "14", "children": [{...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               SELECT l_orderkey, sum(l_extendedprice * (1 - ...
size_bytes_max                                                2884912
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "LIMIT", "opid": "14", "children": [{...
Name: 0, dtype: object
{"name": "LIMIT", "opid": "14", "children": [{"name": "PROJECTION", "opid": "13", "children": [{"name": "ORDER_BY", "opid": "12", "children": [{"name": "PROJECTION", "opid": "11", "children": [{"name": "PROJECTION", "opid": "10", "children": [{"name": "PROJECTION", "opid": "9", "children": [{"name": "HASH_GROUP_BY", "opid": "8", "children": [{"name": "PROJECTION", "opid": "7", "children": [{"name": "PROJECTION", "opid": "6", "children": [{"name": "HASH_JOIN", "opid": "5", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nFilters: l_shipdate>'1995-03-15'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243"},{"name": "HASH_JOIN", "opid": "4", "children": [{"name": "SEQ_SCAN ", "opid": "1", "children": [],"table": "orders","extra": "orders\n[INFOSEPARATOR]\no_custkey\no_orderkey\no_orderdate\no_shippriority\n[INFOSEPARATOR]\nFilters: o_orderdate<'1995-03-15'::DATE AND o_orderdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 300000"},{"name": "FILTER", "opid": "3", "children": [{"name": "SEQ_SCAN ", "opid": "2", "children": [],"table": "customer","extra": "customer\n[INFOSEPARATOR]\nc_custkey\n[INFOSEPARATOR]\nFilters: c_mktsegment='BUILDING' AND c_mktsegment IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 30000"}],"table": "","extra": "(c_custkey <= 149999)\n[INFOSEPARATOR]\nEC: 30000"}],"table": "","extra": "INNER\no_custkey = c_custkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 149999\n\n[INFOSEPARATOR]\nEC: 36179\n"}],"table": "","extra": "INNER\nl_orderkey = o_orderkey\n\n[INFOSEPARATOR]\nEC: 28949\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n#1\n#2\n__internal_compress_integral_uinteger(#3, 1)\n#4\n__internal_compress_integral_utinyint(#5, 0)\n"}],"table": "","extra": "l_orderkey\no_orderdate\no_shippriority\n(l_extendedprice * (1.00 - l_discount))\n"}],"table": "","extra": "#0\n#1\n#2\nsum(#3)"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n#1\n__internal_decompress_integral_integer(#2, 0)\n#3\n"}],"table": "","extra": "l_orderkey\nrevenue\no_orderdate\no_shippriority\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n#1\n#2\n__internal_compress_integral_utinyint(#3, 0)\n"}],"table": "","extra": "ORDERS:\nsum((lineitem.l_extendedprice * (1 - lineitem.l_discount))) DESC\norders.o_orderdate ASC"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n#1\n#2\n__internal_decompress_integral_integer(#3, 0)\n"}],"table": "","extra": ""}
Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│__internal_decompress_strin│                                                                                       
│           g(#0)           │                                                                                       
│             #1            │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│          ORDER_BY         │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│          ORDERS:          │                                                                                       
│ orders.o_orderpriority ASC│                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│__internal_compress_string_│                                                                                       
│        hugeint(#0)        │                                                                                       
│             #1            │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│__internal_decompress_strin│                                                                                       
│           g(#0)           │                                                                                       
│             #1            │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│       HASH_GROUP_BY       │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│             #0            │                                                                                       
│        count_star()       │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│      o_orderpriority      │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│__internal_compress_integra│                                                                                       
│     l_uinteger(#0, 1)     │                                                                                       
│__internal_compress_string_│                                                                                       
│        hugeint(#1)        │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│      RIGHT_DELIM_JOIN     │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│         RIGHT_SEMI        │                                                                                       
│ o_orderkey IS NOT DISTINCT├──────────────┐                                                                        
│       FROM o_orderkey     │              │                                                                        
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                                                        
│        EC: 1200243        │              │                                                                        
└─────────────┬─────────────┘              │                                                                                                     
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                          
│         SEQ_SCAN          ││         HASH_JOIN         │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│           orders          ││         RIGHT_SEMI        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││ o_orderkey IS NOT DISTINCT│                                                          
│         o_orderkey        ││       FROM o_orderkey     │                                                          
│      o_orderpriority      ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││        EC: 1200243        ├───────────────────────────────────────────┐              
│Filters: o_orderdate>='1993││                           │                                           │              
│     -07-01'::DATE AND     ││                           │                                           │              
│ o_orderdate<'1993-10-...  ││                           │                                           │              
│   o_orderdate IS NOT NULL ││                           │                                           │              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                           │              
│         EC: 300000        ││                           │                                           │              
└───────────────────────────┘└─────────────┬─────────────┘                                           │                                           
                             ┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐
                             │         PROJECTION        │                             │         DUMMY_SCAN        │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │                           │
                             │         o_orderkey        │                             │                           │
                             └─────────────┬─────────────┘                             └───────────────────────────┘                             
                             ┌─────────────┴─────────────┐                                                          
                             │         HASH_JOIN         │                                                          
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                             │           INNER           │                                                          
                             │  l_orderkey = o_orderkey  ├──────────────┐                                           
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                           
                             │        EC: 1200243        │              │                                           
                             └─────────────┬─────────────┘              │                                                                        
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             
                             │           FILTER          ││         DELIM_SCAN        │                             
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                             
                             │      (l_commitdate <      ││                           │                             
                             │       l_receiptdate)      ││                           │                             
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                             
                             │        EC: 6001215        ││                           │                             
                             └─────────────┬─────────────┘└───────────────────────────┘                                                          
                             ┌─────────────┴─────────────┐                                                          
                             │         SEQ_SCAN          │                                                          
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                             │          lineitem         │                                                          
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                             │         l_orderkey        │                                                          
                             │        l_commitdate       │                                                          
                             │       l_receiptdate       │                                                          
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                             │        EC: 6001215        │                                                          
                             └───────────────────────────┘                                                                                       

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

compressed filter_log_size: 784338
compressed filter_log_buffer_size: 750165
compressed limit_offset_size: 1376
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 1376
compressed perfect_full_scan_ht_log_buffer_size: 0
compressed perfect_probe_ht_log_size: 1376
compressed perfect_probe_ht_log_buffer_size: 0
compressed row_group_log_size: 165573
compressed row_group_log_buffer_size: 133120
compressed scatter_log_size: 393874
compressed scatter_log_buffer_size: 388366
compressed scatter_sel_log_size: 543200
compressed scatter_sel_log_buffer_size: 533885
compressed gather_log_size: 1376
compressed gather_log_buffer_size: 0
compressed combine_log_size: 7020
compressed combine_log_buffer_size: 4415
compressed finalize_states_log_size: 23684
compressed finalize_states_log_buffer_size: 21206
compressed join_gather_log_size: 2085445
compressed join_gather_log_buffer_size: 1975847
compressed reorder_log_size: 2304
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 1376
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 1376
compressed nlj_log_buffer_size: 0
compressed total_size: 4013694
compressed total_buffer_size: 3807004
compressed total_element_size: 206690

Clear Lineage

%%%%%%%%%%%%%%%% Running Query #  4  threads:  4
SELECT o_orderpriority, count(*) AS order_count FROM orders WHERE o_orderdate >= CAST('1993-07-01' AS date) AND o_orderdate < CAST('1993-10-01' AS date) AND EXISTS ( SELECT * FROM lineitem WHERE l_orderkey = o_orderkey AND l_commitdate < l_receiptdate) GROUP BY o_orderpriority ORDER BY o_orderpriority;
Run:  None SELECT o_orderpriority, count(*) AS order_count FROM orders WHERE o_orderdate >= CAST('1993-07-01' AS date) AND o_orderdate < CAST('1993-10-01' AS date) AND EXISTS ( SELECT * FROM lineitem WHERE l_orderkey = o_orderkey AND l_commitdate < l_receiptdate) GROUP BY o_orderpriority ORDER BY o_orderpriority;
Avg Time in sec:  0.0923391617834568  output size:  5
   o_orderpriority  order_count
0         1-URGENT        10594
1           2-HIGH        10476
2         3-MEDIUM        10410
3  4-NOT SPECIFIED        10556
4            5-LOW        10487
{'name': 'Query', 'result': 0.084638, 'timing': 0.084638, 'cardinality': 0, 'extra-info': "SELECT o_orderpriority, count(*) AS order_count FROM orders WHERE o_orderdate >= CAST('1993-07-01' AS date) AND o_orderdate < CAST('1993-10-01' AS date) AND EXISTS ( SELECT * FROM lineitem WHERE l_orderkey = o_orderkey AND l_commitdate < l_receiptdate) GROUP BY o_orderpriority ORDER BY o_orderpriority;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 1.4e-05, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 6e-06, 'cardinality': 5, 'extra_info': '__internal_decompress_string(#0)\n#1\n', 'children': [{'name': 'ORDER_BY', 'timing': 9.4e-05, 'cardinality': 5, 'extra_info': 'ORDERS:\norders.o_orderpriority ASC', 'children': [{'name': 'PROJECTION', 'timing': 4e-06, 'cardinality': 5, 'extra_info': '__internal_compress_string_hugeint(#0)\n#1\n', 'children': [{'name': 'PROJECTION', 'timing': 1.7e-05, 'cardinality': 5, 'extra_info': '__internal_decompress_string(#0)\n#1\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.002584, 'cardinality': 5, 'extra_info': '#0\ncount_star()', 'children': [{'name': 'PROJECTION', 'timing': 7e-06, 'cardinality': 52523, 'extra_info': 'o_orderpriority\n', 'children': [{'name': 'PROJECTION', 'timing': 0.000672, 'cardinality': 52523, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n__internal_compress_string_hugeint(#1)\n', 'children': [{'name': 'RIGHT_DELIM_JOIN', 'timing': 0.029674, 'cardinality': 0, 'extra_info': 'RIGHT_SEMI\no_orderkey IS NOT DISTINCT FROM o_orderkey\n\n[INFOSEPARATOR]\nEC: 1200243\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.064578, 'cardinality': 57218, 'extra_info': "orders\n[INFOSEPARATOR]\no_orderkey\no_orderpriority\n[INFOSEPARATOR]\nFilters: o_orderdate>='1993-07-01'::DATE AND o_orderdate<'1993-10-01'::DATE AND o_orderdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 300000", 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.017075, 'cardinality': 52523, 'extra_info': 'RIGHT_SEMI\no_orderkey IS NOT DISTINCT FROM o_orderkey\n\n[INFOSEPARATOR]\nEC: 1200243\n', 'children': [{'name': 'PROJECTION', 'timing': 8.7e-05, 'cardinality': 144869, 'extra_info': 'o_orderkey\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.112959, 'cardinality': 144869, 'extra_info': 'INNER\nl_orderkey = o_orderkey\n\n[INFOSEPARATOR]\nEC: 1200243\n', 'children': [{'name': 'FILTER', 'timing': 0.028876, 'cardinality': 3793296, 'extra_info': '(l_commitdate < l_receiptdate)\n[INFOSEPARATOR]\nEC: 6001215', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.010767, 'cardinality': 6001215, 'extra_info': 'lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_commitdate\nl_receiptdate\n[INFOSEPARATOR]\nEC: 6001215', 'children': []}]}, {'name': 'DELIM_SCAN', 'timing': 0.0, 'cardinality': 0, 'extra_info': '', 'children': []}]}]}, {'name': 'DUMMY_SCAN', 'timing': 0.0, 'cardinality': 0, 'extra_info': '', 'children': []}]}, {'name': 'HASH_GROUP_BY', 'timing': 0.004393, 'cardinality': 57218, 'extra_info': '#0', 'children': []}]}]}]}]}]}]}]}]}]}]}
X {'RESULT_COLLECTOR0': 1.4e-05, 'PROJECTION1': 6e-06, 'ORDER_BY2': 9.4e-05, 'PROJECTION3': 4e-06, 'PROJECTION4': 1.7e-05, 'HASH_GROUP_BY5': 0.002584, 'PROJECTION6': 7e-06, 'PROJECTION7': 0.000672, 'RIGHT_DELIM_JOIN8': 0.029674, 'SEQ_SCAN 9': 0.064578, 'HASH_JOIN10': 0.017075, 'PROJECTION11': 8.7e-05, 'HASH_JOIN12': 0.112959, 'FILTER13': 0.028876, 'SEQ_SCAN 14': 0.010767, 'DELIM_SCAN15': 0.0, 'DUMMY_SCAN16': 0.0, 'HASH_GROUP_BY17': 0.004393}
**** output size:  5
LINEAGE_5_FILTER_1
LINEAGE_5_HASH_GROUP_BY_12
LINEAGE_5_HASH_GROUP_BY_7
LINEAGE_5_HASH_JOIN_3
LINEAGE_5_HASH_JOIN_6
LINEAGE_5_ORDER_BY_15
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_8
SELECT o_orderpriority, count(*) AS order_count FROM orders WHERE o_orderdate >= CAST('1993-07-01' AS date) AND o_orderdate < CAST('1993-10-01' AS date) AND EXISTS ( SELECT * FROM lineitem WHERE l_orderkey = o_orderkey AND l_commitdate < l_receiptdate) GROUP BY o_orderpriority ORDER BY o_orderpriority;
   query_id  ...                                               plan
0         5  ...  {"name": "PROJECTION", "opid": "16", "children...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               SELECT o_orderpriority, count(*) AS order_coun...
size_bytes_max                                                4013694
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "PROJECTION", "opid": "16", "children...
Name: 0, dtype: object
{"name": "PROJECTION", "opid": "16", "children": [{"name": "ORDER_BY", "opid": "15", "children": [{"name": "PROJECTION", "opid": "14", "children": [{"name": "PROJECTION", "opid": "13", "children": [{"name": "HASH_GROUP_BY", "opid": "12", "children": [{"name": "PROJECTION", "opid": "11", "children": [{"name": "PROJECTION", "opid": "10", "children": [{"name": "RIGHT_DELIM_JOIN", "opid": "9", "children": [{"name": "HASH_GROUP_BY", "opid": "7", "children": [],"table": "","extra": "#0"},{"name": "HASH_JOIN", "opid": "6", "children": [{"name": "PROJECTION", "opid": "4", "children": [{"name": "HASH_JOIN", "opid": "3", "children": [{"name": "FILTER", "opid": "1", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_commitdate\nl_receiptdate\n[INFOSEPARATOR]\nEC: 6001215"}],"table": "","extra": "(l_commitdate < l_receiptdate)\n[INFOSEPARATOR]\nEC: 6001215"},{"name": "DELIM_SCAN", "opid": "2", "children": [],"table": "","extra": ""}],"table": "","extra": "INNER\nl_orderkey = o_orderkey\n\n[INFOSEPARATOR]\nEC: 1200243\n"}],"table": "","extra": "o_orderkey\n"},{"name": "DUMMY_SCAN", "opid": "5", "children": [],"table": "","extra": ""}],"table": "","extra": "RIGHT_SEMI\no_orderkey IS NOT DISTINCT FROM o_orderkey\n\n[INFOSEPARATOR]\nEC: 1200243\n"},{"name": "SEQ_SCAN ", "opid": "8", "children": [],"table": "orders","extra": "orders\n[INFOSEPARATOR]\no_orderkey\no_orderpriority\n[INFOSEPARATOR]\nFilters: o_orderdate>='1993-07-01'::DATE AND o_orderdate<'1993-10-01'::DATE AND o_orderdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 300000"}],"table": "","extra": "RIGHT_SEMI\no_orderkey IS NOT DISTINCT FROM o_orderkey\n\n[INFOSEPARATOR]\nEC: 1200243\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n__internal_compress_string_hugeint(#1)\n"}],"table": "","extra": "o_orderpriority\n"}],"table": "","extra": "#0\ncount_star()"}],"table": "","extra": "__internal_decompress_string(#0)\n#1\n"}],"table": "","extra": "__internal_compress_string_hugeint(#0)\n#1\n"}],"table": "","extra": "ORDERS:\norders.o_orderpriority ASC"}],"table": "","extra": "__internal_decompress_string(#0)\n#1\n"}
%%%%%%%%%%%%%%%% Running Query #  5  threads:  4
SELECT n_name, sum(l_extendedprice * (1 - l_discount)) AS revenue FROM customer, orders, lineitem, supplier, nation, region WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND l_suppkey = s_suppkey AND c_nationkey = s_nationkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'ASIA' AND o_orderdate >= CAST('1994-01-01' AS date) AND o_orderdate < CAST('1995-01-01' AS date) GROUP BY n_name ORDER BY revenue DESC;
Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│__internal_decompress_strin│                                                                                                                                                 
│           g(#0)           │                                                                                                                                                 
│             #1            │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│          ORDER_BY         │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│          ORDERS:          │                                                                                                                                                 
│       sum((lineitem       │                                                                                                                                                 
│.l_extendedprice * (1 ...  │                                                                                                                                                 
│    .l_discount))) DESC    │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│__internal_compress_string_│                                                                                                                                                 
│        hugeint(#0)        │                                                                                                                                                 
│             #1            │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│__internal_decompress_strin│                                                                                                                                                 
│           g(#0)           │                                                                                                                                                 
│             #1            │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│       HASH_GROUP_BY       │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│             #0            │                                                                                                                                                 
│          sum(#1)          │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│           n_name          │                                                                                                                                                 
│ (l_extendedprice * (1.00 -│                                                                                                                                                 
│        l_discount))       │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│__internal_compress_integra│                                                                                                                                                 
│     l_uinteger(#0, 1)     │                                                                                                                                                 
│__internal_compress_integra│                                                                                                                                                 
│     l_usmallint(#1, 1)    │                                                                                                                                                 
│             #2            │                                                                                                                                                 
│             #3            │                                                                                                                                                 
│__internal_compress_integra│                                                                                                                                                 
│     l_uinteger(#4, 1)     │                                                                                                                                                 
│__internal_compress_integra│                                                                                                                                                 
│     l_utinyint(#5, 0)     │                                                                                                                                                 
│__internal_compress_string_│                                                                                                                                                 
│        hugeint(#6)        │                                                                                                                                                 
│__internal_compress_integra│                                                                                                                                                 
│     l_usmallint(#7, 1)    │                                                                                                                                                 
│__internal_compress_integra│                                                                                                                                                 
│     l_utinyint(#8, 0)     │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         HASH_JOIN         │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│           INNER           │                                                                                                                                                 
│ n_nationkey = s_nationkey ├──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐              
│   l_suppkey = s_suppkey   │                                                                                                                                  │              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                  │              
│         EC: 143512        │                                                                                                                                  │              
└─────────────┬─────────────┘                                                                                                                                  │                                           
┌─────────────┴─────────────┐                                                                                                                    ┌─────────────┴─────────────┐
│         HASH_JOIN         │                                                                                                                    │         SEQ_SCAN          │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│           INNER           │                                                                                                                    │          supplier         │
│  l_orderkey = o_orderkey  │                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐                                                                                                     │         s_suppkey         │
│         EC: 144747        │              │                                                                                                     │        s_nationkey        │
│                           │              │                                                                                                     │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│                           │              │                                                                                                     │         EC: 10000         │
└─────────────┬─────────────┘              │                                                                                                     └───────────────────────────┘                             
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                                                    
│         SEQ_SCAN          ││         HASH_JOIN         │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│          lineitem         ││           INNER           │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   o_custkey = c_custkey   │                                                                                                                    
│         l_orderkey        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│         l_suppkey         ││        Build Min: 1       ├──────────────┐                                                                                                     
│      l_extendedprice      ││     Build Max: 149999     │              │                                                                                                     
│         l_discount        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                                                                                     
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││         EC: 36179         │              │                                                                                                     
│        EC: 6001215        ││                           │              │                                                                                                     
└───────────────────────────┘└─────────────┬─────────────┘              │                                                                                                                                  
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                       
                             │         SEQ_SCAN          ││         PROJECTION        │                                                                                       
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
                             │           orders          ││             #0            │                                                                                       
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││             #1            │                                                                                       
                             │         o_custkey         ││             #3            │                                                                                       
                             │         o_orderkey        ││                           │                                                                                       
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                                                                       
                             │Filters: o_orderdate>='1994││                           │                                                                                       
                             │     -01-01'::DATE AND     ││                           │                                                                                       
                             │ o_orderdate<'1995-01-...  ││                           │                                                                                       
                             │   o_orderdate IS NOT NULL ││                           │                                                                                       
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                                                                       
                             │         EC: 300000        ││                           │                                                                                       
                             └───────────────────────────┘└─────────────┬─────────────┘                                                                                                                    
                                                          ┌─────────────┴─────────────┐                                                                                       
                                                          │           FILTER          │                                                                                       
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
                                                          │   (c_custkey <= 149999)   │                                                                                       
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
                                                          │         EC: 30000         │                                                                                       
                                                          └─────────────┬─────────────┘                                                                                                                    
                                                          ┌─────────────┴─────────────┐                                                                                       
                                                          │         HASH_JOIN         │                                                                                       
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
                                                          │           INNER           │                                                                                       
                                                          │ c_nationkey = n_nationkey │                                                                                       
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐                                                                        
                                                          │        Build Min: 0       │              │                                                                        
                                                          │       Build Max: 24       │              │                                                                        
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                                                        
                                                          │         EC: 30000         │              │                                                                        
                                                          └─────────────┬─────────────┘              │                                                                                                     
                                                          ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                          
                                                          │         SEQ_SCAN          ││         HASH_JOIN         │                                                          
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                          │          customer         ││           INNER           │                                                          
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││ n_regionkey = r_regionkey │                                                          
                                                          │         c_custkey         ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐                                           
                                                          │        c_nationkey        ││           EC: 25          │              │                                           
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │              │                                           
                                                          │         EC: 150000        ││                           │              │                                           
                                                          └───────────────────────────┘└─────────────┬─────────────┘              │                                                                        
                                                                                       ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             
                                                                                       │         SEQ_SCAN          ││         SEQ_SCAN          │                             
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                                                                                       │           nation          ││           region          │                             
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                                                                                       │        n_nationkey        ││        r_regionkey        │                             
                                                                                       │        n_regionkey        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                                                                                       │           n_name          ││ Filters: r_name='ASIA' AND│                             
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││     r_name IS NOT NULL    │                             
                                                                                       │           EC: 25          ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                                                                                       │                           ││           EC: 1           │                             
                                                                                       └───────────────────────────┘└───────────────────────────┘                                                          

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

compressed filter_log_size: 2312
compressed filter_log_buffer_size: 0
compressed limit_offset_size: 1488
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 106726
compressed perfect_full_scan_ht_log_buffer_size: 104470
compressed perfect_probe_ht_log_size: 230965
compressed perfect_probe_ht_log_buffer_size: 217545
compressed row_group_log_size: 222542
compressed row_group_log_buffer_size: 188793
compressed scatter_log_size: 25816
compressed scatter_log_buffer_size: 23605
compressed scatter_sel_log_size: 393614
compressed scatter_sel_log_buffer_size: 385808
compressed gather_log_size: 1488
compressed gather_log_buffer_size: 0
compressed combine_log_size: 2262
compressed combine_log_buffer_size: 320
compressed finalize_states_log_size: 1960
compressed finalize_states_log_buffer_size: 40
compressed join_gather_log_size: 1203427
compressed join_gather_log_buffer_size: 1093086
compressed reorder_log_size: 2472
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 1488
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 1488
compressed nlj_log_buffer_size: 0
compressed total_size: 2198048
compressed total_buffer_size: 2013667
compressed total_element_size: 184381

Run:  None SELECT n_name, sum(l_extendedprice * (1 - l_discount)) AS revenue FROM customer, orders, lineitem, supplier, nation, region WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND l_suppkey = s_suppkey AND c_nationkey = s_nationkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'ASIA' AND o_orderdate >= CAST('1994-01-01' AS date) AND o_orderdate < CAST('1995-01-01' AS date) GROUP BY n_name ORDER BY revenue DESC;
Avg Time in sec:  0.08592810900881886  output size:  5
      n_name       revenue
0  INDONESIA  5.550204e+07
1    VIETNAM  5.529509e+07
2      CHINA  5.372449e+07
3      INDIA  5.203551e+07
4      JAPAN  4.541018e+07
{'name': 'Query', 'result': 0.080128, 'timing': 0.080128, 'cardinality': 0, 'extra-info': "SELECT n_name, sum(l_extendedprice * (1 - l_discount)) AS revenue FROM customer, orders, lineitem, supplier, nation, region WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND l_suppkey = s_suppkey AND c_nationkey = s_nationkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'ASIA' AND o_orderdate >= CAST('1994-01-01' AS date) AND o_orderdate < CAST('1995-01-01' AS date) GROUP BY n_name ORDER BY revenue DESC;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 1e-05, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 7e-06, 'cardinality': 5, 'extra_info': '__internal_decompress_string(#0)\n#1\n', 'children': [{'name': 'ORDER_BY', 'timing': 8.3e-05, 'cardinality': 5, 'extra_info': 'ORDERS:\nsum((lineitem.l_extendedprice * (1 - lineitem.l_discount))) DESC', 'children': [{'name': 'PROJECTION', 'timing': 3e-06, 'cardinality': 5, 'extra_info': '__internal_compress_string_hugeint(#0)\n#1\n', 'children': [{'name': 'PROJECTION', 'timing': 7e-06, 'cardinality': 5, 'extra_info': '__internal_decompress_string(#0)\n#1\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.003224, 'cardinality': 5, 'extra_info': '#0\nsum(#1)', 'children': [{'name': 'PROJECTION', 'timing': 0.0003, 'cardinality': 7243, 'extra_info': 'n_name\n(l_extendedprice * (1.00 - l_discount))\n', 'children': [{'name': 'PROJECTION', 'timing': 0.000772, 'cardinality': 7243, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n__internal_compress_integral_usmallint(#1, 1)\n#2\n#3\n__internal_compress_integral_uinteger(#4, 1)\n__internal_compress_integral_utinyint(#5, 0)\n__internal_compress_string_hugeint(#6)\n__internal_compress_integral_usmallint(#7, 1)\n__internal_compress_integral_utinyint(#8, 0)\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.018529, 'cardinality': 7243, 'extra_info': 'INNER\nn_nationkey = s_nationkey\nl_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nEC: 143512\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.142556, 'cardinality': 184082, 'extra_info': 'INNER\nl_orderkey = o_orderkey\n\n[INFOSEPARATOR]\nEC: 144747\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.013565, 'cardinality': 6001215, 'extra_info': 'lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_suppkey\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nEC: 6001215', 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.021294, 'cardinality': 46008, 'extra_info': 'INNER\no_custkey = c_custkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 149999\n\n[INFOSEPARATOR]\nEC: 36179\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.026191, 'cardinality': 227597, 'extra_info': "orders\n[INFOSEPARATOR]\no_custkey\no_orderkey\n[INFOSEPARATOR]\nFilters: o_orderdate>='1994-01-01'::DATE AND o_orderdate<'1995-01-01'::DATE AND o_orderdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 300000", 'children': []}, {'name': 'PROJECTION', 'timing': 6.1e-05, 'cardinality': 30183, 'extra_info': '#0\n#1\n#3\n', 'children': [{'name': 'FILTER', 'timing': 0.000794, 'cardinality': 30183, 'extra_info': '(c_custkey <= 149999)\n[INFOSEPARATOR]\nEC: 30000', 'children': [{'name': 'HASH_JOIN', 'timing': 0.003641, 'cardinality': 30183, 'extra_info': 'INNER\nc_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 30000\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.000657, 'cardinality': 150000, 'extra_info': 'customer\n[INFOSEPARATOR]\nc_custkey\nc_nationkey\n[INFOSEPARATOR]\nEC: 150000', 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.00014, 'cardinality': 5, 'extra_info': 'INNER\nn_regionkey = r_regionkey\n\n[INFOSEPARATOR]\nEC: 25\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 3.2e-05, 'cardinality': 25, 'extra_info': 'nation\n[INFOSEPARATOR]\nn_nationkey\nn_regionkey\nn_name\n[INFOSEPARATOR]\nEC: 25', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 7.3e-05, 'cardinality': 1, 'extra_info': "region\n[INFOSEPARATOR]\nr_regionkey\n[INFOSEPARATOR]\nFilters: r_name='ASIA' AND r_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1", 'children': []}]}]}]}]}]}]}, {'name': 'SEQ_SCAN ', 'timing': 6.2e-05, 'cardinality': 10000, 'extra_info': 'supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\n[INFOSEPARATOR]\nEC: 10000', 'children': []}]}]}]}]}]}]}]}]}]}]}
X {'RESULT_COLLECTOR0': 1e-05, 'PROJECTION1': 7e-06, 'ORDER_BY2': 8.3e-05, 'PROJECTION3': 3e-06, 'PROJECTION4': 7e-06, 'HASH_GROUP_BY5': 0.003224, 'PROJECTION6': 0.0003, 'PROJECTION7': 0.000772, 'HASH_JOIN8': 0.018529, 'HASH_JOIN9': 0.142556, 'SEQ_SCAN 10': 0.013565, 'HASH_JOIN11': 0.021294, 'SEQ_SCAN 12': 0.026191, 'PROJECTION13': 6.1e-05, 'FILTER14': 0.000794, 'HASH_JOIN15': 0.003641, 'SEQ_SCAN 16': 0.000657, 'HASH_JOIN17': 0.00014, 'SEQ_SCAN 18': 3.2e-05, 'SEQ_SCAN 19': 7.3e-05, 'SEQ_SCAN 20': 6.2e-05}
**** output size:  5
LINEAGE_5_FILTER_7
LINEAGE_5_HASH_GROUP_BY_15
LINEAGE_5_HASH_JOIN_10
LINEAGE_5_HASH_JOIN_12
LINEAGE_5_HASH_JOIN_5
LINEAGE_5_HASH_JOIN_6
LINEAGE_5_HASH_JOIN_9
LINEAGE_5_ORDER_BY_18
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_1
LINEAGE_5_SEQ_SCAN_11
LINEAGE_5_SEQ_SCAN_2
LINEAGE_5_SEQ_SCAN_3
LINEAGE_5_SEQ_SCAN_4
SELECT n_name, sum(l_extendedprice * (1 - l_discount)) AS revenue FROM customer, orders, lineitem, supplier, nation, region WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND l_suppkey = s_suppkey AND c_nationkey = s_nationkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'ASIA' AND o_orderdate >= CAST('1994-01-01' AS date) AND o_orderdate < CAST('1995-01-01' AS date) GROUP BY n_name ORDER BY revenue DESC;
   query_id  ...                                               plan
0         5  ...  {"name": "PROJECTION", "opid": "19", "children...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               SELECT n_name, sum(l_extendedprice * (1 - l_di...
size_bytes_max                                                2198048
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "PROJECTION", "opid": "19", "children...
Name: 0, dtype: object
{"name": "PROJECTION", "opid": "19", "children": [{"name": "ORDER_BY", "opid": "18", "children": [{"name": "PROJECTION", "opid": "17", "children": [{"name": "PROJECTION", "opid": "16", "children": [{"name": "HASH_GROUP_BY", "opid": "15", "children": [{"name": "PROJECTION", "opid": "14", "children": [{"name": "PROJECTION", "opid": "13", "children": [{"name": "HASH_JOIN", "opid": "12", "children": [{"name": "HASH_JOIN", "opid": "10", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_suppkey\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nEC: 6001215"},{"name": "HASH_JOIN", "opid": "9", "children": [{"name": "SEQ_SCAN ", "opid": "1", "children": [],"table": "orders","extra": "orders\n[INFOSEPARATOR]\no_custkey\no_orderkey\n[INFOSEPARATOR]\nFilters: o_orderdate>='1994-01-01'::DATE AND o_orderdate<'1995-01-01'::DATE AND o_orderdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 300000"},{"name": "PROJECTION", "opid": "8", "children": [{"name": "FILTER", "opid": "7", "children": [{"name": "HASH_JOIN", "opid": "6", "children": [{"name": "SEQ_SCAN ", "opid": "2", "children": [],"table": "customer","extra": "customer\n[INFOSEPARATOR]\nc_custkey\nc_nationkey\n[INFOSEPARATOR]\nEC: 150000"},{"name": "HASH_JOIN", "opid": "5", "children": [{"name": "SEQ_SCAN ", "opid": "3", "children": [],"table": "nation","extra": "nation\n[INFOSEPARATOR]\nn_nationkey\nn_regionkey\nn_name\n[INFOSEPARATOR]\nEC: 25"},{"name": "SEQ_SCAN ", "opid": "4", "children": [],"table": "region","extra": "region\n[INFOSEPARATOR]\nr_regionkey\n[INFOSEPARATOR]\nFilters: r_name='ASIA' AND r_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1"}],"table": "","extra": "INNER\nn_regionkey = r_regionkey\n\n[INFOSEPARATOR]\nEC: 25\n"}],"table": "","extra": "INNER\nc_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 30000\n"}],"table": "","extra": "(c_custkey <= 149999)\n[INFOSEPARATOR]\nEC: 30000"}],"table": "","extra": "#0\n#1\n#3\n"}],"table": "","extra": "INNER\no_custkey = c_custkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 149999\n\n[INFOSEPARATOR]\nEC: 36179\n"}],"table": "","extra": "INNER\nl_orderkey = o_orderkey\n\n[INFOSEPARATOR]\nEC: 144747\n"},{"name": "SEQ_SCAN ", "opid": "11", "children": [],"table": "supplier","extra": "supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\n[INFOSEPARATOR]\nEC: 10000"}],"table": "","extra": "INNER\nn_nationkey = s_nationkey\nl_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nEC: 143512\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n__internal_compress_integral_usmallint(#1, 1)\n#2\n#3\n__internal_compress_integral_uinteger(#4, 1)\n__internal_compress_integral_utinyint(#5, 0)\n__internal_compress_string_hugeint(#6)\n__internal_compress_integral_usmallint(#7, 1)\n__internal_compress_integral_utinyint(#8, 0)\n"}],"table": "","extra": "n_name\n(l_extendedprice * (1.00 - l_discount))\n"}],"table": "","extra": "#0\nsum(#1)"}],"table": "","extra": "__internal_decompress_string(#0)\n#1\n"}],"table": "","extra": "__internal_compress_string_hugeint(#0)\n#1\n"}],"table": "","extra": "ORDERS:\nsum((lineitem.l_extendedprice * (1 - lineitem.l_discount))) DESC"}],"table": "","extra": "__internal_decompress_string(#0)\n#1\n"}
Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐
│    UNGROUPED_AGGREGATE    │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│    sum_no_overflow(#0)    │
└─────────────┬─────────────┘                             
┌─────────────┴─────────────┐
│         PROJECTION        │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│     (l_extendedprice *    │
│         l_discount)       │
└─────────────┬─────────────┘                             
┌─────────────┴─────────────┐
│         SEQ_SCAN          │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│          lineitem         │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│         l_discount        │
│      l_extendedprice      │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│ Filters: l_shipdate>='1994│
│-01-01'::DATE AND l_sh...  │
│  <'1995-01-01'::DATE AND  │
│   l_shipdate IS NOT NULL  │
│    l_discount>=0.05 AND   │
│ l_discount<=0.07 AND ...  │
│         IS NOT NULL       │
│    l_quantity<24.00 AND   │
│   l_quantity IS NOT NULL  │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│        EC: 1200243        │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

compressed filter_log_size: 432
compressed filter_log_buffer_size: 0
compressed limit_offset_size: 432
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 432
compressed perfect_full_scan_ht_log_buffer_size: 0
compressed perfect_probe_ht_log_size: 432
compressed perfect_probe_ht_log_buffer_size: 0
compressed row_group_log_size: 402442
compressed row_group_log_buffer_size: 357694
compressed scatter_log_size: 432
compressed scatter_log_buffer_size: 0
compressed scatter_sel_log_size: 432
compressed scatter_sel_log_buffer_size: 0
compressed gather_log_size: 432
compressed gather_log_buffer_size: 0
compressed combine_log_size: 432
compressed combine_log_buffer_size: 0
compressed finalize_states_log_size: 432
compressed finalize_states_log_buffer_size: 0
compressed join_gather_log_size: 432
compressed join_gather_log_buffer_size: 0
compressed reorder_log_size: 648
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 432
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 432
compressed nlj_log_buffer_size: 0
compressed total_size: 408274
compressed total_buffer_size: 357694
compressed total_element_size: 50580

Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│__internal_decompress_strin│                                                                                                                                                 
│           g(#0)           │                                                                                                                                                 
│__internal_decompress_strin│                                                                                                                                                 
│           g(#1)           │                                                                                                                                                 
│__internal_decompress_integ│                                                                                                                                                 
│    ral_bigint(#2, 1992)   │                                                                                                                                                 
│             #3            │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│          ORDER_BY         │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│          ORDERS:          │                                                                                                                                                 
│  shipping.supp_nation ASC │                                                                                                                                                 
│  shipping.cust_nation ASC │                                                                                                                                                 
│    shipping.l_year ASC    │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│__internal_compress_string_│                                                                                                                                                 
│        hugeint(#0)        │                                                                                                                                                 
│__internal_compress_string_│                                                                                                                                                 
│        hugeint(#1)        │                                                                                                                                                 
│__internal_compress_integra│                                                                                                                                                 
│    l_utinyint(#2, 1992)   │                                                                                                                                                 
│             #3            │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│__internal_decompress_strin│                                                                                                                                                 
│           g(#0)           │                                                                                                                                                 
│__internal_decompress_strin│                                                                                                                                                 
│           g(#1)           │                                                                                                                                                 
│__internal_decompress_integ│                                                                                                                                                 
│    ral_bigint(#2, 1992)   │                                                                                                                                                 
│             #3            │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│       HASH_GROUP_BY       │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│             #0            │                                                                                                                                                 
│             #1            │                                                                                                                                                 
│             #2            │                                                                                                                                                 
│          sum(#3)          │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│        supp_nation        │                                                                                                                                                 
│        cust_nation        │                                                                                                                                                 
│           l_year          │                                                                                                                                                 
│           volume          │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│__internal_compress_string_│                                                                                                                                                 
│        hugeint(#0)        │                                                                                                                                                 
│__internal_compress_string_│                                                                                                                                                 
│        hugeint(#1)        │                                                                                                                                                 
│__internal_compress_integra│                                                                                                                                                 
│    l_utinyint(#2, 1992)   │                                                                                                                                                 
│             #3            │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│        supp_nation        │                                                                                                                                                 
│        cust_nation        │                                                                                                                                                 
│      year(l_shipdate)     │                                                                                                                                                 
│           volume          │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│             #2            │                                                                                                                                                 
│             #3            │                                                                                                                                                 
│             #4            │                                                                                                                                                 
│             #6            │                                                                                                                                                 
│             #8            │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│           FILTER          │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│ (((n_name = 'FRANCE') AND │                                                                                                                                                 
│ (n_name = 'GERMANY')) OR (│                                                                                                                                                 
│ (n_name = 'GERMANY') AND  │                                                                                                                                                 
│   (n_name = 'FRANCE')))   │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│         EC: 717564        │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         HASH_JOIN         │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│           INNER           │                                                                                                                                                 
│   l_suppkey = s_suppkey   │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├─────────────────────────────────────────────────────────────────────────────────────────────────────┐                                           
│        Build Min: 1       │                                                                                                     │                                           
│      Build Max: 10000     │                                                                                                     │                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                     │                                           
│         EC: 717564        │                                                                                                     │                                           
└─────────────┬─────────────┘                                                                                                     │                                                                        
┌─────────────┴─────────────┐                                                                                       ┌─────────────┴─────────────┐                             
│         HASH_JOIN         │                                                                                       │         HASH_JOIN         │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│           INNER           │                                                                                       │           INNER           │                             
│  l_orderkey = o_orderkey  │                                                                                       │ s_nationkey = n_nationkey │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐                                                                        │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐              
│         EC: 723735        │              │                                                                        │        Build Min: 0       │              │              
│                           │              │                                                                        │       Build Max: 24       │              │              
│                           │              │                                                                        │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              
│                           │              │                                                                        │         EC: 10000         │              │              
└─────────────┬─────────────┘              │                                                                        └─────────────┬─────────────┘              │                                           
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
│         SEQ_SCAN          ││         HASH_JOIN         │                                                          │         SEQ_SCAN          ││         SEQ_SCAN          │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│          lineitem         ││           INNER           │                                                          │          supplier         ││           nation          │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   o_custkey = c_custkey   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│         l_suppkey         ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │         s_suppkey         ││        n_nationkey        │
│         l_orderkey        ││        Build Min: 1       │                                                          │        s_nationkey        ││           n_name          │
│         l_shipdate        ││     Build Max: 149999     │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│      l_extendedprice      ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │         EC: 10000         ││           EC: 25          │
│         l_discount        ││         EC: 904486        ├──────────────┐                                           │                           ││                           │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │              │                                           │                           ││                           │
│ Filters: l_shipdate>='1995││                           │              │                                           │                           ││                           │
│-01-01'::DATE AND l_sh...  ││                           │              │                                           │                           ││                           │
│  <='1996-12-31'::DATE AND ││                           │              │                                           │                           ││                           │
│   l_shipdate IS NOT NULL  ││                           │              │                                           │                           ││                           │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │              │                                           │                           ││                           │
│        EC: 1200243        ││                           │              │                                           │                           ││                           │
└───────────────────────────┘└─────────────┬─────────────┘              │                                           └───────────────────────────┘└───────────────────────────┘                             
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                       
                             │         SEQ_SCAN          ││         HASH_JOIN         │                                                                                       
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
                             │           orders          ││           INNER           │                                                                                       
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││ c_nationkey = n_nationkey │                                                                                       
                             │         o_orderkey        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐                                                                        
                             │         o_custkey         ││         EC: 150000        │              │                                                                        
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │              │                                                                        
                             │        EC: 1500000        ││                           │              │                                                                        
                             └───────────────────────────┘└─────────────┬─────────────┘              │                                                                                                     
                                                          ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                          
                                                          │         SEQ_SCAN          ││         SEQ_SCAN          │                                                          
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                          │          customer         ││           nation          │                                                          
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                          │         c_custkey         ││        n_nationkey        │                                                          
                                                          │        c_nationkey        ││           n_name          │                                                          
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                          │ Filters: c_custkey<=149999││           EC: 25          │                                                          
                                                          │  AND c_custkey IS NOT NULL││                           │                                                          
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                                          
                                                          │         EC: 150000        ││                           │                                                          
                                                          └───────────────────────────┘└───────────────────────────┘                                                                                       

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

%%%%%%%%%%%%%%%% Running Query #  6  threads:  4
SELECT sum(l_extendedprice * l_discount) AS revenue FROM lineitem WHERE l_shipdate >= CAST('1994-01-01' AS date) AND l_shipdate < CAST('1995-01-01' AS date) AND l_discount BETWEEN 0.05 AND 0.07 AND l_quantity < 24;
Run:  None SELECT sum(l_extendedprice * l_discount) AS revenue FROM lineitem WHERE l_shipdate >= CAST('1994-01-01' AS date) AND l_shipdate < CAST('1995-01-01' AS date) AND l_discount BETWEEN 0.05 AND 0.07 AND l_quantity < 24;
Avg Time in sec:  0.02798994304612279  output size:  1
        revenue
0  1.231411e+08
{'name': 'Query', 'result': 0.026513, 'timing': 0.026513, 'cardinality': 0, 'extra-info': "SELECT sum(l_extendedprice * l_discount) AS revenue FROM lineitem WHERE l_shipdate >= CAST('1994-01-01' AS date) AND l_shipdate < CAST('1995-01-01' AS date) AND l_discount BETWEEN 0.05 AND 0.07 AND l_quantity < 24;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 7e-06, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'UNGROUPED_AGGREGATE', 'timing': 0.001107, 'cardinality': 1, 'extra_info': 'sum_no_overflow(#0)', 'children': [{'name': 'PROJECTION', 'timing': 0.005917, 'cardinality': 114160, 'extra_info': '(l_extendedprice * l_discount)\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.090298, 'cardinality': 114160, 'extra_info': "lineitem\n[INFOSEPARATOR]\nl_discount\nl_extendedprice\n[INFOSEPARATOR]\nFilters: l_shipdate>='1994-01-01'::DATE AND l_shipdate<'1995-01-01'::DATE AND l_shipdate IS NOT NULL\nl_discount>=0.05 AND l_discount<=0.07 AND l_discount IS NOT NULL\nl_quantity<24.00 AND l_quantity IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243", 'children': []}]}]}]}]}
X {'RESULT_COLLECTOR0': 7e-06, 'UNGROUPED_AGGREGATE1': 0.001107, 'PROJECTION2': 0.005917, 'SEQ_SCAN 3': 0.090298}
**** output size:  1
LINEAGE_5_SEQ_SCAN_0
SELECT sum(l_extendedprice * l_discount) AS revenue FROM lineitem WHERE l_shipdate >= CAST('1994-01-01' AS date) AND l_shipdate < CAST('1995-01-01' AS date) AND l_discount BETWEEN 0.05 AND 0.07 AND l_quantity < 24;
   query_id  ...                                               plan
0         5  ...  {"name": "UNGROUPED_AGGREGATE", "opid": "2", "...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               SELECT sum(l_extendedprice * l_discount) AS re...
size_bytes_max                                                 408274
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "UNGROUPED_AGGREGATE", "opid": "2", "...
Name: 0, dtype: object
{"name": "UNGROUPED_AGGREGATE", "opid": "2", "children": [{"name": "PROJECTION", "opid": "1", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_discount\nl_extendedprice\n[INFOSEPARATOR]\nFilters: l_shipdate>='1994-01-01'::DATE AND l_shipdate<'1995-01-01'::DATE AND l_shipdate IS NOT NULL\nl_discount>=0.05 AND l_discount<=0.07 AND l_discount IS NOT NULL\nl_quantity<24.00 AND l_quantity IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243"}],"table": "","extra": "(l_extendedprice * l_discount)\n"}],"table": "","extra": "sum_no_overflow(#0)"}
%%%%%%%%%%%%%%%% Running Query #  7  threads:  4
SELECT supp_nation, cust_nation, l_year, sum(volume) AS revenue FROM ( SELECT n1.n_name AS supp_nation, n2.n_name AS cust_nation, extract(year FROM l_shipdate) AS l_year, l_extendedprice * (1 - l_discount) AS volume FROM supplier, lineitem, orders, customer, nation n1, nation n2 WHERE s_suppkey = l_suppkey AND o_orderkey = l_orderkey AND c_custkey = o_custkey AND s_nationkey = n1.n_nationkey AND c_nationkey = n2.n_nationkey AND ((n1.n_name = 'FRANCE' AND n2.n_name = 'GERMANY') OR (n1.n_name = 'GERMANY' AND n2.n_name = 'FRANCE')) AND l_shipdate BETWEEN CAST('1995-01-01' AS date) AND CAST('1996-12-31' AS date)) AS shipping GROUP BY supp_nation, cust_nation, l_year ORDER BY supp_nation, cust_nation, l_year;
Run:  None SELECT supp_nation, cust_nation, l_year, sum(volume) AS revenue FROM ( SELECT n1.n_name AS supp_nation, n2.n_name AS cust_nation, extract(year FROM l_shipdate) AS l_year, l_extendedprice * (1 - l_discount) AS volume FROM supplier, lineitem, orders, customer, nation n1, nation n2 WHERE s_suppkey = l_suppkey AND o_orderkey = l_orderkey AND c_custkey = o_custkey AND s_nationkey = n1.n_nationkey AND c_nationkey = n2.n_nationkey AND ((n1.n_name = 'FRANCE' AND n2.n_name = 'GERMANY') OR (n1.n_name = 'GERMANY' AND n2.n_name = 'FRANCE')) AND l_shipdate BETWEEN CAST('1995-01-01' AS date) AND CAST('1996-12-31' AS date)) AS shipping GROUP BY supp_nation, cust_nation, l_year ORDER BY supp_nation, cust_nation, l_year;
Avg Time in sec:  0.2526635890826583  output size:  4
  supp_nation cust_nation  l_year       revenue
0      FRANCE     GERMANY    1995  5.463973e+07
1      FRANCE     GERMANY    1996  5.463308e+07
2     GERMANY      FRANCE    1995  5.253175e+07
3     GERMANY      FRANCE    1996  5.252055e+07
{'name': 'Query', 'result': 0.230625, 'timing': 0.230625, 'cardinality': 0, 'extra-info': "SELECT supp_nation, cust_nation, l_year, sum(volume) AS revenue FROM ( SELECT n1.n_name AS supp_nation, n2.n_name AS cust_nation, extract(year FROM l_shipdate) AS l_year, l_extendedprice * (1 - l_discount) AS volume FROM supplier, lineitem, orders, customer, nation n1, nation n2 WHERE s_suppkey = l_suppkey AND o_orderkey = l_orderkey AND c_custkey = o_custkey AND s_nationkey = n1.n_nationkey AND c_nationkey = n2.n_nationkey AND ((n1.n_name = 'FRANCE' AND n2.n_name = 'GERMANY') OR (n1.n_name = 'GERMANY' AND n2.n_name = 'FRANCE')) AND l_shipdate BETWEEN CAST('1995-01-01' AS date) AND CAST('1996-12-31' AS date)) AS shipping GROUP BY supp_nation, cust_nation, l_year ORDER BY supp_nation, cust_nation, l_year;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 1.3e-05, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 1.4e-05, 'cardinality': 4, 'extra_info': '__internal_decompress_string(#0)\n__internal_decompress_string(#1)\n__internal_decompress_integral_bigint(#2, 1992)\n#3\n', 'children': [{'name': 'ORDER_BY', 'timing': 8.6e-05, 'cardinality': 4, 'extra_info': 'ORDERS:\nshipping.supp_nation ASC\nshipping.cust_nation ASC\nshipping.l_year ASC', 'children': [{'name': 'PROJECTION', 'timing': 8e-06, 'cardinality': 4, 'extra_info': '__internal_compress_string_hugeint(#0)\n__internal_compress_string_hugeint(#1)\n__internal_compress_integral_utinyint(#2, 1992)\n#3\n', 'children': [{'name': 'PROJECTION', 'timing': 1.6e-05, 'cardinality': 4, 'extra_info': '__internal_decompress_string(#0)\n__internal_decompress_string(#1)\n__internal_decompress_integral_bigint(#2, 1992)\n#3\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.004116, 'cardinality': 4, 'extra_info': '#0\n#1\n#2\nsum(#3)', 'children': [{'name': 'PROJECTION', 'timing': 5e-06, 'cardinality': 5924, 'extra_info': 'supp_nation\ncust_nation\nl_year\nvolume\n', 'children': [{'name': 'PROJECTION', 'timing': 0.000155, 'cardinality': 5924, 'extra_info': '__internal_compress_string_hugeint(#0)\n__internal_compress_string_hugeint(#1)\n__internal_compress_integral_utinyint(#2, 1992)\n#3\n', 'children': [{'name': 'PROJECTION', 'timing': 0.000167, 'cardinality': 5924, 'extra_info': 'supp_nation\ncust_nation\nyear(l_shipdate)\nvolume\n', 'children': [{'name': 'PROJECTION', 'timing': 9e-06, 'cardinality': 5924, 'extra_info': '#2\n#3\n#4\n#6\n#8\n', 'children': [{'name': 'FILTER', 'timing': 0.070991, 'cardinality': 5924, 'extra_info': "(((n_name = 'FRANCE') AND (n_name = 'GERMANY')) OR ((n_name = 'GERMANY') AND (n_name = 'FRANCE')))\n[INFOSEPARATOR]\nEC: 717564", 'children': [{'name': 'HASH_JOIN', 'timing': 0.059688, 'cardinality': 1828450, 'extra_info': 'INNER\nl_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 717564\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.353966, 'cardinality': 1828450, 'extra_info': 'INNER\nl_orderkey = o_orderkey\n\n[INFOSEPARATOR]\nEC: 723735\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.055124, 'cardinality': 1828450, 'extra_info': "lineitem\n[INFOSEPARATOR]\nl_suppkey\nl_orderkey\nl_shipdate\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nFilters: l_shipdate>='1995-01-01'::DATE AND l_shipdate<='1996-12-31'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243", 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.048624, 'cardinality': 1500000, 'extra_info': 'INNER\no_custkey = c_custkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 149999\n\n[INFOSEPARATOR]\nEC: 904486\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.003484, 'cardinality': 1500000, 'extra_info': 'orders\n[INFOSEPARATOR]\no_orderkey\no_custkey\n[INFOSEPARATOR]\nEC: 1500000', 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.008409, 'cardinality': 149999, 'extra_info': 'INNER\nc_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nEC: 150000\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.001726, 'cardinality': 149999, 'extra_info': 'customer\n[INFOSEPARATOR]\nc_custkey\nc_nationkey\n[INFOSEPARATOR]\nFilters: c_custkey<=149999 AND c_custkey IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 150000', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 3.7e-05, 'cardinality': 25, 'extra_info': 'nation\n[INFOSEPARATOR]\nn_nationkey\nn_name\n[INFOSEPARATOR]\nEC: 25', 'children': []}]}]}]}, {'name': 'HASH_JOIN', 'timing': 0.000212, 'cardinality': 10000, 'extra_info': 'INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 10000\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 4.3e-05, 'cardinality': 10000, 'extra_info': 'supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\n[INFOSEPARATOR]\nEC: 10000', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 1.7e-05, 'cardinality': 25, 'extra_info': 'nation\n[INFOSEPARATOR]\nn_nationkey\nn_name\n[INFOSEPARATOR]\nEC: 25', 'children': []}]}]}]}]}]}]}]}]}]}]}]}]}]}]}
compressed filter_log_size: 54508
compressed filter_log_buffer_size: 23696
compressed limit_offset_size: 1712
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 540097
compressed perfect_full_scan_ht_log_buffer_size: 537233
compressed perfect_probe_ht_log_size: 7491202
compressed perfect_probe_ht_log_buffer_size: 7401240
compressed row_group_log_size: 801297
compressed row_group_log_buffer_size: 750855
compressed scatter_log_size: 17846
compressed scatter_log_buffer_size: 15558
compressed scatter_sel_log_size: 7077052
compressed scatter_sel_log_buffer_size: 7065040
compressed gather_log_size: 1712
compressed gather_log_buffer_size: 0
compressed combine_log_size: 2280
compressed combine_log_buffer_size: 256
compressed finalize_states_log_size: 2032
compressed finalize_states_log_buffer_size: 32
compressed join_gather_log_size: 7713728
compressed join_gather_log_buffer_size: 7567175
compressed reorder_log_size: 2728
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 1712
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 1712
compressed nlj_log_buffer_size: 0
compressed total_size: 23709618
compressed total_buffer_size: 23361085
compressed total_element_size: 348533

Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                                                                                                                                                                                                           
│         PROJECTION        │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│__internal_decompress_integ│                                                                                                                                                                                                           
│    ral_bigint(#0, 1992)   │                                                                                                                                                                                                           
│             #1            │                                                                                                                                                                                                           
└─────────────┬─────────────┘                                                                                                                                                                                                                                        
┌─────────────┴─────────────┐                                                                                                                                                                                                           
│          ORDER_BY         │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│          ORDERS:          │                                                                                                                                                                                                           
│   all_nations.o_year ASC  │                                                                                                                                                                                                           
└─────────────┬─────────────┘                                                                                                                                                                                                                                        
┌─────────────┴─────────────┐                                                                                                                                                                                                           
│         PROJECTION        │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│__internal_compress_integra│                                                                                                                                                                                                           
│    l_utinyint(#0, 1992)   │                                                                                                                                                                                                           
│             #1            │                                                                                                                                                                                                           
└─────────────┬─────────────┘                                                                                                                                                                                                                                        
┌─────────────┴─────────────┐                                                                                                                                                                                                           
│         PROJECTION        │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│           o_year          │                                                                                                                                                                                                           
│         mkt_share         │                                                                                                                                                                                                           
└─────────────┬─────────────┘                                                                                                                                                                                                                                        
┌─────────────┴─────────────┐                                                                                                                                                                                                           
│         PROJECTION        │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│__internal_decompress_integ│                                                                                                                                                                                                           
│    ral_bigint(#0, 1992)   │                                                                                                                                                                                                           
│             #1            │                                                                                                                                                                                                           
│             #2            │                                                                                                                                                                                                           
└─────────────┬─────────────┘                                                                                                                                                                                                                                        
┌─────────────┴─────────────┐                                                                                                                                                                                                           
│   PERFECT_HASH_GROUP_BY   │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│             #0            │                                                                                                                                                                                                           
│          sum(#1)          │                                                                                                                                                                                                           
│          sum(#2)          │                                                                                                                                                                                                           
└─────────────┬─────────────┘                                                                                                                                                                                                                                        
┌─────────────┴─────────────┐                                                                                                                                                                                                           
│         PROJECTION        │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│           o_year          │                                                                                                                                                                                                           
│   CASE  WHEN ((nation =   │                                                                                                                                                                                                           
│'BRAZIL')) THEN (volum...  │                                                                                                                                                                                                           
│         .0000 END         │                                                                                                                                                                                                           
│           volume          │                                                                                                                                                                                                           
└─────────────┬─────────────┘                                                                                                                                                                                                                                        
┌─────────────┴─────────────┐                                                                                                                                                                                                           
│         PROJECTION        │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│__internal_compress_integra│                                                                                                                                                                                                           
│    l_utinyint(#0, 1992)   │                                                                                                                                                                                                           
│             #1            │                                                                                                                                                                                                           
│             #2            │                                                                                                                                                                                                           
└─────────────┬─────────────┘                                                                                                                                                                                                                                        
┌─────────────┴─────────────┐                                                                                                                                                                                                           
│         PROJECTION        │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│     year(o_orderdate)     │                                                                                                                                                                                                           
│           volume          │                                                                                                                                                                                                           
│           nation          │                                                                                                                                                                                                           
└─────────────┬─────────────┘                                                                                                                                                                                                                                        
┌─────────────┴─────────────┐                                                                                                                                                                                                           
│         HASH_JOIN         │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│           INNER           │                                                                                                                                                                                                           
│ s_nationkey = n_nationkey │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐              
│        Build Min: 0       │                                                                                                                                                                                            │              
│       Build Max: 24       │                                                                                                                                                                                            │              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                            │              
│          EC: 508          │                                                                                                                                                                                            │              
└─────────────┬─────────────┘                                                                                                                                                                                            │                                           
┌─────────────┴─────────────┐                                                                                                                                                                              ┌─────────────┴─────────────┐
│         HASH_JOIN         │                                                                                                                                                                              │         SEQ_SCAN          │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│           INNER           │                                                                                                                                                                              │           nation          │
│   s_suppkey = l_suppkey   │                                                                                                                                                                              │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐                                                                                                                                                               │        n_nationkey        │
│        Build Min: 1       │              │                                                                                                                                                               │           n_name          │
│      Build Max: 10000     │              │                                                                                                                                                               │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                                                                                                                                               │           EC: 25          │
│          EC: 508          │              │                                                                                                                                                               │                           │
└─────────────┬─────────────┘              │                                                                                                                                                               └───────────────────────────┘                             
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                                                                                                              
│         SEQ_SCAN          ││         HASH_JOIN         │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│          supplier         ││           INNER           │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││ c_nationkey = n_nationkey │                                                                                                                                                                              
│         s_suppkey         ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├─────────────────────────────────────────────────────────────────────────────────────────────────────┐                                                                        
│        s_nationkey        ││        Build Min: 0       │                                                                                                     │                                                                        
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││       Build Max: 24       │                                                                                                     │                                                                        
│         EC: 10000         ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                     │                                                                        
│                           ││          EC: 512          │                                                                                                     │                                                                        
└───────────────────────────┘└─────────────┬─────────────┘                                                                                                     │                                                                                                     
                             ┌─────────────┴─────────────┐                                                                                       ┌─────────────┴─────────────┐                                                          
                             │         HASH_JOIN         │                                                                                       │         HASH_JOIN         │                                                          
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                             │           INNER           │                                                                                       │           INNER           │                                                          
                             │   c_custkey = o_custkey   │                                                                                       │ n_regionkey = r_regionkey │                                                          
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐                                                                        │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐                                           
                             │        Build Min: 1       │              │                                                                        │        Build Min: 0       │              │                                           
                             │     Build Max: 149999     │              │                                                                        │        Build Max: 4       │              │                                           
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                                                        │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                           
                             │          EC: 2562         │              │                                                                        │           EC: 5           │              │                                           
                             └─────────────┬─────────────┘              │                                                                        └─────────────┬─────────────┘              │                                                                        
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             
                             │         SEQ_SCAN          ││         HASH_JOIN         │                                                          │         SEQ_SCAN          ││         SEQ_SCAN          │                             
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                             │          customer         ││           INNER           │                                                          │           nation          ││           region          │                             
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││  o_orderkey = l_orderkey  │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                             │         c_custkey         ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │        n_nationkey        ││        r_regionkey        │                             
                             │        c_nationkey        ││          EC: 4249         ├──────────────┐                                           │        n_regionkey        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │              │                                           │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││ Filters: r_name='AMERICA' │                             
                             │ Filters: c_custkey<=149999││                           │              │                                           │           EC: 25          ││   AND r_name IS NOT NULL  │                             
                             │  AND c_custkey IS NOT NULL││                           │              │                                           │                           ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │              │                                           │                           ││           EC: 1           │                             
                             │         EC: 150000        ││                           │              │                                           │                           ││                           │                             
                             └───────────────────────────┘└─────────────┬─────────────┘              │                                           └───────────────────────────┘└───────────────────────────┘                                                          
                                                          ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                                                    
                                                          │         SEQ_SCAN          ││         HASH_JOIN         │                                                                                                                    
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
                                                          │           orders          ││           INNER           │                                                                                                                    
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   l_partkey = p_partkey   │                                                                                                                    
                                                          │         o_orderkey        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
                                                          │         o_custkey         ││        Build Min: 1       │                                                                                                                    
                                                          │        o_orderdate        ││     Build Max: 200000     │                                                                                                                    
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐                                                                                                     
                                                          │Filters: o_orderdate>='1995││         EC: 21246         │              │                                                                                                     
                                                          │     -01-01'::DATE AND     ││                           │              │                                                                                                     
                                                          │ o_orderdate<='1996-12...  ││                           │              │                                                                                                     
                                                          │   o_orderdate IS NOT NULL ││                           │              │                                                                                                     
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │              │                                                                                                     
                                                          │         EC: 300000        ││                           │              │                                                                                                     
                                                          └───────────────────────────┘└─────────────┬─────────────┘              │                                                                                                                                  
                                                                                       ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                       
                                                                                       │         SEQ_SCAN          ││         SEQ_SCAN          │                                                                                       
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
                                                                                       │          lineitem         ││            part           │                                                                                       
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
                                                                                       │         l_partkey         ││         p_partkey         │                                                                                       
                                                                                       │         l_suppkey         ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
                                                                                       │         l_orderkey        ││  Filters: p_type='ECONOMY │                                                                                       
                                                                                       │      l_extendedprice      ││ ANODIZED STEEL' AND p...  │                                                                                       
                                                                                       │         l_discount        ││          NOT NULL         │                                                                                       
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
                                                                                       │        EC: 6001215        ││          EC: 1325         │                                                                                       
                                                                                       └───────────────────────────┘└───────────────────────────┘                                                                                                                    

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

X {'RESULT_COLLECTOR0': 1.3e-05, 'PROJECTION1': 1.4e-05, 'ORDER_BY2': 8.6e-05, 'PROJECTION3': 8e-06, 'PROJECTION4': 1.6e-05, 'HASH_GROUP_BY5': 0.004116, 'PROJECTION6': 5e-06, 'PROJECTION7': 0.000155, 'PROJECTION8': 0.000167, 'PROJECTION9': 9e-06, 'FILTER10': 0.070991, 'HASH_JOIN11': 0.059688, 'HASH_JOIN12': 0.353966, 'SEQ_SCAN 13': 0.055124, 'HASH_JOIN14': 0.048624, 'SEQ_SCAN 15': 0.003484, 'HASH_JOIN16': 0.008409, 'SEQ_SCAN 17': 0.001726, 'SEQ_SCAN 18': 3.7e-05, 'HASH_JOIN19': 0.000212, 'SEQ_SCAN 20': 4.3e-05, 'SEQ_SCAN 21': 1.7e-05}
**** output size:  4
LINEAGE_5_FILTER_11
LINEAGE_5_HASH_GROUP_BY_16
LINEAGE_5_HASH_JOIN_10
LINEAGE_5_HASH_JOIN_4
LINEAGE_5_HASH_JOIN_5
LINEAGE_5_HASH_JOIN_6
LINEAGE_5_HASH_JOIN_9
LINEAGE_5_ORDER_BY_19
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_1
LINEAGE_5_SEQ_SCAN_2
LINEAGE_5_SEQ_SCAN_3
LINEAGE_5_SEQ_SCAN_7
LINEAGE_5_SEQ_SCAN_8
SELECT supp_nation, cust_nation, l_year, sum(volume) AS revenue FROM ( SELECT n1.n_name AS supp_nation, n2.n_name AS cust_nation, extract(year FROM l_shipdate) AS l_year, l_extendedprice * (1 - l_discount) AS volume FROM supplier, lineitem, orders, customer, nation n1, nation n2 WHERE s_suppkey = l_suppkey AND o_orderkey = l_orderkey AND c_custkey = o_custkey AND s_nationkey = n1.n_nationkey AND c_nationkey = n2.n_nationkey AND ((n1.n_name = 'FRANCE' AND n2.n_name = 'GERMANY') OR (n1.n_name = 'GERMANY' AND n2.n_name = 'FRANCE')) AND l_shipdate BETWEEN CAST('1995-01-01' AS date) AND CAST('1996-12-31' AS date)) AS shipping GROUP BY supp_nation, cust_nation, l_year ORDER BY supp_nation, cust_nation, l_year;
   query_id  ...                                               plan
0         5  ...  {"name": "PROJECTION", "opid": "20", "children...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               SELECT supp_nation, cust_nation, l_year, sum(v...
size_bytes_max                                               23709618
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "PROJECTION", "opid": "20", "children...
Name: 0, dtype: object
{"name": "PROJECTION", "opid": "20", "children": [{"name": "ORDER_BY", "opid": "19", "children": [{"name": "PROJECTION", "opid": "18", "children": [{"name": "PROJECTION", "opid": "17", "children": [{"name": "HASH_GROUP_BY", "opid": "16", "children": [{"name": "PROJECTION", "opid": "15", "children": [{"name": "PROJECTION", "opid": "14", "children": [{"name": "PROJECTION", "opid": "13", "children": [{"name": "PROJECTION", "opid": "12", "children": [{"name": "FILTER", "opid": "11", "children": [{"name": "HASH_JOIN", "opid": "10", "children": [{"name": "HASH_JOIN", "opid": "6", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_suppkey\nl_orderkey\nl_shipdate\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nFilters: l_shipdate>='1995-01-01'::DATE AND l_shipdate<='1996-12-31'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243"},{"name": "HASH_JOIN", "opid": "5", "children": [{"name": "SEQ_SCAN ", "opid": "1", "children": [],"table": "orders","extra": "orders\n[INFOSEPARATOR]\no_orderkey\no_custkey\n[INFOSEPARATOR]\nEC: 1500000"},{"name": "HASH_JOIN", "opid": "4", "children": [{"name": "SEQ_SCAN ", "opid": "2", "children": [],"table": "customer","extra": "customer\n[INFOSEPARATOR]\nc_custkey\nc_nationkey\n[INFOSEPARATOR]\nFilters: c_custkey<=149999 AND c_custkey IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 150000"},{"name": "SEQ_SCAN ", "opid": "3", "children": [],"table": "nation","extra": "nation\n[INFOSEPARATOR]\nn_nationkey\nn_name\n[INFOSEPARATOR]\nEC: 25"}],"table": "","extra": "INNER\nc_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nEC: 150000\n"}],"table": "","extra": "INNER\no_custkey = c_custkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 149999\n\n[INFOSEPARATOR]\nEC: 904486\n"}],"table": "","extra": "INNER\nl_orderkey = o_orderkey\n\n[INFOSEPARATOR]\nEC: 723735\n"},{"name": "HASH_JOIN", "opid": "9", "children": [{"name": "SEQ_SCAN ", "opid": "7", "children": [],"table": "supplier","extra": "supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\n[INFOSEPARATOR]\nEC: 10000"},{"name": "SEQ_SCAN ", "opid": "8", "children": [],"table": "nation","extra": "nation\n[INFOSEPARATOR]\nn_nationkey\nn_name\n[INFOSEPARATOR]\nEC: 25"}],"table": "","extra": "INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 10000\n"}],"table": "","extra": "INNER\nl_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 717564\n"}],"table": "","extra": "(((n_name = 'FRANCE') AND (n_name = 'GERMANY')) OR ((n_name = 'GERMANY') AND (n_name = 'FRANCE')))\n[INFOSEPARATOR]\nEC: 717564"}],"table": "","extra": "#2\n#3\n#4\n#6\n#8\n"}],"table": "","extra": "supp_nation\ncust_nation\nyear(l_shipdate)\nvolume\n"}],"table": "","extra": "__internal_compress_string_hugeint(#0)\n__internal_compress_string_hugeint(#1)\n__internal_compress_integral_utinyint(#2, 1992)\n#3\n"}],"table": "","extra": "supp_nation\ncust_nation\nl_year\nvolume\n"}],"table": "","extra": "#0\n#1\n#2\nsum(#3)"}],"table": "","extra": "__internal_decompress_string(#0)\n__internal_decompress_string(#1)\n__internal_decompress_integral_bigint(#2, 1992)\n#3\n"}],"table": "","extra": "__internal_compress_string_hugeint(#0)\n__internal_compress_string_hugeint(#1)\n__internal_compress_integral_utinyint(#2, 1992)\n#3\n"}],"table": "","extra": "ORDERS:\nshipping.supp_nation ASC\nshipping.cust_nation ASC\nshipping.l_year ASC"}],"table": "","extra": "__internal_decompress_string(#0)\n__internal_decompress_string(#1)\n__internal_decompress_integral_bigint(#2, 1992)\n#3\n"}
%%%%%%%%%%%%%%%% Running Query #  8  threads:  4
SELECT o_year, sum( CASE WHEN nation = 'BRAZIL' THEN volume ELSE 0 END) / sum(volume) AS mkt_share FROM ( SELECT extract(year FROM o_orderdate) AS o_year, l_extendedprice * (1 - l_discount) AS volume, n2.n_name AS nation FROM part, supplier, lineitem, orders, customer, nation n1, nation n2, region WHERE p_partkey = l_partkey AND s_suppkey = l_suppkey AND l_orderkey = o_orderkey AND o_custkey = c_custkey AND c_nationkey = n1.n_nationkey AND n1.n_regionkey = r_regionkey AND r_name = 'AMERICA' AND s_nationkey = n2.n_nationkey AND o_orderdate BETWEEN CAST('1995-01-01' AS date) AND CAST('1996-12-31' AS date) AND p_type = 'ECONOMY ANODIZED STEEL') AS all_nations GROUP BY o_year ORDER BY o_year;
Run:  None SELECT o_year, sum( CASE WHEN nation = 'BRAZIL' THEN volume ELSE 0 END) / sum(volume) AS mkt_share FROM ( SELECT extract(year FROM o_orderdate) AS o_year, l_extendedprice * (1 - l_discount) AS volume, n2.n_name AS nation FROM part, supplier, lineitem, orders, customer, nation n1, nation n2, region WHERE p_partkey = l_partkey AND s_suppkey = l_suppkey AND l_orderkey = o_orderkey AND o_custkey = c_custkey AND c_nationkey = n1.n_nationkey AND n1.n_regionkey = r_regionkey AND r_name = 'AMERICA' AND s_nationkey = n2.n_nationkey AND o_orderdate BETWEEN CAST('1995-01-01' AS date) AND CAST('1996-12-31' AS date) AND p_type = 'ECONOMY ANODIZED STEEL') AS all_nations GROUP BY o_year ORDER BY o_year;
Avg Time in sec:  0.07090332079678774  output size:  2
   o_year  mkt_share
0    1995   0.034436
1    1996   0.041486
{'name': 'Query', 'result': 0.055322, 'timing': 0.055322, 'cardinality': 0, 'extra-info': "SELECT o_year, sum( CASE WHEN nation = 'BRAZIL' THEN volume ELSE 0 END) / sum(volume) AS mkt_share FROM ( SELECT extract(year FROM o_orderdate) AS o_year, l_extendedprice * (1 - l_discount) AS volume, n2.n_name AS nation FROM part, supplier, lineitem, orders, customer, nation n1, nation n2, region WHERE p_partkey = l_partkey AND s_suppkey = l_suppkey AND l_orderkey = o_orderkey AND o_custkey = c_custkey AND c_nationkey = n1.n_nationkey AND n1.n_regionkey = r_regionkey AND r_name = 'AMERICA' AND s_nationkey = n2.n_nationkey AND o_orderdate BETWEEN CAST('1995-01-01' AS date) AND CAST('1996-12-31' AS date) AND p_type = 'ECONOMY ANODIZED STEEL') AS all_nations GROUP BY o_year ORDER BY o_year;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 5e-06, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 2e-06, 'cardinality': 2, 'extra_info': '__internal_decompress_integral_bigint(#0, 1992)\n#1\n', 'children': [{'name': 'ORDER_BY', 'timing': 4.3e-05, 'cardinality': 2, 'extra_info': 'ORDERS:\nall_nations.o_year ASC', 'children': [{'name': 'PROJECTION', 'timing': 2e-06, 'cardinality': 2, 'extra_info': '__internal_compress_integral_utinyint(#0, 1992)\n#1\n', 'children': [{'name': 'PROJECTION', 'timing': 7e-06, 'cardinality': 2, 'extra_info': 'o_year\nmkt_share\n', 'children': [{'name': 'PROJECTION', 'timing': 6e-06, 'cardinality': 2, 'extra_info': '__internal_decompress_integral_bigint(#0, 1992)\n#1\n#2\n', 'children': [{'name': 'PERFECT_HASH_GROUP_BY', 'timing': 6.8e-05, 'cardinality': 2, 'extra_info': '#0\nsum(#1)\nsum(#2)', 'children': [{'name': 'PROJECTION', 'timing': 4e-05, 'cardinality': 2603, 'extra_info': "o_year\nCASE  WHEN ((nation = 'BRAZIL')) THEN (volume) ELSE 0.0000 END\nvolume\n", 'children': [{'name': 'PROJECTION', 'timing': 1.1e-05, 'cardinality': 2603, 'extra_info': '__internal_compress_integral_utinyint(#0, 1992)\n#1\n#2\n', 'children': [{'name': 'PROJECTION', 'timing': 6.2e-05, 'cardinality': 2603, 'extra_info': 'year(o_orderdate)\nvolume\nnation\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.000166, 'cardinality': 2603, 'extra_info': 'INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 508\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.000969, 'cardinality': 2603, 'extra_info': 'INNER\ns_suppkey = l_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 508\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 3e-05, 'cardinality': 10000, 'extra_info': 'supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\n[INFOSEPARATOR]\nEC: 10000', 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.000882, 'cardinality': 2603, 'extra_info': 'INNER\nc_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 512\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.006918, 'cardinality': 13389, 'extra_info': 'INNER\nc_custkey = o_custkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 149999\n\n[INFOSEPARATOR]\nEC: 2562\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.001101, 'cardinality': 149999, 'extra_info': 'customer\n[INFOSEPARATOR]\nc_custkey\nc_nationkey\n[INFOSEPARATOR]\nFilters: c_custkey<=149999 AND c_custkey IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 150000', 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.02783, 'cardinality': 13389, 'extra_info': 'INNER\no_orderkey = l_orderkey\n\n[INFOSEPARATOR]\nEC: 4249\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.017825, 'cardinality': 457263, 'extra_info': "orders\n[INFOSEPARATOR]\no_orderkey\no_custkey\no_orderdate\n[INFOSEPARATOR]\nFilters: o_orderdate>='1995-01-01'::DATE AND o_orderdate<='1996-12-31'::DATE AND o_orderdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 300000", 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.056167, 'cardinality': 43693, 'extra_info': 'INNER\nl_partkey = p_partkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 21246\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.019762, 'cardinality': 6001215, 'extra_info': 'lineitem\n[INFOSEPARATOR]\nl_partkey\nl_suppkey\nl_orderkey\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nEC: 6001215', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 0.010417, 'cardinality': 1451, 'extra_info': "part\n[INFOSEPARATOR]\np_partkey\n[INFOSEPARATOR]\nFilters: p_type='ECONOMY ANODIZED STEEL' AND p_type IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1325", 'children': []}]}]}]}, {'name': 'HASH_JOIN', 'timing': 6.9e-05, 'cardinality': 5, 'extra_info': 'INNER\nn_regionkey = r_regionkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 4\n\n[INFOSEPARATOR]\nEC: 5\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 1.1e-05, 'cardinality': 25, 'extra_info': 'nation\n[INFOSEPARATOR]\nn_nationkey\nn_regionkey\n[INFOSEPARATOR]\nEC: 25', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 5.1e-05, 'cardinality': 1, 'extra_info': "region\n[INFOSEPARATOR]\nr_regionkey\n[INFOSEPARATOR]\nFilters: r_name='AMERICA' AND r_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1", 'children': []}]}]}]}, {'name': 'SEQ_SCAN ', 'timing': 1.8e-05, 'cardinality': 25, 'extra_info': 'nation\n[INFOSEPARATOR]\nn_nationkey\nn_name\n[INFOSEPARATOR]\nEC: 25', 'children': []}]}]}]}]}]}]}]}]}]}]}]}]}
compressed filter_log_size: 1344
compressed filter_log_buffer_size: 0
compressed limit_offset_size: 1344
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 7695
compressed perfect_full_scan_ht_log_buffer_size: 4815
compressed perfect_probe_ht_log_size: 421837
compressed perfect_probe_ht_log_buffer_size: 376944
compressed row_group_log_size: 230493
compressed row_group_log_buffer_size: 194577
compressed scatter_log_size: 4019
compressed scatter_log_buffer_size: 2484
compressed scatter_sel_log_size: 253820
compressed scatter_sel_log_buffer_size: 247910
compressed gather_log_size: 1344
compressed gather_log_buffer_size: 0
compressed combine_log_size: 1520
compressed combine_log_buffer_size: 32
compressed finalize_states_log_size: 1504
compressed finalize_states_log_buffer_size: 16
compressed join_gather_log_size: 271535
compressed join_gather_log_buffer_size: 241689
compressed reorder_log_size: 2096
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 1344
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 1344
compressed nlj_log_buffer_size: 0
compressed total_size: 1201239
compressed total_buffer_size: 1068467
compressed total_element_size: 132772

Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│__internal_decompress_strin│                                                                                                                                                 
│           g(#0)           │                                                                                                                                                 
│__internal_decompress_integ│                                                                                                                                                 
│    ral_bigint(#1, 1992)   │                                                                                                                                                 
│             #2            │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│          ORDER_BY         │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│          ORDERS:          │                                                                                                                                                 
│     profit.nation ASC     │                                                                                                                                                 
│     profit.o_year DESC    │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│__internal_compress_string_│                                                                                                                                                 
│        hugeint(#0)        │                                                                                                                                                 
│__internal_compress_integra│                                                                                                                                                 
│    l_utinyint(#1, 1992)   │                                                                                                                                                 
│             #2            │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│__internal_decompress_strin│                                                                                                                                                 
│           g(#0)           │                                                                                                                                                 
│__internal_decompress_integ│                                                                                                                                                 
│    ral_bigint(#1, 1992)   │                                                                                                                                                 
│             #2            │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│       HASH_GROUP_BY       │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│             #0            │                                                                                                                                                 
│             #1            │                                                                                                                                                 
│          sum(#2)          │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│           nation          │                                                                                                                                                 
│           o_year          │                                                                                                                                                 
│           amount          │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│__internal_compress_string_│                                                                                                                                                 
│        hugeint(#0)        │                                                                                                                                                 
│__internal_compress_integra│                                                                                                                                                 
│    l_utinyint(#1, 1992)   │                                                                                                                                                 
│             #2            │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│           nation          │                                                                                                                                                 
│     year(o_orderdate)     │                                                                                                                                                 
│           amount          │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         HASH_JOIN         │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│           INNER           │                                                                                                                                                 
│  o_orderkey = l_orderkey  ├──────────────┐                                                                                                                                  
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                                                                                                                  
│        EC: 1191610        │              │                                                                                                                                  
└─────────────┬─────────────┘              │                                                                                                                                                               
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                                                    
│         SEQ_SCAN          ││         HASH_JOIN         │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│           orders          ││           INNER           │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   l_suppkey = ps_suppkey  │                                                                                                                    
│         o_orderkey        ││   l_partkey = ps_partkey  ├──────────────┐                                                                                                     
│        o_orderdate        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                                                                                     
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││        EC: 1191610        │              │                                                                                                     
│        EC: 1500000        ││                           │              │                                                                                                     
└───────────────────────────┘└─────────────┬─────────────┘              │                                                                                                                                  
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                       
                             │         SEQ_SCAN          ││         HASH_JOIN         │                                                                                       
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
                             │          lineitem         ││           INNER           │                                                                                       
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ps_suppkey = s_suppkey  │                                                                                       
                             │         l_suppkey         ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
                             │         l_partkey         ││        Build Min: 1       │                                                                                       
                             │         l_orderkey        ││      Build Max: 10000     ├───────────────────────────────────────────┐                                           
                             │      l_extendedprice      ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                           │                                           
                             │         l_discount        ││         EC: 74312         │                                           │                                           
                             │         l_quantity        ││                           │                                           │                                           
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                           │                                           
                             │        EC: 6001215        ││                           │                                           │                                           
                             └───────────────────────────┘└─────────────┬─────────────┘                                           │                                                                        
                                                          ┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐                             
                                                          │         HASH_JOIN         │                             │         HASH_JOIN         │                             
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                                                          │           INNER           │                             │           INNER           │                             
                                                          │   ps_partkey = p_partkey  │                             │ s_nationkey = n_nationkey │                             
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐              │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐              
                                                          │        Build Min: 1       │              │              │        Build Min: 0       │              │              
                                                          │     Build Max: 200000     │              │              │       Build Max: 24       │              │              
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              
                                                          │         EC: 85503         │              │              │         EC: 10000         │              │              
                                                          └─────────────┬─────────────┘              │              └─────────────┬─────────────┘              │                                           
                                                          ┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐
                                                          │         SEQ_SCAN          ││           FILTER          ││         SEQ_SCAN          ││         SEQ_SCAN          │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │          partsupp         ││ contains(p_name, 'green') ││          supplier         ││           nation          │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │         ps_suppkey        ││         EC: 40000         ││         s_suppkey         ││        n_nationkey        │
                                                          │         ps_partkey        ││                           ││        s_nationkey        ││           n_name          │
                                                          │       ps_supplycost       ││                           ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           ││         EC: 10000         ││           EC: 25          │
                                                          │         EC: 800000        ││                           ││                           ││                           │
                                                          └───────────────────────────┘└─────────────┬─────────────┘└───────────────────────────┘└───────────────────────────┘                             
                                                                                       ┌─────────────┴─────────────┐                                                          
                                                                                       │         SEQ_SCAN          │                                                          
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                                                       │            part           │                                                          
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                                                       │         p_partkey         │                                                          
                                                                                       │           p_name          │                                                          
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                                                       │         EC: 40000         │                                                          
                                                                                       └───────────────────────────┘                                                                                       

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

X {'RESULT_COLLECTOR0': 5e-06, 'PROJECTION1': 2e-06, 'ORDER_BY2': 4.3e-05, 'PROJECTION3': 2e-06, 'PROJECTION4': 7e-06, 'PROJECTION5': 6e-06, 'PERFECT_HASH_GROUP_BY6': 6.8e-05, 'PROJECTION7': 4e-05, 'PROJECTION8': 1.1e-05, 'PROJECTION9': 6.2e-05, 'HASH_JOIN10': 0.000166, 'HASH_JOIN11': 0.000969, 'SEQ_SCAN 12': 3e-05, 'HASH_JOIN13': 0.000882, 'HASH_JOIN14': 0.006918, 'SEQ_SCAN 15': 0.001101, 'HASH_JOIN16': 0.02783, 'SEQ_SCAN 17': 0.017825, 'HASH_JOIN18': 0.056167, 'SEQ_SCAN 19': 0.019762, 'SEQ_SCAN 20': 0.010417, 'HASH_JOIN21': 6.9e-05, 'SEQ_SCAN 22': 1.1e-05, 'SEQ_SCAN 23': 5.1e-05, 'SEQ_SCAN 24': 1.8e-05}
**** output size:  2
LINEAGE_5_HASH_JOIN_10
LINEAGE_5_HASH_JOIN_11
LINEAGE_5_HASH_JOIN_12
LINEAGE_5_HASH_JOIN_14
LINEAGE_5_HASH_JOIN_5
LINEAGE_5_HASH_JOIN_6
LINEAGE_5_HASH_JOIN_7
LINEAGE_5_ORDER_BY_22
LINEAGE_5_PERFECT_HASH_GROUP_BY_18
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_1
LINEAGE_5_SEQ_SCAN_13
LINEAGE_5_SEQ_SCAN_2
LINEAGE_5_SEQ_SCAN_3
LINEAGE_5_SEQ_SCAN_4
LINEAGE_5_SEQ_SCAN_8
LINEAGE_5_SEQ_SCAN_9
SELECT o_year, sum( CASE WHEN nation = 'BRAZIL' THEN volume ELSE 0 END) / sum(volume) AS mkt_share FROM ( SELECT extract(year FROM o_orderdate) AS o_year, l_extendedprice * (1 - l_discount) AS volume, n2.n_name AS nation FROM part, supplier, lineitem, orders, customer, nation n1, nation n2, region WHERE p_partkey = l_partkey AND s_suppkey = l_suppkey AND l_orderkey = o_orderkey AND o_custkey = c_custkey AND c_nationkey = n1.n_nationkey AND n1.n_regionkey = r_regionkey AND r_name = 'AMERICA' AND s_nationkey = n2.n_nationkey AND o_orderdate BETWEEN CAST('1995-01-01' AS date) AND CAST('1996-12-31' AS date) AND p_type = 'ECONOMY ANODIZED STEEL') AS all_nations GROUP BY o_year ORDER BY o_year;
   query_id  ...                                               plan
0         5  ...  {"name": "PROJECTION", "opid": "23", "children...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               SELECT o_year, sum( CASE WHEN nation = 'BRAZIL...
size_bytes_max                                                1201239
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "PROJECTION", "opid": "23", "children...
Name: 0, dtype: object
{"name": "PROJECTION", "opid": "23", "children": [{"name": "ORDER_BY", "opid": "22", "children": [{"name": "PROJECTION", "opid": "21", "children": [{"name": "PROJECTION", "opid": "20", "children": [{"name": "PROJECTION", "opid": "19", "children": [{"name": "PERFECT_HASH_GROUP_BY", "opid": "18", "children": [{"name": "PROJECTION", "opid": "17", "children": [{"name": "PROJECTION", "opid": "16", "children": [{"name": "PROJECTION", "opid": "15", "children": [{"name": "HASH_JOIN", "opid": "14", "children": [{"name": "HASH_JOIN", "opid": "12", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "supplier","extra": "supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\n[INFOSEPARATOR]\nEC: 10000"},{"name": "HASH_JOIN", "opid": "11", "children": [{"name": "HASH_JOIN", "opid": "7", "children": [{"name": "SEQ_SCAN ", "opid": "1", "children": [],"table": "customer","extra": "customer\n[INFOSEPARATOR]\nc_custkey\nc_nationkey\n[INFOSEPARATOR]\nFilters: c_custkey<=149999 AND c_custkey IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 150000"},{"name": "HASH_JOIN", "opid": "6", "children": [{"name": "SEQ_SCAN ", "opid": "2", "children": [],"table": "orders","extra": "orders\n[INFOSEPARATOR]\no_orderkey\no_custkey\no_orderdate\n[INFOSEPARATOR]\nFilters: o_orderdate>='1995-01-01'::DATE AND o_orderdate<='1996-12-31'::DATE AND o_orderdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 300000"},{"name": "HASH_JOIN", "opid": "5", "children": [{"name": "SEQ_SCAN ", "opid": "3", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_partkey\nl_suppkey\nl_orderkey\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nEC: 6001215"},{"name": "SEQ_SCAN ", "opid": "4", "children": [],"table": "part","extra": "part\n[INFOSEPARATOR]\np_partkey\n[INFOSEPARATOR]\nFilters: p_type='ECONOMY ANODIZED STEEL' AND p_type IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1325"}],"table": "","extra": "INNER\nl_partkey = p_partkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 21246\n"}],"table": "","extra": "INNER\no_orderkey = l_orderkey\n\n[INFOSEPARATOR]\nEC: 4249\n"}],"table": "","extra": "INNER\nc_custkey = o_custkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 149999\n\n[INFOSEPARATOR]\nEC: 2562\n"},{"name": "HASH_JOIN", "opid": "10", "children": [{"name": "SEQ_SCAN ", "opid": "8", "children": [],"table": "nation","extra": "nation\n[INFOSEPARATOR]\nn_nationkey\nn_regionkey\n[INFOSEPARATOR]\nEC: 25"},{"name": "SEQ_SCAN ", "opid": "9", "children": [],"table": "region","extra": "region\n[INFOSEPARATOR]\nr_regionkey\n[INFOSEPARATOR]\nFilters: r_name='AMERICA' AND r_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1"}],"table": "","extra": "INNER\nn_regionkey = r_regionkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 4\n\n[INFOSEPARATOR]\nEC: 5\n"}],"table": "","extra": "INNER\nc_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 512\n"}],"table": "","extra": "INNER\ns_suppkey = l_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 508\n"},{"name": "SEQ_SCAN ", "opid": "13", "children": [],"table": "nation","extra": "nation\n[INFOSEPARATOR]\nn_nationkey\nn_name\n[INFOSEPARATOR]\nEC: 25"}],"table": "","extra": "INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 508\n"}],"table": "","extra": "year(o_orderdate)\nvolume\nnation\n"}],"table": "","extra": "__internal_compress_integral_utinyint(#0, 1992)\n#1\n#2\n"}],"table": "","extra": "o_year\nCASE  WHEN ((nation = 'BRAZIL')) THEN (volume) ELSE 0.0000 END\nvolume\n"}],"table": "","extra": "#0\nsum(#1)\nsum(#2)"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1992)\n#1\n#2\n"}],"table": "","extra": "o_year\nmkt_share\n"}],"table": "","extra": "__internal_compress_integral_utinyint(#0, 1992)\n#1\n"}],"table": "","extra": "ORDERS:\nall_nations.o_year ASC"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1992)\n#1\n"}
%%%%%%%%%%%%%%%% Running Query #  9  threads:  4
SELECT nation, o_year, sum(amount) AS sum_profit FROM ( SELECT n_name AS nation, extract(year FROM o_orderdate) AS o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity AS amount FROM part, supplier, lineitem, partsupp, orders, nation WHERE s_suppkey = l_suppkey AND ps_suppkey = l_suppkey AND ps_partkey = l_partkey AND p_partkey = l_partkey AND o_orderkey = l_orderkey AND s_nationkey = n_nationkey AND p_name LIKE '%green%') AS profit GROUP BY nation, o_year ORDER BY nation, o_year DESC;
Run:  None SELECT nation, o_year, sum(amount) AS sum_profit FROM ( SELECT n_name AS nation, extract(year FROM o_orderdate) AS o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity AS amount FROM part, supplier, lineitem, partsupp, orders, nation WHERE s_suppkey = l_suppkey AND ps_suppkey = l_suppkey AND ps_partkey = l_partkey AND p_partkey = l_partkey AND o_orderkey = l_orderkey AND s_nationkey = n_nationkey AND p_name LIKE '%green%') AS profit GROUP BY nation, o_year ORDER BY nation, o_year DESC;
Avg Time in sec:  0.2041658372618258  output size:  175
      nation  o_year    sum_profit
0    ALGERIA    1998  2.713690e+07
1    ALGERIA    1997  4.861183e+07
2    ALGERIA    1996  4.828548e+07
3    ALGERIA    1995  4.440227e+07
4    ALGERIA    1994  4.869401e+07
..       ...     ...           ...
170  VIETNAM    1996  4.782460e+07
171  VIETNAM    1995  4.823514e+07
172  VIETNAM    1994  4.772926e+07
173  VIETNAM    1993  4.535268e+07
174  VIETNAM    1992  4.784636e+07

[175 rows x 3 columns]
{'name': 'Query', 'result': 0.188939, 'timing': 0.188939, 'cardinality': 0, 'extra-info': "SELECT nation, o_year, sum(amount) AS sum_profit FROM ( SELECT n_name AS nation, extract(year FROM o_orderdate) AS o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity AS amount FROM part, supplier, lineitem, partsupp, orders, nation WHERE s_suppkey = l_suppkey AND ps_suppkey = l_suppkey AND ps_partkey = l_partkey AND p_partkey = l_partkey AND o_orderkey = l_orderkey AND s_nationkey = n_nationkey AND p_name LIKE '%green%') AS profit GROUP BY nation, o_year ORDER BY nation, o_year DESC;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 2.5e-05, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 1.9e-05, 'cardinality': 175, 'extra_info': '__internal_decompress_string(#0)\n__internal_decompress_integral_bigint(#1, 1992)\n#2\n', 'children': [{'name': 'ORDER_BY', 'timing': 0.000105, 'cardinality': 175, 'extra_info': 'ORDERS:\nprofit.nation ASC\nprofit.o_year DESC', 'children': [{'name': 'PROJECTION', 'timing': 1.5e-05, 'cardinality': 175, 'extra_info': '__internal_compress_string_hugeint(#0)\n__internal_compress_integral_utinyint(#1, 1992)\n#2\n', 'children': [{'name': 'PROJECTION', 'timing': 2.9e-05, 'cardinality': 175, 'extra_info': '__internal_decompress_string(#0)\n__internal_decompress_integral_bigint(#1, 1992)\n#2\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.026383, 'cardinality': 175, 'extra_info': '#0\n#1\nsum(#2)', 'children': [{'name': 'PROJECTION', 'timing': 0.000517, 'cardinality': 319404, 'extra_info': 'nation\no_year\namount\n', 'children': [{'name': 'PROJECTION', 'timing': 0.005904, 'cardinality': 319404, 'extra_info': '__internal_compress_string_hugeint(#0)\n__internal_compress_integral_utinyint(#1, 1992)\n#2\n', 'children': [{'name': 'PROJECTION', 'timing': 0.0124, 'cardinality': 319404, 'extra_info': 'nation\nyear(o_orderdate)\namount\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.213042, 'cardinality': 319404, 'extra_info': 'INNER\no_orderkey = l_orderkey\n\n[INFOSEPARATOR]\nEC: 1191610\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.00328, 'cardinality': 1500000, 'extra_info': 'orders\n[INFOSEPARATOR]\no_orderkey\no_orderdate\n[INFOSEPARATOR]\nEC: 1500000', 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.25182, 'cardinality': 319404, 'extra_info': 'INNER\nl_suppkey = ps_suppkey\nl_partkey = ps_partkey\n\n[INFOSEPARATOR]\nEC: 1191610\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.022555, 'cardinality': 6001215, 'extra_info': 'lineitem\n[INFOSEPARATOR]\nl_suppkey\nl_partkey\nl_orderkey\nl_extendedprice\nl_discount\nl_quantity\n[INFOSEPARATOR]\nEC: 6001215', 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.007855, 'cardinality': 42656, 'extra_info': 'INNER\nps_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 74312\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.01204, 'cardinality': 42656, 'extra_info': 'INNER\nps_partkey = p_partkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 85503\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.003084, 'cardinality': 800000, 'extra_info': 'partsupp\n[INFOSEPARATOR]\nps_suppkey\nps_partkey\nps_supplycost\n[INFOSEPARATOR]\nEC: 800000', 'children': []}, {'name': 'FILTER', 'timing': 0.01104, 'cardinality': 10664, 'extra_info': "contains(p_name, 'green')\n[INFOSEPARATOR]\nEC: 40000", 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.00857, 'cardinality': 200000, 'extra_info': 'part\n[INFOSEPARATOR]\np_partkey\np_name\n[INFOSEPARATOR]\nEC: 40000', 'children': []}]}]}, {'name': 'HASH_JOIN', 'timing': 0.000302, 'cardinality': 10000, 'extra_info': 'INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 10000\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 4.1e-05, 'cardinality': 10000, 'extra_info': 'supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\n[INFOSEPARATOR]\nEC: 10000', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 2.2e-05, 'cardinality': 25, 'extra_info': 'nation\n[INFOSEPARATOR]\nn_nationkey\nn_name\n[INFOSEPARATOR]\nEC: 25', 'children': []}]}]}]}]}]}]}]}]}]}]}]}]}]}]}
compressed filter_log_size: 23280
compressed filter_log_buffer_size: 20249
compressed limit_offset_size: 1584
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 54753
compressed perfect_full_scan_ht_log_buffer_size: 52017
compressed perfect_probe_ht_log_size: 225264
compressed perfect_probe_ht_log_buffer_size: 210750
compressed row_group_log_size: 32000
compressed row_group_log_buffer_size: 0
compressed scatter_log_size: 1177612
compressed scatter_log_buffer_size: 1168150
compressed scatter_sel_log_size: 2169255
compressed scatter_sel_log_buffer_size: 2124457
compressed gather_log_size: 1584
compressed gather_log_buffer_size: 0
compressed combine_log_size: 19034
compressed combine_log_buffer_size: 16836
compressed finalize_states_log_size: 2440
compressed finalize_states_log_buffer_size: 280
compressed join_gather_log_size: 4158541
compressed join_gather_log_buffer_size: 3978789
compressed reorder_log_size: 2804
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 1584
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 1584
compressed nlj_log_buffer_size: 0
compressed total_size: 7871319
compressed total_buffer_size: 7571528
compressed total_element_size: 299791

Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                                                                                       
│           LIMIT           │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│__internal_decompress_integ│                                                                                       
│     ral_bigint(#0, 1)     │                                                                                       
│             #1            │                                                                                       
│             #2            │                                                                                       
│             #3            │                                                                                       
│__internal_decompress_strin│                                                                                       
│           g(#4)           │                                                                                       
│             #5            │                                                                                       
│__internal_decompress_strin│                                                                                       
│           g(#6)           │                                                                                       
│             #7            │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│          ORDER_BY         │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│          ORDERS:          │                                                                                       
│       sum((lineitem       │                                                                                       
│.l_extendedprice * (1 ...  │                                                                                       
│    .l_discount))) DESC    │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│__internal_compress_integra│                                                                                       
│     l_uinteger(#0, 1)     │                                                                                       
│             #1            │                                                                                       
│             #2            │                                                                                       
│             #3            │                                                                                       
│__internal_compress_string_│                                                                                       
│        hugeint(#4)        │                                                                                       
│             #5            │                                                                                       
│__internal_compress_string_│                                                                                       
│        hugeint(#6)        │                                                                                       
│             #7            │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│         c_custkey         │                                                                                       
│           c_name          │                                                                                       
│          revenue          │                                                                                       
│         c_acctbal         │                                                                                       
│           n_name          │                                                                                       
│         c_address         │                                                                                       
│          c_phone          │                                                                                       
│         c_comment         │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│__internal_decompress_integ│                                                                                       
│     ral_bigint(#0, 1)     │                                                                                       
│             #1            │                                                                                       
│             #2            │                                                                                       
│__internal_decompress_strin│                                                                                       
│           g(#3)           │                                                                                       
│__internal_decompress_strin│                                                                                       
│           g(#4)           │                                                                                       
│             #5            │                                                                                       
│             #6            │                                                                                       
│             #7            │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│       HASH_GROUP_BY       │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│             #0            │                                                                                       
│             #1            │                                                                                       
│             #2            │                                                                                       
│             #3            │                                                                                       
│             #4            │                                                                                       
│             #5            │                                                                                       
│             #6            │                                                                                       
│          sum(#7)          │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│         c_custkey         │                                                                                       
│           c_name          │                                                                                       
│         c_acctbal         │                                                                                       
│          c_phone          │                                                                                       
│           n_name          │                                                                                       
│         c_address         │                                                                                       
│         c_comment         │                                                                                       
│ (l_extendedprice * (1.00 -│                                                                                       
│        l_discount))       │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│__internal_compress_integra│                                                                                       
│     l_uinteger(#0, 1)     │                                                                                       
│             #1            │                                                                                       
│             #2            │                                                                                       
│__internal_compress_integra│                                                                                       
│     l_uinteger(#3, 1)     │                                                                                       
│__internal_compress_integra│                                                                                       
│     l_uinteger(#4, 1)     │                                                                                       
│             #5            │                                                                                       
│             #6            │                                                                                       
│__internal_compress_string_│                                                                                       
│        hugeint(#7)        │                                                                                       
│             #8            │                                                                                       
│             #9            │                                                                                       
│__internal_compress_string_│                                                                                       
│        hugeint(#10)       │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         HASH_JOIN         │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│           INNER           │                                                                                       
│  l_orderkey = o_orderkey  ├──────────────┐                                                                        
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                                                        
│         EC: 241245        │              │                                                                        
└─────────────┬─────────────┘              │                                                                                                     
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                          
│         SEQ_SCAN          ││         HASH_JOIN         │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│          lineitem         ││           INNER           │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   o_custkey = c_custkey   │                                                          
│         l_orderkey        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│      l_extendedprice      ││        Build Min: 1       │                                                          
│         l_discount        ││     Build Max: 149999     ├──────────────┐                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                           
│ Filters: l_returnflag='R' ││         EC: 180897        │              │                                           
│ AND l_returnflag IS N...  ││                           │              │                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │              │                                           
│        EC: 2000405        ││                           │              │                                           
└───────────────────────────┘└─────────────┬─────────────┘              │                                                                        
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             
                             │         SEQ_SCAN          ││         HASH_JOIN         │                             
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                             │           orders          ││           INNER           │                             
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││ c_nationkey = n_nationkey │                             
                             │         o_custkey         ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                             │         o_orderkey        ││         EC: 150000        │                             
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           ├──────────────┐              
                             │Filters: o_orderdate>='1993││                           │              │              
                             │     -10-01'::DATE AND     ││                           │              │              
                             │ o_orderdate<'1994-01-...  ││                           │              │              
                             │   o_orderdate IS NOT NULL ││                           │              │              
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │              │              
                             │         EC: 300000        ││                           │              │              
                             └───────────────────────────┘└─────────────┬─────────────┘              │                                           
                                                          ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
                                                          │         SEQ_SCAN          ││         SEQ_SCAN          │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │          customer         ││           nation          │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │         c_custkey         ││        n_nationkey        │
                                                          │        c_nationkey        ││           n_name          │
                                                          │           c_name          ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │         c_acctbal         ││           EC: 25          │
                                                          │          c_phone          ││                           │
                                                          │         c_address         ││                           │
                                                          │         c_comment         ││                           │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │
                                                          │ Filters: c_custkey<=149999││                           │
                                                          │  AND c_custkey IS NOT NULL││                           │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │
                                                          │         EC: 150000        ││                           │
                                                          └───────────────────────────┘└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

X {'RESULT_COLLECTOR0': 2.5e-05, 'PROJECTION1': 1.9e-05, 'ORDER_BY2': 0.000105, 'PROJECTION3': 1.5e-05, 'PROJECTION4': 2.9e-05, 'HASH_GROUP_BY5': 0.026383, 'PROJECTION6': 0.000517, 'PROJECTION7': 0.005904, 'PROJECTION8': 0.0124, 'HASH_JOIN9': 0.213042, 'SEQ_SCAN 10': 0.00328, 'HASH_JOIN11': 0.25182, 'SEQ_SCAN 12': 0.022555, 'HASH_JOIN13': 0.007855, 'HASH_JOIN14': 0.01204, 'SEQ_SCAN 15': 0.003084, 'FILTER16': 0.01104, 'SEQ_SCAN 17': 0.00857, 'HASH_JOIN18': 0.000302, 'SEQ_SCAN 19': 4.1e-05, 'SEQ_SCAN 20': 2.2e-05}
**** output size:  175
LINEAGE_5_FILTER_4
LINEAGE_5_HASH_GROUP_BY_15
LINEAGE_5_HASH_JOIN_10
LINEAGE_5_HASH_JOIN_11
LINEAGE_5_HASH_JOIN_5
LINEAGE_5_HASH_JOIN_8
LINEAGE_5_HASH_JOIN_9
LINEAGE_5_ORDER_BY_18
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_1
LINEAGE_5_SEQ_SCAN_2
LINEAGE_5_SEQ_SCAN_3
LINEAGE_5_SEQ_SCAN_6
LINEAGE_5_SEQ_SCAN_7
SELECT nation, o_year, sum(amount) AS sum_profit FROM ( SELECT n_name AS nation, extract(year FROM o_orderdate) AS o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity AS amount FROM part, supplier, lineitem, partsupp, orders, nation WHERE s_suppkey = l_suppkey AND ps_suppkey = l_suppkey AND ps_partkey = l_partkey AND p_partkey = l_partkey AND o_orderkey = l_orderkey AND s_nationkey = n_nationkey AND p_name LIKE '%green%') AS profit GROUP BY nation, o_year ORDER BY nation, o_year DESC;
   query_id  ...                                               plan
0         5  ...  {"name": "PROJECTION", "opid": "19", "children...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               SELECT nation, o_year, sum(amount) AS sum_prof...
size_bytes_max                                                7871319
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "PROJECTION", "opid": "19", "children...
Name: 0, dtype: object
{"name": "PROJECTION", "opid": "19", "children": [{"name": "ORDER_BY", "opid": "18", "children": [{"name": "PROJECTION", "opid": "17", "children": [{"name": "PROJECTION", "opid": "16", "children": [{"name": "HASH_GROUP_BY", "opid": "15", "children": [{"name": "PROJECTION", "opid": "14", "children": [{"name": "PROJECTION", "opid": "13", "children": [{"name": "PROJECTION", "opid": "12", "children": [{"name": "HASH_JOIN", "opid": "11", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "orders","extra": "orders\n[INFOSEPARATOR]\no_orderkey\no_orderdate\n[INFOSEPARATOR]\nEC: 1500000"},{"name": "HASH_JOIN", "opid": "10", "children": [{"name": "SEQ_SCAN ", "opid": "1", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_suppkey\nl_partkey\nl_orderkey\nl_extendedprice\nl_discount\nl_quantity\n[INFOSEPARATOR]\nEC: 6001215"},{"name": "HASH_JOIN", "opid": "9", "children": [{"name": "HASH_JOIN", "opid": "5", "children": [{"name": "SEQ_SCAN ", "opid": "2", "children": [],"table": "partsupp","extra": "partsupp\n[INFOSEPARATOR]\nps_suppkey\nps_partkey\nps_supplycost\n[INFOSEPARATOR]\nEC: 800000"},{"name": "FILTER", "opid": "4", "children": [{"name": "SEQ_SCAN ", "opid": "3", "children": [],"table": "part","extra": "part\n[INFOSEPARATOR]\np_partkey\np_name\n[INFOSEPARATOR]\nEC: 40000"}],"table": "","extra": "contains(p_name, 'green')\n[INFOSEPARATOR]\nEC: 40000"}],"table": "","extra": "INNER\nps_partkey = p_partkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 85503\n"},{"name": "HASH_JOIN", "opid": "8", "children": [{"name": "SEQ_SCAN ", "opid": "6", "children": [],"table": "supplier","extra": "supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\n[INFOSEPARATOR]\nEC: 10000"},{"name": "SEQ_SCAN ", "opid": "7", "children": [],"table": "nation","extra": "nation\n[INFOSEPARATOR]\nn_nationkey\nn_name\n[INFOSEPARATOR]\nEC: 25"}],"table": "","extra": "INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 10000\n"}],"table": "","extra": "INNER\nps_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 74312\n"}],"table": "","extra": "INNER\nl_suppkey = ps_suppkey\nl_partkey = ps_partkey\n\n[INFOSEPARATOR]\nEC: 1191610\n"}],"table": "","extra": "INNER\no_orderkey = l_orderkey\n\n[INFOSEPARATOR]\nEC: 1191610\n"}],"table": "","extra": "nation\nyear(o_orderdate)\namount\n"}],"table": "","extra": "__internal_compress_string_hugeint(#0)\n__internal_compress_integral_utinyint(#1, 1992)\n#2\n"}],"table": "","extra": "nation\no_year\namount\n"}],"table": "","extra": "#0\n#1\nsum(#2)"}],"table": "","extra": "__internal_decompress_string(#0)\n__internal_decompress_integral_bigint(#1, 1992)\n#2\n"}],"table": "","extra": "__internal_compress_string_hugeint(#0)\n__internal_compress_integral_utinyint(#1, 1992)\n#2\n"}],"table": "","extra": "ORDERS:\nprofit.nation ASC\nprofit.o_year DESC"}],"table": "","extra": "__internal_decompress_string(#0)\n__internal_decompress_integral_bigint(#1, 1992)\n#2\n"}
%%%%%%%%%%%%%%%% Running Query #  10  threads:  4
SELECT c_custkey, c_name, sum(l_extendedprice * (1 - l_discount)) AS revenue, c_acctbal, n_name, c_address, c_phone, c_comment FROM customer, orders, lineitem, nation WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate >= CAST('1993-10-01' AS date) AND o_orderdate < CAST('1994-01-01' AS date) AND l_returnflag = 'R' AND c_nationkey = n_nationkey GROUP BY c_custkey, c_name, c_acctbal, c_phone, n_name, c_address, c_comment ORDER BY revenue DESC LIMIT 20;
Run:  None SELECT c_custkey, c_name, sum(l_extendedprice * (1 - l_discount)) AS revenue, c_acctbal, n_name, c_address, c_phone, c_comment FROM customer, orders, lineitem, nation WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate >= CAST('1993-10-01' AS date) AND o_orderdate < CAST('1994-01-01' AS date) AND l_returnflag = 'R' AND c_nationkey = n_nationkey GROUP BY c_custkey, c_name, c_acctbal, c_phone, n_name, c_address, c_comment ORDER BY revenue DESC LIMIT 20;
Avg Time in sec:  0.26314039202407  output size:  20
    c_custkey  ...                                          c_comment
0       57040  ...  ep. blithely regular foxes promise slyly furio...
1      143347  ...  endencies sleep. slyly express deposits nag ca...
2       60838  ...   tes. final instructions nag quickly according to
3      101998  ...  ost carefully. slyly regular packages cajole a...
4      125341  ...  ly furiously brave packages. quickly regular d...
5       25501  ...  y ironic foxes hinder according to the furious...
6      115831  ...  unts nag carefully final packages. express the...
7       84223  ...  longside of the slyly final deposits. blithely...
8       54289  ...      cajole furiously after the quickly unusual fo
9       39922  ...  ironic deposits sublate furiously. carefully r...
10       6226  ...  nal packages are alongside of the quickly bold...
11        922  ...                cuses cajole carefully regular idea
12     147946  ...  ly pending platelets. ironic requests haggle a...
13     115640  ...             ffily ironic deposits. blithely specia
14      73606  ...                 uests cajole according to the foxe
15     110246  ...        ow carefully. blithely careful packages hag
16     142549  ...  . slyly bold packages nag quickly against the ...
17     146149  ...  nic, special instructions. multipliers run car...
18      52528  ...  olphins. blithely silent platelets affix caref...
19      23431  ...    the final sentiments. carefully ironic packages

[20 rows x 8 columns]
{'name': 'Query', 'result': 0.25815, 'timing': 0.25815, 'cardinality': 0, 'extra-info': "SELECT c_custkey, c_name, sum(l_extendedprice * (1 - l_discount)) AS revenue, c_acctbal, n_name, c_address, c_phone, c_comment FROM customer, orders, lineitem, nation WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate >= CAST('1993-10-01' AS date) AND o_orderdate < CAST('1994-01-01' AS date) AND l_returnflag = 'R' AND c_nationkey = n_nationkey GROUP BY c_custkey, c_name, c_acctbal, c_phone, n_name, c_address, c_comment ORDER BY revenue DESC LIMIT 20;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 2.5e-05, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'LIMIT', 'timing': 0.000205, 'cardinality': 20, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 0.000568, 'cardinality': 8192, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n#1\n#2\n#3\n__internal_decompress_string(#4)\n#5\n__internal_decompress_string(#6)\n#7\n', 'children': [{'name': 'ORDER_BY', 'timing': 0.007348, 'cardinality': 8192, 'extra_info': 'ORDERS:\nsum((lineitem.l_extendedprice * (1 - lineitem.l_discount))) DESC', 'children': [{'name': 'PROJECTION', 'timing': 0.001621, 'cardinality': 37967, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n#1\n#2\n#3\n__internal_compress_string_hugeint(#4)\n#5\n__internal_compress_string_hugeint(#6)\n#7\n', 'children': [{'name': 'PROJECTION', 'timing': 3.1e-05, 'cardinality': 37967, 'extra_info': 'c_custkey\nc_name\nrevenue\nc_acctbal\nn_name\nc_address\nc_phone\nc_comment\n', 'children': [{'name': 'PROJECTION', 'timing': 0.001904, 'cardinality': 37967, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n#1\n#2\n__internal_decompress_string(#3)\n__internal_decompress_string(#4)\n#5\n#6\n#7\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.066729, 'cardinality': 37967, 'extra_info': '#0\n#1\n#2\n#3\n#4\n#5\n#6\nsum(#7)', 'children': [{'name': 'PROJECTION', 'timing': 0.000961, 'cardinality': 114705, 'extra_info': 'c_custkey\nc_name\nc_acctbal\nc_phone\nn_name\nc_address\nc_comment\n(l_extendedprice * (1.00 - l_discount))\n', 'children': [{'name': 'PROJECTION', 'timing': 0.006721, 'cardinality': 114705, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n#1\n#2\n__internal_compress_integral_uinteger(#3, 1)\n__internal_compress_integral_uinteger(#4, 1)\n#5\n#6\n__internal_compress_string_hugeint(#7)\n#8\n#9\n__internal_compress_string_hugeint(#10)\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.262351, 'cardinality': 114705, 'extra_info': 'INNER\nl_orderkey = o_orderkey\n\n[INFOSEPARATOR]\nEC: 241245\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.215981, 'cardinality': 1478870, 'extra_info': "lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nFilters: l_returnflag='R' AND l_returnflag IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 2000405", 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.054895, 'cardinality': 57069, 'extra_info': 'INNER\no_custkey = c_custkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 149999\n\n[INFOSEPARATOR]\nEC: 180897\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.027465, 'cardinality': 57069, 'extra_info': "orders\n[INFOSEPARATOR]\no_custkey\no_orderkey\n[INFOSEPARATOR]\nFilters: o_orderdate>='1993-10-01'::DATE AND o_orderdate<'1994-01-01'::DATE AND o_orderdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 300000", 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.006939, 'cardinality': 149999, 'extra_info': 'INNER\nc_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nEC: 150000\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.019089, 'cardinality': 149999, 'extra_info': 'customer\n[INFOSEPARATOR]\nc_custkey\nc_nationkey\nc_name\nc_acctbal\nc_phone\nc_address\nc_comment\n[INFOSEPARATOR]\nFilters: c_custkey<=149999 AND c_custkey IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 150000', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 3.4e-05, 'cardinality': 25, 'extra_info': 'nation\n[INFOSEPARATOR]\nn_nationkey\nn_name\n[INFOSEPARATOR]\nEC: 25', 'children': []}]}]}]}]}]}]}]}]}]}]}]}]}]}]}
compressed filter_log_size: 1408
compressed filter_log_buffer_size: 0
compressed limit_offset_size: 1552
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 573018
compressed perfect_full_scan_ht_log_buffer_size: 571226
compressed perfect_probe_ht_log_size: 187380
compressed perfect_probe_ht_log_buffer_size: 175492
compressed row_group_log_size: 942038
compressed row_group_log_buffer_size: 886993
compressed scatter_log_size: 411343
compressed scatter_log_buffer_size: 409116
compressed scatter_sel_log_size: 990169
compressed scatter_sel_log_buffer_size: 978738
compressed gather_log_size: 1408
compressed gather_log_buffer_size: 0
compressed combine_log_size: 456235
compressed combine_log_buffer_size: 454087
compressed finalize_states_log_size: 35205
compressed finalize_states_log_buffer_size: 33162
compressed join_gather_log_size: 1632164
compressed join_gather_log_buffer_size: 1533556
compressed reorder_log_size: 79546
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 1408
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 1408
compressed nlj_log_buffer_size: 0
compressed total_size: 5314282
compressed total_buffer_size: 5042370
compressed total_element_size: 271912

Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│__internal_decompress_integ│                                                                                                                                                 
│     ral_bigint(#0, 1)     │                                                                                                                                                 
│             #1            │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│          ORDER_BY         │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│          ORDERS:          │                                                                                                                                                 
│sum((partsupp.ps_supplycost│                                                                                                                                                 
│  * partsupp.ps_availqty)) │                                                                                                                                                 
│            DESC           │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│__internal_compress_integra│                                                                                                                                                 
│     l_uinteger(#0, 1)     │                                                                                                                                                 
│             #1            │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│         ps_partkey        │                                                                                                                                                 
│           value           │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│      NESTED_LOOP_JOIN     │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│           INNER           │                                                                                                                                                 
│       CAST(sum((CAST      │                                                                                                                                                 
│(ps_supplycost AS DECI...  │                                                                                                                                                 
│(ps_availqty AS DECIMA...  ├────────────────────────────────────────────────────────────────────────┐                                                                        
│ )))) AS DECIMAL(38,11)) > │                                                                        │                                                                        
│          SUBQUERY         │                                                                        │                                                                        
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                        │                                                                        
│           EC: 1           │                                                                        │                                                                        
└─────────────┬─────────────┘                                                                        │                                                                                                     
┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐                                                          
│         PROJECTION        │                                                          │    UNGROUPED_AGGREGATE    │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│__internal_decompress_integ│                                                          │         first(#0)         │                                                          
│     ral_bigint(#0, 1)     │                                                          │                           │                                                          
│             #1            │                                                          │                           │                                                          
└─────────────┬─────────────┘                                                          └─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐                                                          
│       HASH_GROUP_BY       │                                                          │         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│             #0            │                                                          │             #0            │                                                          
│          sum(#1)          │                                                          │                           │                                                          
└─────────────┬─────────────┘                                                          └─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐                                                          
│         PROJECTION        │                                                          │      STREAMING_LIMIT      │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │                           │                                                          
│         ps_partkey        │                                                          │                           │                                                          
│   (CAST(ps_supplycost AS  │                                                          │                           │                                                          
│    DECIMAL(34,2)) * CAST  │                                                          │                           │                                                          
│(ps_availqty AS DECIMA...  │                                                          │                           │                                                          
└─────────────┬─────────────┘                                                          └─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐                                                          
│         PROJECTION        │                                                          │         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│__internal_compress_integra│                                                          │(sum((CAST(ps_supplycost AS│                                                          
│     l_usmallint(#0, 1)    │                                                          │    DECIMAL(34,2)) * CAST  │                                                          
│__internal_compress_integra│                                                          │(ps_availqty AS DECIMA...  │                                                          
│     l_uinteger(#1, 1)     │                                                          │       * 0.000100000)      │                                                          
│             #2            │                                                          │                           │                                                          
│             #3            │                                                          │                           │                                                          
│__internal_compress_integra│                                                          │                           │                                                          
│     l_usmallint(#4, 1)    │                                                          │                           │                                                          
└─────────────┬─────────────┘                                                          └─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐                                                          
│         HASH_JOIN         │                                                          │    UNGROUPED_AGGREGATE    │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│           INNER           │                                                          │          sum(#0)          │                                                          
│   ps_suppkey = s_suppkey  │                                                          │                           │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐                                           │                           │                                                          
│        Build Min: 1       │              │                                           │                           │                                                          
│      Build Max: 10000     │              │                                           │                           │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                           │                           │                                                          
│         EC: 27811         │              │                                           │                           │                                                          
└─────────────┬─────────────┘              │                                           └─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐                                                          
│         SEQ_SCAN          ││         HASH_JOIN         │                             │         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│          partsupp         ││           INNER           │                             │   (CAST(ps_supplycost AS  │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││ s_nationkey = n_nationkey │                             │    DECIMAL(34,2)) * CAST  │                                                          
│         ps_suppkey        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │(ps_availqty AS DECIMA...  │                                                          
│         ps_partkey        ││        Build Min: 0       ├──────────────┐              │                           │                                                          
│       ps_supplycost       ││       Build Max: 24       │              │              │                           │                                                          
│        ps_availqty        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              │                           │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││          EC: 400          │              │              │                           │                                                          
│         EC: 800000        ││                           │              │              │                           │                                                          
└───────────────────────────┘└─────────────┬─────────────┘              │              └─────────────┬─────────────┘                                                                                       
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                          
                             │         SEQ_SCAN          ││         SEQ_SCAN          ││         HASH_JOIN         │                                                          
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                             │          supplier         ││           nation          ││           INNER           │                                                          
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ps_suppkey = s_suppkey  │                                                          
                             │         s_suppkey         ││        n_nationkey        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                             │        s_nationkey        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││        Build Min: 1       ├──────────────┐                                           
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││ Filters: n_name='GERMANY' ││      Build Max: 10000     │              │                                           
                             │         EC: 10000         ││   AND n_name IS NOT NULL  ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                           
                             │                           ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││         EC: 27811         │              │                                           
                             │                           ││           EC: 1           ││                           │              │                                           
                             └───────────────────────────┘└───────────────────────────┘└─────────────┬─────────────┘              │                                                                        
                                                                                       ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             
                                                                                       │         SEQ_SCAN          ││         HASH_JOIN         │                             
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                                                                                       │          partsupp         ││           INNER           │                             
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││ s_nationkey = n_nationkey │                             
                                                                                       │         ps_suppkey        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐              
                                                                                       │       ps_supplycost       ││        Build Min: 0       │              │              
                                                                                       │        ps_availqty        ││       Build Max: 24       │              │              
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              
                                                                                       │         EC: 800000        ││          EC: 400          │              │              
                                                                                       └───────────────────────────┘└─────────────┬─────────────┘              │                                           
                                                                                                                    ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
                                                                                                                    │         SEQ_SCAN          ││         SEQ_SCAN          │
                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                                                    │          supplier         ││           nation          │
                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                                                    │         s_suppkey         ││        n_nationkey        │
                                                                                                                    │        s_nationkey        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││ Filters: n_name='GERMANY' │
                                                                                                                    │         EC: 10000         ││   AND n_name IS NOT NULL  │
                                                                                                                    │                           ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                                                    │                           ││           EC: 1           │
                                                                                                                    └───────────────────────────┘└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

X {'RESULT_COLLECTOR0': 2.5e-05, 'LIMIT1': 0.000205, 'PROJECTION2': 0.000568, 'ORDER_BY3': 0.007348, 'PROJECTION4': 0.001621, 'PROJECTION5': 3.1e-05, 'PROJECTION6': 0.001904, 'HASH_GROUP_BY7': 0.066729, 'PROJECTION8': 0.000961, 'PROJECTION9': 0.006721, 'HASH_JOIN10': 0.262351, 'SEQ_SCAN 11': 0.215981, 'HASH_JOIN12': 0.054895, 'SEQ_SCAN 13': 0.027465, 'HASH_JOIN14': 0.006939, 'SEQ_SCAN 15': 0.019089, 'SEQ_SCAN 16': 3.4e-05}
**** output size:  20
LINEAGE_5_HASH_GROUP_BY_9
LINEAGE_5_HASH_JOIN_4
LINEAGE_5_HASH_JOIN_5
LINEAGE_5_HASH_JOIN_6
LINEAGE_5_LIMIT_15
LINEAGE_5_ORDER_BY_13
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_1
LINEAGE_5_SEQ_SCAN_2
LINEAGE_5_SEQ_SCAN_3
SELECT c_custkey, c_name, sum(l_extendedprice * (1 - l_discount)) AS revenue, c_acctbal, n_name, c_address, c_phone, c_comment FROM customer, orders, lineitem, nation WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate >= CAST('1993-10-01' AS date) AND o_orderdate < CAST('1994-01-01' AS date) AND l_returnflag = 'R' AND c_nationkey = n_nationkey GROUP BY c_custkey, c_name, c_acctbal, c_phone, n_name, c_address, c_comment ORDER BY revenue DESC LIMIT 20;
   query_id  ...                                               plan
0         5  ...  {"name": "LIMIT", "opid": "15", "children": [{...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               SELECT c_custkey, c_name, sum(l_extendedprice ...
size_bytes_max                                                5314282
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "LIMIT", "opid": "15", "children": [{...
Name: 0, dtype: object
{"name": "LIMIT", "opid": "15", "children": [{"name": "PROJECTION", "opid": "14", "children": [{"name": "ORDER_BY", "opid": "13", "children": [{"name": "PROJECTION", "opid": "12", "children": [{"name": "PROJECTION", "opid": "11", "children": [{"name": "PROJECTION", "opid": "10", "children": [{"name": "HASH_GROUP_BY", "opid": "9", "children": [{"name": "PROJECTION", "opid": "8", "children": [{"name": "PROJECTION", "opid": "7", "children": [{"name": "HASH_JOIN", "opid": "6", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nFilters: l_returnflag='R' AND l_returnflag IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 2000405"},{"name": "HASH_JOIN", "opid": "5", "children": [{"name": "SEQ_SCAN ", "opid": "1", "children": [],"table": "orders","extra": "orders\n[INFOSEPARATOR]\no_custkey\no_orderkey\n[INFOSEPARATOR]\nFilters: o_orderdate>='1993-10-01'::DATE AND o_orderdate<'1994-01-01'::DATE AND o_orderdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 300000"},{"name": "HASH_JOIN", "opid": "4", "children": [{"name": "SEQ_SCAN ", "opid": "2", "children": [],"table": "customer","extra": "customer\n[INFOSEPARATOR]\nc_custkey\nc_nationkey\nc_name\nc_acctbal\nc_phone\nc_address\nc_comment\n[INFOSEPARATOR]\nFilters: c_custkey<=149999 AND c_custkey IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 150000"},{"name": "SEQ_SCAN ", "opid": "3", "children": [],"table": "nation","extra": "nation\n[INFOSEPARATOR]\nn_nationkey\nn_name\n[INFOSEPARATOR]\nEC: 25"}],"table": "","extra": "INNER\nc_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nEC: 150000\n"}],"table": "","extra": "INNER\no_custkey = c_custkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 149999\n\n[INFOSEPARATOR]\nEC: 180897\n"}],"table": "","extra": "INNER\nl_orderkey = o_orderkey\n\n[INFOSEPARATOR]\nEC: 241245\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n#1\n#2\n__internal_compress_integral_uinteger(#3, 1)\n__internal_compress_integral_uinteger(#4, 1)\n#5\n#6\n__internal_compress_string_hugeint(#7)\n#8\n#9\n__internal_compress_string_hugeint(#10)\n"}],"table": "","extra": "c_custkey\nc_name\nc_acctbal\nc_phone\nn_name\nc_address\nc_comment\n(l_extendedprice * (1.00 - l_discount))\n"}],"table": "","extra": "#0\n#1\n#2\n#3\n#4\n#5\n#6\nsum(#7)"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n#1\n#2\n__internal_decompress_string(#3)\n__internal_decompress_string(#4)\n#5\n#6\n#7\n"}],"table": "","extra": "c_custkey\nc_name\nrevenue\nc_acctbal\nn_name\nc_address\nc_phone\nc_comment\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n#1\n#2\n#3\n__internal_compress_string_hugeint(#4)\n#5\n__internal_compress_string_hugeint(#6)\n#7\n"}],"table": "","extra": "ORDERS:\nsum((lineitem.l_extendedprice * (1 - lineitem.l_discount))) DESC"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n#1\n#2\n#3\n__internal_decompress_string(#4)\n#5\n__internal_decompress_string(#6)\n#7\n"}],"table": "","extra": ""}
%%%%%%%%%%%%%%%% Running Query #  11  threads:  4
SELECT ps_partkey, sum(ps_supplycost * ps_availqty) AS value FROM partsupp, supplier, nation WHERE ps_suppkey = s_suppkey AND s_nationkey = n_nationkey AND n_name = 'GERMANY' GROUP BY ps_partkey HAVING sum(ps_supplycost * ps_availqty) > ( SELECT sum(ps_supplycost * ps_availqty) * 0.000100000 FROM partsupp, supplier, nation WHERE ps_suppkey = s_suppkey AND s_nationkey = n_nationkey AND n_name = 'GERMANY') ORDER BY value DESC;
Run:  None SELECT ps_partkey, sum(ps_supplycost * ps_availqty) AS value FROM partsupp, supplier, nation WHERE ps_suppkey = s_suppkey AND s_nationkey = n_nationkey AND n_name = 'GERMANY' GROUP BY ps_partkey HAVING sum(ps_supplycost * ps_availqty) > ( SELECT sum(ps_supplycost * ps_availqty) * 0.000100000 FROM partsupp, supplier, nation WHERE ps_suppkey = s_suppkey AND s_nationkey = n_nationkey AND n_name = 'GERMANY') ORDER BY value DESC;
Avg Time in sec:  0.0269054202362895  output size:  1048
      ps_partkey        value
0         129760  17538456.86
1         166726  16503353.92
2         191287  16474801.97
3         161758  16101755.54
4          34452  15983844.72
...          ...          ...
1043      154731   7888301.33
1044      101674   7879324.60
1045       51968   7879102.21
1046       72073   7877736.11
1047        5182   7874521.73

[1048 rows x 2 columns]
{'name': 'Query', 'result': 0.02166, 'timing': 0.02166, 'cardinality': 0, 'extra-info': "SELECT ps_partkey, sum(ps_supplycost * ps_availqty) AS value FROM partsupp, supplier, nation WHERE ps_suppkey = s_suppkey AND s_nationkey = n_nationkey AND n_name = 'GERMANY' GROUP BY ps_partkey HAVING sum(ps_supplycost * ps_availqty) > ( SELECT sum(ps_supplycost * ps_availqty) * 0.000100000 FROM partsupp, supplier, nation WHERE ps_suppkey = s_suppkey AND s_nationkey = n_nationkey AND n_name = 'GERMANY') ORDER BY value DESC;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 1.6e-05, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 1.2e-05, 'cardinality': 1048, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n#1\n', 'children': [{'name': 'ORDER_BY', 'timing': 0.000215, 'cardinality': 1048, 'extra_info': 'ORDERS:\nsum((partsupp.ps_supplycost * partsupp.ps_availqty)) DESC', 'children': [{'name': 'PROJECTION', 'timing': 3.4e-05, 'cardinality': 1048, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n#1\n', 'children': [{'name': 'PROJECTION', 'timing': 8e-06, 'cardinality': 1048, 'extra_info': 'ps_partkey\nvalue\n', 'children': [{'name': 'NESTED_LOOP_JOIN', 'timing': 0.001457, 'cardinality': 1048, 'extra_info': 'INNER\nCAST(sum((CAST(ps_supplycost AS DECIMAL(34,2)) * CAST(ps_availqty AS DECIMAL(34,0)))) AS DECIMAL(38,11)) > SUBQUERY\n\n[INFOSEPARATOR]\nEC: 1\n', 'children': [{'name': 'PROJECTION', 'timing': 6.2e-05, 'cardinality': 29818, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n#1\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.011855, 'cardinality': 29818, 'extra_info': '#0\nsum(#1)', 'children': [{'name': 'PROJECTION', 'timing': 0.008635, 'cardinality': 31680, 'extra_info': 'ps_partkey\n(CAST(ps_supplycost AS DECIMAL(34,2)) * CAST(ps_availqty AS DECIMAL(34,0)))\n', 'children': [{'name': 'PROJECTION', 'timing': 0.002164, 'cardinality': 31680, 'extra_info': '__internal_compress_integral_usmallint(#0, 1)\n__internal_compress_integral_uinteger(#1, 1)\n#2\n#3\n__internal_compress_integral_usmallint(#4, 1)\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.006898, 'cardinality': 31680, 'extra_info': 'INNER\nps_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 27811\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.002377, 'cardinality': 800000, 'extra_info': 'partsupp\n[INFOSEPARATOR]\nps_suppkey\nps_partkey\nps_supplycost\nps_availqty\n[INFOSEPARATOR]\nEC: 800000', 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.000252, 'cardinality': 396, 'extra_info': 'INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 400\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 8.5e-05, 'cardinality': 10000, 'extra_info': 'supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\n[INFOSEPARATOR]\nEC: 10000', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 4.8e-05, 'cardinality': 1, 'extra_info': "nation\n[INFOSEPARATOR]\nn_nationkey\n[INFOSEPARATOR]\nFilters: n_name='GERMANY' AND n_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1", 'children': []}]}]}]}]}]}]}, {'name': 'UNGROUPED_AGGREGATE', 'timing': 3e-06, 'cardinality': 1, 'extra_info': 'first(#0)', 'children': [{'name': 'PROJECTION', 'timing': 0.0, 'cardinality': 1, 'extra_info': '#0\n', 'children': [{'name': 'STREAMING_LIMIT', 'timing': 3e-06, 'cardinality': 1, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 4e-06, 'cardinality': 1, 'extra_info': '(sum((CAST(ps_supplycost AS DECIMAL(34,2)) * CAST(ps_availqty AS DECIMAL(34,0)))) * 0.000100000)\n', 'children': [{'name': 'UNGROUPED_AGGREGATE', 'timing': 0.000879, 'cardinality': 1, 'extra_info': 'sum(#0)', 'children': [{'name': 'PROJECTION', 'timing': 0.012195, 'cardinality': 31680, 'extra_info': '(CAST(ps_supplycost AS DECIMAL(34,2)) * CAST(ps_availqty AS DECIMAL(34,0)))\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.009537, 'cardinality': 31680, 'extra_info': 'INNER\nps_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 27811\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.003097, 'cardinality': 800000, 'extra_info': 'partsupp\n[INFOSEPARATOR]\nps_suppkey\nps_supplycost\nps_availqty\n[INFOSEPARATOR]\nEC: 800000', 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.000117, 'cardinality': 396, 'extra_info': 'INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 400\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 4.4e-05, 'cardinality': 10000, 'extra_info': 'supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\n[INFOSEPARATOR]\nEC: 10000', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 3.8e-05, 'cardinality': 1, 'extra_info': "nation\n[INFOSEPARATOR]\nn_nationkey\n[INFOSEPARATOR]\nFilters: n_name='GERMANY' AND n_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1", 'children': []}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}
compressed filter_log_size: 1744
compressed filter_log_buffer_size: 0
compressed limit_offset_size: 1888
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 5704
compressed perfect_full_scan_ht_log_buffer_size: 2424
compressed perfect_probe_ht_log_size: 310702
compressed perfect_probe_ht_log_buffer_size: 294442
compressed row_group_log_size: 9860
compressed row_group_log_buffer_size: 8
compressed scatter_log_size: 117183
compressed scatter_log_buffer_size: 113010
compressed scatter_sel_log_size: 7277
compressed scatter_sel_log_buffer_size: 4529
compressed gather_log_size: 1744
compressed gather_log_buffer_size: 0
compressed combine_log_size: 5404
compressed combine_log_buffer_size: 2972
compressed finalize_states_log_size: 15110
compressed finalize_states_log_buffer_size: 12761
compressed join_gather_log_size: 1744
compressed join_gather_log_buffer_size: 0
compressed reorder_log_size: 4139
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 1744
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 6365
compressed nlj_log_buffer_size: 2837
compressed total_size: 490608
compressed total_buffer_size: 432983
compressed total_element_size: 57625

Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│__internal_decompress_strin│                             
│           g(#0)           │                             
│             #1            │                             
│             #2            │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│          ORDER_BY         │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│          ORDERS:          │                             
│  lineitem.l_shipmode ASC  │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│__internal_compress_string_│                             
│        ubigint(#0)        │                             
│             #1            │                             
│             #2            │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│__internal_decompress_strin│                             
│           g(#0)           │                             
│             #1            │                             
│             #2            │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│       HASH_GROUP_BY       │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│             #0            │                             
│          sum(#1)          │                             
│          sum(#2)          │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│         l_shipmode        │                             
│       CASE  WHEN ((       │                             
│(o_orderpriority = '1-...  │                             
│(o_orderpriority = '2-...  │                             
│     THEN (1) ELSE 0 END   │                             
│       CASE  WHEN ((       │                             
│(o_orderpriority != '1...  │                             
│(o_orderpriority != '2...  │                             
│     THEN (1) ELSE 0 END   │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│__internal_compress_integra│                             
│     l_uinteger(#0, 1)     │                             
│             #1            │                             
│__internal_compress_integra│                             
│     l_uinteger(#2, 1)     │                             
│__internal_compress_string_│                             
│        ubigint(#3)        │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         HASH_JOIN         │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│           INNER           │                             
│  o_orderkey = l_orderkey  ├──────────────┐              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              
│         EC: 240048        │              │              
└─────────────┬─────────────┘              │                                           
┌─────────────┴─────────────┐┌─────────────┴─────────────┐
│         SEQ_SCAN          ││           FILTER          │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│           orders          ││      ((l_commitdate <     │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││ l_receiptdate) AND (l...  │
│         o_orderkey        ││ l_commitdate) AND ((l...  │
│      o_orderpriority      ││= 'MAIL') OR (l_shipmode = │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││         'SHIP')))         │
│        EC: 1500000        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│                           ││         EC: 240048        │
└───────────────────────────┘└─────────────┬─────────────┘                             
                             ┌─────────────┴─────────────┐
                             │         SEQ_SCAN          │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                             │          lineitem         │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                             │         l_orderkey        │
                             │         l_shipmode        │
                             │        l_commitdate       │
                             │       l_receiptdate       │
                             │         l_shipdate        │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                             │  Filters: l_receiptdate>= │
                             │   '1994-01-01'::DATE AND  │
                             │ l_receiptdate<'1995-0...  │
                             │  AND l_receiptdate IS NOT │
                             │            NULL           │
                             │ l_commitdate<'1995-01-01':│
                             │ :DATE AND l_commitdate IS │
                             │          NOT NULL         │
                             │  l_shipdate<'1995-01-01': │
                             │:DATE AND l_shipdate IS NOT│
                             │            NULL           │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                             │         EC: 240048        │
                             └───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

X {'RESULT_COLLECTOR0': 1.6e-05, 'PROJECTION1': 1.2e-05, 'ORDER_BY2': 0.000215, 'PROJECTION3': 3.4e-05, 'PROJECTION4': 8e-06, 'NESTED_LOOP_JOIN5': 0.001457, 'PROJECTION6': 6.2e-05, 'HASH_GROUP_BY7': 0.011855, 'PROJECTION8': 0.008635, 'PROJECTION9': 0.002164, 'HASH_JOIN10': 0.006898, 'SEQ_SCAN 11': 0.002377, 'HASH_JOIN12': 0.000252, 'SEQ_SCAN 13': 8.5e-05, 'SEQ_SCAN 14': 4.8e-05, 'UNGROUPED_AGGREGATE15': 3e-06, 'PROJECTION16': 0.0, 'STREAMING_LIMIT17': 3e-06, 'PROJECTION18': 4e-06, 'UNGROUPED_AGGREGATE19': 0.000879, 'PROJECTION20': 0.012195, 'HASH_JOIN21': 0.009537, 'SEQ_SCAN 22': 0.003097, 'HASH_JOIN23': 0.000117, 'SEQ_SCAN 24': 4.4e-05, 'SEQ_SCAN 25': 3.8e-05}
**** output size:  1048
LINEAGE_5_HASH_GROUP_BY_7
LINEAGE_5_HASH_JOIN_12
LINEAGE_5_HASH_JOIN_13
LINEAGE_5_HASH_JOIN_3
LINEAGE_5_HASH_JOIN_4
LINEAGE_5_NESTED_LOOP_JOIN_20
LINEAGE_5_ORDER_BY_23
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_1
LINEAGE_5_SEQ_SCAN_10
LINEAGE_5_SEQ_SCAN_11
LINEAGE_5_SEQ_SCAN_2
LINEAGE_5_SEQ_SCAN_9
LINEAGE_5_STREAMING_LIMIT_17
SELECT ps_partkey, sum(ps_supplycost * ps_availqty) AS value FROM partsupp, supplier, nation WHERE ps_suppkey = s_suppkey AND s_nationkey = n_nationkey AND n_name = 'GERMANY' GROUP BY ps_partkey HAVING sum(ps_supplycost * ps_availqty) > ( SELECT sum(ps_supplycost * ps_availqty) * 0.000100000 FROM partsupp, supplier, nation WHERE ps_suppkey = s_suppkey AND s_nationkey = n_nationkey AND n_name = 'GERMANY') ORDER BY value DESC;
   query_id  ...                                               plan
0         5  ...  {"name": "PROJECTION", "opid": "24", "children...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               SELECT ps_partkey, sum(ps_supplycost * ps_avai...
size_bytes_max                                                 490608
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "PROJECTION", "opid": "24", "children...
Name: 0, dtype: object
{"name": "PROJECTION", "opid": "24", "children": [{"name": "ORDER_BY", "opid": "23", "children": [{"name": "PROJECTION", "opid": "22", "children": [{"name": "PROJECTION", "opid": "21", "children": [{"name": "NESTED_LOOP_JOIN", "opid": "20", "children": [{"name": "PROJECTION", "opid": "8", "children": [{"name": "HASH_GROUP_BY", "opid": "7", "children": [{"name": "PROJECTION", "opid": "6", "children": [{"name": "PROJECTION", "opid": "5", "children": [{"name": "HASH_JOIN", "opid": "4", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "partsupp","extra": "partsupp\n[INFOSEPARATOR]\nps_suppkey\nps_partkey\nps_supplycost\nps_availqty\n[INFOSEPARATOR]\nEC: 800000"},{"name": "HASH_JOIN", "opid": "3", "children": [{"name": "SEQ_SCAN ", "opid": "1", "children": [],"table": "supplier","extra": "supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\n[INFOSEPARATOR]\nEC: 10000"},{"name": "SEQ_SCAN ", "opid": "2", "children": [],"table": "nation","extra": "nation\n[INFOSEPARATOR]\nn_nationkey\n[INFOSEPARATOR]\nFilters: n_name='GERMANY' AND n_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1"}],"table": "","extra": "INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 400\n"}],"table": "","extra": "INNER\nps_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 27811\n"}],"table": "","extra": "__internal_compress_integral_usmallint(#0, 1)\n__internal_compress_integral_uinteger(#1, 1)\n#2\n#3\n__internal_compress_integral_usmallint(#4, 1)\n"}],"table": "","extra": "ps_partkey\n(CAST(ps_supplycost AS DECIMAL(34,2)) * CAST(ps_availqty AS DECIMAL(34,0)))\n"}],"table": "","extra": "#0\nsum(#1)"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n#1\n"},{"name": "UNGROUPED_AGGREGATE", "opid": "19", "children": [{"name": "PROJECTION", "opid": "18", "children": [{"name": "STREAMING_LIMIT", "opid": "17", "children": [{"name": "PROJECTION", "opid": "16", "children": [{"name": "UNGROUPED_AGGREGATE", "opid": "15", "children": [{"name": "PROJECTION", "opid": "14", "children": [{"name": "HASH_JOIN", "opid": "13", "children": [{"name": "SEQ_SCAN ", "opid": "9", "children": [],"table": "partsupp","extra": "partsupp\n[INFOSEPARATOR]\nps_suppkey\nps_supplycost\nps_availqty\n[INFOSEPARATOR]\nEC: 800000"},{"name": "HASH_JOIN", "opid": "12", "children": [{"name": "SEQ_SCAN ", "opid": "10", "children": [],"table": "supplier","extra": "supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\n[INFOSEPARATOR]\nEC: 10000"},{"name": "SEQ_SCAN ", "opid": "11", "children": [],"table": "nation","extra": "nation\n[INFOSEPARATOR]\nn_nationkey\n[INFOSEPARATOR]\nFilters: n_name='GERMANY' AND n_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1"}],"table": "","extra": "INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 400\n"}],"table": "","extra": "INNER\nps_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 27811\n"}],"table": "","extra": "(CAST(ps_supplycost AS DECIMAL(34,2)) * CAST(ps_availqty AS DECIMAL(34,0)))\n"}],"table": "","extra": "sum(#0)"}],"table": "","extra": "(sum((CAST(ps_supplycost AS DECIMAL(34,2)) * CAST(ps_availqty AS DECIMAL(34,0)))) * 0.000100000)\n"}],"table": "","extra": ""}],"table": "","extra": "#0\n"}],"table": "","extra": "first(#0)"}],"table": "","extra": "INNER\nCAST(sum((CAST(ps_supplycost AS DECIMAL(34,2)) * CAST(ps_availqty AS DECIMAL(34,0)))) AS DECIMAL(38,11)) > SUBQUERY\n\n[INFOSEPARATOR]\nEC: 1\n"}],"table": "","extra": "ps_partkey\nvalue\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n#1\n"}],"table": "","extra": "ORDERS:\nsum((partsupp.ps_supplycost * partsupp.ps_availqty)) DESC"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n#1\n"}
%%%%%%%%%%%%%%%% Running Query #  12  threads:  4
SELECT l_shipmode, sum( CASE WHEN o_orderpriority = '1-URGENT' OR o_orderpriority = '2-HIGH' THEN 1 ELSE 0 END) AS high_line_count, sum( CASE WHEN o_orderpriority <> '1-URGENT' AND o_orderpriority <> '2-HIGH' THEN 1 ELSE 0 END) AS low_line_count FROM orders, lineitem WHERE o_orderkey = l_orderkey AND l_shipmode IN ('MAIL', 'SHIP') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= CAST('1994-01-01' AS date) AND l_receiptdate < CAST('1995-01-01' AS date) GROUP BY l_shipmode ORDER BY l_shipmode;
Run:  None SELECT l_shipmode, sum( CASE WHEN o_orderpriority = '1-URGENT' OR o_orderpriority = '2-HIGH' THEN 1 ELSE 0 END) AS high_line_count, sum( CASE WHEN o_orderpriority <> '1-URGENT' AND o_orderpriority <> '2-HIGH' THEN 1 ELSE 0 END) AS low_line_count FROM orders, lineitem WHERE o_orderkey = l_orderkey AND l_shipmode IN ('MAIL', 'SHIP') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= CAST('1994-01-01' AS date) AND l_receiptdate < CAST('1995-01-01' AS date) GROUP BY l_shipmode ORDER BY l_shipmode;
Avg Time in sec:  0.1091117411851883  output size:  2
  l_shipmode  high_line_count  low_line_count
0       MAIL           6202.0          9324.0
1       SHIP           6200.0          9262.0
{'name': 'Query', 'result': 0.103655, 'timing': 0.103655, 'cardinality': 0, 'extra-info': "SELECT l_shipmode, sum( CASE WHEN o_orderpriority = '1-URGENT' OR o_orderpriority = '2-HIGH' THEN 1 ELSE 0 END) AS high_line_count, sum( CASE WHEN o_orderpriority <> '1-URGENT' AND o_orderpriority <> '2-HIGH' THEN 1 ELSE 0 END) AS low_line_count FROM orders, lineitem WHERE o_orderkey = l_orderkey AND l_shipmode IN ('MAIL', 'SHIP') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= CAST('1994-01-01' AS date) AND l_receiptdate < CAST('1995-01-01' AS date) GROUP BY l_shipmode ORDER BY l_shipmode;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 9e-06, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 1.4e-05, 'cardinality': 2, 'extra_info': '__internal_decompress_string(#0)\n#1\n#2\n', 'children': [{'name': 'ORDER_BY', 'timing': 6.2e-05, 'cardinality': 2, 'extra_info': 'ORDERS:\nlineitem.l_shipmode ASC', 'children': [{'name': 'PROJECTION', 'timing': 2e-06, 'cardinality': 2, 'extra_info': '__internal_compress_string_ubigint(#0)\n#1\n#2\n', 'children': [{'name': 'PROJECTION', 'timing': 4e-06, 'cardinality': 2, 'extra_info': '__internal_decompress_string(#0)\n#1\n#2\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.003481, 'cardinality': 2, 'extra_info': '#0\nsum(#1)\nsum(#2)', 'children': [{'name': 'PROJECTION', 'timing': 0.001146, 'cardinality': 30988, 'extra_info': "l_shipmode\nCASE  WHEN (((o_orderpriority = '1-URGENT') OR (o_orderpriority = '2-HIGH'))) THEN (1) ELSE 0 END\nCASE  WHEN (((o_orderpriority != '1-URGENT') AND (o_orderpriority != '2-HIGH'))) THEN (1) ELSE 0 END\n", 'children': [{'name': 'PROJECTION', 'timing': 0.000422, 'cardinality': 30988, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n#1\n__internal_compress_integral_uinteger(#2, 1)\n__internal_compress_string_ubigint(#3)\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.054738, 'cardinality': 30988, 'extra_info': 'INNER\no_orderkey = l_orderkey\n\n[INFOSEPARATOR]\nEC: 240048\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.046578, 'cardinality': 1500000, 'extra_info': 'orders\n[INFOSEPARATOR]\no_orderkey\no_orderpriority\n[INFOSEPARATOR]\nEC: 1500000', 'children': []}, {'name': 'FILTER', 'timing': 0.042742, 'cardinality': 30988, 'extra_info': "((l_commitdate < l_receiptdate) AND (l_shipdate < l_commitdate) AND ((l_shipmode = 'MAIL') OR (l_shipmode = 'SHIP')))\n[INFOSEPARATOR]\nEC: 240048", 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.231237, 'cardinality': 885773, 'extra_info': "lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_shipmode\nl_commitdate\nl_receiptdate\nl_shipdate\n[INFOSEPARATOR]\nFilters: l_receiptdate>='1994-01-01'::DATE AND l_receiptdate<'1995-01-01'::DATE AND l_receiptdate IS NOT NULL\nl_commitdate<'1995-01-01'::DATE AND l_commitdate IS NOT NULL\nl_shipdate<'1995-01-01'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 240048", 'children': []}]}]}]}]}]}]}]}]}]}]}]}
compressed filter_log_size: 160274
compressed filter_log_buffer_size: 125456
compressed limit_offset_size: 1088
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 1088
compressed perfect_full_scan_ht_log_buffer_size: 0
compressed perfect_probe_ht_log_size: 1088
compressed perfect_probe_ht_log_buffer_size: 0
compressed row_group_log_size: 685901
compressed row_group_log_buffer_size: 635605
compressed scatter_log_size: 87604
compressed scatter_log_buffer_size: 85917
compressed scatter_sel_log_size: 121783
compressed scatter_sel_log_buffer_size: 119671
compressed gather_log_size: 1088
compressed gather_log_buffer_size: 0
compressed combine_log_size: 1534
compressed combine_log_buffer_size: 128
compressed finalize_states_log_size: 1392
compressed finalize_states_log_buffer_size: 16
compressed join_gather_log_size: 323680
compressed join_gather_log_buffer_size: 288968
compressed reorder_log_size: 1792
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 1088
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 1088
compressed nlj_log_buffer_size: 0
compressed total_size: 1390488
compressed total_buffer_size: 1255761
compressed total_element_size: 134727

Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                             
│          ORDER_BY         │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│          ORDERS:          │                             
│     count_star() DESC     │                             
│   c_orders.c_count DESC   │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│       HASH_GROUP_BY       │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│             #0            │                             
│        count_star()       │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│          c_count          │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│     count(o_orderkey)     │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│__internal_decompress_integ│                             
│     ral_bigint(#0, 1)     │                             
│             #1            │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│       HASH_GROUP_BY       │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│             #0            │                             
│         count(#1)         │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│         c_custkey         │                             
│         o_orderkey        │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│__internal_compress_integra│                             
│     l_uinteger(#0, 1)     │                             
│             #1            │                             
│             #2            │                             
│__internal_compress_integra│                             
│     l_uinteger(#3, 1)     │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         HASH_JOIN         │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│           RIGHT           │                             
│   o_custkey = c_custkey   ├──────────────┐              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              
│         EC: 300000        │              │              
└─────────────┬─────────────┘              │                                           
┌─────────────┴─────────────┐┌─────────────┴─────────────┐
│           FILTER          ││         SEQ_SCAN          │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│  (o_comment !~~ '%special ││          customer         │
│        %requests%')       ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││         c_custkey         │
│         EC: 300000        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│                           ││         EC: 150000        │
└─────────────┬─────────────┘└───────────────────────────┘                             
┌─────────────┴─────────────┐                             
│         SEQ_SCAN          │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│           orders          │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│         o_custkey         │                             
│         o_comment         │                             
│         o_orderkey        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│        EC: 1500000        │                             
└───────────────────────────┘                                                          

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

X {'RESULT_COLLECTOR0': 9e-06, 'PROJECTION1': 1.4e-05, 'ORDER_BY2': 6.2e-05, 'PROJECTION3': 2e-06, 'PROJECTION4': 4e-06, 'HASH_GROUP_BY5': 0.003481, 'PROJECTION6': 0.001146, 'PROJECTION7': 0.000422, 'HASH_JOIN8': 0.054738, 'SEQ_SCAN 9': 0.046578, 'FILTER10': 0.042742, 'SEQ_SCAN 11': 0.231237}
**** output size:  2
LINEAGE_5_FILTER_2
LINEAGE_5_HASH_GROUP_BY_6
LINEAGE_5_HASH_JOIN_3
LINEAGE_5_ORDER_BY_9
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_1
SELECT l_shipmode, sum( CASE WHEN o_orderpriority = '1-URGENT' OR o_orderpriority = '2-HIGH' THEN 1 ELSE 0 END) AS high_line_count, sum( CASE WHEN o_orderpriority <> '1-URGENT' AND o_orderpriority <> '2-HIGH' THEN 1 ELSE 0 END) AS low_line_count FROM orders, lineitem WHERE o_orderkey = l_orderkey AND l_shipmode IN ('MAIL', 'SHIP') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= CAST('1994-01-01' AS date) AND l_receiptdate < CAST('1995-01-01' AS date) GROUP BY l_shipmode ORDER BY l_shipmode;
   query_id  ...                                               plan
0         5  ...  {"name": "PROJECTION", "opid": "10", "children...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               SELECT l_shipmode, sum( CASE WHEN o_orderprior...
size_bytes_max                                                1390488
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "PROJECTION", "opid": "10", "children...
Name: 0, dtype: object
{"name": "PROJECTION", "opid": "10", "children": [{"name": "ORDER_BY", "opid": "9", "children": [{"name": "PROJECTION", "opid": "8", "children": [{"name": "PROJECTION", "opid": "7", "children": [{"name": "HASH_GROUP_BY", "opid": "6", "children": [{"name": "PROJECTION", "opid": "5", "children": [{"name": "PROJECTION", "opid": "4", "children": [{"name": "HASH_JOIN", "opid": "3", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "orders","extra": "orders\n[INFOSEPARATOR]\no_orderkey\no_orderpriority\n[INFOSEPARATOR]\nEC: 1500000"},{"name": "FILTER", "opid": "2", "children": [{"name": "SEQ_SCAN ", "opid": "1", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_shipmode\nl_commitdate\nl_receiptdate\nl_shipdate\n[INFOSEPARATOR]\nFilters: l_receiptdate>='1994-01-01'::DATE AND l_receiptdate<'1995-01-01'::DATE AND l_receiptdate IS NOT NULL\nl_commitdate<'1995-01-01'::DATE AND l_commitdate IS NOT NULL\nl_shipdate<'1995-01-01'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 240048"}],"table": "","extra": "((l_commitdate < l_receiptdate) AND (l_shipdate < l_commitdate) AND ((l_shipmode = 'MAIL') OR (l_shipmode = 'SHIP')))\n[INFOSEPARATOR]\nEC: 240048"}],"table": "","extra": "INNER\no_orderkey = l_orderkey\n\n[INFOSEPARATOR]\nEC: 240048\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n#1\n__internal_compress_integral_uinteger(#2, 1)\n__internal_compress_string_ubigint(#3)\n"}],"table": "","extra": "l_shipmode\nCASE  WHEN (((o_orderpriority = '1-URGENT') OR (o_orderpriority = '2-HIGH'))) THEN (1) ELSE 0 END\nCASE  WHEN (((o_orderpriority != '1-URGENT') AND (o_orderpriority != '2-HIGH'))) THEN (1) ELSE 0 END\n"}],"table": "","extra": "#0\nsum(#1)\nsum(#2)"}],"table": "","extra": "__internal_decompress_string(#0)\n#1\n#2\n"}],"table": "","extra": "__internal_compress_string_ubigint(#0)\n#1\n#2\n"}],"table": "","extra": "ORDERS:\nlineitem.l_shipmode ASC"}],"table": "","extra": "__internal_decompress_string(#0)\n#1\n#2\n"}
%%%%%%%%%%%%%%%% Running Query #  13  threads:  4
SELECT c_count, count(*) AS custdist FROM ( SELECT c_custkey, count(o_orderkey) FROM customer LEFT OUTER JOIN orders ON c_custkey = o_custkey AND o_comment NOT LIKE '%special%requests%' GROUP BY c_custkey) AS c_orders (c_custkey, c_count) GROUP BY c_count ORDER BY custdist DESC, c_count DESC;
Run:  None SELECT c_count, count(*) AS custdist FROM ( SELECT c_custkey, count(o_orderkey) FROM customer LEFT OUTER JOIN orders ON c_custkey = o_custkey AND o_comment NOT LIKE '%special%requests%' GROUP BY c_custkey) AS c_orders (c_custkey, c_count) GROUP BY c_count ORDER BY custdist DESC, c_count DESC;
Avg Time in sec:  0.19316020887345076  output size:  42
    c_count  custdist
0         0     50004
1        10      6668
2         9      6563
3        11      6004
4         8      5890
5        12      5600
6        13      5029
7        19      4805
8         7      4680
9        18      4531
10       20      4507
11       14      4473
12       15      4463
13       17      4445
14       16      4410
15       21      4168
16       22      3742
17        6      3273
18       23      3189
19       24      2700
20       25      2090
21        5      1957
22       26      1653
23       27      1177
24        4      1010
25       28       901
26       29       564
27        3       408
28       30       378
29       31       242
30       32       133
31        2       128
32       33        72
33       34        52
34       35        32
35       36        20
36        1        20
37       37         8
38       38         4
39       41         3
40       40         3
41       39         1
{'name': 'Query', 'result': 0.18653, 'timing': 0.18653, 'cardinality': 0, 'extra-info': "SELECT c_count, count(*) AS custdist FROM ( SELECT c_custkey, count(o_orderkey) FROM customer LEFT OUTER JOIN orders ON c_custkey = o_custkey AND o_comment NOT LIKE '%special%requests%' GROUP BY c_custkey) AS c_orders (c_custkey, c_count) GROUP BY c_count ORDER BY custdist DESC, c_count DESC;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 9e-06, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'ORDER_BY', 'timing': 9e-05, 'cardinality': 42, 'extra_info': 'ORDERS:\ncount_star() DESC\nc_orders.c_count DESC', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.006754, 'cardinality': 42, 'extra_info': '#0\ncount_star()', 'children': [{'name': 'PROJECTION', 'timing': 1.7e-05, 'cardinality': 150000, 'extra_info': 'c_count\n', 'children': [{'name': 'PROJECTION', 'timing': 2e-05, 'cardinality': 150000, 'extra_info': 'count(o_orderkey)\n', 'children': [{'name': 'PROJECTION', 'timing': 0.000181, 'cardinality': 150000, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n#1\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.248203, 'cardinality': 150000, 'extra_info': '#0\ncount(#1)', 'children': [{'name': 'PROJECTION', 'timing': 0.000713, 'cardinality': 1534302, 'extra_info': 'c_custkey\no_orderkey\n', 'children': [{'name': 'PROJECTION', 'timing': 0.006373, 'cardinality': 1534302, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n#1\n#2\n__internal_compress_integral_uinteger(#3, 1)\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.194602, 'cardinality': 1534302, 'extra_info': 'RIGHT\no_custkey = c_custkey\n\n[INFOSEPARATOR]\nEC: 300000\n', 'children': [{'name': 'FILTER', 'timing': 0.122557, 'cardinality': 1484298, 'extra_info': "(o_comment !~~ '%special%requests%')\n[INFOSEPARATOR]\nEC: 300000", 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.065592, 'cardinality': 1500000, 'extra_info': 'orders\n[INFOSEPARATOR]\no_custkey\no_comment\no_orderkey\n[INFOSEPARATOR]\nEC: 1500000', 'children': []}]}, {'name': 'SEQ_SCAN ', 'timing': 0.000295, 'cardinality': 150000, 'extra_info': 'customer\n[INFOSEPARATOR]\nc_custkey\n[INFOSEPARATOR]\nEC: 150000', 'children': []}]}]}]}]}]}]}]}]}]}]}]}
X {'RESULT_COLLECTOR0': 9e-06, 'ORDER_BY1': 9e-05, 'HASH_GROUP_BY2': 0.006754, 'PROJECTION3': 1.7e-05, 'PROJECTION4': 2e-05, 'PROJECTION5': 0.000181, 'HASH_GROUP_BY6': 0.248203, 'PROJECTION7': 0.000713, 'PROJECTION8': 0.006373, 'HASH_JOIN9': 0.194602, 'FILTER10': 0.122557, 'SEQ_SCAN 11': 0.065592, 'SEQ_SCAN 12': 0.000295}
**** output size:  42
LINEAGE_5_FILTER_1
LINEAGE_5_HASH_GROUP_BY_10
LINEAGE_5_HASH_GROUP_BY_6
LINEAGE_5_HASH_JOIN_3
LINEAGE_5_ORDER_BY_11
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_2
SELECT c_count, count(*) AS custdist FROM ( SELECT c_custkey, count(o_orderkey) FROM customer LEFT OUTER JOIN orders ON c_custkey = o_custkey AND o_comment NOT LIKE '%special%requests%' GROUP BY c_custkey) AS c_orders (c_custkey, c_count) GROUP BY c_count ORDER BY custdist DESC, c_count DESC;
compressed filter_log_size: 78122
compressed filter_log_buffer_size: 68140
compressed limit_offset_size: 1152
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 1152
compressed perfect_full_scan_ht_log_buffer_size: 0
compressed perfect_probe_ht_log_size: 1152
compressed perfect_probe_ht_log_buffer_size: 0
compressed row_group_log_size: 7720
compressed row_group_log_buffer_size: 0
compressed scatter_log_size: 5540857
compressed scatter_log_buffer_size: 5529909
compressed scatter_sel_log_size: 574958
compressed scatter_sel_log_buffer_size: 572486
compressed gather_log_size: 1152
compressed gather_log_buffer_size: 0
compressed combine_log_size: 17090526
compressed combine_log_buffer_size: 17084924
compressed finalize_states_log_size: 71429
compressed finalize_states_log_buffer_size: 68725
compressed join_gather_log_size: 6524164
compressed join_gather_log_buffer_size: 6476961
compressed reorder_log_size: 2048
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 1152
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 1152
compressed nlj_log_buffer_size: 0
compressed total_size: 29896736
compressed total_buffer_size: 29801145
compressed total_element_size: 95591

Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│       promo_revenue       │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│    UNGROUPED_AGGREGATE    │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│          sum(#0)          │                             
│          sum(#1)          │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│CASE  WHEN (prefix(p_type, │                             
│      'PROMO')) THEN (     │                             
│(l_extendedprice * (1....  │                             
│     )) ELSE 0.0000 END    │                             
│ (l_extendedprice * (1.00 -│                             
│        l_discount))       │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         HASH_JOIN         │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│           INNER           │                             
│   l_partkey = p_partkey   │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐              
│        Build Min: 1       │              │              
│     Build Max: 200000     │              │              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              
│         EC: 641407        │              │              
└─────────────┬─────────────┘              │                                           
┌─────────────┴─────────────┐┌─────────────┴─────────────┐
│         SEQ_SCAN          ││         SEQ_SCAN          │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│          lineitem         ││            part           │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│         l_partkey         ││         p_partkey         │
│      l_extendedprice      ││           p_type          │
│         l_discount        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││         EC: 200000        │
│ Filters: l_shipdate>='1995││                           │
│-09-01'::DATE AND l_sh...  ││                           │
│  <'1995-10-01'::DATE AND  ││                           │
│   l_shipdate IS NOT NULL  ││                           │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │
│        EC: 1200243        ││                           │
└───────────────────────────┘└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

compressed filter_log_size: 624
compressed filter_log_buffer_size: 0
compressed limit_offset_size: 624
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 686005
compressed perfect_full_scan_ht_log_buffer_size: 684997
compressed perfect_probe_ht_log_size: 385258
compressed perfect_probe_ht_log_buffer_size: 343598
compressed row_group_log_size: 296995
compressed row_group_log_buffer_size: 255158
compressed scatter_log_size: 624
compressed scatter_log_buffer_size: 0
compressed scatter_sel_log_size: 772322
compressed scatter_sel_log_buffer_size: 770135
compressed gather_log_size: 624
compressed gather_log_buffer_size: 0
compressed combine_log_size: 624
compressed combine_log_buffer_size: 0
compressed finalize_states_log_size: 624
compressed finalize_states_log_buffer_size: 0
compressed join_gather_log_size: 624
compressed join_gather_log_buffer_size: 0
compressed reorder_log_size: 936
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 624
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 624
compressed nlj_log_buffer_size: 0
compressed total_size: 2147132
compressed total_buffer_size: 2053888
compressed total_element_size: 93244

Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                                                          
│         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│__internal_decompress_integ│                                                          
│     ral_bigint(#0, 1)     │                                                          
│             #1            │                                                          
│             #2            │                                                          
│__internal_decompress_strin│                                                          
│           g(#3)           │                                                          
│             #4            │                                                          
└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          
│          ORDER_BY         │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│          ORDERS:          │                                                          
│   supplier.s_suppkey ASC  │                                                          
└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          
│         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│__internal_compress_integra│                                                          
│     l_usmallint(#0, 1)    │                                                          
│             #1            │                                                          
│             #2            │                                                          
│__internal_compress_string_│                                                          
│        hugeint(#3)        │                                                          
│             #4            │                                                          
└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          
│         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│         s_suppkey         │                                                          
│           s_name          │                                                          
│         s_address         │                                                          
│          s_phone          │                                                          
│       total_revenue       │                                                          
└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          
│         HASH_JOIN         │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│           INNER           │                                                          
│  s_suppkey = supplier_no  │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐                                           
│        Build Min: 1       │              │                                           
│      Build Max: 10000     │              │                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                           
│           EC: 4           │              │                                           
└─────────────┬─────────────┘              │                                                                        
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             
│         SEQ_SCAN          ││         HASH_JOIN         │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│          supplier         ││           INNER           │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││  total_revenue = SUBQUERY │                             
│         s_suppkey         ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│           s_name          ││           EC: 3           ├──────────────┐              
│         s_address         ││                           │              │              
│          s_phone          ││                           │              │              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │              │              
│         EC: 10000         ││                           │              │              
└───────────────────────────┘└─────────────┬─────────────┘              │                                           
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
                             │         PROJECTION        ││    UNGROUPED_AGGREGATE    │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                             │__internal_decompress_integ││         first(#0)         │
                             │     ral_bigint(#0, 1)     ││                           │
                             │             #1            ││                           │
                             └─────────────┬─────────────┘└─────────────┬─────────────┘                             
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
                             │       HASH_GROUP_BY       ││         PROJECTION        │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                             │             #0            ││             #0            │
                             │    sum_no_overflow(#1)    ││                           │
                             └─────────────┬─────────────┘└─────────────┬─────────────┘                             
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
                             │         PROJECTION        ││      STREAMING_LIMIT      │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │
                             │         l_suppkey         ││                           │
                             │ (l_extendedprice * (1.00 -││                           │
                             │        l_discount))       ││                           │
                             └─────────────┬─────────────┘└─────────────┬─────────────┘                             
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
                             │         PROJECTION        ││    UNGROUPED_AGGREGATE    │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                             │__internal_compress_integra││          max(#0)          │
                             │     l_usmallint(#0, 1)    ││                           │
                             │             #1            ││                           │
                             │             #2            ││                           │
                             └─────────────┬─────────────┘└─────────────┬─────────────┘                             
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
                             │         SEQ_SCAN          ││         PROJECTION        │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                             │          lineitem         ││       total_revenue       │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │
                             │         l_suppkey         ││                           │
                             │      l_extendedprice      ││                           │
                             │         l_discount        ││                           │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │
                             │ Filters: l_shipdate>='1996││                           │
                             │-01-01'::DATE AND l_sh...  ││                           │
                             │  <'1996-04-01'::DATE AND  ││                           │
                             │   l_shipdate IS NOT NULL  ││                           │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │
                             │        EC: 1200243        ││                           │
                             └───────────────────────────┘└─────────────┬─────────────┘                             
                                                          ┌─────────────┴─────────────┐
                                                          │         PROJECTION        │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │  sum((l_extendedprice *   │
                                                          │(CAST(1 AS DECIMAL(16,2)) -│
                                                          │        l_discount)))      │
                                                          └─────────────┬─────────────┘                             
                                                          ┌─────────────┴─────────────┐
                                                          │         PROJECTION        │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │__internal_decompress_integ│
                                                          │     ral_bigint(#0, 1)     │
                                                          │             #1            │
                                                          └─────────────┬─────────────┘                             
                                                          ┌─────────────┴─────────────┐
                                                          │       HASH_GROUP_BY       │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │             #0            │
                                                          │    sum_no_overflow(#1)    │
                                                          └─────────────┬─────────────┘                             
                                                          ┌─────────────┴─────────────┐
                                                          │         PROJECTION        │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │         l_suppkey         │
                                                          │ (l_extendedprice * (1.00 -│
                                                          │        l_discount))       │
                                                          └─────────────┬─────────────┘                             
                                                          ┌─────────────┴─────────────┐
                                                          │         PROJECTION        │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │__internal_compress_integra│
                                                          │     l_usmallint(#0, 1)    │
                                                          │             #1            │
                                                          │             #2            │
                                                          └─────────────┬─────────────┘                             
                                                          ┌─────────────┴─────────────┐
                                                          │         SEQ_SCAN          │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │          lineitem         │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │         l_suppkey         │
                                                          │      l_extendedprice      │
                                                          │         l_discount        │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │ Filters: l_shipdate>='1996│
                                                          │-01-01'::DATE AND l_sh...  │
                                                          │  <'1996-04-01'::DATE AND  │
                                                          │   l_shipdate IS NOT NULL  │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │        EC: 1200243        │
                                                          └───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

   query_id  ...                                               plan
0         5  ...  {"name": "ORDER_BY", "opid": "11", "children":...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               SELECT c_count, count(*) AS custdist FROM ( SE...
size_bytes_max                                               29896736
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "ORDER_BY", "opid": "11", "children":...
Name: 0, dtype: object
{"name": "ORDER_BY", "opid": "11", "children": [{"name": "HASH_GROUP_BY", "opid": "10", "children": [{"name": "PROJECTION", "opid": "9", "children": [{"name": "PROJECTION", "opid": "8", "children": [{"name": "PROJECTION", "opid": "7", "children": [{"name": "HASH_GROUP_BY", "opid": "6", "children": [{"name": "PROJECTION", "opid": "5", "children": [{"name": "PROJECTION", "opid": "4", "children": [{"name": "HASH_JOIN", "opid": "3", "children": [{"name": "FILTER", "opid": "1", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "orders","extra": "orders\n[INFOSEPARATOR]\no_custkey\no_comment\no_orderkey\n[INFOSEPARATOR]\nEC: 1500000"}],"table": "","extra": "(o_comment !~~ '%special%requests%')\n[INFOSEPARATOR]\nEC: 300000"},{"name": "SEQ_SCAN ", "opid": "2", "children": [],"table": "customer","extra": "customer\n[INFOSEPARATOR]\nc_custkey\n[INFOSEPARATOR]\nEC: 150000"}],"table": "","extra": "RIGHT\no_custkey = c_custkey\n\n[INFOSEPARATOR]\nEC: 300000\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n#1\n#2\n__internal_compress_integral_uinteger(#3, 1)\n"}],"table": "","extra": "c_custkey\no_orderkey\n"}],"table": "","extra": "#0\ncount(#1)"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n#1\n"}],"table": "","extra": "count(o_orderkey)\n"}],"table": "","extra": "c_count\n"}],"table": "","extra": "#0\ncount_star()"}],"table": "","extra": "ORDERS:\ncount_star() DESC\nc_orders.c_count DESC"}
%%%%%%%%%%%%%%%% Running Query #  14  threads:  4
SELECT 100.00 * sum( CASE WHEN p_type LIKE 'PROMO%' THEN l_extendedprice * (1 - l_discount) ELSE 0 END) / sum(l_extendedprice * (1 - l_discount)) AS promo_revenue FROM lineitem, part WHERE l_partkey = p_partkey AND l_shipdate >= date '1995-09-01' AND l_shipdate < CAST('1995-10-01' AS date);
Run:  None SELECT 100.00 * sum( CASE WHEN p_type LIKE 'PROMO%' THEN l_extendedprice * (1 - l_discount) ELSE 0 END) / sum(l_extendedprice * (1 - l_discount)) AS promo_revenue FROM lineitem, part WHERE l_partkey = p_partkey AND l_shipdate >= date '1995-09-01' AND l_shipdate < CAST('1995-10-01' AS date);
Avg Time in sec:  0.08177833305671811  output size:  1
   promo_revenue
0      16.380779
{'name': 'Query', 'result': 0.078702, 'timing': 0.078702, 'cardinality': 0, 'extra-info': "SELECT 100.00 * sum( CASE WHEN p_type LIKE 'PROMO%' THEN l_extendedprice * (1 - l_discount) ELSE 0 END) / sum(l_extendedprice * (1 - l_discount)) AS promo_revenue FROM lineitem, part WHERE l_partkey = p_partkey AND l_shipdate >= date '1995-09-01' AND l_shipdate < CAST('1995-10-01' AS date);", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 6e-06, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 1.1e-05, 'cardinality': 1, 'extra_info': 'promo_revenue\n', 'children': [{'name': 'UNGROUPED_AGGREGATE', 'timing': 0.000364, 'cardinality': 1, 'extra_info': 'sum(#0)\nsum(#1)', 'children': [{'name': 'PROJECTION', 'timing': 0.002288, 'cardinality': 75983, 'extra_info': "CASE  WHEN (prefix(p_type, 'PROMO')) THEN ((l_extendedprice * (1.00 - l_discount))) ELSE 0.0000 END\n(l_extendedprice * (1.00 - l_discount))\n", 'children': [{'name': 'HASH_JOIN', 'timing': 0.10193, 'cardinality': 75983, 'extra_info': 'INNER\nl_partkey = p_partkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 641407\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.068929, 'cardinality': 75983, 'extra_info': "lineitem\n[INFOSEPARATOR]\nl_partkey\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nFilters: l_shipdate>='1995-09-01'::DATE AND l_shipdate<'1995-10-01'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243", 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 0.0058, 'cardinality': 200000, 'extra_info': 'part\n[INFOSEPARATOR]\np_partkey\np_type\n[INFOSEPARATOR]\nEC: 200000', 'children': []}]}]}]}]}]}]}
X {'RESULT_COLLECTOR0': 6e-06, 'PROJECTION1': 1.1e-05, 'UNGROUPED_AGGREGATE2': 0.000364, 'PROJECTION3': 0.002288, 'HASH_JOIN4': 0.10193, 'SEQ_SCAN 5': 0.068929, 'SEQ_SCAN 6': 0.0058}
**** output size:  1
LINEAGE_5_HASH_JOIN_2
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_1
SELECT 100.00 * sum( CASE WHEN p_type LIKE 'PROMO%' THEN l_extendedprice * (1 - l_discount) ELSE 0 END) / sum(l_extendedprice * (1 - l_discount)) AS promo_revenue FROM lineitem, part WHERE l_partkey = p_partkey AND l_shipdate >= date '1995-09-01' AND l_shipdate < CAST('1995-10-01' AS date);
   query_id  ...                                               plan
0         5  ...  {"name": "PROJECTION", "opid": "5", "children"...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               SELECT 100.00 * sum( CASE WHEN p_type LIKE 'PR...
size_bytes_max                                                2147132
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "PROJECTION", "opid": "5", "children"...
Name: 0, dtype: object
{"name": "PROJECTION", "opid": "5", "children": [{"name": "UNGROUPED_AGGREGATE", "opid": "4", "children": [{"name": "PROJECTION", "opid": "3", "children": [{"name": "HASH_JOIN", "opid": "2", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_partkey\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nFilters: l_shipdate>='1995-09-01'::DATE AND l_shipdate<'1995-10-01'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243"},{"name": "SEQ_SCAN ", "opid": "1", "children": [],"table": "part","extra": "part\n[INFOSEPARATOR]\np_partkey\np_type\n[INFOSEPARATOR]\nEC: 200000"}],"table": "","extra": "INNER\nl_partkey = p_partkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 641407\n"}],"table": "","extra": "CASE  WHEN (prefix(p_type, 'PROMO')) THEN ((l_extendedprice * (1.00 - l_discount))) ELSE 0.0000 END\n(l_extendedprice * (1.00 - l_discount))\n"}],"table": "","extra": "sum(#0)\nsum(#1)"}],"table": "","extra": "promo_revenue\n"}
%%%%%%%%%%%%%%%% Running Query #  15  threads:  4
with revenue0 (supplier_no, total_revenue) as ( select l_suppkey, sum(l_extendedprice * (1 - l_discount)) from lineitem where l_shipdate >= date '1996-01-01' and l_shipdate < date '1996-01-01' + interval '3' month group by l_suppkey ) SELECT s_suppkey, s_name, s_address, s_phone, total_revenue FROM supplier, revenue0 WHERE s_suppkey = supplier_no AND total_revenue = ( SELECT max(total_revenue) FROM revenue0) ORDER BY s_suppkey;
Run:  None with revenue0 (supplier_no, total_revenue) as ( select l_suppkey, sum(l_extendedprice * (1 - l_discount)) from lineitem where l_shipdate >= date '1996-01-01' and l_shipdate < date '1996-01-01' + interval '3' month group by l_suppkey ) SELECT s_suppkey, s_name, s_address, s_phone, total_revenue FROM supplier, revenue0 WHERE s_suppkey = supplier_no AND total_revenue = ( SELECT max(total_revenue) FROM revenue0) ORDER BY s_suppkey;
Avg Time in sec:  0.06987179815769196  output size:  1
   s_suppkey              s_name  ...          s_phone total_revenue
0       8449  Supplier#000008449  ...  20-469-856-8873  1.772627e+06

[1 rows x 5 columns]
{'name': 'Query', 'result': 0.063689, 'timing': 0.063689, 'cardinality': 0, 'extra-info': "with revenue0 (supplier_no, total_revenue) as ( select l_suppkey, sum(l_extendedprice * (1 - l_discount)) from lineitem where l_shipdate >= date '1996-01-01' and l_shipdate < date '1996-01-01' + interval '3' month group by l_suppkey ) SELECT s_suppkey, s_name, s_address, s_phone, total_revenue FROM supplier, revenue0 WHERE s_suppkey = supplier_no AND total_revenue = ( SELECT max(total_revenue) FROM revenue0) ORDER BY s_suppkey;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 8e-06, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 3e-06, 'cardinality': 1, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n#1\n#2\n__internal_decompress_string(#3)\n#4\n', 'children': [{'name': 'ORDER_BY', 'timing': 3.4e-05, 'cardinality': 1, 'extra_info': 'ORDERS:\nsupplier.s_suppkey ASC', 'children': [{'name': 'PROJECTION', 'timing': 5e-06, 'cardinality': 1, 'extra_info': '__internal_compress_integral_usmallint(#0, 1)\n#1\n#2\n__internal_compress_string_hugeint(#3)\n#4\n', 'children': [{'name': 'PROJECTION', 'timing': 2e-06, 'cardinality': 1, 'extra_info': 's_suppkey\ns_name\ns_address\ns_phone\ntotal_revenue\n', 'children': [{'name': 'HASH_JOIN', 'timing': 8.4e-05, 'cardinality': 1, 'extra_info': 'INNER\ns_suppkey = supplier_no\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 4\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.000734, 'cardinality': 10000, 'extra_info': 'supplier\n[INFOSEPARATOR]\ns_suppkey\ns_name\ns_address\ns_phone\n[INFOSEPARATOR]\nEC: 10000', 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.000228, 'cardinality': 1, 'extra_info': 'INNER\ntotal_revenue = SUBQUERY\n\n[INFOSEPARATOR]\nEC: 3\n', 'children': [{'name': 'PROJECTION', 'timing': 4e-05, 'cardinality': 10000, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n#1\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.029673, 'cardinality': 10000, 'extra_info': '#0\nsum_no_overflow(#1)', 'children': [{'name': 'PROJECTION', 'timing': 0.012743, 'cardinality': 225954, 'extra_info': 'l_suppkey\n(l_extendedprice * (1.00 - l_discount))\n', 'children': [{'name': 'PROJECTION', 'timing': 0.005599, 'cardinality': 225954, 'extra_info': '__internal_compress_integral_usmallint(#0, 1)\n#1\n#2\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.048236, 'cardinality': 225954, 'extra_info': "lineitem\n[INFOSEPARATOR]\nl_suppkey\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nFilters: l_shipdate>='1996-01-01'::DATE AND l_shipdate<'1996-04-01'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243", 'children': []}]}]}]}]}, {'name': 'UNGROUPED_AGGREGATE', 'timing': 3e-06, 'cardinality': 1, 'extra_info': 'first(#0)', 'children': [{'name': 'PROJECTION', 'timing': 1e-06, 'cardinality': 1, 'extra_info': '#0\n', 'children': [{'name': 'STREAMING_LIMIT', 'timing': 3e-06, 'cardinality': 1, 'extra_info': '', 'children': [{'name': 'UNGROUPED_AGGREGATE', 'timing': 2.5e-05, 'cardinality': 1, 'extra_info': 'max(#0)', 'children': [{'name': 'PROJECTION', 'timing': 3e-06, 'cardinality': 10000, 'extra_info': 'total_revenue\n', 'children': [{'name': 'PROJECTION', 'timing': 2e-06, 'cardinality': 10000, 'extra_info': 'sum((l_extendedprice * (CAST(1 AS DECIMAL(16,2)) - l_discount)))\n', 'children': [{'name': 'PROJECTION', 'timing': 2.6e-05, 'cardinality': 10000, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n#1\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.034535, 'cardinality': 10000, 'extra_info': '#0\nsum_no_overflow(#1)', 'children': [{'name': 'PROJECTION', 'timing': 0.015477, 'cardinality': 225954, 'extra_info': 'l_suppkey\n(l_extendedprice * (1.00 - l_discount))\n', 'children': [{'name': 'PROJECTION', 'timing': 0.015126, 'cardinality': 225954, 'extra_info': '__internal_compress_integral_usmallint(#0, 1)\n#1\n#2\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.060501, 'cardinality': 225954, 'extra_info': "lineitem\n[INFOSEPARATOR]\nl_suppkey\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nFilters: l_shipdate>='1996-01-01'::DATE AND l_shipdate<'1996-04-01'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243", 'children': []}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}
compressed filter_log_size: 1680
compressed filter_log_buffer_size: 0
compressed limit_offset_size: 1824
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 2080
compressed perfect_full_scan_ht_log_buffer_size: 16
compressed perfect_probe_ht_log_size: 2072
compressed perfect_probe_ht_log_buffer_size: 8
compressed row_group_log_size: 874705
compressed row_group_log_buffer_size: 792972
compressed scatter_log_size: 1630223
compressed scatter_log_buffer_size: 1598624
compressed scatter_sel_log_size: 2176
compressed scatter_sel_log_buffer_size: 16
compressed gather_log_size: 1680
compressed gather_log_buffer_size: 0
compressed combine_log_size: 1801240
compressed combine_log_buffer_size: 1798296
compressed finalize_states_log_size: 6106
compressed finalize_states_log_buffer_size: 3528
compressed join_gather_log_size: 2124
compressed join_gather_log_buffer_size: 12
compressed reorder_log_size: 2600
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 1680
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 1680
compressed nlj_log_buffer_size: 0
compressed total_size: 4331870
compressed total_buffer_size: 4193472
compressed total_element_size: 138398

Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│__internal_decompress_strin│                                                                                       
│           g(#0)           │                                                                                       
│             #1            │                                                                                       
│__internal_decompress_integ│                                                                                       
│     ral_integer(#2, 1)    │                                                                                       
│             #3            │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│          ORDER_BY         │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│          ORDERS:          │                                                                                       
│  count(DISTINCT partsupp  │                                                                                       
│     .ps_suppkey) DESC     │                                                                                       
│      part.p_brand ASC     │                                                                                       
│      part.p_type ASC      │                                                                                       
│      part.p_size ASC      │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│__internal_compress_string_│                                                                                       
│        hugeint(#0)        │                                                                                       
│             #1            │                                                                                       
│__internal_compress_integra│                                                                                       
│     l_utinyint(#2, 1)     │                                                                                       
│             #3            │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│__internal_decompress_strin│                                                                                       
│           g(#0)           │                                                                                       
│             #1            │                                                                                       
│__internal_decompress_integ│                                                                                       
│     ral_integer(#2, 1)    │                                                                                       
│             #3            │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│       HASH_GROUP_BY       │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│             #0            │                                                                                       
│             #1            │                                                                                       
│             #2            │                                                                                       
│     count(DISTINCT #3)    │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│          p_brand          │                                                                                       
│           p_type          │                                                                                       
│           p_size          │                                                                                       
│         ps_suppkey        │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│             #0            │                                                                                       
│__internal_compress_string_│                                                                                       
│        hugeint(#1)        │                                                                                       
│             #2            │                                                                                       
│__internal_compress_integra│                                                                                       
│     l_utinyint(#3, 1)     │                                                                                       
│             #4            │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│             #1            │                                                                                       
│             #3            │                                                                                       
│             #4            │                                                                                       
│             #5            │                                                                                       
│             #6            │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│           FILTER          │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│       (NOT SUBQUERY)      │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│         EC: 33778         │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         HASH_JOIN         │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│            MARK           │                                                                                       
│      ps_suppkey = #0      ├────────────────────────────────────────────────────────────────────────┐              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                        │              
│         EC: 168893        │                                                                        │              
└─────────────┬─────────────┘                                                                        │                                           
┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐
│         HASH_JOIN         │                                                          │         PROJECTION        │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│           INNER           │                                                          │         s_suppkey         │
│   ps_partkey = p_partkey  │                                                          │                           │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐                                           │                           │
│        Build Min: 1       │              │                                           │                           │
│     Build Max: 200000     │              │                                           │                           │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                           │                           │
│         EC: 168893        │              │                                           │                           │
└─────────────┬─────────────┘              │                                           └─────────────┬─────────────┘                             
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐
│         SEQ_SCAN          ││           FILTER          │                             │           FILTER          │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│          partsupp         ││ (IN (...) AND (p_brand != │                             │  (s_comment ~~ '%Customer │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││'Brand#45') AND (NOT prefix│                             │       %Complaints%')      │
│         ps_partkey        ││(p_type, 'MEDIUM POLIS...  │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│         ps_suppkey        ││             )             │                             │          EC: 2000         │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │                           │
│         EC: 800000        ││         EC: 40000         │                             │                           │
└───────────────────────────┘└─────────────┬─────────────┘                             └─────────────┬─────────────┘                             
                             ┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐
                             │         HASH_JOIN         │                             │         SEQ_SCAN          │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                             │            MARK           │                             │          supplier         │
                             │        p_size = #0        │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐              │         s_comment         │
                             │         EC: 200000        │              │              │         s_suppkey         │
                             │                           │              │              │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                             │                           │              │              │         EC: 10000         │
                             └─────────────┬─────────────┘              │              └───────────────────────────┘                             
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             
                             │         SEQ_SCAN          ││      COLUMN_DATA_SCAN     │                             
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                             
                             │            part           ││                           │                             
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                             
                             │         p_partkey         ││                           │                             
                             │          p_brand          ││                           │                             
                             │           p_type          ││                           │                             
                             │           p_size          ││                           │                             
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                             
                             │         EC: 200000        ││                           │                             
                             └───────────────────────────┘└───────────────────────────┘                                                          

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

X {'RESULT_COLLECTOR0': 8e-06, 'PROJECTION1': 3e-06, 'ORDER_BY2': 3.4e-05, 'PROJECTION3': 5e-06, 'PROJECTION4': 2e-06, 'HASH_JOIN5': 8.4e-05, 'SEQ_SCAN 6': 0.000734, 'HASH_JOIN7': 0.000228, 'PROJECTION8': 4e-05, 'HASH_GROUP_BY9': 0.029673, 'PROJECTION10': 0.012743, 'PROJECTION11': 0.005599, 'SEQ_SCAN 12': 0.048236, 'UNGROUPED_AGGREGATE13': 3e-06, 'PROJECTION14': 1e-06, 'STREAMING_LIMIT15': 3e-06, 'UNGROUPED_AGGREGATE16': 2.5e-05, 'PROJECTION17': 3e-06, 'PROJECTION18': 2e-06, 'PROJECTION19': 2.6e-05, 'HASH_GROUP_BY20': 0.034535, 'PROJECTION21': 0.015477, 'PROJECTION22': 0.015126, 'SEQ_SCAN 23': 0.060501}
**** output size:  1
LINEAGE_5_HASH_GROUP_BY_4
LINEAGE_5_HASH_GROUP_BY_9
LINEAGE_5_HASH_JOIN_17
LINEAGE_5_HASH_JOIN_18
LINEAGE_5_ORDER_BY_21
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_1
LINEAGE_5_SEQ_SCAN_6
LINEAGE_5_STREAMING_LIMIT_14
with revenue0 (supplier_no, total_revenue) as ( select l_suppkey, sum(l_extendedprice * (1 - l_discount)) from lineitem where l_shipdate >= date '1996-01-01' and l_shipdate < date '1996-01-01' + interval '3' month group by l_suppkey ) SELECT s_suppkey, s_name, s_address, s_phone, total_revenue FROM supplier, revenue0 WHERE s_suppkey = supplier_no AND total_revenue = ( SELECT max(total_revenue) FROM revenue0) ORDER BY s_suppkey;
   query_id  ...                                               plan
0         5  ...  {"name": "PROJECTION", "opid": "22", "children...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               with revenue0 (supplier_no, total_revenue) as ...
size_bytes_max                                                4331870
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "PROJECTION", "opid": "22", "children...
Name: 0, dtype: object
{"name": "PROJECTION", "opid": "22", "children": [{"name": "ORDER_BY", "opid": "21", "children": [{"name": "PROJECTION", "opid": "20", "children": [{"name": "PROJECTION", "opid": "19", "children": [{"name": "HASH_JOIN", "opid": "18", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "supplier","extra": "supplier\n[INFOSEPARATOR]\ns_suppkey\ns_name\ns_address\ns_phone\n[INFOSEPARATOR]\nEC: 10000"},{"name": "HASH_JOIN", "opid": "17", "children": [{"name": "PROJECTION", "opid": "5", "children": [{"name": "HASH_GROUP_BY", "opid": "4", "children": [{"name": "PROJECTION", "opid": "3", "children": [{"name": "PROJECTION", "opid": "2", "children": [{"name": "SEQ_SCAN ", "opid": "1", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_suppkey\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nFilters: l_shipdate>='1996-01-01'::DATE AND l_shipdate<'1996-04-01'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243"}],"table": "","extra": "__internal_compress_integral_usmallint(#0, 1)\n#1\n#2\n"}],"table": "","extra": "l_suppkey\n(l_extendedprice * (1.00 - l_discount))\n"}],"table": "","extra": "#0\nsum_no_overflow(#1)"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n#1\n"},{"name": "UNGROUPED_AGGREGATE", "opid": "16", "children": [{"name": "PROJECTION", "opid": "15", "children": [{"name": "STREAMING_LIMIT", "opid": "14", "children": [{"name": "UNGROUPED_AGGREGATE", "opid": "13", "children": [{"name": "PROJECTION", "opid": "12", "children": [{"name": "PROJECTION", "opid": "11", "children": [{"name": "PROJECTION", "opid": "10", "children": [{"name": "HASH_GROUP_BY", "opid": "9", "children": [{"name": "PROJECTION", "opid": "8", "children": [{"name": "PROJECTION", "opid": "7", "children": [{"name": "SEQ_SCAN ", "opid": "6", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_suppkey\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nFilters: l_shipdate>='1996-01-01'::DATE AND l_shipdate<'1996-04-01'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243"}],"table": "","extra": "__internal_compress_integral_usmallint(#0, 1)\n#1\n#2\n"}],"table": "","extra": "l_suppkey\n(l_extendedprice * (1.00 - l_discount))\n"}],"table": "","extra": "#0\nsum_no_overflow(#1)"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n#1\n"}],"table": "","extra": "sum((l_extendedprice * (CAST(1 AS DECIMAL(16,2)) - l_discount)))\n"}],"table": "","extra": "total_revenue\n"}],"table": "","extra": "max(#0)"}],"table": "","extra": ""}],"table": "","extra": "#0\n"}],"table": "","extra": "first(#0)"}],"table": "","extra": "INNER\ntotal_revenue = SUBQUERY\n\n[INFOSEPARATOR]\nEC: 3\n"}],"table": "","extra": "INNER\ns_suppkey = supplier_no\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 4\n"}],"table": "","extra": "s_suppkey\ns_name\ns_address\ns_phone\ntotal_revenue\n"}],"table": "","extra": "__internal_compress_integral_usmallint(#0, 1)\n#1\n#2\n__internal_compress_string_hugeint(#3)\n#4\n"}],"table": "","extra": "ORDERS:\nsupplier.s_suppkey ASC"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n#1\n#2\n__internal_decompress_string(#3)\n#4\n"}
%%%%%%%%%%%%%%%% Running Query #  16  threads:  4
SELECT p_brand, p_type, p_size, count(DISTINCT ps_suppkey) AS supplier_cnt FROM partsupp, part WHERE p_partkey = ps_partkey AND p_brand <> 'Brand#45' AND p_type NOT LIKE 'MEDIUM POLISHED%' AND p_size IN (49, 14, 23, 45, 19, 3, 36, 9) AND ps_suppkey NOT IN ( SELECT s_suppkey FROM supplier WHERE s_comment LIKE '%Customer%Complaints%') GROUP BY p_brand, p_type, p_size ORDER BY supplier_cnt DESC, p_brand, p_type, p_size;
Run:  None SELECT p_brand, p_type, p_size, count(DISTINCT ps_suppkey) AS supplier_cnt FROM partsupp, part WHERE p_partkey = ps_partkey AND p_brand <> 'Brand#45' AND p_type NOT LIKE 'MEDIUM POLISHED%' AND p_size IN (49, 14, 23, 45, 19, 3, 36, 9) AND ps_suppkey NOT IN ( SELECT s_suppkey FROM supplier WHERE s_comment LIKE '%Customer%Complaints%') GROUP BY p_brand, p_type, p_size ORDER BY supplier_cnt DESC, p_brand, p_type, p_size;
Avg Time in sec:  0.06353920605033636  output size:  18314
        p_brand                    p_type  p_size  supplier_cnt
0      Brand#41        MEDIUM BRUSHED TIN       3            28
1      Brand#54   STANDARD BRUSHED COPPER      14            27
2      Brand#11      STANDARD BRUSHED TIN      23            24
3      Brand#11  STANDARD BURNISHED BRASS      36            24
4      Brand#15    MEDIUM ANODIZED NICKEL       3            24
...         ...                       ...     ...           ...
18309  Brand#52      MEDIUM BRUSHED BRASS      45             3
18310  Brand#53        MEDIUM BRUSHED TIN      45             3
18311  Brand#54    ECONOMY POLISHED BRASS       9             3
18312  Brand#55        PROMO PLATED BRASS      19             3
18313  Brand#55       STANDARD PLATED TIN      49             3

[18314 rows x 4 columns]
{'name': 'Query', 'result': 0.05897, 'timing': 0.05897, 'cardinality': 0, 'extra-info': "SELECT p_brand, p_type, p_size, count(DISTINCT ps_suppkey) AS supplier_cnt FROM partsupp, part WHERE p_partkey = ps_partkey AND p_brand <> 'Brand#45' AND p_type NOT LIKE 'MEDIUM POLISHED%' AND p_size IN (49, 14, 23, 45, 19, 3, 36, 9) AND ps_suppkey NOT IN ( SELECT s_suppkey FROM supplier WHERE s_comment LIKE '%Customer%Complaints%') GROUP BY p_brand, p_type, p_size ORDER BY supplier_cnt DESC, p_brand, p_type, p_size;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 0.001534, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 0.000406, 'cardinality': 18314, 'extra_info': '__internal_decompress_string(#0)\n#1\n__internal_decompress_integral_integer(#2, 1)\n#3\n', 'children': [{'name': 'ORDER_BY', 'timing': 0.002083, 'cardinality': 18314, 'extra_info': 'ORDERS:\ncount(DISTINCT partsupp.ps_suppkey) DESC\npart.p_brand ASC\npart.p_type ASC\npart.p_size ASC', 'children': [{'name': 'PROJECTION', 'timing': 0.000261, 'cardinality': 18314, 'extra_info': '__internal_compress_string_hugeint(#0)\n#1\n__internal_compress_integral_utinyint(#2, 1)\n#3\n', 'children': [{'name': 'PROJECTION', 'timing': 0.00052, 'cardinality': 18314, 'extra_info': '__internal_decompress_string(#0)\n#1\n__internal_decompress_integral_integer(#2, 1)\n#3\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.040432, 'cardinality': 18314, 'extra_info': '#0\n#1\n#2\ncount(DISTINCT #3)', 'children': [{'name': 'PROJECTION', 'timing': 0.000232, 'cardinality': 118274, 'extra_info': 'p_brand\np_type\np_size\nps_suppkey\n', 'children': [{'name': 'PROJECTION', 'timing': 0.003367, 'cardinality': 118274, 'extra_info': '#0\n__internal_compress_string_hugeint(#1)\n#2\n__internal_compress_integral_utinyint(#3, 1)\n#4\n', 'children': [{'name': 'PROJECTION', 'timing': 0.000304, 'cardinality': 118274, 'extra_info': '#1\n#3\n#4\n#5\n#6\n', 'children': [{'name': 'FILTER', 'timing': 0.001327, 'cardinality': 118274, 'extra_info': '(NOT SUBQUERY)\n[INFOSEPARATOR]\nEC: 33778', 'children': [{'name': 'HASH_JOIN', 'timing': 0.005556, 'cardinality': 118324, 'extra_info': 'MARK\nps_suppkey = #0\n\n[INFOSEPARATOR]\nEC: 168893\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.014754, 'cardinality': 118324, 'extra_info': 'INNER\nps_partkey = p_partkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 168893\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.001804, 'cardinality': 800000, 'extra_info': 'partsupp\n[INFOSEPARATOR]\nps_partkey\nps_suppkey\n[INFOSEPARATOR]\nEC: 800000', 'children': []}, {'name': 'FILTER', 'timing': 0.002924, 'cardinality': 29581, 'extra_info': "(IN (...) AND (p_brand != 'Brand#45') AND (NOT prefix(p_type, 'MEDIUM POLISHED')))\n[INFOSEPARATOR]\nEC: 40000", 'children': [{'name': 'HASH_JOIN', 'timing': 0.002599, 'cardinality': 200000, 'extra_info': 'MARK\np_size = #0\n\n[INFOSEPARATOR]\nEC: 200000\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.012138, 'cardinality': 200000, 'extra_info': 'part\n[INFOSEPARATOR]\np_partkey\np_brand\np_type\np_size\n[INFOSEPARATOR]\nEC: 200000', 'children': []}, {'name': 'COLUMN_DATA_SCAN', 'timing': 5e-06, 'cardinality': 8, 'extra_info': '', 'children': []}]}]}]}, {'name': 'PROJECTION', 'timing': 1e-06, 'cardinality': 4, 'extra_info': 's_suppkey\n', 'children': [{'name': 'FILTER', 'timing': 0.000388, 'cardinality': 4, 'extra_info': "(s_comment ~~ '%Customer%Complaints%')\n[INFOSEPARATOR]\nEC: 2000", 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.000598, 'cardinality': 10000, 'extra_info': 'supplier\n[INFOSEPARATOR]\ns_comment\ns_suppkey\n[INFOSEPARATOR]\nEC: 10000', 'children': []}]}]}]}]}]}]}]}]}]}]}]}]}]}]}
compressed filter_log_size: 32587
compressed filter_log_buffer_size: 26242
compressed limit_offset_size: 1408
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 84735
compressed perfect_full_scan_ht_log_buffer_size: 82943
compressed perfect_probe_ht_log_size: 223491
compressed perfect_probe_ht_log_buffer_size: 215058
compressed row_group_log_size: 5993
compressed row_group_log_buffer_size: 0
compressed scatter_log_size: 383577
compressed scatter_log_buffer_size: 379798
compressed scatter_sel_log_size: 142777
compressed scatter_sel_log_buffer_size: 139428
compressed gather_log_size: 1408
compressed gather_log_buffer_size: 0
compressed combine_log_size: 898719
compressed combine_log_buffer_size: 896570
compressed finalize_states_log_size: 5075
compressed finalize_states_log_buffer_size: 3058
compressed join_gather_log_size: 1408
compressed join_gather_log_buffer_size: 0
compressed reorder_log_size: 33401
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 1408
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 1408
compressed nlj_log_buffer_size: 0
compressed total_size: 1817395
compressed total_buffer_size: 1743097
compressed total_element_size: 74298

Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                                                                                                                    
│         PROJECTION        │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│         avg_yearly        │                                                                                                                    
└─────────────┬─────────────┘                                                                                                                                                 
┌─────────────┴─────────────┐                                                                                                                    
│    UNGROUPED_AGGREGATE    │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│          sum(#0)          │                                                                                                                    
└─────────────┬─────────────┘                                                                                                                                                 
┌─────────────┴─────────────┐                                                                                                                    
│         PROJECTION        │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│      l_extendedprice      │                                                                                                                    
└─────────────┬─────────────┘                                                                                                                                                 
┌─────────────┴─────────────┐                                                                                                                    
│         PROJECTION        │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│             #0            │                                                                                                                    
│             #3            │                                                                                                                    
│             #4            │                                                                                                                    
└─────────────┬─────────────┘                                                                                                                                                 
┌─────────────┴─────────────┐                                                                                                                    
│           FILTER          │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│(CAST(l_quantity AS DOUBLE)│                                                                                                                    
│         < SUBQUERY)       │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│        EC: 3000607        │                                                                                                                    
└─────────────┬─────────────┘                                                                                                                                                 
┌─────────────┴─────────────┐                                                                                                                    
│      RIGHT_DELIM_JOIN     │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│           RIGHT           │                                                                                                                    
│ p_partkey IS NOT DISTINCT ├───────────────────────────────────────────┐                                                                        
│       FROM p_partkey      │                                           │                                                                        
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                           │                                                                        
│        EC: 3000607        │                                           │                                                                        
└─────────────┬─────────────┘                                           │                                                                                                     
┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐                                                          
│         HASH_JOIN         │                             │         HASH_JOIN         │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│           INNER           │                             │           RIGHT           │                                                          
│   l_partkey = p_partkey   │                             │ p_partkey IS NOT DISTINCT │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐              │       FROM p_partkey      ├───────────────────────────────────────────┐              
│        Build Min: 1       │              │              │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                           │              
│     Build Max: 200000     │              │              │        EC: 3000607        │                                           │              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              │                           │                                           │              
│         EC: 80175         │              │              │                           │                                           │              
└─────────────┬─────────────┘              │              └─────────────┬─────────────┘                                           │                                           
┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐
│         SEQ_SCAN          ││         SEQ_SCAN          ││         PROJECTION        │                             │         DUMMY_SCAN        │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │                           │
│          lineitem         ││            part           ││  (0.2 * avg(l_quantity))  │                             │                           │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││         p_partkey         │                             │                           │
│         l_partkey         ││         p_partkey         ││                           │                             │                           │
│         l_quantity        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                             │                           │
│      l_extendedprice      ││Filters: p_brand='Brand#23'││                           │                             │                           │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   AND p_brand IS NOT NULL ││                           │                             │                           │
│        EC: 6001215        ││ p_container='MED BOX' AND ││                           │                             │                           │
│                           ││   p_container IS NOT NULL ││                           │                             │                           │
│                           ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                             │                           │
│                           ││          EC: 5000         ││                           │                             │                           │
└───────────────────────────┘└───────────────────────────┘└─────────────┬─────────────┘                             └───────────────────────────┘                             
                                                          ┌─────────────┴─────────────┐                                                          
                                                          │         PROJECTION        │                                                          
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                          │__internal_decompress_integ│                                                          
                                                          │     ral_bigint(#0, 1)     │                                                          
                                                          │             #1            │                                                          
                                                          └─────────────┬─────────────┘                                                                                       
                                                          ┌─────────────┴─────────────┐                                                          
                                                          │       HASH_GROUP_BY       │                                                          
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                          │             #0            │                                                          
                                                          │          avg(#1)          │                                                          
                                                          └─────────────┬─────────────┘                                                                                       
                                                          ┌─────────────┴─────────────┐                                                          
                                                          │         PROJECTION        │                                                          
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                          │         p_partkey         │                                                          
                                                          │         l_quantity        │                                                          
                                                          └─────────────┬─────────────┘                                                                                       
                                                          ┌─────────────┴─────────────┐                                                          
                                                          │         PROJECTION        │                                                          
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                          │__internal_compress_integra│                                                          
                                                          │     l_uinteger(#0, 1)     │                                                          
                                                          │             #1            │                                                          
                                                          │             #2            │                                                          
                                                          └─────────────┬─────────────┘                                                                                       
                                                          ┌─────────────┴─────────────┐                                                          
                                                          │         HASH_JOIN         │                                                          
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                          │           INNER           │                                                          
                                                          │   l_partkey = p_partkey   ├──────────────┐                                           
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                           
                                                          │        EC: 6001215        │              │                                           
                                                          └─────────────┬─────────────┘              │                                                                        
                                                          ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             
                                                          │         SEQ_SCAN          ││         DELIM_SCAN        │                             
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                             
                                                          │          lineitem         ││                           │                             
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                             
                                                          │         l_partkey         ││                           │                             
                                                          │         l_quantity        ││                           │                             
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                             
                                                          │        EC: 6001215        ││                           │                             
                                                          └───────────────────────────┘└───────────────────────────┘                                                          

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

X {'RESULT_COLLECTOR0': 0.001534, 'PROJECTION1': 0.000406, 'ORDER_BY2': 0.002083, 'PROJECTION3': 0.000261, 'PROJECTION4': 0.00052, 'HASH_GROUP_BY5': 0.040432, 'PROJECTION6': 0.000232, 'PROJECTION7': 0.003367, 'PROJECTION8': 0.000304, 'FILTER9': 0.001327, 'HASH_JOIN10': 0.005556, 'HASH_JOIN11': 0.014754, 'SEQ_SCAN 12': 0.001804, 'FILTER13': 0.002924, 'HASH_JOIN14': 0.002599, 'SEQ_SCAN 15': 0.012138, 'COLUMN_DATA_SCAN16': 5e-06, 'PROJECTION17': 1e-06, 'FILTER18': 0.000388, 'SEQ_SCAN 19': 0.000598}
**** output size:  18314
LINEAGE_5_COLUMN_DATA_SCAN_2
LINEAGE_5_FILTER_10
LINEAGE_5_FILTER_4
LINEAGE_5_FILTER_7
LINEAGE_5_HASH_GROUP_BY_14
LINEAGE_5_HASH_JOIN_3
LINEAGE_5_HASH_JOIN_5
LINEAGE_5_HASH_JOIN_9
LINEAGE_5_ORDER_BY_17
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_1
LINEAGE_5_SEQ_SCAN_6
SELECT p_brand, p_type, p_size, count(DISTINCT ps_suppkey) AS supplier_cnt FROM partsupp, part WHERE p_partkey = ps_partkey AND p_brand <> 'Brand#45' AND p_type NOT LIKE 'MEDIUM POLISHED%' AND p_size IN (49, 14, 23, 45, 19, 3, 36, 9) AND ps_suppkey NOT IN ( SELECT s_suppkey FROM supplier WHERE s_comment LIKE '%Customer%Complaints%') GROUP BY p_brand, p_type, p_size ORDER BY supplier_cnt DESC, p_brand, p_type, p_size;
   query_id  ...                                               plan
0         5  ...  {"name": "PROJECTION", "opid": "18", "children...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               SELECT p_brand, p_type, p_size, count(DISTINCT...
size_bytes_max                                                1817395
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "PROJECTION", "opid": "18", "children...
Name: 0, dtype: object
{"name": "PROJECTION", "opid": "18", "children": [{"name": "ORDER_BY", "opid": "17", "children": [{"name": "PROJECTION", "opid": "16", "children": [{"name": "PROJECTION", "opid": "15", "children": [{"name": "HASH_GROUP_BY", "opid": "14", "children": [{"name": "PROJECTION", "opid": "13", "children": [{"name": "PROJECTION", "opid": "12", "children": [{"name": "PROJECTION", "opid": "11", "children": [{"name": "FILTER", "opid": "10", "children": [{"name": "HASH_JOIN", "opid": "9", "children": [{"name": "HASH_JOIN", "opid": "5", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "partsupp","extra": "partsupp\n[INFOSEPARATOR]\nps_partkey\nps_suppkey\n[INFOSEPARATOR]\nEC: 800000"},{"name": "FILTER", "opid": "4", "children": [{"name": "HASH_JOIN", "opid": "3", "children": [{"name": "SEQ_SCAN ", "opid": "1", "children": [],"table": "part","extra": "part\n[INFOSEPARATOR]\np_partkey\np_brand\np_type\np_size\n[INFOSEPARATOR]\nEC: 200000"},{"name": "COLUMN_DATA_SCAN", "opid": "2", "children": [],"table": "","extra": ""}],"table": "","extra": "MARK\np_size = #0\n\n[INFOSEPARATOR]\nEC: 200000\n"}],"table": "","extra": "(IN (...) AND (p_brand != 'Brand#45') AND (NOT prefix(p_type, 'MEDIUM POLISHED')))\n[INFOSEPARATOR]\nEC: 40000"}],"table": "","extra": "INNER\nps_partkey = p_partkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 168893\n"},{"name": "PROJECTION", "opid": "8", "children": [{"name": "FILTER", "opid": "7", "children": [{"name": "SEQ_SCAN ", "opid": "6", "children": [],"table": "supplier","extra": "supplier\n[INFOSEPARATOR]\ns_comment\ns_suppkey\n[INFOSEPARATOR]\nEC: 10000"}],"table": "","extra": "(s_comment ~~ '%Customer%Complaints%')\n[INFOSEPARATOR]\nEC: 2000"}],"table": "","extra": "s_suppkey\n"}],"table": "","extra": "MARK\nps_suppkey = #0\n\n[INFOSEPARATOR]\nEC: 168893\n"}],"table": "","extra": "(NOT SUBQUERY)\n[INFOSEPARATOR]\nEC: 33778"}],"table": "","extra": "#1\n#3\n#4\n#5\n#6\n"}],"table": "","extra": "#0\n__internal_compress_string_hugeint(#1)\n#2\n__internal_compress_integral_utinyint(#3, 1)\n#4\n"}],"table": "","extra": "p_brand\np_type\np_size\nps_suppkey\n"}],"table": "","extra": "#0\n#1\n#2\ncount(DISTINCT #3)"}],"table": "","extra": "__internal_decompress_string(#0)\n#1\n__internal_decompress_integral_integer(#2, 1)\n#3\n"}],"table": "","extra": "__internal_compress_string_hugeint(#0)\n#1\n__internal_compress_integral_utinyint(#2, 1)\n#3\n"}],"table": "","extra": "ORDERS:\ncount(DISTINCT partsupp.ps_suppkey) DESC\npart.p_brand ASC\npart.p_type ASC\npart.p_size ASC"}],"table": "","extra": "__internal_decompress_string(#0)\n#1\n__internal_decompress_integral_integer(#2, 1)\n#3\n"}
%%%%%%%%%%%%%%%% Running Query #  17  threads:  4
SELECT sum(l_extendedprice) / 7.0 AS avg_yearly FROM lineitem, part WHERE p_partkey = l_partkey AND p_brand = 'Brand#23' AND p_container = 'MED BOX' AND l_quantity < ( SELECT 0.2 * avg(l_quantity) FROM lineitem WHERE l_partkey = p_partkey);
Run:  None SELECT sum(l_extendedprice) / 7.0 AS avg_yearly FROM lineitem, part WHERE p_partkey = l_partkey AND p_brand = 'Brand#23' AND p_container = 'MED BOX' AND l_quantity < ( SELECT 0.2 * avg(l_quantity) FROM lineitem WHERE l_partkey = p_partkey);
Avg Time in sec:  0.058956703171133995  output size:  1
      avg_yearly
0  348406.054286
{'name': 'Query', 'result': 0.052832, 'timing': 0.052832, 'cardinality': 0, 'extra-info': "SELECT sum(l_extendedprice) / 7.0 AS avg_yearly FROM lineitem, part WHERE p_partkey = l_partkey AND p_brand = 'Brand#23' AND p_container = 'MED BOX' AND l_quantity < ( SELECT 0.2 * avg(l_quantity) FROM lineitem WHERE l_partkey = p_partkey);", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 5e-06, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 4e-06, 'cardinality': 1, 'extra_info': 'avg_yearly\n', 'children': [{'name': 'UNGROUPED_AGGREGATE', 'timing': 1e-05, 'cardinality': 1, 'extra_info': 'sum(#0)', 'children': [{'name': 'PROJECTION', 'timing': 1e-06, 'cardinality': 587, 'extra_info': 'l_extendedprice\n', 'children': [{'name': 'PROJECTION', 'timing': 3e-06, 'cardinality': 587, 'extra_info': '#0\n#3\n#4\n', 'children': [{'name': 'FILTER', 'timing': 0.00015, 'cardinality': 587, 'extra_info': '(CAST(l_quantity AS DOUBLE) < SUBQUERY)\n[INFOSEPARATOR]\nEC: 3000607', 'children': [{'name': 'RIGHT_DELIM_JOIN', 'timing': 0.00319, 'cardinality': 0, 'extra_info': 'RIGHT\np_partkey IS NOT DISTINCT FROM p_partkey\n\n[INFOSEPARATOR]\nEC: 3000607\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.042634, 'cardinality': 6088, 'extra_info': 'INNER\nl_partkey = p_partkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 80175\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.014629, 'cardinality': 6001215, 'extra_info': 'lineitem\n[INFOSEPARATOR]\nl_partkey\nl_quantity\nl_extendedprice\n[INFOSEPARATOR]\nEC: 6001215', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 0.015484, 'cardinality': 204, 'extra_info': "part\n[INFOSEPARATOR]\np_partkey\n[INFOSEPARATOR]\nFilters: p_brand='Brand#23' AND p_brand IS NOT NULL\np_container='MED BOX' AND p_container IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 5000", 'children': []}]}, {'name': 'HASH_JOIN', 'timing': 0.001751, 'cardinality': 6088, 'extra_info': 'RIGHT\np_partkey IS NOT DISTINCT FROM p_partkey\n\n[INFOSEPARATOR]\nEC: 3000607\n', 'children': [{'name': 'PROJECTION', 'timing': 1.1e-05, 'cardinality': 204, 'extra_info': '(0.2 * avg(l_quantity))\np_partkey\n', 'children': [{'name': 'PROJECTION', 'timing': 1.4e-05, 'cardinality': 204, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n#1\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.003923, 'cardinality': 204, 'extra_info': '#0\navg(#1)', 'children': [{'name': 'PROJECTION', 'timing': 3e-06, 'cardinality': 6088, 'extra_info': 'p_partkey\nl_quantity\n', 'children': [{'name': 'PROJECTION', 'timing': 2.4e-05, 'cardinality': 6088, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n#1\n#2\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.067097, 'cardinality': 6088, 'extra_info': 'INNER\nl_partkey = p_partkey\n\n[INFOSEPARATOR]\nEC: 6001215\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.007008, 'cardinality': 6001215, 'extra_info': 'lineitem\n[INFOSEPARATOR]\nl_partkey\nl_quantity\n[INFOSEPARATOR]\nEC: 6001215', 'children': []}, {'name': 'DELIM_SCAN', 'timing': 0.0, 'cardinality': 0, 'extra_info': '', 'children': []}]}]}]}]}]}]}, {'name': 'DUMMY_SCAN', 'timing': 0.0, 'cardinality': 0, 'extra_info': '', 'children': []}]}, {'name': 'HASH_GROUP_BY', 'timing': 0.000838, 'cardinality': 204, 'extra_info': '#0', 'children': []}]}]}]}]}]}]}]}]}
compressed filter_log_size: 3761
compressed filter_log_buffer_size: 785
compressed limit_offset_size: 1632
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 2953
compressed perfect_full_scan_ht_log_buffer_size: 937
compressed perfect_probe_ht_log_size: 90570
compressed perfect_probe_ht_log_buffer_size: 48704
compressed row_group_log_size: 43206
compressed row_group_log_buffer_size: 816
compressed scatter_log_size: 41192
compressed scatter_log_buffer_size: 38408
compressed scatter_sel_log_size: 35572
compressed scatter_sel_log_buffer_size: 30537
compressed gather_log_size: 1632
compressed gather_log_buffer_size: 0
compressed combine_log_size: 42356
compressed combine_log_buffer_size: 39477
compressed finalize_states_log_size: 3349
compressed finalize_states_log_buffer_size: 565
compressed join_gather_log_size: 154947
compressed join_gather_log_buffer_size: 106090
compressed reorder_log_size: 2448
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 1632
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 1632
compressed nlj_log_buffer_size: 0
compressed total_size: 426882
compressed total_buffer_size: 266319
compressed total_element_size: 160563

Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                                                                                       
│           LIMIT           │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│             #0            │                                                                                       
│__internal_decompress_integ│                                                                                       
│     ral_bigint(#1, 1)     │                                                                                       
│__internal_decompress_integ│                                                                                       
│     ral_bigint(#2, 1)     │                                                                                       
│             #3            │                                                                                       
│             #4            │                                                                                       
│             #5            │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│          ORDER_BY         │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│          ORDERS:          │                                                                                       
│  orders.o_totalprice DESC │                                                                                       
│   orders.o_orderdate ASC  │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│             #0            │                                                                                       
│__internal_compress_integra│                                                                                       
│     l_uinteger(#1, 1)     │                                                                                       
│__internal_compress_integra│                                                                                       
│     l_uinteger(#2, 1)     │                                                                                       
│             #3            │                                                                                       
│             #4            │                                                                                       
│             #5            │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│             #0            │                                                                                       
│__internal_decompress_integ│                                                                                       
│     ral_bigint(#1, 1)     │                                                                                       
│__internal_decompress_integ│                                                                                       
│     ral_bigint(#2, 1)     │                                                                                       
│             #3            │                                                                                       
│             #4            │                                                                                       
│             #5            │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│       HASH_GROUP_BY       │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│             #0            │                                                                                       
│             #1            │                                                                                       
│             #2            │                                                                                       
│             #3            │                                                                                       
│             #4            │                                                                                       
│          sum(#5)          │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│           c_name          │                                                                                       
│         c_custkey         │                                                                                       
│         o_orderkey        │                                                                                       
│        o_orderdate        │                                                                                       
│        o_totalprice       │                                                                                       
│         l_quantity        │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│__internal_compress_integra│                                                                                       
│     l_uinteger(#0, 1)     │                                                                                       
│             #1            │                                                                                       
│__internal_compress_integra│                                                                                       
│     l_uinteger(#2, 1)     │                                                                                       
│__internal_compress_integra│                                                                                       
│     l_uinteger(#3, 1)     │                                                                                       
│             #4            │                                                                                       
│             #5            │                                                                                       
│             #6            │                                                                                       
│__internal_compress_integra│                                                                                       
│     l_uinteger(#7, 1)     │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         HASH_JOIN         │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│           INNER           │                                                                                       
│      o_orderkey = #0      ├────────────────────────────────────────────────────────────────────────┐              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                        │              
│        EC: 3618677        │                                                                        │              
└─────────────┬─────────────┘                                                                        │                                           
┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐
│         HASH_JOIN         │                                                          │         PROJECTION        │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│           INNER           │                                                          │__internal_decompress_integ│
│  l_orderkey = o_orderkey  ├──────────────┐                                           │     ral_bigint(#0, 1)     │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                           │                           │
│        EC: 3618677        │              │                                           │                           │
└─────────────┬─────────────┘              │                                           └─────────────┬─────────────┘                             
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐
│         SEQ_SCAN          ││         HASH_JOIN         │                             │       HASH_GROUP_BY       │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│          lineitem         ││           INNER           │                             │             #0            │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   o_custkey = c_custkey   │                             │                           │
│         l_orderkey        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐              │                           │
│         l_quantity        ││        Build Min: 1       │              │              │                           │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││     Build Max: 149999     │              │              │                           │
│        EC: 6001215        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              │                           │
│                           ││         EC: 904486        │              │              │                           │
└───────────────────────────┘└─────────────┬─────────────┘              │              └─────────────┬─────────────┘                             
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐
                             │         SEQ_SCAN          ││         SEQ_SCAN          ││         PROJECTION        │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                             │           orders          ││          customer         ││             #0            │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │
                             │         o_orderkey        ││         c_custkey         ││                           │
                             │         o_custkey         ││           c_name          ││                           │
                             │        o_orderdate        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │
                             │        o_totalprice       ││ Filters: c_custkey<=149999││                           │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││  AND c_custkey IS NOT NULL││                           │
                             │        EC: 1500000        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │
                             │                           ││         EC: 150000        ││                           │
                             └───────────────────────────┘└───────────────────────────┘└─────────────┬─────────────┘                             
                                                                                       ┌─────────────┴─────────────┐
                                                                                       │         PROJECTION        │
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                       │__internal_compress_integra│
                                                                                       │     l_uinteger(#0, 1)     │
                                                                                       └─────────────┬─────────────┘                             
                                                                                       ┌─────────────┴─────────────┐
                                                                                       │         PROJECTION        │
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                       │         l_orderkey        │
                                                                                       └─────────────┬─────────────┘                             
                                                                                       ┌─────────────┴─────────────┐
                                                                                       │           FILTER          │
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                       │ (sum(l_quantity) > 300.00)│
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                       │         EC: 47042         │
                                                                                       └─────────────┬─────────────┘                             
                                                                                       ┌─────────────┴─────────────┐
                                                                                       │         PROJECTION        │
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                       │__internal_decompress_integ│
                                                                                       │     ral_bigint(#0, 1)     │
                                                                                       │             #1            │
                                                                                       └─────────────┬─────────────┘                             
                                                                                       ┌─────────────┴─────────────┐
                                                                                       │       HASH_GROUP_BY       │
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                       │             #0            │
                                                                                       │    sum_no_overflow(#1)    │
                                                                                       └─────────────┬─────────────┘                             
                                                                                       ┌─────────────┴─────────────┐
                                                                                       │         PROJECTION        │
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                       │         l_orderkey        │
                                                                                       │         l_quantity        │
                                                                                       └─────────────┬─────────────┘                             
                                                                                       ┌─────────────┴─────────────┐
                                                                                       │         PROJECTION        │
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                       │__internal_compress_integra│
                                                                                       │     l_uinteger(#0, 1)     │
                                                                                       │             #1            │
                                                                                       └─────────────┬─────────────┘                             
                                                                                       ┌─────────────┴─────────────┐
                                                                                       │         SEQ_SCAN          │
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                       │          lineitem         │
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                       │         l_orderkey        │
                                                                                       │         l_quantity        │
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                       │        EC: 6001215        │
                                                                                       └───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

X {'RESULT_COLLECTOR0': 5e-06, 'PROJECTION1': 4e-06, 'UNGROUPED_AGGREGATE2': 1e-05, 'PROJECTION3': 1e-06, 'PROJECTION4': 3e-06, 'FILTER5': 0.00015, 'RIGHT_DELIM_JOIN6': 0.00319, 'HASH_JOIN7': 0.042634, 'SEQ_SCAN 8': 0.014629, 'SEQ_SCAN 9': 0.015484, 'HASH_JOIN10': 0.001751, 'PROJECTION11': 1.1e-05, 'PROJECTION12': 1.4e-05, 'HASH_GROUP_BY13': 0.003923, 'PROJECTION14': 3e-06, 'PROJECTION15': 2.4e-05, 'HASH_JOIN16': 0.067097, 'SEQ_SCAN 17': 0.007008, 'DELIM_SCAN18': 0.0, 'DUMMY_SCAN19': 0.0, 'HASH_GROUP_BY20': 0.000838}
**** output size:  1
LINEAGE_5_FILTER_15
LINEAGE_5_HASH_GROUP_BY_10
LINEAGE_5_HASH_GROUP_BY_5
LINEAGE_5_HASH_JOIN_13
LINEAGE_5_HASH_JOIN_2
LINEAGE_5_HASH_JOIN_9
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_11
LINEAGE_5_SEQ_SCAN_12
SELECT sum(l_extendedprice) / 7.0 AS avg_yearly FROM lineitem, part WHERE p_partkey = l_partkey AND p_brand = 'Brand#23' AND p_container = 'MED BOX' AND l_quantity < ( SELECT 0.2 * avg(l_quantity) FROM lineitem WHERE l_partkey = p_partkey);
   query_id  ...                                               plan
0         5  ...  {"name": "PROJECTION", "opid": "19", "children...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               SELECT sum(l_extendedprice) / 7.0 AS avg_yearl...
size_bytes_max                                                 426882
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "PROJECTION", "opid": "19", "children...
Name: 0, dtype: object
{"name": "PROJECTION", "opid": "19", "children": [{"name": "UNGROUPED_AGGREGATE", "opid": "18", "children": [{"name": "PROJECTION", "opid": "17", "children": [{"name": "PROJECTION", "opid": "16", "children": [{"name": "FILTER", "opid": "15", "children": [{"name": "RIGHT_DELIM_JOIN", "opid": "14", "children": [{"name": "HASH_GROUP_BY", "opid": "10", "children": [],"table": "","extra": "#0"},{"name": "HASH_JOIN", "opid": "9", "children": [{"name": "PROJECTION", "opid": "7", "children": [{"name": "PROJECTION", "opid": "6", "children": [{"name": "HASH_GROUP_BY", "opid": "5", "children": [{"name": "PROJECTION", "opid": "4", "children": [{"name": "PROJECTION", "opid": "3", "children": [{"name": "HASH_JOIN", "opid": "2", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_partkey\nl_quantity\n[INFOSEPARATOR]\nEC: 6001215"},{"name": "DELIM_SCAN", "opid": "1", "children": [],"table": "","extra": ""}],"table": "","extra": "INNER\nl_partkey = p_partkey\n\n[INFOSEPARATOR]\nEC: 6001215\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n#1\n#2\n"}],"table": "","extra": "p_partkey\nl_quantity\n"}],"table": "","extra": "#0\navg(#1)"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n#1\n"}],"table": "","extra": "(0.2 * avg(l_quantity))\np_partkey\n"},{"name": "DUMMY_SCAN", "opid": "8", "children": [],"table": "","extra": ""}],"table": "","extra": "RIGHT\np_partkey IS NOT DISTINCT FROM p_partkey\n\n[INFOSEPARATOR]\nEC: 3000607\n"},{"name": "HASH_JOIN", "opid": "13", "children": [{"name": "SEQ_SCAN ", "opid": "11", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_partkey\nl_quantity\nl_extendedprice\n[INFOSEPARATOR]\nEC: 6001215"},{"name": "SEQ_SCAN ", "opid": "12", "children": [],"table": "part","extra": "part\n[INFOSEPARATOR]\np_partkey\n[INFOSEPARATOR]\nFilters: p_brand='Brand#23' AND p_brand IS NOT NULL\np_container='MED BOX' AND p_container IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 5000"}],"table": "","extra": "INNER\nl_partkey = p_partkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 80175\n"}],"table": "","extra": "RIGHT\np_partkey IS NOT DISTINCT FROM p_partkey\n\n[INFOSEPARATOR]\nEC: 3000607\n"}],"table": "","extra": "(CAST(l_quantity AS DOUBLE) < SUBQUERY)\n[INFOSEPARATOR]\nEC: 3000607"}],"table": "","extra": "#0\n#3\n#4\n"}],"table": "","extra": "l_extendedprice\n"}],"table": "","extra": "sum(#0)"}],"table": "","extra": "avg_yearly\n"}
%%%%%%%%%%%%%%%% Running Query #  18  threads:  4
SELECT c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, sum(l_quantity) FROM customer, orders, lineitem WHERE o_orderkey IN ( SELECT l_orderkey FROM lineitem GROUP BY l_orderkey HAVING sum(l_quantity) > 300) AND c_custkey = o_custkey AND o_orderkey = l_orderkey GROUP BY c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice ORDER BY o_totalprice DESC, o_orderdate LIMIT 100;
Run:  None SELECT c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, sum(l_quantity) FROM customer, orders, lineitem WHERE o_orderkey IN ( SELECT l_orderkey FROM lineitem GROUP BY l_orderkey HAVING sum(l_quantity) > 300) AND c_custkey = o_custkey AND o_orderkey = l_orderkey GROUP BY c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice ORDER BY o_totalprice DESC, o_orderdate LIMIT 100;
Avg Time in sec:  0.48638141993433237  output size:  57
                c_name  c_custkey  ...  o_totalprice sum(l_quantity)
0   Customer#000128120     128120  ...     544089.09           323.0
1   Customer#000144617     144617  ...     530604.44           317.0
2   Customer#000013940      13940  ...     522720.61           304.0
3   Customer#000066790      66790  ...     515531.82           327.0
4   Customer#000046435      46435  ...     508047.99           309.0
5   Customer#000015272      15272  ...     500241.33           302.0
6   Customer#000146608     146608  ...     499794.58           303.0
7   Customer#000096103      96103  ...     494398.79           312.0
8   Customer#000024341      24341  ...     491348.26           302.0
9   Customer#000137446     137446  ...     487763.25           311.0
10  Customer#000107590     107590  ...     485141.38           301.0
11  Customer#000050008      50008  ...     483891.26           302.0
12  Customer#000015619      15619  ...     480083.96           318.0
13  Customer#000077260      77260  ...     479499.43           307.0
14  Customer#000109379     109379  ...     478064.11           302.0
15  Customer#000054602      54602  ...     471220.08           307.0
16  Customer#000105995     105995  ...     469692.58           307.0
17  Customer#000148885     148885  ...     469630.44           313.0
18  Customer#000114586     114586  ...     469605.59           308.0
19  Customer#000105260     105260  ...     469360.57           303.0
20  Customer#000147197     147197  ...     467149.67           320.0
21  Customer#000064483      64483  ...     466991.35           304.0
22  Customer#000136573     136573  ...     461282.73           301.0
23  Customer#000016384      16384  ...     458378.92           312.0
24  Customer#000117919     117919  ...     456815.92           317.0
25  Customer#000012251      12251  ...     455107.26           309.0
26  Customer#000120098     120098  ...     453451.23           308.0
27  Customer#000066098      66098  ...     453436.16           304.0
28  Customer#000117076     117076  ...     449545.85           301.0
29  Customer#000129379     129379  ...     448665.79           303.0
30  Customer#000126865     126865  ...     447606.65           320.0
31  Customer#000088876      88876  ...     446717.46           304.0
32  Customer#000036619      36619  ...     446704.09           328.0
33  Customer#000141823     141823  ...     446269.12           310.0
34  Customer#000053029      53029  ...     446144.49           302.0
35  Customer#000018188      18188  ...     443807.22           308.0
36  Customer#000066533      66533  ...     443576.50           305.0
37  Customer#000037729      37729  ...     441082.97           309.0
38  Customer#000003566       3566  ...     439803.36           304.0
39  Customer#000045538      45538  ...     436275.31           305.0
40  Customer#000081581      81581  ...     435405.90           305.0
41  Customer#000119989     119989  ...     434568.25           320.0
42  Customer#000003680       3680  ...     433525.97           301.0
43  Customer#000113131     113131  ...     432957.75           301.0
44  Customer#000141098     141098  ...     430986.69           301.0
45  Customer#000093392      93392  ...     425487.51           304.0
46  Customer#000015631      15631  ...     419879.59           302.0
47  Customer#000112987     112987  ...     418161.49           305.0
48  Customer#000012599      12599  ...     415200.61           304.0
49  Customer#000105410     105410  ...     412754.51           302.0
50  Customer#000149842     149842  ...     411329.35           302.0
51  Customer#000010129      10129  ...     409129.85           309.0
52  Customer#000069904      69904  ...     408513.00           305.0
53  Customer#000017746      17746  ...     408446.93           303.0
54  Customer#000013072      13072  ...     399195.47           301.0
55  Customer#000082441      82441  ...     382579.74           305.0
56  Customer#000088703      88703  ...     363812.12           302.0

[57 rows x 6 columns]
compressed filter_log_size: 3973
compressed filter_log_buffer_size: 228
compressed limit_offset_size: 2256
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 516368
compressed perfect_full_scan_ht_log_buffer_size: 513872
compressed perfect_probe_ht_log_size: 3419416
compressed perfect_probe_ht_log_buffer_size: 3410440
compressed row_group_log_size: 49542
compressed row_group_log_buffer_size: 820
compressed scatter_log_size: 19001472
compressed scatter_log_buffer_size: 18984105
compressed scatter_sel_log_size: 7415893
compressed scatter_sel_log_buffer_size: 7403129
compressed gather_log_size: 2112
compressed gather_log_buffer_size: 0
compressed combine_log_size: 114809
compressed combine_log_buffer_size: 104339
compressed finalize_states_log_size: 599025
compressed finalize_states_log_buffer_size: 591542
compressed join_gather_log_size: 19644652
compressed join_gather_log_buffer_size: 19443223
compressed reorder_log_size: 3493
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 2112
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 2112
compressed nlj_log_buffer_size: 0
compressed total_size: 50777235
compressed total_buffer_size: 50451698
compressed total_element_size: 325537

{'name': 'Query', 'result': 0.473404, 'timing': 0.473404, 'cardinality': 0, 'extra-info': 'SELECT c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, sum(l_quantity) FROM customer, orders, lineitem WHERE o_orderkey IN ( SELECT l_orderkey FROM lineitem GROUP BY l_orderkey HAVING sum(l_quantity) > 300) AND c_custkey = o_custkey AND o_orderkey = l_orderkey GROUP BY c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice ORDER BY o_totalprice DESC, o_orderdate LIMIT 100;', 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 4.9e-05, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'LIMIT', 'timing': 0.000123, 'cardinality': 57, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 1.9e-05, 'cardinality': 57, 'extra_info': '#0\n__internal_decompress_integral_bigint(#1, 1)\n__internal_decompress_integral_bigint(#2, 1)\n#3\n#4\n#5\n', 'children': [{'name': 'ORDER_BY', 'timing': 0.000196, 'cardinality': 57, 'extra_info': 'ORDERS:\norders.o_totalprice DESC\norders.o_orderdate ASC', 'children': [{'name': 'PROJECTION', 'timing': 1.9e-05, 'cardinality': 57, 'extra_info': '#0\n__internal_compress_integral_uinteger(#1, 1)\n__internal_compress_integral_uinteger(#2, 1)\n#3\n#4\n#5\n', 'children': [{'name': 'PROJECTION', 'timing': 2.3e-05, 'cardinality': 57, 'extra_info': '#0\n__internal_decompress_integral_bigint(#1, 1)\n__internal_decompress_integral_bigint(#2, 1)\n#3\n#4\n#5\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.004793, 'cardinality': 57, 'extra_info': '#0\n#1\n#2\n#3\n#4\nsum(#5)', 'children': [{'name': 'PROJECTION', 'timing': 3.2e-05, 'cardinality': 399, 'extra_info': 'c_name\nc_custkey\no_orderkey\no_orderdate\no_totalprice\nl_quantity\n', 'children': [{'name': 'PROJECTION', 'timing': 0.000205, 'cardinality': 399, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n#1\n__internal_compress_integral_uinteger(#2, 1)\n__internal_compress_integral_uinteger(#3, 1)\n#4\n#5\n#6\n__internal_compress_integral_uinteger(#7, 1)\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.085976, 'cardinality': 399, 'extra_info': 'INNER\no_orderkey = #0\n\n[INFOSEPARATOR]\nEC: 3618677\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.817192, 'cardinality': 6001215, 'extra_info': 'INNER\nl_orderkey = o_orderkey\n\n[INFOSEPARATOR]\nEC: 3618677\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.012824, 'cardinality': 6001215, 'extra_info': 'lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_quantity\n[INFOSEPARATOR]\nEC: 6001215', 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.052563, 'cardinality': 1500000, 'extra_info': 'INNER\no_custkey = c_custkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 149999\n\n[INFOSEPARATOR]\nEC: 904486\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.006649, 'cardinality': 1500000, 'extra_info': 'orders\n[INFOSEPARATOR]\no_orderkey\no_custkey\no_orderdate\no_totalprice\n[INFOSEPARATOR]\nEC: 1500000', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 0.004245, 'cardinality': 149999, 'extra_info': 'customer\n[INFOSEPARATOR]\nc_custkey\nc_name\n[INFOSEPARATOR]\nFilters: c_custkey<=149999 AND c_custkey IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 150000', 'children': []}]}]}, {'name': 'PROJECTION', 'timing': 1.4e-05, 'cardinality': 57, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.002027, 'cardinality': 57, 'extra_info': '#0', 'children': [{'name': 'PROJECTION', 'timing': 3e-06, 'cardinality': 57, 'extra_info': '#0\n', 'children': [{'name': 'PROJECTION', 'timing': 1.1e-05, 'cardinality': 57, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n', 'children': [{'name': 'PROJECTION', 'timing': 4e-06, 'cardinality': 57, 'extra_info': 'l_orderkey\n', 'children': [{'name': 'FILTER', 'timing': 0.005286, 'cardinality': 57, 'extra_info': '(sum(l_quantity) > 300.00)\n[INFOSEPARATOR]\nEC: 47042', 'children': [{'name': 'PROJECTION', 'timing': 0.001527, 'cardinality': 1500000, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n#1\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.540965, 'cardinality': 1500000, 'extra_info': '#0\nsum_no_overflow(#1)', 'children': [{'name': 'PROJECTION', 'timing': 0.0009, 'cardinality': 6001215, 'extra_info': 'l_orderkey\nl_quantity\n', 'children': [{'name': 'PROJECTION', 'timing': 0.016553, 'cardinality': 6001215, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n#1\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.013154, 'cardinality': 6001215, 'extra_info': 'lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_quantity\n[INFOSEPARATOR]\nEC: 6001215', 'children': []}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}
X {'RESULT_COLLECTOR0': 4.9e-05, 'LIMIT1': 0.000123, 'PROJECTION2': 1.9e-05, 'ORDER_BY3': 0.000196, 'PROJECTION4': 1.9e-05, 'PROJECTION5': 2.3e-05, 'HASH_GROUP_BY6': 0.004793, 'PROJECTION7': 3.2e-05, 'PROJECTION8': 0.000205, 'HASH_JOIN9': 0.085976, 'HASH_JOIN10': 0.817192, 'SEQ_SCAN 11': 0.012824, 'HASH_JOIN12': 0.052563, 'SEQ_SCAN 13': 0.006649, 'SEQ_SCAN 14': 0.004245, 'PROJECTION15': 1.4e-05, 'HASH_GROUP_BY16': 0.002027, 'PROJECTION17': 3e-06, 'PROJECTION18': 1.1e-05, 'PROJECTION19': 4e-06, 'FILTER20': 0.005286, 'PROJECTION21': 0.001527, 'HASH_GROUP_BY22': 0.540965, 'PROJECTION23': 0.0009, 'PROJECTION24': 0.016553, 'SEQ_SCAN 25': 0.013154}
**** output size:  57
LINEAGE_5_FILTER_10
LINEAGE_5_HASH_GROUP_BY_14
LINEAGE_5_HASH_GROUP_BY_19
LINEAGE_5_HASH_GROUP_BY_8
LINEAGE_5_HASH_JOIN_16
LINEAGE_5_HASH_JOIN_3
LINEAGE_5_HASH_JOIN_4
LINEAGE_5_LIMIT_24
LINEAGE_5_ORDER_BY_22
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_1
LINEAGE_5_SEQ_SCAN_2
LINEAGE_5_SEQ_SCAN_5
SELECT c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, sum(l_quantity) FROM customer, orders, lineitem WHERE o_orderkey IN ( SELECT l_orderkey FROM lineitem GROUP BY l_orderkey HAVING sum(l_quantity) > 300) AND c_custkey = o_custkey AND o_orderkey = l_orderkey GROUP BY c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice ORDER BY o_totalprice DESC, o_orderdate LIMIT 100;
   query_id  ...                                               plan
0         5  ...  {"name": "LIMIT", "opid": "24", "children": [{...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               SELECT c_name, c_custkey, o_orderkey, o_orderd...
size_bytes_max                                               50777235
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "LIMIT", "opid": "24", "children": [{...
Name: 0, dtype: object
{"name": "LIMIT", "opid": "24", "children": [{"name": "PROJECTION", "opid": "23", "children": [{"name": "ORDER_BY", "opid": "22", "children": [{"name": "PROJECTION", "opid": "21", "children": [{"name": "PROJECTION", "opid": "20", "children": [{"name": "HASH_GROUP_BY", "opid": "19", "children": [{"name": "PROJECTION", "opid": "18", "children": [{"name": "PROJECTION", "opid": "17", "children": [{"name": "HASH_JOIN", "opid": "16", "children": [{"name": "HASH_JOIN", "opid": "4", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_quantity\n[INFOSEPARATOR]\nEC: 6001215"},{"name": "HASH_JOIN", "opid": "3", "children": [{"name": "SEQ_SCAN ", "opid": "1", "children": [],"table": "orders","extra": "orders\n[INFOSEPARATOR]\no_orderkey\no_custkey\no_orderdate\no_totalprice\n[INFOSEPARATOR]\nEC: 1500000"},{"name": "SEQ_SCAN ", "opid": "2", "children": [],"table": "customer","extra": "customer\n[INFOSEPARATOR]\nc_custkey\nc_name\n[INFOSEPARATOR]\nFilters: c_custkey<=149999 AND c_custkey IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 150000"}],"table": "","extra": "INNER\no_custkey = c_custkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 149999\n\n[INFOSEPARATOR]\nEC: 904486\n"}],"table": "","extra": "INNER\nl_orderkey = o_orderkey\n\n[INFOSEPARATOR]\nEC: 3618677\n"},{"name": "PROJECTION", "opid": "15", "children": [{"name": "HASH_GROUP_BY", "opid": "14", "children": [{"name": "PROJECTION", "opid": "13", "children": [{"name": "PROJECTION", "opid": "12", "children": [{"name": "PROJECTION", "opid": "11", "children": [{"name": "FILTER", "opid": "10", "children": [{"name": "PROJECTION", "opid": "9", "children": [{"name": "HASH_GROUP_BY", "opid": "8", "children": [{"name": "PROJECTION", "opid": "7", "children": [{"name": "PROJECTION", "opid": "6", "children": [{"name": "SEQ_SCAN ", "opid": "5", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_quantity\n[INFOSEPARATOR]\nEC: 6001215"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n#1\n"}],"table": "","extra": "l_orderkey\nl_quantity\n"}],"table": "","extra": "#0\nsum_no_overflow(#1)"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n#1\n"}],"table": "","extra": "(sum(l_quantity) > 300.00)\n[INFOSEPARATOR]\nEC: 47042"}],"table": "","extra": "l_orderkey\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n"}],"table": "","extra": "#0\n"}],"table": "","extra": "#0"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n"}],"table": "","extra": "INNER\no_orderkey = #0\n\n[INFOSEPARATOR]\nEC: 3618677\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n#1\n__internal_compress_integral_uinteger(#2, 1)\n__internal_compress_integral_uinteger(#3, 1)\n#4\n#5\n#6\n__internal_compress_integral_uinteger(#7, 1)\n"}],"table": "","extra": "c_name\nc_custkey\no_orderkey\no_orderdate\no_totalprice\nl_quantity\n"}],"table": "","extra": "#0\n#1\n#2\n#3\n#4\nsum(#5)"}],"table": "","extra": "#0\n__internal_decompress_integral_bigint(#1, 1)\n__internal_decompress_integral_bigint(#2, 1)\n#3\n#4\n#5\n"}],"table": "","extra": "#0\n__internal_compress_integral_uinteger(#1, 1)\n__internal_compress_integral_uinteger(#2, 1)\n#3\n#4\n#5\n"}],"table": "","extra": "ORDERS:\norders.o_totalprice DESC\norders.o_orderdate ASC"}],"table": "","extra": "#0\n__internal_decompress_integral_bigint(#1, 1)\n__internal_decompress_integral_bigint(#2, 1)\n#3\n#4\n#5\n"}],"table": "","extra": ""}
Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                             
│    UNGROUPED_AGGREGATE    │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│          sum(#0)          │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│ (l_extendedprice * (1.00 -│                             
│        l_discount))       │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│             #1            │                             
│             #2            │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│             #1            │                             
│             #3            │                             
│             #4            │                             
│             #6            │                             
│             #7            │                             
│             #8            │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│           FILTER          │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│(((l_quantity <= 11.00) AND│                             
│ (p_size <= 5) AND (p_brand│                             
│     = 'Brand#12') AND (   │                             
│(p_container = 'SM CAS...  │                             
│(p_container = 'SM BOX...  │                             
│(p_container = 'SM PAC...  │                             
│(p_container = 'SM PKG...  │                             
│ ((l_quantity >= 10.00) AND│                             
│ (l_quantity <= 20.00) AND │                             
│(p_size <= 10) AND (p_brand│                             
│     = 'Brand#23') AND (   │                             
│(p_container = 'MED BA...  │                             
│(p_container = 'MED BO...  │                             
│(p_container = 'MED PK...  │                             
│(p_container = 'MED PA...  │                             
│  OR ((l_quantity >= 20.00)│                             
│  AND (l_quantity <= 30.00)│                             
│   AND (p_size <= 15) AND  │                             
│(p_brand = 'Brand#34')...  │                             
│(p_container = 'LG CAS...  │                             
│(p_container = 'LG BOX...  │                             
│(p_container = 'LG PAC...  │                             
│ (p_container = 'LG PKG')))│                             
│             )             │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│         EC: 160351        │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         HASH_JOIN         │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│           INNER           │                             
│   l_partkey = p_partkey   │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐              
│        Build Min: 1       │              │              
│     Build Max: 200000     │              │              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              
│         EC: 160351        │              │              
└─────────────┬─────────────┘              │                                           
┌─────────────┴─────────────┐┌─────────────┴─────────────┐
│           FILTER          ││         SEQ_SCAN          │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│ ((l_shipmode = 'AIR') OR  ││            part           │
│ (l_shipmode = 'AIR REG')) ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││         p_partkey         │
│         EC: 300060        ││          p_brand          │
│                           ││        p_container        │
│                           ││           p_size          │
│                           ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│                           ││         EC: 200000        │
└─────────────┬─────────────┘└───────────────────────────┘                             
┌─────────────┴─────────────┐                             
│         SEQ_SCAN          │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│          lineitem         │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│         l_partkey         │                             
│         l_quantity        │                             
│         l_shipmode        │                             
│      l_extendedprice      │                             
│         l_discount        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│  Filters: l_shipinstruct= │                             
│  'DELIVER IN PERSON' AND  │                             
│ l_shipinstruct IS NOT NULL│                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│         EC: 300060        │                             
└───────────────────────────┘                                                          

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

compressed filter_log_size: 257553
compressed filter_log_buffer_size: 223760
compressed limit_offset_size: 912
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 710609
compressed perfect_full_scan_ht_log_buffer_size: 709313
compressed perfect_probe_ht_log_size: 689177
compressed perfect_probe_ht_log_buffer_size: 648555
compressed row_group_log_size: 794752
compressed row_group_log_buffer_size: 753113
compressed scatter_log_size: 912
compressed scatter_log_buffer_size: 0
compressed scatter_sel_log_size: 823790
compressed scatter_sel_log_buffer_size: 821224
compressed gather_log_size: 912
compressed gather_log_buffer_size: 0
compressed combine_log_size: 912
compressed combine_log_buffer_size: 0
compressed finalize_states_log_size: 912
compressed finalize_states_log_buffer_size: 0
compressed join_gather_log_size: 912
compressed join_gather_log_buffer_size: 0
compressed reorder_log_size: 1368
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 912
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 912
compressed nlj_log_buffer_size: 0
compressed total_size: 3284545
compressed total_buffer_size: 3155965
compressed total_element_size: 128580

%%%%%%%%%%%%%%%% Running Query #  19  threads:  4
SELECT sum(l_extendedprice * (1 - l_discount)) AS revenue FROM lineitem, part WHERE (p_partkey = l_partkey AND p_brand = 'Brand#12' AND p_container IN ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') AND l_quantity >= 1 AND l_quantity <= 1 + 10 AND p_size BETWEEN 1 AND 5 AND l_shipmode IN ('AIR', 'AIR REG') AND l_shipinstruct = 'DELIVER IN PERSON') OR (p_partkey = l_partkey AND p_brand = 'Brand#23' AND p_container IN ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') AND l_quantity >= 10 AND l_quantity <= 10 + 10 AND p_size BETWEEN 1 AND 10 AND l_shipmode IN ('AIR', 'AIR REG') AND l_shipinstruct = 'DELIVER IN PERSON') OR (p_partkey = l_partkey AND p_brand = 'Brand#34' AND p_container IN ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') AND l_quantity >= 20 AND l_quantity <= 20 + 10 AND p_size BETWEEN 1 AND 15 AND l_shipmode IN ('AIR', 'AIR REG') AND l_shipinstruct = 'DELIVER IN PERSON');
Run:  None SELECT sum(l_extendedprice * (1 - l_discount)) AS revenue FROM lineitem, part WHERE (p_partkey = l_partkey AND p_brand = 'Brand#12' AND p_container IN ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') AND l_quantity >= 1 AND l_quantity <= 1 + 10 AND p_size BETWEEN 1 AND 5 AND l_shipmode IN ('AIR', 'AIR REG') AND l_shipinstruct = 'DELIVER IN PERSON') OR (p_partkey = l_partkey AND p_brand = 'Brand#23' AND p_container IN ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') AND l_quantity >= 10 AND l_quantity <= 10 + 10 AND p_size BETWEEN 1 AND 10 AND l_shipmode IN ('AIR', 'AIR REG') AND l_shipinstruct = 'DELIVER IN PERSON') OR (p_partkey = l_partkey AND p_brand = 'Brand#34' AND p_container IN ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') AND l_quantity >= 20 AND l_quantity <= 20 + 10 AND p_size BETWEEN 1 AND 15 AND l_shipmode IN ('AIR', 'AIR REG') AND l_shipinstruct = 'DELIVER IN PERSON');
Avg Time in sec:  0.20611103205010295  output size:  1
        revenue
0  3.083843e+06
{'name': 'Query', 'result': 0.202069, 'timing': 0.202069, 'cardinality': 0, 'extra-info': "SELECT sum(l_extendedprice * (1 - l_discount)) AS revenue FROM lineitem, part WHERE (p_partkey = l_partkey AND p_brand = 'Brand#12' AND p_container IN ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') AND l_quantity >= 1 AND l_quantity <= 1 + 10 AND p_size BETWEEN 1 AND 5 AND l_shipmode IN ('AIR', 'AIR REG') AND l_shipinstruct = 'DELIVER IN PERSON') OR (p_partkey = l_partkey AND p_brand = 'Brand#23' AND p_container IN ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') AND l_quantity >= 10 AND l_quantity <= 10 + 10 AND p_size BETWEEN 1 AND 10 AND l_shipmode IN ('AIR', 'AIR REG') AND l_shipinstruct = 'DELIVER IN PERSON') OR (p_partkey = l_partkey AND p_brand = 'Brand#34' AND p_container IN ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') AND l_quantity >= 20 AND l_quantity <= 20 + 10 AND p_size BETWEEN 1 AND 15 AND l_shipmode IN ('AIR', 'AIR REG') AND l_shipinstruct = 'DELIVER IN PERSON');", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 9e-06, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'UNGROUPED_AGGREGATE', 'timing': 2.6e-05, 'cardinality': 1, 'extra_info': 'sum(#0)', 'children': [{'name': 'PROJECTION', 'timing': 3.6e-05, 'cardinality': 121, 'extra_info': '(l_extendedprice * (1.00 - l_discount))\n', 'children': [{'name': 'PROJECTION', 'timing': 5e-06, 'cardinality': 121, 'extra_info': '#1\n#2\n', 'children': [{'name': 'PROJECTION', 'timing': 1.2e-05, 'cardinality': 121, 'extra_info': '#1\n#3\n#4\n#6\n#7\n#8\n', 'children': [{'name': 'FILTER', 'timing': 0.077742, 'cardinality': 121, 'extra_info': "(((l_quantity <= 11.00) AND (p_size <= 5) AND (p_brand = 'Brand#12') AND ((p_container = 'SM CASE') OR (p_container = 'SM BOX') OR (p_container = 'SM PACK') OR (p_container = 'SM PKG'))) OR ((l_quantity >= 10.00) AND (l_quantity <= 20.00) AND (p_size <= 10) AND (p_brand = 'Brand#23') AND ((p_container = 'MED BAG') OR (p_container = 'MED BOX') OR (p_container = 'MED PKG') OR (p_container = 'MED PACK'))) OR ((l_quantity >= 20.00) AND (l_quantity <= 30.00) AND (p_size <= 15) AND (p_brand = 'Brand#34') AND ((p_container = 'LG CASE') OR (p_container = 'LG BOX') OR (p_container = 'LG PACK') OR (p_container = 'LG PKG'))))\n[INFOSEPARATOR]\nEC: 160351", 'children': [{'name': 'HASH_JOIN', 'timing': 0.047033, 'cardinality': 214377, 'extra_info': 'INNER\nl_partkey = p_partkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 160351\n', 'children': [{'name': 'FILTER', 'timing': 0.046791, 'cardinality': 214377, 'extra_info': "((l_shipmode = 'AIR') OR (l_shipmode = 'AIR REG'))\n[INFOSEPARATOR]\nEC: 300060", 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.412632, 'cardinality': 1500048, 'extra_info': "lineitem\n[INFOSEPARATOR]\nl_partkey\nl_quantity\nl_shipmode\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nFilters: l_shipinstruct='DELIVER IN PERSON' AND l_shipinstruct IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 300060", 'children': []}]}, {'name': 'SEQ_SCAN ', 'timing': 0.012371, 'cardinality': 200000, 'extra_info': 'part\n[INFOSEPARATOR]\np_partkey\np_brand\np_container\np_size\n[INFOSEPARATOR]\nEC: 200000', 'children': []}]}]}]}]}]}]}]}]}
X {'RESULT_COLLECTOR0': 9e-06, 'UNGROUPED_AGGREGATE1': 2.6e-05, 'PROJECTION2': 3.6e-05, 'PROJECTION3': 5e-06, 'PROJECTION4': 1.2e-05, 'FILTER5': 0.077742, 'HASH_JOIN6': 0.047033, 'FILTER7': 0.046791, 'SEQ_SCAN 8': 0.412632, 'SEQ_SCAN 9': 0.012371}
**** output size:  1
LINEAGE_5_FILTER_1
LINEAGE_5_FILTER_4
LINEAGE_5_HASH_JOIN_3
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_2
SELECT sum(l_extendedprice * (1 - l_discount)) AS revenue FROM lineitem, part WHERE (p_partkey = l_partkey AND p_brand = 'Brand#12' AND p_container IN ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') AND l_quantity >= 1 AND l_quantity <= 1 + 10 AND p_size BETWEEN 1 AND 5 AND l_shipmode IN ('AIR', 'AIR REG') AND l_shipinstruct = 'DELIVER IN PERSON') OR (p_partkey = l_partkey AND p_brand = 'Brand#23' AND p_container IN ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') AND l_quantity >= 10 AND l_quantity <= 10 + 10 AND p_size BETWEEN 1 AND 10 AND l_shipmode IN ('AIR', 'AIR REG') AND l_shipinstruct = 'DELIVER IN PERSON') OR (p_partkey = l_partkey AND p_brand = 'Brand#34' AND p_container IN ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') AND l_quantity >= 20 AND l_quantity <= 20 + 10 AND p_size BETWEEN 1 AND 15 AND l_shipmode IN ('AIR', 'AIR REG') AND l_shipinstruct = 'DELIVER IN PERSON');
   query_id  ...                                               plan
0         5  ...  {"name": "UNGROUPED_AGGREGATE", "opid": "8", "...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               SELECT sum(l_extendedprice * (1 - l_discount))...
size_bytes_max                                                3284545
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "UNGROUPED_AGGREGATE", "opid": "8", "...
Name: 0, dtype: object
{"name": "UNGROUPED_AGGREGATE", "opid": "8", "children": [{"name": "PROJECTION", "opid": "7", "children": [{"name": "PROJECTION", "opid": "6", "children": [{"name": "PROJECTION", "opid": "5", "children": [{"name": "FILTER", "opid": "4", "children": [{"name": "HASH_JOIN", "opid": "3", "children": [{"name": "FILTER", "opid": "1", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_partkey\nl_quantity\nl_shipmode\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nFilters: l_shipinstruct='DELIVER IN PERSON' AND l_shipinstruct IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 300060"}],"table": "","extra": "((l_shipmode = 'AIR') OR (l_shipmode = 'AIR REG'))\n[INFOSEPARATOR]\nEC: 300060"},{"name": "SEQ_SCAN ", "opid": "2", "children": [],"table": "part","extra": "part\n[INFOSEPARATOR]\np_partkey\np_brand\np_container\np_size\n[INFOSEPARATOR]\nEC: 200000"}],"table": "","extra": "INNER\nl_partkey = p_partkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 160351\n"}],"table": "","extra": "(((l_quantity <= 11.00) AND (p_size <= 5) AND (p_brand = 'Brand#12') AND ((p_container = 'SM CASE') OR (p_container = 'SM BOX') OR (p_container = 'SM PACK') OR (p_container = 'SM PKG'))) OR ((l_quantity >= 10.00) AND (l_quantity <= 20.00) AND (p_size <= 10) AND (p_brand = 'Brand#23') AND ((p_container = 'MED BAG') OR (p_container = 'MED BOX') OR (p_container = 'MED PKG') OR (p_container = 'MED PACK'))) OR ((l_quantity >= 20.00) AND (l_quantity <= 30.00) AND (p_size <= 15) AND (p_brand = 'Brand#34') AND ((p_container = 'LG CASE') OR (p_container = 'LG BOX') OR (p_container = 'LG PACK') OR (p_container = 'LG PKG'))))\n[INFOSEPARATOR]\nEC: 160351"}],"table": "","extra": "#1\n#3\n#4\n#6\n#7\n#8\n"}],"table": "","extra": "#1\n#2\n"}],"table": "","extra": "(l_extendedprice * (1.00 - l_discount))\n"}],"table": "","extra": "sum(#0)"}
Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                                                                                                                                                                              
│          ORDER_BY         │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│          ORDERS:          │                                                                                                                                                                              
│    supplier.s_name ASC    │                                                                                                                                                                              
└─────────────┬─────────────┘                                                                                                                                                                                                           
┌─────────────┴─────────────┐                                                                                                                                                                              
│         PROJECTION        │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│           s_name          │                                                                                                                                                                              
│         s_address         │                                                                                                                                                                              
└─────────────┬─────────────┘                                                                                                                                                                                                           
┌─────────────┴─────────────┐                                                                                                                                                                              
│         HASH_JOIN         │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│           INNER           │                                                                                                                                                                              
│       #0 = s_suppkey      │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐                                           
│        Build Min: 1       │                                                                                                                                  │                                           
│      Build Max: 10000     │                                                                                                                                  │                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                  │                                           
│          EC: 400          │                                                                                                                                  │                                           
└─────────────┬─────────────┘                                                                                                                                  │                                                                        
┌─────────────┴─────────────┐                                                                                                                    ┌─────────────┴─────────────┐                             
│         PROJECTION        │                                                                                                                    │         HASH_JOIN         │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│__internal_decompress_integ│                                                                                                                    │           INNER           │                             
│     ral_bigint(#0, 1)     │                                                                                                                    │ s_nationkey = n_nationkey │                             
│                           │                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐              
│                           │                                                                                                                    │        Build Min: 0       │              │              
│                           │                                                                                                                    │       Build Max: 24       │              │              
│                           │                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              
│                           │                                                                                                                    │          EC: 400          │              │              
└─────────────┬─────────────┘                                                                                                                    └─────────────┬─────────────┘              │                                           
┌─────────────┴─────────────┐                                                                                                                    ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
│       HASH_GROUP_BY       │                                                                                                                    │         SEQ_SCAN          ││         SEQ_SCAN          │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│             #0            │                                                                                                                    │          supplier         ││           nation          │
│                           │                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│                           │                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│                           │                                                                                                                    │         EC: 10000         ││  Filters: n_name='CANADA' │
│                           │                                                                                                                    │                           ││   AND n_name IS NOT NULL  │
│                           │                                                                                                                    │                           ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│                           │                                                                                                                    │                           ││           EC: 1           │
└─────────────┬─────────────┘                                                                                                                    └───────────────────────────┘└───────────────────────────┘                             
┌─────────────┴─────────────┐                                                                                                                                                                              
│         PROJECTION        │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│             #0            │                                                                                                                                                                              
└─────────────┬─────────────┘                                                                                                                                                                                                           
┌─────────────┴─────────────┐                                                                                                                                                                              
│         PROJECTION        │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│__internal_compress_integra│                                                                                                                                                                              
│     l_usmallint(#0, 1)    │                                                                                                                                                                              
└─────────────┬─────────────┘                                                                                                                                                                                                           
┌─────────────┴─────────────┐                                                                                                                                                                              
│         PROJECTION        │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│         ps_suppkey        │                                                                                                                                                                              
└─────────────┬─────────────┘                                                                                                                                                                                                           
┌─────────────┴─────────────┐                                                                                                                                                                              
│         PROJECTION        │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│             #0            │                                                                                                                                                                              
│             #4            │                                                                                                                                                                              
│             #5            │                                                                                                                                                                              
└─────────────┬─────────────┘                                                                                                                                                                                                           
┌─────────────┴─────────────┐                                                                                                                                                                              
│           FILTER          │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│    (CAST(ps_availqty AS   │                                                                                                                                                                              
│ DECIMAL(38,3)) > SUBQUERY)│                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│         EC: 800000        │                                                                                                                                                                              
└─────────────┬─────────────┘                                                                                                                                                                                                           
┌─────────────┴─────────────┐                                                                                                                                                                              
│      RIGHT_DELIM_JOIN     │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│           RIGHT           │                                                                                                                                                                              
│ ps_partkey IS NOT DISTINCT│                                                                                                                                                                              
│       FROM ps_partkey     ├───────────────────────────────────────────┐                                                                                                                                  
│ ps_suppkey IS NOT DISTINCT│                                           │                                                                                                                                  
│       FROM ps_suppkey     │                                           │                                                                                                                                  
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                           │                                                                                                                                  
│         EC: 800000        │                                           │                                                                                                                                  
└─────────────┬─────────────┘                                           │                                                                                                                                                               
┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐                                                                                                                    
│         HASH_JOIN         │                             │         HASH_JOIN         │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│           INNER           │                             │           RIGHT           │                                                                                                                    
│      ps_partkey = #0      │                             │ ps_partkey IS NOT DISTINCT│                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐              │       FROM ps_partkey     ├───────────────────────────────────────────┐                                                                        
│        Build Min: 1       │              │              │ ps_suppkey IS NOT DISTINCT│                                           │                                                                        
│     Build Max: 200000     │              │              │       FROM ps_suppkey     │                                           │                                                                        
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                           │                                                                        
│         EC: 800000        │              │              │         EC: 800000        │                                           │                                                                        
└─────────────┬─────────────┘              │              └─────────────┬─────────────┘                                           │                                                                                                     
┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐                                                          
│         SEQ_SCAN          ││         PROJECTION        ││         PROJECTION        │                             │         DUMMY_SCAN        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │                           │                                                          
│          partsupp         ││__internal_decompress_integ││  (0.5 * sum(l_quantity))  │                             │                           │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││     ral_bigint(#0, 1)     ││         ps_partkey        │                             │                           │                                                          
│         ps_partkey        ││                           ││         ps_suppkey        │                             │                           │                                                          
│        ps_availqty        ││                           ││                           │                             │                           │                                                          
│         ps_suppkey        ││                           ││                           │                             │                           │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           ││                           │                             │                           │                                                          
│         EC: 800000        ││                           ││                           │                             │                           │                                                          
└───────────────────────────┘└─────────────┬─────────────┘└─────────────┬─────────────┘                             └───────────────────────────┘                                                                                       
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                                                    
                             │       HASH_GROUP_BY       ││         PROJECTION        │                                                                                                                    
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
                             │             #0            ││__internal_decompress_integ│                                                                                                                    
                             │                           ││     ral_bigint(#0, 1)     │                                                                                                                    
                             │                           ││__internal_decompress_integ│                                                                                                                    
                             │                           ││     ral_bigint(#1, 1)     │                                                                                                                    
                             │                           ││             #2            │                                                                                                                    
                             └─────────────┬─────────────┘└─────────────┬─────────────┘                                                                                                                                                 
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                                                    
                             │         PROJECTION        ││       HASH_GROUP_BY       │                                                                                                                    
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
                             │             #0            ││             #0            │                                                                                                                    
                             │                           ││             #1            │                                                                                                                    
                             │                           ││          sum(#2)          │                                                                                                                    
                             └─────────────┬─────────────┘└─────────────┬─────────────┘                                                                                                                                                 
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                                                    
                             │         PROJECTION        ││         PROJECTION        │                                                                                                                    
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
                             │__internal_compress_integra││         ps_partkey        │                                                                                                                    
                             │     l_uinteger(#0, 1)     ││         ps_suppkey        │                                                                                                                    
                             │                           ││         l_quantity        │                                                                                                                    
                             └─────────────┬─────────────┘└─────────────┬─────────────┘                                                                                                                                                 
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                                                    
                             │         PROJECTION        ││         PROJECTION        │                                                                                                                    
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
                             │         p_partkey         ││__internal_compress_integra│                                                                                                                    
                             │                           ││     l_uinteger(#0, 1)     │                                                                                                                    
                             │                           ││__internal_compress_integra│                                                                                                                    
                             │                           ││     l_usmallint(#1, 1)    │                                                                                                                    
                             │                           ││             #2            │                                                                                                                    
                             │                           ││             #3            │                                                                                                                    
                             │                           ││             #4            │                                                                                                                    
                             └─────────────┬─────────────┘└─────────────┬─────────────┘                                                                                                                                                 
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                                                    
                             │           FILTER          ││         HASH_JOIN         │                                                                                                                    
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
                             │  prefix(p_name, 'forest') ││           INNER           │                                                                                                                    
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   l_partkey = ps_partkey  ├──────────────┐                                                                                                     
                             │          EC: 8000         ││   l_suppkey = ps_suppkey  │              │                                                                                                     
                             │                           ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                                                                                     
                             │                           ││        EC: 1200243        │              │                                                                                                     
                             └─────────────┬─────────────┘└─────────────┬─────────────┘              │                                                                                                                                  
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                       
                             │         SEQ_SCAN          ││         SEQ_SCAN          ││         DELIM_SCAN        │                                                                                       
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                                                                       
                             │            part           ││          lineitem         ││                           │                                                                                       
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                                                                       
                             │           p_name          ││         l_partkey         ││                           │                                                                                       
                             │         p_partkey         ││         l_suppkey         ││                           │                                                                                       
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││         l_quantity        ││                           │                                                                                       
                             │ Filters: p_name>='forest' ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                                                                       
                             │   AND p_name<'foresu' AND ││ Filters: l_shipdate>='1994││                           │                                                                                       
                             │     p_name IS NOT NULL    ││-01-01'::DATE AND l_sh...  ││                           │                                                                                       
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││  <'1995-01-01'::DATE AND  ││                           │                                                                                       
                             │         EC: 40000         ││   l_shipdate IS NOT NULL  ││                           │                                                                                       
                             │                           ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                                                                       
                             │                           ││        EC: 1200243        ││                           │                                                                                       
                             └───────────────────────────┘└───────────────────────────┘└───────────────────────────┘                                                                                                                    

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

%%%%%%%%%%%%%%%% Running Query #  20  threads:  4
SELECT s_name, s_address FROM supplier, nation WHERE s_suppkey IN ( SELECT ps_suppkey FROM partsupp WHERE ps_partkey IN ( SELECT p_partkey FROM part WHERE p_name LIKE 'forest%') AND ps_availqty > ( SELECT 0.5 * sum(l_quantity) FROM lineitem WHERE l_partkey = ps_partkey AND l_suppkey = ps_suppkey AND l_shipdate >= CAST('1994-01-01' AS date) AND l_shipdate < CAST('1995-01-01' AS date))) AND s_nationkey = n_nationkey AND n_name = 'CANADA' ORDER BY s_name;
Run:  None SELECT s_name, s_address FROM supplier, nation WHERE s_suppkey IN ( SELECT ps_suppkey FROM partsupp WHERE ps_partkey IN ( SELECT p_partkey FROM part WHERE p_name LIKE 'forest%') AND ps_availqty > ( SELECT 0.5 * sum(l_quantity) FROM lineitem WHERE l_partkey = ps_partkey AND l_suppkey = ps_suppkey AND l_shipdate >= CAST('1994-01-01' AS date) AND l_shipdate < CAST('1995-01-01' AS date))) AND s_nationkey = n_nationkey AND n_name = 'CANADA' ORDER BY s_name;
Avg Time in sec:  0.07039776491001248  output size:  186
                 s_name                               s_address
0    Supplier#000000020               JtPqm19E7tF 152Rl1wQZ8j0H
1    Supplier#000000091    35WVnU7GLNbQDcc2TARavGtk6RB6ZCd46UAY
2    Supplier#000000205                            Alrx5TN,hdnG
3    Supplier#000000285           q TMZEDyZtv vUiFKBhT3NJlnIxpL
4    Supplier#000000287                       UQR8bUA4V2HxVbw9K
..                  ...                                     ...
181  Supplier#000009811                  nXIxtBT6D1v6TCb2iMYkyU
182  Supplier#000009812     rbl9euXFoPLlKQVYDVyRouslbbbKDHAkyXY
183  Supplier#000009846  WTzdvihXbyqnx0JfbbVaxBOcO9d93DYbtBhi J
184  Supplier#000009899                       U3NBqk s Zz06al2m
185  Supplier#000009974         Uvh0hWngOu96WgB,OafBQOqwpWqzwg8

[186 rows x 2 columns]
{'name': 'Query', 'result': 0.062974, 'timing': 0.062974, 'cardinality': 0, 'extra-info': "SELECT s_name, s_address FROM supplier, nation WHERE s_suppkey IN ( SELECT ps_suppkey FROM partsupp WHERE ps_partkey IN ( SELECT p_partkey FROM part WHERE p_name LIKE 'forest%') AND ps_availqty > ( SELECT 0.5 * sum(l_quantity) FROM lineitem WHERE l_partkey = ps_partkey AND l_suppkey = ps_suppkey AND l_shipdate >= CAST('1994-01-01' AS date) AND l_shipdate < CAST('1995-01-01' AS date))) AND s_nationkey = n_nationkey AND n_name = 'CANADA' ORDER BY s_name;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 3.6e-05, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'ORDER_BY', 'timing': 0.000152, 'cardinality': 186, 'extra_info': 'ORDERS:\nsupplier.s_name ASC', 'children': [{'name': 'PROJECTION', 'timing': 3e-06, 'cardinality': 186, 'extra_info': 's_name\ns_address\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.001308, 'cardinality': 186, 'extra_info': 'INNER\n#0 = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 400\n', 'children': [{'name': 'PROJECTION', 'timing': 2.2e-05, 'cardinality': 4397, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.002942, 'cardinality': 4397, 'extra_info': '#0', 'children': [{'name': 'PROJECTION', 'timing': 3e-06, 'cardinality': 5833, 'extra_info': '#0\n', 'children': [{'name': 'PROJECTION', 'timing': 2.5e-05, 'cardinality': 5833, 'extra_info': '__internal_compress_integral_usmallint(#0, 1)\n', 'children': [{'name': 'PROJECTION', 'timing': 3e-06, 'cardinality': 5833, 'extra_info': 'ps_suppkey\n', 'children': [{'name': 'PROJECTION', 'timing': 6e-06, 'cardinality': 5833, 'extra_info': '#0\n#4\n#5\n', 'children': [{'name': 'FILTER', 'timing': 0.000455, 'cardinality': 5833, 'extra_info': '(CAST(ps_availqty AS DECIMAL(38,3)) > SUBQUERY)\n[INFOSEPARATOR]\nEC: 800000', 'children': [{'name': 'RIGHT_DELIM_JOIN', 'timing': 0.004845, 'cardinality': 0, 'extra_info': 'RIGHT\nps_partkey IS NOT DISTINCT FROM ps_partkey\nps_suppkey IS NOT DISTINCT FROM ps_suppkey\n\n[INFOSEPARATOR]\nEC: 800000\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.01293, 'cardinality': 8508, 'extra_info': 'INNER\nps_partkey = #0\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 800000\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.003005, 'cardinality': 800000, 'extra_info': 'partsupp\n[INFOSEPARATOR]\nps_partkey\nps_availqty\nps_suppkey\n[INFOSEPARATOR]\nEC: 800000', 'children': []}, {'name': 'PROJECTION', 'timing': 3e-05, 'cardinality': 2127, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.002401, 'cardinality': 2127, 'extra_info': '#0', 'children': [{'name': 'PROJECTION', 'timing': 1e-06, 'cardinality': 2127, 'extra_info': '#0\n', 'children': [{'name': 'PROJECTION', 'timing': 1e-05, 'cardinality': 2127, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n', 'children': [{'name': 'PROJECTION', 'timing': 3e-06, 'cardinality': 2127, 'extra_info': 'p_partkey\n', 'children': [{'name': 'FILTER', 'timing': 0.001492, 'cardinality': 2127, 'extra_info': "prefix(p_name, 'forest')\n[INFOSEPARATOR]\nEC: 8000", 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.015757, 'cardinality': 2127, 'extra_info': "part\n[INFOSEPARATOR]\np_name\np_partkey\n[INFOSEPARATOR]\nFilters: p_name>='forest' AND p_name<'foresu' AND p_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 40000", 'children': []}]}]}]}]}]}]}]}, {'name': 'HASH_JOIN', 'timing': 0.001067, 'cardinality': 8508, 'extra_info': 'RIGHT\nps_partkey IS NOT DISTINCT FROM ps_partkey\nps_suppkey IS NOT DISTINCT FROM ps_suppkey\n\n[INFOSEPARATOR]\nEC: 800000\n', 'children': [{'name': 'PROJECTION', 'timing': 0.0002, 'cardinality': 5843, 'extra_info': '(0.5 * sum(l_quantity))\nps_partkey\nps_suppkey\n', 'children': [{'name': 'PROJECTION', 'timing': 4.1e-05, 'cardinality': 5843, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n__internal_decompress_integral_bigint(#1, 1)\n#2\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.004316, 'cardinality': 5843, 'extra_info': '#0\n#1\nsum(#2)', 'children': [{'name': 'PROJECTION', 'timing': 1.1e-05, 'cardinality': 9741, 'extra_info': 'ps_partkey\nps_suppkey\nl_quantity\n', 'children': [{'name': 'PROJECTION', 'timing': 0.000101, 'cardinality': 9741, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n__internal_compress_integral_usmallint(#1, 1)\n#2\n#3\n#4\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.060521, 'cardinality': 9741, 'extra_info': 'INNER\nl_partkey = ps_partkey\nl_suppkey = ps_suppkey\n\n[INFOSEPARATOR]\nEC: 1200243\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.057704, 'cardinality': 909455, 'extra_info': "lineitem\n[INFOSEPARATOR]\nl_partkey\nl_suppkey\nl_quantity\n[INFOSEPARATOR]\nFilters: l_shipdate>='1994-01-01'::DATE AND l_shipdate<'1995-01-01'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243", 'children': []}, {'name': 'DELIM_SCAN', 'timing': 0.0, 'cardinality': 0, 'extra_info': '', 'children': []}]}]}]}]}]}]}, {'name': 'DUMMY_SCAN', 'timing': 0.0, 'cardinality': 0, 'extra_info': '', 'children': []}]}, {'name': 'HASH_GROUP_BY', 'timing': 0.007175, 'cardinality': 8508, 'extra_info': '#0\n#2', 'children': []}]}]}]}]}]}]}]}]}, {'name': 'HASH_JOIN', 'timing': 0.000269, 'cardinality': 412, 'extra_info': 'INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 400\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.001128, 'cardinality': 10000, 'extra_info': 'supplier\n[INFOSEPARATOR]\n\n[INFOSEPARATOR]\nEC: 10000', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 6.7e-05, 'cardinality': 1, 'extra_info': "nation\n[INFOSEPARATOR]\n\n[INFOSEPARATOR]\nFilters: n_name='CANADA' AND n_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1", 'children': []}]}]}]}]}]}]}
X {'RESULT_COLLECTOR0': 3.6e-05, 'ORDER_BY1': 0.000152, 'PROJECTION2': 3e-06, 'HASH_JOIN3': 0.001308, 'PROJECTION4': 2.2e-05, 'HASH_GROUP_BY5': 0.002942, 'PROJECTION6': 3e-06, 'PROJECTION7': 2.5e-05, 'PROJECTION8': 3e-06, 'PROJECTION9': 6e-06, 'FILTER10': 0.000455, 'RIGHT_DELIM_JOIN11': 0.004845, 'HASH_JOIN12': 0.01293, 'SEQ_SCAN 13': 0.003005, 'PROJECTION14': 3e-05, 'HASH_GROUP_BY15': 0.002401, 'PROJECTION16': 1e-06, 'PROJECTION17': 1e-05, 'PROJECTION18': 3e-06, 'FILTER19': 0.001492, 'SEQ_SCAN 20': 0.015757, 'HASH_JOIN21': 0.001067, 'PROJECTION22': 0.0002, 'PROJECTION23': 4.1e-05, 'HASH_GROUP_BY24': 0.004316, 'PROJECTION25': 1.1e-05, 'PROJECTION26': 0.000101, 'HASH_JOIN27': 0.060521, 'SEQ_SCAN 28': 0.057704, 'DELIM_SCAN29': 0.0, 'DUMMY_SCAN30': 0.0, 'HASH_GROUP_BY31': 0.007175, 'HASH_JOIN32': 0.000269, 'SEQ_SCAN 33': 0.001128, 'SEQ_SCAN 34': 6.7e-05}
compressed filter_log_size: 5498
compressed filter_log_buffer_size: 785
compressed limit_offset_size: 2528
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 12224
compressed perfect_full_scan_ht_log_buffer_size: 8544
compressed perfect_probe_ht_log_size: 59242
compressed perfect_probe_ht_log_buffer_size: 48092
compressed row_group_log_size: 703895
compressed row_group_log_buffer_size: 653359
compressed scatter_log_size: 100217
compressed scatter_log_buffer_size: 95669
compressed scatter_sel_log_size: 78164
compressed scatter_sel_log_buffer_size: 72258
compressed gather_log_size: 2528
compressed gather_log_buffer_size: 0
compressed combine_log_size: 189196
compressed combine_log_buffer_size: 184231
compressed finalize_states_log_size: 8735
compressed finalize_states_log_buffer_size: 3895
compressed join_gather_log_size: 208589
compressed join_gather_log_buffer_size: 152413
compressed reorder_log_size: 4238
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 2528
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 2528
compressed nlj_log_buffer_size: 0
compressed total_size: 1380110
compressed total_buffer_size: 1219246
compressed total_element_size: 160864

Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌─────────────────────┐                                                                                                                                                                                                               
│        LIMIT        │                                                                                                                                                                                                               
└──────────┬──────────┘                                                                                                                                                                                                                                      
┌──────────┴──────────┐                                                                                                                                                                                                               
│       ORDER_BY      │                                                                                                                                                                                                               
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                               
│       ORDERS:       │                                                                                                                                                                                                               
│  count_star() DESC  │                                                                                                                                                                                                               
│ supplier.s_name ASC │                                                                                                                                                                                                               
└──────────┬──────────┘                                                                                                                                                                                                                                      
┌──────────┴──────────┐                                                                                                                                                                                                               
│    HASH_GROUP_BY    │                                                                                                                                                                                                               
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                               
│          #0         │                                                                                                                                                                                                               
│     count_star()    │                                                                                                                                                                                                               
└──────────┬──────────┘                                                                                                                                                                                                                                      
┌──────────┴──────────┐                                                                                                                                                                                                               
│      PROJECTION     │                                                                                                                                                                                                               
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                               
│        s_name       │                                                                                                                                                                                                               
└──────────┬──────────┘                                                                                                                                                                                                                                      
┌──────────┴──────────┐                                                                                                                                                                                                               
│      PROJECTION     │                                                                                                                                                                                                               
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                               
│__internal_compress_i│                                                                                                                                                                                                               
│ ntegral_uinteger(#0,│                                                                                                                                                                                                               
│          1)         │                                                                                                                                                                                                               
│__internal_compress_i│                                                                                                                                                                                                               
│ntegral_usmallint(#1,│                                                                                                                                                                                                               
│          1)         │                                                                                                                                                                                                               
│__internal_compress_i│                                                                                                                                                                                                               
│ ntegral_uinteger(#2,│                                                                                                                                                                                                               
│          1)         │                                                                                                                                                                                                               
│          #3         │                                                                                                                                                                                                               
└──────────┬──────────┘                                                                                                                                                                                                                                      
┌──────────┴──────────┐                                                                                                                                                                                                               
│   RIGHT_DELIM_JOIN  │                                                                                                                                                                                                               
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                               
│      RIGHT_ANTI     │                                                                                                                                                                                                               
│  l_orderkey IS NOT  │                                                                                                                                                                                                               
│ DISTINCT FROM l...  ├─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐                                                         
│   l_suppkey IS NOT  │                                                                                                                                                     │                                                         
│ DISTINCT FROM l...  │                                                                                                                                                     │                                                         
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                     │                                                         
│     EC: 6001215     │                                                                                                                                                     │                                                         
└──────────┬──────────┘                                                                                                                                                     │                                                                                
┌──────────┴──────────┐                                                                                                                                          ┌──────────┴──────────┐                                              
│   RIGHT_DELIM_JOIN  │                                                                                                                                          │      HASH_JOIN      │                                              
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                          │   ─ ─ ─ ─ ─ ─ ─ ─   │                                              
│      RIGHT_SEMI     │                                                                                                                                          │      RIGHT_ANTI     │                                              
│  l_orderkey IS NOT  │                                                                                                                                          │  l_orderkey IS NOT  │                                              
│ DISTINCT FROM l...  ├────────────────────────────────────────────────────────────────────────────────┐                                                         │ DISTINCT FROM l...  ├──────────────────────────────────┐           
│   l_suppkey IS NOT  │                                                                                │                                                         │   l_suppkey IS NOT  │                                  │           
│ DISTINCT FROM l...  │                                                                                │                                                         │ DISTINCT FROM l...  │                                  │           
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                │                                                         │   ─ ─ ─ ─ ─ ─ ─ ─   │                                  │           
│     EC: 6001215     │                                                                                │                                                         │     EC: 6001215     │                                  │           
└──────────┬──────────┘                                                                                │                                                         └──────────┬──────────┘                                  │                                  
┌──────────┴──────────┐                                                                     ┌──────────┴──────────┐                                              ┌──────────┴──────────┐                       ┌──────────┴──────────┐
│      HASH_JOIN      │                                                                     │      HASH_JOIN      │                                              │      PROJECTION     │                       │      DUMMY_SCAN     │
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                     │   ─ ─ ─ ─ ─ ─ ─ ─   │                                              │   ─ ─ ─ ─ ─ ─ ─ ─   │                       │                     │
│        INNER        │                                                                     │      RIGHT_SEMI     │                                              │      l_orderkey     │                       │                     │
│     o_orderkey =    │                                                                     │  l_orderkey IS NOT  │                                              │      l_suppkey      │                       │                     │
│      l_orderkey     ├───────────┐                                                         │ DISTINCT FROM l...  ├──────────────────────────────────┐           │                     │                       │                     │
│   ─ ─ ─ ─ ─ ─ ─ ─   │           │                                                         │   l_suppkey IS NOT  │                                  │           │                     │                       │                     │
│      EC: 15866      │           │                                                         │ DISTINCT FROM l...  │                                  │           │                     │                       │                     │
│                     │           │                                                         │   ─ ─ ─ ─ ─ ─ ─ ─   │                                  │           │                     │                       │                     │
│                     │           │                                                         │     EC: 6001215     │                                  │           │                     │                       │                     │
└──────────┬──────────┘           │                                                         └──────────┬──────────┘                                  │           └──────────┬──────────┘                       └─────────────────────┘                       
┌──────────┴──────────┐┌──────────┴──────────┐                                              ┌──────────┴──────────┐                       ┌──────────┴──────────┐┌──────────┴──────────┐                                              
│      SEQ_SCAN       ││      HASH_JOIN      │                                              │      PROJECTION     │                       │      DUMMY_SCAN     ││      HASH_JOIN      │                                              
│   ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─   │                                              │   ─ ─ ─ ─ ─ ─ ─ ─   │                       │                     ││   ─ ─ ─ ─ ─ ─ ─ ─   │                                              
│        orders       ││        INNER        │                                              │      l_orderkey     │                       │                     ││        INNER        │                                              
│   ─ ─ ─ ─ ─ ─ ─ ─   ││l_suppkey = s_suppkey│                                              │      l_suppkey      │                       │                     ││     l_orderkey =    │                                              
│      o_orderkey     ││   ─ ─ ─ ─ ─ ─ ─ ─   │                                              │                     │                       │                     ││      l_orderkey     │                                              
│   ─ ─ ─ ─ ─ ─ ─ ─   ││     Build Min: 1    ├───────────┐                                  │                     │                       │                     ││     l_suppkey !=    ├───────────┐                                  
│Filters: o_orderstatu││   Build Max: 10000  │           │                                  │                     │                       │                     ││       l_suppkey     │           │                                  
│      s='F' AND      ││   ─ ─ ─ ─ ─ ─ ─ ─   │           │                                  │                     │                       │                     ││   ─ ─ ─ ─ ─ ─ ─ ─   │           │                                  
│ o_orderstatus I...  ││      EC: 47600      │           │                                  │                     │                       │                     ││     EC: 1200243     │           │                                  
│   ─ ─ ─ ─ ─ ─ ─ ─   ││                     │           │                                  │                     │                       │                     ││                     │           │                                  
│      EC: 500000     ││                     │           │                                  │                     │                       │                     ││                     │           │                                  
└─────────────────────┘└──────────┬──────────┘           │                                  └──────────┬──────────┘                       └─────────────────────┘└──────────┬──────────┘           │                                                         
                       ┌──────────┴──────────┐┌──────────┴──────────┐                       ┌──────────┴──────────┐                                              ┌──────────┴──────────┐┌──────────┴──────────┐                       
                       │        FILTER       ││      HASH_JOIN      │                       │      HASH_JOIN      │                                              │        FILTER       ││      DELIM_SCAN     │                       
                       │   ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─   │                       │   ─ ─ ─ ─ ─ ─ ─ ─   │                                              │   ─ ─ ─ ─ ─ ─ ─ ─   ││                     │                       
                       │   (l_receiptdate >  ││        INNER        │                       │        INNER        │                                              │   (l_receiptdate >  ││                     │                       
                       │     l_commitdate)   ││    s_nationkey =    │                       │     l_orderkey =    │                                              │     l_commitdate)   ││                     │                       
                       │   ─ ─ ─ ─ ─ ─ ─ ─   ││      n_nationkey    │                       │      l_orderkey     │                                              │   ─ ─ ─ ─ ─ ─ ─ ─   ││                     │                       
                       │     EC: 1200243     ││   ─ ─ ─ ─ ─ ─ ─ ─   ├───────────┐           │     l_suppkey !=    ├───────────┐                                  │     EC: 6001215     ││                     │                       
                       │                     ││     Build Min: 0    │           │           │       l_suppkey     │           │                                  │                     ││                     │                       
                       │                     ││    Build Max: 24    │           │           │   ─ ─ ─ ─ ─ ─ ─ ─   │           │                                  │                     ││                     │                       
                       │                     ││   ─ ─ ─ ─ ─ ─ ─ ─   │           │           │     EC: 6001215     │           │                                  │                     ││                     │                       
                       │                     ││       EC: 400       │           │           │                     │           │                                  │                     ││                     │                       
                       └──────────┬──────────┘└──────────┬──────────┘           │           └──────────┬──────────┘           │                                  └──────────┬──────────┘└─────────────────────┘                                              
                       ┌──────────┴──────────┐┌──────────┴──────────┐┌──────────┴──────────┐┌──────────┴──────────┐┌──────────┴──────────┐                       ┌──────────┴──────────┐                                              
                       │      SEQ_SCAN       ││      SEQ_SCAN       ││      SEQ_SCAN       ││      SEQ_SCAN       ││      DELIM_SCAN     │                       │      SEQ_SCAN       │                                              
                       │   ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─   ││                     │                       │   ─ ─ ─ ─ ─ ─ ─ ─   │                                              
                       │       lineitem      ││       supplier      ││        nation       ││       lineitem      ││                     │                       │       lineitem      │                                              
                       │   ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─   ││                     │                       │   ─ ─ ─ ─ ─ ─ ─ ─   │                                              
                       │      l_suppkey      ││      s_suppkey      ││     n_nationkey     ││      l_orderkey     ││                     │                       │      l_orderkey     │                                              
                       │      l_orderkey     ││     s_nationkey     ││   ─ ─ ─ ─ ─ ─ ─ ─   ││      l_suppkey      ││                     │                       │      l_suppkey      │                                              
                       │    l_receiptdate    ││        s_name       ││   Filters: n_name=  ││   ─ ─ ─ ─ ─ ─ ─ ─   ││                     │                       │    l_receiptdate    │                                              
                       │     l_commitdate    ││   ─ ─ ─ ─ ─ ─ ─ ─   ││'SAUDI ARABIA' A...  ││     EC: 6001215     ││                     │                       │     l_commitdate    │                                              
                       │   ─ ─ ─ ─ ─ ─ ─ ─   ││      EC: 10000      ││      IS NOT NULL    ││                     ││                     │                       │   ─ ─ ─ ─ ─ ─ ─ ─   │                                              
                       │     EC: 1200243     ││                     ││   ─ ─ ─ ─ ─ ─ ─ ─   ││                     ││                     │                       │     EC: 6001215     │                                              
                       │                     ││                     ││        EC: 1        ││                     ││                     │                       │                     │                                              
                       └─────────────────────┘└─────────────────────┘└─────────────────────┘└─────────────────────┘└─────────────────────┘                       └─────────────────────┘                                                                     

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

**** output size:  186
LINEAGE_5_FILTER_13
LINEAGE_5_FILTER_21
LINEAGE_5_HASH_GROUP_BY_10
LINEAGE_5_HASH_GROUP_BY_17
LINEAGE_5_HASH_GROUP_BY_26
LINEAGE_5_HASH_GROUP_BY_5
LINEAGE_5_HASH_JOIN_19
LINEAGE_5_HASH_JOIN_2
LINEAGE_5_HASH_JOIN_30
LINEAGE_5_HASH_JOIN_31
LINEAGE_5_HASH_JOIN_9
LINEAGE_5_ORDER_BY_33
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_11
LINEAGE_5_SEQ_SCAN_12
LINEAGE_5_SEQ_SCAN_28
LINEAGE_5_SEQ_SCAN_29
SELECT s_name, s_address FROM supplier, nation WHERE s_suppkey IN ( SELECT ps_suppkey FROM partsupp WHERE ps_partkey IN ( SELECT p_partkey FROM part WHERE p_name LIKE 'forest%') AND ps_availqty > ( SELECT 0.5 * sum(l_quantity) FROM lineitem WHERE l_partkey = ps_partkey AND l_suppkey = ps_suppkey AND l_shipdate >= CAST('1994-01-01' AS date) AND l_shipdate < CAST('1995-01-01' AS date))) AND s_nationkey = n_nationkey AND n_name = 'CANADA' ORDER BY s_name;
   query_id  ...                                               plan
0         5  ...  {"name": "ORDER_BY", "opid": "33", "children":...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               SELECT s_name, s_address FROM supplier, nation...
size_bytes_max                                                1380110
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "ORDER_BY", "opid": "33", "children":...
Name: 0, dtype: object
{"name": "ORDER_BY", "opid": "33", "children": [{"name": "PROJECTION", "opid": "32", "children": [{"name": "HASH_JOIN", "opid": "31", "children": [{"name": "PROJECTION", "opid": "27", "children": [{"name": "HASH_GROUP_BY", "opid": "26", "children": [{"name": "PROJECTION", "opid": "25", "children": [{"name": "PROJECTION", "opid": "24", "children": [{"name": "PROJECTION", "opid": "23", "children": [{"name": "PROJECTION", "opid": "22", "children": [{"name": "FILTER", "opid": "21", "children": [{"name": "RIGHT_DELIM_JOIN", "opid": "20", "children": [{"name": "HASH_GROUP_BY", "opid": "10", "children": [],"table": "","extra": "#0\n#2"},{"name": "HASH_JOIN", "opid": "9", "children": [{"name": "PROJECTION", "opid": "7", "children": [{"name": "PROJECTION", "opid": "6", "children": [{"name": "HASH_GROUP_BY", "opid": "5", "children": [{"name": "PROJECTION", "opid": "4", "children": [{"name": "PROJECTION", "opid": "3", "children": [{"name": "HASH_JOIN", "opid": "2", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_partkey\nl_suppkey\nl_quantity\n[INFOSEPARATOR]\nFilters: l_shipdate>='1994-01-01'::DATE AND l_shipdate<'1995-01-01'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243"},{"name": "DELIM_SCAN", "opid": "1", "children": [],"table": "","extra": ""}],"table": "","extra": "INNER\nl_partkey = ps_partkey\nl_suppkey = ps_suppkey\n\n[INFOSEPARATOR]\nEC: 1200243\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n__internal_compress_integral_usmallint(#1, 1)\n#2\n#3\n#4\n"}],"table": "","extra": "ps_partkey\nps_suppkey\nl_quantity\n"}],"table": "","extra": "#0\n#1\nsum(#2)"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n__internal_decompress_integral_bigint(#1, 1)\n#2\n"}],"table": "","extra": "(0.5 * sum(l_quantity))\nps_partkey\nps_suppkey\n"},{"name": "DUMMY_SCAN", "opid": "8", "children": [],"table": "","extra": ""}],"table": "","extra": "RIGHT\nps_partkey IS NOT DISTINCT FROM ps_partkey\nps_suppkey IS NOT DISTINCT FROM ps_suppkey\n\n[INFOSEPARATOR]\nEC: 800000\n"},{"name": "HASH_JOIN", "opid": "19", "children": [{"name": "SEQ_SCAN ", "opid": "11", "children": [],"table": "partsupp","extra": "partsupp\n[INFOSEPARATOR]\nps_partkey\nps_availqty\nps_suppkey\n[INFOSEPARATOR]\nEC: 800000"},{"name": "PROJECTION", "opid": "18", "children": [{"name": "HASH_GROUP_BY", "opid": "17", "children": [{"name": "PROJECTION", "opid": "16", "children": [{"name": "PROJECTION", "opid": "15", "children": [{"name": "PROJECTION", "opid": "14", "children": [{"name": "FILTER", "opid": "13", "children": [{"name": "SEQ_SCAN ", "opid": "12", "children": [],"table": "part","extra": "part\n[INFOSEPARATOR]\np_name\np_partkey\n[INFOSEPARATOR]\nFilters: p_name>='forest' AND p_name<'foresu' AND p_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 40000"}],"table": "","extra": "prefix(p_name, 'forest')\n[INFOSEPARATOR]\nEC: 8000"}],"table": "","extra": "p_partkey\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n"}],"table": "","extra": "#0\n"}],"table": "","extra": "#0"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n"}],"table": "","extra": "INNER\nps_partkey = #0\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 800000\n"}],"table": "","extra": "RIGHT\nps_partkey IS NOT DISTINCT FROM ps_partkey\nps_suppkey IS NOT DISTINCT FROM ps_suppkey\n\n[INFOSEPARATOR]\nEC: 800000\n"}],"table": "","extra": "(CAST(ps_availqty AS DECIMAL(38,3)) > SUBQUERY)\n[INFOSEPARATOR]\nEC: 800000"}],"table": "","extra": "#0\n#4\n#5\n"}],"table": "","extra": "ps_suppkey\n"}],"table": "","extra": "__internal_compress_integral_usmallint(#0, 1)\n"}],"table": "","extra": "#0\n"}],"table": "","extra": "#0"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n"},{"name": "HASH_JOIN", "opid": "30", "children": [{"name": "SEQ_SCAN ", "opid": "28", "children": [],"table": "supplier","extra": "supplier\n[INFOSEPARATOR]\n\n[INFOSEPARATOR]\nEC: 10000"},{"name": "SEQ_SCAN ", "opid": "29", "children": [],"table": "nation","extra": "nation\n[INFOSEPARATOR]\n\n[INFOSEPARATOR]\nFilters: n_name='CANADA' AND n_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1"}],"table": "","extra": "INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 400\n"}],"table": "","extra": "INNER\n#0 = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 400\n"}],"table": "","extra": "s_name\ns_address\n"}],"table": "","extra": "ORDERS:\nsupplier.s_name ASC"}
%%%%%%%%%%%%%%%% Running Query #  21  threads:  4
SELECT s_name, count(*) AS numwait FROM supplier, lineitem l1, orders, nation WHERE s_suppkey = l1.l_suppkey AND o_orderkey = l1.l_orderkey AND o_orderstatus = 'F' AND l1.l_receiptdate > l1.l_commitdate AND EXISTS ( SELECT * FROM lineitem l2 WHERE l2.l_orderkey = l1.l_orderkey AND l2.l_suppkey <> l1.l_suppkey) AND NOT EXISTS ( SELECT * FROM lineitem l3 WHERE l3.l_orderkey = l1.l_orderkey AND l3.l_suppkey <> l1.l_suppkey AND l3.l_receiptdate > l3.l_commitdate) AND s_nationkey = n_nationkey AND n_name = 'SAUDI ARABIA' GROUP BY s_name ORDER BY numwait DESC, s_name LIMIT 100;
Run:  None SELECT s_name, count(*) AS numwait FROM supplier, lineitem l1, orders, nation WHERE s_suppkey = l1.l_suppkey AND o_orderkey = l1.l_orderkey AND o_orderstatus = 'F' AND l1.l_receiptdate > l1.l_commitdate AND EXISTS ( SELECT * FROM lineitem l2 WHERE l2.l_orderkey = l1.l_orderkey AND l2.l_suppkey <> l1.l_suppkey) AND NOT EXISTS ( SELECT * FROM lineitem l3 WHERE l3.l_orderkey = l1.l_orderkey AND l3.l_suppkey <> l1.l_suppkey AND l3.l_receiptdate > l3.l_commitdate) AND s_nationkey = n_nationkey AND n_name = 'SAUDI ARABIA' GROUP BY s_name ORDER BY numwait DESC, s_name LIMIT 100;
Avg Time in sec:  0.2272926508449018  output size:  100
                s_name  numwait
0   Supplier#000002829       20
1   Supplier#000005808       18
2   Supplier#000000262       17
3   Supplier#000000496       17
4   Supplier#000002160       17
..                 ...      ...
95  Supplier#000001916       12
96  Supplier#000001925       12
97  Supplier#000002039       12
98  Supplier#000002357       12
99  Supplier#000002483       12

[100 rows x 2 columns]
{'name': 'Query', 'result': 0.219909, 'timing': 0.219909, 'cardinality': 0, 'extra-info': "SELECT s_name, count(*) AS numwait FROM supplier, lineitem l1, orders, nation WHERE s_suppkey = l1.l_suppkey AND o_orderkey = l1.l_orderkey AND o_orderstatus = 'F' AND l1.l_receiptdate > l1.l_commitdate AND EXISTS ( SELECT * FROM lineitem l2 WHERE l2.l_orderkey = l1.l_orderkey AND l2.l_suppkey <> l1.l_suppkey) AND NOT EXISTS ( SELECT * FROM lineitem l3 WHERE l3.l_orderkey = l1.l_orderkey AND l3.l_suppkey <> l1.l_suppkey AND l3.l_receiptdate > l3.l_commitdate) AND s_nationkey = n_nationkey AND n_name = 'SAUDI ARABIA' GROUP BY s_name ORDER BY numwait DESC, s_name LIMIT 100;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 1.2e-05, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'LIMIT', 'timing': 5.6e-05, 'cardinality': 100, 'extra_info': '', 'children': [{'name': 'ORDER_BY', 'timing': 0.0001, 'cardinality': 411, 'extra_info': 'ORDERS:\ncount_star() DESC\nsupplier.s_name ASC', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.009426, 'cardinality': 411, 'extra_info': '#0\ncount_star()', 'children': [{'name': 'PROJECTION', 'timing': 1e-06, 'cardinality': 4141, 'extra_info': 's_name\n', 'children': [{'name': 'PROJECTION', 'timing': 2.9e-05, 'cardinality': 4141, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n__internal_compress_integral_usmallint(#1, 1)\n__internal_compress_integral_uinteger(#2, 1)\n#3\n', 'children': [{'name': 'RIGHT_DELIM_JOIN', 'timing': 0.016085, 'cardinality': 0, 'extra_info': 'RIGHT_ANTI\nl_orderkey IS NOT DISTINCT FROM l_orderkey\nl_suppkey IS NOT DISTINCT FROM l_suppkey\n\n[INFOSEPARATOR]\nEC: 6001215\n', 'children': [{'name': 'RIGHT_DELIM_JOIN', 'timing': 0.032773, 'cardinality': 0, 'extra_info': 'RIGHT_SEMI\nl_orderkey IS NOT DISTINCT FROM l_orderkey\nl_suppkey IS NOT DISTINCT FROM l_suppkey\n\n[INFOSEPARATOR]\nEC: 6001215\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.071072, 'cardinality': 75871, 'extra_info': 'INNER\no_orderkey = l_orderkey\n\n[INFOSEPARATOR]\nEC: 15866\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.051971, 'cardinality': 729413, 'extra_info': "orders\n[INFOSEPARATOR]\no_orderkey\n[INFOSEPARATOR]\nFilters: o_orderstatus='F' AND o_orderstatus IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 500000", 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.05899, 'cardinality': 156739, 'extra_info': 'INNER\nl_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 47600\n', 'children': [{'name': 'FILTER', 'timing': 0.040164, 'cardinality': 3793296, 'extra_info': '(l_receiptdate > l_commitdate)\n[INFOSEPARATOR]\nEC: 1200243', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.015455, 'cardinality': 6001215, 'extra_info': 'lineitem\n[INFOSEPARATOR]\nl_suppkey\nl_orderkey\nl_receiptdate\nl_commitdate\n[INFOSEPARATOR]\nEC: 1200243', 'children': []}]}, {'name': 'HASH_JOIN', 'timing': 0.000109, 'cardinality': 411, 'extra_info': 'INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 400\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.000213, 'cardinality': 10000, 'extra_info': 'supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\ns_name\n[INFOSEPARATOR]\nEC: 10000', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 3.9e-05, 'cardinality': 1, 'extra_info': "nation\n[INFOSEPARATOR]\nn_nationkey\n[INFOSEPARATOR]\nFilters: n_name='SAUDI ARABIA' AND n_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1", 'children': []}]}]}]}, {'name': 'HASH_JOIN', 'timing': 0.049703, 'cardinality': 73089, 'extra_info': 'RIGHT_SEMI\nl_orderkey IS NOT DISTINCT FROM l_orderkey\nl_suppkey IS NOT DISTINCT FROM l_suppkey\n\n[INFOSEPARATOR]\nEC: 6001215\n', 'children': [{'name': 'PROJECTION', 'timing': 0.000822, 'cardinality': 302356, 'extra_info': 'l_orderkey\nl_suppkey\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.12661, 'cardinality': 302356, 'extra_info': 'INNER\nl_orderkey = l_orderkey\nl_suppkey != l_suppkey\n\n[INFOSEPARATOR]\nEC: 6001215\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.008733, 'cardinality': 6001215, 'extra_info': 'lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_suppkey\n[INFOSEPARATOR]\nEC: 6001215', 'children': []}, {'name': 'DELIM_SCAN', 'timing': 0.0, 'cardinality': 0, 'extra_info': '', 'children': []}]}]}, {'name': 'DUMMY_SCAN', 'timing': 0.0, 'cardinality': 0, 'extra_info': '', 'children': []}]}, {'name': 'HASH_GROUP_BY', 'timing': 0.00661, 'cardinality': 75864, 'extra_info': '#0\n#1', 'children': []}]}, {'name': 'HASH_JOIN', 'timing': 0.024464, 'cardinality': 4141, 'extra_info': 'RIGHT_ANTI\nl_orderkey IS NOT DISTINCT FROM l_orderkey\nl_suppkey IS NOT DISTINCT FROM l_suppkey\n\n[INFOSEPARATOR]\nEC: 6001215\n', 'children': [{'name': 'PROJECTION', 'timing': 0.000256, 'cardinality': 190909, 'extra_info': 'l_orderkey\nl_suppkey\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.116236, 'cardinality': 190909, 'extra_info': 'INNER\nl_orderkey = l_orderkey\nl_suppkey != l_suppkey\n\n[INFOSEPARATOR]\nEC: 1200243\n', 'children': [{'name': 'FILTER', 'timing': 0.027716, 'cardinality': 3793296, 'extra_info': '(l_receiptdate > l_commitdate)\n[INFOSEPARATOR]\nEC: 6001215', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.011444, 'cardinality': 6001215, 'extra_info': 'lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_suppkey\nl_receiptdate\nl_commitdate\n[INFOSEPARATOR]\nEC: 6001215', 'children': []}]}, {'name': 'DELIM_SCAN', 'timing': 0.0, 'cardinality': 0, 'extra_info': '', 'children': []}]}]}, {'name': 'DUMMY_SCAN', 'timing': 0.0, 'cardinality': 0, 'extra_info': '', 'children': []}]}, {'name': 'HASH_GROUP_BY', 'timing': 0.007513, 'cardinality': 73082, 'extra_info': '#0\n#1', 'children': []}]}]}]}]}]}]}]}]}
compressed filter_log_size: 1567002
compressed filter_log_buffer_size: 1500330
compressed limit_offset_size: 2368
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 4407
compressed perfect_full_scan_ht_log_buffer_size: 1415
compressed perfect_probe_ht_log_size: 847696
compressed perfect_probe_ht_log_buffer_size: 799990
compressed row_group_log_size: 259619
compressed row_group_log_buffer_size: 187517
compressed scatter_log_size: 331274
compressed scatter_log_buffer_size: 324296
compressed scatter_sel_log_size: 1914732
compressed scatter_sel_log_buffer_size: 1896458
compressed gather_log_size: 2224
compressed gather_log_buffer_size: 0
compressed combine_log_size: 16103
compressed combine_log_buffer_size: 11710
compressed finalize_states_log_size: 67273
compressed finalize_states_log_buffer_size: 63141
compressed join_gather_log_size: 6167679
compressed join_gather_log_buffer_size: 5802686
compressed reorder_log_size: 3963
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 2224
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 2224
compressed nlj_log_buffer_size: 0
compressed total_size: 11188788
compressed total_buffer_size: 10587543
compressed total_element_size: 601245

Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                                                                                                                                                                              
│          ORDER_BY         │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│          ORDERS:          │                                                                                                                                                                              
│   custsale.cntrycode ASC  │                                                                                                                                                                              
└─────────────┬─────────────┘                                                                                                                                                                                                           
┌─────────────┴─────────────┐                                                                                                                                                                              
│       HASH_GROUP_BY       │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│             #0            │                                                                                                                                                                              
│        count_star()       │                                                                                                                                                                              
│          sum(#1)          │                                                                                                                                                                              
└─────────────┬─────────────┘                                                                                                                                                                                                           
┌─────────────┴─────────────┐                                                                                                                                                                              
│         PROJECTION        │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│         cntrycode         │                                                                                                                                                                              
│         c_acctbal         │                                                                                                                                                                              
└─────────────┬─────────────┘                                                                                                                                                                                                           
┌─────────────┴─────────────┐                                                                                                                                                                              
│         PROJECTION        │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│         cntrycode         │                                                                                                                                                                              
│         c_acctbal         │                                                                                                                                                                              
└─────────────┬─────────────┘                                                                                                                                                                                                           
┌─────────────┴─────────────┐                                                                                                                                                                              
│      RIGHT_DELIM_JOIN     │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│         RIGHT_ANTI        │                                                                                                                                                                              
│ c_custkey IS NOT DISTINCT ├─────────────────────────────────────────────────────────────────────────────────────────────────────┐                                                                        
│       FROM c_custkey      │                                                                                                     │                                                                        
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                     │                                                                        
│        EC: 1500000        │                                                                                                     │                                                                        
└─────────────┬─────────────┘                                                                                                     │                                                                                                     
┌─────────────┴─────────────┐                                                                                       ┌─────────────┴─────────────┐                                                          
│      NESTED_LOOP_JOIN     │                                                                                       │         HASH_JOIN         │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│           INNER           │                                                                                       │         RIGHT_ANTI        │                                                          
│CAST(c_acctbal AS DOUBLE) >├───────────────────────────────────────────┐                                           │ c_custkey IS NOT DISTINCT ├───────────────────────────────────────────┐              
│          SUBQUERY         │                                           │                                           │       FROM c_custkey      │                                           │              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                           │                                           │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                           │              
│           EC: 0           │                                           │                                           │        EC: 1500000        │                                           │              
└─────────────┬─────────────┘                                           │                                           └─────────────┬─────────────┘                                           │                                           
┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐
│           FILTER          │                             │    UNGROUPED_AGGREGATE    │                             │         PROJECTION        │                             │         DUMMY_SCAN        │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │                           │
│          IN (...)         │                             │         first(#0)         │                             │         c_custkey         │                             │                           │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │                           │                             │                           │                             │                           │
│         EC: 30000         │                             │                           │                             │                           │                             │                           │
└─────────────┬─────────────┘                             └─────────────┬─────────────┘                             └─────────────┬─────────────┘                             └───────────────────────────┘                             
┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐                                                          
│         HASH_JOIN         │                             │         PROJECTION        │                             │         HASH_JOIN         │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│            MARK           │                             │             #0            │                             │           INNER           │                                                          
│substring(c_phone, 1, 2) = ├──────────────┐              │                           │                             │   o_custkey = c_custkey   ├──────────────┐                                           
│             #0            │              │              │                           │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              │                           │                             │        EC: 1500000        │              │                                           
│         EC: 150000        │              │              │                           │                             │                           │              │                                           
└─────────────┬─────────────┘              │              └─────────────┬─────────────┘                             └─────────────┬─────────────┘              │                                                                        
┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             
│         SEQ_SCAN          ││      COLUMN_DATA_SCAN     ││      STREAMING_LIMIT      │                             │         SEQ_SCAN          ││         DELIM_SCAN        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           ││                           │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                             
│          customer         ││                           ││                           │                             │           orders          ││                           │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           ││                           │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                             
│          c_phone          ││                           ││                           │                             │         o_custkey         ││                           │                             
│         c_acctbal         ││                           ││                           │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                             
│         c_custkey         ││                           ││                           │                             │        EC: 1500000        ││                           │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           ││                           │                             │                           ││                           │                             
│         EC: 150000        ││                           ││                           │                             │                           ││                           │                             
└───────────────────────────┘└───────────────────────────┘└─────────────┬─────────────┘                             └───────────────────────────┘└───────────────────────────┘                                                          
                                                          ┌─────────────┴─────────────┐                                                                                                                    
                                                          │    UNGROUPED_AGGREGATE    │                                                                                                                    
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
                                                          │          avg(#0)          │                                                                                                                    
                                                          └─────────────┬─────────────┘                                                                                                                                                 
                                                          ┌─────────────┴─────────────┐                                                                                                                    
                                                          │         PROJECTION        │                                                                                                                    
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
                                                          │         c_acctbal         │                                                                                                                    
                                                          └─────────────┬─────────────┘                                                                                                                                                 
                                                          ┌─────────────┴─────────────┐                                                                                                                    
                                                          │         PROJECTION        │                                                                                                                    
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
                                                          │             #0            │                                                                                                                    
                                                          │             #2            │                                                                                                                    
                                                          └─────────────┬─────────────┘                                                                                                                                                 
                                                          ┌─────────────┴─────────────┐                                                                                                                    
                                                          │           FILTER          │                                                                                                                    
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
                                                          │          IN (...)         │                                                                                                                    
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
                                                          │          EC: 6000         │                                                                                                                    
                                                          └─────────────┬─────────────┘                                                                                                                                                 
                                                          ┌─────────────┴─────────────┐                                                                                                                    
                                                          │         HASH_JOIN         │                                                                                                                    
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
                                                          │            MARK           │                                                                                                                    
                                                          │substring(c_phone, 1, 2) = ├──────────────┐                                                                                                     
                                                          │             #0            │              │                                                                                                     
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                                                                                     
                                                          │         EC: 30000         │              │                                                                                                     
                                                          └─────────────┬─────────────┘              │                                                                                                                                  
                                                          ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                       
                                                          │         SEQ_SCAN          ││      COLUMN_DATA_SCAN     │                                                                                       
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                                                                       
                                                          │          customer         ││                           │                                                                                       
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                                                                       
                                                          │         c_acctbal         ││                           │                                                                                       
                                                          │          c_phone          ││                           │                                                                                       
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                                                                       
                                                          │Filters: c_acctbal>0.00 AND││                           │                                                                                       
                                                          │    c_acctbal IS NOT NULL  ││                           │                                                                                       
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                                                                       
                                                          │         EC: 30000         ││                           │                                                                                       
                                                          └───────────────────────────┘└───────────────────────────┘                                                                                                                    

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

X {'RESULT_COLLECTOR0': 1.2e-05, 'LIMIT1': 5.6e-05, 'ORDER_BY2': 0.0001, 'HASH_GROUP_BY3': 0.009426, 'PROJECTION4': 1e-06, 'PROJECTION5': 2.9e-05, 'RIGHT_DELIM_JOIN6': 0.016085, 'RIGHT_DELIM_JOIN7': 0.032773, 'HASH_JOIN8': 0.071072, 'SEQ_SCAN 9': 0.051971, 'HASH_JOIN10': 0.05899, 'FILTER11': 0.040164, 'SEQ_SCAN 12': 0.015455, 'HASH_JOIN13': 0.000109, 'SEQ_SCAN 14': 0.000213, 'SEQ_SCAN 15': 3.9e-05, 'HASH_JOIN16': 0.049703, 'PROJECTION17': 0.000822, 'HASH_JOIN18': 0.12661, 'SEQ_SCAN 19': 0.008733, 'DELIM_SCAN20': 0.0, 'DUMMY_SCAN21': 0.0, 'HASH_GROUP_BY22': 0.00661, 'HASH_JOIN23': 0.024464, 'PROJECTION24': 0.000256, 'HASH_JOIN25': 0.116236, 'FILTER26': 0.027716, 'SEQ_SCAN 27': 0.011444, 'DELIM_SCAN28': 0.0, 'DUMMY_SCAN29': 0.0, 'HASH_GROUP_BY30': 0.007513}
**** output size:  100
LINEAGE_5_FILTER_1
LINEAGE_5_FILTER_17
LINEAGE_5_HASH_GROUP_BY_14
LINEAGE_5_HASH_GROUP_BY_27
LINEAGE_5_HASH_GROUP_BY_7
LINEAGE_5_HASH_JOIN_10
LINEAGE_5_HASH_JOIN_13
LINEAGE_5_HASH_JOIN_20
LINEAGE_5_HASH_JOIN_21
LINEAGE_5_HASH_JOIN_22
LINEAGE_5_HASH_JOIN_3
LINEAGE_5_HASH_JOIN_6
LINEAGE_5_LIMIT_29
LINEAGE_5_ORDER_BY_28
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_15
LINEAGE_5_SEQ_SCAN_16
LINEAGE_5_SEQ_SCAN_18
LINEAGE_5_SEQ_SCAN_19
LINEAGE_5_SEQ_SCAN_8
SELECT s_name, count(*) AS numwait FROM supplier, lineitem l1, orders, nation WHERE s_suppkey = l1.l_suppkey AND o_orderkey = l1.l_orderkey AND o_orderstatus = 'F' AND l1.l_receiptdate > l1.l_commitdate AND EXISTS ( SELECT * FROM lineitem l2 WHERE l2.l_orderkey = l1.l_orderkey AND l2.l_suppkey <> l1.l_suppkey) AND NOT EXISTS ( SELECT * FROM lineitem l3 WHERE l3.l_orderkey = l1.l_orderkey AND l3.l_suppkey <> l1.l_suppkey AND l3.l_receiptdate > l3.l_commitdate) AND s_nationkey = n_nationkey AND n_name = 'SAUDI ARABIA' GROUP BY s_name ORDER BY numwait DESC, s_name LIMIT 100;
   query_id  ...                                               plan
0         5  ...  {"name": "LIMIT", "opid": "29", "children": [{...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               SELECT s_name, count(*) AS numwait FROM suppli...
size_bytes_max                                               11188788
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "LIMIT", "opid": "29", "children": [{...
Name: 0, dtype: object
{"name": "LIMIT", "opid": "29", "children": [{"name": "ORDER_BY", "opid": "28", "children": [{"name": "HASH_GROUP_BY", "opid": "27", "children": [{"name": "PROJECTION", "opid": "26", "children": [{"name": "PROJECTION", "opid": "25", "children": [{"name": "RIGHT_DELIM_JOIN", "opid": "24", "children": [{"name": "HASH_GROUP_BY", "opid": "7", "children": [],"table": "","extra": "#0\n#1"},{"name": "HASH_JOIN", "opid": "6", "children": [{"name": "PROJECTION", "opid": "4", "children": [{"name": "HASH_JOIN", "opid": "3", "children": [{"name": "FILTER", "opid": "1", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_suppkey\nl_receiptdate\nl_commitdate\n[INFOSEPARATOR]\nEC: 6001215"}],"table": "","extra": "(l_receiptdate > l_commitdate)\n[INFOSEPARATOR]\nEC: 6001215"},{"name": "DELIM_SCAN", "opid": "2", "children": [],"table": "","extra": ""}],"table": "","extra": "INNER\nl_orderkey = l_orderkey\nl_suppkey != l_suppkey\n\n[INFOSEPARATOR]\nEC: 1200243\n"}],"table": "","extra": "l_orderkey\nl_suppkey\n"},{"name": "DUMMY_SCAN", "opid": "5", "children": [],"table": "","extra": ""}],"table": "","extra": "RIGHT_ANTI\nl_orderkey IS NOT DISTINCT FROM l_orderkey\nl_suppkey IS NOT DISTINCT FROM l_suppkey\n\n[INFOSEPARATOR]\nEC: 6001215\n"},{"name": "RIGHT_DELIM_JOIN", "opid": "23", "children": [{"name": "HASH_GROUP_BY", "opid": "14", "children": [],"table": "","extra": "#0\n#1"},{"name": "HASH_JOIN", "opid": "13", "children": [{"name": "PROJECTION", "opid": "11", "children": [{"name": "HASH_JOIN", "opid": "10", "children": [{"name": "SEQ_SCAN ", "opid": "8", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_suppkey\n[INFOSEPARATOR]\nEC: 6001215"},{"name": "DELIM_SCAN", "opid": "9", "children": [],"table": "","extra": ""}],"table": "","extra": "INNER\nl_orderkey = l_orderkey\nl_suppkey != l_suppkey\n\n[INFOSEPARATOR]\nEC: 6001215\n"}],"table": "","extra": "l_orderkey\nl_suppkey\n"},{"name": "DUMMY_SCAN", "opid": "12", "children": [],"table": "","extra": ""}],"table": "","extra": "RIGHT_SEMI\nl_orderkey IS NOT DISTINCT FROM l_orderkey\nl_suppkey IS NOT DISTINCT FROM l_suppkey\n\n[INFOSEPARATOR]\nEC: 6001215\n"},{"name": "HASH_JOIN", "opid": "22", "children": [{"name": "SEQ_SCAN ", "opid": "15", "children": [],"table": "orders","extra": "orders\n[INFOSEPARATOR]\no_orderkey\n[INFOSEPARATOR]\nFilters: o_orderstatus='F' AND o_orderstatus IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 500000"},{"name": "HASH_JOIN", "opid": "21", "children": [{"name": "FILTER", "opid": "17", "children": [{"name": "SEQ_SCAN ", "opid": "16", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_suppkey\nl_orderkey\nl_receiptdate\nl_commitdate\n[INFOSEPARATOR]\nEC: 1200243"}],"table": "","extra": "(l_receiptdate > l_commitdate)\n[INFOSEPARATOR]\nEC: 1200243"},{"name": "HASH_JOIN", "opid": "20", "children": [{"name": "SEQ_SCAN ", "opid": "18", "children": [],"table": "supplier","extra": "supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\ns_name\n[INFOSEPARATOR]\nEC: 10000"},{"name": "SEQ_SCAN ", "opid": "19", "children": [],"table": "nation","extra": "nation\n[INFOSEPARATOR]\nn_nationkey\n[INFOSEPARATOR]\nFilters: n_name='SAUDI ARABIA' AND n_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1"}],"table": "","extra": "INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 400\n"}],"table": "","extra": "INNER\nl_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 47600\n"}],"table": "","extra": "INNER\no_orderkey = l_orderkey\n\n[INFOSEPARATOR]\nEC: 15866\n"}],"table": "","extra": "RIGHT_SEMI\nl_orderkey IS NOT DISTINCT FROM l_orderkey\nl_suppkey IS NOT DISTINCT FROM l_suppkey\n\n[INFOSEPARATOR]\nEC: 6001215\n"}],"table": "","extra": "RIGHT_ANTI\nl_orderkey IS NOT DISTINCT FROM l_orderkey\nl_suppkey IS NOT DISTINCT FROM l_suppkey\n\n[INFOSEPARATOR]\nEC: 6001215\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n__internal_compress_integral_usmallint(#1, 1)\n__internal_compress_integral_uinteger(#2, 1)\n#3\n"}],"table": "","extra": "s_name\n"}],"table": "","extra": "#0\ncount_star()"}],"table": "","extra": "ORDERS:\ncount_star() DESC\nsupplier.s_name ASC"}],"table": "","extra": ""}
%%%%%%%%%%%%%%%% Running Query #  22  threads:  4
SELECT cntrycode, count(*) AS numcust, sum(c_acctbal) AS totacctbal FROM ( SELECT substring(c_phone FROM 1 FOR 2) AS cntrycode, c_acctbal FROM customer WHERE substring(c_phone FROM 1 FOR 2) IN ('13', '31', '23', '29', '30', '18', '17') AND c_acctbal > ( SELECT avg(c_acctbal) FROM customer WHERE c_acctbal > 0.00 AND substring(c_phone FROM 1 FOR 2) IN ('13', '31', '23', '29', '30', '18', '17')) AND NOT EXISTS ( SELECT * FROM orders WHERE o_custkey = c_custkey)) AS custsale GROUP BY cntrycode ORDER BY cntrycode;
Run:  None SELECT cntrycode, count(*) AS numcust, sum(c_acctbal) AS totacctbal FROM ( SELECT substring(c_phone FROM 1 FOR 2) AS cntrycode, c_acctbal FROM customer WHERE substring(c_phone FROM 1 FOR 2) IN ('13', '31', '23', '29', '30', '18', '17') AND c_acctbal > ( SELECT avg(c_acctbal) FROM customer WHERE c_acctbal > 0.00 AND substring(c_phone FROM 1 FOR 2) IN ('13', '31', '23', '29', '30', '18', '17')) AND NOT EXISTS ( SELECT * FROM orders WHERE o_custkey = c_custkey)) AS custsale GROUP BY cntrycode ORDER BY cntrycode;
Avg Time in sec:  0.06262037483975291  output size:  7
  cntrycode  numcust  totacctbal
0        13      888  6737713.99
1        17      861  6460573.72
2        18      964  7236687.40
3        23      892  6701457.95
4        29      948  7158866.63
5        30      909  6808436.13
6        31      922  6806670.18
compressed filter_log_size: 41668
compressed filter_log_buffer_size: 37254
compressed limit_offset_size: 1904
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 1760
compressed perfect_full_scan_ht_log_buffer_size: 0
compressed perfect_probe_ht_log_size: 1760
compressed perfect_probe_ht_log_buffer_size: 0
compressed row_group_log_size: 27641
compressed row_group_log_buffer_size: 17936
compressed scatter_log_size: 82290
compressed scatter_log_buffer_size: 79765
compressed scatter_sel_log_size: 143458
compressed scatter_sel_log_buffer_size: 139155
compressed gather_log_size: 1760
compressed gather_log_buffer_size: 0
compressed combine_log_size: 4171
compressed combine_log_buffer_size: 1528
compressed finalize_states_log_size: 5861
compressed finalize_states_log_buffer_size: 3226
compressed join_gather_log_size: 1915446
compressed join_gather_log_buffer_size: 1863953
compressed reorder_log_size: 2800
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 1760
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 10870
compressed nlj_log_buffer_size: 7419
compressed total_size: 2243149
compressed total_buffer_size: 2150236
compressed total_element_size: 92913

{'name': 'Query', 'result': 0.056913, 'timing': 0.056913, 'cardinality': 0, 'extra-info': "SELECT cntrycode, count(*) AS numcust, sum(c_acctbal) AS totacctbal FROM ( SELECT substring(c_phone FROM 1 FOR 2) AS cntrycode, c_acctbal FROM customer WHERE substring(c_phone FROM 1 FOR 2) IN ('13', '31', '23', '29', '30', '18', '17') AND c_acctbal > ( SELECT avg(c_acctbal) FROM customer WHERE c_acctbal > 0.00 AND substring(c_phone FROM 1 FOR 2) IN ('13', '31', '23', '29', '30', '18', '17')) AND NOT EXISTS ( SELECT * FROM orders WHERE o_custkey = c_custkey)) AS custsale GROUP BY cntrycode ORDER BY cntrycode;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 8e-06, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'ORDER_BY', 'timing': 7e-05, 'cardinality': 7, 'extra_info': 'ORDERS:\ncustsale.cntrycode ASC', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.001072, 'cardinality': 7, 'extra_info': '#0\ncount_star()\nsum(#1)', 'children': [{'name': 'PROJECTION', 'timing': 2e-06, 'cardinality': 6384, 'extra_info': 'cntrycode\nc_acctbal\n', 'children': [{'name': 'PROJECTION', 'timing': 0.000292, 'cardinality': 6384, 'extra_info': 'cntrycode\nc_acctbal\n', 'children': [{'name': 'RIGHT_DELIM_JOIN', 'timing': 0.008137, 'cardinality': 0, 'extra_info': 'RIGHT_ANTI\nc_custkey IS NOT DISTINCT FROM c_custkey\n\n[INFOSEPARATOR]\nEC: 1500000\n', 'children': [{'name': 'NESTED_LOOP_JOIN', 'timing': 0.002698, 'cardinality': 19000, 'extra_info': 'INNER\nCAST(c_acctbal AS DOUBLE) > SUBQUERY\n\n[INFOSEPARATOR]\nEC: 0\n', 'children': [{'name': 'FILTER', 'timing': 0.001355, 'cardinality': 42015, 'extra_info': 'IN (...)\n[INFOSEPARATOR]\nEC: 30000', 'children': [{'name': 'HASH_JOIN', 'timing': 0.012201, 'cardinality': 150000, 'extra_info': 'MARK\nsubstring(c_phone, 1, 2) = #0\n\n[INFOSEPARATOR]\nEC: 150000\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.004238, 'cardinality': 150000, 'extra_info': 'customer\n[INFOSEPARATOR]\nc_phone\nc_acctbal\nc_custkey\n[INFOSEPARATOR]\nEC: 150000', 'children': []}, {'name': 'COLUMN_DATA_SCAN', 'timing': 1.5e-05, 'cardinality': 7, 'extra_info': '', 'children': []}]}]}, {'name': 'UNGROUPED_AGGREGATE', 'timing': 2e-06, 'cardinality': 1, 'extra_info': 'first(#0)', 'children': [{'name': 'PROJECTION', 'timing': 0.0, 'cardinality': 1, 'extra_info': '#0\n', 'children': [{'name': 'STREAMING_LIMIT', 'timing': 2e-06, 'cardinality': 1, 'extra_info': '', 'children': [{'name': 'UNGROUPED_AGGREGATE', 'timing': 0.000119, 'cardinality': 1, 'extra_info': 'avg(#0)', 'children': [{'name': 'PROJECTION', 'timing': 1.5e-05, 'cardinality': 38120, 'extra_info': 'c_acctbal\n', 'children': [{'name': 'PROJECTION', 'timing': 2.3e-05, 'cardinality': 38120, 'extra_info': '#0\n#2\n', 'children': [{'name': 'FILTER', 'timing': 0.000901, 'cardinality': 38120, 'extra_info': 'IN (...)\n[INFOSEPARATOR]\nEC: 6000', 'children': [{'name': 'HASH_JOIN', 'timing': 0.007276, 'cardinality': 136308, 'extra_info': 'MARK\nsubstring(c_phone, 1, 2) = #0\n\n[INFOSEPARATOR]\nEC: 30000\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.00469, 'cardinality': 136308, 'extra_info': 'customer\n[INFOSEPARATOR]\nc_acctbal\nc_phone\n[INFOSEPARATOR]\nFilters: c_acctbal>0.00 AND c_acctbal IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 30000', 'children': []}, {'name': 'COLUMN_DATA_SCAN', 'timing': 9e-06, 'cardinality': 7, 'extra_info': '', 'children': []}]}]}]}]}]}]}]}]}]}, {'name': 'HASH_JOIN', 'timing': 0.019411, 'cardinality': 6384, 'extra_info': 'RIGHT_ANTI\nc_custkey IS NOT DISTINCT FROM c_custkey\n\n[INFOSEPARATOR]\nEC: 1500000\n', 'children': [{'name': 'PROJECTION', 'timing': 0.000229, 'cardinality': 190069, 'extra_info': 'c_custkey\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.050007, 'cardinality': 190069, 'extra_info': 'INNER\no_custkey = c_custkey\n\n[INFOSEPARATOR]\nEC: 1500000\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.001978, 'cardinality': 1500000, 'extra_info': 'orders\n[INFOSEPARATOR]\no_custkey\n[INFOSEPARATOR]\nEC: 1500000', 'children': []}, {'name': 'DELIM_SCAN', 'timing': 0.0, 'cardinality': 0, 'extra_info': '', 'children': []}]}]}, {'name': 'DUMMY_SCAN', 'timing': 0.0, 'cardinality': 0, 'extra_info': '', 'children': []}]}, {'name': 'HASH_GROUP_BY', 'timing': 0.002444, 'cardinality': 19000, 'extra_info': '#2', 'children': []}]}]}]}]}]}]}]}
X {'RESULT_COLLECTOR0': 8e-06, 'ORDER_BY1': 7e-05, 'HASH_GROUP_BY2': 0.001072, 'PROJECTION3': 2e-06, 'PROJECTION4': 0.000292, 'RIGHT_DELIM_JOIN5': 0.008137, 'NESTED_LOOP_JOIN6': 0.002698, 'FILTER7': 0.001355, 'HASH_JOIN8': 0.012201, 'SEQ_SCAN 9': 0.004238, 'COLUMN_DATA_SCAN10': 1.5e-05, 'UNGROUPED_AGGREGATE11': 2e-06, 'PROJECTION12': 0.0, 'STREAMING_LIMIT13': 2e-06, 'UNGROUPED_AGGREGATE14': 0.000119, 'PROJECTION15': 1.5e-05, 'PROJECTION16': 2.3e-05, 'FILTER17': 0.000901, 'HASH_JOIN18': 0.007276, 'SEQ_SCAN 19': 0.00469, 'COLUMN_DATA_SCAN20': 9e-06, 'HASH_JOIN21': 0.019411, 'PROJECTION22': 0.000229, 'HASH_JOIN23': 0.050007, 'SEQ_SCAN 24': 0.001978, 'DELIM_SCAN25': 0.0, 'DUMMY_SCAN26': 0.0, 'HASH_GROUP_BY27': 0.002444}
**** output size:  7
LINEAGE_5_COLUMN_DATA_SCAN_12
LINEAGE_5_COLUMN_DATA_SCAN_8
LINEAGE_5_FILTER_10
LINEAGE_5_FILTER_14
LINEAGE_5_HASH_GROUP_BY_25
LINEAGE_5_HASH_GROUP_BY_6
LINEAGE_5_HASH_JOIN_13
LINEAGE_5_HASH_JOIN_2
LINEAGE_5_HASH_JOIN_5
LINEAGE_5_HASH_JOIN_9
LINEAGE_5_NESTED_LOOP_JOIN_21
LINEAGE_5_ORDER_BY_26
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_11
LINEAGE_5_SEQ_SCAN_7
LINEAGE_5_STREAMING_LIMIT_18
SELECT cntrycode, count(*) AS numcust, sum(c_acctbal) AS totacctbal FROM ( SELECT substring(c_phone FROM 1 FOR 2) AS cntrycode, c_acctbal FROM customer WHERE substring(c_phone FROM 1 FOR 2) IN ('13', '31', '23', '29', '30', '18', '17') AND c_acctbal > ( SELECT avg(c_acctbal) FROM customer WHERE c_acctbal > 0.00 AND substring(c_phone FROM 1 FOR 2) IN ('13', '31', '23', '29', '30', '18', '17')) AND NOT EXISTS ( SELECT * FROM orders WHERE o_custkey = c_custkey)) AS custsale GROUP BY cntrycode ORDER BY cntrycode;
   query_id  ...                                               plan
0         5  ...  {"name": "ORDER_BY", "opid": "26", "children":...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               SELECT cntrycode, count(*) AS numcust, sum(c_a...
size_bytes_max                                                2243149
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "ORDER_BY", "opid": "26", "children":...
Name: 0, dtype: object
{"name": "ORDER_BY", "opid": "26", "children": [{"name": "HASH_GROUP_BY", "opid": "25", "children": [{"name": "PROJECTION", "opid": "24", "children": [{"name": "PROJECTION", "opid": "23", "children": [{"name": "RIGHT_DELIM_JOIN", "opid": "22", "children": [{"name": "HASH_GROUP_BY", "opid": "6", "children": [],"table": "","extra": "#2"},{"name": "HASH_JOIN", "opid": "5", "children": [{"name": "PROJECTION", "opid": "3", "children": [{"name": "HASH_JOIN", "opid": "2", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "orders","extra": "orders\n[INFOSEPARATOR]\no_custkey\n[INFOSEPARATOR]\nEC: 1500000"},{"name": "DELIM_SCAN", "opid": "1", "children": [],"table": "","extra": ""}],"table": "","extra": "INNER\no_custkey = c_custkey\n\n[INFOSEPARATOR]\nEC: 1500000\n"}],"table": "","extra": "c_custkey\n"},{"name": "DUMMY_SCAN", "opid": "4", "children": [],"table": "","extra": ""}],"table": "","extra": "RIGHT_ANTI\nc_custkey IS NOT DISTINCT FROM c_custkey\n\n[INFOSEPARATOR]\nEC: 1500000\n"},{"name": "NESTED_LOOP_JOIN", "opid": "21", "children": [{"name": "FILTER", "opid": "10", "children": [{"name": "HASH_JOIN", "opid": "9", "children": [{"name": "SEQ_SCAN ", "opid": "7", "children": [],"table": "customer","extra": "customer\n[INFOSEPARATOR]\nc_phone\nc_acctbal\nc_custkey\n[INFOSEPARATOR]\nEC: 150000"},{"name": "COLUMN_DATA_SCAN", "opid": "8", "children": [],"table": "","extra": ""}],"table": "","extra": "MARK\nsubstring(c_phone, 1, 2) = #0\n\n[INFOSEPARATOR]\nEC: 150000\n"}],"table": "","extra": "IN (...)\n[INFOSEPARATOR]\nEC: 30000"},{"name": "UNGROUPED_AGGREGATE", "opid": "20", "children": [{"name": "PROJECTION", "opid": "19", "children": [{"name": "STREAMING_LIMIT", "opid": "18", "children": [{"name": "UNGROUPED_AGGREGATE", "opid": "17", "children": [{"name": "PROJECTION", "opid": "16", "children": [{"name": "PROJECTION", "opid": "15", "children": [{"name": "FILTER", "opid": "14", "children": [{"name": "HASH_JOIN", "opid": "13", "children": [{"name": "SEQ_SCAN ", "opid": "11", "children": [],"table": "customer","extra": "customer\n[INFOSEPARATOR]\nc_acctbal\nc_phone\n[INFOSEPARATOR]\nFilters: c_acctbal>0.00 AND c_acctbal IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 30000"},{"name": "COLUMN_DATA_SCAN", "opid": "12", "children": [],"table": "","extra": ""}],"table": "","extra": "MARK\nsubstring(c_phone, 1, 2) = #0\n\n[INFOSEPARATOR]\nEC: 30000\n"}],"table": "","extra": "IN (...)\n[INFOSEPARATOR]\nEC: 6000"}],"table": "","extra": "#0\n#2\n"}],"table": "","extra": "c_acctbal\n"}],"table": "","extra": "avg(#0)"}],"table": "","extra": ""}],"table": "","extra": "#0\n"}],"table": "","extra": "first(#0)"}],"table": "","extra": "INNER\nCAST(c_acctbal AS DOUBLE) > SUBQUERY\n\n[INFOSEPARATOR]\nEC: 0\n"}],"table": "","extra": "RIGHT_ANTI\nc_custkey IS NOT DISTINCT FROM c_custkey\n\n[INFOSEPARATOR]\nEC: 1500000\n"}],"table": "","extra": "cntrycode\nc_acctbal\n"}],"table": "","extra": "cntrycode\nc_acctbal\n"}],"table": "","extra": "#0\ncount_star()\nsum(#1)"}],"table": "","extra": "ORDERS:\ncustsale.cntrycode ASC"}
Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐
│         PROJECTION        │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│__internal_decompress_strin│
│           g(#0)           │
│__internal_decompress_strin│
│           g(#1)           │
│             #2            │
│             #3            │
│             #4            │
│             #5            │
│             #6            │
│             #7            │
│             #8            │
│             #9            │
└─────────────┬─────────────┘                             
┌─────────────┴─────────────┐
│          ORDER_BY         │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│          ORDERS:          │
│ lineitem.l_returnflag ASC │
│ lineitem.l_linestatus ASC │
└─────────────┬─────────────┘                             
┌─────────────┴─────────────┐
│         PROJECTION        │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│__internal_compress_string_│
│        utinyint(#0)       │
│__internal_compress_string_│
│        utinyint(#1)       │
│             #2            │
│             #3            │
│             #4            │
│             #5            │
│             #6            │
│             #7            │
│             #8            │
│             #9            │
└─────────────┬─────────────┘                             
┌─────────────┴─────────────┐
│         PROJECTION        │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│__internal_decompress_strin│
│           g(#0)           │
│__internal_decompress_strin│
│           g(#1)           │
│             #2            │
│             #3            │
│             #4            │
│             #5            │
│             #6            │
│             #7            │
│             #8            │
│             #9            │
└─────────────┬─────────────┘                             
┌─────────────┴─────────────┐
│   PERFECT_HASH_GROUP_BY   │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│             #0            │
│             #1            │
│    sum_no_overflow(#2)    │
│    sum_no_overflow(#3)    │
│    sum_no_overflow(#4)    │
│    sum_no_overflow(#5)    │
│          avg(#6)          │
│          avg(#7)          │
│          avg(#8)          │
│        count_star()       │
└─────────────┬─────────────┘                             
┌─────────────┴─────────────┐
│         PROJECTION        │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│        l_returnflag       │
│        l_linestatus       │
│         l_quantity        │
│      l_extendedprice      │
│             #4            │
│   (#4 * (1.00 + l_tax))   │
│         l_quantity        │
│      l_extendedprice      │
│         l_discount        │
└─────────────┬─────────────┘                             
┌─────────────┴─────────────┐
│         PROJECTION        │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│__internal_compress_string_│
│        utinyint(#0)       │
│__internal_compress_string_│
│        utinyint(#1)       │
│             #2            │
│             #3            │
│             #4            │
│             #5            │
│             #6            │
└─────────────┬─────────────┘                             
┌─────────────┴─────────────┐
│         PROJECTION        │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│        l_returnflag       │
│        l_linestatus       │
│         l_quantity        │
│      l_extendedprice      │
│ (l_extendedprice * (1.00 -│
│        l_discount))       │
│           l_tax           │
│         l_discount        │
└─────────────┬─────────────┘                             
┌─────────────┴─────────────┐
│         SEQ_SCAN          │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│          lineitem         │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│        l_returnflag       │
│        l_linestatus       │
│         l_quantity        │
│      l_extendedprice      │
│         l_discount        │
│           l_tax           │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│ Filters: l_shipdate<='1998│
│-09-02'::DATE AND l_sh...  │
│         IS NOT NULL       │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│        EC: 1200243        │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

compressed filter_log_size: 1104
compressed filter_log_buffer_size: 0
compressed limit_offset_size: 1104
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 1104
compressed perfect_full_scan_ht_log_buffer_size: 0
compressed perfect_probe_ht_log_size: 1104
compressed perfect_probe_ht_log_buffer_size: 0
compressed row_group_log_size: 266356
compressed row_group_log_buffer_size: 224597
compressed scatter_log_size: 12353212
compressed scatter_log_buffer_size: 12337930
compressed scatter_sel_log_size: 1104
compressed scatter_sel_log_buffer_size: 0
compressed gather_log_size: 1104
compressed gather_log_buffer_size: 0
compressed combine_log_size: 2768
compressed combine_log_buffer_size: 512
compressed finalize_states_log_size: 1318
compressed finalize_states_log_buffer_size: 70
compressed join_gather_log_size: 1104
compressed join_gather_log_buffer_size: 0
compressed reorder_log_size: 1736
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 1104
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 1104
compressed nlj_log_buffer_size: 0
compressed total_size: 12635326
compressed total_buffer_size: 12563109
compressed total_element_size: 72217

Clear Lineage

%%%%%%%%%%%%%%%% Running Query #  1  threads:  8
SELECT l_returnflag, l_linestatus, sum(l_quantity) AS sum_qty, sum(l_extendedprice) AS sum_base_price, sum(l_extendedprice * (1 - l_discount)) AS sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) AS sum_charge, avg(l_quantity) AS avg_qty, avg(l_extendedprice) AS avg_price, avg(l_discount) AS avg_disc, count(*) AS count_order FROM lineitem WHERE l_shipdate <= CAST('1998-09-02' AS date) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus
Run:  None SELECT l_returnflag, l_linestatus, sum(l_quantity) AS sum_qty, sum(l_extendedprice) AS sum_base_price, sum(l_extendedprice * (1 - l_discount)) AS sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) AS sum_charge, avg(l_quantity) AS avg_qty, avg(l_extendedprice) AS avg_price, avg(l_discount) AS avg_disc, count(*) AS count_order FROM lineitem WHERE l_shipdate <= CAST('1998-09-02' AS date) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus
Avg Time in sec:  0.13204921502619982  output size:  4
  l_returnflag l_linestatus     sum_qty  ...     avg_price  avg_disc  count_order
0            A            F  37734107.0  ...  38273.129735  0.049985      1478493
1            N            F    991417.0  ...  38284.467761  0.050093        38854
2            N            O  74476040.0  ...  38249.117989  0.049997      2920374
3            R            F  37719753.0  ...  38250.854626  0.050009      1478870

[4 rows x 10 columns]
{'name': 'Query', 'result': 0.111151, 'timing': 0.111151, 'cardinality': 0, 'extra-info': "SELECT l_returnflag, l_linestatus, sum(l_quantity) AS sum_qty, sum(l_extendedprice) AS sum_base_price, sum(l_extendedprice * (1 - l_discount)) AS sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) AS sum_charge, avg(l_quantity) AS avg_qty, avg(l_extendedprice) AS avg_price, avg(l_discount) AS avg_disc, count(*) AS count_order FROM lineitem WHERE l_shipdate <= CAST('1998-09-02' AS date) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 2.2e-05, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 2e-06, 'cardinality': 4, 'extra_info': '__internal_decompress_string(#0)\n__internal_decompress_string(#1)\n#2\n#3\n#4\n#5\n#6\n#7\n#8\n#9\n', 'children': [{'name': 'ORDER_BY', 'timing': 4.6e-05, 'cardinality': 4, 'extra_info': 'ORDERS:\nlineitem.l_returnflag ASC\nlineitem.l_linestatus ASC', 'children': [{'name': 'PROJECTION', 'timing': 2e-06, 'cardinality': 4, 'extra_info': '__internal_compress_string_utinyint(#0)\n__internal_compress_string_utinyint(#1)\n#2\n#3\n#4\n#5\n#6\n#7\n#8\n#9\n', 'children': [{'name': 'PROJECTION', 'timing': 4e-06, 'cardinality': 4, 'extra_info': '__internal_decompress_string(#0)\n__internal_decompress_string(#1)\n#2\n#3\n#4\n#5\n#6\n#7\n#8\n#9\n', 'children': [{'name': 'PERFECT_HASH_GROUP_BY', 'timing': 0.216493, 'cardinality': 4, 'extra_info': '#0\n#1\nsum_no_overflow(#2)\nsum_no_overflow(#3)\nsum_no_overflow(#4)\nsum_no_overflow(#5)\navg(#6)\navg(#7)\navg(#8)\ncount_star()', 'children': [{'name': 'PROJECTION', 'timing': 0.065086, 'cardinality': 5916591, 'extra_info': 'l_returnflag\nl_linestatus\nl_quantity\nl_extendedprice\n#4\n(#4 * (1.00 + l_tax))\nl_quantity\nl_extendedprice\nl_discount\n', 'children': [{'name': 'PROJECTION', 'timing': 0.031659, 'cardinality': 5916591, 'extra_info': '__internal_compress_string_utinyint(#0)\n__internal_compress_string_utinyint(#1)\n#2\n#3\n#4\n#5\n#6\n', 'children': [{'name': 'PROJECTION', 'timing': 0.071227, 'cardinality': 5916591, 'extra_info': 'l_returnflag\nl_linestatus\nl_quantity\nl_extendedprice\n(l_extendedprice * (1.00 - l_discount))\nl_tax\nl_discount\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.377097, 'cardinality': 5916591, 'extra_info': "lineitem\n[INFOSEPARATOR]\nl_returnflag\nl_linestatus\nl_quantity\nl_extendedprice\nl_discount\nl_tax\n[INFOSEPARATOR]\nFilters: l_shipdate<='1998-09-02'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243", 'children': []}]}]}]}]}]}]}]}]}]}]}
X {'RESULT_COLLECTOR0': 2.2e-05, 'PROJECTION1': 2e-06, 'ORDER_BY2': 4.6e-05, 'PROJECTION3': 2e-06, 'PROJECTION4': 4e-06, 'PERFECT_HASH_GROUP_BY5': 0.216493, 'PROJECTION6': 0.065086, 'PROJECTION7': 0.031659, 'PROJECTION8': 0.071227, 'SEQ_SCAN 9': 0.377097}
**** output size:  4
LINEAGE_5_ORDER_BY_7
LINEAGE_5_PERFECT_HASH_GROUP_BY_4
LINEAGE_5_SEQ_SCAN_0
SELECT l_returnflag, l_linestatus, sum(l_quantity) AS sum_qty, sum(l_extendedprice) AS sum_base_price, sum(l_extendedprice * (1 - l_discount)) AS sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) AS sum_charge, avg(l_quantity) AS avg_qty, avg(l_extendedprice) AS avg_price, avg(l_discount) AS avg_disc, count(*) AS count_order FROM lineitem WHERE l_shipdate <= CAST('1998-09-02' AS date) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus
   query_id  ...                                               plan
0         5  ...  {"name": "PROJECTION", "opid": "8", "children"...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               SELECT l_returnflag, l_linestatus, sum(l_quant...
size_bytes_max                                               12635326
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "PROJECTION", "opid": "8", "children"...
Name: 0, dtype: object
{"name": "PROJECTION", "opid": "8", "children": [{"name": "ORDER_BY", "opid": "7", "children": [{"name": "PROJECTION", "opid": "6", "children": [{"name": "PROJECTION", "opid": "5", "children": [{"name": "PERFECT_HASH_GROUP_BY", "opid": "4", "children": [{"name": "PROJECTION", "opid": "3", "children": [{"name": "PROJECTION", "opid": "2", "children": [{"name": "PROJECTION", "opid": "1", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_returnflag\nl_linestatus\nl_quantity\nl_extendedprice\nl_discount\nl_tax\n[INFOSEPARATOR]\nFilters: l_shipdate<='1998-09-02'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243"}],"table": "","extra": "l_returnflag\nl_linestatus\nl_quantity\nl_extendedprice\n(l_extendedprice * (1.00 - l_discount))\nl_tax\nl_discount\n"}],"table": "","extra": "__internal_compress_string_utinyint(#0)\n__internal_compress_string_utinyint(#1)\n#2\n#3\n#4\n#5\n#6\n"}],"table": "","extra": "l_returnflag\nl_linestatus\nl_quantity\nl_extendedprice\n#4\n(#4 * (1.00 + l_tax))\nl_quantity\nl_extendedprice\nl_discount\n"}],"table": "","extra": "#0\n#1\nsum_no_overflow(#2)\nsum_no_overflow(#3)\nsum_no_overflow(#4)\nsum_no_overflow(#5)\navg(#6)\navg(#7)\navg(#8)\ncount_star()"}],"table": "","extra": "__internal_decompress_string(#0)\n__internal_decompress_string(#1)\n#2\n#3\n#4\n#5\n#6\n#7\n#8\n#9\n"}],"table": "","extra": "__internal_compress_string_utinyint(#0)\n__internal_compress_string_utinyint(#1)\n#2\n#3\n#4\n#5\n#6\n#7\n#8\n#9\n"}],"table": "","extra": "ORDERS:\nlineitem.l_returnflag ASC\nlineitem.l_linestatus ASC"}],"table": "","extra": "__internal_decompress_string(#0)\n__internal_decompress_string(#1)\n#2\n#3\n#4\n#5\n#6\n#7\n#8\n#9\n"}
%%%%%%%%%%%%%%%% Running Query #  2  threads:  8
SELECT s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment FROM part, supplier, partsupp, nation, region WHERE p_partkey = ps_partkey AND s_suppkey = ps_suppkey AND p_size = 15 AND p_type LIKE '%BRASS' AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'EUROPE' AND ps_supplycost = ( SELECT min(ps_supplycost) FROM partsupp, supplier, nation, region WHERE p_partkey = ps_partkey AND s_suppkey = ps_suppkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'EUROPE' ) ORDER BY s_acctbal DESC, n_name, s_name, p_partkey LIMIT 100;
Run:  None SELECT s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment FROM part, supplier, partsupp, nation, region WHERE p_partkey = ps_partkey AND s_suppkey = ps_suppkey AND p_size = 15 AND p_type LIKE '%BRASS' AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'EUROPE' AND ps_supplycost = ( SELECT min(ps_supplycost) FROM partsupp, supplier, nation, region WHERE p_partkey = ps_partkey AND s_suppkey = ps_suppkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'EUROPE' ) ORDER BY s_acctbal DESC, n_name, s_name, p_partkey LIMIT 100;
Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────┐                                                                                                                                                                                                                  
│       LIMIT       │                                                                                                                                                                                                                  
└─────────┬─────────┘                                                                                                                                                                                                                                       
┌─────────┴─────────┐                                                                                                                                                                                                                  
│     PROJECTION    │                                                                                                                                                                                                                  
│   ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                                  
│         #0        │                                                                                                                                                                                                                  
│         #1        │                                                                                                                                                                                                                  
│__internal_decompre│                                                                                                                                                                                                                  
│   ss_string(#2)   │                                                                                                                                                                                                                  
│__internal_decompre│                                                                                                                                                                                                                  
│ss_integral_bigint(│                                                                                                                                                                                                                  
│       #3, 1)      │                                                                                                                                                                                                                  
│__internal_decompre│                                                                                                                                                                                                                  
│   ss_string(#4)   │                                                                                                                                                                                                                  
│         #5        │                                                                                                                                                                                                                  
│__internal_decompre│                                                                                                                                                                                                                  
│   ss_string(#6)   │                                                                                                                                                                                                                  
│         #7        │                                                                                                                                                                                                                  
└─────────┬─────────┘                                                                                                                                                                                                                                       
┌─────────┴─────────┐                                                                                                                                                                                                                  
│      ORDER_BY     │                                                                                                                                                                                                                  
│   ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                                  
│      ORDERS:      │                                                                                                                                                                                                                  
│ supplier.s_acctbal│                                                                                                                                                                                                                  
│        DESC       │                                                                                                                                                                                                                  
│ nation.n_name ASC │                                                                                                                                                                                                                  
│supplier.s_name ASC│                                                                                                                                                                                                                  
│ part.p_partkey ASC│                                                                                                                                                                                                                  
└─────────┬─────────┘                                                                                                                                                                                                                                       
┌─────────┴─────────┐                                                                                                                                                                                                                  
│     PROJECTION    │                                                                                                                                                                                                                  
│   ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                                  
│         #0        │                                                                                                                                                                                                                  
│         #1        │                                                                                                                                                                                                                  
│__internal_compress│                                                                                                                                                                                                                  
│_string_hugeint(#2)│                                                                                                                                                                                                                  
│__internal_compress│                                                                                                                                                                                                                  
│_integral_uinteger(│                                                                                                                                                                                                                  
│       #3, 1)      │                                                                                                                                                                                                                  
│__internal_compress│                                                                                                                                                                                                                  
│_string_hugeint(#4)│                                                                                                                                                                                                                  
│         #5        │                                                                                                                                                                                                                  
│__internal_compress│                                                                                                                                                                                                                  
│_string_hugeint(#6)│                                                                                                                                                                                                                  
│         #7        │                                                                                                                                                                                                                  
└─────────┬─────────┘                                                                                                                                                                                                                                       
┌─────────┴─────────┐                                                                                                                                                                                                                  
│     PROJECTION    │                                                                                                                                                                                                                  
│   ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                                  
│     s_acctbal     │                                                                                                                                                                                                                  
│       s_name      │                                                                                                                                                                                                                  
│       n_name      │                                                                                                                                                                                                                  
│     p_partkey     │                                                                                                                                                                                                                  
│       p_mfgr      │                                                                                                                                                                                                                  
│     s_address     │                                                                                                                                                                                                                  
│      s_phone      │                                                                                                                                                                                                                  
│     s_comment     │                                                                                                                                                                                                                  
└─────────┬─────────┘                                                                                                                                                                                                                                       
┌─────────┴─────────┐                                                                                                                                                                                                                  
│     PROJECTION    │                                                                                                                                                                                                                  
│   ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                                  
│         #0        │                                                                                                                                                                                                                  
│         #2        │                                                                                                                                                                                                                  
│         #4        │                                                                                                                                                                                                                  
│         #6        │                                                                                                                                                                                                                  
│         #8        │                                                                                                                                                                                                                  
│         #9        │                                                                                                                                                                                                                  
│        #10        │                                                                                                                                                                                                                  
│        #11        │                                                                                                                                                                                                                  
│        #12        │                                                                                                                                                                                                                  
│        #13        │                                                                                                                                                                                                                  
└─────────┬─────────┘                                                                                                                                                                                                                                       
┌─────────┴─────────┐                                                                                                                                                                                                                  
│       FILTER      │                                                                                                                                                                                                                  
│   ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                                  
│  (ps_supplycost = │                                                                                                                                                                                                                  
│      SUBQUERY)    │                                                                                                                                                                                                                  
│   ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                                  
│     EC: 400000    │                                                                                                                                                                                                                  
└─────────┬─────────┘                                                                                                                                                                                                                                       
┌─────────┴─────────┐                                                                                                                                                                                                                  
│  RIGHT_DELIM_JOIN │                                                                                                                                                                                                                  
│   ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                                  
│       RIGHT       │                                                                                                                                                                                                                  
│  p_partkey IS NOT │                                                                                                                                                                                                                  
│    DISTINCT FROM  ├──────────────────────────────────────────────────────────────────────────────────────────────┐                                                                                                                   
│      p_partkey    │                                                                                              │                                                                                                                   
│   ─ ─ ─ ─ ─ ─ ─   │                                                                                              │                                                                                                                   
│     EC: 400000    │                                                                                              │                                                                                                                   
└─────────┬─────────┘                                                                                              │                                                                                                                                        
┌─────────┴─────────┐                                                                                    ┌─────────┴─────────┐                                                                                                         
│     HASH_JOIN     │                                                                                    │     HASH_JOIN     │                                                                                                         
│   ─ ─ ─ ─ ─ ─ ─   │                                                                                    │   ─ ─ ─ ─ ─ ─ ─   │                                                                                                         
│       INNER       │                                                                                    │       RIGHT       │                                                                                                         
│    ps_suppkey =   │                                                                                    │  p_partkey IS NOT │                                                                                                         
│      s_suppkey    │                                                                                    │    DISTINCT FROM  │                                                                                                         
│   ─ ─ ─ ─ ─ ─ ─   ├───────────────────────────────┐                                                    │      p_partkey    ├──────────────────────────────────────────────────────────────────────────────────────────────┐          
│    Build Min: 1   │                               │                                                    │   ─ ─ ─ ─ ─ ─ ─   │                                                                                              │          
│  Build Max: 10000 │                               │                                                    │     EC: 400000    │                                                                                              │          
│   ─ ─ ─ ─ ─ ─ ─   │                               │                                                    │                   │                                                                                              │          
│      EC: 587      │                               │                                                    │                   │                                                                                              │          
└─────────┬─────────┘                               │                                                    └─────────┬─────────┘                                                                                              │                               
┌─────────┴─────────┐                     ┌─────────┴─────────┐                                          ┌─────────┴─────────┐                                                                                    ┌─────────┴─────────┐
│     HASH_JOIN     │                     │     HASH_JOIN     │                                          │     PROJECTION    │                                                                                    │     DUMMY_SCAN    │
│   ─ ─ ─ ─ ─ ─ ─   │                     │   ─ ─ ─ ─ ─ ─ ─   │                                          │   ─ ─ ─ ─ ─ ─ ─   │                                                                                    │                   │
│       INNER       │                     │       INNER       │                                          │ min(ps_supplycost)│                                                                                    │                   │
│    ps_partkey =   │                     │   s_nationkey =   │                                          │     p_partkey     │                                                                                    │                   │
│      p_partkey    │                     │     n_nationkey   │                                          │                   │                                                                                    │                   │
│   ─ ─ ─ ─ ─ ─ ─   ├──────────┐          │   ─ ─ ─ ─ ─ ─ ─   ├──────────┐                               │                   │                                                                                    │                   │
│    Build Min: 1   │          │          │    Build Min: 0   │          │                               │                   │                                                                                    │                   │
│ Build Max: 200000 │          │          │   Build Max: 24   │          │                               │                   │                                                                                    │                   │
│   ─ ─ ─ ─ ─ ─ ─   │          │          │   ─ ─ ─ ─ ─ ─ ─   │          │                               │                   │                                                                                    │                   │
│      EC: 3377     │          │          │      EC: 2000     │          │                               │                   │                                                                                    │                   │
└─────────┬─────────┘          │          └─────────┬─────────┘          │                               └─────────┬─────────┘                                                                                    └───────────────────┘                     
┌─────────┴─────────┐┌─────────┴─────────┐┌─────────┴─────────┐┌─────────┴─────────┐                     ┌─────────┴─────────┐                                                                                                         
│     SEQ_SCAN      ││       FILTER      ││     SEQ_SCAN      ││     HASH_JOIN     │                     │     PROJECTION    │                                                                                                         
│   ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─   │                     │   ─ ─ ─ ─ ─ ─ ─   │                                                                                                         
│      partsupp     ││  suffix(p_type,   ││      supplier     ││       INNER       │                     │__internal_decompre│                                                                                                         
│   ─ ─ ─ ─ ─ ─ ─   ││      'BRASS')     ││   ─ ─ ─ ─ ─ ─ ─   ││   n_regionkey =   │                     │ss_integral_bigint(│                                                                                                         
│     ps_partkey    ││   ─ ─ ─ ─ ─ ─ ─   ││     s_suppkey     ││     r_regionkey   │                     │       #0, 1)      │                                                                                                         
│     ps_suppkey    ││      EC: 800      ││    s_nationkey    ││   ─ ─ ─ ─ ─ ─ ─   │                     │         #1        │                                                                                                         
│   ps_supplycost   ││                   ││     s_acctbal     ││    Build Min: 0   ├──────────┐          │                   │                                                                                                         
│   ─ ─ ─ ─ ─ ─ ─   ││                   ││       s_name      ││    Build Max: 4   │          │          │                   │                                                                                                         
│     EC: 800000    ││                   ││     s_address     ││   ─ ─ ─ ─ ─ ─ ─   │          │          │                   │                                                                                                         
│                   ││                   ││      s_phone      ││       EC: 5       │          │          │                   │                                                                                                         
│                   ││                   ││     s_comment     ││                   │          │          │                   │                                                                                                         
│                   ││                   ││   ─ ─ ─ ─ ─ ─ ─   ││                   │          │          │                   │                                                                                                         
│                   ││                   ││     EC: 10000     ││                   │          │          │                   │                                                                                                         
└───────────────────┘└─────────┬─────────┘└───────────────────┘└─────────┬─────────┘          │          └─────────┬─────────┘                                                                                                                              
                     ┌─────────┴─────────┐                     ┌─────────┴─────────┐┌─────────┴─────────┐┌─────────┴─────────┐                                                                                                         
                     │     SEQ_SCAN      │                     │     SEQ_SCAN      ││     SEQ_SCAN      ││   HASH_GROUP_BY   │                                                                                                         
                     │   ─ ─ ─ ─ ─ ─ ─   │                     │   ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─   │                                                                                                         
                     │        part       │                     │       nation      ││       region      ││         #0        │                                                                                                         
                     │   ─ ─ ─ ─ ─ ─ ─   │                     │   ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─   ││      min(#1)      │                                                                                                         
                     │     p_partkey     │                     │    n_nationkey    ││    r_regionkey    ││                   │                                                                                                         
                     │       p_type      │                     │    n_regionkey    ││   ─ ─ ─ ─ ─ ─ ─   ││                   │                                                                                                         
                     │       p_mfgr      │                     │       n_name      ││  Filters: r_name= ││                   │                                                                                                         
                     │   ─ ─ ─ ─ ─ ─ ─   │                     │   ─ ─ ─ ─ ─ ─ ─   ││'EUROPE' AND r...  ││                   │                                                                                                         
                     │ Filters: p_size=15│                     │       EC: 25      ││      NOT NULL     ││                   │                                                                                                         
                     │  AND p_size IS NOT│                     │                   ││   ─ ─ ─ ─ ─ ─ ─   ││                   │                                                                                                         
                     │        NULL       │                     │                   ││       EC: 1       ││                   │                                                                                                         
                     │   ─ ─ ─ ─ ─ ─ ─   │                     │                   ││                   ││                   │                                                                                                         
                     │      EC: 800      │                     │                   ││                   ││                   │                                                                                                         
                     └───────────────────┘                     └───────────────────┘└───────────────────┘└─────────┬─────────┘                                                                                                                              
                                                                                                         ┌─────────┴─────────┐                                                                                                         
                                                                                                         │     PROJECTION    │                                                                                                         
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   │                                                                                                         
                                                                                                         │     p_partkey     │                                                                                                         
                                                                                                         │   ps_supplycost   │                                                                                                         
                                                                                                         └─────────┬─────────┘                                                                                                                              
                                                                                                         ┌─────────┴─────────┐                                                                                                         
                                                                                                         │     PROJECTION    │                                                                                                         
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   │                                                                                                         
                                                                                                         │__internal_compress│                                                                                                         
                                                                                                         │_integral_uinteger(│                                                                                                         
                                                                                                         │       #0, 1)      │                                                                                                         
                                                                                                         │__internal_compress│                                                                                                         
                                                                                                         │_integral_usmallint│                                                                                                         
                                                                                                         │      (#1, 1)      │                                                                                                         
                                                                                                         │         #2        │                                                                                                         
                                                                                                         │__internal_compress│                                                                                                         
                                                                                                         │_integral_usmallint│                                                                                                         
                                                                                                         │      (#3, 1)      │                                                                                                         
                                                                                                         │__internal_compress│                                                                                                         
                                                                                                         │_integral_utinyint(│                                                                                                         
                                                                                                         │       #4, 0)      │                                                                                                         
                                                                                                         │__internal_compress│                                                                                                         
                                                                                                         │_integral_utinyint(│                                                                                                         
                                                                                                         │       #5, 0)      │                                                                                                         
                                                                                                         │__internal_compress│                                                                                                         
                                                                                                         │_integral_utinyint(│                                                                                                         
                                                                                                         │       #6, 0)      │                                                                                                         
                                                                                                         │__internal_compress│                                                                                                         
                                                                                                         │_integral_utinyint(│                                                                                                         
                                                                                                         │       #7, 0)      │                                                                                                         
                                                                                                         │         #8        │                                                                                                         
                                                                                                         └─────────┬─────────┘                                                                                                                              
                                                                                                         ┌─────────┴─────────┐                                                                                                         
                                                                                                         │     HASH_JOIN     │                                                                                                         
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   │                                                                                                         
                                                                                                         │       INNER       │                                                                                                         
                                                                                                         │    ps_partkey =   ├─────────────────────────────────────────────────────────────────────────┐                               
                                                                                                         │      p_partkey    │                                                                         │                               
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   │                                                                         │                               
                                                                                                         │     EC: 800000    │                                                                         │                               
                                                                                                         └─────────┬─────────┘                                                                         │                                                    
                                                                                                         ┌─────────┴─────────┐                                                               ┌─────────┴─────────┐                     
                                                                                                         │     HASH_JOIN     │                                                               │     DELIM_SCAN    │                     
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   │                                                               │                   │                     
                                                                                                         │       INNER       │                                                               │                   │                     
                                                                                                         │   n_regionkey =   │                                                               │                   │                     
                                                                                                         │     r_regionkey   │                                                               │                   │                     
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   ├────────────────────────────────────────────────────┐          │                   │                     
                                                                                                         │    Build Min: 0   │                                                    │          │                   │                     
                                                                                                         │    Build Max: 4   │                                                    │          │                   │                     
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   │                                                    │          │                   │                     
                                                                                                         │     EC: 800000    │                                                    │          │                   │                     
                                                                                                         └─────────┬─────────┘                                                    │          └───────────────────┘                                          
                                                                                                         ┌─────────┴─────────┐                                          ┌─────────┴─────────┐                                          
                                                                                                         │     HASH_JOIN     │                                          │     SEQ_SCAN      │                                          
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   │                                          │   ─ ─ ─ ─ ─ ─ ─   │                                          
                                                                                                         │       INNER       │                                          │       region      │                                          
                                                                                                         │   s_nationkey =   │                                          │   ─ ─ ─ ─ ─ ─ ─   │                                          
                                                                                                         │     n_nationkey   │                                          │    r_regionkey    │                                          
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   ├───────────────────────────────┐          │   ─ ─ ─ ─ ─ ─ ─   │                                          
                                                                                                         │    Build Min: 0   │                               │          │  Filters: r_name= │                                          
                                                                                                         │   Build Max: 24   │                               │          │'EUROPE' AND r...  │                                          
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   │                               │          │      NOT NULL     │                                          
                                                                                                         │     EC: 800000    │                               │          │   ─ ─ ─ ─ ─ ─ ─   │                                          
                                                                                                         │                   │                               │          │       EC: 1       │                                          
                                                                                                         └─────────┬─────────┘                               │          └───────────────────┘                                                               
                                                                                                         ┌─────────┴─────────┐                     ┌─────────┴─────────┐                                                               
                                                                                                         │     HASH_JOIN     │                     │     SEQ_SCAN      │                                                               
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   │                     │   ─ ─ ─ ─ ─ ─ ─   │                                                               
                                                                                                         │       INNER       │                     │       nation      │                                                               
                                                                                                         │    ps_suppkey =   │                     │   ─ ─ ─ ─ ─ ─ ─   │                                                               
                                                                                                         │      s_suppkey    │                     │    n_nationkey    │                                                               
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   ├──────────┐          │    n_regionkey    │                                                               
                                                                                                         │    Build Min: 1   │          │          │   ─ ─ ─ ─ ─ ─ ─   │                                                               
                                                                                                         │  Build Max: 10000 │          │          │       EC: 25      │                                                               
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   │          │          │                   │                                                               
                                                                                                         │     EC: 800000    │          │          │                   │                                                               
                                                                                                         └─────────┬─────────┘          │          └───────────────────┘                                                                                    
                                                                                                         ┌─────────┴─────────┐┌─────────┴─────────┐                                                                                    
                                                                                                         │     SEQ_SCAN      ││     SEQ_SCAN      │                                                                                    
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─   │                                                                                    
                                                                                                         │      partsupp     ││      supplier     │                                                                                    
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─   │                                                                                    
                                                                                                         │     ps_partkey    ││     s_suppkey     │                                                                                    
                                                                                                         │     ps_suppkey    ││    s_nationkey    │                                                                                    
                                                                                                         │   ps_supplycost   ││   ─ ─ ─ ─ ─ ─ ─   │                                                                                    
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   ││     EC: 10000     │                                                                                    
                                                                                                         │     EC: 800000    ││                   │                                                                                    
                                                                                                         └───────────────────┘└───────────────────┘                                                                                                         

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

Avg Time in sec:  0.061250227969139814  output size:  100
    s_acctbal  ...                                          s_comment
0     9938.53  ...                      l, ironic instructions cajole
1     9937.84  ...  es. furiously silent deposits among the deposi...
2     9936.22  ...  ar, regular requests nag blithely special acco...
3     9923.77  ...  s sleep according to the quick requests. caref...
4     9871.22  ...  against the slyly daring requests. unusual acc...
..        ...  ...                                                ...
95    7887.08  ...   the regular ideas. furiously bold deposits bo...
96    7871.50  ...  ording to the furious theodolites cajole caref...
97    7852.45  ...  egular, regular ideas. requests are carefully....
98    7850.66  ...                   ccounts. special, final deposits
99    7843.52  ...  sits. blithely regular requests above the pend...

[100 rows x 8 columns]
{'name': 'Query', 'result': 0.05323, 'timing': 0.05323, 'cardinality': 0, 'extra-info': "SELECT s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment FROM part, supplier, partsupp, nation, region WHERE p_partkey = ps_partkey AND s_suppkey = ps_suppkey AND p_size = 15 AND p_type LIKE '%BRASS' AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'EUROPE' AND ps_supplycost = ( SELECT min(ps_supplycost) FROM partsupp, supplier, nation, region WHERE p_partkey = ps_partkey AND s_suppkey = ps_suppkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'EUROPE' ) ORDER BY s_acctbal DESC, n_name, s_name, p_partkey LIMIT 100;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 3.3e-05, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'LIMIT', 'timing': 0.000274, 'cardinality': 100, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 6e-05, 'cardinality': 460, 'extra_info': '#0\n#1\n__internal_decompress_string(#2)\n__internal_decompress_integral_bigint(#3, 1)\n__internal_decompress_string(#4)\n#5\n__internal_decompress_string(#6)\n#7\n', 'children': [{'name': 'ORDER_BY', 'timing': 0.004513, 'cardinality': 460, 'extra_info': 'ORDERS:\nsupplier.s_acctbal DESC\nnation.n_name ASC\nsupplier.s_name ASC\npart.p_partkey ASC', 'children': [{'name': 'PROJECTION', 'timing': 6.6e-05, 'cardinality': 460, 'extra_info': '#0\n#1\n__internal_compress_string_hugeint(#2)\n__internal_compress_integral_uinteger(#3, 1)\n__internal_compress_string_hugeint(#4)\n#5\n__internal_compress_string_hugeint(#6)\n#7\n', 'children': [{'name': 'PROJECTION', 'timing': 8e-06, 'cardinality': 460, 'extra_info': 's_acctbal\ns_name\nn_name\np_partkey\np_mfgr\ns_address\ns_phone\ns_comment\n', 'children': [{'name': 'PROJECTION', 'timing': 1e-05, 'cardinality': 460, 'extra_info': '#0\n#2\n#4\n#6\n#8\n#9\n#10\n#11\n#12\n#13\n', 'children': [{'name': 'FILTER', 'timing': 0.000223, 'cardinality': 460, 'extra_info': '(ps_supplycost = SUBQUERY)\n[INFOSEPARATOR]\nEC: 400000', 'children': [{'name': 'RIGHT_DELIM_JOIN', 'timing': 0.016505, 'cardinality': 0, 'extra_info': 'RIGHT\np_partkey IS NOT DISTINCT FROM p_partkey\n\n[INFOSEPARATOR]\nEC: 400000\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.000981, 'cardinality': 642, 'extra_info': 'INNER\nps_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 587\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.01647, 'cardinality': 2988, 'extra_info': 'INNER\nps_partkey = p_partkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 3377\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.005072, 'cardinality': 800000, 'extra_info': 'partsupp\n[INFOSEPARATOR]\nps_partkey\nps_suppkey\nps_supplycost\n[INFOSEPARATOR]\nEC: 800000', 'children': []}, {'name': 'FILTER', 'timing': 0.001532, 'cardinality': 747, 'extra_info': "suffix(p_type, 'BRASS')\n[INFOSEPARATOR]\nEC: 800", 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.025194, 'cardinality': 3907, 'extra_info': 'part\n[INFOSEPARATOR]\np_partkey\np_type\np_mfgr\n[INFOSEPARATOR]\nFilters: p_size=15 AND p_size IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 800', 'children': []}]}]}, {'name': 'HASH_JOIN', 'timing': 0.000164, 'cardinality': 1987, 'extra_info': 'INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 2000\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.001214, 'cardinality': 10000, 'extra_info': 'supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\ns_acctbal\ns_name\ns_address\ns_phone\ns_comment\n[INFOSEPARATOR]\nEC: 10000', 'children': []}, {'name': 'HASH_JOIN', 'timing': 4.9e-05, 'cardinality': 5, 'extra_info': 'INNER\nn_regionkey = r_regionkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 4\n\n[INFOSEPARATOR]\nEC: 5\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 1.3e-05, 'cardinality': 25, 'extra_info': 'nation\n[INFOSEPARATOR]\nn_nationkey\nn_regionkey\nn_name\n[INFOSEPARATOR]\nEC: 25', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 3.9e-05, 'cardinality': 1, 'extra_info': "region\n[INFOSEPARATOR]\nr_regionkey\n[INFOSEPARATOR]\nFilters: r_name='EUROPE' AND r_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1", 'children': []}]}]}]}, {'name': 'HASH_JOIN', 'timing': 0.004482, 'cardinality': 642, 'extra_info': 'RIGHT\np_partkey IS NOT DISTINCT FROM p_partkey\n\n[INFOSEPARATOR]\nEC: 400000\n', 'children': [{'name': 'PROJECTION', 'timing': 5e-06, 'cardinality': 460, 'extra_info': 'min(ps_supplycost)\np_partkey\n', 'children': [{'name': 'PROJECTION', 'timing': 2.6e-05, 'cardinality': 460, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n#1\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.005875, 'cardinality': 460, 'extra_info': '#0\nmin(#1)', 'children': [{'name': 'PROJECTION', 'timing': 4e-06, 'cardinality': 642, 'extra_info': 'p_partkey\nps_supplycost\n', 'children': [{'name': 'PROJECTION', 'timing': 0.000102, 'cardinality': 642, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n__internal_compress_integral_usmallint(#1, 1)\n#2\n__internal_compress_integral_usmallint(#3, 1)\n__internal_compress_integral_utinyint(#4, 0)\n__internal_compress_integral_utinyint(#5, 0)\n__internal_compress_integral_utinyint(#6, 0)\n__internal_compress_integral_utinyint(#7, 0)\n#8\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.011919, 'cardinality': 642, 'extra_info': 'INNER\nps_partkey = p_partkey\n\n[INFOSEPARATOR]\nEC: 800000\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.01305, 'cardinality': 158960, 'extra_info': 'INNER\nn_regionkey = r_regionkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 4\n\n[INFOSEPARATOR]\nEC: 800000\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.017598, 'cardinality': 800000, 'extra_info': 'INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 800000\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.026186, 'cardinality': 800000, 'extra_info': 'INNER\nps_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 800000\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.00221, 'cardinality': 800000, 'extra_info': 'partsupp\n[INFOSEPARATOR]\nps_partkey\nps_suppkey\nps_supplycost\n[INFOSEPARATOR]\nEC: 800000', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 9.3e-05, 'cardinality': 10000, 'extra_info': 'supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\n[INFOSEPARATOR]\nEC: 10000', 'children': []}]}, {'name': 'SEQ_SCAN ', 'timing': 2.2e-05, 'cardinality': 25, 'extra_info': 'nation\n[INFOSEPARATOR]\nn_nationkey\nn_regionkey\n[INFOSEPARATOR]\nEC: 25', 'children': []}]}, {'name': 'SEQ_SCAN ', 'timing': 5.1e-05, 'cardinality': 1, 'extra_info': "region\n[INFOSEPARATOR]\nr_regionkey\n[INFOSEPARATOR]\nFilters: r_name='EUROPE' AND r_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1", 'children': []}]}, {'name': 'DELIM_SCAN', 'timing': 0.0, 'cardinality': 0, 'extra_info': '', 'children': []}]}]}]}]}]}]}, {'name': 'DUMMY_SCAN', 'timing': 0.0, 'cardinality': 0, 'extra_info': '', 'children': []}]}, {'name': 'HASH_GROUP_BY', 'timing': 0.002471, 'cardinality': 460, 'extra_info': '#0', 'children': []}]}]}]}]}]}]}]}]}]}]}
X {'RESULT_COLLECTOR0': 3.3e-05, 'LIMIT1': 0.000274, 'PROJECTION2': 6e-05, 'ORDER_BY3': 0.004513, 'PROJECTION4': 6.6e-05, 'PROJECTION5': 8e-06, 'PROJECTION6': 1e-05, 'FILTER7': 0.000223, 'RIGHT_DELIM_JOIN8': 0.016505, 'HASH_JOIN9': 0.000981, 'HASH_JOIN10': 0.01647, 'SEQ_SCAN 11': 0.005072, 'FILTER12': 0.001532, 'SEQ_SCAN 13': 0.025194, 'HASH_JOIN14': 0.000164, 'SEQ_SCAN 15': 0.001214, 'HASH_JOIN16': 4.9e-05, 'SEQ_SCAN 17': 1.3e-05, 'SEQ_SCAN 18': 3.9e-05, 'HASH_JOIN19': 0.004482, 'PROJECTION20': 5e-06, 'PROJECTION21': 2.6e-05, 'HASH_GROUP_BY22': 0.005875, 'PROJECTION23': 4e-06, 'PROJECTION24': 0.000102, 'HASH_JOIN25': 0.011919, 'HASH_JOIN26': 0.01305, 'HASH_JOIN27': 0.017598, 'HASH_JOIN28': 0.026186, 'SEQ_SCAN 29': 0.00221, 'SEQ_SCAN 30': 9.3e-05, 'SEQ_SCAN 31': 2.2e-05, 'SEQ_SCAN 32': 5.1e-05, 'DELIM_SCAN33': 0.0, 'DUMMY_SCAN34': 0.0, 'HASH_GROUP_BY35': 0.002471}
compressed filter_log_size: 10236
compressed filter_log_buffer_size: 3139
compressed limit_offset_size: 3952
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 37760
compressed perfect_full_scan_ht_log_buffer_size: 31264
compressed perfect_probe_ht_log_size: 2127136
compressed perfect_probe_ht_log_buffer_size: 2096581
compressed row_group_log_size: 27285
compressed row_group_log_buffer_size: 12964
compressed scatter_log_size: 10963
compressed scatter_log_buffer_size: 5139
compressed scatter_sel_log_size: 71599
compressed scatter_sel_log_buffer_size: 62482
compressed gather_log_size: 3808
compressed gather_log_buffer_size: 0
compressed combine_log_size: 18254
compressed combine_log_buffer_size: 11684
compressed finalize_states_log_size: 6830
compressed finalize_states_log_buffer_size: 1142
compressed join_gather_log_size: 24530
compressed join_gather_log_buffer_size: 11718
compressed reorder_log_size: 6560
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 3808
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 3808
compressed nlj_log_buffer_size: 0
compressed total_size: 2356529
compressed total_buffer_size: 2236113
compressed total_element_size: 120416

Clear Lineage

**** output size:  100
LINEAGE_5_FILTER_19
LINEAGE_5_FILTER_28
LINEAGE_5_HASH_GROUP_BY_11
LINEAGE_5_HASH_GROUP_BY_16
LINEAGE_5_HASH_JOIN_15
LINEAGE_5_HASH_JOIN_2
LINEAGE_5_HASH_JOIN_20
LINEAGE_5_HASH_JOIN_24
LINEAGE_5_HASH_JOIN_25
LINEAGE_5_HASH_JOIN_26
LINEAGE_5_HASH_JOIN_4
LINEAGE_5_HASH_JOIN_6
LINEAGE_5_HASH_JOIN_8
LINEAGE_5_LIMIT_34
LINEAGE_5_ORDER_BY_32
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_1
LINEAGE_5_SEQ_SCAN_17
LINEAGE_5_SEQ_SCAN_18
LINEAGE_5_SEQ_SCAN_21
LINEAGE_5_SEQ_SCAN_22
LINEAGE_5_SEQ_SCAN_23
LINEAGE_5_SEQ_SCAN_3
LINEAGE_5_SEQ_SCAN_5
SELECT s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment FROM part, supplier, partsupp, nation, region WHERE p_partkey = ps_partkey AND s_suppkey = ps_suppkey AND p_size = 15 AND p_type LIKE '%BRASS' AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'EUROPE' AND ps_supplycost = ( SELECT min(ps_supplycost) FROM partsupp, supplier, nation, region WHERE p_partkey = ps_partkey AND s_suppkey = ps_suppkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'EUROPE' ) ORDER BY s_acctbal DESC, n_name, s_name, p_partkey LIMIT 100;
   query_id  ...                                               plan
0         5  ...  {"name": "LIMIT", "opid": "34", "children": [{...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               SELECT s_acctbal, s_name, n_name, p_partkey, p...
size_bytes_max                                                2356529
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "LIMIT", "opid": "34", "children": [{...
Name: 0, dtype: object
{"name": "LIMIT", "opid": "34", "children": [{"name": "PROJECTION", "opid": "33", "children": [{"name": "ORDER_BY", "opid": "32", "children": [{"name": "PROJECTION", "opid": "31", "children": [{"name": "PROJECTION", "opid": "30", "children": [{"name": "PROJECTION", "opid": "29", "children": [{"name": "FILTER", "opid": "28", "children": [{"name": "RIGHT_DELIM_JOIN", "opid": "27", "children": [{"name": "HASH_GROUP_BY", "opid": "16", "children": [],"table": "","extra": "#0"},{"name": "HASH_JOIN", "opid": "15", "children": [{"name": "PROJECTION", "opid": "13", "children": [{"name": "PROJECTION", "opid": "12", "children": [{"name": "HASH_GROUP_BY", "opid": "11", "children": [{"name": "PROJECTION", "opid": "10", "children": [{"name": "PROJECTION", "opid": "9", "children": [{"name": "HASH_JOIN", "opid": "8", "children": [{"name": "HASH_JOIN", "opid": "6", "children": [{"name": "HASH_JOIN", "opid": "4", "children": [{"name": "HASH_JOIN", "opid": "2", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "partsupp","extra": "partsupp\n[INFOSEPARATOR]\nps_partkey\nps_suppkey\nps_supplycost\n[INFOSEPARATOR]\nEC: 800000"},{"name": "SEQ_SCAN ", "opid": "1", "children": [],"table": "supplier","extra": "supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\n[INFOSEPARATOR]\nEC: 10000"}],"table": "","extra": "INNER\nps_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 800000\n"},{"name": "SEQ_SCAN ", "opid": "3", "children": [],"table": "nation","extra": "nation\n[INFOSEPARATOR]\nn_nationkey\nn_regionkey\n[INFOSEPARATOR]\nEC: 25"}],"table": "","extra": "INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 800000\n"},{"name": "SEQ_SCAN ", "opid": "5", "children": [],"table": "region","extra": "region\n[INFOSEPARATOR]\nr_regionkey\n[INFOSEPARATOR]\nFilters: r_name='EUROPE' AND r_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1"}],"table": "","extra": "INNER\nn_regionkey = r_regionkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 4\n\n[INFOSEPARATOR]\nEC: 800000\n"},{"name": "DELIM_SCAN", "opid": "7", "children": [],"table": "","extra": ""}],"table": "","extra": "INNER\nps_partkey = p_partkey\n\n[INFOSEPARATOR]\nEC: 800000\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n__internal_compress_integral_usmallint(#1, 1)\n#2\n__internal_compress_integral_usmallint(#3, 1)\n__internal_compress_integral_utinyint(#4, 0)\n__internal_compress_integral_utinyint(#5, 0)\n__internal_compress_integral_utinyint(#6, 0)\n__internal_compress_integral_utinyint(#7, 0)\n#8\n"}],"table": "","extra": "p_partkey\nps_supplycost\n"}],"table": "","extra": "#0\nmin(#1)"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n#1\n"}],"table": "","extra": "min(ps_supplycost)\np_partkey\n"},{"name": "DUMMY_SCAN", "opid": "14", "children": [],"table": "","extra": ""}],"table": "","extra": "RIGHT\np_partkey IS NOT DISTINCT FROM p_partkey\n\n[INFOSEPARATOR]\nEC: 400000\n"},{"name": "HASH_JOIN", "opid": "26", "children": [{"name": "HASH_JOIN", "opid": "20", "children": [{"name": "SEQ_SCAN ", "opid": "17", "children": [],"table": "partsupp","extra": "partsupp\n[INFOSEPARATOR]\nps_partkey\nps_suppkey\nps_supplycost\n[INFOSEPARATOR]\nEC: 800000"},{"name": "FILTER", "opid": "19", "children": [{"name": "SEQ_SCAN ", "opid": "18", "children": [],"table": "part","extra": "part\n[INFOSEPARATOR]\np_partkey\np_type\np_mfgr\n[INFOSEPARATOR]\nFilters: p_size=15 AND p_size IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 800"}],"table": "","extra": "suffix(p_type, 'BRASS')\n[INFOSEPARATOR]\nEC: 800"}],"table": "","extra": "INNER\nps_partkey = p_partkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 3377\n"},{"name": "HASH_JOIN", "opid": "25", "children": [{"name": "SEQ_SCAN ", "opid": "21", "children": [],"table": "supplier","extra": "supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\ns_acctbal\ns_name\ns_address\ns_phone\ns_comment\n[INFOSEPARATOR]\nEC: 10000"},{"name": "HASH_JOIN", "opid": "24", "children": [{"name": "SEQ_SCAN ", "opid": "22", "children": [],"table": "nation","extra": "nation\n[INFOSEPARATOR]\nn_nationkey\nn_regionkey\nn_name\n[INFOSEPARATOR]\nEC: 25"},{"name": "SEQ_SCAN ", "opid": "23", "children": [],"table": "region","extra": "region\n[INFOSEPARATOR]\nr_regionkey\n[INFOSEPARATOR]\nFilters: r_name='EUROPE' AND r_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1"}],"table": "","extra": "INNER\nn_regionkey = r_regionkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 4\n\n[INFOSEPARATOR]\nEC: 5\n"}],"table": "","extra": "INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 2000\n"}],"table": "","extra": "INNER\nps_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 587\n"}],"table": "","extra": "RIGHT\np_partkey IS NOT DISTINCT FROM p_partkey\n\n[INFOSEPARATOR]\nEC: 400000\n"}],"table": "","extra": "(ps_supplycost = SUBQUERY)\n[INFOSEPARATOR]\nEC: 400000"}],"table": "","extra": "#0\n#2\n#4\n#6\n#8\n#9\n#10\n#11\n#12\n#13\n"}],"table": "","extra": "s_acctbal\ns_name\nn_name\np_partkey\np_mfgr\ns_address\ns_phone\ns_comment\n"}],"table": "","extra": "#0\n#1\n__internal_compress_string_hugeint(#2)\n__internal_compress_integral_uinteger(#3, 1)\n__internal_compress_string_hugeint(#4)\n#5\n__internal_compress_string_hugeint(#6)\n#7\n"}],"table": "","extra": "ORDERS:\nsupplier.s_acctbal DESC\nnation.n_name ASC\nsupplier.s_name ASC\npart.p_partkey ASC"}],"table": "","extra": "#0\n#1\n__internal_decompress_string(#2)\n__internal_decompress_integral_bigint(#3, 1)\n__internal_decompress_string(#4)\n#5\n__internal_decompress_string(#6)\n#7\n"}],"table": "","extra": ""}
%%%%%%%%%%%%%%%% Running Query #  3  threads:  8
SELECT l_orderkey, sum(l_extendedprice * (1 - l_discount)) AS revenue, o_orderdate, o_shippriority FROM customer, orders, lineitem WHERE c_mktsegment = 'BUILDING' AND c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate < CAST('1995-03-15' AS date) AND l_shipdate > CAST('1995-03-15' AS date) GROUP BY l_orderkey, o_orderdate, o_shippriority ORDER BY revenue DESC, o_orderdate LIMIT 10;
Run:  None SELECT l_orderkey, sum(l_extendedprice * (1 - l_discount)) AS revenue, o_orderdate, o_shippriority FROM customer, orders, lineitem WHERE c_mktsegment = 'BUILDING' AND c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate < CAST('1995-03-15' AS date) AND l_shipdate > CAST('1995-03-15' AS date) GROUP BY l_orderkey, o_orderdate, o_shippriority ORDER BY revenue DESC, o_orderdate LIMIT 10;
Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                                                          
│           LIMIT           │                                                          
└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          
│         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│__internal_decompress_integ│                                                          
│     ral_bigint(#0, 1)     │                                                          
│             #1            │                                                          
│             #2            │                                                          
│__internal_decompress_integ│                                                          
│     ral_integer(#3, 0)    │                                                          
└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          
│          ORDER_BY         │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│          ORDERS:          │                                                          
│       sum((lineitem       │                                                          
│.l_extendedprice * (1 ...  │                                                          
│    .l_discount))) DESC    │                                                          
│   orders.o_orderdate ASC  │                                                          
└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          
│         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│__internal_compress_integra│                                                          
│     l_uinteger(#0, 1)     │                                                          
│             #1            │                                                          
│             #2            │                                                          
│__internal_compress_integra│                                                          
│     l_utinyint(#3, 0)     │                                                          
└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          
│         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│         l_orderkey        │                                                          
│          revenue          │                                                          
│        o_orderdate        │                                                          
│       o_shippriority      │                                                          
└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          
│         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│__internal_decompress_integ│                                                          
│     ral_bigint(#0, 1)     │                                                          
│             #1            │                                                          
│__internal_decompress_integ│                                                          
│     ral_integer(#2, 0)    │                                                          
│             #3            │                                                          
└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          
│       HASH_GROUP_BY       │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│             #0            │                                                          
│             #1            │                                                          
│             #2            │                                                          
│          sum(#3)          │                                                          
└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          
│         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│         l_orderkey        │                                                          
│        o_orderdate        │                                                          
│       o_shippriority      │                                                          
│ (l_extendedprice * (1.00 -│                                                          
│        l_discount))       │                                                          
└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          
│         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│__internal_compress_integra│                                                          
│     l_uinteger(#0, 1)     │                                                          
│             #1            │                                                          
│             #2            │                                                          
│__internal_compress_integra│                                                          
│     l_uinteger(#3, 1)     │                                                          
│             #4            │                                                          
│__internal_compress_integra│                                                          
│     l_utinyint(#5, 0)     │                                                          
└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          
│         HASH_JOIN         │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│           INNER           │                                                          
│  l_orderkey = o_orderkey  ├──────────────┐                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                           
│         EC: 28949         │              │                                           
└─────────────┬─────────────┘              │                                                                        
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             
│         SEQ_SCAN          ││         HASH_JOIN         │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│          lineitem         ││           INNER           │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   o_custkey = c_custkey   │                             
│         l_orderkey        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│      l_extendedprice      ││        Build Min: 1       │                             
│         l_discount        ││     Build Max: 149999     ├──────────────┐              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              
│ Filters: l_shipdate>'1995 ││         EC: 36179         │              │              
│-03-15'::DATE AND l_sh...  ││                           │              │              
│         IS NOT NULL       ││                           │              │              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │              │              
│        EC: 1200243        ││                           │              │              
└───────────────────────────┘└─────────────┬─────────────┘              │                                           
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
                             │         SEQ_SCAN          ││           FILTER          │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                             │           orders          ││   (c_custkey <= 149999)   │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                             │         o_custkey         ││         EC: 30000         │
                             │         o_orderkey        ││                           │
                             │        o_orderdate        ││                           │
                             │       o_shippriority      ││                           │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │
                             │ Filters: o_orderdate<'1995││                           │
                             │     -03-15'::DATE AND     ││                           │
                             │   o_orderdate IS NOT NULL ││                           │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │
                             │         EC: 300000        ││                           │
                             └───────────────────────────┘└─────────────┬─────────────┘                             
                                                          ┌─────────────┴─────────────┐
                                                          │         SEQ_SCAN          │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │          customer         │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │         c_custkey         │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │   Filters: c_mktsegment=  │
                                                          │'BUILDING' AND c_mktse...  │
                                                          │          NOT NULL         │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │         EC: 30000         │
                                                          └───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

compressed filter_log_size: 3049
compressed filter_log_buffer_size: 0
compressed limit_offset_size: 2368
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 101854
compressed perfect_full_scan_ht_log_buffer_size: 99246
compressed perfect_probe_ht_log_size: 481079
compressed perfect_probe_ht_log_buffer_size: 466901
compressed row_group_log_size: 1010511
compressed row_group_log_buffer_size: 956586
compressed scatter_log_size: 111854
compressed scatter_log_buffer_size: 108473
compressed scatter_sel_log_size: 836127
compressed scatter_sel_log_buffer_size: 823196
compressed gather_log_size: 2224
compressed gather_log_buffer_size: 0
compressed combine_log_size: 11093
compressed combine_log_buffer_size: 7424
compressed finalize_states_log_size: 5342
compressed finalize_states_log_buffer_size: 1966
compressed join_gather_log_size: 346430
compressed join_gather_log_buffer_size: 285454
compressed reorder_log_size: 21563
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 2224
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 2224
compressed nlj_log_buffer_size: 0
compressed total_size: 2937942
compressed total_buffer_size: 2749246
compressed total_element_size: 188696

Avg Time in sec:  0.058626573998481035  output size:  10
   l_orderkey      revenue o_orderdate  o_shippriority
0     2456423  406181.0111  1995-03-05               0
1     3459808  405838.6989  1995-03-04               0
2      492164  390324.0610  1995-02-19               0
3     1188320  384537.9359  1995-03-09               0
4     2435712  378673.0558  1995-02-26               0
5     4878020  378376.7952  1995-03-12               0
6     5521732  375153.9215  1995-03-13               0
7     2628192  373133.3094  1995-02-22               0
8      993600  371407.4595  1995-03-05               0
9     2300070  367371.1452  1995-03-13               0
{'name': 'Query', 'result': 0.050667, 'timing': 0.050667, 'cardinality': 0, 'extra-info': "SELECT l_orderkey, sum(l_extendedprice * (1 - l_discount)) AS revenue, o_orderdate, o_shippriority FROM customer, orders, lineitem WHERE c_mktsegment = 'BUILDING' AND c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate < CAST('1995-03-15' AS date) AND l_shipdate > CAST('1995-03-15' AS date) GROUP BY l_orderkey, o_orderdate, o_shippriority ORDER BY revenue DESC, o_orderdate LIMIT 10;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 9e-06, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'LIMIT', 'timing': 0.000161, 'cardinality': 10, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 8.6e-05, 'cardinality': 11620, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n#1\n#2\n__internal_decompress_integral_integer(#3, 0)\n', 'children': [{'name': 'ORDER_BY', 'timing': 0.000887, 'cardinality': 11620, 'extra_info': 'ORDERS:\nsum((lineitem.l_extendedprice * (1 - lineitem.l_discount))) DESC\norders.o_orderdate ASC', 'children': [{'name': 'PROJECTION', 'timing': 3.6e-05, 'cardinality': 11620, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n#1\n#2\n__internal_compress_integral_utinyint(#3, 0)\n', 'children': [{'name': 'PROJECTION', 'timing': 6e-06, 'cardinality': 11620, 'extra_info': 'l_orderkey\nrevenue\no_orderdate\no_shippriority\n', 'children': [{'name': 'PROJECTION', 'timing': 6.6e-05, 'cardinality': 11620, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n#1\n__internal_decompress_integral_integer(#2, 0)\n#3\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.01151, 'cardinality': 11620, 'extra_info': '#0\n#1\n#2\nsum(#3)', 'children': [{'name': 'PROJECTION', 'timing': 0.000228, 'cardinality': 30519, 'extra_info': 'l_orderkey\no_orderdate\no_shippriority\n(l_extendedprice * (1.00 - l_discount))\n', 'children': [{'name': 'PROJECTION', 'timing': 0.00028, 'cardinality': 30519, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n#1\n#2\n__internal_compress_integral_uinteger(#3, 1)\n#4\n__internal_compress_integral_utinyint(#5, 0)\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.136125, 'cardinality': 30519, 'extra_info': 'INNER\nl_orderkey = o_orderkey\n\n[INFOSEPARATOR]\nEC: 28949\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.048614, 'cardinality': 3241776, 'extra_info': "lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nFilters: l_shipdate>'1995-03-15'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243", 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.026462, 'cardinality': 147126, 'extra_info': 'INNER\no_custkey = c_custkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 149999\n\n[INFOSEPARATOR]\nEC: 36179\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.030367, 'cardinality': 727305, 'extra_info': "orders\n[INFOSEPARATOR]\no_custkey\no_orderkey\no_orderdate\no_shippriority\n[INFOSEPARATOR]\nFilters: o_orderdate<'1995-03-15'::DATE AND o_orderdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 300000", 'children': []}, {'name': 'FILTER', 'timing': 0.00038, 'cardinality': 30142, 'extra_info': '(c_custkey <= 149999)\n[INFOSEPARATOR]\nEC: 30000', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.00548, 'cardinality': 30142, 'extra_info': "customer\n[INFOSEPARATOR]\nc_custkey\n[INFOSEPARATOR]\nFilters: c_mktsegment='BUILDING' AND c_mktsegment IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 30000", 'children': []}]}]}]}]}]}]}]}]}]}]}]}]}]}]}
X {'RESULT_COLLECTOR0': 9e-06, 'LIMIT1': 0.000161, 'PROJECTION2': 8.6e-05, 'ORDER_BY3': 0.000887, 'PROJECTION4': 3.6e-05, 'PROJECTION5': 6e-06, 'PROJECTION6': 6.6e-05, 'HASH_GROUP_BY7': 0.01151, 'PROJECTION8': 0.000228, 'PROJECTION9': 0.00028, 'HASH_JOIN10': 0.136125, 'SEQ_SCAN 11': 0.048614, 'HASH_JOIN12': 0.026462, 'SEQ_SCAN 13': 0.030367, 'FILTER14': 0.00038, 'SEQ_SCAN 15': 0.00548}
**** output size:  10
LINEAGE_5_FILTER_3
LINEAGE_5_HASH_GROUP_BY_8
LINEAGE_5_HASH_JOIN_4
LINEAGE_5_HASH_JOIN_5
LINEAGE_5_LIMIT_14
LINEAGE_5_ORDER_BY_12
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_1
LINEAGE_5_SEQ_SCAN_2
SELECT l_orderkey, sum(l_extendedprice * (1 - l_discount)) AS revenue, o_orderdate, o_shippriority FROM customer, orders, lineitem WHERE c_mktsegment = 'BUILDING' AND c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate < CAST('1995-03-15' AS date) AND l_shipdate > CAST('1995-03-15' AS date) GROUP BY l_orderkey, o_orderdate, o_shippriority ORDER BY revenue DESC, o_orderdate LIMIT 10;
   query_id  ...                                               plan
0         5  ...  {"name": "LIMIT", "opid": "14", "children": [{...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               SELECT l_orderkey, sum(l_extendedprice * (1 - ...
size_bytes_max                                                2937942
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "LIMIT", "opid": "14", "children": [{...
Name: 0, dtype: object
{"name": "LIMIT", "opid": "14", "children": [{"name": "PROJECTION", "opid": "13", "children": [{"name": "ORDER_BY", "opid": "12", "children": [{"name": "PROJECTION", "opid": "11", "children": [{"name": "PROJECTION", "opid": "10", "children": [{"name": "PROJECTION", "opid": "9", "children": [{"name": "HASH_GROUP_BY", "opid": "8", "children": [{"name": "PROJECTION", "opid": "7", "children": [{"name": "PROJECTION", "opid": "6", "children": [{"name": "HASH_JOIN", "opid": "5", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nFilters: l_shipdate>'1995-03-15'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243"},{"name": "HASH_JOIN", "opid": "4", "children": [{"name": "SEQ_SCAN ", "opid": "1", "children": [],"table": "orders","extra": "orders\n[INFOSEPARATOR]\no_custkey\no_orderkey\no_orderdate\no_shippriority\n[INFOSEPARATOR]\nFilters: o_orderdate<'1995-03-15'::DATE AND o_orderdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 300000"},{"name": "FILTER", "opid": "3", "children": [{"name": "SEQ_SCAN ", "opid": "2", "children": [],"table": "customer","extra": "customer\n[INFOSEPARATOR]\nc_custkey\n[INFOSEPARATOR]\nFilters: c_mktsegment='BUILDING' AND c_mktsegment IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 30000"}],"table": "","extra": "(c_custkey <= 149999)\n[INFOSEPARATOR]\nEC: 30000"}],"table": "","extra": "INNER\no_custkey = c_custkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 149999\n\n[INFOSEPARATOR]\nEC: 36179\n"}],"table": "","extra": "INNER\nl_orderkey = o_orderkey\n\n[INFOSEPARATOR]\nEC: 28949\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n#1\n#2\n__internal_compress_integral_uinteger(#3, 1)\n#4\n__internal_compress_integral_utinyint(#5, 0)\n"}],"table": "","extra": "l_orderkey\no_orderdate\no_shippriority\n(l_extendedprice * (1.00 - l_discount))\n"}],"table": "","extra": "#0\n#1\n#2\nsum(#3)"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n#1\n__internal_decompress_integral_integer(#2, 0)\n#3\n"}],"table": "","extra": "l_orderkey\nrevenue\no_orderdate\no_shippriority\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n#1\n#2\n__internal_compress_integral_utinyint(#3, 0)\n"}],"table": "","extra": "ORDERS:\nsum((lineitem.l_extendedprice * (1 - lineitem.l_discount))) DESC\norders.o_orderdate ASC"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n#1\n#2\n__internal_decompress_integral_integer(#3, 0)\n"}],"table": "","extra": ""}
Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│__internal_decompress_strin│                                                                                       
│           g(#0)           │                                                                                       
│             #1            │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│          ORDER_BY         │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│          ORDERS:          │                                                                                       
│ orders.o_orderpriority ASC│                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│__internal_compress_string_│                                                                                       
│        hugeint(#0)        │                                                                                       
│             #1            │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│__internal_decompress_strin│                                                                                       
│           g(#0)           │                                                                                       
│             #1            │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│       HASH_GROUP_BY       │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│             #0            │                                                                                       
│        count_star()       │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│      o_orderpriority      │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│__internal_compress_integra│                                                                                       
│     l_uinteger(#0, 1)     │                                                                                       
│__internal_compress_string_│                                                                                       
│        hugeint(#1)        │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│      RIGHT_DELIM_JOIN     │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│         RIGHT_SEMI        │                                                                                       
│ o_orderkey IS NOT DISTINCT├──────────────┐                                                                        
│       FROM o_orderkey     │              │                                                                        
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                                                        
│        EC: 1200243        │              │                                                                        
└─────────────┬─────────────┘              │                                                                                                     
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                          
│         SEQ_SCAN          ││         HASH_JOIN         │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│           orders          ││         RIGHT_SEMI        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││ o_orderkey IS NOT DISTINCT│                                                          
│         o_orderkey        ││       FROM o_orderkey     │                                                          
│      o_orderpriority      ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││        EC: 1200243        ├───────────────────────────────────────────┐              
│Filters: o_orderdate>='1993││                           │                                           │              
│     -07-01'::DATE AND     ││                           │                                           │              
│ o_orderdate<'1993-10-...  ││                           │                                           │              
│   o_orderdate IS NOT NULL ││                           │                                           │              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                           │              
│         EC: 300000        ││                           │                                           │              
└───────────────────────────┘└─────────────┬─────────────┘                                           │                                           
                             ┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐
                             │         PROJECTION        │                             │         DUMMY_SCAN        │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │                           │
                             │         o_orderkey        │                             │                           │
                             └─────────────┬─────────────┘                             └───────────────────────────┘                             
                             ┌─────────────┴─────────────┐                                                          
                             │         HASH_JOIN         │                                                          
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                             │           INNER           │                                                          
                             │  l_orderkey = o_orderkey  ├──────────────┐                                           
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                           
                             │        EC: 1200243        │              │                                           
                             └─────────────┬─────────────┘              │                                                                        
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             
                             │           FILTER          ││         DELIM_SCAN        │                             
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                             
                             │      (l_commitdate <      ││                           │                             
                             │       l_receiptdate)      ││                           │                             
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                             
                             │        EC: 6001215        ││                           │                             
                             └─────────────┬─────────────┘└───────────────────────────┘                                                          
                             ┌─────────────┴─────────────┐                                                          
                             │         SEQ_SCAN          │                                                          
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                             │          lineitem         │                                                          
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                             │         l_orderkey        │                                                          
                             │        l_commitdate       │                                                          
                             │       l_receiptdate       │                                                          
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                             │        EC: 6001215        │                                                          
                             └───────────────────────────┘                                                                                       

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

compressed filter_log_size: 784255
compressed filter_log_buffer_size: 750165
compressed limit_offset_size: 2272
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 2272
compressed perfect_full_scan_ht_log_buffer_size: 0
compressed perfect_probe_ht_log_size: 2272
compressed perfect_probe_ht_log_buffer_size: 0
compressed row_group_log_size: 167694
compressed row_group_log_buffer_size: 133120
compressed scatter_log_size: 386887
compressed scatter_log_buffer_size: 379945
compressed scatter_sel_log_size: 489161
compressed scatter_sel_log_buffer_size: 477256
compressed gather_log_size: 2272
compressed gather_log_buffer_size: 0
compressed combine_log_size: 11817
compressed combine_log_buffer_size: 7632
compressed finalize_states_log_size: 13162
compressed finalize_states_log_buffer_size: 9242
compressed join_gather_log_size: 2098885
compressed join_gather_log_buffer_size: 1981299
compressed reorder_log_size: 3648
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 2272
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 2272
compressed nlj_log_buffer_size: 0
compressed total_size: 3969141
compressed total_buffer_size: 3738659
compressed total_element_size: 230482

Clear Lineage

%%%%%%%%%%%%%%%% Running Query #  4  threads:  8
SELECT o_orderpriority, count(*) AS order_count FROM orders WHERE o_orderdate >= CAST('1993-07-01' AS date) AND o_orderdate < CAST('1993-10-01' AS date) AND EXISTS ( SELECT * FROM lineitem WHERE l_orderkey = o_orderkey AND l_commitdate < l_receiptdate) GROUP BY o_orderpriority ORDER BY o_orderpriority;
Run:  None SELECT o_orderpriority, count(*) AS order_count FROM orders WHERE o_orderdate >= CAST('1993-07-01' AS date) AND o_orderdate < CAST('1993-10-01' AS date) AND EXISTS ( SELECT * FROM lineitem WHERE l_orderkey = o_orderkey AND l_commitdate < l_receiptdate) GROUP BY o_orderpriority ORDER BY o_orderpriority;
Avg Time in sec:  0.061589368153363466  output size:  5
   o_orderpriority  order_count
0         1-URGENT        10594
1           2-HIGH        10476
2         3-MEDIUM        10410
3  4-NOT SPECIFIED        10556
4            5-LOW        10487
{'name': 'Query', 'result': 0.052601, 'timing': 0.052601, 'cardinality': 0, 'extra-info': "SELECT o_orderpriority, count(*) AS order_count FROM orders WHERE o_orderdate >= CAST('1993-07-01' AS date) AND o_orderdate < CAST('1993-10-01' AS date) AND EXISTS ( SELECT * FROM lineitem WHERE l_orderkey = o_orderkey AND l_commitdate < l_receiptdate) GROUP BY o_orderpriority ORDER BY o_orderpriority;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 1e-05, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 7e-06, 'cardinality': 5, 'extra_info': '__internal_decompress_string(#0)\n#1\n', 'children': [{'name': 'ORDER_BY', 'timing': 6.8e-05, 'cardinality': 5, 'extra_info': 'ORDERS:\norders.o_orderpriority ASC', 'children': [{'name': 'PROJECTION', 'timing': 3e-06, 'cardinality': 5, 'extra_info': '__internal_compress_string_hugeint(#0)\n#1\n', 'children': [{'name': 'PROJECTION', 'timing': 9e-06, 'cardinality': 5, 'extra_info': '__internal_decompress_string(#0)\n#1\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.002779, 'cardinality': 5, 'extra_info': '#0\ncount_star()', 'children': [{'name': 'PROJECTION', 'timing': 7e-06, 'cardinality': 52523, 'extra_info': 'o_orderpriority\n', 'children': [{'name': 'PROJECTION', 'timing': 0.000665, 'cardinality': 52523, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n__internal_compress_string_hugeint(#1)\n', 'children': [{'name': 'RIGHT_DELIM_JOIN', 'timing': 0.041901, 'cardinality': 0, 'extra_info': 'RIGHT_SEMI\no_orderkey IS NOT DISTINCT FROM o_orderkey\n\n[INFOSEPARATOR]\nEC: 1200243\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.080141, 'cardinality': 57218, 'extra_info': "orders\n[INFOSEPARATOR]\no_orderkey\no_orderpriority\n[INFOSEPARATOR]\nFilters: o_orderdate>='1993-07-01'::DATE AND o_orderdate<'1993-10-01'::DATE AND o_orderdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 300000", 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.014514, 'cardinality': 52523, 'extra_info': 'RIGHT_SEMI\no_orderkey IS NOT DISTINCT FROM o_orderkey\n\n[INFOSEPARATOR]\nEC: 1200243\n', 'children': [{'name': 'PROJECTION', 'timing': 7.4e-05, 'cardinality': 144869, 'extra_info': 'o_orderkey\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.103829, 'cardinality': 144869, 'extra_info': 'INNER\nl_orderkey = o_orderkey\n\n[INFOSEPARATOR]\nEC: 1200243\n', 'children': [{'name': 'FILTER', 'timing': 0.031153, 'cardinality': 3793296, 'extra_info': '(l_commitdate < l_receiptdate)\n[INFOSEPARATOR]\nEC: 6001215', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.010185, 'cardinality': 6001215, 'extra_info': 'lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_commitdate\nl_receiptdate\n[INFOSEPARATOR]\nEC: 6001215', 'children': []}]}, {'name': 'DELIM_SCAN', 'timing': 0.0, 'cardinality': 0, 'extra_info': '', 'children': []}]}]}, {'name': 'DUMMY_SCAN', 'timing': 0.0, 'cardinality': 0, 'extra_info': '', 'children': []}]}, {'name': 'HASH_GROUP_BY', 'timing': 0.005584, 'cardinality': 57218, 'extra_info': '#0', 'children': []}]}]}]}]}]}]}]}]}]}]}
X {'RESULT_COLLECTOR0': 1e-05, 'PROJECTION1': 7e-06, 'ORDER_BY2': 6.8e-05, 'PROJECTION3': 3e-06, 'PROJECTION4': 9e-06, 'HASH_GROUP_BY5': 0.002779, 'PROJECTION6': 7e-06, 'PROJECTION7': 0.000665, 'RIGHT_DELIM_JOIN8': 0.041901, 'SEQ_SCAN 9': 0.080141, 'HASH_JOIN10': 0.014514, 'PROJECTION11': 7.4e-05, 'HASH_JOIN12': 0.103829, 'FILTER13': 0.031153, 'SEQ_SCAN 14': 0.010185, 'DELIM_SCAN15': 0.0, 'DUMMY_SCAN16': 0.0, 'HASH_GROUP_BY17': 0.005584}
**** output size:  5
LINEAGE_5_FILTER_1
LINEAGE_5_HASH_GROUP_BY_12
LINEAGE_5_HASH_GROUP_BY_7
LINEAGE_5_HASH_JOIN_3
LINEAGE_5_HASH_JOIN_6
LINEAGE_5_ORDER_BY_15
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_8
SELECT o_orderpriority, count(*) AS order_count FROM orders WHERE o_orderdate >= CAST('1993-07-01' AS date) AND o_orderdate < CAST('1993-10-01' AS date) AND EXISTS ( SELECT * FROM lineitem WHERE l_orderkey = o_orderkey AND l_commitdate < l_receiptdate) GROUP BY o_orderpriority ORDER BY o_orderpriority;
   query_id  ...                                               plan
0         5  ...  {"name": "PROJECTION", "opid": "16", "children...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               SELECT o_orderpriority, count(*) AS order_coun...
size_bytes_max                                                3969141
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "PROJECTION", "opid": "16", "children...
Name: 0, dtype: object
{"name": "PROJECTION", "opid": "16", "children": [{"name": "ORDER_BY", "opid": "15", "children": [{"name": "PROJECTION", "opid": "14", "children": [{"name": "PROJECTION", "opid": "13", "children": [{"name": "HASH_GROUP_BY", "opid": "12", "children": [{"name": "PROJECTION", "opid": "11", "children": [{"name": "PROJECTION", "opid": "10", "children": [{"name": "RIGHT_DELIM_JOIN", "opid": "9", "children": [{"name": "HASH_GROUP_BY", "opid": "7", "children": [],"table": "","extra": "#0"},{"name": "HASH_JOIN", "opid": "6", "children": [{"name": "PROJECTION", "opid": "4", "children": [{"name": "HASH_JOIN", "opid": "3", "children": [{"name": "FILTER", "opid": "1", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_commitdate\nl_receiptdate\n[INFOSEPARATOR]\nEC: 6001215"}],"table": "","extra": "(l_commitdate < l_receiptdate)\n[INFOSEPARATOR]\nEC: 6001215"},{"name": "DELIM_SCAN", "opid": "2", "children": [],"table": "","extra": ""}],"table": "","extra": "INNER\nl_orderkey = o_orderkey\n\n[INFOSEPARATOR]\nEC: 1200243\n"}],"table": "","extra": "o_orderkey\n"},{"name": "DUMMY_SCAN", "opid": "5", "children": [],"table": "","extra": ""}],"table": "","extra": "RIGHT_SEMI\no_orderkey IS NOT DISTINCT FROM o_orderkey\n\n[INFOSEPARATOR]\nEC: 1200243\n"},{"name": "SEQ_SCAN ", "opid": "8", "children": [],"table": "orders","extra": "orders\n[INFOSEPARATOR]\no_orderkey\no_orderpriority\n[INFOSEPARATOR]\nFilters: o_orderdate>='1993-07-01'::DATE AND o_orderdate<'1993-10-01'::DATE AND o_orderdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 300000"}],"table": "","extra": "RIGHT_SEMI\no_orderkey IS NOT DISTINCT FROM o_orderkey\n\n[INFOSEPARATOR]\nEC: 1200243\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n__internal_compress_string_hugeint(#1)\n"}],"table": "","extra": "o_orderpriority\n"}],"table": "","extra": "#0\ncount_star()"}],"table": "","extra": "__internal_decompress_string(#0)\n#1\n"}],"table": "","extra": "__internal_compress_string_hugeint(#0)\n#1\n"}],"table": "","extra": "ORDERS:\norders.o_orderpriority ASC"}],"table": "","extra": "__internal_decompress_string(#0)\n#1\n"}
%%%%%%%%%%%%%%%% Running Query #  5  threads:  8
SELECT n_name, sum(l_extendedprice * (1 - l_discount)) AS revenue FROM customer, orders, lineitem, supplier, nation, region WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND l_suppkey = s_suppkey AND c_nationkey = s_nationkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'ASIA' AND o_orderdate >= CAST('1994-01-01' AS date) AND o_orderdate < CAST('1995-01-01' AS date) GROUP BY n_name ORDER BY revenue DESC;
Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│__internal_decompress_strin│                                                                                                                                                 
│           g(#0)           │                                                                                                                                                 
│             #1            │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│          ORDER_BY         │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│          ORDERS:          │                                                                                                                                                 
│       sum((lineitem       │                                                                                                                                                 
│.l_extendedprice * (1 ...  │                                                                                                                                                 
│    .l_discount))) DESC    │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│__internal_compress_string_│                                                                                                                                                 
│        hugeint(#0)        │                                                                                                                                                 
│             #1            │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│__internal_decompress_strin│                                                                                                                                                 
│           g(#0)           │                                                                                                                                                 
│             #1            │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│       HASH_GROUP_BY       │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│             #0            │                                                                                                                                                 
│          sum(#1)          │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│           n_name          │                                                                                                                                                 
│ (l_extendedprice * (1.00 -│                                                                                                                                                 
│        l_discount))       │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│__internal_compress_integra│                                                                                                                                                 
│     l_uinteger(#0, 1)     │                                                                                                                                                 
│__internal_compress_integra│                                                                                                                                                 
│     l_usmallint(#1, 1)    │                                                                                                                                                 
│             #2            │                                                                                                                                                 
│             #3            │                                                                                                                                                 
│__internal_compress_integra│                                                                                                                                                 
│     l_uinteger(#4, 1)     │                                                                                                                                                 
│__internal_compress_integra│                                                                                                                                                 
│     l_utinyint(#5, 0)     │                                                                                                                                                 
│__internal_compress_string_│                                                                                                                                                 
│        hugeint(#6)        │                                                                                                                                                 
│__internal_compress_integra│                                                                                                                                                 
│     l_usmallint(#7, 1)    │                                                                                                                                                 
│__internal_compress_integra│                                                                                                                                                 
│     l_utinyint(#8, 0)     │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         HASH_JOIN         │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│           INNER           │                                                                                                                                                 
│ n_nationkey = s_nationkey ├──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐              
│   l_suppkey = s_suppkey   │                                                                                                                                  │              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                  │              
│         EC: 143512        │                                                                                                                                  │              
└─────────────┬─────────────┘                                                                                                                                  │                                           
┌─────────────┴─────────────┐                                                                                                                    ┌─────────────┴─────────────┐
│         HASH_JOIN         │                                                                                                                    │         SEQ_SCAN          │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│           INNER           │                                                                                                                    │          supplier         │
│  l_orderkey = o_orderkey  │                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐                                                                                                     │         s_suppkey         │
│         EC: 144747        │              │                                                                                                     │        s_nationkey        │
│                           │              │                                                                                                     │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│                           │              │                                                                                                     │         EC: 10000         │
└─────────────┬─────────────┘              │                                                                                                     └───────────────────────────┘                             
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                                                    
│         SEQ_SCAN          ││         HASH_JOIN         │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│          lineitem         ││           INNER           │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   o_custkey = c_custkey   │                                                                                                                    
│         l_orderkey        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│         l_suppkey         ││        Build Min: 1       ├──────────────┐                                                                                                     
│      l_extendedprice      ││     Build Max: 149999     │              │                                                                                                     
│         l_discount        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                                                                                     
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││         EC: 36179         │              │                                                                                                     
│        EC: 6001215        ││                           │              │                                                                                                     
└───────────────────────────┘└─────────────┬─────────────┘              │                                                                                                                                  
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                       
                             │         SEQ_SCAN          ││         PROJECTION        │                                                                                       
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
                             │           orders          ││             #0            │                                                                                       
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││             #1            │                                                                                       
                             │         o_custkey         ││             #3            │                                                                                       
                             │         o_orderkey        ││                           │                                                                                       
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                                                                       
                             │Filters: o_orderdate>='1994││                           │                                                                                       
                             │     -01-01'::DATE AND     ││                           │                                                                                       
                             │ o_orderdate<'1995-01-...  ││                           │                                                                                       
                             │   o_orderdate IS NOT NULL ││                           │                                                                                       
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                                                                       
                             │         EC: 300000        ││                           │                                                                                       
                             └───────────────────────────┘└─────────────┬─────────────┘                                                                                                                    
                                                          ┌─────────────┴─────────────┐                                                                                       
                                                          │           FILTER          │                                                                                       
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
                                                          │   (c_custkey <= 149999)   │                                                                                       
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
                                                          │         EC: 30000         │                                                                                       
                                                          └─────────────┬─────────────┘                                                                                                                    
                                                          ┌─────────────┴─────────────┐                                                                                       
                                                          │         HASH_JOIN         │                                                                                       
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
                                                          │           INNER           │                                                                                       
                                                          │ c_nationkey = n_nationkey │                                                                                       
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐                                                                        
                                                          │        Build Min: 0       │              │                                                                        
                                                          │       Build Max: 24       │              │                                                                        
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                                                        
                                                          │         EC: 30000         │              │                                                                        
                                                          └─────────────┬─────────────┘              │                                                                                                     
                                                          ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                          
                                                          │         SEQ_SCAN          ││         HASH_JOIN         │                                                          
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                          │          customer         ││           INNER           │                                                          
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││ n_regionkey = r_regionkey │                                                          
                                                          │         c_custkey         ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐                                           
                                                          │        c_nationkey        ││           EC: 25          │              │                                           
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │              │                                           
                                                          │         EC: 150000        ││                           │              │                                           
                                                          └───────────────────────────┘└─────────────┬─────────────┘              │                                                                        
                                                                                       ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             
                                                                                       │         SEQ_SCAN          ││         SEQ_SCAN          │                             
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                                                                                       │           nation          ││           region          │                             
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                                                                                       │        n_nationkey        ││        r_regionkey        │                             
                                                                                       │        n_regionkey        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                                                                                       │           n_name          ││ Filters: r_name='ASIA' AND│                             
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││     r_name IS NOT NULL    │                             
                                                                                       │           EC: 25          ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                                                                                       │                           ││           EC: 1           │                             
                                                                                       └───────────────────────────┘└───────────────────────────┘                                                          

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

compressed filter_log_size: 2988
compressed filter_log_buffer_size: 0
compressed limit_offset_size: 2176
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 107409
compressed perfect_full_scan_ht_log_buffer_size: 104465
compressed perfect_probe_ht_log_size: 233103
compressed perfect_probe_ht_log_buffer_size: 217545
compressed row_group_log_size: 224618
compressed row_group_log_buffer_size: 188793
compressed scatter_log_size: 29891
compressed scatter_log_buffer_size: 26458
compressed scatter_sel_log_size: 407688
compressed scatter_sel_log_buffer_size: 398159
compressed gather_log_size: 2176
compressed gather_log_buffer_size: 0
compressed combine_log_size: 3542
compressed combine_log_buffer_size: 640
compressed finalize_states_log_size: 2792
compressed finalize_states_log_buffer_size: 40
compressed join_gather_log_size: 1202803
compressed join_gather_log_buffer_size: 1091568
compressed reorder_log_size: 3584
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 2176
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 2176
compressed nlj_log_buffer_size: 0
compressed total_size: 2227122
compressed total_buffer_size: 2027668
compressed total_element_size: 199454

Run:  None SELECT n_name, sum(l_extendedprice * (1 - l_discount)) AS revenue FROM customer, orders, lineitem, supplier, nation, region WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND l_suppkey = s_suppkey AND c_nationkey = s_nationkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'ASIA' AND o_orderdate >= CAST('1994-01-01' AS date) AND o_orderdate < CAST('1995-01-01' AS date) GROUP BY n_name ORDER BY revenue DESC;
Avg Time in sec:  0.05924296332523227  output size:  5
      n_name       revenue
0  INDONESIA  5.550204e+07
1    VIETNAM  5.529509e+07
2      CHINA  5.372449e+07
3      INDIA  5.203551e+07
4      JAPAN  4.541018e+07
{'name': 'Query', 'result': 0.052951, 'timing': 0.052951, 'cardinality': 0, 'extra-info': "SELECT n_name, sum(l_extendedprice * (1 - l_discount)) AS revenue FROM customer, orders, lineitem, supplier, nation, region WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND l_suppkey = s_suppkey AND c_nationkey = s_nationkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'ASIA' AND o_orderdate >= CAST('1994-01-01' AS date) AND o_orderdate < CAST('1995-01-01' AS date) GROUP BY n_name ORDER BY revenue DESC;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 1.4e-05, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 7e-06, 'cardinality': 5, 'extra_info': '__internal_decompress_string(#0)\n#1\n', 'children': [{'name': 'ORDER_BY', 'timing': 9.2e-05, 'cardinality': 5, 'extra_info': 'ORDERS:\nsum((lineitem.l_extendedprice * (1 - lineitem.l_discount))) DESC', 'children': [{'name': 'PROJECTION', 'timing': 3e-06, 'cardinality': 5, 'extra_info': '__internal_compress_string_hugeint(#0)\n#1\n', 'children': [{'name': 'PROJECTION', 'timing': 7e-06, 'cardinality': 5, 'extra_info': '__internal_decompress_string(#0)\n#1\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.004987, 'cardinality': 5, 'extra_info': '#0\nsum(#1)', 'children': [{'name': 'PROJECTION', 'timing': 0.000348, 'cardinality': 7243, 'extra_info': 'n_name\n(l_extendedprice * (1.00 - l_discount))\n', 'children': [{'name': 'PROJECTION', 'timing': 0.00091, 'cardinality': 7243, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n__internal_compress_integral_usmallint(#1, 1)\n#2\n#3\n__internal_compress_integral_uinteger(#4, 1)\n__internal_compress_integral_utinyint(#5, 0)\n__internal_compress_string_hugeint(#6)\n__internal_compress_integral_usmallint(#7, 1)\n__internal_compress_integral_utinyint(#8, 0)\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.024781, 'cardinality': 7243, 'extra_info': 'INNER\nn_nationkey = s_nationkey\nl_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nEC: 143512\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.169396, 'cardinality': 184082, 'extra_info': 'INNER\nl_orderkey = o_orderkey\n\n[INFOSEPARATOR]\nEC: 144747\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.015351, 'cardinality': 6001215, 'extra_info': 'lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_suppkey\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nEC: 6001215', 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.023474, 'cardinality': 46008, 'extra_info': 'INNER\no_custkey = c_custkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 149999\n\n[INFOSEPARATOR]\nEC: 36179\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.036995, 'cardinality': 227597, 'extra_info': "orders\n[INFOSEPARATOR]\no_custkey\no_orderkey\n[INFOSEPARATOR]\nFilters: o_orderdate>='1994-01-01'::DATE AND o_orderdate<'1995-01-01'::DATE AND o_orderdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 300000", 'children': []}, {'name': 'PROJECTION', 'timing': 3.3e-05, 'cardinality': 30183, 'extra_info': '#0\n#1\n#3\n', 'children': [{'name': 'FILTER', 'timing': 0.000376, 'cardinality': 30183, 'extra_info': '(c_custkey <= 149999)\n[INFOSEPARATOR]\nEC: 30000', 'children': [{'name': 'HASH_JOIN', 'timing': 0.001915, 'cardinality': 30183, 'extra_info': 'INNER\nc_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 30000\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.000318, 'cardinality': 150000, 'extra_info': 'customer\n[INFOSEPARATOR]\nc_custkey\nc_nationkey\n[INFOSEPARATOR]\nEC: 150000', 'children': []}, {'name': 'HASH_JOIN', 'timing': 5.5e-05, 'cardinality': 5, 'extra_info': 'INNER\nn_regionkey = r_regionkey\n\n[INFOSEPARATOR]\nEC: 25\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 1e-05, 'cardinality': 25, 'extra_info': 'nation\n[INFOSEPARATOR]\nn_nationkey\nn_regionkey\nn_name\n[INFOSEPARATOR]\nEC: 25', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 2.3e-05, 'cardinality': 1, 'extra_info': "region\n[INFOSEPARATOR]\nr_regionkey\n[INFOSEPARATOR]\nFilters: r_name='ASIA' AND r_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1", 'children': []}]}]}]}]}]}]}, {'name': 'SEQ_SCAN ', 'timing': 7e-05, 'cardinality': 10000, 'extra_info': 'supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\n[INFOSEPARATOR]\nEC: 10000', 'children': []}]}]}]}]}]}]}]}]}]}]}
X {'RESULT_COLLECTOR0': 1.4e-05, 'PROJECTION1': 7e-06, 'ORDER_BY2': 9.2e-05, 'PROJECTION3': 3e-06, 'PROJECTION4': 7e-06, 'HASH_GROUP_BY5': 0.004987, 'PROJECTION6': 0.000348, 'PROJECTION7': 0.00091, 'HASH_JOIN8': 0.024781, 'HASH_JOIN9': 0.169396, 'SEQ_SCAN 10': 0.015351, 'HASH_JOIN11': 0.023474, 'SEQ_SCAN 12': 0.036995, 'PROJECTION13': 3.3e-05, 'FILTER14': 0.000376, 'HASH_JOIN15': 0.001915, 'SEQ_SCAN 16': 0.000318, 'HASH_JOIN17': 5.5e-05, 'SEQ_SCAN 18': 1e-05, 'SEQ_SCAN 19': 2.3e-05, 'SEQ_SCAN 20': 7e-05}
**** output size:  5
LINEAGE_5_FILTER_7
LINEAGE_5_HASH_GROUP_BY_15
LINEAGE_5_HASH_JOIN_10
LINEAGE_5_HASH_JOIN_12
LINEAGE_5_HASH_JOIN_5
LINEAGE_5_HASH_JOIN_6
LINEAGE_5_HASH_JOIN_9
LINEAGE_5_ORDER_BY_18
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_1
LINEAGE_5_SEQ_SCAN_11
LINEAGE_5_SEQ_SCAN_2
LINEAGE_5_SEQ_SCAN_3
LINEAGE_5_SEQ_SCAN_4
SELECT n_name, sum(l_extendedprice * (1 - l_discount)) AS revenue FROM customer, orders, lineitem, supplier, nation, region WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND l_suppkey = s_suppkey AND c_nationkey = s_nationkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'ASIA' AND o_orderdate >= CAST('1994-01-01' AS date) AND o_orderdate < CAST('1995-01-01' AS date) GROUP BY n_name ORDER BY revenue DESC;
   query_id  ...                                               plan
0         5  ...  {"name": "PROJECTION", "opid": "19", "children...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               SELECT n_name, sum(l_extendedprice * (1 - l_di...
size_bytes_max                                                2227122
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "PROJECTION", "opid": "19", "children...
Name: 0, dtype: object
{"name": "PROJECTION", "opid": "19", "children": [{"name": "ORDER_BY", "opid": "18", "children": [{"name": "PROJECTION", "opid": "17", "children": [{"name": "PROJECTION", "opid": "16", "children": [{"name": "HASH_GROUP_BY", "opid": "15", "children": [{"name": "PROJECTION", "opid": "14", "children": [{"name": "PROJECTION", "opid": "13", "children": [{"name": "HASH_JOIN", "opid": "12", "children": [{"name": "HASH_JOIN", "opid": "10", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_suppkey\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nEC: 6001215"},{"name": "HASH_JOIN", "opid": "9", "children": [{"name": "SEQ_SCAN ", "opid": "1", "children": [],"table": "orders","extra": "orders\n[INFOSEPARATOR]\no_custkey\no_orderkey\n[INFOSEPARATOR]\nFilters: o_orderdate>='1994-01-01'::DATE AND o_orderdate<'1995-01-01'::DATE AND o_orderdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 300000"},{"name": "PROJECTION", "opid": "8", "children": [{"name": "FILTER", "opid": "7", "children": [{"name": "HASH_JOIN", "opid": "6", "children": [{"name": "SEQ_SCAN ", "opid": "2", "children": [],"table": "customer","extra": "customer\n[INFOSEPARATOR]\nc_custkey\nc_nationkey\n[INFOSEPARATOR]\nEC: 150000"},{"name": "HASH_JOIN", "opid": "5", "children": [{"name": "SEQ_SCAN ", "opid": "3", "children": [],"table": "nation","extra": "nation\n[INFOSEPARATOR]\nn_nationkey\nn_regionkey\nn_name\n[INFOSEPARATOR]\nEC: 25"},{"name": "SEQ_SCAN ", "opid": "4", "children": [],"table": "region","extra": "region\n[INFOSEPARATOR]\nr_regionkey\n[INFOSEPARATOR]\nFilters: r_name='ASIA' AND r_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1"}],"table": "","extra": "INNER\nn_regionkey = r_regionkey\n\n[INFOSEPARATOR]\nEC: 25\n"}],"table": "","extra": "INNER\nc_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 30000\n"}],"table": "","extra": "(c_custkey <= 149999)\n[INFOSEPARATOR]\nEC: 30000"}],"table": "","extra": "#0\n#1\n#3\n"}],"table": "","extra": "INNER\no_custkey = c_custkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 149999\n\n[INFOSEPARATOR]\nEC: 36179\n"}],"table": "","extra": "INNER\nl_orderkey = o_orderkey\n\n[INFOSEPARATOR]\nEC: 144747\n"},{"name": "SEQ_SCAN ", "opid": "11", "children": [],"table": "supplier","extra": "supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\n[INFOSEPARATOR]\nEC: 10000"}],"table": "","extra": "INNER\nn_nationkey = s_nationkey\nl_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nEC: 143512\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n__internal_compress_integral_usmallint(#1, 1)\n#2\n#3\n__internal_compress_integral_uinteger(#4, 1)\n__internal_compress_integral_utinyint(#5, 0)\n__internal_compress_string_hugeint(#6)\n__internal_compress_integral_usmallint(#7, 1)\n__internal_compress_integral_utinyint(#8, 0)\n"}],"table": "","extra": "n_name\n(l_extendedprice * (1.00 - l_discount))\n"}],"table": "","extra": "#0\nsum(#1)"}],"table": "","extra": "__internal_decompress_string(#0)\n#1\n"}],"table": "","extra": "__internal_compress_string_hugeint(#0)\n#1\n"}],"table": "","extra": "ORDERS:\nsum((lineitem.l_extendedprice * (1 - lineitem.l_discount))) DESC"}],"table": "","extra": "__internal_decompress_string(#0)\n#1\n"}
Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐
│    UNGROUPED_AGGREGATE    │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│    sum_no_overflow(#0)    │
└─────────────┬─────────────┘                             
┌─────────────┴─────────────┐
│         PROJECTION        │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│     (l_extendedprice *    │
│         l_discount)       │
└─────────────┬─────────────┘                             
┌─────────────┴─────────────┐
│         SEQ_SCAN          │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│          lineitem         │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│         l_discount        │
│      l_extendedprice      │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│ Filters: l_shipdate>='1994│
│-01-01'::DATE AND l_sh...  │
│  <'1995-01-01'::DATE AND  │
│   l_shipdate IS NOT NULL  │
│    l_discount>=0.05 AND   │
│ l_discount<=0.07 AND ...  │
│         IS NOT NULL       │
│    l_quantity<24.00 AND   │
│   l_quantity IS NOT NULL  │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│        EC: 1200243        │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

compressed filter_log_size: 624
compressed filter_log_buffer_size: 0
compressed limit_offset_size: 624
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 624
compressed perfect_full_scan_ht_log_buffer_size: 0
compressed perfect_probe_ht_log_size: 624
compressed perfect_probe_ht_log_buffer_size: 0
compressed row_group_log_size: 400847
compressed row_group_log_buffer_size: 357694
compressed scatter_log_size: 624
compressed scatter_log_buffer_size: 0
compressed scatter_sel_log_size: 624
compressed scatter_sel_log_buffer_size: 0
compressed gather_log_size: 624
compressed gather_log_buffer_size: 0
compressed combine_log_size: 624
compressed combine_log_buffer_size: 0
compressed finalize_states_log_size: 624
compressed finalize_states_log_buffer_size: 0
compressed join_gather_log_size: 624
compressed join_gather_log_buffer_size: 0
compressed reorder_log_size: 936
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 624
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 624
compressed nlj_log_buffer_size: 0
compressed total_size: 409271
compressed total_buffer_size: 357694
compressed total_element_size: 51577

Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│__internal_decompress_strin│                                                                                                                                                 
│           g(#0)           │                                                                                                                                                 
│__internal_decompress_strin│                                                                                                                                                 
│           g(#1)           │                                                                                                                                                 
│__internal_decompress_integ│                                                                                                                                                 
│    ral_bigint(#2, 1992)   │                                                                                                                                                 
│             #3            │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│          ORDER_BY         │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│          ORDERS:          │                                                                                                                                                 
│  shipping.supp_nation ASC │                                                                                                                                                 
│  shipping.cust_nation ASC │                                                                                                                                                 
│    shipping.l_year ASC    │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│__internal_compress_string_│                                                                                                                                                 
│        hugeint(#0)        │                                                                                                                                                 
│__internal_compress_string_│                                                                                                                                                 
│        hugeint(#1)        │                                                                                                                                                 
│__internal_compress_integra│                                                                                                                                                 
│    l_utinyint(#2, 1992)   │                                                                                                                                                 
│             #3            │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│__internal_decompress_strin│                                                                                                                                                 
│           g(#0)           │                                                                                                                                                 
│__internal_decompress_strin│                                                                                                                                                 
│           g(#1)           │                                                                                                                                                 
│__internal_decompress_integ│                                                                                                                                                 
│    ral_bigint(#2, 1992)   │                                                                                                                                                 
│             #3            │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│       HASH_GROUP_BY       │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│             #0            │                                                                                                                                                 
│             #1            │                                                                                                                                                 
│             #2            │                                                                                                                                                 
│          sum(#3)          │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│        supp_nation        │                                                                                                                                                 
│        cust_nation        │                                                                                                                                                 
│           l_year          │                                                                                                                                                 
│           volume          │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│__internal_compress_string_│                                                                                                                                                 
│        hugeint(#0)        │                                                                                                                                                 
│__internal_compress_string_│                                                                                                                                                 
│        hugeint(#1)        │                                                                                                                                                 
│__internal_compress_integra│                                                                                                                                                 
│    l_utinyint(#2, 1992)   │                                                                                                                                                 
│             #3            │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│        supp_nation        │                                                                                                                                                 
│        cust_nation        │                                                                                                                                                 
│      year(l_shipdate)     │                                                                                                                                                 
│           volume          │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│             #2            │                                                                                                                                                 
│             #3            │                                                                                                                                                 
│             #4            │                                                                                                                                                 
│             #6            │                                                                                                                                                 
│             #8            │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│           FILTER          │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│ (((n_name = 'FRANCE') AND │                                                                                                                                                 
│ (n_name = 'GERMANY')) OR (│                                                                                                                                                 
│ (n_name = 'GERMANY') AND  │                                                                                                                                                 
│   (n_name = 'FRANCE')))   │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│         EC: 717564        │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         HASH_JOIN         │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│           INNER           │                                                                                                                                                 
│   l_suppkey = s_suppkey   │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├─────────────────────────────────────────────────────────────────────────────────────────────────────┐                                           
│        Build Min: 1       │                                                                                                     │                                           
│      Build Max: 10000     │                                                                                                     │                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                     │                                           
│         EC: 717564        │                                                                                                     │                                           
└─────────────┬─────────────┘                                                                                                     │                                                                        
┌─────────────┴─────────────┐                                                                                       ┌─────────────┴─────────────┐                             
│         HASH_JOIN         │                                                                                       │         HASH_JOIN         │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│           INNER           │                                                                                       │           INNER           │                             
│  l_orderkey = o_orderkey  │                                                                                       │ s_nationkey = n_nationkey │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐                                                                        │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐              
│         EC: 723735        │              │                                                                        │        Build Min: 0       │              │              
│                           │              │                                                                        │       Build Max: 24       │              │              
│                           │              │                                                                        │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              
│                           │              │                                                                        │         EC: 10000         │              │              
└─────────────┬─────────────┘              │                                                                        └─────────────┬─────────────┘              │                                           
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
│         SEQ_SCAN          ││         HASH_JOIN         │                                                          │         SEQ_SCAN          ││         SEQ_SCAN          │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│          lineitem         ││           INNER           │                                                          │          supplier         ││           nation          │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   o_custkey = c_custkey   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│         l_suppkey         ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │         s_suppkey         ││        n_nationkey        │
│         l_orderkey        ││        Build Min: 1       │                                                          │        s_nationkey        ││           n_name          │
│         l_shipdate        ││     Build Max: 149999     │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│      l_extendedprice      ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │         EC: 10000         ││           EC: 25          │
│         l_discount        ││         EC: 904486        ├──────────────┐                                           │                           ││                           │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │              │                                           │                           ││                           │
│ Filters: l_shipdate>='1995││                           │              │                                           │                           ││                           │
│-01-01'::DATE AND l_sh...  ││                           │              │                                           │                           ││                           │
│  <='1996-12-31'::DATE AND ││                           │              │                                           │                           ││                           │
│   l_shipdate IS NOT NULL  ││                           │              │                                           │                           ││                           │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │              │                                           │                           ││                           │
│        EC: 1200243        ││                           │              │                                           │                           ││                           │
└───────────────────────────┘└─────────────┬─────────────┘              │                                           └───────────────────────────┘└───────────────────────────┘                             
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                       
                             │         SEQ_SCAN          ││         HASH_JOIN         │                                                                                       
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
                             │           orders          ││           INNER           │                                                                                       
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││ c_nationkey = n_nationkey │                                                                                       
                             │         o_orderkey        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐                                                                        
                             │         o_custkey         ││         EC: 150000        │              │                                                                        
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │              │                                                                        
                             │        EC: 1500000        ││                           │              │                                                                        
                             └───────────────────────────┘└─────────────┬─────────────┘              │                                                                                                     
                                                          ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                          
                                                          │         SEQ_SCAN          ││         SEQ_SCAN          │                                                          
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                          │          customer         ││           nation          │                                                          
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                          │         c_custkey         ││        n_nationkey        │                                                          
                                                          │        c_nationkey        ││           n_name          │                                                          
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                          │ Filters: c_custkey<=149999││           EC: 25          │                                                          
                                                          │  AND c_custkey IS NOT NULL││                           │                                                          
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                                          
                                                          │         EC: 150000        ││                           │                                                          
                                                          └───────────────────────────┘└───────────────────────────┘                                                                                       

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

%%%%%%%%%%%%%%%% Running Query #  6  threads:  8
SELECT sum(l_extendedprice * l_discount) AS revenue FROM lineitem WHERE l_shipdate >= CAST('1994-01-01' AS date) AND l_shipdate < CAST('1995-01-01' AS date) AND l_discount BETWEEN 0.05 AND 0.07 AND l_quantity < 24;
Run:  None SELECT sum(l_extendedprice * l_discount) AS revenue FROM lineitem WHERE l_shipdate >= CAST('1994-01-01' AS date) AND l_shipdate < CAST('1995-01-01' AS date) AND l_discount BETWEEN 0.05 AND 0.07 AND l_quantity < 24;
Avg Time in sec:  0.01897826325148344  output size:  1
        revenue
0  1.231411e+08
{'name': 'Query', 'result': 0.017835, 'timing': 0.017835, 'cardinality': 0, 'extra-info': "SELECT sum(l_extendedprice * l_discount) AS revenue FROM lineitem WHERE l_shipdate >= CAST('1994-01-01' AS date) AND l_shipdate < CAST('1995-01-01' AS date) AND l_discount BETWEEN 0.05 AND 0.07 AND l_quantity < 24;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 4e-06, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'UNGROUPED_AGGREGATE', 'timing': 0.001645, 'cardinality': 1, 'extra_info': 'sum_no_overflow(#0)', 'children': [{'name': 'PROJECTION', 'timing': 0.007049, 'cardinality': 114160, 'extra_info': '(l_extendedprice * l_discount)\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.120732, 'cardinality': 114160, 'extra_info': "lineitem\n[INFOSEPARATOR]\nl_discount\nl_extendedprice\n[INFOSEPARATOR]\nFilters: l_shipdate>='1994-01-01'::DATE AND l_shipdate<'1995-01-01'::DATE AND l_shipdate IS NOT NULL\nl_discount>=0.05 AND l_discount<=0.07 AND l_discount IS NOT NULL\nl_quantity<24.00 AND l_quantity IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243", 'children': []}]}]}]}]}
X {'RESULT_COLLECTOR0': 4e-06, 'UNGROUPED_AGGREGATE1': 0.001645, 'PROJECTION2': 0.007049, 'SEQ_SCAN 3': 0.120732}
**** output size:  1
LINEAGE_5_SEQ_SCAN_0
SELECT sum(l_extendedprice * l_discount) AS revenue FROM lineitem WHERE l_shipdate >= CAST('1994-01-01' AS date) AND l_shipdate < CAST('1995-01-01' AS date) AND l_discount BETWEEN 0.05 AND 0.07 AND l_quantity < 24;
   query_id  ...                                               plan
0         5  ...  {"name": "UNGROUPED_AGGREGATE", "opid": "2", "...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               SELECT sum(l_extendedprice * l_discount) AS re...
size_bytes_max                                                 409271
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "UNGROUPED_AGGREGATE", "opid": "2", "...
Name: 0, dtype: object
{"name": "UNGROUPED_AGGREGATE", "opid": "2", "children": [{"name": "PROJECTION", "opid": "1", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_discount\nl_extendedprice\n[INFOSEPARATOR]\nFilters: l_shipdate>='1994-01-01'::DATE AND l_shipdate<'1995-01-01'::DATE AND l_shipdate IS NOT NULL\nl_discount>=0.05 AND l_discount<=0.07 AND l_discount IS NOT NULL\nl_quantity<24.00 AND l_quantity IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243"}],"table": "","extra": "(l_extendedprice * l_discount)\n"}],"table": "","extra": "sum_no_overflow(#0)"}
%%%%%%%%%%%%%%%% Running Query #  7  threads:  8
SELECT supp_nation, cust_nation, l_year, sum(volume) AS revenue FROM ( SELECT n1.n_name AS supp_nation, n2.n_name AS cust_nation, extract(year FROM l_shipdate) AS l_year, l_extendedprice * (1 - l_discount) AS volume FROM supplier, lineitem, orders, customer, nation n1, nation n2 WHERE s_suppkey = l_suppkey AND o_orderkey = l_orderkey AND c_custkey = o_custkey AND s_nationkey = n1.n_nationkey AND c_nationkey = n2.n_nationkey AND ((n1.n_name = 'FRANCE' AND n2.n_name = 'GERMANY') OR (n1.n_name = 'GERMANY' AND n2.n_name = 'FRANCE')) AND l_shipdate BETWEEN CAST('1995-01-01' AS date) AND CAST('1996-12-31' AS date)) AS shipping GROUP BY supp_nation, cust_nation, l_year ORDER BY supp_nation, cust_nation, l_year;
Run:  None SELECT supp_nation, cust_nation, l_year, sum(volume) AS revenue FROM ( SELECT n1.n_name AS supp_nation, n2.n_name AS cust_nation, extract(year FROM l_shipdate) AS l_year, l_extendedprice * (1 - l_discount) AS volume FROM supplier, lineitem, orders, customer, nation n1, nation n2 WHERE s_suppkey = l_suppkey AND o_orderkey = l_orderkey AND c_custkey = o_custkey AND s_nationkey = n1.n_nationkey AND c_nationkey = n2.n_nationkey AND ((n1.n_name = 'FRANCE' AND n2.n_name = 'GERMANY') OR (n1.n_name = 'GERMANY' AND n2.n_name = 'FRANCE')) AND l_shipdate BETWEEN CAST('1995-01-01' AS date) AND CAST('1996-12-31' AS date)) AS shipping GROUP BY supp_nation, cust_nation, l_year ORDER BY supp_nation, cust_nation, l_year;
Avg Time in sec:  0.18039273284375668  output size:  4
  supp_nation cust_nation  l_year       revenue
0      FRANCE     GERMANY    1995  5.463973e+07
1      FRANCE     GERMANY    1996  5.463308e+07
2     GERMANY      FRANCE    1995  5.253175e+07
3     GERMANY      FRANCE    1996  5.252055e+07
{'name': 'Query', 'result': 0.152605, 'timing': 0.152605, 'cardinality': 0, 'extra-info': "SELECT supp_nation, cust_nation, l_year, sum(volume) AS revenue FROM ( SELECT n1.n_name AS supp_nation, n2.n_name AS cust_nation, extract(year FROM l_shipdate) AS l_year, l_extendedprice * (1 - l_discount) AS volume FROM supplier, lineitem, orders, customer, nation n1, nation n2 WHERE s_suppkey = l_suppkey AND o_orderkey = l_orderkey AND c_custkey = o_custkey AND s_nationkey = n1.n_nationkey AND c_nationkey = n2.n_nationkey AND ((n1.n_name = 'FRANCE' AND n2.n_name = 'GERMANY') OR (n1.n_name = 'GERMANY' AND n2.n_name = 'FRANCE')) AND l_shipdate BETWEEN CAST('1995-01-01' AS date) AND CAST('1996-12-31' AS date)) AS shipping GROUP BY supp_nation, cust_nation, l_year ORDER BY supp_nation, cust_nation, l_year;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 1.5e-05, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 1.1e-05, 'cardinality': 4, 'extra_info': '__internal_decompress_string(#0)\n__internal_decompress_string(#1)\n__internal_decompress_integral_bigint(#2, 1992)\n#3\n', 'children': [{'name': 'ORDER_BY', 'timing': 0.000107, 'cardinality': 4, 'extra_info': 'ORDERS:\nshipping.supp_nation ASC\nshipping.cust_nation ASC\nshipping.l_year ASC', 'children': [{'name': 'PROJECTION', 'timing': 1.3e-05, 'cardinality': 4, 'extra_info': '__internal_compress_string_hugeint(#0)\n__internal_compress_string_hugeint(#1)\n__internal_compress_integral_utinyint(#2, 1992)\n#3\n', 'children': [{'name': 'PROJECTION', 'timing': 2.3e-05, 'cardinality': 4, 'extra_info': '__internal_decompress_string(#0)\n__internal_decompress_string(#1)\n__internal_decompress_integral_bigint(#2, 1992)\n#3\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.008511, 'cardinality': 4, 'extra_info': '#0\n#1\n#2\nsum(#3)', 'children': [{'name': 'PROJECTION', 'timing': 9e-06, 'cardinality': 5924, 'extra_info': 'supp_nation\ncust_nation\nl_year\nvolume\n', 'children': [{'name': 'PROJECTION', 'timing': 0.000229, 'cardinality': 5924, 'extra_info': '__internal_compress_string_hugeint(#0)\n__internal_compress_string_hugeint(#1)\n__internal_compress_integral_utinyint(#2, 1992)\n#3\n', 'children': [{'name': 'PROJECTION', 'timing': 0.000191, 'cardinality': 5924, 'extra_info': 'supp_nation\ncust_nation\nyear(l_shipdate)\nvolume\n', 'children': [{'name': 'PROJECTION', 'timing': 1.5e-05, 'cardinality': 5924, 'extra_info': '#2\n#3\n#4\n#6\n#8\n', 'children': [{'name': 'FILTER', 'timing': 0.073843, 'cardinality': 5924, 'extra_info': "(((n_name = 'FRANCE') AND (n_name = 'GERMANY')) OR ((n_name = 'GERMANY') AND (n_name = 'FRANCE')))\n[INFOSEPARATOR]\nEC: 717564", 'children': [{'name': 'HASH_JOIN', 'timing': 0.060547, 'cardinality': 1828450, 'extra_info': 'INNER\nl_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 717564\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.380709, 'cardinality': 1828450, 'extra_info': 'INNER\nl_orderkey = o_orderkey\n\n[INFOSEPARATOR]\nEC: 723735\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.053874, 'cardinality': 1828450, 'extra_info': "lineitem\n[INFOSEPARATOR]\nl_suppkey\nl_orderkey\nl_shipdate\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nFilters: l_shipdate>='1995-01-01'::DATE AND l_shipdate<='1996-12-31'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243", 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.049917, 'cardinality': 1500000, 'extra_info': 'INNER\no_custkey = c_custkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 149999\n\n[INFOSEPARATOR]\nEC: 904486\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.003987, 'cardinality': 1500000, 'extra_info': 'orders\n[INFOSEPARATOR]\no_orderkey\no_custkey\n[INFOSEPARATOR]\nEC: 1500000', 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.006595, 'cardinality': 149999, 'extra_info': 'INNER\nc_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nEC: 150000\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.001049, 'cardinality': 149999, 'extra_info': 'customer\n[INFOSEPARATOR]\nc_custkey\nc_nationkey\n[INFOSEPARATOR]\nFilters: c_custkey<=149999 AND c_custkey IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 150000', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 3.4e-05, 'cardinality': 25, 'extra_info': 'nation\n[INFOSEPARATOR]\nn_nationkey\nn_name\n[INFOSEPARATOR]\nEC: 25', 'children': []}]}]}]}, {'name': 'HASH_JOIN', 'timing': 0.000472, 'cardinality': 10000, 'extra_info': 'INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 10000\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 5.6e-05, 'cardinality': 10000, 'extra_info': 'supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\n[INFOSEPARATOR]\nEC: 10000', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 4.5e-05, 'cardinality': 25, 'extra_info': 'nation\n[INFOSEPARATOR]\nn_nationkey\nn_name\n[INFOSEPARATOR]\nEC: 25', 'children': []}]}]}]}]}]}]}]}]}]}]}]}]}]}]}
compressed filter_log_size: 55838
compressed filter_log_buffer_size: 23696
compressed limit_offset_size: 2528
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 540897
compressed perfect_full_scan_ht_log_buffer_size: 537217
compressed perfect_probe_ht_log_size: 7464270
compressed perfect_probe_ht_log_buffer_size: 7373775
compressed row_group_log_size: 804019
compressed row_group_log_buffer_size: 750855
compressed scatter_log_size: 22050
compressed scatter_log_buffer_size: 18370
compressed scatter_sel_log_size: 7752246
compressed scatter_sel_log_buffer_size: 7738309
compressed gather_log_size: 2528
compressed gather_log_buffer_size: 0
compressed combine_log_size: 3772
compressed combine_log_buffer_size: 512
compressed finalize_states_log_size: 3136
compressed finalize_states_log_buffer_size: 32
compressed join_gather_log_size: 7729372
compressed join_gather_log_buffer_size: 7589080
compressed reorder_log_size: 4112
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 2528
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 2528
compressed nlj_log_buffer_size: 0
compressed total_size: 24389824
compressed total_buffer_size: 24031846
compressed total_element_size: 357978

Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                                                                                                                                                                                                           
│         PROJECTION        │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│__internal_decompress_integ│                                                                                                                                                                                                           
│    ral_bigint(#0, 1992)   │                                                                                                                                                                                                           
│             #1            │                                                                                                                                                                                                           
└─────────────┬─────────────┘                                                                                                                                                                                                                                        
┌─────────────┴─────────────┐                                                                                                                                                                                                           
│          ORDER_BY         │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│          ORDERS:          │                                                                                                                                                                                                           
│   all_nations.o_year ASC  │                                                                                                                                                                                                           
└─────────────┬─────────────┘                                                                                                                                                                                                                                        
┌─────────────┴─────────────┐                                                                                                                                                                                                           
│         PROJECTION        │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│__internal_compress_integra│                                                                                                                                                                                                           
│    l_utinyint(#0, 1992)   │                                                                                                                                                                                                           
│             #1            │                                                                                                                                                                                                           
└─────────────┬─────────────┘                                                                                                                                                                                                                                        
┌─────────────┴─────────────┐                                                                                                                                                                                                           
│         PROJECTION        │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│           o_year          │                                                                                                                                                                                                           
│         mkt_share         │                                                                                                                                                                                                           
└─────────────┬─────────────┘                                                                                                                                                                                                                                        
┌─────────────┴─────────────┐                                                                                                                                                                                                           
│         PROJECTION        │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│__internal_decompress_integ│                                                                                                                                                                                                           
│    ral_bigint(#0, 1992)   │                                                                                                                                                                                                           
│             #1            │                                                                                                                                                                                                           
│             #2            │                                                                                                                                                                                                           
└─────────────┬─────────────┘                                                                                                                                                                                                                                        
┌─────────────┴─────────────┐                                                                                                                                                                                                           
│   PERFECT_HASH_GROUP_BY   │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│             #0            │                                                                                                                                                                                                           
│          sum(#1)          │                                                                                                                                                                                                           
│          sum(#2)          │                                                                                                                                                                                                           
└─────────────┬─────────────┘                                                                                                                                                                                                                                        
┌─────────────┴─────────────┐                                                                                                                                                                                                           
│         PROJECTION        │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│           o_year          │                                                                                                                                                                                                           
│   CASE  WHEN ((nation =   │                                                                                                                                                                                                           
│'BRAZIL')) THEN (volum...  │                                                                                                                                                                                                           
│         .0000 END         │                                                                                                                                                                                                           
│           volume          │                                                                                                                                                                                                           
└─────────────┬─────────────┘                                                                                                                                                                                                                                        
┌─────────────┴─────────────┐                                                                                                                                                                                                           
│         PROJECTION        │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│__internal_compress_integra│                                                                                                                                                                                                           
│    l_utinyint(#0, 1992)   │                                                                                                                                                                                                           
│             #1            │                                                                                                                                                                                                           
│             #2            │                                                                                                                                                                                                           
└─────────────┬─────────────┘                                                                                                                                                                                                                                        
┌─────────────┴─────────────┐                                                                                                                                                                                                           
│         PROJECTION        │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│     year(o_orderdate)     │                                                                                                                                                                                                           
│           volume          │                                                                                                                                                                                                           
│           nation          │                                                                                                                                                                                                           
└─────────────┬─────────────┘                                                                                                                                                                                                                                        
┌─────────────┴─────────────┐                                                                                                                                                                                                           
│         HASH_JOIN         │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│           INNER           │                                                                                                                                                                                                           
│ s_nationkey = n_nationkey │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐              
│        Build Min: 0       │                                                                                                                                                                                            │              
│       Build Max: 24       │                                                                                                                                                                                            │              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                            │              
│          EC: 508          │                                                                                                                                                                                            │              
└─────────────┬─────────────┘                                                                                                                                                                                            │                                           
┌─────────────┴─────────────┐                                                                                                                                                                              ┌─────────────┴─────────────┐
│         HASH_JOIN         │                                                                                                                                                                              │         SEQ_SCAN          │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│           INNER           │                                                                                                                                                                              │           nation          │
│   s_suppkey = l_suppkey   │                                                                                                                                                                              │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐                                                                                                                                                               │        n_nationkey        │
│        Build Min: 1       │              │                                                                                                                                                               │           n_name          │
│      Build Max: 10000     │              │                                                                                                                                                               │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                                                                                                                                               │           EC: 25          │
│          EC: 508          │              │                                                                                                                                                               │                           │
└─────────────┬─────────────┘              │                                                                                                                                                               └───────────────────────────┘                             
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                                                                                                              
│         SEQ_SCAN          ││         HASH_JOIN         │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│          supplier         ││           INNER           │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││ c_nationkey = n_nationkey │                                                                                                                                                                              
│         s_suppkey         ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├─────────────────────────────────────────────────────────────────────────────────────────────────────┐                                                                        
│        s_nationkey        ││        Build Min: 0       │                                                                                                     │                                                                        
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││       Build Max: 24       │                                                                                                     │                                                                        
│         EC: 10000         ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                     │                                                                        
│                           ││          EC: 512          │                                                                                                     │                                                                        
└───────────────────────────┘└─────────────┬─────────────┘                                                                                                     │                                                                                                     
                             ┌─────────────┴─────────────┐                                                                                       ┌─────────────┴─────────────┐                                                          
                             │         HASH_JOIN         │                                                                                       │         HASH_JOIN         │                                                          
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                             │           INNER           │                                                                                       │           INNER           │                                                          
                             │   c_custkey = o_custkey   │                                                                                       │ n_regionkey = r_regionkey │                                                          
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐                                                                        │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐                                           
                             │        Build Min: 1       │              │                                                                        │        Build Min: 0       │              │                                           
                             │     Build Max: 149999     │              │                                                                        │        Build Max: 4       │              │                                           
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                                                        │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                           
                             │          EC: 2562         │              │                                                                        │           EC: 5           │              │                                           
                             └─────────────┬─────────────┘              │                                                                        └─────────────┬─────────────┘              │                                                                        
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             
                             │         SEQ_SCAN          ││         HASH_JOIN         │                                                          │         SEQ_SCAN          ││         SEQ_SCAN          │                             
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                             │          customer         ││           INNER           │                                                          │           nation          ││           region          │                             
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││  o_orderkey = l_orderkey  │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                             │         c_custkey         ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │        n_nationkey        ││        r_regionkey        │                             
                             │        c_nationkey        ││          EC: 4249         ├──────────────┐                                           │        n_regionkey        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │              │                                           │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││ Filters: r_name='AMERICA' │                             
                             │ Filters: c_custkey<=149999││                           │              │                                           │           EC: 25          ││   AND r_name IS NOT NULL  │                             
                             │  AND c_custkey IS NOT NULL││                           │              │                                           │                           ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │              │                                           │                           ││           EC: 1           │                             
                             │         EC: 150000        ││                           │              │                                           │                           ││                           │                             
                             └───────────────────────────┘└─────────────┬─────────────┘              │                                           └───────────────────────────┘└───────────────────────────┘                                                          
                                                          ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                                                    
                                                          │         SEQ_SCAN          ││         HASH_JOIN         │                                                                                                                    
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
                                                          │           orders          ││           INNER           │                                                                                                                    
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   l_partkey = p_partkey   │                                                                                                                    
                                                          │         o_orderkey        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
                                                          │         o_custkey         ││        Build Min: 1       │                                                                                                                    
                                                          │        o_orderdate        ││     Build Max: 200000     │                                                                                                                    
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐                                                                                                     
                                                          │Filters: o_orderdate>='1995││         EC: 21246         │              │                                                                                                     
                                                          │     -01-01'::DATE AND     ││                           │              │                                                                                                     
                                                          │ o_orderdate<='1996-12...  ││                           │              │                                                                                                     
                                                          │   o_orderdate IS NOT NULL ││                           │              │                                                                                                     
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │              │                                                                                                     
                                                          │         EC: 300000        ││                           │              │                                                                                                     
                                                          └───────────────────────────┘└─────────────┬─────────────┘              │                                                                                                                                  
                                                                                       ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                       
                                                                                       │         SEQ_SCAN          ││         SEQ_SCAN          │                                                                                       
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
                                                                                       │          lineitem         ││            part           │                                                                                       
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
                                                                                       │         l_partkey         ││         p_partkey         │                                                                                       
                                                                                       │         l_suppkey         ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
                                                                                       │         l_orderkey        ││  Filters: p_type='ECONOMY │                                                                                       
                                                                                       │      l_extendedprice      ││ ANODIZED STEEL' AND p...  │                                                                                       
                                                                                       │         l_discount        ││          NOT NULL         │                                                                                       
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
                                                                                       │        EC: 6001215        ││          EC: 1325         │                                                                                       
                                                                                       └───────────────────────────┘└───────────────────────────┘                                                                                                                    

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

X {'RESULT_COLLECTOR0': 1.5e-05, 'PROJECTION1': 1.1e-05, 'ORDER_BY2': 0.000107, 'PROJECTION3': 1.3e-05, 'PROJECTION4': 2.3e-05, 'HASH_GROUP_BY5': 0.008511, 'PROJECTION6': 9e-06, 'PROJECTION7': 0.000229, 'PROJECTION8': 0.000191, 'PROJECTION9': 1.5e-05, 'FILTER10': 0.073843, 'HASH_JOIN11': 0.060547, 'HASH_JOIN12': 0.380709, 'SEQ_SCAN 13': 0.053874, 'HASH_JOIN14': 0.049917, 'SEQ_SCAN 15': 0.003987, 'HASH_JOIN16': 0.006595, 'SEQ_SCAN 17': 0.001049, 'SEQ_SCAN 18': 3.4e-05, 'HASH_JOIN19': 0.000472, 'SEQ_SCAN 20': 5.6e-05, 'SEQ_SCAN 21': 4.5e-05}
**** output size:  4
LINEAGE_5_FILTER_11
LINEAGE_5_HASH_GROUP_BY_16
LINEAGE_5_HASH_JOIN_10
LINEAGE_5_HASH_JOIN_4
LINEAGE_5_HASH_JOIN_5
LINEAGE_5_HASH_JOIN_6
LINEAGE_5_HASH_JOIN_9
LINEAGE_5_ORDER_BY_19
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_1
LINEAGE_5_SEQ_SCAN_2
LINEAGE_5_SEQ_SCAN_3
LINEAGE_5_SEQ_SCAN_7
LINEAGE_5_SEQ_SCAN_8
SELECT supp_nation, cust_nation, l_year, sum(volume) AS revenue FROM ( SELECT n1.n_name AS supp_nation, n2.n_name AS cust_nation, extract(year FROM l_shipdate) AS l_year, l_extendedprice * (1 - l_discount) AS volume FROM supplier, lineitem, orders, customer, nation n1, nation n2 WHERE s_suppkey = l_suppkey AND o_orderkey = l_orderkey AND c_custkey = o_custkey AND s_nationkey = n1.n_nationkey AND c_nationkey = n2.n_nationkey AND ((n1.n_name = 'FRANCE' AND n2.n_name = 'GERMANY') OR (n1.n_name = 'GERMANY' AND n2.n_name = 'FRANCE')) AND l_shipdate BETWEEN CAST('1995-01-01' AS date) AND CAST('1996-12-31' AS date)) AS shipping GROUP BY supp_nation, cust_nation, l_year ORDER BY supp_nation, cust_nation, l_year;
   query_id  ...                                               plan
0         5  ...  {"name": "PROJECTION", "opid": "20", "children...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               SELECT supp_nation, cust_nation, l_year, sum(v...
size_bytes_max                                               24389824
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "PROJECTION", "opid": "20", "children...
Name: 0, dtype: object
{"name": "PROJECTION", "opid": "20", "children": [{"name": "ORDER_BY", "opid": "19", "children": [{"name": "PROJECTION", "opid": "18", "children": [{"name": "PROJECTION", "opid": "17", "children": [{"name": "HASH_GROUP_BY", "opid": "16", "children": [{"name": "PROJECTION", "opid": "15", "children": [{"name": "PROJECTION", "opid": "14", "children": [{"name": "PROJECTION", "opid": "13", "children": [{"name": "PROJECTION", "opid": "12", "children": [{"name": "FILTER", "opid": "11", "children": [{"name": "HASH_JOIN", "opid": "10", "children": [{"name": "HASH_JOIN", "opid": "6", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_suppkey\nl_orderkey\nl_shipdate\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nFilters: l_shipdate>='1995-01-01'::DATE AND l_shipdate<='1996-12-31'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243"},{"name": "HASH_JOIN", "opid": "5", "children": [{"name": "SEQ_SCAN ", "opid": "1", "children": [],"table": "orders","extra": "orders\n[INFOSEPARATOR]\no_orderkey\no_custkey\n[INFOSEPARATOR]\nEC: 1500000"},{"name": "HASH_JOIN", "opid": "4", "children": [{"name": "SEQ_SCAN ", "opid": "2", "children": [],"table": "customer","extra": "customer\n[INFOSEPARATOR]\nc_custkey\nc_nationkey\n[INFOSEPARATOR]\nFilters: c_custkey<=149999 AND c_custkey IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 150000"},{"name": "SEQ_SCAN ", "opid": "3", "children": [],"table": "nation","extra": "nation\n[INFOSEPARATOR]\nn_nationkey\nn_name\n[INFOSEPARATOR]\nEC: 25"}],"table": "","extra": "INNER\nc_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nEC: 150000\n"}],"table": "","extra": "INNER\no_custkey = c_custkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 149999\n\n[INFOSEPARATOR]\nEC: 904486\n"}],"table": "","extra": "INNER\nl_orderkey = o_orderkey\n\n[INFOSEPARATOR]\nEC: 723735\n"},{"name": "HASH_JOIN", "opid": "9", "children": [{"name": "SEQ_SCAN ", "opid": "7", "children": [],"table": "supplier","extra": "supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\n[INFOSEPARATOR]\nEC: 10000"},{"name": "SEQ_SCAN ", "opid": "8", "children": [],"table": "nation","extra": "nation\n[INFOSEPARATOR]\nn_nationkey\nn_name\n[INFOSEPARATOR]\nEC: 25"}],"table": "","extra": "INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 10000\n"}],"table": "","extra": "INNER\nl_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 717564\n"}],"table": "","extra": "(((n_name = 'FRANCE') AND (n_name = 'GERMANY')) OR ((n_name = 'GERMANY') AND (n_name = 'FRANCE')))\n[INFOSEPARATOR]\nEC: 717564"}],"table": "","extra": "#2\n#3\n#4\n#6\n#8\n"}],"table": "","extra": "supp_nation\ncust_nation\nyear(l_shipdate)\nvolume\n"}],"table": "","extra": "__internal_compress_string_hugeint(#0)\n__internal_compress_string_hugeint(#1)\n__internal_compress_integral_utinyint(#2, 1992)\n#3\n"}],"table": "","extra": "supp_nation\ncust_nation\nl_year\nvolume\n"}],"table": "","extra": "#0\n#1\n#2\nsum(#3)"}],"table": "","extra": "__internal_decompress_string(#0)\n__internal_decompress_string(#1)\n__internal_decompress_integral_bigint(#2, 1992)\n#3\n"}],"table": "","extra": "__internal_compress_string_hugeint(#0)\n__internal_compress_string_hugeint(#1)\n__internal_compress_integral_utinyint(#2, 1992)\n#3\n"}],"table": "","extra": "ORDERS:\nshipping.supp_nation ASC\nshipping.cust_nation ASC\nshipping.l_year ASC"}],"table": "","extra": "__internal_decompress_string(#0)\n__internal_decompress_string(#1)\n__internal_decompress_integral_bigint(#2, 1992)\n#3\n"}
%%%%%%%%%%%%%%%% Running Query #  8  threads:  8
SELECT o_year, sum( CASE WHEN nation = 'BRAZIL' THEN volume ELSE 0 END) / sum(volume) AS mkt_share FROM ( SELECT extract(year FROM o_orderdate) AS o_year, l_extendedprice * (1 - l_discount) AS volume, n2.n_name AS nation FROM part, supplier, lineitem, orders, customer, nation n1, nation n2, region WHERE p_partkey = l_partkey AND s_suppkey = l_suppkey AND l_orderkey = o_orderkey AND o_custkey = c_custkey AND c_nationkey = n1.n_nationkey AND n1.n_regionkey = r_regionkey AND r_name = 'AMERICA' AND s_nationkey = n2.n_nationkey AND o_orderdate BETWEEN CAST('1995-01-01' AS date) AND CAST('1996-12-31' AS date) AND p_type = 'ECONOMY ANODIZED STEEL') AS all_nations GROUP BY o_year ORDER BY o_year;
Run:  None SELECT o_year, sum( CASE WHEN nation = 'BRAZIL' THEN volume ELSE 0 END) / sum(volume) AS mkt_share FROM ( SELECT extract(year FROM o_orderdate) AS o_year, l_extendedprice * (1 - l_discount) AS volume, n2.n_name AS nation FROM part, supplier, lineitem, orders, customer, nation n1, nation n2, region WHERE p_partkey = l_partkey AND s_suppkey = l_suppkey AND l_orderkey = o_orderkey AND o_custkey = c_custkey AND c_nationkey = n1.n_nationkey AND n1.n_regionkey = r_regionkey AND r_name = 'AMERICA' AND s_nationkey = n2.n_nationkey AND o_orderdate BETWEEN CAST('1995-01-01' AS date) AND CAST('1996-12-31' AS date) AND p_type = 'ECONOMY ANODIZED STEEL') AS all_nations GROUP BY o_year ORDER BY o_year;
Avg Time in sec:  0.06702719908207655  output size:  2
   o_year  mkt_share
0    1995   0.034436
1    1996   0.041486
{'name': 'Query', 'result': 0.045315, 'timing': 0.045315, 'cardinality': 0, 'extra-info': "SELECT o_year, sum( CASE WHEN nation = 'BRAZIL' THEN volume ELSE 0 END) / sum(volume) AS mkt_share FROM ( SELECT extract(year FROM o_orderdate) AS o_year, l_extendedprice * (1 - l_discount) AS volume, n2.n_name AS nation FROM part, supplier, lineitem, orders, customer, nation n1, nation n2, region WHERE p_partkey = l_partkey AND s_suppkey = l_suppkey AND l_orderkey = o_orderkey AND o_custkey = c_custkey AND c_nationkey = n1.n_nationkey AND n1.n_regionkey = r_regionkey AND r_name = 'AMERICA' AND s_nationkey = n2.n_nationkey AND o_orderdate BETWEEN CAST('1995-01-01' AS date) AND CAST('1996-12-31' AS date) AND p_type = 'ECONOMY ANODIZED STEEL') AS all_nations GROUP BY o_year ORDER BY o_year;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 4e-06, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 1e-06, 'cardinality': 2, 'extra_info': '__internal_decompress_integral_bigint(#0, 1992)\n#1\n', 'children': [{'name': 'ORDER_BY', 'timing': 2.5e-05, 'cardinality': 2, 'extra_info': 'ORDERS:\nall_nations.o_year ASC', 'children': [{'name': 'PROJECTION', 'timing': 1e-06, 'cardinality': 2, 'extra_info': '__internal_compress_integral_utinyint(#0, 1992)\n#1\n', 'children': [{'name': 'PROJECTION', 'timing': 5e-06, 'cardinality': 2, 'extra_info': 'o_year\nmkt_share\n', 'children': [{'name': 'PROJECTION', 'timing': 3e-06, 'cardinality': 2, 'extra_info': '__internal_decompress_integral_bigint(#0, 1992)\n#1\n#2\n', 'children': [{'name': 'PERFECT_HASH_GROUP_BY', 'timing': 6e-05, 'cardinality': 2, 'extra_info': '#0\nsum(#1)\nsum(#2)', 'children': [{'name': 'PROJECTION', 'timing': 4.1e-05, 'cardinality': 2603, 'extra_info': "o_year\nCASE  WHEN ((nation = 'BRAZIL')) THEN (volume) ELSE 0.0000 END\nvolume\n", 'children': [{'name': 'PROJECTION', 'timing': 1.2e-05, 'cardinality': 2603, 'extra_info': '__internal_compress_integral_utinyint(#0, 1992)\n#1\n#2\n', 'children': [{'name': 'PROJECTION', 'timing': 6.2e-05, 'cardinality': 2603, 'extra_info': 'year(o_orderdate)\nvolume\nnation\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.000254, 'cardinality': 2603, 'extra_info': 'INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 508\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.00084, 'cardinality': 2603, 'extra_info': 'INNER\ns_suppkey = l_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 508\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 3e-05, 'cardinality': 10000, 'extra_info': 'supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\n[INFOSEPARATOR]\nEC: 10000', 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.000758, 'cardinality': 2603, 'extra_info': 'INNER\nc_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 512\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.006331, 'cardinality': 13389, 'extra_info': 'INNER\nc_custkey = o_custkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 149999\n\n[INFOSEPARATOR]\nEC: 2562\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.000897, 'cardinality': 149999, 'extra_info': 'customer\n[INFOSEPARATOR]\nc_custkey\nc_nationkey\n[INFOSEPARATOR]\nFilters: c_custkey<=149999 AND c_custkey IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 150000', 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.02871, 'cardinality': 13389, 'extra_info': 'INNER\no_orderkey = l_orderkey\n\n[INFOSEPARATOR]\nEC: 4249\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.017863, 'cardinality': 457263, 'extra_info': "orders\n[INFOSEPARATOR]\no_orderkey\no_custkey\no_orderdate\n[INFOSEPARATOR]\nFilters: o_orderdate>='1995-01-01'::DATE AND o_orderdate<='1996-12-31'::DATE AND o_orderdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 300000", 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.076136, 'cardinality': 43693, 'extra_info': 'INNER\nl_partkey = p_partkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 21246\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.023089, 'cardinality': 6001215, 'extra_info': 'lineitem\n[INFOSEPARATOR]\nl_partkey\nl_suppkey\nl_orderkey\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nEC: 6001215', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 0.011539, 'cardinality': 1451, 'extra_info': "part\n[INFOSEPARATOR]\np_partkey\n[INFOSEPARATOR]\nFilters: p_type='ECONOMY ANODIZED STEEL' AND p_type IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1325", 'children': []}]}]}]}, {'name': 'HASH_JOIN', 'timing': 4.5e-05, 'cardinality': 5, 'extra_info': 'INNER\nn_regionkey = r_regionkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 4\n\n[INFOSEPARATOR]\nEC: 5\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 1.1e-05, 'cardinality': 25, 'extra_info': 'nation\n[INFOSEPARATOR]\nn_nationkey\nn_regionkey\n[INFOSEPARATOR]\nEC: 25', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 2.6e-05, 'cardinality': 1, 'extra_info': "region\n[INFOSEPARATOR]\nr_regionkey\n[INFOSEPARATOR]\nFilters: r_name='AMERICA' AND r_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1", 'children': []}]}]}]}, {'name': 'SEQ_SCAN ', 'timing': 3.1e-05, 'cardinality': 25, 'extra_info': 'nation\n[INFOSEPARATOR]\nn_nationkey\nn_name\n[INFOSEPARATOR]\nEC: 25', 'children': []}]}]}]}]}]}]}]}]}]}]}]}]}
compressed filter_log_size: 1664
compressed filter_log_buffer_size: 0
compressed limit_offset_size: 1664
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 8561
compressed perfect_full_scan_ht_log_buffer_size: 5361
compressed perfect_probe_ht_log_size: 424422
compressed perfect_probe_ht_log_buffer_size: 376804
compressed row_group_log_size: 231594
compressed row_group_log_buffer_size: 194577
compressed scatter_log_size: 4336
compressed scatter_log_buffer_size: 2484
compressed scatter_sel_log_size: 286239
compressed scatter_sel_log_buffer_size: 278158
compressed gather_log_size: 1664
compressed gather_log_buffer_size: 0
compressed combine_log_size: 1840
compressed combine_log_buffer_size: 32
compressed finalize_states_log_size: 1824
compressed finalize_states_log_buffer_size: 16
compressed join_gather_log_size: 278201
compressed join_gather_log_buffer_size: 246138
compressed reorder_log_size: 2576
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 1664
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 1664
compressed nlj_log_buffer_size: 0
compressed total_size: 1247913
compressed total_buffer_size: 1103570
compressed total_element_size: 144343

Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│__internal_decompress_strin│                                                                                                                                                 
│           g(#0)           │                                                                                                                                                 
│__internal_decompress_integ│                                                                                                                                                 
│    ral_bigint(#1, 1992)   │                                                                                                                                                 
│             #2            │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│          ORDER_BY         │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│          ORDERS:          │                                                                                                                                                 
│     profit.nation ASC     │                                                                                                                                                 
│     profit.o_year DESC    │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│__internal_compress_string_│                                                                                                                                                 
│        hugeint(#0)        │                                                                                                                                                 
│__internal_compress_integra│                                                                                                                                                 
│    l_utinyint(#1, 1992)   │                                                                                                                                                 
│             #2            │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│__internal_decompress_strin│                                                                                                                                                 
│           g(#0)           │                                                                                                                                                 
│__internal_decompress_integ│                                                                                                                                                 
│    ral_bigint(#1, 1992)   │                                                                                                                                                 
│             #2            │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│       HASH_GROUP_BY       │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│             #0            │                                                                                                                                                 
│             #1            │                                                                                                                                                 
│          sum(#2)          │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│           nation          │                                                                                                                                                 
│           o_year          │                                                                                                                                                 
│           amount          │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│__internal_compress_string_│                                                                                                                                                 
│        hugeint(#0)        │                                                                                                                                                 
│__internal_compress_integra│                                                                                                                                                 
│    l_utinyint(#1, 1992)   │                                                                                                                                                 
│             #2            │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│           nation          │                                                                                                                                                 
│     year(o_orderdate)     │                                                                                                                                                 
│           amount          │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         HASH_JOIN         │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│           INNER           │                                                                                                                                                 
│  o_orderkey = l_orderkey  ├──────────────┐                                                                                                                                  
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                                                                                                                  
│        EC: 1191610        │              │                                                                                                                                  
└─────────────┬─────────────┘              │                                                                                                                                                               
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                                                    
│         SEQ_SCAN          ││         HASH_JOIN         │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│           orders          ││           INNER           │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   l_suppkey = ps_suppkey  │                                                                                                                    
│         o_orderkey        ││   l_partkey = ps_partkey  ├──────────────┐                                                                                                     
│        o_orderdate        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                                                                                     
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││        EC: 1191610        │              │                                                                                                     
│        EC: 1500000        ││                           │              │                                                                                                     
└───────────────────────────┘└─────────────┬─────────────┘              │                                                                                                                                  
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                       
                             │         SEQ_SCAN          ││         HASH_JOIN         │                                                                                       
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
                             │          lineitem         ││           INNER           │                                                                                       
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ps_suppkey = s_suppkey  │                                                                                       
                             │         l_suppkey         ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
                             │         l_partkey         ││        Build Min: 1       │                                                                                       
                             │         l_orderkey        ││      Build Max: 10000     ├───────────────────────────────────────────┐                                           
                             │      l_extendedprice      ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                           │                                           
                             │         l_discount        ││         EC: 74312         │                                           │                                           
                             │         l_quantity        ││                           │                                           │                                           
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                           │                                           
                             │        EC: 6001215        ││                           │                                           │                                           
                             └───────────────────────────┘└─────────────┬─────────────┘                                           │                                                                        
                                                          ┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐                             
                                                          │         HASH_JOIN         │                             │         HASH_JOIN         │                             
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                                                          │           INNER           │                             │           INNER           │                             
                                                          │   ps_partkey = p_partkey  │                             │ s_nationkey = n_nationkey │                             
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐              │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐              
                                                          │        Build Min: 1       │              │              │        Build Min: 0       │              │              
                                                          │     Build Max: 200000     │              │              │       Build Max: 24       │              │              
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              
                                                          │         EC: 85503         │              │              │         EC: 10000         │              │              
                                                          └─────────────┬─────────────┘              │              └─────────────┬─────────────┘              │                                           
                                                          ┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐
                                                          │         SEQ_SCAN          ││           FILTER          ││         SEQ_SCAN          ││         SEQ_SCAN          │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │          partsupp         ││ contains(p_name, 'green') ││          supplier         ││           nation          │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │         ps_suppkey        ││         EC: 40000         ││         s_suppkey         ││        n_nationkey        │
                                                          │         ps_partkey        ││                           ││        s_nationkey        ││           n_name          │
                                                          │       ps_supplycost       ││                           ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           ││         EC: 10000         ││           EC: 25          │
                                                          │         EC: 800000        ││                           ││                           ││                           │
                                                          └───────────────────────────┘└─────────────┬─────────────┘└───────────────────────────┘└───────────────────────────┘                             
                                                                                       ┌─────────────┴─────────────┐                                                          
                                                                                       │         SEQ_SCAN          │                                                          
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                                                       │            part           │                                                          
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                                                       │         p_partkey         │                                                          
                                                                                       │           p_name          │                                                          
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                                                       │         EC: 40000         │                                                          
                                                                                       └───────────────────────────┘                                                                                       

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

X {'RESULT_COLLECTOR0': 4e-06, 'PROJECTION1': 1e-06, 'ORDER_BY2': 2.5e-05, 'PROJECTION3': 1e-06, 'PROJECTION4': 5e-06, 'PROJECTION5': 3e-06, 'PERFECT_HASH_GROUP_BY6': 6e-05, 'PROJECTION7': 4.1e-05, 'PROJECTION8': 1.2e-05, 'PROJECTION9': 6.2e-05, 'HASH_JOIN10': 0.000254, 'HASH_JOIN11': 0.00084, 'SEQ_SCAN 12': 3e-05, 'HASH_JOIN13': 0.000758, 'HASH_JOIN14': 0.006331, 'SEQ_SCAN 15': 0.000897, 'HASH_JOIN16': 0.02871, 'SEQ_SCAN 17': 0.017863, 'HASH_JOIN18': 0.076136, 'SEQ_SCAN 19': 0.023089, 'SEQ_SCAN 20': 0.011539, 'HASH_JOIN21': 4.5e-05, 'SEQ_SCAN 22': 1.1e-05, 'SEQ_SCAN 23': 2.6e-05, 'SEQ_SCAN 24': 3.1e-05}
**** output size:  2
LINEAGE_5_HASH_JOIN_10
LINEAGE_5_HASH_JOIN_11
LINEAGE_5_HASH_JOIN_12
LINEAGE_5_HASH_JOIN_14
LINEAGE_5_HASH_JOIN_5
LINEAGE_5_HASH_JOIN_6
LINEAGE_5_HASH_JOIN_7
LINEAGE_5_ORDER_BY_22
LINEAGE_5_PERFECT_HASH_GROUP_BY_18
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_1
LINEAGE_5_SEQ_SCAN_13
LINEAGE_5_SEQ_SCAN_2
LINEAGE_5_SEQ_SCAN_3
LINEAGE_5_SEQ_SCAN_4
LINEAGE_5_SEQ_SCAN_8
LINEAGE_5_SEQ_SCAN_9
SELECT o_year, sum( CASE WHEN nation = 'BRAZIL' THEN volume ELSE 0 END) / sum(volume) AS mkt_share FROM ( SELECT extract(year FROM o_orderdate) AS o_year, l_extendedprice * (1 - l_discount) AS volume, n2.n_name AS nation FROM part, supplier, lineitem, orders, customer, nation n1, nation n2, region WHERE p_partkey = l_partkey AND s_suppkey = l_suppkey AND l_orderkey = o_orderkey AND o_custkey = c_custkey AND c_nationkey = n1.n_nationkey AND n1.n_regionkey = r_regionkey AND r_name = 'AMERICA' AND s_nationkey = n2.n_nationkey AND o_orderdate BETWEEN CAST('1995-01-01' AS date) AND CAST('1996-12-31' AS date) AND p_type = 'ECONOMY ANODIZED STEEL') AS all_nations GROUP BY o_year ORDER BY o_year;
   query_id  ...                                               plan
0         5  ...  {"name": "PROJECTION", "opid": "23", "children...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               SELECT o_year, sum( CASE WHEN nation = 'BRAZIL...
size_bytes_max                                                1247913
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "PROJECTION", "opid": "23", "children...
Name: 0, dtype: object
{"name": "PROJECTION", "opid": "23", "children": [{"name": "ORDER_BY", "opid": "22", "children": [{"name": "PROJECTION", "opid": "21", "children": [{"name": "PROJECTION", "opid": "20", "children": [{"name": "PROJECTION", "opid": "19", "children": [{"name": "PERFECT_HASH_GROUP_BY", "opid": "18", "children": [{"name": "PROJECTION", "opid": "17", "children": [{"name": "PROJECTION", "opid": "16", "children": [{"name": "PROJECTION", "opid": "15", "children": [{"name": "HASH_JOIN", "opid": "14", "children": [{"name": "HASH_JOIN", "opid": "12", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "supplier","extra": "supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\n[INFOSEPARATOR]\nEC: 10000"},{"name": "HASH_JOIN", "opid": "11", "children": [{"name": "HASH_JOIN", "opid": "7", "children": [{"name": "SEQ_SCAN ", "opid": "1", "children": [],"table": "customer","extra": "customer\n[INFOSEPARATOR]\nc_custkey\nc_nationkey\n[INFOSEPARATOR]\nFilters: c_custkey<=149999 AND c_custkey IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 150000"},{"name": "HASH_JOIN", "opid": "6", "children": [{"name": "SEQ_SCAN ", "opid": "2", "children": [],"table": "orders","extra": "orders\n[INFOSEPARATOR]\no_orderkey\no_custkey\no_orderdate\n[INFOSEPARATOR]\nFilters: o_orderdate>='1995-01-01'::DATE AND o_orderdate<='1996-12-31'::DATE AND o_orderdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 300000"},{"name": "HASH_JOIN", "opid": "5", "children": [{"name": "SEQ_SCAN ", "opid": "3", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_partkey\nl_suppkey\nl_orderkey\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nEC: 6001215"},{"name": "SEQ_SCAN ", "opid": "4", "children": [],"table": "part","extra": "part\n[INFOSEPARATOR]\np_partkey\n[INFOSEPARATOR]\nFilters: p_type='ECONOMY ANODIZED STEEL' AND p_type IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1325"}],"table": "","extra": "INNER\nl_partkey = p_partkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 21246\n"}],"table": "","extra": "INNER\no_orderkey = l_orderkey\n\n[INFOSEPARATOR]\nEC: 4249\n"}],"table": "","extra": "INNER\nc_custkey = o_custkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 149999\n\n[INFOSEPARATOR]\nEC: 2562\n"},{"name": "HASH_JOIN", "opid": "10", "children": [{"name": "SEQ_SCAN ", "opid": "8", "children": [],"table": "nation","extra": "nation\n[INFOSEPARATOR]\nn_nationkey\nn_regionkey\n[INFOSEPARATOR]\nEC: 25"},{"name": "SEQ_SCAN ", "opid": "9", "children": [],"table": "region","extra": "region\n[INFOSEPARATOR]\nr_regionkey\n[INFOSEPARATOR]\nFilters: r_name='AMERICA' AND r_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1"}],"table": "","extra": "INNER\nn_regionkey = r_regionkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 4\n\n[INFOSEPARATOR]\nEC: 5\n"}],"table": "","extra": "INNER\nc_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 512\n"}],"table": "","extra": "INNER\ns_suppkey = l_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 508\n"},{"name": "SEQ_SCAN ", "opid": "13", "children": [],"table": "nation","extra": "nation\n[INFOSEPARATOR]\nn_nationkey\nn_name\n[INFOSEPARATOR]\nEC: 25"}],"table": "","extra": "INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 508\n"}],"table": "","extra": "year(o_orderdate)\nvolume\nnation\n"}],"table": "","extra": "__internal_compress_integral_utinyint(#0, 1992)\n#1\n#2\n"}],"table": "","extra": "o_year\nCASE  WHEN ((nation = 'BRAZIL')) THEN (volume) ELSE 0.0000 END\nvolume\n"}],"table": "","extra": "#0\nsum(#1)\nsum(#2)"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1992)\n#1\n#2\n"}],"table": "","extra": "o_year\nmkt_share\n"}],"table": "","extra": "__internal_compress_integral_utinyint(#0, 1992)\n#1\n"}],"table": "","extra": "ORDERS:\nall_nations.o_year ASC"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1992)\n#1\n"}
%%%%%%%%%%%%%%%% Running Query #  9  threads:  8
SELECT nation, o_year, sum(amount) AS sum_profit FROM ( SELECT n_name AS nation, extract(year FROM o_orderdate) AS o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity AS amount FROM part, supplier, lineitem, partsupp, orders, nation WHERE s_suppkey = l_suppkey AND ps_suppkey = l_suppkey AND ps_partkey = l_partkey AND p_partkey = l_partkey AND o_orderkey = l_orderkey AND s_nationkey = n_nationkey AND p_name LIKE '%green%') AS profit GROUP BY nation, o_year ORDER BY nation, o_year DESC;
Run:  None SELECT nation, o_year, sum(amount) AS sum_profit FROM ( SELECT n_name AS nation, extract(year FROM o_orderdate) AS o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity AS amount FROM part, supplier, lineitem, partsupp, orders, nation WHERE s_suppkey = l_suppkey AND ps_suppkey = l_suppkey AND ps_partkey = l_partkey AND p_partkey = l_partkey AND o_orderkey = l_orderkey AND s_nationkey = n_nationkey AND p_name LIKE '%green%') AS profit GROUP BY nation, o_year ORDER BY nation, o_year DESC;
Avg Time in sec:  0.13206680491566658  output size:  175
      nation  o_year    sum_profit
0    ALGERIA    1998  2.713690e+07
1    ALGERIA    1997  4.861183e+07
2    ALGERIA    1996  4.828548e+07
3    ALGERIA    1995  4.440227e+07
4    ALGERIA    1994  4.869401e+07
..       ...     ...           ...
170  VIETNAM    1996  4.782460e+07
171  VIETNAM    1995  4.823514e+07
172  VIETNAM    1994  4.772926e+07
173  VIETNAM    1993  4.535268e+07
174  VIETNAM    1992  4.784636e+07

[175 rows x 3 columns]
{'name': 'Query', 'result': 0.117628, 'timing': 0.117628, 'cardinality': 0, 'extra-info': "SELECT nation, o_year, sum(amount) AS sum_profit FROM ( SELECT n_name AS nation, extract(year FROM o_orderdate) AS o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity AS amount FROM part, supplier, lineitem, partsupp, orders, nation WHERE s_suppkey = l_suppkey AND ps_suppkey = l_suppkey AND ps_partkey = l_partkey AND p_partkey = l_partkey AND o_orderkey = l_orderkey AND s_nationkey = n_nationkey AND p_name LIKE '%green%') AS profit GROUP BY nation, o_year ORDER BY nation, o_year DESC;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 3.1e-05, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 1.7e-05, 'cardinality': 175, 'extra_info': '__internal_decompress_string(#0)\n__internal_decompress_integral_bigint(#1, 1992)\n#2\n', 'children': [{'name': 'ORDER_BY', 'timing': 0.000294, 'cardinality': 175, 'extra_info': 'ORDERS:\nprofit.nation ASC\nprofit.o_year DESC', 'children': [{'name': 'PROJECTION', 'timing': 3.3e-05, 'cardinality': 175, 'extra_info': '__internal_compress_string_hugeint(#0)\n__internal_compress_integral_utinyint(#1, 1992)\n#2\n', 'children': [{'name': 'PROJECTION', 'timing': 5.7e-05, 'cardinality': 175, 'extra_info': '__internal_decompress_string(#0)\n__internal_decompress_integral_bigint(#1, 1992)\n#2\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.038946, 'cardinality': 175, 'extra_info': '#0\n#1\nsum(#2)', 'children': [{'name': 'PROJECTION', 'timing': 0.000666, 'cardinality': 319404, 'extra_info': 'nation\no_year\namount\n', 'children': [{'name': 'PROJECTION', 'timing': 0.006265, 'cardinality': 319404, 'extra_info': '__internal_compress_string_hugeint(#0)\n__internal_compress_integral_utinyint(#1, 1992)\n#2\n', 'children': [{'name': 'PROJECTION', 'timing': 0.012323, 'cardinality': 319404, 'extra_info': 'nation\nyear(o_orderdate)\namount\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.203169, 'cardinality': 319404, 'extra_info': 'INNER\no_orderkey = l_orderkey\n\n[INFOSEPARATOR]\nEC: 1191610\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.003254, 'cardinality': 1500000, 'extra_info': 'orders\n[INFOSEPARATOR]\no_orderkey\no_orderdate\n[INFOSEPARATOR]\nEC: 1500000', 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.255924, 'cardinality': 319404, 'extra_info': 'INNER\nl_suppkey = ps_suppkey\nl_partkey = ps_partkey\n\n[INFOSEPARATOR]\nEC: 1191610\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.019641, 'cardinality': 6001215, 'extra_info': 'lineitem\n[INFOSEPARATOR]\nl_suppkey\nl_partkey\nl_orderkey\nl_extendedprice\nl_discount\nl_quantity\n[INFOSEPARATOR]\nEC: 6001215', 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.007724, 'cardinality': 42656, 'extra_info': 'INNER\nps_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 74312\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.01163, 'cardinality': 42656, 'extra_info': 'INNER\nps_partkey = p_partkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 85503\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.003028, 'cardinality': 800000, 'extra_info': 'partsupp\n[INFOSEPARATOR]\nps_suppkey\nps_partkey\nps_supplycost\n[INFOSEPARATOR]\nEC: 800000', 'children': []}, {'name': 'FILTER', 'timing': 0.011974, 'cardinality': 10664, 'extra_info': "contains(p_name, 'green')\n[INFOSEPARATOR]\nEC: 40000", 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.00619, 'cardinality': 200000, 'extra_info': 'part\n[INFOSEPARATOR]\np_partkey\np_name\n[INFOSEPARATOR]\nEC: 40000', 'children': []}]}]}, {'name': 'HASH_JOIN', 'timing': 0.000599, 'cardinality': 10000, 'extra_info': 'INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 10000\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 9e-05, 'cardinality': 10000, 'extra_info': 'supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\n[INFOSEPARATOR]\nEC: 10000', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 4.9e-05, 'cardinality': 25, 'extra_info': 'nation\n[INFOSEPARATOR]\nn_nationkey\nn_name\n[INFOSEPARATOR]\nEC: 25', 'children': []}]}]}]}]}]}]}]}]}]}]}]}]}]}]}
compressed filter_log_size: 24180
compressed filter_log_buffer_size: 20249
compressed limit_offset_size: 2448
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 55596
compressed perfect_full_scan_ht_log_buffer_size: 51996
compressed perfect_probe_ht_log_size: 227977
compressed perfect_probe_ht_log_buffer_size: 210750
compressed row_group_log_size: 34558
compressed row_group_log_buffer_size: 0
compressed scatter_log_size: 1275181
compressed scatter_log_buffer_size: 1264356
compressed scatter_sel_log_size: 2184481
compressed scatter_sel_log_buffer_size: 2139346
compressed gather_log_size: 2448
compressed gather_log_buffer_size: 0
compressed combine_log_size: 47066
compressed combine_log_buffer_size: 43142
compressed finalize_states_log_size: 4137
compressed finalize_states_log_buffer_size: 537
compressed join_gather_log_size: 4195841
compressed join_gather_log_buffer_size: 4016411
compressed reorder_log_size: 4372
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 2448
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 2448
compressed nlj_log_buffer_size: 0
compressed total_size: 8063181
compressed total_buffer_size: 7746787
compressed total_element_size: 316394

Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                                                                                       
│           LIMIT           │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│__internal_decompress_integ│                                                                                       
│     ral_bigint(#0, 1)     │                                                                                       
│             #1            │                                                                                       
│             #2            │                                                                                       
│             #3            │                                                                                       
│__internal_decompress_strin│                                                                                       
│           g(#4)           │                                                                                       
│             #5            │                                                                                       
│__internal_decompress_strin│                                                                                       
│           g(#6)           │                                                                                       
│             #7            │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│          ORDER_BY         │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│          ORDERS:          │                                                                                       
│       sum((lineitem       │                                                                                       
│.l_extendedprice * (1 ...  │                                                                                       
│    .l_discount))) DESC    │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│__internal_compress_integra│                                                                                       
│     l_uinteger(#0, 1)     │                                                                                       
│             #1            │                                                                                       
│             #2            │                                                                                       
│             #3            │                                                                                       
│__internal_compress_string_│                                                                                       
│        hugeint(#4)        │                                                                                       
│             #5            │                                                                                       
│__internal_compress_string_│                                                                                       
│        hugeint(#6)        │                                                                                       
│             #7            │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│         c_custkey         │                                                                                       
│           c_name          │                                                                                       
│          revenue          │                                                                                       
│         c_acctbal         │                                                                                       
│           n_name          │                                                                                       
│         c_address         │                                                                                       
│          c_phone          │                                                                                       
│         c_comment         │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│__internal_decompress_integ│                                                                                       
│     ral_bigint(#0, 1)     │                                                                                       
│             #1            │                                                                                       
│             #2            │                                                                                       
│__internal_decompress_strin│                                                                                       
│           g(#3)           │                                                                                       
│__internal_decompress_strin│                                                                                       
│           g(#4)           │                                                                                       
│             #5            │                                                                                       
│             #6            │                                                                                       
│             #7            │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│       HASH_GROUP_BY       │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│             #0            │                                                                                       
│             #1            │                                                                                       
│             #2            │                                                                                       
│             #3            │                                                                                       
│             #4            │                                                                                       
│             #5            │                                                                                       
│             #6            │                                                                                       
│          sum(#7)          │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│         c_custkey         │                                                                                       
│           c_name          │                                                                                       
│         c_acctbal         │                                                                                       
│          c_phone          │                                                                                       
│           n_name          │                                                                                       
│         c_address         │                                                                                       
│         c_comment         │                                                                                       
│ (l_extendedprice * (1.00 -│                                                                                       
│        l_discount))       │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│__internal_compress_integra│                                                                                       
│     l_uinteger(#0, 1)     │                                                                                       
│             #1            │                                                                                       
│             #2            │                                                                                       
│__internal_compress_integra│                                                                                       
│     l_uinteger(#3, 1)     │                                                                                       
│__internal_compress_integra│                                                                                       
│     l_uinteger(#4, 1)     │                                                                                       
│             #5            │                                                                                       
│             #6            │                                                                                       
│__internal_compress_string_│                                                                                       
│        hugeint(#7)        │                                                                                       
│             #8            │                                                                                       
│             #9            │                                                                                       
│__internal_compress_string_│                                                                                       
│        hugeint(#10)       │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         HASH_JOIN         │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│           INNER           │                                                                                       
│  l_orderkey = o_orderkey  ├──────────────┐                                                                        
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                                                        
│         EC: 241245        │              │                                                                        
└─────────────┬─────────────┘              │                                                                                                     
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                          
│         SEQ_SCAN          ││         HASH_JOIN         │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│          lineitem         ││           INNER           │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   o_custkey = c_custkey   │                                                          
│         l_orderkey        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│      l_extendedprice      ││        Build Min: 1       │                                                          
│         l_discount        ││     Build Max: 149999     ├──────────────┐                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                           
│ Filters: l_returnflag='R' ││         EC: 180897        │              │                                           
│ AND l_returnflag IS N...  ││                           │              │                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │              │                                           
│        EC: 2000405        ││                           │              │                                           
└───────────────────────────┘└─────────────┬─────────────┘              │                                                                        
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             
                             │         SEQ_SCAN          ││         HASH_JOIN         │                             
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                             │           orders          ││           INNER           │                             
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││ c_nationkey = n_nationkey │                             
                             │         o_custkey         ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                             │         o_orderkey        ││         EC: 150000        │                             
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           ├──────────────┐              
                             │Filters: o_orderdate>='1993││                           │              │              
                             │     -10-01'::DATE AND     ││                           │              │              
                             │ o_orderdate<'1994-01-...  ││                           │              │              
                             │   o_orderdate IS NOT NULL ││                           │              │              
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │              │              
                             │         EC: 300000        ││                           │              │              
                             └───────────────────────────┘└─────────────┬─────────────┘              │                                           
                                                          ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
                                                          │         SEQ_SCAN          ││         SEQ_SCAN          │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │          customer         ││           nation          │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │         c_custkey         ││        n_nationkey        │
                                                          │        c_nationkey        ││           n_name          │
                                                          │           c_name          ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │         c_acctbal         ││           EC: 25          │
                                                          │          c_phone          ││                           │
                                                          │         c_address         ││                           │
                                                          │         c_comment         ││                           │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │
                                                          │ Filters: c_custkey<=149999││                           │
                                                          │  AND c_custkey IS NOT NULL││                           │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │
                                                          │         EC: 150000        ││                           │
                                                          └───────────────────────────┘└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

X {'RESULT_COLLECTOR0': 3.1e-05, 'PROJECTION1': 1.7e-05, 'ORDER_BY2': 0.000294, 'PROJECTION3': 3.3e-05, 'PROJECTION4': 5.7e-05, 'HASH_GROUP_BY5': 0.038946, 'PROJECTION6': 0.000666, 'PROJECTION7': 0.006265, 'PROJECTION8': 0.012323, 'HASH_JOIN9': 0.203169, 'SEQ_SCAN 10': 0.003254, 'HASH_JOIN11': 0.255924, 'SEQ_SCAN 12': 0.019641, 'HASH_JOIN13': 0.007724, 'HASH_JOIN14': 0.01163, 'SEQ_SCAN 15': 0.003028, 'FILTER16': 0.011974, 'SEQ_SCAN 17': 0.00619, 'HASH_JOIN18': 0.000599, 'SEQ_SCAN 19': 9e-05, 'SEQ_SCAN 20': 4.9e-05}
**** output size:  175
LINEAGE_5_FILTER_4
LINEAGE_5_HASH_GROUP_BY_15
LINEAGE_5_HASH_JOIN_10
LINEAGE_5_HASH_JOIN_11
LINEAGE_5_HASH_JOIN_5
LINEAGE_5_HASH_JOIN_8
LINEAGE_5_HASH_JOIN_9
LINEAGE_5_ORDER_BY_18
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_1
LINEAGE_5_SEQ_SCAN_2
LINEAGE_5_SEQ_SCAN_3
LINEAGE_5_SEQ_SCAN_6
LINEAGE_5_SEQ_SCAN_7
SELECT nation, o_year, sum(amount) AS sum_profit FROM ( SELECT n_name AS nation, extract(year FROM o_orderdate) AS o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity AS amount FROM part, supplier, lineitem, partsupp, orders, nation WHERE s_suppkey = l_suppkey AND ps_suppkey = l_suppkey AND ps_partkey = l_partkey AND p_partkey = l_partkey AND o_orderkey = l_orderkey AND s_nationkey = n_nationkey AND p_name LIKE '%green%') AS profit GROUP BY nation, o_year ORDER BY nation, o_year DESC;
   query_id  ...                                               plan
0         5  ...  {"name": "PROJECTION", "opid": "19", "children...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               SELECT nation, o_year, sum(amount) AS sum_prof...
size_bytes_max                                                8063181
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "PROJECTION", "opid": "19", "children...
Name: 0, dtype: object
{"name": "PROJECTION", "opid": "19", "children": [{"name": "ORDER_BY", "opid": "18", "children": [{"name": "PROJECTION", "opid": "17", "children": [{"name": "PROJECTION", "opid": "16", "children": [{"name": "HASH_GROUP_BY", "opid": "15", "children": [{"name": "PROJECTION", "opid": "14", "children": [{"name": "PROJECTION", "opid": "13", "children": [{"name": "PROJECTION", "opid": "12", "children": [{"name": "HASH_JOIN", "opid": "11", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "orders","extra": "orders\n[INFOSEPARATOR]\no_orderkey\no_orderdate\n[INFOSEPARATOR]\nEC: 1500000"},{"name": "HASH_JOIN", "opid": "10", "children": [{"name": "SEQ_SCAN ", "opid": "1", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_suppkey\nl_partkey\nl_orderkey\nl_extendedprice\nl_discount\nl_quantity\n[INFOSEPARATOR]\nEC: 6001215"},{"name": "HASH_JOIN", "opid": "9", "children": [{"name": "HASH_JOIN", "opid": "5", "children": [{"name": "SEQ_SCAN ", "opid": "2", "children": [],"table": "partsupp","extra": "partsupp\n[INFOSEPARATOR]\nps_suppkey\nps_partkey\nps_supplycost\n[INFOSEPARATOR]\nEC: 800000"},{"name": "FILTER", "opid": "4", "children": [{"name": "SEQ_SCAN ", "opid": "3", "children": [],"table": "part","extra": "part\n[INFOSEPARATOR]\np_partkey\np_name\n[INFOSEPARATOR]\nEC: 40000"}],"table": "","extra": "contains(p_name, 'green')\n[INFOSEPARATOR]\nEC: 40000"}],"table": "","extra": "INNER\nps_partkey = p_partkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 85503\n"},{"name": "HASH_JOIN", "opid": "8", "children": [{"name": "SEQ_SCAN ", "opid": "6", "children": [],"table": "supplier","extra": "supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\n[INFOSEPARATOR]\nEC: 10000"},{"name": "SEQ_SCAN ", "opid": "7", "children": [],"table": "nation","extra": "nation\n[INFOSEPARATOR]\nn_nationkey\nn_name\n[INFOSEPARATOR]\nEC: 25"}],"table": "","extra": "INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 10000\n"}],"table": "","extra": "INNER\nps_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 74312\n"}],"table": "","extra": "INNER\nl_suppkey = ps_suppkey\nl_partkey = ps_partkey\n\n[INFOSEPARATOR]\nEC: 1191610\n"}],"table": "","extra": "INNER\no_orderkey = l_orderkey\n\n[INFOSEPARATOR]\nEC: 1191610\n"}],"table": "","extra": "nation\nyear(o_orderdate)\namount\n"}],"table": "","extra": "__internal_compress_string_hugeint(#0)\n__internal_compress_integral_utinyint(#1, 1992)\n#2\n"}],"table": "","extra": "nation\no_year\namount\n"}],"table": "","extra": "#0\n#1\nsum(#2)"}],"table": "","extra": "__internal_decompress_string(#0)\n__internal_decompress_integral_bigint(#1, 1992)\n#2\n"}],"table": "","extra": "__internal_compress_string_hugeint(#0)\n__internal_compress_integral_utinyint(#1, 1992)\n#2\n"}],"table": "","extra": "ORDERS:\nprofit.nation ASC\nprofit.o_year DESC"}],"table": "","extra": "__internal_decompress_string(#0)\n__internal_decompress_integral_bigint(#1, 1992)\n#2\n"}
%%%%%%%%%%%%%%%% Running Query #  10  threads:  8
SELECT c_custkey, c_name, sum(l_extendedprice * (1 - l_discount)) AS revenue, c_acctbal, n_name, c_address, c_phone, c_comment FROM customer, orders, lineitem, nation WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate >= CAST('1993-10-01' AS date) AND o_orderdate < CAST('1994-01-01' AS date) AND l_returnflag = 'R' AND c_nationkey = n_nationkey GROUP BY c_custkey, c_name, c_acctbal, c_phone, n_name, c_address, c_comment ORDER BY revenue DESC LIMIT 20;
Run:  None SELECT c_custkey, c_name, sum(l_extendedprice * (1 - l_discount)) AS revenue, c_acctbal, n_name, c_address, c_phone, c_comment FROM customer, orders, lineitem, nation WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate >= CAST('1993-10-01' AS date) AND o_orderdate < CAST('1994-01-01' AS date) AND l_returnflag = 'R' AND c_nationkey = n_nationkey GROUP BY c_custkey, c_name, c_acctbal, c_phone, n_name, c_address, c_comment ORDER BY revenue DESC LIMIT 20;
Avg Time in sec:  0.17483735596761107  output size:  20
    c_custkey  ...                                          c_comment
0       57040  ...  ep. blithely regular foxes promise slyly furio...
1      143347  ...  endencies sleep. slyly express deposits nag ca...
2       60838  ...   tes. final instructions nag quickly according to
3      101998  ...  ost carefully. slyly regular packages cajole a...
4      125341  ...  ly furiously brave packages. quickly regular d...
5       25501  ...  y ironic foxes hinder according to the furious...
6      115831  ...  unts nag carefully final packages. express the...
7       84223  ...  longside of the slyly final deposits. blithely...
8       54289  ...      cajole furiously after the quickly unusual fo
9       39922  ...  ironic deposits sublate furiously. carefully r...
10       6226  ...  nal packages are alongside of the quickly bold...
11        922  ...                cuses cajole carefully regular idea
12     147946  ...  ly pending platelets. ironic requests haggle a...
13     115640  ...             ffily ironic deposits. blithely specia
14      73606  ...                 uests cajole according to the foxe
15     110246  ...        ow carefully. blithely careful packages hag
16     142549  ...  . slyly bold packages nag quickly against the ...
17     146149  ...  nic, special instructions. multipliers run car...
18      52528  ...  olphins. blithely silent platelets affix caref...
19      23431  ...    the final sentiments. carefully ironic packages

[20 rows x 8 columns]
{'name': 'Query', 'result': 0.161035, 'timing': 0.161035, 'cardinality': 0, 'extra-info': "SELECT c_custkey, c_name, sum(l_extendedprice * (1 - l_discount)) AS revenue, c_acctbal, n_name, c_address, c_phone, c_comment FROM customer, orders, lineitem, nation WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate >= CAST('1993-10-01' AS date) AND o_orderdate < CAST('1994-01-01' AS date) AND l_returnflag = 'R' AND c_nationkey = n_nationkey GROUP BY c_custkey, c_name, c_acctbal, c_phone, n_name, c_address, c_comment ORDER BY revenue DESC LIMIT 20;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 2.6e-05, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'LIMIT', 'timing': 0.000301, 'cardinality': 20, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 0.000864, 'cardinality': 16384, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n#1\n#2\n#3\n__internal_decompress_string(#4)\n#5\n__internal_decompress_string(#6)\n#7\n', 'children': [{'name': 'ORDER_BY', 'timing': 0.008299, 'cardinality': 16384, 'extra_info': 'ORDERS:\nsum((lineitem.l_extendedprice * (1 - lineitem.l_discount))) DESC', 'children': [{'name': 'PROJECTION', 'timing': 0.001349, 'cardinality': 37967, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n#1\n#2\n#3\n__internal_compress_string_hugeint(#4)\n#5\n__internal_compress_string_hugeint(#6)\n#7\n', 'children': [{'name': 'PROJECTION', 'timing': 3.1e-05, 'cardinality': 37967, 'extra_info': 'c_custkey\nc_name\nrevenue\nc_acctbal\nn_name\nc_address\nc_phone\nc_comment\n', 'children': [{'name': 'PROJECTION', 'timing': 0.001891, 'cardinality': 37967, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n#1\n#2\n__internal_decompress_string(#3)\n__internal_decompress_string(#4)\n#5\n#6\n#7\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.055295, 'cardinality': 37967, 'extra_info': '#0\n#1\n#2\n#3\n#4\n#5\n#6\nsum(#7)', 'children': [{'name': 'PROJECTION', 'timing': 0.000787, 'cardinality': 114705, 'extra_info': 'c_custkey\nc_name\nc_acctbal\nc_phone\nn_name\nc_address\nc_comment\n(l_extendedprice * (1.00 - l_discount))\n', 'children': [{'name': 'PROJECTION', 'timing': 0.005047, 'cardinality': 114705, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n#1\n#2\n__internal_compress_integral_uinteger(#3, 1)\n__internal_compress_integral_uinteger(#4, 1)\n#5\n#6\n__internal_compress_string_hugeint(#7)\n#8\n#9\n__internal_compress_string_hugeint(#10)\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.209006, 'cardinality': 114705, 'extra_info': 'INNER\nl_orderkey = o_orderkey\n\n[INFOSEPARATOR]\nEC: 241245\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.171545, 'cardinality': 1478870, 'extra_info': "lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nFilters: l_returnflag='R' AND l_returnflag IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 2000405", 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.056772, 'cardinality': 57069, 'extra_info': 'INNER\no_custkey = c_custkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 149999\n\n[INFOSEPARATOR]\nEC: 180897\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.031572, 'cardinality': 57069, 'extra_info': "orders\n[INFOSEPARATOR]\no_custkey\no_orderkey\n[INFOSEPARATOR]\nFilters: o_orderdate>='1993-10-01'::DATE AND o_orderdate<'1994-01-01'::DATE AND o_orderdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 300000", 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.007132, 'cardinality': 149999, 'extra_info': 'INNER\nc_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nEC: 150000\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.019536, 'cardinality': 149999, 'extra_info': 'customer\n[INFOSEPARATOR]\nc_custkey\nc_nationkey\nc_name\nc_acctbal\nc_phone\nc_address\nc_comment\n[INFOSEPARATOR]\nFilters: c_custkey<=149999 AND c_custkey IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 150000', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 1.8e-05, 'cardinality': 25, 'extra_info': 'nation\n[INFOSEPARATOR]\nn_nationkey\nn_name\n[INFOSEPARATOR]\nEC: 25', 'children': []}]}]}]}]}]}]}]}]}]}]}]}]}]}]}
compressed filter_log_size: 2240
compressed filter_log_buffer_size: 0
compressed limit_offset_size: 2384
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 573865
compressed perfect_full_scan_ht_log_buffer_size: 571241
compressed perfect_probe_ht_log_size: 189387
compressed perfect_probe_ht_log_buffer_size: 175492
compressed row_group_log_size: 944510
compressed row_group_log_buffer_size: 886993
compressed scatter_log_size: 430970
compressed scatter_log_buffer_size: 427388
compressed scatter_sel_log_size: 1038750
compressed scatter_sel_log_buffer_size: 1026029
compressed gather_log_size: 2240
compressed gather_log_buffer_size: 0
compressed combine_log_size: 542379
compressed combine_log_buffer_size: 538621
compressed finalize_states_log_size: 69258
compressed finalize_states_log_buffer_size: 65784
compressed join_gather_log_size: 1561431
compressed join_gather_log_buffer_size: 1458230
compressed reorder_log_size: 71640
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 2240
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 2240
compressed nlj_log_buffer_size: 0
compressed total_size: 5433534
compressed total_buffer_size: 5149778
compressed total_element_size: 283756

Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│__internal_decompress_integ│                                                                                                                                                 
│     ral_bigint(#0, 1)     │                                                                                                                                                 
│             #1            │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│          ORDER_BY         │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│          ORDERS:          │                                                                                                                                                 
│sum((partsupp.ps_supplycost│                                                                                                                                                 
│  * partsupp.ps_availqty)) │                                                                                                                                                 
│            DESC           │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│__internal_compress_integra│                                                                                                                                                 
│     l_uinteger(#0, 1)     │                                                                                                                                                 
│             #1            │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│         ps_partkey        │                                                                                                                                                 
│           value           │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│      NESTED_LOOP_JOIN     │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│           INNER           │                                                                                                                                                 
│       CAST(sum((CAST      │                                                                                                                                                 
│(ps_supplycost AS DECI...  │                                                                                                                                                 
│(ps_availqty AS DECIMA...  ├────────────────────────────────────────────────────────────────────────┐                                                                        
│ )))) AS DECIMAL(38,11)) > │                                                                        │                                                                        
│          SUBQUERY         │                                                                        │                                                                        
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                        │                                                                        
│           EC: 1           │                                                                        │                                                                        
└─────────────┬─────────────┘                                                                        │                                                                                                     
┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐                                                          
│         PROJECTION        │                                                          │    UNGROUPED_AGGREGATE    │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│__internal_decompress_integ│                                                          │         first(#0)         │                                                          
│     ral_bigint(#0, 1)     │                                                          │                           │                                                          
│             #1            │                                                          │                           │                                                          
└─────────────┬─────────────┘                                                          └─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐                                                          
│       HASH_GROUP_BY       │                                                          │         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│             #0            │                                                          │             #0            │                                                          
│          sum(#1)          │                                                          │                           │                                                          
└─────────────┬─────────────┘                                                          └─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐                                                          
│         PROJECTION        │                                                          │      STREAMING_LIMIT      │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │                           │                                                          
│         ps_partkey        │                                                          │                           │                                                          
│   (CAST(ps_supplycost AS  │                                                          │                           │                                                          
│    DECIMAL(34,2)) * CAST  │                                                          │                           │                                                          
│(ps_availqty AS DECIMA...  │                                                          │                           │                                                          
└─────────────┬─────────────┘                                                          └─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐                                                          
│         PROJECTION        │                                                          │         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│__internal_compress_integra│                                                          │(sum((CAST(ps_supplycost AS│                                                          
│     l_usmallint(#0, 1)    │                                                          │    DECIMAL(34,2)) * CAST  │                                                          
│__internal_compress_integra│                                                          │(ps_availqty AS DECIMA...  │                                                          
│     l_uinteger(#1, 1)     │                                                          │       * 0.000100000)      │                                                          
│             #2            │                                                          │                           │                                                          
│             #3            │                                                          │                           │                                                          
│__internal_compress_integra│                                                          │                           │                                                          
│     l_usmallint(#4, 1)    │                                                          │                           │                                                          
└─────────────┬─────────────┘                                                          └─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐                                                          
│         HASH_JOIN         │                                                          │    UNGROUPED_AGGREGATE    │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│           INNER           │                                                          │          sum(#0)          │                                                          
│   ps_suppkey = s_suppkey  │                                                          │                           │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐                                           │                           │                                                          
│        Build Min: 1       │              │                                           │                           │                                                          
│      Build Max: 10000     │              │                                           │                           │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                           │                           │                                                          
│         EC: 27811         │              │                                           │                           │                                                          
└─────────────┬─────────────┘              │                                           └─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐                                                          
│         SEQ_SCAN          ││         HASH_JOIN         │                             │         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│          partsupp         ││           INNER           │                             │   (CAST(ps_supplycost AS  │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││ s_nationkey = n_nationkey │                             │    DECIMAL(34,2)) * CAST  │                                                          
│         ps_suppkey        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │(ps_availqty AS DECIMA...  │                                                          
│         ps_partkey        ││        Build Min: 0       ├──────────────┐              │                           │                                                          
│       ps_supplycost       ││       Build Max: 24       │              │              │                           │                                                          
│        ps_availqty        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              │                           │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││          EC: 400          │              │              │                           │                                                          
│         EC: 800000        ││                           │              │              │                           │                                                          
└───────────────────────────┘└─────────────┬─────────────┘              │              └─────────────┬─────────────┘                                                                                       
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                          
                             │         SEQ_SCAN          ││         SEQ_SCAN          ││         HASH_JOIN         │                                                          
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                             │          supplier         ││           nation          ││           INNER           │                                                          
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ps_suppkey = s_suppkey  │                                                          
                             │         s_suppkey         ││        n_nationkey        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                             │        s_nationkey        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││        Build Min: 1       ├──────────────┐                                           
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││ Filters: n_name='GERMANY' ││      Build Max: 10000     │              │                                           
                             │         EC: 10000         ││   AND n_name IS NOT NULL  ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                           
                             │                           ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││         EC: 27811         │              │                                           
                             │                           ││           EC: 1           ││                           │              │                                           
                             └───────────────────────────┘└───────────────────────────┘└─────────────┬─────────────┘              │                                                                        
                                                                                       ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             
                                                                                       │         SEQ_SCAN          ││         HASH_JOIN         │                             
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                                                                                       │          partsupp         ││           INNER           │                             
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││ s_nationkey = n_nationkey │                             
                                                                                       │         ps_suppkey        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐              
                                                                                       │       ps_supplycost       ││        Build Min: 0       │              │              
                                                                                       │        ps_availqty        ││       Build Max: 24       │              │              
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              
                                                                                       │         EC: 800000        ││          EC: 400          │              │              
                                                                                       └───────────────────────────┘└─────────────┬─────────────┘              │                                           
                                                                                                                    ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
                                                                                                                    │         SEQ_SCAN          ││         SEQ_SCAN          │
                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                                                    │          supplier         ││           nation          │
                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                                                    │         s_suppkey         ││        n_nationkey        │
                                                                                                                    │        s_nationkey        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││ Filters: n_name='GERMANY' │
                                                                                                                    │         EC: 10000         ││   AND n_name IS NOT NULL  │
                                                                                                                    │                           ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                                                    │                           ││           EC: 1           │
                                                                                                                    └───────────────────────────┘└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

X {'RESULT_COLLECTOR0': 2.6e-05, 'LIMIT1': 0.000301, 'PROJECTION2': 0.000864, 'ORDER_BY3': 0.008299, 'PROJECTION4': 0.001349, 'PROJECTION5': 3.1e-05, 'PROJECTION6': 0.001891, 'HASH_GROUP_BY7': 0.055295, 'PROJECTION8': 0.000787, 'PROJECTION9': 0.005047, 'HASH_JOIN10': 0.209006, 'SEQ_SCAN 11': 0.171545, 'HASH_JOIN12': 0.056772, 'SEQ_SCAN 13': 0.031572, 'HASH_JOIN14': 0.007132, 'SEQ_SCAN 15': 0.019536, 'SEQ_SCAN 16': 1.8e-05}
**** output size:  20
LINEAGE_5_HASH_GROUP_BY_9
LINEAGE_5_HASH_JOIN_4
LINEAGE_5_HASH_JOIN_5
LINEAGE_5_HASH_JOIN_6
LINEAGE_5_LIMIT_15
LINEAGE_5_ORDER_BY_13
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_1
LINEAGE_5_SEQ_SCAN_2
LINEAGE_5_SEQ_SCAN_3
SELECT c_custkey, c_name, sum(l_extendedprice * (1 - l_discount)) AS revenue, c_acctbal, n_name, c_address, c_phone, c_comment FROM customer, orders, lineitem, nation WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate >= CAST('1993-10-01' AS date) AND o_orderdate < CAST('1994-01-01' AS date) AND l_returnflag = 'R' AND c_nationkey = n_nationkey GROUP BY c_custkey, c_name, c_acctbal, c_phone, n_name, c_address, c_comment ORDER BY revenue DESC LIMIT 20;
   query_id  ...                                               plan
0         5  ...  {"name": "LIMIT", "opid": "15", "children": [{...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               SELECT c_custkey, c_name, sum(l_extendedprice ...
size_bytes_max                                                5433534
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "LIMIT", "opid": "15", "children": [{...
Name: 0, dtype: object
{"name": "LIMIT", "opid": "15", "children": [{"name": "PROJECTION", "opid": "14", "children": [{"name": "ORDER_BY", "opid": "13", "children": [{"name": "PROJECTION", "opid": "12", "children": [{"name": "PROJECTION", "opid": "11", "children": [{"name": "PROJECTION", "opid": "10", "children": [{"name": "HASH_GROUP_BY", "opid": "9", "children": [{"name": "PROJECTION", "opid": "8", "children": [{"name": "PROJECTION", "opid": "7", "children": [{"name": "HASH_JOIN", "opid": "6", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nFilters: l_returnflag='R' AND l_returnflag IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 2000405"},{"name": "HASH_JOIN", "opid": "5", "children": [{"name": "SEQ_SCAN ", "opid": "1", "children": [],"table": "orders","extra": "orders\n[INFOSEPARATOR]\no_custkey\no_orderkey\n[INFOSEPARATOR]\nFilters: o_orderdate>='1993-10-01'::DATE AND o_orderdate<'1994-01-01'::DATE AND o_orderdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 300000"},{"name": "HASH_JOIN", "opid": "4", "children": [{"name": "SEQ_SCAN ", "opid": "2", "children": [],"table": "customer","extra": "customer\n[INFOSEPARATOR]\nc_custkey\nc_nationkey\nc_name\nc_acctbal\nc_phone\nc_address\nc_comment\n[INFOSEPARATOR]\nFilters: c_custkey<=149999 AND c_custkey IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 150000"},{"name": "SEQ_SCAN ", "opid": "3", "children": [],"table": "nation","extra": "nation\n[INFOSEPARATOR]\nn_nationkey\nn_name\n[INFOSEPARATOR]\nEC: 25"}],"table": "","extra": "INNER\nc_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nEC: 150000\n"}],"table": "","extra": "INNER\no_custkey = c_custkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 149999\n\n[INFOSEPARATOR]\nEC: 180897\n"}],"table": "","extra": "INNER\nl_orderkey = o_orderkey\n\n[INFOSEPARATOR]\nEC: 241245\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n#1\n#2\n__internal_compress_integral_uinteger(#3, 1)\n__internal_compress_integral_uinteger(#4, 1)\n#5\n#6\n__internal_compress_string_hugeint(#7)\n#8\n#9\n__internal_compress_string_hugeint(#10)\n"}],"table": "","extra": "c_custkey\nc_name\nc_acctbal\nc_phone\nn_name\nc_address\nc_comment\n(l_extendedprice * (1.00 - l_discount))\n"}],"table": "","extra": "#0\n#1\n#2\n#3\n#4\n#5\n#6\nsum(#7)"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n#1\n#2\n__internal_decompress_string(#3)\n__internal_decompress_string(#4)\n#5\n#6\n#7\n"}],"table": "","extra": "c_custkey\nc_name\nrevenue\nc_acctbal\nn_name\nc_address\nc_phone\nc_comment\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n#1\n#2\n#3\n__internal_compress_string_hugeint(#4)\n#5\n__internal_compress_string_hugeint(#6)\n#7\n"}],"table": "","extra": "ORDERS:\nsum((lineitem.l_extendedprice * (1 - lineitem.l_discount))) DESC"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n#1\n#2\n#3\n__internal_decompress_string(#4)\n#5\n__internal_decompress_string(#6)\n#7\n"}],"table": "","extra": ""}
%%%%%%%%%%%%%%%% Running Query #  11  threads:  8
SELECT ps_partkey, sum(ps_supplycost * ps_availqty) AS value FROM partsupp, supplier, nation WHERE ps_suppkey = s_suppkey AND s_nationkey = n_nationkey AND n_name = 'GERMANY' GROUP BY ps_partkey HAVING sum(ps_supplycost * ps_availqty) > ( SELECT sum(ps_supplycost * ps_availqty) * 0.000100000 FROM partsupp, supplier, nation WHERE ps_suppkey = s_suppkey AND s_nationkey = n_nationkey AND n_name = 'GERMANY') ORDER BY value DESC;
Run:  None SELECT ps_partkey, sum(ps_supplycost * ps_availqty) AS value FROM partsupp, supplier, nation WHERE ps_suppkey = s_suppkey AND s_nationkey = n_nationkey AND n_name = 'GERMANY' GROUP BY ps_partkey HAVING sum(ps_supplycost * ps_availqty) > ( SELECT sum(ps_supplycost * ps_availqty) * 0.000100000 FROM partsupp, supplier, nation WHERE ps_suppkey = s_suppkey AND s_nationkey = n_nationkey AND n_name = 'GERMANY') ORDER BY value DESC;
Avg Time in sec:  0.021027748007327318  output size:  1048
      ps_partkey        value
0         129760  17538456.86
1         166726  16503353.92
2         191287  16474801.97
3         161758  16101755.54
4          34452  15983844.72
...          ...          ...
1043      154731   7888301.33
1044      101674   7879324.60
1045       51968   7879102.21
1046       72073   7877736.11
1047        5182   7874521.73

[1048 rows x 2 columns]
{'name': 'Query', 'result': 0.016137, 'timing': 0.016137, 'cardinality': 0, 'extra-info': "SELECT ps_partkey, sum(ps_supplycost * ps_availqty) AS value FROM partsupp, supplier, nation WHERE ps_suppkey = s_suppkey AND s_nationkey = n_nationkey AND n_name = 'GERMANY' GROUP BY ps_partkey HAVING sum(ps_supplycost * ps_availqty) > ( SELECT sum(ps_supplycost * ps_availqty) * 0.000100000 FROM partsupp, supplier, nation WHERE ps_suppkey = s_suppkey AND s_nationkey = n_nationkey AND n_name = 'GERMANY') ORDER BY value DESC;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 2.9e-05, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 1.1e-05, 'cardinality': 1048, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n#1\n', 'children': [{'name': 'ORDER_BY', 'timing': 0.000301, 'cardinality': 1048, 'extra_info': 'ORDERS:\nsum((partsupp.ps_supplycost * partsupp.ps_availqty)) DESC', 'children': [{'name': 'PROJECTION', 'timing': 4.2e-05, 'cardinality': 1048, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n#1\n', 'children': [{'name': 'PROJECTION', 'timing': 1.1e-05, 'cardinality': 1048, 'extra_info': 'ps_partkey\nvalue\n', 'children': [{'name': 'NESTED_LOOP_JOIN', 'timing': 0.001801, 'cardinality': 1048, 'extra_info': 'INNER\nCAST(sum((CAST(ps_supplycost AS DECIMAL(34,2)) * CAST(ps_availqty AS DECIMAL(34,0)))) AS DECIMAL(38,11)) > SUBQUERY\n\n[INFOSEPARATOR]\nEC: 1\n', 'children': [{'name': 'PROJECTION', 'timing': 8.4e-05, 'cardinality': 29818, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n#1\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.021898, 'cardinality': 29818, 'extra_info': '#0\nsum(#1)', 'children': [{'name': 'PROJECTION', 'timing': 0.011312, 'cardinality': 31680, 'extra_info': 'ps_partkey\n(CAST(ps_supplycost AS DECIMAL(34,2)) * CAST(ps_availqty AS DECIMAL(34,0)))\n', 'children': [{'name': 'PROJECTION', 'timing': 0.003301, 'cardinality': 31680, 'extra_info': '__internal_compress_integral_usmallint(#0, 1)\n__internal_compress_integral_uinteger(#1, 1)\n#2\n#3\n__internal_compress_integral_usmallint(#4, 1)\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.011088, 'cardinality': 31680, 'extra_info': 'INNER\nps_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 27811\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.00347, 'cardinality': 800000, 'extra_info': 'partsupp\n[INFOSEPARATOR]\nps_suppkey\nps_partkey\nps_supplycost\nps_availqty\n[INFOSEPARATOR]\nEC: 800000', 'children': []}, {'name': 'HASH_JOIN', 'timing': 9e-05, 'cardinality': 396, 'extra_info': 'INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 400\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 3.5e-05, 'cardinality': 10000, 'extra_info': 'supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\n[INFOSEPARATOR]\nEC: 10000', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 2.8e-05, 'cardinality': 1, 'extra_info': "nation\n[INFOSEPARATOR]\nn_nationkey\n[INFOSEPARATOR]\nFilters: n_name='GERMANY' AND n_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1", 'children': []}]}]}]}]}]}]}, {'name': 'UNGROUPED_AGGREGATE', 'timing': 2e-06, 'cardinality': 1, 'extra_info': 'first(#0)', 'children': [{'name': 'PROJECTION', 'timing': 0.0, 'cardinality': 1, 'extra_info': '#0\n', 'children': [{'name': 'STREAMING_LIMIT', 'timing': 2e-06, 'cardinality': 1, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 4e-06, 'cardinality': 1, 'extra_info': '(sum((CAST(ps_supplycost AS DECIMAL(34,2)) * CAST(ps_availqty AS DECIMAL(34,0)))) * 0.000100000)\n', 'children': [{'name': 'UNGROUPED_AGGREGATE', 'timing': 0.000877, 'cardinality': 1, 'extra_info': 'sum(#0)', 'children': [{'name': 'PROJECTION', 'timing': 0.007657, 'cardinality': 31680, 'extra_info': '(CAST(ps_supplycost AS DECIMAL(34,2)) * CAST(ps_availqty AS DECIMAL(34,0)))\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.008445, 'cardinality': 31680, 'extra_info': 'INNER\nps_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 27811\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.002511, 'cardinality': 800000, 'extra_info': 'partsupp\n[INFOSEPARATOR]\nps_suppkey\nps_supplycost\nps_availqty\n[INFOSEPARATOR]\nEC: 800000', 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.000211, 'cardinality': 396, 'extra_info': 'INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 400\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 6.8e-05, 'cardinality': 10000, 'extra_info': 'supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\n[INFOSEPARATOR]\nEC: 10000', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 5.2e-05, 'cardinality': 1, 'extra_info': "nation\n[INFOSEPARATOR]\nn_nationkey\n[INFOSEPARATOR]\nFilters: n_name='GERMANY' AND n_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1", 'children': []}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}
compressed filter_log_size: 2480
compressed filter_log_buffer_size: 0
compressed limit_offset_size: 2624
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 6440
compressed perfect_full_scan_ht_log_buffer_size: 2424
compressed perfect_probe_ht_log_size: 312325
compressed perfect_probe_ht_log_buffer_size: 294442
compressed row_group_log_size: 10604
compressed row_group_log_buffer_size: 8
compressed scatter_log_size: 131318
compressed scatter_log_buffer_size: 126170
compressed scatter_sel_log_size: 8057
compressed scatter_sel_log_buffer_size: 4581
compressed gather_log_size: 2480
compressed gather_log_buffer_size: 0
compressed combine_log_size: 10515
compressed combine_log_buffer_size: 6608
compressed finalize_states_log_size: 8391
compressed finalize_states_log_buffer_size: 4755
compressed join_gather_log_size: 2480
compressed join_gather_log_buffer_size: 0
compressed reorder_log_size: 5441
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 2480
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 8819
compressed nlj_log_buffer_size: 2879
compressed total_size: 514454
compressed total_buffer_size: 441867
compressed total_element_size: 72587

Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│__internal_decompress_strin│                             
│           g(#0)           │                             
│             #1            │                             
│             #2            │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│          ORDER_BY         │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│          ORDERS:          │                             
│  lineitem.l_shipmode ASC  │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│__internal_compress_string_│                             
│        ubigint(#0)        │                             
│             #1            │                             
│             #2            │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│__internal_decompress_strin│                             
│           g(#0)           │                             
│             #1            │                             
│             #2            │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│       HASH_GROUP_BY       │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│             #0            │                             
│          sum(#1)          │                             
│          sum(#2)          │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│         l_shipmode        │                             
│       CASE  WHEN ((       │                             
│(o_orderpriority = '1-...  │                             
│(o_orderpriority = '2-...  │                             
│     THEN (1) ELSE 0 END   │                             
│       CASE  WHEN ((       │                             
│(o_orderpriority != '1...  │                             
│(o_orderpriority != '2...  │                             
│     THEN (1) ELSE 0 END   │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│__internal_compress_integra│                             
│     l_uinteger(#0, 1)     │                             
│             #1            │                             
│__internal_compress_integra│                             
│     l_uinteger(#2, 1)     │                             
│__internal_compress_string_│                             
│        ubigint(#3)        │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         HASH_JOIN         │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│           INNER           │                             
│  o_orderkey = l_orderkey  ├──────────────┐              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              
│         EC: 240048        │              │              
└─────────────┬─────────────┘              │                                           
┌─────────────┴─────────────┐┌─────────────┴─────────────┐
│         SEQ_SCAN          ││           FILTER          │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│           orders          ││      ((l_commitdate <     │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││ l_receiptdate) AND (l...  │
│         o_orderkey        ││ l_commitdate) AND ((l...  │
│      o_orderpriority      ││= 'MAIL') OR (l_shipmode = │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││         'SHIP')))         │
│        EC: 1500000        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│                           ││         EC: 240048        │
└───────────────────────────┘└─────────────┬─────────────┘                             
                             ┌─────────────┴─────────────┐
                             │         SEQ_SCAN          │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                             │          lineitem         │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                             │         l_orderkey        │
                             │         l_shipmode        │
                             │        l_commitdate       │
                             │       l_receiptdate       │
                             │         l_shipdate        │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                             │  Filters: l_receiptdate>= │
                             │   '1994-01-01'::DATE AND  │
                             │ l_receiptdate<'1995-0...  │
                             │  AND l_receiptdate IS NOT │
                             │            NULL           │
                             │ l_commitdate<'1995-01-01':│
                             │ :DATE AND l_commitdate IS │
                             │          NOT NULL         │
                             │  l_shipdate<'1995-01-01': │
                             │:DATE AND l_shipdate IS NOT│
                             │            NULL           │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                             │         EC: 240048        │
                             └───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

X {'RESULT_COLLECTOR0': 2.9e-05, 'PROJECTION1': 1.1e-05, 'ORDER_BY2': 0.000301, 'PROJECTION3': 4.2e-05, 'PROJECTION4': 1.1e-05, 'NESTED_LOOP_JOIN5': 0.001801, 'PROJECTION6': 8.4e-05, 'HASH_GROUP_BY7': 0.021898, 'PROJECTION8': 0.011312, 'PROJECTION9': 0.003301, 'HASH_JOIN10': 0.011088, 'SEQ_SCAN 11': 0.00347, 'HASH_JOIN12': 9e-05, 'SEQ_SCAN 13': 3.5e-05, 'SEQ_SCAN 14': 2.8e-05, 'UNGROUPED_AGGREGATE15': 2e-06, 'PROJECTION16': 0.0, 'STREAMING_LIMIT17': 2e-06, 'PROJECTION18': 4e-06, 'UNGROUPED_AGGREGATE19': 0.000877, 'PROJECTION20': 0.007657, 'HASH_JOIN21': 0.008445, 'SEQ_SCAN 22': 0.002511, 'HASH_JOIN23': 0.000211, 'SEQ_SCAN 24': 6.8e-05, 'SEQ_SCAN 25': 5.2e-05}
**** output size:  1048
LINEAGE_5_HASH_GROUP_BY_7
LINEAGE_5_HASH_JOIN_12
LINEAGE_5_HASH_JOIN_13
LINEAGE_5_HASH_JOIN_3
LINEAGE_5_HASH_JOIN_4
LINEAGE_5_NESTED_LOOP_JOIN_20
LINEAGE_5_ORDER_BY_23
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_1
LINEAGE_5_SEQ_SCAN_10
LINEAGE_5_SEQ_SCAN_11
LINEAGE_5_SEQ_SCAN_2
LINEAGE_5_SEQ_SCAN_9
LINEAGE_5_STREAMING_LIMIT_17
SELECT ps_partkey, sum(ps_supplycost * ps_availqty) AS value FROM partsupp, supplier, nation WHERE ps_suppkey = s_suppkey AND s_nationkey = n_nationkey AND n_name = 'GERMANY' GROUP BY ps_partkey HAVING sum(ps_supplycost * ps_availqty) > ( SELECT sum(ps_supplycost * ps_availqty) * 0.000100000 FROM partsupp, supplier, nation WHERE ps_suppkey = s_suppkey AND s_nationkey = n_nationkey AND n_name = 'GERMANY') ORDER BY value DESC;
   query_id  ...                                               plan
0         5  ...  {"name": "PROJECTION", "opid": "24", "children...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               SELECT ps_partkey, sum(ps_supplycost * ps_avai...
size_bytes_max                                                 514454
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "PROJECTION", "opid": "24", "children...
Name: 0, dtype: object
{"name": "PROJECTION", "opid": "24", "children": [{"name": "ORDER_BY", "opid": "23", "children": [{"name": "PROJECTION", "opid": "22", "children": [{"name": "PROJECTION", "opid": "21", "children": [{"name": "NESTED_LOOP_JOIN", "opid": "20", "children": [{"name": "PROJECTION", "opid": "8", "children": [{"name": "HASH_GROUP_BY", "opid": "7", "children": [{"name": "PROJECTION", "opid": "6", "children": [{"name": "PROJECTION", "opid": "5", "children": [{"name": "HASH_JOIN", "opid": "4", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "partsupp","extra": "partsupp\n[INFOSEPARATOR]\nps_suppkey\nps_partkey\nps_supplycost\nps_availqty\n[INFOSEPARATOR]\nEC: 800000"},{"name": "HASH_JOIN", "opid": "3", "children": [{"name": "SEQ_SCAN ", "opid": "1", "children": [],"table": "supplier","extra": "supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\n[INFOSEPARATOR]\nEC: 10000"},{"name": "SEQ_SCAN ", "opid": "2", "children": [],"table": "nation","extra": "nation\n[INFOSEPARATOR]\nn_nationkey\n[INFOSEPARATOR]\nFilters: n_name='GERMANY' AND n_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1"}],"table": "","extra": "INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 400\n"}],"table": "","extra": "INNER\nps_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 27811\n"}],"table": "","extra": "__internal_compress_integral_usmallint(#0, 1)\n__internal_compress_integral_uinteger(#1, 1)\n#2\n#3\n__internal_compress_integral_usmallint(#4, 1)\n"}],"table": "","extra": "ps_partkey\n(CAST(ps_supplycost AS DECIMAL(34,2)) * CAST(ps_availqty AS DECIMAL(34,0)))\n"}],"table": "","extra": "#0\nsum(#1)"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n#1\n"},{"name": "UNGROUPED_AGGREGATE", "opid": "19", "children": [{"name": "PROJECTION", "opid": "18", "children": [{"name": "STREAMING_LIMIT", "opid": "17", "children": [{"name": "PROJECTION", "opid": "16", "children": [{"name": "UNGROUPED_AGGREGATE", "opid": "15", "children": [{"name": "PROJECTION", "opid": "14", "children": [{"name": "HASH_JOIN", "opid": "13", "children": [{"name": "SEQ_SCAN ", "opid": "9", "children": [],"table": "partsupp","extra": "partsupp\n[INFOSEPARATOR]\nps_suppkey\nps_supplycost\nps_availqty\n[INFOSEPARATOR]\nEC: 800000"},{"name": "HASH_JOIN", "opid": "12", "children": [{"name": "SEQ_SCAN ", "opid": "10", "children": [],"table": "supplier","extra": "supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\n[INFOSEPARATOR]\nEC: 10000"},{"name": "SEQ_SCAN ", "opid": "11", "children": [],"table": "nation","extra": "nation\n[INFOSEPARATOR]\nn_nationkey\n[INFOSEPARATOR]\nFilters: n_name='GERMANY' AND n_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1"}],"table": "","extra": "INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 400\n"}],"table": "","extra": "INNER\nps_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 27811\n"}],"table": "","extra": "(CAST(ps_supplycost AS DECIMAL(34,2)) * CAST(ps_availqty AS DECIMAL(34,0)))\n"}],"table": "","extra": "sum(#0)"}],"table": "","extra": "(sum((CAST(ps_supplycost AS DECIMAL(34,2)) * CAST(ps_availqty AS DECIMAL(34,0)))) * 0.000100000)\n"}],"table": "","extra": ""}],"table": "","extra": "#0\n"}],"table": "","extra": "first(#0)"}],"table": "","extra": "INNER\nCAST(sum((CAST(ps_supplycost AS DECIMAL(34,2)) * CAST(ps_availqty AS DECIMAL(34,0)))) AS DECIMAL(38,11)) > SUBQUERY\n\n[INFOSEPARATOR]\nEC: 1\n"}],"table": "","extra": "ps_partkey\nvalue\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n#1\n"}],"table": "","extra": "ORDERS:\nsum((partsupp.ps_supplycost * partsupp.ps_availqty)) DESC"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n#1\n"}
%%%%%%%%%%%%%%%% Running Query #  12  threads:  8
SELECT l_shipmode, sum( CASE WHEN o_orderpriority = '1-URGENT' OR o_orderpriority = '2-HIGH' THEN 1 ELSE 0 END) AS high_line_count, sum( CASE WHEN o_orderpriority <> '1-URGENT' AND o_orderpriority <> '2-HIGH' THEN 1 ELSE 0 END) AS low_line_count FROM orders, lineitem WHERE o_orderkey = l_orderkey AND l_shipmode IN ('MAIL', 'SHIP') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= CAST('1994-01-01' AS date) AND l_receiptdate < CAST('1995-01-01' AS date) GROUP BY l_shipmode ORDER BY l_shipmode;
Run:  None SELECT l_shipmode, sum( CASE WHEN o_orderpriority = '1-URGENT' OR o_orderpriority = '2-HIGH' THEN 1 ELSE 0 END) AS high_line_count, sum( CASE WHEN o_orderpriority <> '1-URGENT' AND o_orderpriority <> '2-HIGH' THEN 1 ELSE 0 END) AS low_line_count FROM orders, lineitem WHERE o_orderkey = l_orderkey AND l_shipmode IN ('MAIL', 'SHIP') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= CAST('1994-01-01' AS date) AND l_receiptdate < CAST('1995-01-01' AS date) GROUP BY l_shipmode ORDER BY l_shipmode;
Avg Time in sec:  0.060380361042916775  output size:  2
  l_shipmode  high_line_count  low_line_count
0       MAIL           6202.0          9324.0
1       SHIP           6200.0          9262.0
{'name': 'Query', 'result': 0.054275, 'timing': 0.054275, 'cardinality': 0, 'extra-info': "SELECT l_shipmode, sum( CASE WHEN o_orderpriority = '1-URGENT' OR o_orderpriority = '2-HIGH' THEN 1 ELSE 0 END) AS high_line_count, sum( CASE WHEN o_orderpriority <> '1-URGENT' AND o_orderpriority <> '2-HIGH' THEN 1 ELSE 0 END) AS low_line_count FROM orders, lineitem WHERE o_orderkey = l_orderkey AND l_shipmode IN ('MAIL', 'SHIP') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= CAST('1994-01-01' AS date) AND l_receiptdate < CAST('1995-01-01' AS date) GROUP BY l_shipmode ORDER BY l_shipmode;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 1.4e-05, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 3e-06, 'cardinality': 2, 'extra_info': '__internal_decompress_string(#0)\n#1\n#2\n', 'children': [{'name': 'ORDER_BY', 'timing': 4.5e-05, 'cardinality': 2, 'extra_info': 'ORDERS:\nlineitem.l_shipmode ASC', 'children': [{'name': 'PROJECTION', 'timing': 6e-06, 'cardinality': 2, 'extra_info': '__internal_compress_string_ubigint(#0)\n#1\n#2\n', 'children': [{'name': 'PROJECTION', 'timing': 5e-06, 'cardinality': 2, 'extra_info': '__internal_decompress_string(#0)\n#1\n#2\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.006482, 'cardinality': 2, 'extra_info': '#0\nsum(#1)\nsum(#2)', 'children': [{'name': 'PROJECTION', 'timing': 0.001027, 'cardinality': 30988, 'extra_info': "l_shipmode\nCASE  WHEN (((o_orderpriority = '1-URGENT') OR (o_orderpriority = '2-HIGH'))) THEN (1) ELSE 0 END\nCASE  WHEN (((o_orderpriority != '1-URGENT') AND (o_orderpriority != '2-HIGH'))) THEN (1) ELSE 0 END\n", 'children': [{'name': 'PROJECTION', 'timing': 0.000358, 'cardinality': 30988, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n#1\n__internal_compress_integral_uinteger(#2, 1)\n__internal_compress_string_ubigint(#3)\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.045955, 'cardinality': 30988, 'extra_info': 'INNER\no_orderkey = l_orderkey\n\n[INFOSEPARATOR]\nEC: 240048\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.035839, 'cardinality': 1500000, 'extra_info': 'orders\n[INFOSEPARATOR]\no_orderkey\no_orderpriority\n[INFOSEPARATOR]\nEC: 1500000', 'children': []}, {'name': 'FILTER', 'timing': 0.045645, 'cardinality': 30988, 'extra_info': "((l_commitdate < l_receiptdate) AND (l_shipdate < l_commitdate) AND ((l_shipmode = 'MAIL') OR (l_shipmode = 'SHIP')))\n[INFOSEPARATOR]\nEC: 240048", 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.232825, 'cardinality': 885773, 'extra_info': "lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_shipmode\nl_commitdate\nl_receiptdate\nl_shipdate\n[INFOSEPARATOR]\nFilters: l_receiptdate>='1994-01-01'::DATE AND l_receiptdate<'1995-01-01'::DATE AND l_receiptdate IS NOT NULL\nl_commitdate<'1995-01-01'::DATE AND l_commitdate IS NOT NULL\nl_shipdate<'1995-01-01'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 240048", 'children': []}]}]}]}]}]}]}]}]}]}]}]}
compressed filter_log_size: 159554
compressed filter_log_buffer_size: 125456
compressed limit_offset_size: 1728
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 1728
compressed perfect_full_scan_ht_log_buffer_size: 0
compressed perfect_probe_ht_log_size: 1728
compressed perfect_probe_ht_log_buffer_size: 0
compressed row_group_log_size: 684807
compressed row_group_log_buffer_size: 635605
compressed scatter_log_size: 88594
compressed scatter_log_buffer_size: 85709
compressed scatter_sel_log_size: 134152
compressed scatter_sel_log_buffer_size: 130492
compressed gather_log_size: 1728
compressed gather_log_buffer_size: 0
compressed combine_log_size: 2348
compressed combine_log_buffer_size: 256
compressed finalize_states_log_size: 2032
compressed finalize_states_log_buffer_size: 16
compressed join_gather_log_size: 332778
compressed join_gather_log_buffer_size: 295688
compressed reorder_log_size: 2752
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 1728
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 1728
compressed nlj_log_buffer_size: 0
compressed total_size: 1417385
compressed total_buffer_size: 1273222
compressed total_element_size: 144163

Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                             
│          ORDER_BY         │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│          ORDERS:          │                             
│     count_star() DESC     │                             
│   c_orders.c_count DESC   │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│       HASH_GROUP_BY       │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│             #0            │                             
│        count_star()       │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│          c_count          │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│     count(o_orderkey)     │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│__internal_decompress_integ│                             
│     ral_bigint(#0, 1)     │                             
│             #1            │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│       HASH_GROUP_BY       │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│             #0            │                             
│         count(#1)         │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│         c_custkey         │                             
│         o_orderkey        │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│__internal_compress_integra│                             
│     l_uinteger(#0, 1)     │                             
│             #1            │                             
│             #2            │                             
│__internal_compress_integra│                             
│     l_uinteger(#3, 1)     │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         HASH_JOIN         │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│           RIGHT           │                             
│   o_custkey = c_custkey   ├──────────────┐              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              
│         EC: 300000        │              │              
└─────────────┬─────────────┘              │                                           
┌─────────────┴─────────────┐┌─────────────┴─────────────┐
│           FILTER          ││         SEQ_SCAN          │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│  (o_comment !~~ '%special ││          customer         │
│        %requests%')       ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││         c_custkey         │
│         EC: 300000        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│                           ││         EC: 150000        │
└─────────────┬─────────────┘└───────────────────────────┘                             
┌─────────────┴─────────────┐                             
│         SEQ_SCAN          │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│           orders          │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│         o_custkey         │                             
│         o_comment         │                             
│         o_orderkey        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│        EC: 1500000        │                             
└───────────────────────────┘                                                          

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

X {'RESULT_COLLECTOR0': 1.4e-05, 'PROJECTION1': 3e-06, 'ORDER_BY2': 4.5e-05, 'PROJECTION3': 6e-06, 'PROJECTION4': 5e-06, 'HASH_GROUP_BY5': 0.006482, 'PROJECTION6': 0.001027, 'PROJECTION7': 0.000358, 'HASH_JOIN8': 0.045955, 'SEQ_SCAN 9': 0.035839, 'FILTER10': 0.045645, 'SEQ_SCAN 11': 0.232825}
**** output size:  2
LINEAGE_5_FILTER_2
LINEAGE_5_HASH_GROUP_BY_6
LINEAGE_5_HASH_JOIN_3
LINEAGE_5_ORDER_BY_9
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_1
SELECT l_shipmode, sum( CASE WHEN o_orderpriority = '1-URGENT' OR o_orderpriority = '2-HIGH' THEN 1 ELSE 0 END) AS high_line_count, sum( CASE WHEN o_orderpriority <> '1-URGENT' AND o_orderpriority <> '2-HIGH' THEN 1 ELSE 0 END) AS low_line_count FROM orders, lineitem WHERE o_orderkey = l_orderkey AND l_shipmode IN ('MAIL', 'SHIP') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= CAST('1994-01-01' AS date) AND l_receiptdate < CAST('1995-01-01' AS date) GROUP BY l_shipmode ORDER BY l_shipmode;
   query_id  ...                                               plan
0         5  ...  {"name": "PROJECTION", "opid": "10", "children...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               SELECT l_shipmode, sum( CASE WHEN o_orderprior...
size_bytes_max                                                1417385
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "PROJECTION", "opid": "10", "children...
Name: 0, dtype: object
{"name": "PROJECTION", "opid": "10", "children": [{"name": "ORDER_BY", "opid": "9", "children": [{"name": "PROJECTION", "opid": "8", "children": [{"name": "PROJECTION", "opid": "7", "children": [{"name": "HASH_GROUP_BY", "opid": "6", "children": [{"name": "PROJECTION", "opid": "5", "children": [{"name": "PROJECTION", "opid": "4", "children": [{"name": "HASH_JOIN", "opid": "3", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "orders","extra": "orders\n[INFOSEPARATOR]\no_orderkey\no_orderpriority\n[INFOSEPARATOR]\nEC: 1500000"},{"name": "FILTER", "opid": "2", "children": [{"name": "SEQ_SCAN ", "opid": "1", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_shipmode\nl_commitdate\nl_receiptdate\nl_shipdate\n[INFOSEPARATOR]\nFilters: l_receiptdate>='1994-01-01'::DATE AND l_receiptdate<'1995-01-01'::DATE AND l_receiptdate IS NOT NULL\nl_commitdate<'1995-01-01'::DATE AND l_commitdate IS NOT NULL\nl_shipdate<'1995-01-01'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 240048"}],"table": "","extra": "((l_commitdate < l_receiptdate) AND (l_shipdate < l_commitdate) AND ((l_shipmode = 'MAIL') OR (l_shipmode = 'SHIP')))\n[INFOSEPARATOR]\nEC: 240048"}],"table": "","extra": "INNER\no_orderkey = l_orderkey\n\n[INFOSEPARATOR]\nEC: 240048\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n#1\n__internal_compress_integral_uinteger(#2, 1)\n__internal_compress_string_ubigint(#3)\n"}],"table": "","extra": "l_shipmode\nCASE  WHEN (((o_orderpriority = '1-URGENT') OR (o_orderpriority = '2-HIGH'))) THEN (1) ELSE 0 END\nCASE  WHEN (((o_orderpriority != '1-URGENT') AND (o_orderpriority != '2-HIGH'))) THEN (1) ELSE 0 END\n"}],"table": "","extra": "#0\nsum(#1)\nsum(#2)"}],"table": "","extra": "__internal_decompress_string(#0)\n#1\n#2\n"}],"table": "","extra": "__internal_compress_string_ubigint(#0)\n#1\n#2\n"}],"table": "","extra": "ORDERS:\nlineitem.l_shipmode ASC"}],"table": "","extra": "__internal_decompress_string(#0)\n#1\n#2\n"}
%%%%%%%%%%%%%%%% Running Query #  13  threads:  8
SELECT c_count, count(*) AS custdist FROM ( SELECT c_custkey, count(o_orderkey) FROM customer LEFT OUTER JOIN orders ON c_custkey = o_custkey AND o_comment NOT LIKE '%special%requests%' GROUP BY c_custkey) AS c_orders (c_custkey, c_count) GROUP BY c_count ORDER BY custdist DESC, c_count DESC;
Run:  None SELECT c_count, count(*) AS custdist FROM ( SELECT c_custkey, count(o_orderkey) FROM customer LEFT OUTER JOIN orders ON c_custkey = o_custkey AND o_comment NOT LIKE '%special%requests%' GROUP BY c_custkey) AS c_orders (c_custkey, c_count) GROUP BY c_count ORDER BY custdist DESC, c_count DESC;
Avg Time in sec:  0.12533749593421817  output size:  42
    c_count  custdist
0         0     50004
1        10      6668
2         9      6563
3        11      6004
4         8      5890
5        12      5600
6        13      5029
7        19      4805
8         7      4680
9        18      4531
10       20      4507
11       14      4473
12       15      4463
13       17      4445
14       16      4410
15       21      4168
16       22      3742
17        6      3273
18       23      3189
19       24      2700
20       25      2090
21        5      1957
22       26      1653
23       27      1177
24        4      1010
25       28       901
26       29       564
27        3       408
28       30       378
29       31       242
30       32       133
31        2       128
32       33        72
33       34        52
34       35        32
35       36        20
36        1        20
37       37         8
38       38         4
39       41         3
40       40         3
41       39         1
{'name': 'Query', 'result': 0.11718, 'timing': 0.11718, 'cardinality': 0, 'extra-info': "SELECT c_count, count(*) AS custdist FROM ( SELECT c_custkey, count(o_orderkey) FROM customer LEFT OUTER JOIN orders ON c_custkey = o_custkey AND o_comment NOT LIKE '%special%requests%' GROUP BY c_custkey) AS c_orders (c_custkey, c_count) GROUP BY c_count ORDER BY custdist DESC, c_count DESC;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 2.4e-05, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'ORDER_BY', 'timing': 0.000149, 'cardinality': 42, 'extra_info': 'ORDERS:\ncount_star() DESC\nc_orders.c_count DESC', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.008743, 'cardinality': 42, 'extra_info': '#0\ncount_star()', 'children': [{'name': 'PROJECTION', 'timing': 1.7e-05, 'cardinality': 150000, 'extra_info': 'c_count\n', 'children': [{'name': 'PROJECTION', 'timing': 2.1e-05, 'cardinality': 150000, 'extra_info': 'count(o_orderkey)\n', 'children': [{'name': 'PROJECTION', 'timing': 0.000215, 'cardinality': 150000, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n#1\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.270135, 'cardinality': 150000, 'extra_info': '#0\ncount(#1)', 'children': [{'name': 'PROJECTION', 'timing': 0.000598, 'cardinality': 1534302, 'extra_info': 'c_custkey\no_orderkey\n', 'children': [{'name': 'PROJECTION', 'timing': 0.006112, 'cardinality': 1534302, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n#1\n#2\n__internal_compress_integral_uinteger(#3, 1)\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.173196, 'cardinality': 1534302, 'extra_info': 'RIGHT\no_custkey = c_custkey\n\n[INFOSEPARATOR]\nEC: 300000\n', 'children': [{'name': 'FILTER', 'timing': 0.11976, 'cardinality': 1484298, 'extra_info': "(o_comment !~~ '%special%requests%')\n[INFOSEPARATOR]\nEC: 300000", 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.075898, 'cardinality': 1500000, 'extra_info': 'orders\n[INFOSEPARATOR]\no_custkey\no_comment\no_orderkey\n[INFOSEPARATOR]\nEC: 1500000', 'children': []}]}, {'name': 'SEQ_SCAN ', 'timing': 0.00022, 'cardinality': 150000, 'extra_info': 'customer\n[INFOSEPARATOR]\nc_custkey\n[INFOSEPARATOR]\nEC: 150000', 'children': []}]}]}]}]}]}]}]}]}]}]}]}
X {'RESULT_COLLECTOR0': 2.4e-05, 'ORDER_BY1': 0.000149, 'HASH_GROUP_BY2': 0.008743, 'PROJECTION3': 1.7e-05, 'PROJECTION4': 2.1e-05, 'PROJECTION5': 0.000215, 'HASH_GROUP_BY6': 0.270135, 'PROJECTION7': 0.000598, 'PROJECTION8': 0.006112, 'HASH_JOIN9': 0.173196, 'FILTER10': 0.11976, 'SEQ_SCAN 11': 0.075898, 'SEQ_SCAN 12': 0.00022}
**** output size:  42
LINEAGE_5_FILTER_1
LINEAGE_5_HASH_GROUP_BY_10
LINEAGE_5_HASH_GROUP_BY_6
LINEAGE_5_HASH_JOIN_3
LINEAGE_5_ORDER_BY_11
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_2
SELECT c_count, count(*) AS custdist FROM ( SELECT c_custkey, count(o_orderkey) FROM customer LEFT OUTER JOIN orders ON c_custkey = o_custkey AND o_comment NOT LIKE '%special%requests%' GROUP BY c_custkey) AS c_orders (c_custkey, c_count) GROUP BY c_count ORDER BY custdist DESC, c_count DESC;
compressed filter_log_size: 79504
compressed filter_log_buffer_size: 68140
compressed limit_offset_size: 1856
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 1856
compressed perfect_full_scan_ht_log_buffer_size: 0
compressed perfect_probe_ht_log_size: 1856
compressed perfect_probe_ht_log_buffer_size: 0
compressed row_group_log_size: 8875
compressed row_group_log_buffer_size: 0
compressed scatter_log_size: 5825899
compressed scatter_log_buffer_size: 5813583
compressed scatter_sel_log_size: 644740
compressed scatter_sel_log_buffer_size: 641581
compressed gather_log_size: 1856
compressed gather_log_buffer_size: 0
compressed combine_log_size: 19425134
compressed combine_log_buffer_size: 19417241
compressed finalize_states_log_size: 50718
compressed finalize_states_log_buffer_size: 46425
compressed join_gather_log_size: 6150541
compressed join_gather_log_buffer_size: 6102964
compressed reorder_log_size: 3344
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 1856
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 1856
compressed nlj_log_buffer_size: 0
compressed total_size: 32199891
compressed total_buffer_size: 32089934
compressed total_element_size: 109957

Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│       promo_revenue       │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│    UNGROUPED_AGGREGATE    │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│          sum(#0)          │                             
│          sum(#1)          │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│CASE  WHEN (prefix(p_type, │                             
│      'PROMO')) THEN (     │                             
│(l_extendedprice * (1....  │                             
│     )) ELSE 0.0000 END    │                             
│ (l_extendedprice * (1.00 -│                             
│        l_discount))       │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         HASH_JOIN         │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│           INNER           │                             
│   l_partkey = p_partkey   │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐              
│        Build Min: 1       │              │              
│     Build Max: 200000     │              │              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              
│         EC: 641407        │              │              
└─────────────┬─────────────┘              │                                           
┌─────────────┴─────────────┐┌─────────────┴─────────────┐
│         SEQ_SCAN          ││         SEQ_SCAN          │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│          lineitem         ││            part           │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│         l_partkey         ││         p_partkey         │
│      l_extendedprice      ││           p_type          │
│         l_discount        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││         EC: 200000        │
│ Filters: l_shipdate>='1995││                           │
│-09-01'::DATE AND l_sh...  ││                           │
│  <'1995-10-01'::DATE AND  ││                           │
│   l_shipdate IS NOT NULL  ││                           │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │
│        EC: 1200243        ││                           │
└───────────────────────────┘└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

compressed filter_log_size: 880
compressed filter_log_buffer_size: 0
compressed limit_offset_size: 880
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 461242
compressed perfect_full_scan_ht_log_buffer_size: 459978
compressed perfect_probe_ht_log_size: 386630
compressed perfect_probe_ht_log_buffer_size: 343598
compressed row_group_log_size: 298803
compressed row_group_log_buffer_size: 255158
compressed scatter_log_size: 880
compressed scatter_log_buffer_size: 0
compressed scatter_sel_log_size: 927729
compressed scatter_sel_log_buffer_size: 925329
compressed gather_log_size: 880
compressed gather_log_buffer_size: 0
compressed combine_log_size: 880
compressed combine_log_buffer_size: 0
compressed finalize_states_log_size: 880
compressed finalize_states_log_buffer_size: 0
compressed join_gather_log_size: 880
compressed join_gather_log_buffer_size: 0
compressed reorder_log_size: 1320
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 880
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 880
compressed nlj_log_buffer_size: 0
compressed total_size: 2083644
compressed total_buffer_size: 1984063
compressed total_element_size: 99581

Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                                                          
│         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│__internal_decompress_integ│                                                          
│     ral_bigint(#0, 1)     │                                                          
│             #1            │                                                          
│             #2            │                                                          
│__internal_decompress_strin│                                                          
│           g(#3)           │                                                          
│             #4            │                                                          
└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          
│          ORDER_BY         │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│          ORDERS:          │                                                          
│   supplier.s_suppkey ASC  │                                                          
└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          
│         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│__internal_compress_integra│                                                          
│     l_usmallint(#0, 1)    │                                                          
│             #1            │                                                          
│             #2            │                                                          
│__internal_compress_string_│                                                          
│        hugeint(#3)        │                                                          
│             #4            │                                                          
└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          
│         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│         s_suppkey         │                                                          
│           s_name          │                                                          
│         s_address         │                                                          
│          s_phone          │                                                          
│       total_revenue       │                                                          
└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          
│         HASH_JOIN         │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│           INNER           │                                                          
│  s_suppkey = supplier_no  │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐                                           
│        Build Min: 1       │              │                                           
│      Build Max: 10000     │              │                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                           
│           EC: 4           │              │                                           
└─────────────┬─────────────┘              │                                                                        
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             
│         SEQ_SCAN          ││         HASH_JOIN         │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│          supplier         ││           INNER           │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││  total_revenue = SUBQUERY │                             
│         s_suppkey         ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│           s_name          ││           EC: 3           ├──────────────┐              
│         s_address         ││                           │              │              
│          s_phone          ││                           │              │              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │              │              
│         EC: 10000         ││                           │              │              
└───────────────────────────┘└─────────────┬─────────────┘              │                                           
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
                             │         PROJECTION        ││    UNGROUPED_AGGREGATE    │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                             │__internal_decompress_integ││         first(#0)         │
                             │     ral_bigint(#0, 1)     ││                           │
                             │             #1            ││                           │
                             └─────────────┬─────────────┘└─────────────┬─────────────┘                             
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
                             │       HASH_GROUP_BY       ││         PROJECTION        │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                             │             #0            ││             #0            │
                             │    sum_no_overflow(#1)    ││                           │
                             └─────────────┬─────────────┘└─────────────┬─────────────┘                             
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
                             │         PROJECTION        ││      STREAMING_LIMIT      │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │
                             │         l_suppkey         ││                           │
                             │ (l_extendedprice * (1.00 -││                           │
                             │        l_discount))       ││                           │
                             └─────────────┬─────────────┘└─────────────┬─────────────┘                             
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
                             │         PROJECTION        ││    UNGROUPED_AGGREGATE    │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                             │__internal_compress_integra││          max(#0)          │
                             │     l_usmallint(#0, 1)    ││                           │
                             │             #1            ││                           │
                             │             #2            ││                           │
                             └─────────────┬─────────────┘└─────────────┬─────────────┘                             
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
                             │         SEQ_SCAN          ││         PROJECTION        │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                             │          lineitem         ││       total_revenue       │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │
                             │         l_suppkey         ││                           │
                             │      l_extendedprice      ││                           │
                             │         l_discount        ││                           │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │
                             │ Filters: l_shipdate>='1996││                           │
                             │-01-01'::DATE AND l_sh...  ││                           │
                             │  <'1996-04-01'::DATE AND  ││                           │
                             │   l_shipdate IS NOT NULL  ││                           │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │
                             │        EC: 1200243        ││                           │
                             └───────────────────────────┘└─────────────┬─────────────┘                             
                                                          ┌─────────────┴─────────────┐
                                                          │         PROJECTION        │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │  sum((l_extendedprice *   │
                                                          │(CAST(1 AS DECIMAL(16,2)) -│
                                                          │        l_discount)))      │
                                                          └─────────────┬─────────────┘                             
                                                          ┌─────────────┴─────────────┐
                                                          │         PROJECTION        │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │__internal_decompress_integ│
                                                          │     ral_bigint(#0, 1)     │
                                                          │             #1            │
                                                          └─────────────┬─────────────┘                             
                                                          ┌─────────────┴─────────────┐
                                                          │       HASH_GROUP_BY       │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │             #0            │
                                                          │    sum_no_overflow(#1)    │
                                                          └─────────────┬─────────────┘                             
                                                          ┌─────────────┴─────────────┐
                                                          │         PROJECTION        │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │         l_suppkey         │
                                                          │ (l_extendedprice * (1.00 -│
                                                          │        l_discount))       │
                                                          └─────────────┬─────────────┘                             
                                                          ┌─────────────┴─────────────┐
                                                          │         PROJECTION        │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │__internal_compress_integra│
                                                          │     l_usmallint(#0, 1)    │
                                                          │             #1            │
                                                          │             #2            │
                                                          └─────────────┬─────────────┘                             
                                                          ┌─────────────┴─────────────┐
                                                          │         SEQ_SCAN          │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │          lineitem         │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │         l_suppkey         │
                                                          │      l_extendedprice      │
                                                          │         l_discount        │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │ Filters: l_shipdate>='1996│
                                                          │-01-01'::DATE AND l_sh...  │
                                                          │  <'1996-04-01'::DATE AND  │
                                                          │   l_shipdate IS NOT NULL  │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │        EC: 1200243        │
                                                          └───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

   query_id  ...                                               plan
0         5  ...  {"name": "ORDER_BY", "opid": "11", "children":...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               SELECT c_count, count(*) AS custdist FROM ( SE...
size_bytes_max                                               32199891
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "ORDER_BY", "opid": "11", "children":...
Name: 0, dtype: object
{"name": "ORDER_BY", "opid": "11", "children": [{"name": "HASH_GROUP_BY", "opid": "10", "children": [{"name": "PROJECTION", "opid": "9", "children": [{"name": "PROJECTION", "opid": "8", "children": [{"name": "PROJECTION", "opid": "7", "children": [{"name": "HASH_GROUP_BY", "opid": "6", "children": [{"name": "PROJECTION", "opid": "5", "children": [{"name": "PROJECTION", "opid": "4", "children": [{"name": "HASH_JOIN", "opid": "3", "children": [{"name": "FILTER", "opid": "1", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "orders","extra": "orders\n[INFOSEPARATOR]\no_custkey\no_comment\no_orderkey\n[INFOSEPARATOR]\nEC: 1500000"}],"table": "","extra": "(o_comment !~~ '%special%requests%')\n[INFOSEPARATOR]\nEC: 300000"},{"name": "SEQ_SCAN ", "opid": "2", "children": [],"table": "customer","extra": "customer\n[INFOSEPARATOR]\nc_custkey\n[INFOSEPARATOR]\nEC: 150000"}],"table": "","extra": "RIGHT\no_custkey = c_custkey\n\n[INFOSEPARATOR]\nEC: 300000\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n#1\n#2\n__internal_compress_integral_uinteger(#3, 1)\n"}],"table": "","extra": "c_custkey\no_orderkey\n"}],"table": "","extra": "#0\ncount(#1)"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n#1\n"}],"table": "","extra": "count(o_orderkey)\n"}],"table": "","extra": "c_count\n"}],"table": "","extra": "#0\ncount_star()"}],"table": "","extra": "ORDERS:\ncount_star() DESC\nc_orders.c_count DESC"}
%%%%%%%%%%%%%%%% Running Query #  14  threads:  8
SELECT 100.00 * sum( CASE WHEN p_type LIKE 'PROMO%' THEN l_extendedprice * (1 - l_discount) ELSE 0 END) / sum(l_extendedprice * (1 - l_discount)) AS promo_revenue FROM lineitem, part WHERE l_partkey = p_partkey AND l_shipdate >= date '1995-09-01' AND l_shipdate < CAST('1995-10-01' AS date);
Run:  None SELECT 100.00 * sum( CASE WHEN p_type LIKE 'PROMO%' THEN l_extendedprice * (1 - l_discount) ELSE 0 END) / sum(l_extendedprice * (1 - l_discount)) AS promo_revenue FROM lineitem, part WHERE l_partkey = p_partkey AND l_shipdate >= date '1995-09-01' AND l_shipdate < CAST('1995-10-01' AS date);
Avg Time in sec:  0.04844192508608103  output size:  1
   promo_revenue
0      16.380779
{'name': 'Query', 'result': 0.04615, 'timing': 0.04615, 'cardinality': 0, 'extra-info': "SELECT 100.00 * sum( CASE WHEN p_type LIKE 'PROMO%' THEN l_extendedprice * (1 - l_discount) ELSE 0 END) / sum(l_extendedprice * (1 - l_discount)) AS promo_revenue FROM lineitem, part WHERE l_partkey = p_partkey AND l_shipdate >= date '1995-09-01' AND l_shipdate < CAST('1995-10-01' AS date);", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 5e-06, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 2.7e-05, 'cardinality': 1, 'extra_info': 'promo_revenue\n', 'children': [{'name': 'UNGROUPED_AGGREGATE', 'timing': 0.000442, 'cardinality': 1, 'extra_info': 'sum(#0)\nsum(#1)', 'children': [{'name': 'PROJECTION', 'timing': 0.002654, 'cardinality': 75983, 'extra_info': "CASE  WHEN (prefix(p_type, 'PROMO')) THEN ((l_extendedprice * (1.00 - l_discount))) ELSE 0.0000 END\n(l_extendedprice * (1.00 - l_discount))\n", 'children': [{'name': 'HASH_JOIN', 'timing': 0.071426, 'cardinality': 75983, 'extra_info': 'INNER\nl_partkey = p_partkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 641407\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.080224, 'cardinality': 75983, 'extra_info': "lineitem\n[INFOSEPARATOR]\nl_partkey\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nFilters: l_shipdate>='1995-09-01'::DATE AND l_shipdate<'1995-10-01'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243", 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 0.004869, 'cardinality': 200000, 'extra_info': 'part\n[INFOSEPARATOR]\np_partkey\np_type\n[INFOSEPARATOR]\nEC: 200000', 'children': []}]}]}]}]}]}]}
X {'RESULT_COLLECTOR0': 5e-06, 'PROJECTION1': 2.7e-05, 'UNGROUPED_AGGREGATE2': 0.000442, 'PROJECTION3': 0.002654, 'HASH_JOIN4': 0.071426, 'SEQ_SCAN 5': 0.080224, 'SEQ_SCAN 6': 0.004869}
**** output size:  1
LINEAGE_5_HASH_JOIN_2
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_1
SELECT 100.00 * sum( CASE WHEN p_type LIKE 'PROMO%' THEN l_extendedprice * (1 - l_discount) ELSE 0 END) / sum(l_extendedprice * (1 - l_discount)) AS promo_revenue FROM lineitem, part WHERE l_partkey = p_partkey AND l_shipdate >= date '1995-09-01' AND l_shipdate < CAST('1995-10-01' AS date);
   query_id  ...                                               plan
0         5  ...  {"name": "PROJECTION", "opid": "5", "children"...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               SELECT 100.00 * sum( CASE WHEN p_type LIKE 'PR...
size_bytes_max                                                2083644
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "PROJECTION", "opid": "5", "children"...
Name: 0, dtype: object
{"name": "PROJECTION", "opid": "5", "children": [{"name": "UNGROUPED_AGGREGATE", "opid": "4", "children": [{"name": "PROJECTION", "opid": "3", "children": [{"name": "HASH_JOIN", "opid": "2", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_partkey\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nFilters: l_shipdate>='1995-09-01'::DATE AND l_shipdate<'1995-10-01'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243"},{"name": "SEQ_SCAN ", "opid": "1", "children": [],"table": "part","extra": "part\n[INFOSEPARATOR]\np_partkey\np_type\n[INFOSEPARATOR]\nEC: 200000"}],"table": "","extra": "INNER\nl_partkey = p_partkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 641407\n"}],"table": "","extra": "CASE  WHEN (prefix(p_type, 'PROMO')) THEN ((l_extendedprice * (1.00 - l_discount))) ELSE 0.0000 END\n(l_extendedprice * (1.00 - l_discount))\n"}],"table": "","extra": "sum(#0)\nsum(#1)"}],"table": "","extra": "promo_revenue\n"}
%%%%%%%%%%%%%%%% Running Query #  15  threads:  8
with revenue0 (supplier_no, total_revenue) as ( select l_suppkey, sum(l_extendedprice * (1 - l_discount)) from lineitem where l_shipdate >= date '1996-01-01' and l_shipdate < date '1996-01-01' + interval '3' month group by l_suppkey ) SELECT s_suppkey, s_name, s_address, s_phone, total_revenue FROM supplier, revenue0 WHERE s_suppkey = supplier_no AND total_revenue = ( SELECT max(total_revenue) FROM revenue0) ORDER BY s_suppkey;
Run:  None with revenue0 (supplier_no, total_revenue) as ( select l_suppkey, sum(l_extendedprice * (1 - l_discount)) from lineitem where l_shipdate >= date '1996-01-01' and l_shipdate < date '1996-01-01' + interval '3' month group by l_suppkey ) SELECT s_suppkey, s_name, s_address, s_phone, total_revenue FROM supplier, revenue0 WHERE s_suppkey = supplier_no AND total_revenue = ( SELECT max(total_revenue) FROM revenue0) ORDER BY s_suppkey;
Avg Time in sec:  0.04627979686483741  output size:  1
   s_suppkey              s_name  ...          s_phone total_revenue
0       8449  Supplier#000008449  ...  20-469-856-8873  1.772627e+06

[1 rows x 5 columns]
{'name': 'Query', 'result': 0.039059, 'timing': 0.039059, 'cardinality': 0, 'extra-info': "with revenue0 (supplier_no, total_revenue) as ( select l_suppkey, sum(l_extendedprice * (1 - l_discount)) from lineitem where l_shipdate >= date '1996-01-01' and l_shipdate < date '1996-01-01' + interval '3' month group by l_suppkey ) SELECT s_suppkey, s_name, s_address, s_phone, total_revenue FROM supplier, revenue0 WHERE s_suppkey = supplier_no AND total_revenue = ( SELECT max(total_revenue) FROM revenue0) ORDER BY s_suppkey;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 7e-06, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 3e-06, 'cardinality': 1, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n#1\n#2\n__internal_decompress_string(#3)\n#4\n', 'children': [{'name': 'ORDER_BY', 'timing': 3.6e-05, 'cardinality': 1, 'extra_info': 'ORDERS:\nsupplier.s_suppkey ASC', 'children': [{'name': 'PROJECTION', 'timing': 5e-06, 'cardinality': 1, 'extra_info': '__internal_compress_integral_usmallint(#0, 1)\n#1\n#2\n__internal_compress_string_hugeint(#3)\n#4\n', 'children': [{'name': 'PROJECTION', 'timing': 1e-06, 'cardinality': 1, 'extra_info': 's_suppkey\ns_name\ns_address\ns_phone\ntotal_revenue\n', 'children': [{'name': 'HASH_JOIN', 'timing': 8e-05, 'cardinality': 1, 'extra_info': 'INNER\ns_suppkey = supplier_no\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 4\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.000658, 'cardinality': 10000, 'extra_info': 'supplier\n[INFOSEPARATOR]\ns_suppkey\ns_name\ns_address\ns_phone\n[INFOSEPARATOR]\nEC: 10000', 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.000259, 'cardinality': 1, 'extra_info': 'INNER\ntotal_revenue = SUBQUERY\n\n[INFOSEPARATOR]\nEC: 3\n', 'children': [{'name': 'PROJECTION', 'timing': 6.1e-05, 'cardinality': 10000, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n#1\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.044282, 'cardinality': 10000, 'extra_info': '#0\nsum_no_overflow(#1)', 'children': [{'name': 'PROJECTION', 'timing': 0.012218, 'cardinality': 225954, 'extra_info': 'l_suppkey\n(l_extendedprice * (1.00 - l_discount))\n', 'children': [{'name': 'PROJECTION', 'timing': 0.005531, 'cardinality': 225954, 'extra_info': '__internal_compress_integral_usmallint(#0, 1)\n#1\n#2\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.050415, 'cardinality': 225954, 'extra_info': "lineitem\n[INFOSEPARATOR]\nl_suppkey\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nFilters: l_shipdate>='1996-01-01'::DATE AND l_shipdate<'1996-04-01'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243", 'children': []}]}]}]}]}, {'name': 'UNGROUPED_AGGREGATE', 'timing': 3e-06, 'cardinality': 1, 'extra_info': 'first(#0)', 'children': [{'name': 'PROJECTION', 'timing': 0.0, 'cardinality': 1, 'extra_info': '#0\n', 'children': [{'name': 'STREAMING_LIMIT', 'timing': 2e-06, 'cardinality': 1, 'extra_info': '', 'children': [{'name': 'UNGROUPED_AGGREGATE', 'timing': 3e-05, 'cardinality': 1, 'extra_info': 'max(#0)', 'children': [{'name': 'PROJECTION', 'timing': 3e-06, 'cardinality': 10000, 'extra_info': 'total_revenue\n', 'children': [{'name': 'PROJECTION', 'timing': 3e-06, 'cardinality': 10000, 'extra_info': 'sum((l_extendedprice * (CAST(1 AS DECIMAL(16,2)) - l_discount)))\n', 'children': [{'name': 'PROJECTION', 'timing': 4.4e-05, 'cardinality': 10000, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n#1\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.056968, 'cardinality': 10000, 'extra_info': '#0\nsum_no_overflow(#1)', 'children': [{'name': 'PROJECTION', 'timing': 0.014842, 'cardinality': 225954, 'extra_info': 'l_suppkey\n(l_extendedprice * (1.00 - l_discount))\n', 'children': [{'name': 'PROJECTION', 'timing': 0.007377, 'cardinality': 225954, 'extra_info': '__internal_compress_integral_usmallint(#0, 1)\n#1\n#2\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.069338, 'cardinality': 225954, 'extra_info': "lineitem\n[INFOSEPARATOR]\nl_suppkey\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nFilters: l_shipdate>='1996-01-01'::DATE AND l_shipdate<'1996-04-01'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243", 'children': []}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}
compressed filter_log_size: 2656
compressed filter_log_buffer_size: 0
compressed limit_offset_size: 2800
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 3056
compressed perfect_full_scan_ht_log_buffer_size: 16
compressed perfect_probe_ht_log_size: 3048
compressed perfect_probe_ht_log_buffer_size: 8
compressed row_group_log_size: 882955
compressed row_group_log_buffer_size: 792972
compressed scatter_log_size: 1822038
compressed scatter_log_buffer_size: 1788899
compressed scatter_sel_log_size: 3152
compressed scatter_sel_log_buffer_size: 16
compressed gather_log_size: 2656
compressed gather_log_buffer_size: 0
compressed combine_log_size: 3927996
compressed combine_log_buffer_size: 3922432
compressed finalize_states_log_size: 8490
compressed finalize_states_log_buffer_size: 3530
compressed join_gather_log_size: 3100
compressed join_gather_log_buffer_size: 12
compressed reorder_log_size: 4064
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 2656
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 2656
compressed nlj_log_buffer_size: 0
compressed total_size: 6671323
compressed total_buffer_size: 6507885
compressed total_element_size: 163438

Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│__internal_decompress_strin│                                                                                       
│           g(#0)           │                                                                                       
│             #1            │                                                                                       
│__internal_decompress_integ│                                                                                       
│     ral_integer(#2, 1)    │                                                                                       
│             #3            │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│          ORDER_BY         │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│          ORDERS:          │                                                                                       
│  count(DISTINCT partsupp  │                                                                                       
│     .ps_suppkey) DESC     │                                                                                       
│      part.p_brand ASC     │                                                                                       
│      part.p_type ASC      │                                                                                       
│      part.p_size ASC      │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│__internal_compress_string_│                                                                                       
│        hugeint(#0)        │                                                                                       
│             #1            │                                                                                       
│__internal_compress_integra│                                                                                       
│     l_utinyint(#2, 1)     │                                                                                       
│             #3            │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│__internal_decompress_strin│                                                                                       
│           g(#0)           │                                                                                       
│             #1            │                                                                                       
│__internal_decompress_integ│                                                                                       
│     ral_integer(#2, 1)    │                                                                                       
│             #3            │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│       HASH_GROUP_BY       │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│             #0            │                                                                                       
│             #1            │                                                                                       
│             #2            │                                                                                       
│     count(DISTINCT #3)    │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│          p_brand          │                                                                                       
│           p_type          │                                                                                       
│           p_size          │                                                                                       
│         ps_suppkey        │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│             #0            │                                                                                       
│__internal_compress_string_│                                                                                       
│        hugeint(#1)        │                                                                                       
│             #2            │                                                                                       
│__internal_compress_integra│                                                                                       
│     l_utinyint(#3, 1)     │                                                                                       
│             #4            │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│             #1            │                                                                                       
│             #3            │                                                                                       
│             #4            │                                                                                       
│             #5            │                                                                                       
│             #6            │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│           FILTER          │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│       (NOT SUBQUERY)      │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│         EC: 33778         │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         HASH_JOIN         │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│            MARK           │                                                                                       
│      ps_suppkey = #0      ├────────────────────────────────────────────────────────────────────────┐              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                        │              
│         EC: 168893        │                                                                        │              
└─────────────┬─────────────┘                                                                        │                                           
┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐
│         HASH_JOIN         │                                                          │         PROJECTION        │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│           INNER           │                                                          │         s_suppkey         │
│   ps_partkey = p_partkey  │                                                          │                           │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐                                           │                           │
│        Build Min: 1       │              │                                           │                           │
│     Build Max: 200000     │              │                                           │                           │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                           │                           │
│         EC: 168893        │              │                                           │                           │
└─────────────┬─────────────┘              │                                           └─────────────┬─────────────┘                             
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐
│         SEQ_SCAN          ││           FILTER          │                             │           FILTER          │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│          partsupp         ││ (IN (...) AND (p_brand != │                             │  (s_comment ~~ '%Customer │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││'Brand#45') AND (NOT prefix│                             │       %Complaints%')      │
│         ps_partkey        ││(p_type, 'MEDIUM POLIS...  │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│         ps_suppkey        ││             )             │                             │          EC: 2000         │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │                           │
│         EC: 800000        ││         EC: 40000         │                             │                           │
└───────────────────────────┘└─────────────┬─────────────┘                             └─────────────┬─────────────┘                             
                             ┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐
                             │         HASH_JOIN         │                             │         SEQ_SCAN          │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                             │            MARK           │                             │          supplier         │
                             │        p_size = #0        │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐              │         s_comment         │
                             │         EC: 200000        │              │              │         s_suppkey         │
                             │                           │              │              │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                             │                           │              │              │         EC: 10000         │
                             └─────────────┬─────────────┘              │              └───────────────────────────┘                             
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             
                             │         SEQ_SCAN          ││      COLUMN_DATA_SCAN     │                             
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                             
                             │            part           ││                           │                             
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                             
                             │         p_partkey         ││                           │                             
                             │          p_brand          ││                           │                             
                             │           p_type          ││                           │                             
                             │           p_size          ││                           │                             
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                             
                             │         EC: 200000        ││                           │                             
                             └───────────────────────────┘└───────────────────────────┘                                                          

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

X {'RESULT_COLLECTOR0': 7e-06, 'PROJECTION1': 3e-06, 'ORDER_BY2': 3.6e-05, 'PROJECTION3': 5e-06, 'PROJECTION4': 1e-06, 'HASH_JOIN5': 8e-05, 'SEQ_SCAN 6': 0.000658, 'HASH_JOIN7': 0.000259, 'PROJECTION8': 6.1e-05, 'HASH_GROUP_BY9': 0.044282, 'PROJECTION10': 0.012218, 'PROJECTION11': 0.005531, 'SEQ_SCAN 12': 0.050415, 'UNGROUPED_AGGREGATE13': 3e-06, 'PROJECTION14': 0.0, 'STREAMING_LIMIT15': 2e-06, 'UNGROUPED_AGGREGATE16': 3e-05, 'PROJECTION17': 3e-06, 'PROJECTION18': 3e-06, 'PROJECTION19': 4.4e-05, 'HASH_GROUP_BY20': 0.056968, 'PROJECTION21': 0.014842, 'PROJECTION22': 0.007377, 'SEQ_SCAN 23': 0.069338}
**** output size:  1
LINEAGE_5_HASH_GROUP_BY_4
LINEAGE_5_HASH_GROUP_BY_9
LINEAGE_5_HASH_JOIN_17
LINEAGE_5_HASH_JOIN_18
LINEAGE_5_ORDER_BY_21
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_1
LINEAGE_5_SEQ_SCAN_6
LINEAGE_5_STREAMING_LIMIT_14
with revenue0 (supplier_no, total_revenue) as ( select l_suppkey, sum(l_extendedprice * (1 - l_discount)) from lineitem where l_shipdate >= date '1996-01-01' and l_shipdate < date '1996-01-01' + interval '3' month group by l_suppkey ) SELECT s_suppkey, s_name, s_address, s_phone, total_revenue FROM supplier, revenue0 WHERE s_suppkey = supplier_no AND total_revenue = ( SELECT max(total_revenue) FROM revenue0) ORDER BY s_suppkey;
   query_id  ...                                               plan
0         5  ...  {"name": "PROJECTION", "opid": "22", "children...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               with revenue0 (supplier_no, total_revenue) as ...
size_bytes_max                                                6671323
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "PROJECTION", "opid": "22", "children...
Name: 0, dtype: object
{"name": "PROJECTION", "opid": "22", "children": [{"name": "ORDER_BY", "opid": "21", "children": [{"name": "PROJECTION", "opid": "20", "children": [{"name": "PROJECTION", "opid": "19", "children": [{"name": "HASH_JOIN", "opid": "18", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "supplier","extra": "supplier\n[INFOSEPARATOR]\ns_suppkey\ns_name\ns_address\ns_phone\n[INFOSEPARATOR]\nEC: 10000"},{"name": "HASH_JOIN", "opid": "17", "children": [{"name": "PROJECTION", "opid": "5", "children": [{"name": "HASH_GROUP_BY", "opid": "4", "children": [{"name": "PROJECTION", "opid": "3", "children": [{"name": "PROJECTION", "opid": "2", "children": [{"name": "SEQ_SCAN ", "opid": "1", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_suppkey\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nFilters: l_shipdate>='1996-01-01'::DATE AND l_shipdate<'1996-04-01'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243"}],"table": "","extra": "__internal_compress_integral_usmallint(#0, 1)\n#1\n#2\n"}],"table": "","extra": "l_suppkey\n(l_extendedprice * (1.00 - l_discount))\n"}],"table": "","extra": "#0\nsum_no_overflow(#1)"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n#1\n"},{"name": "UNGROUPED_AGGREGATE", "opid": "16", "children": [{"name": "PROJECTION", "opid": "15", "children": [{"name": "STREAMING_LIMIT", "opid": "14", "children": [{"name": "UNGROUPED_AGGREGATE", "opid": "13", "children": [{"name": "PROJECTION", "opid": "12", "children": [{"name": "PROJECTION", "opid": "11", "children": [{"name": "PROJECTION", "opid": "10", "children": [{"name": "HASH_GROUP_BY", "opid": "9", "children": [{"name": "PROJECTION", "opid": "8", "children": [{"name": "PROJECTION", "opid": "7", "children": [{"name": "SEQ_SCAN ", "opid": "6", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_suppkey\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nFilters: l_shipdate>='1996-01-01'::DATE AND l_shipdate<'1996-04-01'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243"}],"table": "","extra": "__internal_compress_integral_usmallint(#0, 1)\n#1\n#2\n"}],"table": "","extra": "l_suppkey\n(l_extendedprice * (1.00 - l_discount))\n"}],"table": "","extra": "#0\nsum_no_overflow(#1)"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n#1\n"}],"table": "","extra": "sum((l_extendedprice * (CAST(1 AS DECIMAL(16,2)) - l_discount)))\n"}],"table": "","extra": "total_revenue\n"}],"table": "","extra": "max(#0)"}],"table": "","extra": ""}],"table": "","extra": "#0\n"}],"table": "","extra": "first(#0)"}],"table": "","extra": "INNER\ntotal_revenue = SUBQUERY\n\n[INFOSEPARATOR]\nEC: 3\n"}],"table": "","extra": "INNER\ns_suppkey = supplier_no\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 4\n"}],"table": "","extra": "s_suppkey\ns_name\ns_address\ns_phone\ntotal_revenue\n"}],"table": "","extra": "__internal_compress_integral_usmallint(#0, 1)\n#1\n#2\n__internal_compress_string_hugeint(#3)\n#4\n"}],"table": "","extra": "ORDERS:\nsupplier.s_suppkey ASC"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n#1\n#2\n__internal_decompress_string(#3)\n#4\n"}
%%%%%%%%%%%%%%%% Running Query #  16  threads:  8
SELECT p_brand, p_type, p_size, count(DISTINCT ps_suppkey) AS supplier_cnt FROM partsupp, part WHERE p_partkey = ps_partkey AND p_brand <> 'Brand#45' AND p_type NOT LIKE 'MEDIUM POLISHED%' AND p_size IN (49, 14, 23, 45, 19, 3, 36, 9) AND ps_suppkey NOT IN ( SELECT s_suppkey FROM supplier WHERE s_comment LIKE '%Customer%Complaints%') GROUP BY p_brand, p_type, p_size ORDER BY supplier_cnt DESC, p_brand, p_type, p_size;
Run:  None SELECT p_brand, p_type, p_size, count(DISTINCT ps_suppkey) AS supplier_cnt FROM partsupp, part WHERE p_partkey = ps_partkey AND p_brand <> 'Brand#45' AND p_type NOT LIKE 'MEDIUM POLISHED%' AND p_size IN (49, 14, 23, 45, 19, 3, 36, 9) AND ps_suppkey NOT IN ( SELECT s_suppkey FROM supplier WHERE s_comment LIKE '%Customer%Complaints%') GROUP BY p_brand, p_type, p_size ORDER BY supplier_cnt DESC, p_brand, p_type, p_size;
Avg Time in sec:  0.06454174127429724  output size:  18314
        p_brand                    p_type  p_size  supplier_cnt
0      Brand#41        MEDIUM BRUSHED TIN       3            28
1      Brand#54   STANDARD BRUSHED COPPER      14            27
2      Brand#11      STANDARD BRUSHED TIN      23            24
3      Brand#11  STANDARD BURNISHED BRASS      36            24
4      Brand#15    MEDIUM ANODIZED NICKEL       3            24
...         ...                       ...     ...           ...
18309  Brand#52      MEDIUM BRUSHED BRASS      45             3
18310  Brand#53        MEDIUM BRUSHED TIN      45             3
18311  Brand#54    ECONOMY POLISHED BRASS       9             3
18312  Brand#55        PROMO PLATED BRASS      19             3
18313  Brand#55       STANDARD PLATED TIN      49             3

[18314 rows x 4 columns]
{'name': 'Query', 'result': 0.059968, 'timing': 0.059968, 'cardinality': 0, 'extra-info': "SELECT p_brand, p_type, p_size, count(DISTINCT ps_suppkey) AS supplier_cnt FROM partsupp, part WHERE p_partkey = ps_partkey AND p_brand <> 'Brand#45' AND p_type NOT LIKE 'MEDIUM POLISHED%' AND p_size IN (49, 14, 23, 45, 19, 3, 36, 9) AND ps_suppkey NOT IN ( SELECT s_suppkey FROM supplier WHERE s_comment LIKE '%Customer%Complaints%') GROUP BY p_brand, p_type, p_size ORDER BY supplier_cnt DESC, p_brand, p_type, p_size;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 0.001311, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 0.000365, 'cardinality': 18314, 'extra_info': '__internal_decompress_string(#0)\n#1\n__internal_decompress_integral_integer(#2, 1)\n#3\n', 'children': [{'name': 'ORDER_BY', 'timing': 0.002922, 'cardinality': 18314, 'extra_info': 'ORDERS:\ncount(DISTINCT partsupp.ps_suppkey) DESC\npart.p_brand ASC\npart.p_type ASC\npart.p_size ASC', 'children': [{'name': 'PROJECTION', 'timing': 0.00029, 'cardinality': 18314, 'extra_info': '__internal_compress_string_hugeint(#0)\n#1\n__internal_compress_integral_utinyint(#2, 1)\n#3\n', 'children': [{'name': 'PROJECTION', 'timing': 0.000669, 'cardinality': 18314, 'extra_info': '__internal_decompress_string(#0)\n#1\n__internal_decompress_integral_integer(#2, 1)\n#3\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.049583, 'cardinality': 18314, 'extra_info': '#0\n#1\n#2\ncount(DISTINCT #3)', 'children': [{'name': 'PROJECTION', 'timing': 0.000298, 'cardinality': 118274, 'extra_info': 'p_brand\np_type\np_size\nps_suppkey\n', 'children': [{'name': 'PROJECTION', 'timing': 0.004609, 'cardinality': 118274, 'extra_info': '#0\n__internal_compress_string_hugeint(#1)\n#2\n__internal_compress_integral_utinyint(#3, 1)\n#4\n', 'children': [{'name': 'PROJECTION', 'timing': 0.000435, 'cardinality': 118274, 'extra_info': '#1\n#3\n#4\n#5\n#6\n', 'children': [{'name': 'FILTER', 'timing': 0.001919, 'cardinality': 118274, 'extra_info': '(NOT SUBQUERY)\n[INFOSEPARATOR]\nEC: 33778', 'children': [{'name': 'HASH_JOIN', 'timing': 0.006798, 'cardinality': 118324, 'extra_info': 'MARK\nps_suppkey = #0\n\n[INFOSEPARATOR]\nEC: 168893\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.019005, 'cardinality': 118324, 'extra_info': 'INNER\nps_partkey = p_partkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 168893\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.002238, 'cardinality': 800000, 'extra_info': 'partsupp\n[INFOSEPARATOR]\nps_partkey\nps_suppkey\n[INFOSEPARATOR]\nEC: 800000', 'children': []}, {'name': 'FILTER', 'timing': 0.004231, 'cardinality': 29581, 'extra_info': "(IN (...) AND (p_brand != 'Brand#45') AND (NOT prefix(p_type, 'MEDIUM POLISHED')))\n[INFOSEPARATOR]\nEC: 40000", 'children': [{'name': 'HASH_JOIN', 'timing': 0.00335, 'cardinality': 200000, 'extra_info': 'MARK\np_size = #0\n\n[INFOSEPARATOR]\nEC: 200000\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.016154, 'cardinality': 200000, 'extra_info': 'part\n[INFOSEPARATOR]\np_partkey\np_brand\np_type\np_size\n[INFOSEPARATOR]\nEC: 200000', 'children': []}, {'name': 'COLUMN_DATA_SCAN', 'timing': 6e-06, 'cardinality': 8, 'extra_info': '', 'children': []}]}]}]}, {'name': 'PROJECTION', 'timing': 1e-06, 'cardinality': 4, 'extra_info': 's_suppkey\n', 'children': [{'name': 'FILTER', 'timing': 0.000264, 'cardinality': 4, 'extra_info': "(s_comment ~~ '%Customer%Complaints%')\n[INFOSEPARATOR]\nEC: 2000", 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.000263, 'cardinality': 10000, 'extra_info': 'supplier\n[INFOSEPARATOR]\ns_comment\ns_suppkey\n[INFOSEPARATOR]\nEC: 10000', 'children': []}]}]}]}]}]}]}]}]}]}]}]}]}]}]}
compressed filter_log_size: 34036
compressed filter_log_buffer_size: 26242
compressed limit_offset_size: 2048
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 107567
compressed perfect_full_scan_ht_log_buffer_size: 105135
compressed perfect_probe_ht_log_size: 224642
compressed perfect_probe_ht_log_buffer_size: 215058
compressed row_group_log_size: 6803
compressed row_group_log_buffer_size: 0
compressed scatter_log_size: 445486
compressed scatter_log_buffer_size: 440713
compressed scatter_sel_log_size: 146812
compressed scatter_sel_log_buffer_size: 142865
compressed gather_log_size: 2048
compressed gather_log_buffer_size: 0
compressed combine_log_size: 1785310
compressed combine_log_buffer_size: 1781823
compressed finalize_states_log_size: 6523
compressed finalize_states_log_buffer_size: 3315
compressed join_gather_log_size: 2048
compressed join_gather_log_buffer_size: 0
compressed reorder_log_size: 34862
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 2048
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 2048
compressed nlj_log_buffer_size: 0
compressed total_size: 2802281
compressed total_buffer_size: 2715151
compressed total_element_size: 87130

Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                                                                                                                    
│         PROJECTION        │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│         avg_yearly        │                                                                                                                    
└─────────────┬─────────────┘                                                                                                                                                 
┌─────────────┴─────────────┐                                                                                                                    
│    UNGROUPED_AGGREGATE    │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│          sum(#0)          │                                                                                                                    
└─────────────┬─────────────┘                                                                                                                                                 
┌─────────────┴─────────────┐                                                                                                                    
│         PROJECTION        │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│      l_extendedprice      │                                                                                                                    
└─────────────┬─────────────┘                                                                                                                                                 
┌─────────────┴─────────────┐                                                                                                                    
│         PROJECTION        │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│             #0            │                                                                                                                    
│             #3            │                                                                                                                    
│             #4            │                                                                                                                    
└─────────────┬─────────────┘                                                                                                                                                 
┌─────────────┴─────────────┐                                                                                                                    
│           FILTER          │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│(CAST(l_quantity AS DOUBLE)│                                                                                                                    
│         < SUBQUERY)       │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│        EC: 3000607        │                                                                                                                    
└─────────────┬─────────────┘                                                                                                                                                 
┌─────────────┴─────────────┐                                                                                                                    
│      RIGHT_DELIM_JOIN     │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│           RIGHT           │                                                                                                                    
│ p_partkey IS NOT DISTINCT ├───────────────────────────────────────────┐                                                                        
│       FROM p_partkey      │                                           │                                                                        
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                           │                                                                        
│        EC: 3000607        │                                           │                                                                        
└─────────────┬─────────────┘                                           │                                                                                                     
┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐                                                          
│         HASH_JOIN         │                             │         HASH_JOIN         │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│           INNER           │                             │           RIGHT           │                                                          
│   l_partkey = p_partkey   │                             │ p_partkey IS NOT DISTINCT │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐              │       FROM p_partkey      ├───────────────────────────────────────────┐              
│        Build Min: 1       │              │              │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                           │              
│     Build Max: 200000     │              │              │        EC: 3000607        │                                           │              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              │                           │                                           │              
│         EC: 80175         │              │              │                           │                                           │              
└─────────────┬─────────────┘              │              └─────────────┬─────────────┘                                           │                                           
┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐
│         SEQ_SCAN          ││         SEQ_SCAN          ││         PROJECTION        │                             │         DUMMY_SCAN        │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │                           │
│          lineitem         ││            part           ││  (0.2 * avg(l_quantity))  │                             │                           │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││         p_partkey         │                             │                           │
│         l_partkey         ││         p_partkey         ││                           │                             │                           │
│         l_quantity        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                             │                           │
│      l_extendedprice      ││Filters: p_brand='Brand#23'││                           │                             │                           │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   AND p_brand IS NOT NULL ││                           │                             │                           │
│        EC: 6001215        ││ p_container='MED BOX' AND ││                           │                             │                           │
│                           ││   p_container IS NOT NULL ││                           │                             │                           │
│                           ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                             │                           │
│                           ││          EC: 5000         ││                           │                             │                           │
└───────────────────────────┘└───────────────────────────┘└─────────────┬─────────────┘                             └───────────────────────────┘                             
                                                          ┌─────────────┴─────────────┐                                                          
                                                          │         PROJECTION        │                                                          
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                          │__internal_decompress_integ│                                                          
                                                          │     ral_bigint(#0, 1)     │                                                          
                                                          │             #1            │                                                          
                                                          └─────────────┬─────────────┘                                                                                       
                                                          ┌─────────────┴─────────────┐                                                          
                                                          │       HASH_GROUP_BY       │                                                          
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                          │             #0            │                                                          
                                                          │          avg(#1)          │                                                          
                                                          └─────────────┬─────────────┘                                                                                       
                                                          ┌─────────────┴─────────────┐                                                          
                                                          │         PROJECTION        │                                                          
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                          │         p_partkey         │                                                          
                                                          │         l_quantity        │                                                          
                                                          └─────────────┬─────────────┘                                                                                       
                                                          ┌─────────────┴─────────────┐                                                          
                                                          │         PROJECTION        │                                                          
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                          │__internal_compress_integra│                                                          
                                                          │     l_uinteger(#0, 1)     │                                                          
                                                          │             #1            │                                                          
                                                          │             #2            │                                                          
                                                          └─────────────┬─────────────┘                                                                                       
                                                          ┌─────────────┴─────────────┐                                                          
                                                          │         HASH_JOIN         │                                                          
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                          │           INNER           │                                                          
                                                          │   l_partkey = p_partkey   ├──────────────┐                                           
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                           
                                                          │        EC: 6001215        │              │                                           
                                                          └─────────────┬─────────────┘              │                                                                        
                                                          ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             
                                                          │         SEQ_SCAN          ││         DELIM_SCAN        │                             
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                             
                                                          │          lineitem         ││                           │                             
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                             
                                                          │         l_partkey         ││                           │                             
                                                          │         l_quantity        ││                           │                             
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                             
                                                          │        EC: 6001215        ││                           │                             
                                                          └───────────────────────────┘└───────────────────────────┘                                                          

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

X {'RESULT_COLLECTOR0': 0.001311, 'PROJECTION1': 0.000365, 'ORDER_BY2': 0.002922, 'PROJECTION3': 0.00029, 'PROJECTION4': 0.000669, 'HASH_GROUP_BY5': 0.049583, 'PROJECTION6': 0.000298, 'PROJECTION7': 0.004609, 'PROJECTION8': 0.000435, 'FILTER9': 0.001919, 'HASH_JOIN10': 0.006798, 'HASH_JOIN11': 0.019005, 'SEQ_SCAN 12': 0.002238, 'FILTER13': 0.004231, 'HASH_JOIN14': 0.00335, 'SEQ_SCAN 15': 0.016154, 'COLUMN_DATA_SCAN16': 6e-06, 'PROJECTION17': 1e-06, 'FILTER18': 0.000264, 'SEQ_SCAN 19': 0.000263}
**** output size:  18314
LINEAGE_5_COLUMN_DATA_SCAN_2
LINEAGE_5_FILTER_10
LINEAGE_5_FILTER_4
LINEAGE_5_FILTER_7
LINEAGE_5_HASH_GROUP_BY_14
LINEAGE_5_HASH_JOIN_3
LINEAGE_5_HASH_JOIN_5
LINEAGE_5_HASH_JOIN_9
LINEAGE_5_ORDER_BY_17
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_1
LINEAGE_5_SEQ_SCAN_6
SELECT p_brand, p_type, p_size, count(DISTINCT ps_suppkey) AS supplier_cnt FROM partsupp, part WHERE p_partkey = ps_partkey AND p_brand <> 'Brand#45' AND p_type NOT LIKE 'MEDIUM POLISHED%' AND p_size IN (49, 14, 23, 45, 19, 3, 36, 9) AND ps_suppkey NOT IN ( SELECT s_suppkey FROM supplier WHERE s_comment LIKE '%Customer%Complaints%') GROUP BY p_brand, p_type, p_size ORDER BY supplier_cnt DESC, p_brand, p_type, p_size;
   query_id  ...                                               plan
0         5  ...  {"name": "PROJECTION", "opid": "18", "children...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               SELECT p_brand, p_type, p_size, count(DISTINCT...
size_bytes_max                                                2802281
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "PROJECTION", "opid": "18", "children...
Name: 0, dtype: object
{"name": "PROJECTION", "opid": "18", "children": [{"name": "ORDER_BY", "opid": "17", "children": [{"name": "PROJECTION", "opid": "16", "children": [{"name": "PROJECTION", "opid": "15", "children": [{"name": "HASH_GROUP_BY", "opid": "14", "children": [{"name": "PROJECTION", "opid": "13", "children": [{"name": "PROJECTION", "opid": "12", "children": [{"name": "PROJECTION", "opid": "11", "children": [{"name": "FILTER", "opid": "10", "children": [{"name": "HASH_JOIN", "opid": "9", "children": [{"name": "HASH_JOIN", "opid": "5", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "partsupp","extra": "partsupp\n[INFOSEPARATOR]\nps_partkey\nps_suppkey\n[INFOSEPARATOR]\nEC: 800000"},{"name": "FILTER", "opid": "4", "children": [{"name": "HASH_JOIN", "opid": "3", "children": [{"name": "SEQ_SCAN ", "opid": "1", "children": [],"table": "part","extra": "part\n[INFOSEPARATOR]\np_partkey\np_brand\np_type\np_size\n[INFOSEPARATOR]\nEC: 200000"},{"name": "COLUMN_DATA_SCAN", "opid": "2", "children": [],"table": "","extra": ""}],"table": "","extra": "MARK\np_size = #0\n\n[INFOSEPARATOR]\nEC: 200000\n"}],"table": "","extra": "(IN (...) AND (p_brand != 'Brand#45') AND (NOT prefix(p_type, 'MEDIUM POLISHED')))\n[INFOSEPARATOR]\nEC: 40000"}],"table": "","extra": "INNER\nps_partkey = p_partkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 168893\n"},{"name": "PROJECTION", "opid": "8", "children": [{"name": "FILTER", "opid": "7", "children": [{"name": "SEQ_SCAN ", "opid": "6", "children": [],"table": "supplier","extra": "supplier\n[INFOSEPARATOR]\ns_comment\ns_suppkey\n[INFOSEPARATOR]\nEC: 10000"}],"table": "","extra": "(s_comment ~~ '%Customer%Complaints%')\n[INFOSEPARATOR]\nEC: 2000"}],"table": "","extra": "s_suppkey\n"}],"table": "","extra": "MARK\nps_suppkey = #0\n\n[INFOSEPARATOR]\nEC: 168893\n"}],"table": "","extra": "(NOT SUBQUERY)\n[INFOSEPARATOR]\nEC: 33778"}],"table": "","extra": "#1\n#3\n#4\n#5\n#6\n"}],"table": "","extra": "#0\n__internal_compress_string_hugeint(#1)\n#2\n__internal_compress_integral_utinyint(#3, 1)\n#4\n"}],"table": "","extra": "p_brand\np_type\np_size\nps_suppkey\n"}],"table": "","extra": "#0\n#1\n#2\ncount(DISTINCT #3)"}],"table": "","extra": "__internal_decompress_string(#0)\n#1\n__internal_decompress_integral_integer(#2, 1)\n#3\n"}],"table": "","extra": "__internal_compress_string_hugeint(#0)\n#1\n__internal_compress_integral_utinyint(#2, 1)\n#3\n"}],"table": "","extra": "ORDERS:\ncount(DISTINCT partsupp.ps_suppkey) DESC\npart.p_brand ASC\npart.p_type ASC\npart.p_size ASC"}],"table": "","extra": "__internal_decompress_string(#0)\n#1\n__internal_decompress_integral_integer(#2, 1)\n#3\n"}
%%%%%%%%%%%%%%%% Running Query #  17  threads:  8
SELECT sum(l_extendedprice) / 7.0 AS avg_yearly FROM lineitem, part WHERE p_partkey = l_partkey AND p_brand = 'Brand#23' AND p_container = 'MED BOX' AND l_quantity < ( SELECT 0.2 * avg(l_quantity) FROM lineitem WHERE l_partkey = p_partkey);
Run:  None SELECT sum(l_extendedprice) / 7.0 AS avg_yearly FROM lineitem, part WHERE p_partkey = l_partkey AND p_brand = 'Brand#23' AND p_container = 'MED BOX' AND l_quantity < ( SELECT 0.2 * avg(l_quantity) FROM lineitem WHERE l_partkey = p_partkey);
Avg Time in sec:  0.06266460428014398  output size:  1
      avg_yearly
0  348406.054286
{'name': 'Query', 'result': 0.049694, 'timing': 0.049694, 'cardinality': 0, 'extra-info': "SELECT sum(l_extendedprice) / 7.0 AS avg_yearly FROM lineitem, part WHERE p_partkey = l_partkey AND p_brand = 'Brand#23' AND p_container = 'MED BOX' AND l_quantity < ( SELECT 0.2 * avg(l_quantity) FROM lineitem WHERE l_partkey = p_partkey);", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 2e-05, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 6e-06, 'cardinality': 1, 'extra_info': 'avg_yearly\n', 'children': [{'name': 'UNGROUPED_AGGREGATE', 'timing': 3.2e-05, 'cardinality': 1, 'extra_info': 'sum(#0)', 'children': [{'name': 'PROJECTION', 'timing': 5e-06, 'cardinality': 587, 'extra_info': 'l_extendedprice\n', 'children': [{'name': 'PROJECTION', 'timing': 1.1e-05, 'cardinality': 587, 'extra_info': '#0\n#3\n#4\n', 'children': [{'name': 'FILTER', 'timing': 0.000468, 'cardinality': 587, 'extra_info': '(CAST(l_quantity AS DOUBLE) < SUBQUERY)\n[INFOSEPARATOR]\nEC: 3000607', 'children': [{'name': 'RIGHT_DELIM_JOIN', 'timing': 0.015118, 'cardinality': 0, 'extra_info': 'RIGHT\np_partkey IS NOT DISTINCT FROM p_partkey\n\n[INFOSEPARATOR]\nEC: 3000607\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.049086, 'cardinality': 6088, 'extra_info': 'INNER\nl_partkey = p_partkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 80175\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.018659, 'cardinality': 6001215, 'extra_info': 'lineitem\n[INFOSEPARATOR]\nl_partkey\nl_quantity\nl_extendedprice\n[INFOSEPARATOR]\nEC: 6001215', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 0.015323, 'cardinality': 204, 'extra_info': "part\n[INFOSEPARATOR]\np_partkey\n[INFOSEPARATOR]\nFilters: p_brand='Brand#23' AND p_brand IS NOT NULL\np_container='MED BOX' AND p_container IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 5000", 'children': []}]}, {'name': 'HASH_JOIN', 'timing': 0.006134, 'cardinality': 6088, 'extra_info': 'RIGHT\np_partkey IS NOT DISTINCT FROM p_partkey\n\n[INFOSEPARATOR]\nEC: 3000607\n', 'children': [{'name': 'PROJECTION', 'timing': 4.5e-05, 'cardinality': 204, 'extra_info': '(0.2 * avg(l_quantity))\np_partkey\n', 'children': [{'name': 'PROJECTION', 'timing': 5.7e-05, 'cardinality': 204, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n#1\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.027543, 'cardinality': 204, 'extra_info': '#0\navg(#1)', 'children': [{'name': 'PROJECTION', 'timing': 3.2e-05, 'cardinality': 6088, 'extra_info': 'p_partkey\nl_quantity\n', 'children': [{'name': 'PROJECTION', 'timing': 0.000202, 'cardinality': 6088, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n#1\n#2\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.085906, 'cardinality': 6088, 'extra_info': 'INNER\nl_partkey = p_partkey\n\n[INFOSEPARATOR]\nEC: 6001215\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.01529, 'cardinality': 6001215, 'extra_info': 'lineitem\n[INFOSEPARATOR]\nl_partkey\nl_quantity\n[INFOSEPARATOR]\nEC: 6001215', 'children': []}, {'name': 'DELIM_SCAN', 'timing': 0.0, 'cardinality': 0, 'extra_info': '', 'children': []}]}]}]}]}]}]}, {'name': 'DUMMY_SCAN', 'timing': 0.0, 'cardinality': 0, 'extra_info': '', 'children': []}]}, {'name': 'HASH_GROUP_BY', 'timing': 0.002561, 'cardinality': 204, 'extra_info': '#0', 'children': []}]}]}]}]}]}]}]}]}
compressed filter_log_size: 6207
compressed filter_log_buffer_size: 831
compressed limit_offset_size: 2688
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 4009
compressed perfect_full_scan_ht_log_buffer_size: 937
compressed perfect_probe_ht_log_size: 90220
compressed perfect_probe_ht_log_buffer_size: 48704
compressed row_group_log_size: 47462
compressed row_group_log_buffer_size: 816
compressed scatter_log_size: 49624
compressed scatter_log_buffer_size: 44632
compressed scatter_sel_log_size: 40168
compressed scatter_sel_log_buffer_size: 32174
compressed gather_log_size: 2688
compressed gather_log_buffer_size: 0
compressed combine_log_size: 97562
compressed combine_log_buffer_size: 91977
compressed finalize_states_log_size: 6072
compressed finalize_states_log_buffer_size: 1080
compressed join_gather_log_size: 167906
compressed join_gather_log_buffer_size: 114830
compressed reorder_log_size: 4032
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 2688
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 2688
compressed nlj_log_buffer_size: 0
compressed total_size: 524014
compressed total_buffer_size: 335981
compressed total_element_size: 188033

Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                                                                                       
│           LIMIT           │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│             #0            │                                                                                       
│__internal_decompress_integ│                                                                                       
│     ral_bigint(#1, 1)     │                                                                                       
│__internal_decompress_integ│                                                                                       
│     ral_bigint(#2, 1)     │                                                                                       
│             #3            │                                                                                       
│             #4            │                                                                                       
│             #5            │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│          ORDER_BY         │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│          ORDERS:          │                                                                                       
│  orders.o_totalprice DESC │                                                                                       
│   orders.o_orderdate ASC  │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│             #0            │                                                                                       
│__internal_compress_integra│                                                                                       
│     l_uinteger(#1, 1)     │                                                                                       
│__internal_compress_integra│                                                                                       
│     l_uinteger(#2, 1)     │                                                                                       
│             #3            │                                                                                       
│             #4            │                                                                                       
│             #5            │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│             #0            │                                                                                       
│__internal_decompress_integ│                                                                                       
│     ral_bigint(#1, 1)     │                                                                                       
│__internal_decompress_integ│                                                                                       
│     ral_bigint(#2, 1)     │                                                                                       
│             #3            │                                                                                       
│             #4            │                                                                                       
│             #5            │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│       HASH_GROUP_BY       │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│             #0            │                                                                                       
│             #1            │                                                                                       
│             #2            │                                                                                       
│             #3            │                                                                                       
│             #4            │                                                                                       
│          sum(#5)          │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│           c_name          │                                                                                       
│         c_custkey         │                                                                                       
│         o_orderkey        │                                                                                       
│        o_orderdate        │                                                                                       
│        o_totalprice       │                                                                                       
│         l_quantity        │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│__internal_compress_integra│                                                                                       
│     l_uinteger(#0, 1)     │                                                                                       
│             #1            │                                                                                       
│__internal_compress_integra│                                                                                       
│     l_uinteger(#2, 1)     │                                                                                       
│__internal_compress_integra│                                                                                       
│     l_uinteger(#3, 1)     │                                                                                       
│             #4            │                                                                                       
│             #5            │                                                                                       
│             #6            │                                                                                       
│__internal_compress_integra│                                                                                       
│     l_uinteger(#7, 1)     │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         HASH_JOIN         │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│           INNER           │                                                                                       
│      o_orderkey = #0      ├────────────────────────────────────────────────────────────────────────┐              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                        │              
│        EC: 3618677        │                                                                        │              
└─────────────┬─────────────┘                                                                        │                                           
┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐
│         HASH_JOIN         │                                                          │         PROJECTION        │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│           INNER           │                                                          │__internal_decompress_integ│
│  l_orderkey = o_orderkey  ├──────────────┐                                           │     ral_bigint(#0, 1)     │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                           │                           │
│        EC: 3618677        │              │                                           │                           │
└─────────────┬─────────────┘              │                                           └─────────────┬─────────────┘                             
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐
│         SEQ_SCAN          ││         HASH_JOIN         │                             │       HASH_GROUP_BY       │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│          lineitem         ││           INNER           │                             │             #0            │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   o_custkey = c_custkey   │                             │                           │
│         l_orderkey        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐              │                           │
│         l_quantity        ││        Build Min: 1       │              │              │                           │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││     Build Max: 149999     │              │              │                           │
│        EC: 6001215        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              │                           │
│                           ││         EC: 904486        │              │              │                           │
└───────────────────────────┘└─────────────┬─────────────┘              │              └─────────────┬─────────────┘                             
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐
                             │         SEQ_SCAN          ││         SEQ_SCAN          ││         PROJECTION        │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                             │           orders          ││          customer         ││             #0            │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │
                             │         o_orderkey        ││         c_custkey         ││                           │
                             │         o_custkey         ││           c_name          ││                           │
                             │        o_orderdate        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │
                             │        o_totalprice       ││ Filters: c_custkey<=149999││                           │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││  AND c_custkey IS NOT NULL││                           │
                             │        EC: 1500000        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │
                             │                           ││         EC: 150000        ││                           │
                             └───────────────────────────┘└───────────────────────────┘└─────────────┬─────────────┘                             
                                                                                       ┌─────────────┴─────────────┐
                                                                                       │         PROJECTION        │
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                       │__internal_compress_integra│
                                                                                       │     l_uinteger(#0, 1)     │
                                                                                       └─────────────┬─────────────┘                             
                                                                                       ┌─────────────┴─────────────┐
                                                                                       │         PROJECTION        │
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                       │         l_orderkey        │
                                                                                       └─────────────┬─────────────┘                             
                                                                                       ┌─────────────┴─────────────┐
                                                                                       │           FILTER          │
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                       │ (sum(l_quantity) > 300.00)│
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                       │         EC: 47042         │
                                                                                       └─────────────┬─────────────┘                             
                                                                                       ┌─────────────┴─────────────┐
                                                                                       │         PROJECTION        │
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                       │__internal_decompress_integ│
                                                                                       │     ral_bigint(#0, 1)     │
                                                                                       │             #1            │
                                                                                       └─────────────┬─────────────┘                             
                                                                                       ┌─────────────┴─────────────┐
                                                                                       │       HASH_GROUP_BY       │
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                       │             #0            │
                                                                                       │    sum_no_overflow(#1)    │
                                                                                       └─────────────┬─────────────┘                             
                                                                                       ┌─────────────┴─────────────┐
                                                                                       │         PROJECTION        │
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                       │         l_orderkey        │
                                                                                       │         l_quantity        │
                                                                                       └─────────────┬─────────────┘                             
                                                                                       ┌─────────────┴─────────────┐
                                                                                       │         PROJECTION        │
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                       │__internal_compress_integra│
                                                                                       │     l_uinteger(#0, 1)     │
                                                                                       │             #1            │
                                                                                       └─────────────┬─────────────┘                             
                                                                                       ┌─────────────┴─────────────┐
                                                                                       │         SEQ_SCAN          │
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                       │          lineitem         │
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                       │         l_orderkey        │
                                                                                       │         l_quantity        │
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                       │        EC: 6001215        │
                                                                                       └───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

X {'RESULT_COLLECTOR0': 2e-05, 'PROJECTION1': 6e-06, 'UNGROUPED_AGGREGATE2': 3.2e-05, 'PROJECTION3': 5e-06, 'PROJECTION4': 1.1e-05, 'FILTER5': 0.000468, 'RIGHT_DELIM_JOIN6': 0.015118, 'HASH_JOIN7': 0.049086, 'SEQ_SCAN 8': 0.018659, 'SEQ_SCAN 9': 0.015323, 'HASH_JOIN10': 0.006134, 'PROJECTION11': 4.5e-05, 'PROJECTION12': 5.7e-05, 'HASH_GROUP_BY13': 0.027543, 'PROJECTION14': 3.2e-05, 'PROJECTION15': 0.000202, 'HASH_JOIN16': 0.085906, 'SEQ_SCAN 17': 0.01529, 'DELIM_SCAN18': 0.0, 'DUMMY_SCAN19': 0.0, 'HASH_GROUP_BY20': 0.002561}
**** output size:  1
LINEAGE_5_FILTER_15
LINEAGE_5_HASH_GROUP_BY_10
LINEAGE_5_HASH_GROUP_BY_5
LINEAGE_5_HASH_JOIN_13
LINEAGE_5_HASH_JOIN_2
LINEAGE_5_HASH_JOIN_9
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_11
LINEAGE_5_SEQ_SCAN_12
SELECT sum(l_extendedprice) / 7.0 AS avg_yearly FROM lineitem, part WHERE p_partkey = l_partkey AND p_brand = 'Brand#23' AND p_container = 'MED BOX' AND l_quantity < ( SELECT 0.2 * avg(l_quantity) FROM lineitem WHERE l_partkey = p_partkey);
   query_id  ...                                               plan
0         5  ...  {"name": "PROJECTION", "opid": "19", "children...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               SELECT sum(l_extendedprice) / 7.0 AS avg_yearl...
size_bytes_max                                                 524014
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "PROJECTION", "opid": "19", "children...
Name: 0, dtype: object
{"name": "PROJECTION", "opid": "19", "children": [{"name": "UNGROUPED_AGGREGATE", "opid": "18", "children": [{"name": "PROJECTION", "opid": "17", "children": [{"name": "PROJECTION", "opid": "16", "children": [{"name": "FILTER", "opid": "15", "children": [{"name": "RIGHT_DELIM_JOIN", "opid": "14", "children": [{"name": "HASH_GROUP_BY", "opid": "10", "children": [],"table": "","extra": "#0"},{"name": "HASH_JOIN", "opid": "9", "children": [{"name": "PROJECTION", "opid": "7", "children": [{"name": "PROJECTION", "opid": "6", "children": [{"name": "HASH_GROUP_BY", "opid": "5", "children": [{"name": "PROJECTION", "opid": "4", "children": [{"name": "PROJECTION", "opid": "3", "children": [{"name": "HASH_JOIN", "opid": "2", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_partkey\nl_quantity\n[INFOSEPARATOR]\nEC: 6001215"},{"name": "DELIM_SCAN", "opid": "1", "children": [],"table": "","extra": ""}],"table": "","extra": "INNER\nl_partkey = p_partkey\n\n[INFOSEPARATOR]\nEC: 6001215\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n#1\n#2\n"}],"table": "","extra": "p_partkey\nl_quantity\n"}],"table": "","extra": "#0\navg(#1)"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n#1\n"}],"table": "","extra": "(0.2 * avg(l_quantity))\np_partkey\n"},{"name": "DUMMY_SCAN", "opid": "8", "children": [],"table": "","extra": ""}],"table": "","extra": "RIGHT\np_partkey IS NOT DISTINCT FROM p_partkey\n\n[INFOSEPARATOR]\nEC: 3000607\n"},{"name": "HASH_JOIN", "opid": "13", "children": [{"name": "SEQ_SCAN ", "opid": "11", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_partkey\nl_quantity\nl_extendedprice\n[INFOSEPARATOR]\nEC: 6001215"},{"name": "SEQ_SCAN ", "opid": "12", "children": [],"table": "part","extra": "part\n[INFOSEPARATOR]\np_partkey\n[INFOSEPARATOR]\nFilters: p_brand='Brand#23' AND p_brand IS NOT NULL\np_container='MED BOX' AND p_container IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 5000"}],"table": "","extra": "INNER\nl_partkey = p_partkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 80175\n"}],"table": "","extra": "RIGHT\np_partkey IS NOT DISTINCT FROM p_partkey\n\n[INFOSEPARATOR]\nEC: 3000607\n"}],"table": "","extra": "(CAST(l_quantity AS DOUBLE) < SUBQUERY)\n[INFOSEPARATOR]\nEC: 3000607"}],"table": "","extra": "#0\n#3\n#4\n"}],"table": "","extra": "l_extendedprice\n"}],"table": "","extra": "sum(#0)"}],"table": "","extra": "avg_yearly\n"}
%%%%%%%%%%%%%%%% Running Query #  18  threads:  8
SELECT c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, sum(l_quantity) FROM customer, orders, lineitem WHERE o_orderkey IN ( SELECT l_orderkey FROM lineitem GROUP BY l_orderkey HAVING sum(l_quantity) > 300) AND c_custkey = o_custkey AND o_orderkey = l_orderkey GROUP BY c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice ORDER BY o_totalprice DESC, o_orderdate LIMIT 100;
Run:  None SELECT c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, sum(l_quantity) FROM customer, orders, lineitem WHERE o_orderkey IN ( SELECT l_orderkey FROM lineitem GROUP BY l_orderkey HAVING sum(l_quantity) > 300) AND c_custkey = o_custkey AND o_orderkey = l_orderkey GROUP BY c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice ORDER BY o_totalprice DESC, o_orderdate LIMIT 100;
Avg Time in sec:  0.3112169452942908  output size:  57
                c_name  c_custkey  ...  o_totalprice sum(l_quantity)
0   Customer#000128120     128120  ...     544089.09           323.0
1   Customer#000144617     144617  ...     530604.44           317.0
2   Customer#000013940      13940  ...     522720.61           304.0
3   Customer#000066790      66790  ...     515531.82           327.0
4   Customer#000046435      46435  ...     508047.99           309.0
5   Customer#000015272      15272  ...     500241.33           302.0
6   Customer#000146608     146608  ...     499794.58           303.0
7   Customer#000096103      96103  ...     494398.79           312.0
8   Customer#000024341      24341  ...     491348.26           302.0
9   Customer#000137446     137446  ...     487763.25           311.0
10  Customer#000107590     107590  ...     485141.38           301.0
11  Customer#000050008      50008  ...     483891.26           302.0
12  Customer#000015619      15619  ...     480083.96           318.0
13  Customer#000077260      77260  ...     479499.43           307.0
14  Customer#000109379     109379  ...     478064.11           302.0
15  Customer#000054602      54602  ...     471220.08           307.0
16  Customer#000105995     105995  ...     469692.58           307.0
17  Customer#000148885     148885  ...     469630.44           313.0
18  Customer#000114586     114586  ...     469605.59           308.0
19  Customer#000105260     105260  ...     469360.57           303.0
20  Customer#000147197     147197  ...     467149.67           320.0
21  Customer#000064483      64483  ...     466991.35           304.0
22  Customer#000136573     136573  ...     461282.73           301.0
23  Customer#000016384      16384  ...     458378.92           312.0
24  Customer#000117919     117919  ...     456815.92           317.0
25  Customer#000012251      12251  ...     455107.26           309.0
26  Customer#000120098     120098  ...     453451.23           308.0
27  Customer#000066098      66098  ...     453436.16           304.0
28  Customer#000117076     117076  ...     449545.85           301.0
29  Customer#000129379     129379  ...     448665.79           303.0
30  Customer#000126865     126865  ...     447606.65           320.0
31  Customer#000088876      88876  ...     446717.46           304.0
32  Customer#000036619      36619  ...     446704.09           328.0
33  Customer#000141823     141823  ...     446269.12           310.0
34  Customer#000053029      53029  ...     446144.49           302.0
35  Customer#000018188      18188  ...     443807.22           308.0
36  Customer#000066533      66533  ...     443576.50           305.0
37  Customer#000037729      37729  ...     441082.97           309.0
38  Customer#000003566       3566  ...     439803.36           304.0
39  Customer#000045538      45538  ...     436275.31           305.0
40  Customer#000081581      81581  ...     435405.90           305.0
41  Customer#000119989     119989  ...     434568.25           320.0
42  Customer#000003680       3680  ...     433525.97           301.0
43  Customer#000113131     113131  ...     432957.75           301.0
44  Customer#000141098     141098  ...     430986.69           301.0
45  Customer#000093392      93392  ...     425487.51           304.0
46  Customer#000015631      15631  ...     419879.59           302.0
47  Customer#000112987     112987  ...     418161.49           305.0
48  Customer#000012599      12599  ...     415200.61           304.0
49  Customer#000105410     105410  ...     412754.51           302.0
50  Customer#000149842     149842  ...     411329.35           302.0
51  Customer#000010129      10129  ...     409129.85           309.0
52  Customer#000069904      69904  ...     408513.00           305.0
53  Customer#000017746      17746  ...     408446.93           303.0
54  Customer#000013072      13072  ...     399195.47           301.0
55  Customer#000082441      82441  ...     382579.74           305.0
56  Customer#000088703      88703  ...     363812.12           302.0

[57 rows x 6 columns]
compressed filter_log_size: 6766
compressed filter_log_buffer_size: 228
compressed limit_offset_size: 3776
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 517866
compressed perfect_full_scan_ht_log_buffer_size: 513850
compressed perfect_probe_ht_log_size: 3421933
compressed perfect_probe_ht_log_buffer_size: 3410440
compressed row_group_log_size: 53435
compressed row_group_log_buffer_size: 820
compressed scatter_log_size: 20302502
compressed scatter_log_buffer_size: 20283444
compressed scatter_sel_log_size: 7743654
compressed scatter_sel_log_buffer_size: 7727729
compressed gather_log_size: 3632
compressed gather_log_buffer_size: 0
compressed combine_log_size: 121190
compressed combine_log_buffer_size: 107897
compressed finalize_states_log_size: 631520
compressed finalize_states_log_buffer_size: 620924
compressed join_gather_log_size: 19621365
compressed join_gather_log_buffer_size: 19426799
compressed reorder_log_size: 6008
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 3632
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 3632
compressed nlj_log_buffer_size: 0
compressed total_size: 52440911
compressed total_buffer_size: 52092131
compressed total_element_size: 348780

{'name': 'Query', 'result': 0.275247, 'timing': 0.275247, 'cardinality': 0, 'extra-info': 'SELECT c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, sum(l_quantity) FROM customer, orders, lineitem WHERE o_orderkey IN ( SELECT l_orderkey FROM lineitem GROUP BY l_orderkey HAVING sum(l_quantity) > 300) AND c_custkey = o_custkey AND o_orderkey = l_orderkey GROUP BY c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice ORDER BY o_totalprice DESC, o_orderdate LIMIT 100;', 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 4.9e-05, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'LIMIT', 'timing': 0.000164, 'cardinality': 57, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 3.7e-05, 'cardinality': 57, 'extra_info': '#0\n__internal_decompress_integral_bigint(#1, 1)\n__internal_decompress_integral_bigint(#2, 1)\n#3\n#4\n#5\n', 'children': [{'name': 'ORDER_BY', 'timing': 0.000358, 'cardinality': 57, 'extra_info': 'ORDERS:\norders.o_totalprice DESC\norders.o_orderdate ASC', 'children': [{'name': 'PROJECTION', 'timing': 3.2e-05, 'cardinality': 57, 'extra_info': '#0\n__internal_compress_integral_uinteger(#1, 1)\n__internal_compress_integral_uinteger(#2, 1)\n#3\n#4\n#5\n', 'children': [{'name': 'PROJECTION', 'timing': 5e-05, 'cardinality': 57, 'extra_info': '#0\n__internal_decompress_integral_bigint(#1, 1)\n__internal_decompress_integral_bigint(#2, 1)\n#3\n#4\n#5\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.010116, 'cardinality': 57, 'extra_info': '#0\n#1\n#2\n#3\n#4\nsum(#5)', 'children': [{'name': 'PROJECTION', 'timing': 1.7e-05, 'cardinality': 399, 'extra_info': 'c_name\nc_custkey\no_orderkey\no_orderdate\no_totalprice\nl_quantity\n', 'children': [{'name': 'PROJECTION', 'timing': 0.000127, 'cardinality': 399, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n#1\n__internal_compress_integral_uinteger(#2, 1)\n__internal_compress_integral_uinteger(#3, 1)\n#4\n#5\n#6\n__internal_compress_integral_uinteger(#7, 1)\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.09064, 'cardinality': 399, 'extra_info': 'INNER\no_orderkey = #0\n\n[INFOSEPARATOR]\nEC: 3618677\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.792939, 'cardinality': 6001215, 'extra_info': 'INNER\nl_orderkey = o_orderkey\n\n[INFOSEPARATOR]\nEC: 3618677\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.013486, 'cardinality': 6001215, 'extra_info': 'lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_quantity\n[INFOSEPARATOR]\nEC: 6001215', 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.053883, 'cardinality': 1500000, 'extra_info': 'INNER\no_custkey = c_custkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 149999\n\n[INFOSEPARATOR]\nEC: 904486\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.006709, 'cardinality': 1500000, 'extra_info': 'orders\n[INFOSEPARATOR]\no_orderkey\no_custkey\no_orderdate\no_totalprice\n[INFOSEPARATOR]\nEC: 1500000', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 0.004288, 'cardinality': 149999, 'extra_info': 'customer\n[INFOSEPARATOR]\nc_custkey\nc_name\n[INFOSEPARATOR]\nFilters: c_custkey<=149999 AND c_custkey IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 150000', 'children': []}]}]}, {'name': 'PROJECTION', 'timing': 2.4e-05, 'cardinality': 57, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.003614, 'cardinality': 57, 'extra_info': '#0', 'children': [{'name': 'PROJECTION', 'timing': 5e-06, 'cardinality': 57, 'extra_info': '#0\n', 'children': [{'name': 'PROJECTION', 'timing': 2e-05, 'cardinality': 57, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n', 'children': [{'name': 'PROJECTION', 'timing': 7e-06, 'cardinality': 57, 'extra_info': 'l_orderkey\n', 'children': [{'name': 'FILTER', 'timing': 0.005082, 'cardinality': 57, 'extra_info': '(sum(l_quantity) > 300.00)\n[INFOSEPARATOR]\nEC: 47042', 'children': [{'name': 'PROJECTION', 'timing': 0.001462, 'cardinality': 1500000, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n#1\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.605824, 'cardinality': 1500000, 'extra_info': '#0\nsum_no_overflow(#1)', 'children': [{'name': 'PROJECTION', 'timing': 0.00109, 'cardinality': 6001215, 'extra_info': 'l_orderkey\nl_quantity\n', 'children': [{'name': 'PROJECTION', 'timing': 0.0111, 'cardinality': 6001215, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n#1\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.019625, 'cardinality': 6001215, 'extra_info': 'lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_quantity\n[INFOSEPARATOR]\nEC: 6001215', 'children': []}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}
X {'RESULT_COLLECTOR0': 4.9e-05, 'LIMIT1': 0.000164, 'PROJECTION2': 3.7e-05, 'ORDER_BY3': 0.000358, 'PROJECTION4': 3.2e-05, 'PROJECTION5': 5e-05, 'HASH_GROUP_BY6': 0.010116, 'PROJECTION7': 1.7e-05, 'PROJECTION8': 0.000127, 'HASH_JOIN9': 0.09064, 'HASH_JOIN10': 0.792939, 'SEQ_SCAN 11': 0.013486, 'HASH_JOIN12': 0.053883, 'SEQ_SCAN 13': 0.006709, 'SEQ_SCAN 14': 0.004288, 'PROJECTION15': 2.4e-05, 'HASH_GROUP_BY16': 0.003614, 'PROJECTION17': 5e-06, 'PROJECTION18': 2e-05, 'PROJECTION19': 7e-06, 'FILTER20': 0.005082, 'PROJECTION21': 0.001462, 'HASH_GROUP_BY22': 0.605824, 'PROJECTION23': 0.00109, 'PROJECTION24': 0.0111, 'SEQ_SCAN 25': 0.019625}
**** output size:  57
LINEAGE_5_FILTER_10
LINEAGE_5_HASH_GROUP_BY_14
LINEAGE_5_HASH_GROUP_BY_19
LINEAGE_5_HASH_GROUP_BY_8
LINEAGE_5_HASH_JOIN_16
LINEAGE_5_HASH_JOIN_3
LINEAGE_5_HASH_JOIN_4
LINEAGE_5_LIMIT_24
LINEAGE_5_ORDER_BY_22
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_1
LINEAGE_5_SEQ_SCAN_2
LINEAGE_5_SEQ_SCAN_5
SELECT c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, sum(l_quantity) FROM customer, orders, lineitem WHERE o_orderkey IN ( SELECT l_orderkey FROM lineitem GROUP BY l_orderkey HAVING sum(l_quantity) > 300) AND c_custkey = o_custkey AND o_orderkey = l_orderkey GROUP BY c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice ORDER BY o_totalprice DESC, o_orderdate LIMIT 100;
   query_id  ...                                               plan
0         5  ...  {"name": "LIMIT", "opid": "24", "children": [{...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               SELECT c_name, c_custkey, o_orderkey, o_orderd...
size_bytes_max                                               52440911
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "LIMIT", "opid": "24", "children": [{...
Name: 0, dtype: object
{"name": "LIMIT", "opid": "24", "children": [{"name": "PROJECTION", "opid": "23", "children": [{"name": "ORDER_BY", "opid": "22", "children": [{"name": "PROJECTION", "opid": "21", "children": [{"name": "PROJECTION", "opid": "20", "children": [{"name": "HASH_GROUP_BY", "opid": "19", "children": [{"name": "PROJECTION", "opid": "18", "children": [{"name": "PROJECTION", "opid": "17", "children": [{"name": "HASH_JOIN", "opid": "16", "children": [{"name": "HASH_JOIN", "opid": "4", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_quantity\n[INFOSEPARATOR]\nEC: 6001215"},{"name": "HASH_JOIN", "opid": "3", "children": [{"name": "SEQ_SCAN ", "opid": "1", "children": [],"table": "orders","extra": "orders\n[INFOSEPARATOR]\no_orderkey\no_custkey\no_orderdate\no_totalprice\n[INFOSEPARATOR]\nEC: 1500000"},{"name": "SEQ_SCAN ", "opid": "2", "children": [],"table": "customer","extra": "customer\n[INFOSEPARATOR]\nc_custkey\nc_name\n[INFOSEPARATOR]\nFilters: c_custkey<=149999 AND c_custkey IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 150000"}],"table": "","extra": "INNER\no_custkey = c_custkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 149999\n\n[INFOSEPARATOR]\nEC: 904486\n"}],"table": "","extra": "INNER\nl_orderkey = o_orderkey\n\n[INFOSEPARATOR]\nEC: 3618677\n"},{"name": "PROJECTION", "opid": "15", "children": [{"name": "HASH_GROUP_BY", "opid": "14", "children": [{"name": "PROJECTION", "opid": "13", "children": [{"name": "PROJECTION", "opid": "12", "children": [{"name": "PROJECTION", "opid": "11", "children": [{"name": "FILTER", "opid": "10", "children": [{"name": "PROJECTION", "opid": "9", "children": [{"name": "HASH_GROUP_BY", "opid": "8", "children": [{"name": "PROJECTION", "opid": "7", "children": [{"name": "PROJECTION", "opid": "6", "children": [{"name": "SEQ_SCAN ", "opid": "5", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_quantity\n[INFOSEPARATOR]\nEC: 6001215"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n#1\n"}],"table": "","extra": "l_orderkey\nl_quantity\n"}],"table": "","extra": "#0\nsum_no_overflow(#1)"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n#1\n"}],"table": "","extra": "(sum(l_quantity) > 300.00)\n[INFOSEPARATOR]\nEC: 47042"}],"table": "","extra": "l_orderkey\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n"}],"table": "","extra": "#0\n"}],"table": "","extra": "#0"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n"}],"table": "","extra": "INNER\no_orderkey = #0\n\n[INFOSEPARATOR]\nEC: 3618677\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n#1\n__internal_compress_integral_uinteger(#2, 1)\n__internal_compress_integral_uinteger(#3, 1)\n#4\n#5\n#6\n__internal_compress_integral_uinteger(#7, 1)\n"}],"table": "","extra": "c_name\nc_custkey\no_orderkey\no_orderdate\no_totalprice\nl_quantity\n"}],"table": "","extra": "#0\n#1\n#2\n#3\n#4\nsum(#5)"}],"table": "","extra": "#0\n__internal_decompress_integral_bigint(#1, 1)\n__internal_decompress_integral_bigint(#2, 1)\n#3\n#4\n#5\n"}],"table": "","extra": "#0\n__internal_compress_integral_uinteger(#1, 1)\n__internal_compress_integral_uinteger(#2, 1)\n#3\n#4\n#5\n"}],"table": "","extra": "ORDERS:\norders.o_totalprice DESC\norders.o_orderdate ASC"}],"table": "","extra": "#0\n__internal_decompress_integral_bigint(#1, 1)\n__internal_decompress_integral_bigint(#2, 1)\n#3\n#4\n#5\n"}],"table": "","extra": ""}
Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                             
│    UNGROUPED_AGGREGATE    │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│          sum(#0)          │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│ (l_extendedprice * (1.00 -│                             
│        l_discount))       │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│             #1            │                             
│             #2            │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│             #1            │                             
│             #3            │                             
│             #4            │                             
│             #6            │                             
│             #7            │                             
│             #8            │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│           FILTER          │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│(((l_quantity <= 11.00) AND│                             
│ (p_size <= 5) AND (p_brand│                             
│     = 'Brand#12') AND (   │                             
│(p_container = 'SM CAS...  │                             
│(p_container = 'SM BOX...  │                             
│(p_container = 'SM PAC...  │                             
│(p_container = 'SM PKG...  │                             
│ ((l_quantity >= 10.00) AND│                             
│ (l_quantity <= 20.00) AND │                             
│(p_size <= 10) AND (p_brand│                             
│     = 'Brand#23') AND (   │                             
│(p_container = 'MED BA...  │                             
│(p_container = 'MED BO...  │                             
│(p_container = 'MED PK...  │                             
│(p_container = 'MED PA...  │                             
│  OR ((l_quantity >= 20.00)│                             
│  AND (l_quantity <= 30.00)│                             
│   AND (p_size <= 15) AND  │                             
│(p_brand = 'Brand#34')...  │                             
│(p_container = 'LG CAS...  │                             
│(p_container = 'LG BOX...  │                             
│(p_container = 'LG PAC...  │                             
│ (p_container = 'LG PKG')))│                             
│             )             │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│         EC: 160351        │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         HASH_JOIN         │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│           INNER           │                             
│   l_partkey = p_partkey   │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐              
│        Build Min: 1       │              │              
│     Build Max: 200000     │              │              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              
│         EC: 160351        │              │              
└─────────────┬─────────────┘              │                                           
┌─────────────┴─────────────┐┌─────────────┴─────────────┐
│           FILTER          ││         SEQ_SCAN          │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│ ((l_shipmode = 'AIR') OR  ││            part           │
│ (l_shipmode = 'AIR REG')) ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││         p_partkey         │
│         EC: 300060        ││          p_brand          │
│                           ││        p_container        │
│                           ││           p_size          │
│                           ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│                           ││         EC: 200000        │
└─────────────┬─────────────┘└───────────────────────────┘                             
┌─────────────┴─────────────┐                             
│         SEQ_SCAN          │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│          lineitem         │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│         l_partkey         │                             
│         l_quantity        │                             
│         l_shipmode        │                             
│      l_extendedprice      │                             
│         l_discount        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│  Filters: l_shipinstruct= │                             
│  'DELIVER IN PERSON' AND  │                             
│ l_shipinstruct IS NOT NULL│                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│         EC: 300060        │                             
└───────────────────────────┘                                                          

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

compressed filter_log_size: 260584
compressed filter_log_buffer_size: 223760
compressed limit_offset_size: 1424
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 486128
compressed perfect_full_scan_ht_log_buffer_size: 484320
compressed perfect_probe_ht_log_size: 689483
compressed perfect_probe_ht_log_buffer_size: 649058
compressed row_group_log_size: 796394
compressed row_group_log_buffer_size: 753113
compressed scatter_log_size: 1424
compressed scatter_log_buffer_size: 0
compressed scatter_sel_log_size: 896950
compressed scatter_sel_log_buffer_size: 894017
compressed gather_log_size: 1424
compressed gather_log_buffer_size: 0
compressed combine_log_size: 1424
compressed combine_log_buffer_size: 0
compressed finalize_states_log_size: 1424
compressed finalize_states_log_buffer_size: 0
compressed join_gather_log_size: 1424
compressed join_gather_log_buffer_size: 0
compressed reorder_log_size: 2136
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 1424
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 1424
compressed nlj_log_buffer_size: 0
compressed total_size: 3143067
compressed total_buffer_size: 3004268
compressed total_element_size: 138799

%%%%%%%%%%%%%%%% Running Query #  19  threads:  8
SELECT sum(l_extendedprice * (1 - l_discount)) AS revenue FROM lineitem, part WHERE (p_partkey = l_partkey AND p_brand = 'Brand#12' AND p_container IN ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') AND l_quantity >= 1 AND l_quantity <= 1 + 10 AND p_size BETWEEN 1 AND 5 AND l_shipmode IN ('AIR', 'AIR REG') AND l_shipinstruct = 'DELIVER IN PERSON') OR (p_partkey = l_partkey AND p_brand = 'Brand#23' AND p_container IN ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') AND l_quantity >= 10 AND l_quantity <= 10 + 10 AND p_size BETWEEN 1 AND 10 AND l_shipmode IN ('AIR', 'AIR REG') AND l_shipinstruct = 'DELIVER IN PERSON') OR (p_partkey = l_partkey AND p_brand = 'Brand#34' AND p_container IN ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') AND l_quantity >= 20 AND l_quantity <= 20 + 10 AND p_size BETWEEN 1 AND 15 AND l_shipmode IN ('AIR', 'AIR REG') AND l_shipinstruct = 'DELIVER IN PERSON');
Run:  None SELECT sum(l_extendedprice * (1 - l_discount)) AS revenue FROM lineitem, part WHERE (p_partkey = l_partkey AND p_brand = 'Brand#12' AND p_container IN ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') AND l_quantity >= 1 AND l_quantity <= 1 + 10 AND p_size BETWEEN 1 AND 5 AND l_shipmode IN ('AIR', 'AIR REG') AND l_shipinstruct = 'DELIVER IN PERSON') OR (p_partkey = l_partkey AND p_brand = 'Brand#23' AND p_container IN ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') AND l_quantity >= 10 AND l_quantity <= 10 + 10 AND p_size BETWEEN 1 AND 10 AND l_shipmode IN ('AIR', 'AIR REG') AND l_shipinstruct = 'DELIVER IN PERSON') OR (p_partkey = l_partkey AND p_brand = 'Brand#34' AND p_container IN ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') AND l_quantity >= 20 AND l_quantity <= 20 + 10 AND p_size BETWEEN 1 AND 15 AND l_shipmode IN ('AIR', 'AIR REG') AND l_shipinstruct = 'DELIVER IN PERSON');
Avg Time in sec:  0.129626773763448  output size:  1
        revenue
0  3.083843e+06
{'name': 'Query', 'result': 0.126192, 'timing': 0.126192, 'cardinality': 0, 'extra-info': "SELECT sum(l_extendedprice * (1 - l_discount)) AS revenue FROM lineitem, part WHERE (p_partkey = l_partkey AND p_brand = 'Brand#12' AND p_container IN ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') AND l_quantity >= 1 AND l_quantity <= 1 + 10 AND p_size BETWEEN 1 AND 5 AND l_shipmode IN ('AIR', 'AIR REG') AND l_shipinstruct = 'DELIVER IN PERSON') OR (p_partkey = l_partkey AND p_brand = 'Brand#23' AND p_container IN ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') AND l_quantity >= 10 AND l_quantity <= 10 + 10 AND p_size BETWEEN 1 AND 10 AND l_shipmode IN ('AIR', 'AIR REG') AND l_shipinstruct = 'DELIVER IN PERSON') OR (p_partkey = l_partkey AND p_brand = 'Brand#34' AND p_container IN ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') AND l_quantity >= 20 AND l_quantity <= 20 + 10 AND p_size BETWEEN 1 AND 15 AND l_shipmode IN ('AIR', 'AIR REG') AND l_shipinstruct = 'DELIVER IN PERSON');", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 5e-06, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'UNGROUPED_AGGREGATE', 'timing': 2.3e-05, 'cardinality': 1, 'extra_info': 'sum(#0)', 'children': [{'name': 'PROJECTION', 'timing': 3.5e-05, 'cardinality': 121, 'extra_info': '(l_extendedprice * (1.00 - l_discount))\n', 'children': [{'name': 'PROJECTION', 'timing': 7e-06, 'cardinality': 121, 'extra_info': '#1\n#2\n', 'children': [{'name': 'PROJECTION', 'timing': 2e-05, 'cardinality': 121, 'extra_info': '#1\n#3\n#4\n#6\n#7\n#8\n', 'children': [{'name': 'FILTER', 'timing': 0.079592, 'cardinality': 121, 'extra_info': "(((l_quantity <= 11.00) AND (p_size <= 5) AND (p_brand = 'Brand#12') AND ((p_container = 'SM CASE') OR (p_container = 'SM BOX') OR (p_container = 'SM PACK') OR (p_container = 'SM PKG'))) OR ((l_quantity >= 10.00) AND (l_quantity <= 20.00) AND (p_size <= 10) AND (p_brand = 'Brand#23') AND ((p_container = 'MED BAG') OR (p_container = 'MED BOX') OR (p_container = 'MED PKG') OR (p_container = 'MED PACK'))) OR ((l_quantity >= 20.00) AND (l_quantity <= 30.00) AND (p_size <= 15) AND (p_brand = 'Brand#34') AND ((p_container = 'LG CASE') OR (p_container = 'LG BOX') OR (p_container = 'LG PACK') OR (p_container = 'LG PKG'))))\n[INFOSEPARATOR]\nEC: 160351", 'children': [{'name': 'HASH_JOIN', 'timing': 0.046353, 'cardinality': 214377, 'extra_info': 'INNER\nl_partkey = p_partkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 160351\n', 'children': [{'name': 'FILTER', 'timing': 0.049068, 'cardinality': 214377, 'extra_info': "((l_shipmode = 'AIR') OR (l_shipmode = 'AIR REG'))\n[INFOSEPARATOR]\nEC: 300060", 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.417394, 'cardinality': 1500048, 'extra_info': "lineitem\n[INFOSEPARATOR]\nl_partkey\nl_quantity\nl_shipmode\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nFilters: l_shipinstruct='DELIVER IN PERSON' AND l_shipinstruct IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 300060", 'children': []}]}, {'name': 'SEQ_SCAN ', 'timing': 0.01338, 'cardinality': 200000, 'extra_info': 'part\n[INFOSEPARATOR]\np_partkey\np_brand\np_container\np_size\n[INFOSEPARATOR]\nEC: 200000', 'children': []}]}]}]}]}]}]}]}]}
X {'RESULT_COLLECTOR0': 5e-06, 'UNGROUPED_AGGREGATE1': 2.3e-05, 'PROJECTION2': 3.5e-05, 'PROJECTION3': 7e-06, 'PROJECTION4': 2e-05, 'FILTER5': 0.079592, 'HASH_JOIN6': 0.046353, 'FILTER7': 0.049068, 'SEQ_SCAN 8': 0.417394, 'SEQ_SCAN 9': 0.01338}
**** output size:  1
LINEAGE_5_FILTER_1
LINEAGE_5_FILTER_4
LINEAGE_5_HASH_JOIN_3
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_2
SELECT sum(l_extendedprice * (1 - l_discount)) AS revenue FROM lineitem, part WHERE (p_partkey = l_partkey AND p_brand = 'Brand#12' AND p_container IN ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') AND l_quantity >= 1 AND l_quantity <= 1 + 10 AND p_size BETWEEN 1 AND 5 AND l_shipmode IN ('AIR', 'AIR REG') AND l_shipinstruct = 'DELIVER IN PERSON') OR (p_partkey = l_partkey AND p_brand = 'Brand#23' AND p_container IN ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') AND l_quantity >= 10 AND l_quantity <= 10 + 10 AND p_size BETWEEN 1 AND 10 AND l_shipmode IN ('AIR', 'AIR REG') AND l_shipinstruct = 'DELIVER IN PERSON') OR (p_partkey = l_partkey AND p_brand = 'Brand#34' AND p_container IN ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') AND l_quantity >= 20 AND l_quantity <= 20 + 10 AND p_size BETWEEN 1 AND 15 AND l_shipmode IN ('AIR', 'AIR REG') AND l_shipinstruct = 'DELIVER IN PERSON');
   query_id  ...                                               plan
0         5  ...  {"name": "UNGROUPED_AGGREGATE", "opid": "8", "...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               SELECT sum(l_extendedprice * (1 - l_discount))...
size_bytes_max                                                3143067
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "UNGROUPED_AGGREGATE", "opid": "8", "...
Name: 0, dtype: object
{"name": "UNGROUPED_AGGREGATE", "opid": "8", "children": [{"name": "PROJECTION", "opid": "7", "children": [{"name": "PROJECTION", "opid": "6", "children": [{"name": "PROJECTION", "opid": "5", "children": [{"name": "FILTER", "opid": "4", "children": [{"name": "HASH_JOIN", "opid": "3", "children": [{"name": "FILTER", "opid": "1", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_partkey\nl_quantity\nl_shipmode\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nFilters: l_shipinstruct='DELIVER IN PERSON' AND l_shipinstruct IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 300060"}],"table": "","extra": "((l_shipmode = 'AIR') OR (l_shipmode = 'AIR REG'))\n[INFOSEPARATOR]\nEC: 300060"},{"name": "SEQ_SCAN ", "opid": "2", "children": [],"table": "part","extra": "part\n[INFOSEPARATOR]\np_partkey\np_brand\np_container\np_size\n[INFOSEPARATOR]\nEC: 200000"}],"table": "","extra": "INNER\nl_partkey = p_partkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 160351\n"}],"table": "","extra": "(((l_quantity <= 11.00) AND (p_size <= 5) AND (p_brand = 'Brand#12') AND ((p_container = 'SM CASE') OR (p_container = 'SM BOX') OR (p_container = 'SM PACK') OR (p_container = 'SM PKG'))) OR ((l_quantity >= 10.00) AND (l_quantity <= 20.00) AND (p_size <= 10) AND (p_brand = 'Brand#23') AND ((p_container = 'MED BAG') OR (p_container = 'MED BOX') OR (p_container = 'MED PKG') OR (p_container = 'MED PACK'))) OR ((l_quantity >= 20.00) AND (l_quantity <= 30.00) AND (p_size <= 15) AND (p_brand = 'Brand#34') AND ((p_container = 'LG CASE') OR (p_container = 'LG BOX') OR (p_container = 'LG PACK') OR (p_container = 'LG PKG'))))\n[INFOSEPARATOR]\nEC: 160351"}],"table": "","extra": "#1\n#3\n#4\n#6\n#7\n#8\n"}],"table": "","extra": "#1\n#2\n"}],"table": "","extra": "(l_extendedprice * (1.00 - l_discount))\n"}],"table": "","extra": "sum(#0)"}
Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                                                                                                                                                                              
│          ORDER_BY         │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│          ORDERS:          │                                                                                                                                                                              
│    supplier.s_name ASC    │                                                                                                                                                                              
└─────────────┬─────────────┘                                                                                                                                                                                                           
┌─────────────┴─────────────┐                                                                                                                                                                              
│         PROJECTION        │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│           s_name          │                                                                                                                                                                              
│         s_address         │                                                                                                                                                                              
└─────────────┬─────────────┘                                                                                                                                                                                                           
┌─────────────┴─────────────┐                                                                                                                                                                              
│         HASH_JOIN         │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│           INNER           │                                                                                                                                                                              
│       #0 = s_suppkey      │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐                                           
│        Build Min: 1       │                                                                                                                                  │                                           
│      Build Max: 10000     │                                                                                                                                  │                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                  │                                           
│          EC: 400          │                                                                                                                                  │                                           
└─────────────┬─────────────┘                                                                                                                                  │                                                                        
┌─────────────┴─────────────┐                                                                                                                    ┌─────────────┴─────────────┐                             
│         PROJECTION        │                                                                                                                    │         HASH_JOIN         │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│__internal_decompress_integ│                                                                                                                    │           INNER           │                             
│     ral_bigint(#0, 1)     │                                                                                                                    │ s_nationkey = n_nationkey │                             
│                           │                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐              
│                           │                                                                                                                    │        Build Min: 0       │              │              
│                           │                                                                                                                    │       Build Max: 24       │              │              
│                           │                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              
│                           │                                                                                                                    │          EC: 400          │              │              
└─────────────┬─────────────┘                                                                                                                    └─────────────┬─────────────┘              │                                           
┌─────────────┴─────────────┐                                                                                                                    ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
│       HASH_GROUP_BY       │                                                                                                                    │         SEQ_SCAN          ││         SEQ_SCAN          │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│             #0            │                                                                                                                    │          supplier         ││           nation          │
│                           │                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│                           │                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│                           │                                                                                                                    │         EC: 10000         ││  Filters: n_name='CANADA' │
│                           │                                                                                                                    │                           ││   AND n_name IS NOT NULL  │
│                           │                                                                                                                    │                           ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│                           │                                                                                                                    │                           ││           EC: 1           │
└─────────────┬─────────────┘                                                                                                                    └───────────────────────────┘└───────────────────────────┘                             
┌─────────────┴─────────────┐                                                                                                                                                                              
│         PROJECTION        │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│             #0            │                                                                                                                                                                              
└─────────────┬─────────────┘                                                                                                                                                                                                           
┌─────────────┴─────────────┐                                                                                                                                                                              
│         PROJECTION        │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│__internal_compress_integra│                                                                                                                                                                              
│     l_usmallint(#0, 1)    │                                                                                                                                                                              
└─────────────┬─────────────┘                                                                                                                                                                                                           
┌─────────────┴─────────────┐                                                                                                                                                                              
│         PROJECTION        │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│         ps_suppkey        │                                                                                                                                                                              
└─────────────┬─────────────┘                                                                                                                                                                                                           
┌─────────────┴─────────────┐                                                                                                                                                                              
│         PROJECTION        │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│             #0            │                                                                                                                                                                              
│             #4            │                                                                                                                                                                              
│             #5            │                                                                                                                                                                              
└─────────────┬─────────────┘                                                                                                                                                                                                           
┌─────────────┴─────────────┐                                                                                                                                                                              
│           FILTER          │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│    (CAST(ps_availqty AS   │                                                                                                                                                                              
│ DECIMAL(38,3)) > SUBQUERY)│                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│         EC: 800000        │                                                                                                                                                                              
└─────────────┬─────────────┘                                                                                                                                                                                                           
┌─────────────┴─────────────┐                                                                                                                                                                              
│      RIGHT_DELIM_JOIN     │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│           RIGHT           │                                                                                                                                                                              
│ ps_partkey IS NOT DISTINCT│                                                                                                                                                                              
│       FROM ps_partkey     ├───────────────────────────────────────────┐                                                                                                                                  
│ ps_suppkey IS NOT DISTINCT│                                           │                                                                                                                                  
│       FROM ps_suppkey     │                                           │                                                                                                                                  
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                           │                                                                                                                                  
│         EC: 800000        │                                           │                                                                                                                                  
└─────────────┬─────────────┘                                           │                                                                                                                                                               
┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐                                                                                                                    
│         HASH_JOIN         │                             │         HASH_JOIN         │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│           INNER           │                             │           RIGHT           │                                                                                                                    
│      ps_partkey = #0      │                             │ ps_partkey IS NOT DISTINCT│                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐              │       FROM ps_partkey     ├───────────────────────────────────────────┐                                                                        
│        Build Min: 1       │              │              │ ps_suppkey IS NOT DISTINCT│                                           │                                                                        
│     Build Max: 200000     │              │              │       FROM ps_suppkey     │                                           │                                                                        
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                           │                                                                        
│         EC: 800000        │              │              │         EC: 800000        │                                           │                                                                        
└─────────────┬─────────────┘              │              └─────────────┬─────────────┘                                           │                                                                                                     
┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐                                                          
│         SEQ_SCAN          ││         PROJECTION        ││         PROJECTION        │                             │         DUMMY_SCAN        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │                           │                                                          
│          partsupp         ││__internal_decompress_integ││  (0.5 * sum(l_quantity))  │                             │                           │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││     ral_bigint(#0, 1)     ││         ps_partkey        │                             │                           │                                                          
│         ps_partkey        ││                           ││         ps_suppkey        │                             │                           │                                                          
│        ps_availqty        ││                           ││                           │                             │                           │                                                          
│         ps_suppkey        ││                           ││                           │                             │                           │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           ││                           │                             │                           │                                                          
│         EC: 800000        ││                           ││                           │                             │                           │                                                          
└───────────────────────────┘└─────────────┬─────────────┘└─────────────┬─────────────┘                             └───────────────────────────┘                                                                                       
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                                                    
                             │       HASH_GROUP_BY       ││         PROJECTION        │                                                                                                                    
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
                             │             #0            ││__internal_decompress_integ│                                                                                                                    
                             │                           ││     ral_bigint(#0, 1)     │                                                                                                                    
                             │                           ││__internal_decompress_integ│                                                                                                                    
                             │                           ││     ral_bigint(#1, 1)     │                                                                                                                    
                             │                           ││             #2            │                                                                                                                    
                             └─────────────┬─────────────┘└─────────────┬─────────────┘                                                                                                                                                 
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                                                    
                             │         PROJECTION        ││       HASH_GROUP_BY       │                                                                                                                    
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
                             │             #0            ││             #0            │                                                                                                                    
                             │                           ││             #1            │                                                                                                                    
                             │                           ││          sum(#2)          │                                                                                                                    
                             └─────────────┬─────────────┘└─────────────┬─────────────┘                                                                                                                                                 
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                                                    
                             │         PROJECTION        ││         PROJECTION        │                                                                                                                    
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
                             │__internal_compress_integra││         ps_partkey        │                                                                                                                    
                             │     l_uinteger(#0, 1)     ││         ps_suppkey        │                                                                                                                    
                             │                           ││         l_quantity        │                                                                                                                    
                             └─────────────┬─────────────┘└─────────────┬─────────────┘                                                                                                                                                 
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                                                    
                             │         PROJECTION        ││         PROJECTION        │                                                                                                                    
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
                             │         p_partkey         ││__internal_compress_integra│                                                                                                                    
                             │                           ││     l_uinteger(#0, 1)     │                                                                                                                    
                             │                           ││__internal_compress_integra│                                                                                                                    
                             │                           ││     l_usmallint(#1, 1)    │                                                                                                                    
                             │                           ││             #2            │                                                                                                                    
                             │                           ││             #3            │                                                                                                                    
                             │                           ││             #4            │                                                                                                                    
                             └─────────────┬─────────────┘└─────────────┬─────────────┘                                                                                                                                                 
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                                                    
                             │           FILTER          ││         HASH_JOIN         │                                                                                                                    
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
                             │  prefix(p_name, 'forest') ││           INNER           │                                                                                                                    
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   l_partkey = ps_partkey  ├──────────────┐                                                                                                     
                             │          EC: 8000         ││   l_suppkey = ps_suppkey  │              │                                                                                                     
                             │                           ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                                                                                     
                             │                           ││        EC: 1200243        │              │                                                                                                     
                             └─────────────┬─────────────┘└─────────────┬─────────────┘              │                                                                                                                                  
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                       
                             │         SEQ_SCAN          ││         SEQ_SCAN          ││         DELIM_SCAN        │                                                                                       
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                                                                       
                             │            part           ││          lineitem         ││                           │                                                                                       
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                                                                       
                             │           p_name          ││         l_partkey         ││                           │                                                                                       
                             │         p_partkey         ││         l_suppkey         ││                           │                                                                                       
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││         l_quantity        ││                           │                                                                                       
                             │ Filters: p_name>='forest' ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                                                                       
                             │   AND p_name<'foresu' AND ││ Filters: l_shipdate>='1994││                           │                                                                                       
                             │     p_name IS NOT NULL    ││-01-01'::DATE AND l_sh...  ││                           │                                                                                       
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││  <'1995-01-01'::DATE AND  ││                           │                                                                                       
                             │         EC: 40000         ││   l_shipdate IS NOT NULL  ││                           │                                                                                       
                             │                           ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                                                                       
                             │                           ││        EC: 1200243        ││                           │                                                                                       
                             └───────────────────────────┘└───────────────────────────┘└───────────────────────────┘                                                                                                                    

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

%%%%%%%%%%%%%%%% Running Query #  20  threads:  8
SELECT s_name, s_address FROM supplier, nation WHERE s_suppkey IN ( SELECT ps_suppkey FROM partsupp WHERE ps_partkey IN ( SELECT p_partkey FROM part WHERE p_name LIKE 'forest%') AND ps_availqty > ( SELECT 0.5 * sum(l_quantity) FROM lineitem WHERE l_partkey = ps_partkey AND l_suppkey = ps_suppkey AND l_shipdate >= CAST('1994-01-01' AS date) AND l_shipdate < CAST('1995-01-01' AS date))) AND s_nationkey = n_nationkey AND n_name = 'CANADA' ORDER BY s_name;
Run:  None SELECT s_name, s_address FROM supplier, nation WHERE s_suppkey IN ( SELECT ps_suppkey FROM partsupp WHERE ps_partkey IN ( SELECT p_partkey FROM part WHERE p_name LIKE 'forest%') AND ps_availqty > ( SELECT 0.5 * sum(l_quantity) FROM lineitem WHERE l_partkey = ps_partkey AND l_suppkey = ps_suppkey AND l_shipdate >= CAST('1994-01-01' AS date) AND l_shipdate < CAST('1995-01-01' AS date))) AND s_nationkey = n_nationkey AND n_name = 'CANADA' ORDER BY s_name;
Avg Time in sec:  0.0637951111420989  output size:  186
                 s_name                               s_address
0    Supplier#000000020               JtPqm19E7tF 152Rl1wQZ8j0H
1    Supplier#000000091    35WVnU7GLNbQDcc2TARavGtk6RB6ZCd46UAY
2    Supplier#000000205                            Alrx5TN,hdnG
3    Supplier#000000285           q TMZEDyZtv vUiFKBhT3NJlnIxpL
4    Supplier#000000287                       UQR8bUA4V2HxVbw9K
..                  ...                                     ...
181  Supplier#000009811                  nXIxtBT6D1v6TCb2iMYkyU
182  Supplier#000009812     rbl9euXFoPLlKQVYDVyRouslbbbKDHAkyXY
183  Supplier#000009846  WTzdvihXbyqnx0JfbbVaxBOcO9d93DYbtBhi J
184  Supplier#000009899                       U3NBqk s Zz06al2m
185  Supplier#000009974         Uvh0hWngOu96WgB,OafBQOqwpWqzwg8

[186 rows x 2 columns]
{'name': 'Query', 'result': 0.055303, 'timing': 0.055303, 'cardinality': 0, 'extra-info': "SELECT s_name, s_address FROM supplier, nation WHERE s_suppkey IN ( SELECT ps_suppkey FROM partsupp WHERE ps_partkey IN ( SELECT p_partkey FROM part WHERE p_name LIKE 'forest%') AND ps_availqty > ( SELECT 0.5 * sum(l_quantity) FROM lineitem WHERE l_partkey = ps_partkey AND l_suppkey = ps_suppkey AND l_shipdate >= CAST('1994-01-01' AS date) AND l_shipdate < CAST('1995-01-01' AS date))) AND s_nationkey = n_nationkey AND n_name = 'CANADA' ORDER BY s_name;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 6.2e-05, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'ORDER_BY', 'timing': 0.000279, 'cardinality': 186, 'extra_info': 'ORDERS:\nsupplier.s_name ASC', 'children': [{'name': 'PROJECTION', 'timing': 7e-06, 'cardinality': 186, 'extra_info': 's_name\ns_address\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.000523, 'cardinality': 186, 'extra_info': 'INNER\n#0 = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 400\n', 'children': [{'name': 'PROJECTION', 'timing': 0.000203, 'cardinality': 4397, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.005333, 'cardinality': 4397, 'extra_info': '#0', 'children': [{'name': 'PROJECTION', 'timing': 6e-06, 'cardinality': 5833, 'extra_info': '#0\n', 'children': [{'name': 'PROJECTION', 'timing': 5.1e-05, 'cardinality': 5833, 'extra_info': '__internal_compress_integral_usmallint(#0, 1)\n', 'children': [{'name': 'PROJECTION', 'timing': 6e-06, 'cardinality': 5833, 'extra_info': 'ps_suppkey\n', 'children': [{'name': 'PROJECTION', 'timing': 1.4e-05, 'cardinality': 5833, 'extra_info': '#0\n#4\n#5\n', 'children': [{'name': 'FILTER', 'timing': 0.000646, 'cardinality': 5833, 'extra_info': '(CAST(ps_availqty AS DECIMAL(38,3)) > SUBQUERY)\n[INFOSEPARATOR]\nEC: 800000', 'children': [{'name': 'RIGHT_DELIM_JOIN', 'timing': 0.006102, 'cardinality': 0, 'extra_info': 'RIGHT\nps_partkey IS NOT DISTINCT FROM ps_partkey\nps_suppkey IS NOT DISTINCT FROM ps_suppkey\n\n[INFOSEPARATOR]\nEC: 800000\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.018829, 'cardinality': 8508, 'extra_info': 'INNER\nps_partkey = #0\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 800000\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.003732, 'cardinality': 800000, 'extra_info': 'partsupp\n[INFOSEPARATOR]\nps_partkey\nps_availqty\nps_suppkey\n[INFOSEPARATOR]\nEC: 800000', 'children': []}, {'name': 'PROJECTION', 'timing': 4.1e-05, 'cardinality': 2127, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.003058, 'cardinality': 2127, 'extra_info': '#0', 'children': [{'name': 'PROJECTION', 'timing': 1e-06, 'cardinality': 2127, 'extra_info': '#0\n', 'children': [{'name': 'PROJECTION', 'timing': 7e-06, 'cardinality': 2127, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n', 'children': [{'name': 'PROJECTION', 'timing': 2e-06, 'cardinality': 2127, 'extra_info': 'p_partkey\n', 'children': [{'name': 'FILTER', 'timing': 0.000967, 'cardinality': 2127, 'extra_info': "prefix(p_name, 'forest')\n[INFOSEPARATOR]\nEC: 8000", 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.016581, 'cardinality': 2127, 'extra_info': "part\n[INFOSEPARATOR]\np_name\np_partkey\n[INFOSEPARATOR]\nFilters: p_name>='forest' AND p_name<'foresu' AND p_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 40000", 'children': []}]}]}]}]}]}]}]}, {'name': 'HASH_JOIN', 'timing': 0.00161, 'cardinality': 8508, 'extra_info': 'RIGHT\nps_partkey IS NOT DISTINCT FROM ps_partkey\nps_suppkey IS NOT DISTINCT FROM ps_suppkey\n\n[INFOSEPARATOR]\nEC: 800000\n', 'children': [{'name': 'PROJECTION', 'timing': 0.000237, 'cardinality': 5843, 'extra_info': '(0.5 * sum(l_quantity))\nps_partkey\nps_suppkey\n', 'children': [{'name': 'PROJECTION', 'timing': 5.1e-05, 'cardinality': 5843, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n__internal_decompress_integral_bigint(#1, 1)\n#2\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.006807, 'cardinality': 5843, 'extra_info': '#0\n#1\nsum(#2)', 'children': [{'name': 'PROJECTION', 'timing': 1e-05, 'cardinality': 9741, 'extra_info': 'ps_partkey\nps_suppkey\nl_quantity\n', 'children': [{'name': 'PROJECTION', 'timing': 8.7e-05, 'cardinality': 9741, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n__internal_compress_integral_usmallint(#1, 1)\n#2\n#3\n#4\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.076384, 'cardinality': 9741, 'extra_info': 'INNER\nl_partkey = ps_partkey\nl_suppkey = ps_suppkey\n\n[INFOSEPARATOR]\nEC: 1200243\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.076005, 'cardinality': 909455, 'extra_info': "lineitem\n[INFOSEPARATOR]\nl_partkey\nl_suppkey\nl_quantity\n[INFOSEPARATOR]\nFilters: l_shipdate>='1994-01-01'::DATE AND l_shipdate<'1995-01-01'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243", 'children': []}, {'name': 'DELIM_SCAN', 'timing': 0.0, 'cardinality': 0, 'extra_info': '', 'children': []}]}]}]}]}]}]}, {'name': 'DUMMY_SCAN', 'timing': 0.0, 'cardinality': 0, 'extra_info': '', 'children': []}]}, {'name': 'HASH_GROUP_BY', 'timing': 0.002953, 'cardinality': 8508, 'extra_info': '#0\n#2', 'children': []}]}]}]}]}]}]}]}]}, {'name': 'HASH_JOIN', 'timing': 0.000135, 'cardinality': 412, 'extra_info': 'INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 400\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.000511, 'cardinality': 10000, 'extra_info': 'supplier\n[INFOSEPARATOR]\n\n[INFOSEPARATOR]\nEC: 10000', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 6.4e-05, 'cardinality': 1, 'extra_info': "nation\n[INFOSEPARATOR]\n\n[INFOSEPARATOR]\nFilters: n_name='CANADA' AND n_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1", 'children': []}]}]}]}]}]}]}
X {'RESULT_COLLECTOR0': 6.2e-05, 'ORDER_BY1': 0.000279, 'PROJECTION2': 7e-06, 'HASH_JOIN3': 0.000523, 'PROJECTION4': 0.000203, 'HASH_GROUP_BY5': 0.005333, 'PROJECTION6': 6e-06, 'PROJECTION7': 5.1e-05, 'PROJECTION8': 6e-06, 'PROJECTION9': 1.4e-05, 'FILTER10': 0.000646, 'RIGHT_DELIM_JOIN11': 0.006102, 'HASH_JOIN12': 0.018829, 'SEQ_SCAN 13': 0.003732, 'PROJECTION14': 4.1e-05, 'HASH_GROUP_BY15': 0.003058, 'PROJECTION16': 1e-06, 'PROJECTION17': 7e-06, 'PROJECTION18': 2e-06, 'FILTER19': 0.000967, 'SEQ_SCAN 20': 0.016581, 'HASH_JOIN21': 0.00161, 'PROJECTION22': 0.000237, 'PROJECTION23': 5.1e-05, 'HASH_GROUP_BY24': 0.006807, 'PROJECTION25': 1e-05, 'PROJECTION26': 8.7e-05, 'HASH_JOIN27': 0.076384, 'SEQ_SCAN 28': 0.076005, 'DELIM_SCAN29': 0.0, 'DUMMY_SCAN30': 0.0, 'HASH_GROUP_BY31': 0.002953, 'HASH_JOIN32': 0.000135, 'SEQ_SCAN 33': 0.000511, 'SEQ_SCAN 34': 6.4e-05}
compressed filter_log_size: 8808
compressed filter_log_buffer_size: 1299
compressed limit_offset_size: 4032
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 14244
compressed perfect_full_scan_ht_log_buffer_size: 9060
compressed perfect_probe_ht_log_size: 63650
compressed perfect_probe_ht_log_buffer_size: 48392
compressed row_group_log_size: 705013
compressed row_group_log_buffer_size: 653359
compressed scatter_log_size: 102071
compressed scatter_log_buffer_size: 94431
compressed scatter_sel_log_size: 83045
compressed scatter_sel_log_buffer_size: 73226
compressed gather_log_size: 4032
compressed gather_log_buffer_size: 0
compressed combine_log_size: 244795
compressed combine_log_buffer_size: 235317
compressed finalize_states_log_size: 13164
compressed finalize_states_log_buffer_size: 4668
compressed join_gather_log_size: 214438
compressed join_gather_log_buffer_size: 154424
compressed reorder_log_size: 6757
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 4032
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 4032
compressed nlj_log_buffer_size: 0
compressed total_size: 1472113
compressed total_buffer_size: 1274176
compressed total_element_size: 197937

Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌─────────────────────┐                                                                                                                                                                                                               
│        LIMIT        │                                                                                                                                                                                                               
└──────────┬──────────┘                                                                                                                                                                                                                                      
┌──────────┴──────────┐                                                                                                                                                                                                               
│       ORDER_BY      │                                                                                                                                                                                                               
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                               
│       ORDERS:       │                                                                                                                                                                                                               
│  count_star() DESC  │                                                                                                                                                                                                               
│ supplier.s_name ASC │                                                                                                                                                                                                               
└──────────┬──────────┘                                                                                                                                                                                                                                      
┌──────────┴──────────┐                                                                                                                                                                                                               
│    HASH_GROUP_BY    │                                                                                                                                                                                                               
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                               
│          #0         │                                                                                                                                                                                                               
│     count_star()    │                                                                                                                                                                                                               
└──────────┬──────────┘                                                                                                                                                                                                                                      
┌──────────┴──────────┐                                                                                                                                                                                                               
│      PROJECTION     │                                                                                                                                                                                                               
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                               
│        s_name       │                                                                                                                                                                                                               
└──────────┬──────────┘                                                                                                                                                                                                                                      
┌──────────┴──────────┐                                                                                                                                                                                                               
│      PROJECTION     │                                                                                                                                                                                                               
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                               
│__internal_compress_i│                                                                                                                                                                                                               
│ ntegral_uinteger(#0,│                                                                                                                                                                                                               
│          1)         │                                                                                                                                                                                                               
│__internal_compress_i│                                                                                                                                                                                                               
│ntegral_usmallint(#1,│                                                                                                                                                                                                               
│          1)         │                                                                                                                                                                                                               
│__internal_compress_i│                                                                                                                                                                                                               
│ ntegral_uinteger(#2,│                                                                                                                                                                                                               
│          1)         │                                                                                                                                                                                                               
│          #3         │                                                                                                                                                                                                               
└──────────┬──────────┘                                                                                                                                                                                                                                      
┌──────────┴──────────┐                                                                                                                                                                                                               
│   RIGHT_DELIM_JOIN  │                                                                                                                                                                                                               
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                               
│      RIGHT_ANTI     │                                                                                                                                                                                                               
│  l_orderkey IS NOT  │                                                                                                                                                                                                               
│ DISTINCT FROM l...  ├─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐                                                         
│   l_suppkey IS NOT  │                                                                                                                                                     │                                                         
│ DISTINCT FROM l...  │                                                                                                                                                     │                                                         
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                     │                                                         
│     EC: 6001215     │                                                                                                                                                     │                                                         
└──────────┬──────────┘                                                                                                                                                     │                                                                                
┌──────────┴──────────┐                                                                                                                                          ┌──────────┴──────────┐                                              
│   RIGHT_DELIM_JOIN  │                                                                                                                                          │      HASH_JOIN      │                                              
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                          │   ─ ─ ─ ─ ─ ─ ─ ─   │                                              
│      RIGHT_SEMI     │                                                                                                                                          │      RIGHT_ANTI     │                                              
│  l_orderkey IS NOT  │                                                                                                                                          │  l_orderkey IS NOT  │                                              
│ DISTINCT FROM l...  ├────────────────────────────────────────────────────────────────────────────────┐                                                         │ DISTINCT FROM l...  ├──────────────────────────────────┐           
│   l_suppkey IS NOT  │                                                                                │                                                         │   l_suppkey IS NOT  │                                  │           
│ DISTINCT FROM l...  │                                                                                │                                                         │ DISTINCT FROM l...  │                                  │           
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                │                                                         │   ─ ─ ─ ─ ─ ─ ─ ─   │                                  │           
│     EC: 6001215     │                                                                                │                                                         │     EC: 6001215     │                                  │           
└──────────┬──────────┘                                                                                │                                                         └──────────┬──────────┘                                  │                                  
┌──────────┴──────────┐                                                                     ┌──────────┴──────────┐                                              ┌──────────┴──────────┐                       ┌──────────┴──────────┐
│      HASH_JOIN      │                                                                     │      HASH_JOIN      │                                              │      PROJECTION     │                       │      DUMMY_SCAN     │
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                     │   ─ ─ ─ ─ ─ ─ ─ ─   │                                              │   ─ ─ ─ ─ ─ ─ ─ ─   │                       │                     │
│        INNER        │                                                                     │      RIGHT_SEMI     │                                              │      l_orderkey     │                       │                     │
│     o_orderkey =    │                                                                     │  l_orderkey IS NOT  │                                              │      l_suppkey      │                       │                     │
│      l_orderkey     ├───────────┐                                                         │ DISTINCT FROM l...  ├──────────────────────────────────┐           │                     │                       │                     │
│   ─ ─ ─ ─ ─ ─ ─ ─   │           │                                                         │   l_suppkey IS NOT  │                                  │           │                     │                       │                     │
│      EC: 15866      │           │                                                         │ DISTINCT FROM l...  │                                  │           │                     │                       │                     │
│                     │           │                                                         │   ─ ─ ─ ─ ─ ─ ─ ─   │                                  │           │                     │                       │                     │
│                     │           │                                                         │     EC: 6001215     │                                  │           │                     │                       │                     │
└──────────┬──────────┘           │                                                         └──────────┬──────────┘                                  │           └──────────┬──────────┘                       └─────────────────────┘                       
┌──────────┴──────────┐┌──────────┴──────────┐                                              ┌──────────┴──────────┐                       ┌──────────┴──────────┐┌──────────┴──────────┐                                              
│      SEQ_SCAN       ││      HASH_JOIN      │                                              │      PROJECTION     │                       │      DUMMY_SCAN     ││      HASH_JOIN      │                                              
│   ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─   │                                              │   ─ ─ ─ ─ ─ ─ ─ ─   │                       │                     ││   ─ ─ ─ ─ ─ ─ ─ ─   │                                              
│        orders       ││        INNER        │                                              │      l_orderkey     │                       │                     ││        INNER        │                                              
│   ─ ─ ─ ─ ─ ─ ─ ─   ││l_suppkey = s_suppkey│                                              │      l_suppkey      │                       │                     ││     l_orderkey =    │                                              
│      o_orderkey     ││   ─ ─ ─ ─ ─ ─ ─ ─   │                                              │                     │                       │                     ││      l_orderkey     │                                              
│   ─ ─ ─ ─ ─ ─ ─ ─   ││     Build Min: 1    ├───────────┐                                  │                     │                       │                     ││     l_suppkey !=    ├───────────┐                                  
│Filters: o_orderstatu││   Build Max: 10000  │           │                                  │                     │                       │                     ││       l_suppkey     │           │                                  
│      s='F' AND      ││   ─ ─ ─ ─ ─ ─ ─ ─   │           │                                  │                     │                       │                     ││   ─ ─ ─ ─ ─ ─ ─ ─   │           │                                  
│ o_orderstatus I...  ││      EC: 47600      │           │                                  │                     │                       │                     ││     EC: 1200243     │           │                                  
│   ─ ─ ─ ─ ─ ─ ─ ─   ││                     │           │                                  │                     │                       │                     ││                     │           │                                  
│      EC: 500000     ││                     │           │                                  │                     │                       │                     ││                     │           │                                  
└─────────────────────┘└──────────┬──────────┘           │                                  └──────────┬──────────┘                       └─────────────────────┘└──────────┬──────────┘           │                                                         
                       ┌──────────┴──────────┐┌──────────┴──────────┐                       ┌──────────┴──────────┐                                              ┌──────────┴──────────┐┌──────────┴──────────┐                       
                       │        FILTER       ││      HASH_JOIN      │                       │      HASH_JOIN      │                                              │        FILTER       ││      DELIM_SCAN     │                       
                       │   ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─   │                       │   ─ ─ ─ ─ ─ ─ ─ ─   │                                              │   ─ ─ ─ ─ ─ ─ ─ ─   ││                     │                       
                       │   (l_receiptdate >  ││        INNER        │                       │        INNER        │                                              │   (l_receiptdate >  ││                     │                       
                       │     l_commitdate)   ││    s_nationkey =    │                       │     l_orderkey =    │                                              │     l_commitdate)   ││                     │                       
                       │   ─ ─ ─ ─ ─ ─ ─ ─   ││      n_nationkey    │                       │      l_orderkey     │                                              │   ─ ─ ─ ─ ─ ─ ─ ─   ││                     │                       
                       │     EC: 1200243     ││   ─ ─ ─ ─ ─ ─ ─ ─   ├───────────┐           │     l_suppkey !=    ├───────────┐                                  │     EC: 6001215     ││                     │                       
                       │                     ││     Build Min: 0    │           │           │       l_suppkey     │           │                                  │                     ││                     │                       
                       │                     ││    Build Max: 24    │           │           │   ─ ─ ─ ─ ─ ─ ─ ─   │           │                                  │                     ││                     │                       
                       │                     ││   ─ ─ ─ ─ ─ ─ ─ ─   │           │           │     EC: 6001215     │           │                                  │                     ││                     │                       
                       │                     ││       EC: 400       │           │           │                     │           │                                  │                     ││                     │                       
                       └──────────┬──────────┘└──────────┬──────────┘           │           └──────────┬──────────┘           │                                  └──────────┬──────────┘└─────────────────────┘                                              
                       ┌──────────┴──────────┐┌──────────┴──────────┐┌──────────┴──────────┐┌──────────┴──────────┐┌──────────┴──────────┐                       ┌──────────┴──────────┐                                              
                       │      SEQ_SCAN       ││      SEQ_SCAN       ││      SEQ_SCAN       ││      SEQ_SCAN       ││      DELIM_SCAN     │                       │      SEQ_SCAN       │                                              
                       │   ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─   ││                     │                       │   ─ ─ ─ ─ ─ ─ ─ ─   │                                              
                       │       lineitem      ││       supplier      ││        nation       ││       lineitem      ││                     │                       │       lineitem      │                                              
                       │   ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─   ││                     │                       │   ─ ─ ─ ─ ─ ─ ─ ─   │                                              
                       │      l_suppkey      ││      s_suppkey      ││     n_nationkey     ││      l_orderkey     ││                     │                       │      l_orderkey     │                                              
                       │      l_orderkey     ││     s_nationkey     ││   ─ ─ ─ ─ ─ ─ ─ ─   ││      l_suppkey      ││                     │                       │      l_suppkey      │                                              
                       │    l_receiptdate    ││        s_name       ││   Filters: n_name=  ││   ─ ─ ─ ─ ─ ─ ─ ─   ││                     │                       │    l_receiptdate    │                                              
                       │     l_commitdate    ││   ─ ─ ─ ─ ─ ─ ─ ─   ││'SAUDI ARABIA' A...  ││     EC: 6001215     ││                     │                       │     l_commitdate    │                                              
                       │   ─ ─ ─ ─ ─ ─ ─ ─   ││      EC: 10000      ││      IS NOT NULL    ││                     ││                     │                       │   ─ ─ ─ ─ ─ ─ ─ ─   │                                              
                       │     EC: 1200243     ││                     ││   ─ ─ ─ ─ ─ ─ ─ ─   ││                     ││                     │                       │     EC: 6001215     │                                              
                       │                     ││                     ││        EC: 1        ││                     ││                     │                       │                     │                                              
                       └─────────────────────┘└─────────────────────┘└─────────────────────┘└─────────────────────┘└─────────────────────┘                       └─────────────────────┘                                                                     

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

**** output size:  186
LINEAGE_5_FILTER_13
LINEAGE_5_FILTER_21
LINEAGE_5_HASH_GROUP_BY_10
LINEAGE_5_HASH_GROUP_BY_17
LINEAGE_5_HASH_GROUP_BY_26
LINEAGE_5_HASH_GROUP_BY_5
LINEAGE_5_HASH_JOIN_19
LINEAGE_5_HASH_JOIN_2
LINEAGE_5_HASH_JOIN_30
LINEAGE_5_HASH_JOIN_31
LINEAGE_5_HASH_JOIN_9
LINEAGE_5_ORDER_BY_33
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_11
LINEAGE_5_SEQ_SCAN_12
LINEAGE_5_SEQ_SCAN_28
LINEAGE_5_SEQ_SCAN_29
SELECT s_name, s_address FROM supplier, nation WHERE s_suppkey IN ( SELECT ps_suppkey FROM partsupp WHERE ps_partkey IN ( SELECT p_partkey FROM part WHERE p_name LIKE 'forest%') AND ps_availqty > ( SELECT 0.5 * sum(l_quantity) FROM lineitem WHERE l_partkey = ps_partkey AND l_suppkey = ps_suppkey AND l_shipdate >= CAST('1994-01-01' AS date) AND l_shipdate < CAST('1995-01-01' AS date))) AND s_nationkey = n_nationkey AND n_name = 'CANADA' ORDER BY s_name;
   query_id  ...                                               plan
0         5  ...  {"name": "ORDER_BY", "opid": "33", "children":...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               SELECT s_name, s_address FROM supplier, nation...
size_bytes_max                                                1472113
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "ORDER_BY", "opid": "33", "children":...
Name: 0, dtype: object
{"name": "ORDER_BY", "opid": "33", "children": [{"name": "PROJECTION", "opid": "32", "children": [{"name": "HASH_JOIN", "opid": "31", "children": [{"name": "PROJECTION", "opid": "27", "children": [{"name": "HASH_GROUP_BY", "opid": "26", "children": [{"name": "PROJECTION", "opid": "25", "children": [{"name": "PROJECTION", "opid": "24", "children": [{"name": "PROJECTION", "opid": "23", "children": [{"name": "PROJECTION", "opid": "22", "children": [{"name": "FILTER", "opid": "21", "children": [{"name": "RIGHT_DELIM_JOIN", "opid": "20", "children": [{"name": "HASH_GROUP_BY", "opid": "10", "children": [],"table": "","extra": "#0\n#2"},{"name": "HASH_JOIN", "opid": "9", "children": [{"name": "PROJECTION", "opid": "7", "children": [{"name": "PROJECTION", "opid": "6", "children": [{"name": "HASH_GROUP_BY", "opid": "5", "children": [{"name": "PROJECTION", "opid": "4", "children": [{"name": "PROJECTION", "opid": "3", "children": [{"name": "HASH_JOIN", "opid": "2", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_partkey\nl_suppkey\nl_quantity\n[INFOSEPARATOR]\nFilters: l_shipdate>='1994-01-01'::DATE AND l_shipdate<'1995-01-01'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243"},{"name": "DELIM_SCAN", "opid": "1", "children": [],"table": "","extra": ""}],"table": "","extra": "INNER\nl_partkey = ps_partkey\nl_suppkey = ps_suppkey\n\n[INFOSEPARATOR]\nEC: 1200243\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n__internal_compress_integral_usmallint(#1, 1)\n#2\n#3\n#4\n"}],"table": "","extra": "ps_partkey\nps_suppkey\nl_quantity\n"}],"table": "","extra": "#0\n#1\nsum(#2)"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n__internal_decompress_integral_bigint(#1, 1)\n#2\n"}],"table": "","extra": "(0.5 * sum(l_quantity))\nps_partkey\nps_suppkey\n"},{"name": "DUMMY_SCAN", "opid": "8", "children": [],"table": "","extra": ""}],"table": "","extra": "RIGHT\nps_partkey IS NOT DISTINCT FROM ps_partkey\nps_suppkey IS NOT DISTINCT FROM ps_suppkey\n\n[INFOSEPARATOR]\nEC: 800000\n"},{"name": "HASH_JOIN", "opid": "19", "children": [{"name": "SEQ_SCAN ", "opid": "11", "children": [],"table": "partsupp","extra": "partsupp\n[INFOSEPARATOR]\nps_partkey\nps_availqty\nps_suppkey\n[INFOSEPARATOR]\nEC: 800000"},{"name": "PROJECTION", "opid": "18", "children": [{"name": "HASH_GROUP_BY", "opid": "17", "children": [{"name": "PROJECTION", "opid": "16", "children": [{"name": "PROJECTION", "opid": "15", "children": [{"name": "PROJECTION", "opid": "14", "children": [{"name": "FILTER", "opid": "13", "children": [{"name": "SEQ_SCAN ", "opid": "12", "children": [],"table": "part","extra": "part\n[INFOSEPARATOR]\np_name\np_partkey\n[INFOSEPARATOR]\nFilters: p_name>='forest' AND p_name<'foresu' AND p_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 40000"}],"table": "","extra": "prefix(p_name, 'forest')\n[INFOSEPARATOR]\nEC: 8000"}],"table": "","extra": "p_partkey\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n"}],"table": "","extra": "#0\n"}],"table": "","extra": "#0"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n"}],"table": "","extra": "INNER\nps_partkey = #0\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 800000\n"}],"table": "","extra": "RIGHT\nps_partkey IS NOT DISTINCT FROM ps_partkey\nps_suppkey IS NOT DISTINCT FROM ps_suppkey\n\n[INFOSEPARATOR]\nEC: 800000\n"}],"table": "","extra": "(CAST(ps_availqty AS DECIMAL(38,3)) > SUBQUERY)\n[INFOSEPARATOR]\nEC: 800000"}],"table": "","extra": "#0\n#4\n#5\n"}],"table": "","extra": "ps_suppkey\n"}],"table": "","extra": "__internal_compress_integral_usmallint(#0, 1)\n"}],"table": "","extra": "#0\n"}],"table": "","extra": "#0"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n"},{"name": "HASH_JOIN", "opid": "30", "children": [{"name": "SEQ_SCAN ", "opid": "28", "children": [],"table": "supplier","extra": "supplier\n[INFOSEPARATOR]\n\n[INFOSEPARATOR]\nEC: 10000"},{"name": "SEQ_SCAN ", "opid": "29", "children": [],"table": "nation","extra": "nation\n[INFOSEPARATOR]\n\n[INFOSEPARATOR]\nFilters: n_name='CANADA' AND n_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1"}],"table": "","extra": "INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 400\n"}],"table": "","extra": "INNER\n#0 = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 400\n"}],"table": "","extra": "s_name\ns_address\n"}],"table": "","extra": "ORDERS:\nsupplier.s_name ASC"}
%%%%%%%%%%%%%%%% Running Query #  21  threads:  8
SELECT s_name, count(*) AS numwait FROM supplier, lineitem l1, orders, nation WHERE s_suppkey = l1.l_suppkey AND o_orderkey = l1.l_orderkey AND o_orderstatus = 'F' AND l1.l_receiptdate > l1.l_commitdate AND EXISTS ( SELECT * FROM lineitem l2 WHERE l2.l_orderkey = l1.l_orderkey AND l2.l_suppkey <> l1.l_suppkey) AND NOT EXISTS ( SELECT * FROM lineitem l3 WHERE l3.l_orderkey = l1.l_orderkey AND l3.l_suppkey <> l1.l_suppkey AND l3.l_receiptdate > l3.l_commitdate) AND s_nationkey = n_nationkey AND n_name = 'SAUDI ARABIA' GROUP BY s_name ORDER BY numwait DESC, s_name LIMIT 100;
Run:  None SELECT s_name, count(*) AS numwait FROM supplier, lineitem l1, orders, nation WHERE s_suppkey = l1.l_suppkey AND o_orderkey = l1.l_orderkey AND o_orderstatus = 'F' AND l1.l_receiptdate > l1.l_commitdate AND EXISTS ( SELECT * FROM lineitem l2 WHERE l2.l_orderkey = l1.l_orderkey AND l2.l_suppkey <> l1.l_suppkey) AND NOT EXISTS ( SELECT * FROM lineitem l3 WHERE l3.l_orderkey = l1.l_orderkey AND l3.l_suppkey <> l1.l_suppkey AND l3.l_receiptdate > l3.l_commitdate) AND s_nationkey = n_nationkey AND n_name = 'SAUDI ARABIA' GROUP BY s_name ORDER BY numwait DESC, s_name LIMIT 100;
Avg Time in sec:  0.20354374637827277  output size:  100
                s_name  numwait
0   Supplier#000002829       20
1   Supplier#000005808       18
2   Supplier#000000262       17
3   Supplier#000000496       17
4   Supplier#000002160       17
..                 ...      ...
95  Supplier#000001916       12
96  Supplier#000001925       12
97  Supplier#000002039       12
98  Supplier#000002357       12
99  Supplier#000002483       12

[100 rows x 2 columns]
{'name': 'Query', 'result': 0.180339, 'timing': 0.180339, 'cardinality': 0, 'extra-info': "SELECT s_name, count(*) AS numwait FROM supplier, lineitem l1, orders, nation WHERE s_suppkey = l1.l_suppkey AND o_orderkey = l1.l_orderkey AND o_orderstatus = 'F' AND l1.l_receiptdate > l1.l_commitdate AND EXISTS ( SELECT * FROM lineitem l2 WHERE l2.l_orderkey = l1.l_orderkey AND l2.l_suppkey <> l1.l_suppkey) AND NOT EXISTS ( SELECT * FROM lineitem l3 WHERE l3.l_orderkey = l1.l_orderkey AND l3.l_suppkey <> l1.l_suppkey AND l3.l_receiptdate > l3.l_commitdate) AND s_nationkey = n_nationkey AND n_name = 'SAUDI ARABIA' GROUP BY s_name ORDER BY numwait DESC, s_name LIMIT 100;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 1.8e-05, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'LIMIT', 'timing': 0.000175, 'cardinality': 100, 'extra_info': '', 'children': [{'name': 'ORDER_BY', 'timing': 0.000634, 'cardinality': 411, 'extra_info': 'ORDERS:\ncount_star() DESC\nsupplier.s_name ASC', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.003593, 'cardinality': 411, 'extra_info': '#0\ncount_star()', 'children': [{'name': 'PROJECTION', 'timing': 2e-06, 'cardinality': 4141, 'extra_info': 's_name\n', 'children': [{'name': 'PROJECTION', 'timing': 3.1e-05, 'cardinality': 4141, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n__internal_compress_integral_usmallint(#1, 1)\n__internal_compress_integral_uinteger(#2, 1)\n#3\n', 'children': [{'name': 'RIGHT_DELIM_JOIN', 'timing': 0.014681, 'cardinality': 0, 'extra_info': 'RIGHT_ANTI\nl_orderkey IS NOT DISTINCT FROM l_orderkey\nl_suppkey IS NOT DISTINCT FROM l_suppkey\n\n[INFOSEPARATOR]\nEC: 6001215\n', 'children': [{'name': 'RIGHT_DELIM_JOIN', 'timing': 0.051138, 'cardinality': 0, 'extra_info': 'RIGHT_SEMI\nl_orderkey IS NOT DISTINCT FROM l_orderkey\nl_suppkey IS NOT DISTINCT FROM l_suppkey\n\n[INFOSEPARATOR]\nEC: 6001215\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.087651, 'cardinality': 75871, 'extra_info': 'INNER\no_orderkey = l_orderkey\n\n[INFOSEPARATOR]\nEC: 15866\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.058304, 'cardinality': 729413, 'extra_info': "orders\n[INFOSEPARATOR]\no_orderkey\n[INFOSEPARATOR]\nFilters: o_orderstatus='F' AND o_orderstatus IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 500000", 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.084956, 'cardinality': 156739, 'extra_info': 'INNER\nl_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 47600\n', 'children': [{'name': 'FILTER', 'timing': 0.048553, 'cardinality': 3793296, 'extra_info': '(l_receiptdate > l_commitdate)\n[INFOSEPARATOR]\nEC: 1200243', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.021008, 'cardinality': 6001215, 'extra_info': 'lineitem\n[INFOSEPARATOR]\nl_suppkey\nl_orderkey\nl_receiptdate\nl_commitdate\n[INFOSEPARATOR]\nEC: 1200243', 'children': []}]}, {'name': 'HASH_JOIN', 'timing': 0.000128, 'cardinality': 411, 'extra_info': 'INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 400\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.000227, 'cardinality': 10000, 'extra_info': 'supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\ns_name\n[INFOSEPARATOR]\nEC: 10000', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 4.4e-05, 'cardinality': 1, 'extra_info': "nation\n[INFOSEPARATOR]\nn_nationkey\n[INFOSEPARATOR]\nFilters: n_name='SAUDI ARABIA' AND n_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1", 'children': []}]}]}]}, {'name': 'HASH_JOIN', 'timing': 0.068946, 'cardinality': 73089, 'extra_info': 'RIGHT_SEMI\nl_orderkey IS NOT DISTINCT FROM l_orderkey\nl_suppkey IS NOT DISTINCT FROM l_suppkey\n\n[INFOSEPARATOR]\nEC: 6001215\n', 'children': [{'name': 'PROJECTION', 'timing': 0.001316, 'cardinality': 302356, 'extra_info': 'l_orderkey\nl_suppkey\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.179676, 'cardinality': 302356, 'extra_info': 'INNER\nl_orderkey = l_orderkey\nl_suppkey != l_suppkey\n\n[INFOSEPARATOR]\nEC: 6001215\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.015313, 'cardinality': 6001215, 'extra_info': 'lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_suppkey\n[INFOSEPARATOR]\nEC: 6001215', 'children': []}, {'name': 'DELIM_SCAN', 'timing': 0.0, 'cardinality': 0, 'extra_info': '', 'children': []}]}]}, {'name': 'DUMMY_SCAN', 'timing': 0.0, 'cardinality': 0, 'extra_info': '', 'children': []}]}, {'name': 'HASH_GROUP_BY', 'timing': 0.011712, 'cardinality': 75864, 'extra_info': '#0\n#1', 'children': []}]}, {'name': 'HASH_JOIN', 'timing': 0.029419, 'cardinality': 4141, 'extra_info': 'RIGHT_ANTI\nl_orderkey IS NOT DISTINCT FROM l_orderkey\nl_suppkey IS NOT DISTINCT FROM l_suppkey\n\n[INFOSEPARATOR]\nEC: 6001215\n', 'children': [{'name': 'PROJECTION', 'timing': 0.00036, 'cardinality': 190909, 'extra_info': 'l_orderkey\nl_suppkey\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.15056, 'cardinality': 190909, 'extra_info': 'INNER\nl_orderkey = l_orderkey\nl_suppkey != l_suppkey\n\n[INFOSEPARATOR]\nEC: 1200243\n', 'children': [{'name': 'FILTER', 'timing': 0.031579, 'cardinality': 3793296, 'extra_info': '(l_receiptdate > l_commitdate)\n[INFOSEPARATOR]\nEC: 6001215', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.014717, 'cardinality': 6001215, 'extra_info': 'lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_suppkey\nl_receiptdate\nl_commitdate\n[INFOSEPARATOR]\nEC: 6001215', 'children': []}]}, {'name': 'DELIM_SCAN', 'timing': 0.0, 'cardinality': 0, 'extra_info': '', 'children': []}]}]}, {'name': 'DUMMY_SCAN', 'timing': 0.0, 'cardinality': 0, 'extra_info': '', 'children': []}]}, {'name': 'HASH_GROUP_BY', 'timing': 0.011264, 'cardinality': 73082, 'extra_info': '#0\n#1', 'children': []}]}]}]}]}]}]}]}]}
compressed filter_log_size: 1567283
compressed filter_log_buffer_size: 1500330
compressed limit_offset_size: 3872
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 5913
compressed perfect_full_scan_ht_log_buffer_size: 1417
compressed perfect_probe_ht_log_size: 848160
compressed perfect_probe_ht_log_buffer_size: 799990
compressed row_group_log_size: 265075
compressed row_group_log_buffer_size: 187517
compressed scatter_log_size: 370558
compressed scatter_log_buffer_size: 361453
compressed scatter_sel_log_size: 1948518
compressed scatter_sel_log_buffer_size: 1926133
compressed gather_log_size: 3728
compressed gather_log_buffer_size: 0
compressed combine_log_size: 21940
compressed combine_log_buffer_size: 14280
compressed finalize_states_log_size: 77230
compressed finalize_states_log_buffer_size: 69860
compressed join_gather_log_size: 6173116
compressed join_gather_log_buffer_size: 5802603
compressed reorder_log_size: 6493
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 3728
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 3728
compressed nlj_log_buffer_size: 0
compressed total_size: 11299342
compressed total_buffer_size: 10663583
compressed total_element_size: 635759

Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                                                                                                                                                                              
│          ORDER_BY         │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│          ORDERS:          │                                                                                                                                                                              
│   custsale.cntrycode ASC  │                                                                                                                                                                              
└─────────────┬─────────────┘                                                                                                                                                                                                           
┌─────────────┴─────────────┐                                                                                                                                                                              
│       HASH_GROUP_BY       │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│             #0            │                                                                                                                                                                              
│        count_star()       │                                                                                                                                                                              
│          sum(#1)          │                                                                                                                                                                              
└─────────────┬─────────────┘                                                                                                                                                                                                           
┌─────────────┴─────────────┐                                                                                                                                                                              
│         PROJECTION        │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│         cntrycode         │                                                                                                                                                                              
│         c_acctbal         │                                                                                                                                                                              
└─────────────┬─────────────┘                                                                                                                                                                                                           
┌─────────────┴─────────────┐                                                                                                                                                                              
│         PROJECTION        │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│         cntrycode         │                                                                                                                                                                              
│         c_acctbal         │                                                                                                                                                                              
└─────────────┬─────────────┘                                                                                                                                                                                                           
┌─────────────┴─────────────┐                                                                                                                                                                              
│      RIGHT_DELIM_JOIN     │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│         RIGHT_ANTI        │                                                                                                                                                                              
│ c_custkey IS NOT DISTINCT ├─────────────────────────────────────────────────────────────────────────────────────────────────────┐                                                                        
│       FROM c_custkey      │                                                                                                     │                                                                        
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                     │                                                                        
│        EC: 1500000        │                                                                                                     │                                                                        
└─────────────┬─────────────┘                                                                                                     │                                                                                                     
┌─────────────┴─────────────┐                                                                                       ┌─────────────┴─────────────┐                                                          
│      NESTED_LOOP_JOIN     │                                                                                       │         HASH_JOIN         │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│           INNER           │                                                                                       │         RIGHT_ANTI        │                                                          
│CAST(c_acctbal AS DOUBLE) >├───────────────────────────────────────────┐                                           │ c_custkey IS NOT DISTINCT ├───────────────────────────────────────────┐              
│          SUBQUERY         │                                           │                                           │       FROM c_custkey      │                                           │              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                           │                                           │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                           │              
│           EC: 0           │                                           │                                           │        EC: 1500000        │                                           │              
└─────────────┬─────────────┘                                           │                                           └─────────────┬─────────────┘                                           │                                           
┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐
│           FILTER          │                             │    UNGROUPED_AGGREGATE    │                             │         PROJECTION        │                             │         DUMMY_SCAN        │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │                           │
│          IN (...)         │                             │         first(#0)         │                             │         c_custkey         │                             │                           │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │                           │                             │                           │                             │                           │
│         EC: 30000         │                             │                           │                             │                           │                             │                           │
└─────────────┬─────────────┘                             └─────────────┬─────────────┘                             └─────────────┬─────────────┘                             └───────────────────────────┘                             
┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐                                                          
│         HASH_JOIN         │                             │         PROJECTION        │                             │         HASH_JOIN         │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│            MARK           │                             │             #0            │                             │           INNER           │                                                          
│substring(c_phone, 1, 2) = ├──────────────┐              │                           │                             │   o_custkey = c_custkey   ├──────────────┐                                           
│             #0            │              │              │                           │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              │                           │                             │        EC: 1500000        │              │                                           
│         EC: 150000        │              │              │                           │                             │                           │              │                                           
└─────────────┬─────────────┘              │              └─────────────┬─────────────┘                             └─────────────┬─────────────┘              │                                                                        
┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             
│         SEQ_SCAN          ││      COLUMN_DATA_SCAN     ││      STREAMING_LIMIT      │                             │         SEQ_SCAN          ││         DELIM_SCAN        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           ││                           │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                             
│          customer         ││                           ││                           │                             │           orders          ││                           │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           ││                           │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                             
│          c_phone          ││                           ││                           │                             │         o_custkey         ││                           │                             
│         c_acctbal         ││                           ││                           │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                             
│         c_custkey         ││                           ││                           │                             │        EC: 1500000        ││                           │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           ││                           │                             │                           ││                           │                             
│         EC: 150000        ││                           ││                           │                             │                           ││                           │                             
└───────────────────────────┘└───────────────────────────┘└─────────────┬─────────────┘                             └───────────────────────────┘└───────────────────────────┘                                                          
                                                          ┌─────────────┴─────────────┐                                                                                                                    
                                                          │    UNGROUPED_AGGREGATE    │                                                                                                                    
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
                                                          │          avg(#0)          │                                                                                                                    
                                                          └─────────────┬─────────────┘                                                                                                                                                 
                                                          ┌─────────────┴─────────────┐                                                                                                                    
                                                          │         PROJECTION        │                                                                                                                    
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
                                                          │         c_acctbal         │                                                                                                                    
                                                          └─────────────┬─────────────┘                                                                                                                                                 
                                                          ┌─────────────┴─────────────┐                                                                                                                    
                                                          │         PROJECTION        │                                                                                                                    
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
                                                          │             #0            │                                                                                                                    
                                                          │             #2            │                                                                                                                    
                                                          └─────────────┬─────────────┘                                                                                                                                                 
                                                          ┌─────────────┴─────────────┐                                                                                                                    
                                                          │           FILTER          │                                                                                                                    
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
                                                          │          IN (...)         │                                                                                                                    
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
                                                          │          EC: 6000         │                                                                                                                    
                                                          └─────────────┬─────────────┘                                                                                                                                                 
                                                          ┌─────────────┴─────────────┐                                                                                                                    
                                                          │         HASH_JOIN         │                                                                                                                    
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
                                                          │            MARK           │                                                                                                                    
                                                          │substring(c_phone, 1, 2) = ├──────────────┐                                                                                                     
                                                          │             #0            │              │                                                                                                     
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                                                                                     
                                                          │         EC: 30000         │              │                                                                                                     
                                                          └─────────────┬─────────────┘              │                                                                                                                                  
                                                          ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                       
                                                          │         SEQ_SCAN          ││      COLUMN_DATA_SCAN     │                                                                                       
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                                                                       
                                                          │          customer         ││                           │                                                                                       
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                                                                       
                                                          │         c_acctbal         ││                           │                                                                                       
                                                          │          c_phone          ││                           │                                                                                       
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                                                                       
                                                          │Filters: c_acctbal>0.00 AND││                           │                                                                                       
                                                          │    c_acctbal IS NOT NULL  ││                           │                                                                                       
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                                                                       
                                                          │         EC: 30000         ││                           │                                                                                       
                                                          └───────────────────────────┘└───────────────────────────┘                                                                                                                    

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

X {'RESULT_COLLECTOR0': 1.8e-05, 'LIMIT1': 0.000175, 'ORDER_BY2': 0.000634, 'HASH_GROUP_BY3': 0.003593, 'PROJECTION4': 2e-06, 'PROJECTION5': 3.1e-05, 'RIGHT_DELIM_JOIN6': 0.014681, 'RIGHT_DELIM_JOIN7': 0.051138, 'HASH_JOIN8': 0.087651, 'SEQ_SCAN 9': 0.058304, 'HASH_JOIN10': 0.084956, 'FILTER11': 0.048553, 'SEQ_SCAN 12': 0.021008, 'HASH_JOIN13': 0.000128, 'SEQ_SCAN 14': 0.000227, 'SEQ_SCAN 15': 4.4e-05, 'HASH_JOIN16': 0.068946, 'PROJECTION17': 0.001316, 'HASH_JOIN18': 0.179676, 'SEQ_SCAN 19': 0.015313, 'DELIM_SCAN20': 0.0, 'DUMMY_SCAN21': 0.0, 'HASH_GROUP_BY22': 0.011712, 'HASH_JOIN23': 0.029419, 'PROJECTION24': 0.00036, 'HASH_JOIN25': 0.15056, 'FILTER26': 0.031579, 'SEQ_SCAN 27': 0.014717, 'DELIM_SCAN28': 0.0, 'DUMMY_SCAN29': 0.0, 'HASH_GROUP_BY30': 0.011264}
**** output size:  100
LINEAGE_5_FILTER_1
LINEAGE_5_FILTER_17
LINEAGE_5_HASH_GROUP_BY_14
LINEAGE_5_HASH_GROUP_BY_27
LINEAGE_5_HASH_GROUP_BY_7
LINEAGE_5_HASH_JOIN_10
LINEAGE_5_HASH_JOIN_13
LINEAGE_5_HASH_JOIN_20
LINEAGE_5_HASH_JOIN_21
LINEAGE_5_HASH_JOIN_22
LINEAGE_5_HASH_JOIN_3
LINEAGE_5_HASH_JOIN_6
LINEAGE_5_LIMIT_29
LINEAGE_5_ORDER_BY_28
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_15
LINEAGE_5_SEQ_SCAN_16
LINEAGE_5_SEQ_SCAN_18
LINEAGE_5_SEQ_SCAN_19
LINEAGE_5_SEQ_SCAN_8
SELECT s_name, count(*) AS numwait FROM supplier, lineitem l1, orders, nation WHERE s_suppkey = l1.l_suppkey AND o_orderkey = l1.l_orderkey AND o_orderstatus = 'F' AND l1.l_receiptdate > l1.l_commitdate AND EXISTS ( SELECT * FROM lineitem l2 WHERE l2.l_orderkey = l1.l_orderkey AND l2.l_suppkey <> l1.l_suppkey) AND NOT EXISTS ( SELECT * FROM lineitem l3 WHERE l3.l_orderkey = l1.l_orderkey AND l3.l_suppkey <> l1.l_suppkey AND l3.l_receiptdate > l3.l_commitdate) AND s_nationkey = n_nationkey AND n_name = 'SAUDI ARABIA' GROUP BY s_name ORDER BY numwait DESC, s_name LIMIT 100;
   query_id  ...                                               plan
0         5  ...  {"name": "LIMIT", "opid": "29", "children": [{...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               SELECT s_name, count(*) AS numwait FROM suppli...
size_bytes_max                                               11299342
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "LIMIT", "opid": "29", "children": [{...
Name: 0, dtype: object
{"name": "LIMIT", "opid": "29", "children": [{"name": "ORDER_BY", "opid": "28", "children": [{"name": "HASH_GROUP_BY", "opid": "27", "children": [{"name": "PROJECTION", "opid": "26", "children": [{"name": "PROJECTION", "opid": "25", "children": [{"name": "RIGHT_DELIM_JOIN", "opid": "24", "children": [{"name": "HASH_GROUP_BY", "opid": "7", "children": [],"table": "","extra": "#0\n#1"},{"name": "HASH_JOIN", "opid": "6", "children": [{"name": "PROJECTION", "opid": "4", "children": [{"name": "HASH_JOIN", "opid": "3", "children": [{"name": "FILTER", "opid": "1", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_suppkey\nl_receiptdate\nl_commitdate\n[INFOSEPARATOR]\nEC: 6001215"}],"table": "","extra": "(l_receiptdate > l_commitdate)\n[INFOSEPARATOR]\nEC: 6001215"},{"name": "DELIM_SCAN", "opid": "2", "children": [],"table": "","extra": ""}],"table": "","extra": "INNER\nl_orderkey = l_orderkey\nl_suppkey != l_suppkey\n\n[INFOSEPARATOR]\nEC: 1200243\n"}],"table": "","extra": "l_orderkey\nl_suppkey\n"},{"name": "DUMMY_SCAN", "opid": "5", "children": [],"table": "","extra": ""}],"table": "","extra": "RIGHT_ANTI\nl_orderkey IS NOT DISTINCT FROM l_orderkey\nl_suppkey IS NOT DISTINCT FROM l_suppkey\n\n[INFOSEPARATOR]\nEC: 6001215\n"},{"name": "RIGHT_DELIM_JOIN", "opid": "23", "children": [{"name": "HASH_GROUP_BY", "opid": "14", "children": [],"table": "","extra": "#0\n#1"},{"name": "HASH_JOIN", "opid": "13", "children": [{"name": "PROJECTION", "opid": "11", "children": [{"name": "HASH_JOIN", "opid": "10", "children": [{"name": "SEQ_SCAN ", "opid": "8", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_suppkey\n[INFOSEPARATOR]\nEC: 6001215"},{"name": "DELIM_SCAN", "opid": "9", "children": [],"table": "","extra": ""}],"table": "","extra": "INNER\nl_orderkey = l_orderkey\nl_suppkey != l_suppkey\n\n[INFOSEPARATOR]\nEC: 6001215\n"}],"table": "","extra": "l_orderkey\nl_suppkey\n"},{"name": "DUMMY_SCAN", "opid": "12", "children": [],"table": "","extra": ""}],"table": "","extra": "RIGHT_SEMI\nl_orderkey IS NOT DISTINCT FROM l_orderkey\nl_suppkey IS NOT DISTINCT FROM l_suppkey\n\n[INFOSEPARATOR]\nEC: 6001215\n"},{"name": "HASH_JOIN", "opid": "22", "children": [{"name": "SEQ_SCAN ", "opid": "15", "children": [],"table": "orders","extra": "orders\n[INFOSEPARATOR]\no_orderkey\n[INFOSEPARATOR]\nFilters: o_orderstatus='F' AND o_orderstatus IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 500000"},{"name": "HASH_JOIN", "opid": "21", "children": [{"name": "FILTER", "opid": "17", "children": [{"name": "SEQ_SCAN ", "opid": "16", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_suppkey\nl_orderkey\nl_receiptdate\nl_commitdate\n[INFOSEPARATOR]\nEC: 1200243"}],"table": "","extra": "(l_receiptdate > l_commitdate)\n[INFOSEPARATOR]\nEC: 1200243"},{"name": "HASH_JOIN", "opid": "20", "children": [{"name": "SEQ_SCAN ", "opid": "18", "children": [],"table": "supplier","extra": "supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\ns_name\n[INFOSEPARATOR]\nEC: 10000"},{"name": "SEQ_SCAN ", "opid": "19", "children": [],"table": "nation","extra": "nation\n[INFOSEPARATOR]\nn_nationkey\n[INFOSEPARATOR]\nFilters: n_name='SAUDI ARABIA' AND n_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1"}],"table": "","extra": "INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 400\n"}],"table": "","extra": "INNER\nl_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 47600\n"}],"table": "","extra": "INNER\no_orderkey = l_orderkey\n\n[INFOSEPARATOR]\nEC: 15866\n"}],"table": "","extra": "RIGHT_SEMI\nl_orderkey IS NOT DISTINCT FROM l_orderkey\nl_suppkey IS NOT DISTINCT FROM l_suppkey\n\n[INFOSEPARATOR]\nEC: 6001215\n"}],"table": "","extra": "RIGHT_ANTI\nl_orderkey IS NOT DISTINCT FROM l_orderkey\nl_suppkey IS NOT DISTINCT FROM l_suppkey\n\n[INFOSEPARATOR]\nEC: 6001215\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n__internal_compress_integral_usmallint(#1, 1)\n__internal_compress_integral_uinteger(#2, 1)\n#3\n"}],"table": "","extra": "s_name\n"}],"table": "","extra": "#0\ncount_star()"}],"table": "","extra": "ORDERS:\ncount_star() DESC\nsupplier.s_name ASC"}],"table": "","extra": ""}
%%%%%%%%%%%%%%%% Running Query #  22  threads:  8
SELECT cntrycode, count(*) AS numcust, sum(c_acctbal) AS totacctbal FROM ( SELECT substring(c_phone FROM 1 FOR 2) AS cntrycode, c_acctbal FROM customer WHERE substring(c_phone FROM 1 FOR 2) IN ('13', '31', '23', '29', '30', '18', '17') AND c_acctbal > ( SELECT avg(c_acctbal) FROM customer WHERE c_acctbal > 0.00 AND substring(c_phone FROM 1 FOR 2) IN ('13', '31', '23', '29', '30', '18', '17')) AND NOT EXISTS ( SELECT * FROM orders WHERE o_custkey = c_custkey)) AS custsale GROUP BY cntrycode ORDER BY cntrycode;
Run:  None SELECT cntrycode, count(*) AS numcust, sum(c_acctbal) AS totacctbal FROM ( SELECT substring(c_phone FROM 1 FOR 2) AS cntrycode, c_acctbal FROM customer WHERE substring(c_phone FROM 1 FOR 2) IN ('13', '31', '23', '29', '30', '18', '17') AND c_acctbal > ( SELECT avg(c_acctbal) FROM customer WHERE c_acctbal > 0.00 AND substring(c_phone FROM 1 FOR 2) IN ('13', '31', '23', '29', '30', '18', '17')) AND NOT EXISTS ( SELECT * FROM orders WHERE o_custkey = c_custkey)) AS custsale GROUP BY cntrycode ORDER BY cntrycode;
Avg Time in sec:  0.059821014292538166  output size:  7
  cntrycode  numcust  totacctbal
0        13      888  6737713.99
1        17      861  6460573.72
2        18      964  7236687.40
3        23      892  6701457.95
4        29      948  7158866.63
5        30      909  6808436.13
6        31      922  6806670.18
compressed filter_log_size: 42238
compressed filter_log_buffer_size: 37254
compressed limit_offset_size: 2528
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 2384
compressed perfect_full_scan_ht_log_buffer_size: 0
compressed perfect_probe_ht_log_size: 2384
compressed perfect_probe_ht_log_buffer_size: 0
compressed row_group_log_size: 28636
compressed row_group_log_buffer_size: 17936
compressed scatter_log_size: 97352
compressed scatter_log_buffer_size: 94118
compressed scatter_sel_log_size: 151040
compressed scatter_sel_log_buffer_size: 145102
compressed gather_log_size: 2384
compressed gather_log_buffer_size: 0
compressed combine_log_size: 6112
compressed combine_log_buffer_size: 2000
compressed finalize_states_log_size: 7603
compressed finalize_states_log_buffer_size: 3491
compressed join_gather_log_size: 1966956
compressed join_gather_log_buffer_size: 1912593
compressed reorder_log_size: 3896
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 2384
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 11599
compressed nlj_log_buffer_size: 7419
compressed total_size: 2327496
compressed total_buffer_size: 2219913
compressed total_element_size: 107583

{'name': 'Query', 'result': 0.053473, 'timing': 0.053473, 'cardinality': 0, 'extra-info': "SELECT cntrycode, count(*) AS numcust, sum(c_acctbal) AS totacctbal FROM ( SELECT substring(c_phone FROM 1 FOR 2) AS cntrycode, c_acctbal FROM customer WHERE substring(c_phone FROM 1 FOR 2) IN ('13', '31', '23', '29', '30', '18', '17') AND c_acctbal > ( SELECT avg(c_acctbal) FROM customer WHERE c_acctbal > 0.00 AND substring(c_phone FROM 1 FOR 2) IN ('13', '31', '23', '29', '30', '18', '17')) AND NOT EXISTS ( SELECT * FROM orders WHERE o_custkey = c_custkey)) AS custsale GROUP BY cntrycode ORDER BY cntrycode;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 9e-06, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'ORDER_BY', 'timing': 0.000202, 'cardinality': 7, 'extra_info': 'ORDERS:\ncustsale.cntrycode ASC', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.001555, 'cardinality': 7, 'extra_info': '#0\ncount_star()\nsum(#1)', 'children': [{'name': 'PROJECTION', 'timing': 2e-06, 'cardinality': 6384, 'extra_info': 'cntrycode\nc_acctbal\n', 'children': [{'name': 'PROJECTION', 'timing': 0.000244, 'cardinality': 6384, 'extra_info': 'cntrycode\nc_acctbal\n', 'children': [{'name': 'RIGHT_DELIM_JOIN', 'timing': 0.006991, 'cardinality': 0, 'extra_info': 'RIGHT_ANTI\nc_custkey IS NOT DISTINCT FROM c_custkey\n\n[INFOSEPARATOR]\nEC: 1500000\n', 'children': [{'name': 'NESTED_LOOP_JOIN', 'timing': 0.002508, 'cardinality': 19000, 'extra_info': 'INNER\nCAST(c_acctbal AS DOUBLE) > SUBQUERY\n\n[INFOSEPARATOR]\nEC: 0\n', 'children': [{'name': 'FILTER', 'timing': 0.001212, 'cardinality': 42015, 'extra_info': 'IN (...)\n[INFOSEPARATOR]\nEC: 30000', 'children': [{'name': 'HASH_JOIN', 'timing': 0.010489, 'cardinality': 150000, 'extra_info': 'MARK\nsubstring(c_phone, 1, 2) = #0\n\n[INFOSEPARATOR]\nEC: 150000\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.003694, 'cardinality': 150000, 'extra_info': 'customer\n[INFOSEPARATOR]\nc_phone\nc_acctbal\nc_custkey\n[INFOSEPARATOR]\nEC: 150000', 'children': []}, {'name': 'COLUMN_DATA_SCAN', 'timing': 2.2e-05, 'cardinality': 7, 'extra_info': '', 'children': []}]}]}, {'name': 'UNGROUPED_AGGREGATE', 'timing': 1.1e-05, 'cardinality': 1, 'extra_info': 'first(#0)', 'children': [{'name': 'PROJECTION', 'timing': 1e-06, 'cardinality': 1, 'extra_info': '#0\n', 'children': [{'name': 'STREAMING_LIMIT', 'timing': 2e-06, 'cardinality': 1, 'extra_info': '', 'children': [{'name': 'UNGROUPED_AGGREGATE', 'timing': 0.000169, 'cardinality': 1, 'extra_info': 'avg(#0)', 'children': [{'name': 'PROJECTION', 'timing': 2e-05, 'cardinality': 38120, 'extra_info': 'c_acctbal\n', 'children': [{'name': 'PROJECTION', 'timing': 3.1e-05, 'cardinality': 38120, 'extra_info': '#0\n#2\n', 'children': [{'name': 'FILTER', 'timing': 0.001247, 'cardinality': 38120, 'extra_info': 'IN (...)\n[INFOSEPARATOR]\nEC: 6000', 'children': [{'name': 'HASH_JOIN', 'timing': 0.01097, 'cardinality': 136308, 'extra_info': 'MARK\nsubstring(c_phone, 1, 2) = #0\n\n[INFOSEPARATOR]\nEC: 30000\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.005847, 'cardinality': 136308, 'extra_info': 'customer\n[INFOSEPARATOR]\nc_acctbal\nc_phone\n[INFOSEPARATOR]\nFilters: c_acctbal>0.00 AND c_acctbal IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 30000', 'children': []}, {'name': 'COLUMN_DATA_SCAN', 'timing': 1e-05, 'cardinality': 7, 'extra_info': '', 'children': []}]}]}]}]}]}]}]}]}]}, {'name': 'HASH_JOIN', 'timing': 0.032507, 'cardinality': 6384, 'extra_info': 'RIGHT_ANTI\nc_custkey IS NOT DISTINCT FROM c_custkey\n\n[INFOSEPARATOR]\nEC: 1500000\n', 'children': [{'name': 'PROJECTION', 'timing': 0.000405, 'cardinality': 190069, 'extra_info': 'c_custkey\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.081258, 'cardinality': 190069, 'extra_info': 'INNER\no_custkey = c_custkey\n\n[INFOSEPARATOR]\nEC: 1500000\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.003548, 'cardinality': 1500000, 'extra_info': 'orders\n[INFOSEPARATOR]\no_custkey\n[INFOSEPARATOR]\nEC: 1500000', 'children': []}, {'name': 'DELIM_SCAN', 'timing': 0.0, 'cardinality': 0, 'extra_info': '', 'children': []}]}]}, {'name': 'DUMMY_SCAN', 'timing': 0.0, 'cardinality': 0, 'extra_info': '', 'children': []}]}, {'name': 'HASH_GROUP_BY', 'timing': 0.004274, 'cardinality': 19000, 'extra_info': '#2', 'children': []}]}]}]}]}]}]}]}
X {'RESULT_COLLECTOR0': 9e-06, 'ORDER_BY1': 0.000202, 'HASH_GROUP_BY2': 0.001555, 'PROJECTION3': 2e-06, 'PROJECTION4': 0.000244, 'RIGHT_DELIM_JOIN5': 0.006991, 'NESTED_LOOP_JOIN6': 0.002508, 'FILTER7': 0.001212, 'HASH_JOIN8': 0.010489, 'SEQ_SCAN 9': 0.003694, 'COLUMN_DATA_SCAN10': 2.2e-05, 'UNGROUPED_AGGREGATE11': 1.1e-05, 'PROJECTION12': 1e-06, 'STREAMING_LIMIT13': 2e-06, 'UNGROUPED_AGGREGATE14': 0.000169, 'PROJECTION15': 2e-05, 'PROJECTION16': 3.1e-05, 'FILTER17': 0.001247, 'HASH_JOIN18': 0.01097, 'SEQ_SCAN 19': 0.005847, 'COLUMN_DATA_SCAN20': 1e-05, 'HASH_JOIN21': 0.032507, 'PROJECTION22': 0.000405, 'HASH_JOIN23': 0.081258, 'SEQ_SCAN 24': 0.003548, 'DELIM_SCAN25': 0.0, 'DUMMY_SCAN26': 0.0, 'HASH_GROUP_BY27': 0.004274}
**** output size:  7
LINEAGE_5_COLUMN_DATA_SCAN_12
LINEAGE_5_COLUMN_DATA_SCAN_8
LINEAGE_5_FILTER_10
LINEAGE_5_FILTER_14
LINEAGE_5_HASH_GROUP_BY_25
LINEAGE_5_HASH_GROUP_BY_6
LINEAGE_5_HASH_JOIN_13
LINEAGE_5_HASH_JOIN_2
LINEAGE_5_HASH_JOIN_5
LINEAGE_5_HASH_JOIN_9
LINEAGE_5_NESTED_LOOP_JOIN_21
LINEAGE_5_ORDER_BY_26
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_11
LINEAGE_5_SEQ_SCAN_7
LINEAGE_5_STREAMING_LIMIT_18
SELECT cntrycode, count(*) AS numcust, sum(c_acctbal) AS totacctbal FROM ( SELECT substring(c_phone FROM 1 FOR 2) AS cntrycode, c_acctbal FROM customer WHERE substring(c_phone FROM 1 FOR 2) IN ('13', '31', '23', '29', '30', '18', '17') AND c_acctbal > ( SELECT avg(c_acctbal) FROM customer WHERE c_acctbal > 0.00 AND substring(c_phone FROM 1 FOR 2) IN ('13', '31', '23', '29', '30', '18', '17')) AND NOT EXISTS ( SELECT * FROM orders WHERE o_custkey = c_custkey)) AS custsale GROUP BY cntrycode ORDER BY cntrycode;
   query_id  ...                                               plan
0         5  ...  {"name": "ORDER_BY", "opid": "26", "children":...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               SELECT cntrycode, count(*) AS numcust, sum(c_a...
size_bytes_max                                                2327496
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "ORDER_BY", "opid": "26", "children":...
Name: 0, dtype: object
{"name": "ORDER_BY", "opid": "26", "children": [{"name": "HASH_GROUP_BY", "opid": "25", "children": [{"name": "PROJECTION", "opid": "24", "children": [{"name": "PROJECTION", "opid": "23", "children": [{"name": "RIGHT_DELIM_JOIN", "opid": "22", "children": [{"name": "HASH_GROUP_BY", "opid": "6", "children": [],"table": "","extra": "#2"},{"name": "HASH_JOIN", "opid": "5", "children": [{"name": "PROJECTION", "opid": "3", "children": [{"name": "HASH_JOIN", "opid": "2", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "orders","extra": "orders\n[INFOSEPARATOR]\no_custkey\n[INFOSEPARATOR]\nEC: 1500000"},{"name": "DELIM_SCAN", "opid": "1", "children": [],"table": "","extra": ""}],"table": "","extra": "INNER\no_custkey = c_custkey\n\n[INFOSEPARATOR]\nEC: 1500000\n"}],"table": "","extra": "c_custkey\n"},{"name": "DUMMY_SCAN", "opid": "4", "children": [],"table": "","extra": ""}],"table": "","extra": "RIGHT_ANTI\nc_custkey IS NOT DISTINCT FROM c_custkey\n\n[INFOSEPARATOR]\nEC: 1500000\n"},{"name": "NESTED_LOOP_JOIN", "opid": "21", "children": [{"name": "FILTER", "opid": "10", "children": [{"name": "HASH_JOIN", "opid": "9", "children": [{"name": "SEQ_SCAN ", "opid": "7", "children": [],"table": "customer","extra": "customer\n[INFOSEPARATOR]\nc_phone\nc_acctbal\nc_custkey\n[INFOSEPARATOR]\nEC: 150000"},{"name": "COLUMN_DATA_SCAN", "opid": "8", "children": [],"table": "","extra": ""}],"table": "","extra": "MARK\nsubstring(c_phone, 1, 2) = #0\n\n[INFOSEPARATOR]\nEC: 150000\n"}],"table": "","extra": "IN (...)\n[INFOSEPARATOR]\nEC: 30000"},{"name": "UNGROUPED_AGGREGATE", "opid": "20", "children": [{"name": "PROJECTION", "opid": "19", "children": [{"name": "STREAMING_LIMIT", "opid": "18", "children": [{"name": "UNGROUPED_AGGREGATE", "opid": "17", "children": [{"name": "PROJECTION", "opid": "16", "children": [{"name": "PROJECTION", "opid": "15", "children": [{"name": "FILTER", "opid": "14", "children": [{"name": "HASH_JOIN", "opid": "13", "children": [{"name": "SEQ_SCAN ", "opid": "11", "children": [],"table": "customer","extra": "customer\n[INFOSEPARATOR]\nc_acctbal\nc_phone\n[INFOSEPARATOR]\nFilters: c_acctbal>0.00 AND c_acctbal IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 30000"},{"name": "COLUMN_DATA_SCAN", "opid": "12", "children": [],"table": "","extra": ""}],"table": "","extra": "MARK\nsubstring(c_phone, 1, 2) = #0\n\n[INFOSEPARATOR]\nEC: 30000\n"}],"table": "","extra": "IN (...)\n[INFOSEPARATOR]\nEC: 6000"}],"table": "","extra": "#0\n#2\n"}],"table": "","extra": "c_acctbal\n"}],"table": "","extra": "avg(#0)"}],"table": "","extra": ""}],"table": "","extra": "#0\n"}],"table": "","extra": "first(#0)"}],"table": "","extra": "INNER\nCAST(c_acctbal AS DOUBLE) > SUBQUERY\n\n[INFOSEPARATOR]\nEC: 0\n"}],"table": "","extra": "RIGHT_ANTI\nc_custkey IS NOT DISTINCT FROM c_custkey\n\n[INFOSEPARATOR]\nEC: 1500000\n"}],"table": "","extra": "cntrycode\nc_acctbal\n"}],"table": "","extra": "cntrycode\nc_acctbal\n"}],"table": "","extra": "#0\ncount_star()\nsum(#1)"}],"table": "","extra": "ORDERS:\ncustsale.cntrycode ASC"}
Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐
│         PROJECTION        │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│__internal_decompress_strin│
│           g(#0)           │
│__internal_decompress_strin│
│           g(#1)           │
│             #2            │
│             #3            │
│             #4            │
│             #5            │
│             #6            │
│             #7            │
│             #8            │
│             #9            │
└─────────────┬─────────────┘                             
┌─────────────┴─────────────┐
│          ORDER_BY         │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│          ORDERS:          │
│ lineitem.l_returnflag ASC │
│ lineitem.l_linestatus ASC │
└─────────────┬─────────────┘                             
┌─────────────┴─────────────┐
│         PROJECTION        │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│__internal_compress_string_│
│        utinyint(#0)       │
│__internal_compress_string_│
│        utinyint(#1)       │
│             #2            │
│             #3            │
│             #4            │
│             #5            │
│             #6            │
│             #7            │
│             #8            │
│             #9            │
└─────────────┬─────────────┘                             
┌─────────────┴─────────────┐
│         PROJECTION        │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│__internal_decompress_strin│
│           g(#0)           │
│__internal_decompress_strin│
│           g(#1)           │
│             #2            │
│             #3            │
│             #4            │
│             #5            │
│             #6            │
│             #7            │
│             #8            │
│             #9            │
└─────────────┬─────────────┘                             
┌─────────────┴─────────────┐
│   PERFECT_HASH_GROUP_BY   │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│             #0            │
│             #1            │
│    sum_no_overflow(#2)    │
│    sum_no_overflow(#3)    │
│    sum_no_overflow(#4)    │
│    sum_no_overflow(#5)    │
│          avg(#6)          │
│          avg(#7)          │
│          avg(#8)          │
│        count_star()       │
└─────────────┬─────────────┘                             
┌─────────────┴─────────────┐
│         PROJECTION        │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│        l_returnflag       │
│        l_linestatus       │
│         l_quantity        │
│      l_extendedprice      │
│             #4            │
│   (#4 * (1.00 + l_tax))   │
│         l_quantity        │
│      l_extendedprice      │
│         l_discount        │
└─────────────┬─────────────┘                             
┌─────────────┴─────────────┐
│         PROJECTION        │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│__internal_compress_string_│
│        utinyint(#0)       │
│__internal_compress_string_│
│        utinyint(#1)       │
│             #2            │
│             #3            │
│             #4            │
│             #5            │
│             #6            │
└─────────────┬─────────────┘                             
┌─────────────┴─────────────┐
│         PROJECTION        │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│        l_returnflag       │
│        l_linestatus       │
│         l_quantity        │
│      l_extendedprice      │
│ (l_extendedprice * (1.00 -│
│        l_discount))       │
│           l_tax           │
│         l_discount        │
└─────────────┬─────────────┘                             
┌─────────────┴─────────────┐
│         SEQ_SCAN          │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│          lineitem         │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│        l_returnflag       │
│        l_linestatus       │
│         l_quantity        │
│      l_extendedprice      │
│         l_discount        │
│           l_tax           │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│ Filters: l_shipdate<='1998│
│-09-02'::DATE AND l_sh...  │
│         IS NOT NULL       │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│        EC: 1200243        │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

compressed filter_log_size: 1760
compressed filter_log_buffer_size: 0
compressed limit_offset_size: 1760
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 1760
compressed perfect_full_scan_ht_log_buffer_size: 0
compressed perfect_probe_ht_log_size: 1760
compressed perfect_probe_ht_log_buffer_size: 0
compressed row_group_log_size: 268981
compressed row_group_log_buffer_size: 224597
compressed scatter_log_size: 12836752
compressed scatter_log_buffer_size: 12820430
compressed scatter_sel_log_size: 1760
compressed scatter_sel_log_buffer_size: 0
compressed gather_log_size: 1760
compressed gather_log_buffer_size: 0
compressed combine_log_size: 5088
compressed combine_log_buffer_size: 1024
compressed finalize_states_log_size: 1974
compressed finalize_states_log_buffer_size: 70
compressed join_gather_log_size: 1760
compressed join_gather_log_buffer_size: 0
compressed reorder_log_size: 2720
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 1760
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 1760
compressed nlj_log_buffer_size: 0
compressed total_size: 13131355
compressed total_buffer_size: 13046121
compressed total_element_size: 85234

Clear Lineage

%%%%%%%%%%%%%%%% Running Query #  1  threads:  16
SELECT l_returnflag, l_linestatus, sum(l_quantity) AS sum_qty, sum(l_extendedprice) AS sum_base_price, sum(l_extendedprice * (1 - l_discount)) AS sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) AS sum_charge, avg(l_quantity) AS avg_qty, avg(l_extendedprice) AS avg_price, avg(l_discount) AS avg_disc, count(*) AS count_order FROM lineitem WHERE l_shipdate <= CAST('1998-09-02' AS date) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus
Run:  None SELECT l_returnflag, l_linestatus, sum(l_quantity) AS sum_qty, sum(l_extendedprice) AS sum_base_price, sum(l_extendedprice * (1 - l_discount)) AS sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) AS sum_charge, avg(l_quantity) AS avg_qty, avg(l_extendedprice) AS avg_price, avg(l_discount) AS avg_disc, count(*) AS count_order FROM lineitem WHERE l_shipdate <= CAST('1998-09-02' AS date) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus
Avg Time in sec:  0.10182584123685956  output size:  4
  l_returnflag l_linestatus     sum_qty  ...     avg_price  avg_disc  count_order
0            A            F  37734107.0  ...  38273.129735  0.049985      1478493
1            N            F    991417.0  ...  38284.467761  0.050093        38854
2            N            O  74476040.0  ...  38249.117989  0.049997      2920374
3            R            F  37719753.0  ...  38250.854626  0.050009      1478870

[4 rows x 10 columns]
{'name': 'Query', 'result': 0.093448, 'timing': 0.093448, 'cardinality': 0, 'extra-info': "SELECT l_returnflag, l_linestatus, sum(l_quantity) AS sum_qty, sum(l_extendedprice) AS sum_base_price, sum(l_extendedprice * (1 - l_discount)) AS sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) AS sum_charge, avg(l_quantity) AS avg_qty, avg(l_extendedprice) AS avg_price, avg(l_discount) AS avg_disc, count(*) AS count_order FROM lineitem WHERE l_shipdate <= CAST('1998-09-02' AS date) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 1.3e-05, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 4e-06, 'cardinality': 4, 'extra_info': '__internal_decompress_string(#0)\n__internal_decompress_string(#1)\n#2\n#3\n#4\n#5\n#6\n#7\n#8\n#9\n', 'children': [{'name': 'ORDER_BY', 'timing': 5.4e-05, 'cardinality': 4, 'extra_info': 'ORDERS:\nlineitem.l_returnflag ASC\nlineitem.l_linestatus ASC', 'children': [{'name': 'PROJECTION', 'timing': 3e-06, 'cardinality': 4, 'extra_info': '__internal_compress_string_utinyint(#0)\n__internal_compress_string_utinyint(#1)\n#2\n#3\n#4\n#5\n#6\n#7\n#8\n#9\n', 'children': [{'name': 'PROJECTION', 'timing': 5e-06, 'cardinality': 4, 'extra_info': '__internal_decompress_string(#0)\n__internal_decompress_string(#1)\n#2\n#3\n#4\n#5\n#6\n#7\n#8\n#9\n', 'children': [{'name': 'PERFECT_HASH_GROUP_BY', 'timing': 0.316711, 'cardinality': 4, 'extra_info': '#0\n#1\nsum_no_overflow(#2)\nsum_no_overflow(#3)\nsum_no_overflow(#4)\nsum_no_overflow(#5)\navg(#6)\navg(#7)\navg(#8)\ncount_star()', 'children': [{'name': 'PROJECTION', 'timing': 0.121443, 'cardinality': 5916591, 'extra_info': 'l_returnflag\nl_linestatus\nl_quantity\nl_extendedprice\n#4\n(#4 * (1.00 + l_tax))\nl_quantity\nl_extendedprice\nl_discount\n', 'children': [{'name': 'PROJECTION', 'timing': 0.042314, 'cardinality': 5916591, 'extra_info': '__internal_compress_string_utinyint(#0)\n__internal_compress_string_utinyint(#1)\n#2\n#3\n#4\n#5\n#6\n', 'children': [{'name': 'PROJECTION', 'timing': 0.118582, 'cardinality': 5916591, 'extra_info': 'l_returnflag\nl_linestatus\nl_quantity\nl_extendedprice\n(l_extendedprice * (1.00 - l_discount))\nl_tax\nl_discount\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.722738, 'cardinality': 5916591, 'extra_info': "lineitem\n[INFOSEPARATOR]\nl_returnflag\nl_linestatus\nl_quantity\nl_extendedprice\nl_discount\nl_tax\n[INFOSEPARATOR]\nFilters: l_shipdate<='1998-09-02'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243", 'children': []}]}]}]}]}]}]}]}]}]}]}
X {'RESULT_COLLECTOR0': 1.3e-05, 'PROJECTION1': 4e-06, 'ORDER_BY2': 5.4e-05, 'PROJECTION3': 3e-06, 'PROJECTION4': 5e-06, 'PERFECT_HASH_GROUP_BY5': 0.316711, 'PROJECTION6': 0.121443, 'PROJECTION7': 0.042314, 'PROJECTION8': 0.118582, 'SEQ_SCAN 9': 0.722738}
**** output size:  4
LINEAGE_5_ORDER_BY_7
LINEAGE_5_PERFECT_HASH_GROUP_BY_4
LINEAGE_5_SEQ_SCAN_0
SELECT l_returnflag, l_linestatus, sum(l_quantity) AS sum_qty, sum(l_extendedprice) AS sum_base_price, sum(l_extendedprice * (1 - l_discount)) AS sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) AS sum_charge, avg(l_quantity) AS avg_qty, avg(l_extendedprice) AS avg_price, avg(l_discount) AS avg_disc, count(*) AS count_order FROM lineitem WHERE l_shipdate <= CAST('1998-09-02' AS date) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus
   query_id  ...                                               plan
0         5  ...  {"name": "PROJECTION", "opid": "8", "children"...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               SELECT l_returnflag, l_linestatus, sum(l_quant...
size_bytes_max                                               13131355
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "PROJECTION", "opid": "8", "children"...
Name: 0, dtype: object
{"name": "PROJECTION", "opid": "8", "children": [{"name": "ORDER_BY", "opid": "7", "children": [{"name": "PROJECTION", "opid": "6", "children": [{"name": "PROJECTION", "opid": "5", "children": [{"name": "PERFECT_HASH_GROUP_BY", "opid": "4", "children": [{"name": "PROJECTION", "opid": "3", "children": [{"name": "PROJECTION", "opid": "2", "children": [{"name": "PROJECTION", "opid": "1", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_returnflag\nl_linestatus\nl_quantity\nl_extendedprice\nl_discount\nl_tax\n[INFOSEPARATOR]\nFilters: l_shipdate<='1998-09-02'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243"}],"table": "","extra": "l_returnflag\nl_linestatus\nl_quantity\nl_extendedprice\n(l_extendedprice * (1.00 - l_discount))\nl_tax\nl_discount\n"}],"table": "","extra": "__internal_compress_string_utinyint(#0)\n__internal_compress_string_utinyint(#1)\n#2\n#3\n#4\n#5\n#6\n"}],"table": "","extra": "l_returnflag\nl_linestatus\nl_quantity\nl_extendedprice\n#4\n(#4 * (1.00 + l_tax))\nl_quantity\nl_extendedprice\nl_discount\n"}],"table": "","extra": "#0\n#1\nsum_no_overflow(#2)\nsum_no_overflow(#3)\nsum_no_overflow(#4)\nsum_no_overflow(#5)\navg(#6)\navg(#7)\navg(#8)\ncount_star()"}],"table": "","extra": "__internal_decompress_string(#0)\n__internal_decompress_string(#1)\n#2\n#3\n#4\n#5\n#6\n#7\n#8\n#9\n"}],"table": "","extra": "__internal_compress_string_utinyint(#0)\n__internal_compress_string_utinyint(#1)\n#2\n#3\n#4\n#5\n#6\n#7\n#8\n#9\n"}],"table": "","extra": "ORDERS:\nlineitem.l_returnflag ASC\nlineitem.l_linestatus ASC"}],"table": "","extra": "__internal_decompress_string(#0)\n__internal_decompress_string(#1)\n#2\n#3\n#4\n#5\n#6\n#7\n#8\n#9\n"}
%%%%%%%%%%%%%%%% Running Query #  2  threads:  16
SELECT s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment FROM part, supplier, partsupp, nation, region WHERE p_partkey = ps_partkey AND s_suppkey = ps_suppkey AND p_size = 15 AND p_type LIKE '%BRASS' AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'EUROPE' AND ps_supplycost = ( SELECT min(ps_supplycost) FROM partsupp, supplier, nation, region WHERE p_partkey = ps_partkey AND s_suppkey = ps_suppkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'EUROPE' ) ORDER BY s_acctbal DESC, n_name, s_name, p_partkey LIMIT 100;
Run:  None SELECT s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment FROM part, supplier, partsupp, nation, region WHERE p_partkey = ps_partkey AND s_suppkey = ps_suppkey AND p_size = 15 AND p_type LIKE '%BRASS' AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'EUROPE' AND ps_supplycost = ( SELECT min(ps_supplycost) FROM partsupp, supplier, nation, region WHERE p_partkey = ps_partkey AND s_suppkey = ps_suppkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'EUROPE' ) ORDER BY s_acctbal DESC, n_name, s_name, p_partkey LIMIT 100;
Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────┐                                                                                                                                                                                                                  
│       LIMIT       │                                                                                                                                                                                                                  
└─────────┬─────────┘                                                                                                                                                                                                                                       
┌─────────┴─────────┐                                                                                                                                                                                                                  
│     PROJECTION    │                                                                                                                                                                                                                  
│   ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                                  
│         #0        │                                                                                                                                                                                                                  
│         #1        │                                                                                                                                                                                                                  
│__internal_decompre│                                                                                                                                                                                                                  
│   ss_string(#2)   │                                                                                                                                                                                                                  
│__internal_decompre│                                                                                                                                                                                                                  
│ss_integral_bigint(│                                                                                                                                                                                                                  
│       #3, 1)      │                                                                                                                                                                                                                  
│__internal_decompre│                                                                                                                                                                                                                  
│   ss_string(#4)   │                                                                                                                                                                                                                  
│         #5        │                                                                                                                                                                                                                  
│__internal_decompre│                                                                                                                                                                                                                  
│   ss_string(#6)   │                                                                                                                                                                                                                  
│         #7        │                                                                                                                                                                                                                  
└─────────┬─────────┘                                                                                                                                                                                                                                       
┌─────────┴─────────┐                                                                                                                                                                                                                  
│      ORDER_BY     │                                                                                                                                                                                                                  
│   ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                                  
│      ORDERS:      │                                                                                                                                                                                                                  
│ supplier.s_acctbal│                                                                                                                                                                                                                  
│        DESC       │                                                                                                                                                                                                                  
│ nation.n_name ASC │                                                                                                                                                                                                                  
│supplier.s_name ASC│                                                                                                                                                                                                                  
│ part.p_partkey ASC│                                                                                                                                                                                                                  
└─────────┬─────────┘                                                                                                                                                                                                                                       
┌─────────┴─────────┐                                                                                                                                                                                                                  
│     PROJECTION    │                                                                                                                                                                                                                  
│   ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                                  
│         #0        │                                                                                                                                                                                                                  
│         #1        │                                                                                                                                                                                                                  
│__internal_compress│                                                                                                                                                                                                                  
│_string_hugeint(#2)│                                                                                                                                                                                                                  
│__internal_compress│                                                                                                                                                                                                                  
│_integral_uinteger(│                                                                                                                                                                                                                  
│       #3, 1)      │                                                                                                                                                                                                                  
│__internal_compress│                                                                                                                                                                                                                  
│_string_hugeint(#4)│                                                                                                                                                                                                                  
│         #5        │                                                                                                                                                                                                                  
│__internal_compress│                                                                                                                                                                                                                  
│_string_hugeint(#6)│                                                                                                                                                                                                                  
│         #7        │                                                                                                                                                                                                                  
└─────────┬─────────┘                                                                                                                                                                                                                                       
┌─────────┴─────────┐                                                                                                                                                                                                                  
│     PROJECTION    │                                                                                                                                                                                                                  
│   ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                                  
│     s_acctbal     │                                                                                                                                                                                                                  
│       s_name      │                                                                                                                                                                                                                  
│       n_name      │                                                                                                                                                                                                                  
│     p_partkey     │                                                                                                                                                                                                                  
│       p_mfgr      │                                                                                                                                                                                                                  
│     s_address     │                                                                                                                                                                                                                  
│      s_phone      │                                                                                                                                                                                                                  
│     s_comment     │                                                                                                                                                                                                                  
└─────────┬─────────┘                                                                                                                                                                                                                                       
┌─────────┴─────────┐                                                                                                                                                                                                                  
│     PROJECTION    │                                                                                                                                                                                                                  
│   ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                                  
│         #0        │                                                                                                                                                                                                                  
│         #2        │                                                                                                                                                                                                                  
│         #4        │                                                                                                                                                                                                                  
│         #6        │                                                                                                                                                                                                                  
│         #8        │                                                                                                                                                                                                                  
│         #9        │                                                                                                                                                                                                                  
│        #10        │                                                                                                                                                                                                                  
│        #11        │                                                                                                                                                                                                                  
│        #12        │                                                                                                                                                                                                                  
│        #13        │                                                                                                                                                                                                                  
└─────────┬─────────┘                                                                                                                                                                                                                                       
┌─────────┴─────────┐                                                                                                                                                                                                                  
│       FILTER      │                                                                                                                                                                                                                  
│   ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                                  
│  (ps_supplycost = │                                                                                                                                                                                                                  
│      SUBQUERY)    │                                                                                                                                                                                                                  
│   ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                                  
│     EC: 400000    │                                                                                                                                                                                                                  
└─────────┬─────────┘                                                                                                                                                                                                                                       
┌─────────┴─────────┐                                                                                                                                                                                                                  
│  RIGHT_DELIM_JOIN │                                                                                                                                                                                                                  
│   ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                                  
│       RIGHT       │                                                                                                                                                                                                                  
│  p_partkey IS NOT │                                                                                                                                                                                                                  
│    DISTINCT FROM  ├──────────────────────────────────────────────────────────────────────────────────────────────┐                                                                                                                   
│      p_partkey    │                                                                                              │                                                                                                                   
│   ─ ─ ─ ─ ─ ─ ─   │                                                                                              │                                                                                                                   
│     EC: 400000    │                                                                                              │                                                                                                                   
└─────────┬─────────┘                                                                                              │                                                                                                                                        
┌─────────┴─────────┐                                                                                    ┌─────────┴─────────┐                                                                                                         
│     HASH_JOIN     │                                                                                    │     HASH_JOIN     │                                                                                                         
│   ─ ─ ─ ─ ─ ─ ─   │                                                                                    │   ─ ─ ─ ─ ─ ─ ─   │                                                                                                         
│       INNER       │                                                                                    │       RIGHT       │                                                                                                         
│    ps_suppkey =   │                                                                                    │  p_partkey IS NOT │                                                                                                         
│      s_suppkey    │                                                                                    │    DISTINCT FROM  │                                                                                                         
│   ─ ─ ─ ─ ─ ─ ─   ├───────────────────────────────┐                                                    │      p_partkey    ├──────────────────────────────────────────────────────────────────────────────────────────────┐          
│    Build Min: 1   │                               │                                                    │   ─ ─ ─ ─ ─ ─ ─   │                                                                                              │          
│  Build Max: 10000 │                               │                                                    │     EC: 400000    │                                                                                              │          
│   ─ ─ ─ ─ ─ ─ ─   │                               │                                                    │                   │                                                                                              │          
│      EC: 587      │                               │                                                    │                   │                                                                                              │          
└─────────┬─────────┘                               │                                                    └─────────┬─────────┘                                                                                              │                               
┌─────────┴─────────┐                     ┌─────────┴─────────┐                                          ┌─────────┴─────────┐                                                                                    ┌─────────┴─────────┐
│     HASH_JOIN     │                     │     HASH_JOIN     │                                          │     PROJECTION    │                                                                                    │     DUMMY_SCAN    │
│   ─ ─ ─ ─ ─ ─ ─   │                     │   ─ ─ ─ ─ ─ ─ ─   │                                          │   ─ ─ ─ ─ ─ ─ ─   │                                                                                    │                   │
│       INNER       │                     │       INNER       │                                          │ min(ps_supplycost)│                                                                                    │                   │
│    ps_partkey =   │                     │   s_nationkey =   │                                          │     p_partkey     │                                                                                    │                   │
│      p_partkey    │                     │     n_nationkey   │                                          │                   │                                                                                    │                   │
│   ─ ─ ─ ─ ─ ─ ─   ├──────────┐          │   ─ ─ ─ ─ ─ ─ ─   ├──────────┐                               │                   │                                                                                    │                   │
│    Build Min: 1   │          │          │    Build Min: 0   │          │                               │                   │                                                                                    │                   │
│ Build Max: 200000 │          │          │   Build Max: 24   │          │                               │                   │                                                                                    │                   │
│   ─ ─ ─ ─ ─ ─ ─   │          │          │   ─ ─ ─ ─ ─ ─ ─   │          │                               │                   │                                                                                    │                   │
│      EC: 3377     │          │          │      EC: 2000     │          │                               │                   │                                                                                    │                   │
└─────────┬─────────┘          │          └─────────┬─────────┘          │                               └─────────┬─────────┘                                                                                    └───────────────────┘                     
┌─────────┴─────────┐┌─────────┴─────────┐┌─────────┴─────────┐┌─────────┴─────────┐                     ┌─────────┴─────────┐                                                                                                         
│     SEQ_SCAN      ││       FILTER      ││     SEQ_SCAN      ││     HASH_JOIN     │                     │     PROJECTION    │                                                                                                         
│   ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─   │                     │   ─ ─ ─ ─ ─ ─ ─   │                                                                                                         
│      partsupp     ││  suffix(p_type,   ││      supplier     ││       INNER       │                     │__internal_decompre│                                                                                                         
│   ─ ─ ─ ─ ─ ─ ─   ││      'BRASS')     ││   ─ ─ ─ ─ ─ ─ ─   ││   n_regionkey =   │                     │ss_integral_bigint(│                                                                                                         
│     ps_partkey    ││   ─ ─ ─ ─ ─ ─ ─   ││     s_suppkey     ││     r_regionkey   │                     │       #0, 1)      │                                                                                                         
│     ps_suppkey    ││      EC: 800      ││    s_nationkey    ││   ─ ─ ─ ─ ─ ─ ─   │                     │         #1        │                                                                                                         
│   ps_supplycost   ││                   ││     s_acctbal     ││    Build Min: 0   ├──────────┐          │                   │                                                                                                         
│   ─ ─ ─ ─ ─ ─ ─   ││                   ││       s_name      ││    Build Max: 4   │          │          │                   │                                                                                                         
│     EC: 800000    ││                   ││     s_address     ││   ─ ─ ─ ─ ─ ─ ─   │          │          │                   │                                                                                                         
│                   ││                   ││      s_phone      ││       EC: 5       │          │          │                   │                                                                                                         
│                   ││                   ││     s_comment     ││                   │          │          │                   │                                                                                                         
│                   ││                   ││   ─ ─ ─ ─ ─ ─ ─   ││                   │          │          │                   │                                                                                                         
│                   ││                   ││     EC: 10000     ││                   │          │          │                   │                                                                                                         
└───────────────────┘└─────────┬─────────┘└───────────────────┘└─────────┬─────────┘          │          └─────────┬─────────┘                                                                                                                              
                     ┌─────────┴─────────┐                     ┌─────────┴─────────┐┌─────────┴─────────┐┌─────────┴─────────┐                                                                                                         
                     │     SEQ_SCAN      │                     │     SEQ_SCAN      ││     SEQ_SCAN      ││   HASH_GROUP_BY   │                                                                                                         
                     │   ─ ─ ─ ─ ─ ─ ─   │                     │   ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─   │                                                                                                         
                     │        part       │                     │       nation      ││       region      ││         #0        │                                                                                                         
                     │   ─ ─ ─ ─ ─ ─ ─   │                     │   ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─   ││      min(#1)      │                                                                                                         
                     │     p_partkey     │                     │    n_nationkey    ││    r_regionkey    ││                   │                                                                                                         
                     │       p_type      │                     │    n_regionkey    ││   ─ ─ ─ ─ ─ ─ ─   ││                   │                                                                                                         
                     │       p_mfgr      │                     │       n_name      ││  Filters: r_name= ││                   │                                                                                                         
                     │   ─ ─ ─ ─ ─ ─ ─   │                     │   ─ ─ ─ ─ ─ ─ ─   ││'EUROPE' AND r...  ││                   │                                                                                                         
                     │ Filters: p_size=15│                     │       EC: 25      ││      NOT NULL     ││                   │                                                                                                         
                     │  AND p_size IS NOT│                     │                   ││   ─ ─ ─ ─ ─ ─ ─   ││                   │                                                                                                         
                     │        NULL       │                     │                   ││       EC: 1       ││                   │                                                                                                         
                     │   ─ ─ ─ ─ ─ ─ ─   │                     │                   ││                   ││                   │                                                                                                         
                     │      EC: 800      │                     │                   ││                   ││                   │                                                                                                         
                     └───────────────────┘                     └───────────────────┘└───────────────────┘└─────────┬─────────┘                                                                                                                              
                                                                                                         ┌─────────┴─────────┐                                                                                                         
                                                                                                         │     PROJECTION    │                                                                                                         
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   │                                                                                                         
                                                                                                         │     p_partkey     │                                                                                                         
                                                                                                         │   ps_supplycost   │                                                                                                         
                                                                                                         └─────────┬─────────┘                                                                                                                              
                                                                                                         ┌─────────┴─────────┐                                                                                                         
                                                                                                         │     PROJECTION    │                                                                                                         
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   │                                                                                                         
                                                                                                         │__internal_compress│                                                                                                         
                                                                                                         │_integral_uinteger(│                                                                                                         
                                                                                                         │       #0, 1)      │                                                                                                         
                                                                                                         │__internal_compress│                                                                                                         
                                                                                                         │_integral_usmallint│                                                                                                         
                                                                                                         │      (#1, 1)      │                                                                                                         
                                                                                                         │         #2        │                                                                                                         
                                                                                                         │__internal_compress│                                                                                                         
                                                                                                         │_integral_usmallint│                                                                                                         
                                                                                                         │      (#3, 1)      │                                                                                                         
                                                                                                         │__internal_compress│                                                                                                         
                                                                                                         │_integral_utinyint(│                                                                                                         
                                                                                                         │       #4, 0)      │                                                                                                         
                                                                                                         │__internal_compress│                                                                                                         
                                                                                                         │_integral_utinyint(│                                                                                                         
                                                                                                         │       #5, 0)      │                                                                                                         
                                                                                                         │__internal_compress│                                                                                                         
                                                                                                         │_integral_utinyint(│                                                                                                         
                                                                                                         │       #6, 0)      │                                                                                                         
                                                                                                         │__internal_compress│                                                                                                         
                                                                                                         │_integral_utinyint(│                                                                                                         
                                                                                                         │       #7, 0)      │                                                                                                         
                                                                                                         │         #8        │                                                                                                         
                                                                                                         └─────────┬─────────┘                                                                                                                              
                                                                                                         ┌─────────┴─────────┐                                                                                                         
                                                                                                         │     HASH_JOIN     │                                                                                                         
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   │                                                                                                         
                                                                                                         │       INNER       │                                                                                                         
                                                                                                         │    ps_partkey =   ├─────────────────────────────────────────────────────────────────────────┐                               
                                                                                                         │      p_partkey    │                                                                         │                               
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   │                                                                         │                               
                                                                                                         │     EC: 800000    │                                                                         │                               
                                                                                                         └─────────┬─────────┘                                                                         │                                                    
                                                                                                         ┌─────────┴─────────┐                                                               ┌─────────┴─────────┐                     
                                                                                                         │     HASH_JOIN     │                                                               │     DELIM_SCAN    │                     
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   │                                                               │                   │                     
                                                                                                         │       INNER       │                                                               │                   │                     
                                                                                                         │   n_regionkey =   │                                                               │                   │                     
                                                                                                         │     r_regionkey   │                                                               │                   │                     
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   ├────────────────────────────────────────────────────┐          │                   │                     
                                                                                                         │    Build Min: 0   │                                                    │          │                   │                     
                                                                                                         │    Build Max: 4   │                                                    │          │                   │                     
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   │                                                    │          │                   │                     
                                                                                                         │     EC: 800000    │                                                    │          │                   │                     
                                                                                                         └─────────┬─────────┘                                                    │          └───────────────────┘                                          
                                                                                                         ┌─────────┴─────────┐                                          ┌─────────┴─────────┐                                          
                                                                                                         │     HASH_JOIN     │                                          │     SEQ_SCAN      │                                          
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   │                                          │   ─ ─ ─ ─ ─ ─ ─   │                                          
                                                                                                         │       INNER       │                                          │       region      │                                          
                                                                                                         │   s_nationkey =   │                                          │   ─ ─ ─ ─ ─ ─ ─   │                                          
                                                                                                         │     n_nationkey   │                                          │    r_regionkey    │                                          
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   ├───────────────────────────────┐          │   ─ ─ ─ ─ ─ ─ ─   │                                          
                                                                                                         │    Build Min: 0   │                               │          │  Filters: r_name= │                                          
                                                                                                         │   Build Max: 24   │                               │          │'EUROPE' AND r...  │                                          
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   │                               │          │      NOT NULL     │                                          
                                                                                                         │     EC: 800000    │                               │          │   ─ ─ ─ ─ ─ ─ ─   │                                          
                                                                                                         │                   │                               │          │       EC: 1       │                                          
                                                                                                         └─────────┬─────────┘                               │          └───────────────────┘                                                               
                                                                                                         ┌─────────┴─────────┐                     ┌─────────┴─────────┐                                                               
                                                                                                         │     HASH_JOIN     │                     │     SEQ_SCAN      │                                                               
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   │                     │   ─ ─ ─ ─ ─ ─ ─   │                                                               
                                                                                                         │       INNER       │                     │       nation      │                                                               
                                                                                                         │    ps_suppkey =   │                     │   ─ ─ ─ ─ ─ ─ ─   │                                                               
                                                                                                         │      s_suppkey    │                     │    n_nationkey    │                                                               
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   ├──────────┐          │    n_regionkey    │                                                               
                                                                                                         │    Build Min: 1   │          │          │   ─ ─ ─ ─ ─ ─ ─   │                                                               
                                                                                                         │  Build Max: 10000 │          │          │       EC: 25      │                                                               
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   │          │          │                   │                                                               
                                                                                                         │     EC: 800000    │          │          │                   │                                                               
                                                                                                         └─────────┬─────────┘          │          └───────────────────┘                                                                                    
                                                                                                         ┌─────────┴─────────┐┌─────────┴─────────┐                                                                                    
                                                                                                         │     SEQ_SCAN      ││     SEQ_SCAN      │                                                                                    
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─   │                                                                                    
                                                                                                         │      partsupp     ││      supplier     │                                                                                    
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─   │                                                                                    
                                                                                                         │     ps_partkey    ││     s_suppkey     │                                                                                    
                                                                                                         │     ps_suppkey    ││    s_nationkey    │                                                                                    
                                                                                                         │   ps_supplycost   ││   ─ ─ ─ ─ ─ ─ ─   │                                                                                    
                                                                                                         │   ─ ─ ─ ─ ─ ─ ─   ││     EC: 10000     │                                                                                    
                                                                                                         │     EC: 800000    ││                   │                                                                                    
                                                                                                         └───────────────────┘└───────────────────┘                                                                                                         

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

Avg Time in sec:  0.06836493080481887  output size:  100
    s_acctbal  ...                                          s_comment
0     9938.53  ...                      l, ironic instructions cajole
1     9937.84  ...  es. furiously silent deposits among the deposi...
2     9936.22  ...  ar, regular requests nag blithely special acco...
3     9923.77  ...  s sleep according to the quick requests. caref...
4     9871.22  ...  against the slyly daring requests. unusual acc...
..        ...  ...                                                ...
95    7887.08  ...   the regular ideas. furiously bold deposits bo...
96    7871.50  ...  ording to the furious theodolites cajole caref...
97    7852.45  ...  egular, regular ideas. requests are carefully....
98    7850.66  ...                   ccounts. special, final deposits
99    7843.52  ...  sits. blithely regular requests above the pend...

[100 rows x 8 columns]
{'name': 'Query', 'result': 0.058085, 'timing': 0.058085, 'cardinality': 0, 'extra-info': "SELECT s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment FROM part, supplier, partsupp, nation, region WHERE p_partkey = ps_partkey AND s_suppkey = ps_suppkey AND p_size = 15 AND p_type LIKE '%BRASS' AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'EUROPE' AND ps_supplycost = ( SELECT min(ps_supplycost) FROM partsupp, supplier, nation, region WHERE p_partkey = ps_partkey AND s_suppkey = ps_suppkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'EUROPE' ) ORDER BY s_acctbal DESC, n_name, s_name, p_partkey LIMIT 100;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 3.7e-05, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'LIMIT', 'timing': 0.000262, 'cardinality': 100, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 7.9e-05, 'cardinality': 460, 'extra_info': '#0\n#1\n__internal_decompress_string(#2)\n__internal_decompress_integral_bigint(#3, 1)\n__internal_decompress_string(#4)\n#5\n__internal_decompress_string(#6)\n#7\n', 'children': [{'name': 'ORDER_BY', 'timing': 0.000825, 'cardinality': 460, 'extra_info': 'ORDERS:\nsupplier.s_acctbal DESC\nnation.n_name ASC\nsupplier.s_name ASC\npart.p_partkey ASC', 'children': [{'name': 'PROJECTION', 'timing': 0.000142, 'cardinality': 460, 'extra_info': '#0\n#1\n__internal_compress_string_hugeint(#2)\n__internal_compress_integral_uinteger(#3, 1)\n__internal_compress_string_hugeint(#4)\n#5\n__internal_compress_string_hugeint(#6)\n#7\n', 'children': [{'name': 'PROJECTION', 'timing': 1.1e-05, 'cardinality': 460, 'extra_info': 's_acctbal\ns_name\nn_name\np_partkey\np_mfgr\ns_address\ns_phone\ns_comment\n', 'children': [{'name': 'PROJECTION', 'timing': 1.9e-05, 'cardinality': 460, 'extra_info': '#0\n#2\n#4\n#6\n#8\n#9\n#10\n#11\n#12\n#13\n', 'children': [{'name': 'FILTER', 'timing': 0.000406, 'cardinality': 460, 'extra_info': '(ps_supplycost = SUBQUERY)\n[INFOSEPARATOR]\nEC: 400000', 'children': [{'name': 'RIGHT_DELIM_JOIN', 'timing': 0.019082, 'cardinality': 0, 'extra_info': 'RIGHT\np_partkey IS NOT DISTINCT FROM p_partkey\n\n[INFOSEPARATOR]\nEC: 400000\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.001094, 'cardinality': 642, 'extra_info': 'INNER\nps_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 587\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.011183, 'cardinality': 2988, 'extra_info': 'INNER\nps_partkey = p_partkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 3377\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.003973, 'cardinality': 800000, 'extra_info': 'partsupp\n[INFOSEPARATOR]\nps_partkey\nps_suppkey\nps_supplycost\n[INFOSEPARATOR]\nEC: 800000', 'children': []}, {'name': 'FILTER', 'timing': 0.001323, 'cardinality': 747, 'extra_info': "suffix(p_type, 'BRASS')\n[INFOSEPARATOR]\nEC: 800", 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.020616, 'cardinality': 3907, 'extra_info': 'part\n[INFOSEPARATOR]\np_partkey\np_type\np_mfgr\n[INFOSEPARATOR]\nFilters: p_size=15 AND p_size IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 800', 'children': []}]}]}, {'name': 'HASH_JOIN', 'timing': 0.000205, 'cardinality': 1987, 'extra_info': 'INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 2000\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.0013, 'cardinality': 10000, 'extra_info': 'supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\ns_acctbal\ns_name\ns_address\ns_phone\ns_comment\n[INFOSEPARATOR]\nEC: 10000', 'children': []}, {'name': 'HASH_JOIN', 'timing': 6.1e-05, 'cardinality': 5, 'extra_info': 'INNER\nn_regionkey = r_regionkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 4\n\n[INFOSEPARATOR]\nEC: 5\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 1.4e-05, 'cardinality': 25, 'extra_info': 'nation\n[INFOSEPARATOR]\nn_nationkey\nn_regionkey\nn_name\n[INFOSEPARATOR]\nEC: 25', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 3.1e-05, 'cardinality': 1, 'extra_info': "region\n[INFOSEPARATOR]\nr_regionkey\n[INFOSEPARATOR]\nFilters: r_name='EUROPE' AND r_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1", 'children': []}]}]}]}, {'name': 'HASH_JOIN', 'timing': 0.002103, 'cardinality': 642, 'extra_info': 'RIGHT\np_partkey IS NOT DISTINCT FROM p_partkey\n\n[INFOSEPARATOR]\nEC: 400000\n', 'children': [{'name': 'PROJECTION', 'timing': 6e-06, 'cardinality': 460, 'extra_info': 'min(ps_supplycost)\np_partkey\n', 'children': [{'name': 'PROJECTION', 'timing': 4.5e-05, 'cardinality': 460, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n#1\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.007298, 'cardinality': 460, 'extra_info': '#0\nmin(#1)', 'children': [{'name': 'PROJECTION', 'timing': 1e-05, 'cardinality': 642, 'extra_info': 'p_partkey\nps_supplycost\n', 'children': [{'name': 'PROJECTION', 'timing': 0.000171, 'cardinality': 642, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n__internal_compress_integral_usmallint(#1, 1)\n#2\n__internal_compress_integral_usmallint(#3, 1)\n__internal_compress_integral_utinyint(#4, 0)\n__internal_compress_integral_utinyint(#5, 0)\n__internal_compress_integral_utinyint(#6, 0)\n__internal_compress_integral_utinyint(#7, 0)\n#8\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.013219, 'cardinality': 642, 'extra_info': 'INNER\nps_partkey = p_partkey\n\n[INFOSEPARATOR]\nEC: 800000\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.012348, 'cardinality': 158960, 'extra_info': 'INNER\nn_regionkey = r_regionkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 4\n\n[INFOSEPARATOR]\nEC: 800000\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.018502, 'cardinality': 800000, 'extra_info': 'INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 800000\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.025608, 'cardinality': 800000, 'extra_info': 'INNER\nps_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 800000\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.002848, 'cardinality': 800000, 'extra_info': 'partsupp\n[INFOSEPARATOR]\nps_partkey\nps_suppkey\nps_supplycost\n[INFOSEPARATOR]\nEC: 800000', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 7.5e-05, 'cardinality': 10000, 'extra_info': 'supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\n[INFOSEPARATOR]\nEC: 10000', 'children': []}]}, {'name': 'SEQ_SCAN ', 'timing': 4.5e-05, 'cardinality': 25, 'extra_info': 'nation\n[INFOSEPARATOR]\nn_nationkey\nn_regionkey\n[INFOSEPARATOR]\nEC: 25', 'children': []}]}, {'name': 'SEQ_SCAN ', 'timing': 4.3e-05, 'cardinality': 1, 'extra_info': "region\n[INFOSEPARATOR]\nr_regionkey\n[INFOSEPARATOR]\nFilters: r_name='EUROPE' AND r_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1", 'children': []}]}, {'name': 'DELIM_SCAN', 'timing': 0.0, 'cardinality': 0, 'extra_info': '', 'children': []}]}]}]}]}]}]}, {'name': 'DUMMY_SCAN', 'timing': 0.0, 'cardinality': 0, 'extra_info': '', 'children': []}]}, {'name': 'HASH_GROUP_BY', 'timing': 0.010445, 'cardinality': 460, 'extra_info': '#0', 'children': []}]}]}]}]}]}]}]}]}]}]}
X {'RESULT_COLLECTOR0': 3.7e-05, 'LIMIT1': 0.000262, 'PROJECTION2': 7.9e-05, 'ORDER_BY3': 0.000825, 'PROJECTION4': 0.000142, 'PROJECTION5': 1.1e-05, 'PROJECTION6': 1.9e-05, 'FILTER7': 0.000406, 'RIGHT_DELIM_JOIN8': 0.019082, 'HASH_JOIN9': 0.001094, 'HASH_JOIN10': 0.011183, 'SEQ_SCAN 11': 0.003973, 'FILTER12': 0.001323, 'SEQ_SCAN 13': 0.020616, 'HASH_JOIN14': 0.000205, 'SEQ_SCAN 15': 0.0013, 'HASH_JOIN16': 6.1e-05, 'SEQ_SCAN 17': 1.4e-05, 'SEQ_SCAN 18': 3.1e-05, 'HASH_JOIN19': 0.002103, 'PROJECTION20': 6e-06, 'PROJECTION21': 4.5e-05, 'HASH_GROUP_BY22': 0.007298, 'PROJECTION23': 1e-05, 'PROJECTION24': 0.000171, 'HASH_JOIN25': 0.013219, 'HASH_JOIN26': 0.012348, 'HASH_JOIN27': 0.018502, 'HASH_JOIN28': 0.025608, 'SEQ_SCAN 29': 0.002848, 'SEQ_SCAN 30': 7.5e-05, 'SEQ_SCAN 31': 4.5e-05, 'SEQ_SCAN 32': 4.3e-05, 'DELIM_SCAN33': 0.0, 'DUMMY_SCAN34': 0.0, 'HASH_GROUP_BY35': 0.010445}
compressed filter_log_size: 10857
compressed filter_log_buffer_size: 3149
compressed limit_offset_size: 4192
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 37988
compressed perfect_full_scan_ht_log_buffer_size: 31252
compressed perfect_probe_ht_log_size: 2127454
compressed perfect_probe_ht_log_buffer_size: 2096581
compressed row_group_log_size: 27639
compressed row_group_log_buffer_size: 12964
compressed scatter_log_size: 11128
compressed scatter_log_buffer_size: 5064
compressed scatter_sel_log_size: 74912
compressed scatter_sel_log_buffer_size: 65304
compressed gather_log_size: 4048
compressed gather_log_buffer_size: 0
compressed combine_log_size: 18659
compressed combine_log_buffer_size: 11684
compressed finalize_states_log_size: 7354
compressed finalize_states_log_buffer_size: 1142
compressed join_gather_log_size: 25230
compressed join_gather_log_buffer_size: 11868
compressed reorder_log_size: 6982
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 4048
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 4048
compressed nlj_log_buffer_size: 0
compressed total_size: 2364539
compressed total_buffer_size: 2239008
compressed total_element_size: 125531

Clear Lineage

**** output size:  100
LINEAGE_5_FILTER_19
LINEAGE_5_FILTER_28
LINEAGE_5_HASH_GROUP_BY_11
LINEAGE_5_HASH_GROUP_BY_16
LINEAGE_5_HASH_JOIN_15
LINEAGE_5_HASH_JOIN_2
LINEAGE_5_HASH_JOIN_20
LINEAGE_5_HASH_JOIN_24
LINEAGE_5_HASH_JOIN_25
LINEAGE_5_HASH_JOIN_26
LINEAGE_5_HASH_JOIN_4
LINEAGE_5_HASH_JOIN_6
LINEAGE_5_HASH_JOIN_8
LINEAGE_5_LIMIT_34
LINEAGE_5_ORDER_BY_32
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_1
LINEAGE_5_SEQ_SCAN_17
LINEAGE_5_SEQ_SCAN_18
LINEAGE_5_SEQ_SCAN_21
LINEAGE_5_SEQ_SCAN_22
LINEAGE_5_SEQ_SCAN_23
LINEAGE_5_SEQ_SCAN_3
LINEAGE_5_SEQ_SCAN_5
SELECT s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment FROM part, supplier, partsupp, nation, region WHERE p_partkey = ps_partkey AND s_suppkey = ps_suppkey AND p_size = 15 AND p_type LIKE '%BRASS' AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'EUROPE' AND ps_supplycost = ( SELECT min(ps_supplycost) FROM partsupp, supplier, nation, region WHERE p_partkey = ps_partkey AND s_suppkey = ps_suppkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'EUROPE' ) ORDER BY s_acctbal DESC, n_name, s_name, p_partkey LIMIT 100;
   query_id  ...                                               plan
0         5  ...  {"name": "LIMIT", "opid": "34", "children": [{...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               SELECT s_acctbal, s_name, n_name, p_partkey, p...
size_bytes_max                                                2364539
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "LIMIT", "opid": "34", "children": [{...
Name: 0, dtype: object
{"name": "LIMIT", "opid": "34", "children": [{"name": "PROJECTION", "opid": "33", "children": [{"name": "ORDER_BY", "opid": "32", "children": [{"name": "PROJECTION", "opid": "31", "children": [{"name": "PROJECTION", "opid": "30", "children": [{"name": "PROJECTION", "opid": "29", "children": [{"name": "FILTER", "opid": "28", "children": [{"name": "RIGHT_DELIM_JOIN", "opid": "27", "children": [{"name": "HASH_GROUP_BY", "opid": "16", "children": [],"table": "","extra": "#0"},{"name": "HASH_JOIN", "opid": "15", "children": [{"name": "PROJECTION", "opid": "13", "children": [{"name": "PROJECTION", "opid": "12", "children": [{"name": "HASH_GROUP_BY", "opid": "11", "children": [{"name": "PROJECTION", "opid": "10", "children": [{"name": "PROJECTION", "opid": "9", "children": [{"name": "HASH_JOIN", "opid": "8", "children": [{"name": "HASH_JOIN", "opid": "6", "children": [{"name": "HASH_JOIN", "opid": "4", "children": [{"name": "HASH_JOIN", "opid": "2", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "partsupp","extra": "partsupp\n[INFOSEPARATOR]\nps_partkey\nps_suppkey\nps_supplycost\n[INFOSEPARATOR]\nEC: 800000"},{"name": "SEQ_SCAN ", "opid": "1", "children": [],"table": "supplier","extra": "supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\n[INFOSEPARATOR]\nEC: 10000"}],"table": "","extra": "INNER\nps_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 800000\n"},{"name": "SEQ_SCAN ", "opid": "3", "children": [],"table": "nation","extra": "nation\n[INFOSEPARATOR]\nn_nationkey\nn_regionkey\n[INFOSEPARATOR]\nEC: 25"}],"table": "","extra": "INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 800000\n"},{"name": "SEQ_SCAN ", "opid": "5", "children": [],"table": "region","extra": "region\n[INFOSEPARATOR]\nr_regionkey\n[INFOSEPARATOR]\nFilters: r_name='EUROPE' AND r_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1"}],"table": "","extra": "INNER\nn_regionkey = r_regionkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 4\n\n[INFOSEPARATOR]\nEC: 800000\n"},{"name": "DELIM_SCAN", "opid": "7", "children": [],"table": "","extra": ""}],"table": "","extra": "INNER\nps_partkey = p_partkey\n\n[INFOSEPARATOR]\nEC: 800000\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n__internal_compress_integral_usmallint(#1, 1)\n#2\n__internal_compress_integral_usmallint(#3, 1)\n__internal_compress_integral_utinyint(#4, 0)\n__internal_compress_integral_utinyint(#5, 0)\n__internal_compress_integral_utinyint(#6, 0)\n__internal_compress_integral_utinyint(#7, 0)\n#8\n"}],"table": "","extra": "p_partkey\nps_supplycost\n"}],"table": "","extra": "#0\nmin(#1)"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n#1\n"}],"table": "","extra": "min(ps_supplycost)\np_partkey\n"},{"name": "DUMMY_SCAN", "opid": "14", "children": [],"table": "","extra": ""}],"table": "","extra": "RIGHT\np_partkey IS NOT DISTINCT FROM p_partkey\n\n[INFOSEPARATOR]\nEC: 400000\n"},{"name": "HASH_JOIN", "opid": "26", "children": [{"name": "HASH_JOIN", "opid": "20", "children": [{"name": "SEQ_SCAN ", "opid": "17", "children": [],"table": "partsupp","extra": "partsupp\n[INFOSEPARATOR]\nps_partkey\nps_suppkey\nps_supplycost\n[INFOSEPARATOR]\nEC: 800000"},{"name": "FILTER", "opid": "19", "children": [{"name": "SEQ_SCAN ", "opid": "18", "children": [],"table": "part","extra": "part\n[INFOSEPARATOR]\np_partkey\np_type\np_mfgr\n[INFOSEPARATOR]\nFilters: p_size=15 AND p_size IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 800"}],"table": "","extra": "suffix(p_type, 'BRASS')\n[INFOSEPARATOR]\nEC: 800"}],"table": "","extra": "INNER\nps_partkey = p_partkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 3377\n"},{"name": "HASH_JOIN", "opid": "25", "children": [{"name": "SEQ_SCAN ", "opid": "21", "children": [],"table": "supplier","extra": "supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\ns_acctbal\ns_name\ns_address\ns_phone\ns_comment\n[INFOSEPARATOR]\nEC: 10000"},{"name": "HASH_JOIN", "opid": "24", "children": [{"name": "SEQ_SCAN ", "opid": "22", "children": [],"table": "nation","extra": "nation\n[INFOSEPARATOR]\nn_nationkey\nn_regionkey\nn_name\n[INFOSEPARATOR]\nEC: 25"},{"name": "SEQ_SCAN ", "opid": "23", "children": [],"table": "region","extra": "region\n[INFOSEPARATOR]\nr_regionkey\n[INFOSEPARATOR]\nFilters: r_name='EUROPE' AND r_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1"}],"table": "","extra": "INNER\nn_regionkey = r_regionkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 4\n\n[INFOSEPARATOR]\nEC: 5\n"}],"table": "","extra": "INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 2000\n"}],"table": "","extra": "INNER\nps_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 587\n"}],"table": "","extra": "RIGHT\np_partkey IS NOT DISTINCT FROM p_partkey\n\n[INFOSEPARATOR]\nEC: 400000\n"}],"table": "","extra": "(ps_supplycost = SUBQUERY)\n[INFOSEPARATOR]\nEC: 400000"}],"table": "","extra": "#0\n#2\n#4\n#6\n#8\n#9\n#10\n#11\n#12\n#13\n"}],"table": "","extra": "s_acctbal\ns_name\nn_name\np_partkey\np_mfgr\ns_address\ns_phone\ns_comment\n"}],"table": "","extra": "#0\n#1\n__internal_compress_string_hugeint(#2)\n__internal_compress_integral_uinteger(#3, 1)\n__internal_compress_string_hugeint(#4)\n#5\n__internal_compress_string_hugeint(#6)\n#7\n"}],"table": "","extra": "ORDERS:\nsupplier.s_acctbal DESC\nnation.n_name ASC\nsupplier.s_name ASC\npart.p_partkey ASC"}],"table": "","extra": "#0\n#1\n__internal_decompress_string(#2)\n__internal_decompress_integral_bigint(#3, 1)\n__internal_decompress_string(#4)\n#5\n__internal_decompress_string(#6)\n#7\n"}],"table": "","extra": ""}
%%%%%%%%%%%%%%%% Running Query #  3  threads:  16
SELECT l_orderkey, sum(l_extendedprice * (1 - l_discount)) AS revenue, o_orderdate, o_shippriority FROM customer, orders, lineitem WHERE c_mktsegment = 'BUILDING' AND c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate < CAST('1995-03-15' AS date) AND l_shipdate > CAST('1995-03-15' AS date) GROUP BY l_orderkey, o_orderdate, o_shippriority ORDER BY revenue DESC, o_orderdate LIMIT 10;
Run:  None SELECT l_orderkey, sum(l_extendedprice * (1 - l_discount)) AS revenue, o_orderdate, o_shippriority FROM customer, orders, lineitem WHERE c_mktsegment = 'BUILDING' AND c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate < CAST('1995-03-15' AS date) AND l_shipdate > CAST('1995-03-15' AS date) GROUP BY l_orderkey, o_orderdate, o_shippriority ORDER BY revenue DESC, o_orderdate LIMIT 10;
Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                                                          
│           LIMIT           │                                                          
└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          
│         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│__internal_decompress_integ│                                                          
│     ral_bigint(#0, 1)     │                                                          
│             #1            │                                                          
│             #2            │                                                          
│__internal_decompress_integ│                                                          
│     ral_integer(#3, 0)    │                                                          
└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          
│          ORDER_BY         │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│          ORDERS:          │                                                          
│       sum((lineitem       │                                                          
│.l_extendedprice * (1 ...  │                                                          
│    .l_discount))) DESC    │                                                          
│   orders.o_orderdate ASC  │                                                          
└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          
│         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│__internal_compress_integra│                                                          
│     l_uinteger(#0, 1)     │                                                          
│             #1            │                                                          
│             #2            │                                                          
│__internal_compress_integra│                                                          
│     l_utinyint(#3, 0)     │                                                          
└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          
│         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│         l_orderkey        │                                                          
│          revenue          │                                                          
│        o_orderdate        │                                                          
│       o_shippriority      │                                                          
└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          
│         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│__internal_decompress_integ│                                                          
│     ral_bigint(#0, 1)     │                                                          
│             #1            │                                                          
│__internal_decompress_integ│                                                          
│     ral_integer(#2, 0)    │                                                          
│             #3            │                                                          
└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          
│       HASH_GROUP_BY       │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│             #0            │                                                          
│             #1            │                                                          
│             #2            │                                                          
│          sum(#3)          │                                                          
└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          
│         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│         l_orderkey        │                                                          
│        o_orderdate        │                                                          
│       o_shippriority      │                                                          
│ (l_extendedprice * (1.00 -│                                                          
│        l_discount))       │                                                          
└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          
│         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│__internal_compress_integra│                                                          
│     l_uinteger(#0, 1)     │                                                          
│             #1            │                                                          
│             #2            │                                                          
│__internal_compress_integra│                                                          
│     l_uinteger(#3, 1)     │                                                          
│             #4            │                                                          
│__internal_compress_integra│                                                          
│     l_utinyint(#5, 0)     │                                                          
└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          
│         HASH_JOIN         │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│           INNER           │                                                          
│  l_orderkey = o_orderkey  ├──────────────┐                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                           
│         EC: 28949         │              │                                           
└─────────────┬─────────────┘              │                                                                        
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             
│         SEQ_SCAN          ││         HASH_JOIN         │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│          lineitem         ││           INNER           │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   o_custkey = c_custkey   │                             
│         l_orderkey        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│      l_extendedprice      ││        Build Min: 1       │                             
│         l_discount        ││     Build Max: 149999     ├──────────────┐              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              
│ Filters: l_shipdate>'1995 ││         EC: 36179         │              │              
│-03-15'::DATE AND l_sh...  ││                           │              │              
│         IS NOT NULL       ││                           │              │              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │              │              
│        EC: 1200243        ││                           │              │              
└───────────────────────────┘└─────────────┬─────────────┘              │                                           
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
                             │         SEQ_SCAN          ││           FILTER          │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                             │           orders          ││   (c_custkey <= 149999)   │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                             │         o_custkey         ││         EC: 30000         │
                             │         o_orderkey        ││                           │
                             │        o_orderdate        ││                           │
                             │       o_shippriority      ││                           │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │
                             │ Filters: o_orderdate<'1995││                           │
                             │     -03-15'::DATE AND     ││                           │
                             │   o_orderdate IS NOT NULL ││                           │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │
                             │         EC: 300000        ││                           │
                             └───────────────────────────┘└─────────────┬─────────────┘                             
                                                          ┌─────────────┴─────────────┐
                                                          │         SEQ_SCAN          │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │          customer         │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │         c_custkey         │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │   Filters: c_mktsegment=  │
                                                          │'BUILDING' AND c_mktse...  │
                                                          │          NOT NULL         │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │         EC: 30000         │
                                                          └───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

compressed filter_log_size: 3954
compressed filter_log_buffer_size: 0
compressed limit_offset_size: 3264
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 102760
compressed perfect_full_scan_ht_log_buffer_size: 99256
compressed perfect_probe_ht_log_size: 483094
compressed perfect_probe_ht_log_buffer_size: 466901
compressed row_group_log_size: 1012825
compressed row_group_log_buffer_size: 956586
compressed scatter_log_size: 112897
compressed scatter_log_buffer_size: 107473
compressed scatter_sel_log_size: 906891
compressed scatter_sel_log_buffer_size: 892369
compressed gather_log_size: 3120
compressed gather_log_buffer_size: 0
compressed combine_log_size: 19887
compressed combine_log_buffer_size: 14804
compressed finalize_states_log_size: 6238
compressed finalize_states_log_buffer_size: 1966
compressed join_gather_log_size: 348644
compressed join_gather_log_buffer_size: 285841
compressed reorder_log_size: 23059
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 3120
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 3120
compressed nlj_log_buffer_size: 0
compressed total_size: 3032873
compressed total_buffer_size: 2825196
compressed total_element_size: 207677

Avg Time in sec:  0.06754452455788851  output size:  10
   l_orderkey      revenue o_orderdate  o_shippriority
0     2456423  406181.0111  1995-03-05               0
1     3459808  405838.6989  1995-03-04               0
2      492164  390324.0610  1995-02-19               0
3     1188320  384537.9359  1995-03-09               0
4     2435712  378673.0558  1995-02-26               0
5     4878020  378376.7952  1995-03-12               0
6     5521732  375153.9215  1995-03-13               0
7     2628192  373133.3094  1995-02-22               0
8      993600  371407.4595  1995-03-05               0
9     2300070  367371.1452  1995-03-13               0
{'name': 'Query', 'result': 0.055722, 'timing': 0.055722, 'cardinality': 0, 'extra-info': "SELECT l_orderkey, sum(l_extendedprice * (1 - l_discount)) AS revenue, o_orderdate, o_shippriority FROM customer, orders, lineitem WHERE c_mktsegment = 'BUILDING' AND c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate < CAST('1995-03-15' AS date) AND l_shipdate > CAST('1995-03-15' AS date) GROUP BY l_orderkey, o_orderdate, o_shippriority ORDER BY revenue DESC, o_orderdate LIMIT 10;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 7e-06, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'LIMIT', 'timing': 0.00024, 'cardinality': 10, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 0.000107, 'cardinality': 11620, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n#1\n#2\n__internal_decompress_integral_integer(#3, 0)\n', 'children': [{'name': 'ORDER_BY', 'timing': 0.001447, 'cardinality': 11620, 'extra_info': 'ORDERS:\nsum((lineitem.l_extendedprice * (1 - lineitem.l_discount))) DESC\norders.o_orderdate ASC', 'children': [{'name': 'PROJECTION', 'timing': 5.1e-05, 'cardinality': 11620, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n#1\n#2\n__internal_compress_integral_utinyint(#3, 0)\n', 'children': [{'name': 'PROJECTION', 'timing': 1e-05, 'cardinality': 11620, 'extra_info': 'l_orderkey\nrevenue\no_orderdate\no_shippriority\n', 'children': [{'name': 'PROJECTION', 'timing': 8.4e-05, 'cardinality': 11620, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n#1\n__internal_decompress_integral_integer(#2, 0)\n#3\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.018124, 'cardinality': 11620, 'extra_info': '#0\n#1\n#2\nsum(#3)', 'children': [{'name': 'PROJECTION', 'timing': 0.000375, 'cardinality': 30519, 'extra_info': 'l_orderkey\no_orderdate\no_shippriority\n(l_extendedprice * (1.00 - l_discount))\n', 'children': [{'name': 'PROJECTION', 'timing': 0.000396, 'cardinality': 30519, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n#1\n#2\n__internal_compress_integral_uinteger(#3, 1)\n#4\n__internal_compress_integral_utinyint(#5, 0)\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.18313, 'cardinality': 30519, 'extra_info': 'INNER\nl_orderkey = o_orderkey\n\n[INFOSEPARATOR]\nEC: 28949\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.07603, 'cardinality': 3241776, 'extra_info': "lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nFilters: l_shipdate>'1995-03-15'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243", 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.025692, 'cardinality': 147126, 'extra_info': 'INNER\no_custkey = c_custkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 149999\n\n[INFOSEPARATOR]\nEC: 36179\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.032372, 'cardinality': 727305, 'extra_info': "orders\n[INFOSEPARATOR]\no_custkey\no_orderkey\no_orderdate\no_shippriority\n[INFOSEPARATOR]\nFilters: o_orderdate<'1995-03-15'::DATE AND o_orderdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 300000", 'children': []}, {'name': 'FILTER', 'timing': 0.000332, 'cardinality': 30142, 'extra_info': '(c_custkey <= 149999)\n[INFOSEPARATOR]\nEC: 30000', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.00485, 'cardinality': 30142, 'extra_info': "customer\n[INFOSEPARATOR]\nc_custkey\n[INFOSEPARATOR]\nFilters: c_mktsegment='BUILDING' AND c_mktsegment IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 30000", 'children': []}]}]}]}]}]}]}]}]}]}]}]}]}]}]}
X {'RESULT_COLLECTOR0': 7e-06, 'LIMIT1': 0.00024, 'PROJECTION2': 0.000107, 'ORDER_BY3': 0.001447, 'PROJECTION4': 5.1e-05, 'PROJECTION5': 1e-05, 'PROJECTION6': 8.4e-05, 'HASH_GROUP_BY7': 0.018124, 'PROJECTION8': 0.000375, 'PROJECTION9': 0.000396, 'HASH_JOIN10': 0.18313, 'SEQ_SCAN 11': 0.07603, 'HASH_JOIN12': 0.025692, 'SEQ_SCAN 13': 0.032372, 'FILTER14': 0.000332, 'SEQ_SCAN 15': 0.00485}
**** output size:  10
LINEAGE_5_FILTER_3
LINEAGE_5_HASH_GROUP_BY_8
LINEAGE_5_HASH_JOIN_4
LINEAGE_5_HASH_JOIN_5
LINEAGE_5_LIMIT_14
LINEAGE_5_ORDER_BY_12
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_1
LINEAGE_5_SEQ_SCAN_2
SELECT l_orderkey, sum(l_extendedprice * (1 - l_discount)) AS revenue, o_orderdate, o_shippriority FROM customer, orders, lineitem WHERE c_mktsegment = 'BUILDING' AND c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate < CAST('1995-03-15' AS date) AND l_shipdate > CAST('1995-03-15' AS date) GROUP BY l_orderkey, o_orderdate, o_shippriority ORDER BY revenue DESC, o_orderdate LIMIT 10;
   query_id  ...                                               plan
0         5  ...  {"name": "LIMIT", "opid": "14", "children": [{...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               SELECT l_orderkey, sum(l_extendedprice * (1 - ...
size_bytes_max                                                3032873
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "LIMIT", "opid": "14", "children": [{...
Name: 0, dtype: object
{"name": "LIMIT", "opid": "14", "children": [{"name": "PROJECTION", "opid": "13", "children": [{"name": "ORDER_BY", "opid": "12", "children": [{"name": "PROJECTION", "opid": "11", "children": [{"name": "PROJECTION", "opid": "10", "children": [{"name": "PROJECTION", "opid": "9", "children": [{"name": "HASH_GROUP_BY", "opid": "8", "children": [{"name": "PROJECTION", "opid": "7", "children": [{"name": "PROJECTION", "opid": "6", "children": [{"name": "HASH_JOIN", "opid": "5", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nFilters: l_shipdate>'1995-03-15'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243"},{"name": "HASH_JOIN", "opid": "4", "children": [{"name": "SEQ_SCAN ", "opid": "1", "children": [],"table": "orders","extra": "orders\n[INFOSEPARATOR]\no_custkey\no_orderkey\no_orderdate\no_shippriority\n[INFOSEPARATOR]\nFilters: o_orderdate<'1995-03-15'::DATE AND o_orderdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 300000"},{"name": "FILTER", "opid": "3", "children": [{"name": "SEQ_SCAN ", "opid": "2", "children": [],"table": "customer","extra": "customer\n[INFOSEPARATOR]\nc_custkey\n[INFOSEPARATOR]\nFilters: c_mktsegment='BUILDING' AND c_mktsegment IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 30000"}],"table": "","extra": "(c_custkey <= 149999)\n[INFOSEPARATOR]\nEC: 30000"}],"table": "","extra": "INNER\no_custkey = c_custkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 149999\n\n[INFOSEPARATOR]\nEC: 36179\n"}],"table": "","extra": "INNER\nl_orderkey = o_orderkey\n\n[INFOSEPARATOR]\nEC: 28949\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n#1\n#2\n__internal_compress_integral_uinteger(#3, 1)\n#4\n__internal_compress_integral_utinyint(#5, 0)\n"}],"table": "","extra": "l_orderkey\no_orderdate\no_shippriority\n(l_extendedprice * (1.00 - l_discount))\n"}],"table": "","extra": "#0\n#1\n#2\nsum(#3)"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n#1\n__internal_decompress_integral_integer(#2, 0)\n#3\n"}],"table": "","extra": "l_orderkey\nrevenue\no_orderdate\no_shippriority\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n#1\n#2\n__internal_compress_integral_utinyint(#3, 0)\n"}],"table": "","extra": "ORDERS:\nsum((lineitem.l_extendedprice * (1 - lineitem.l_discount))) DESC\norders.o_orderdate ASC"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n#1\n#2\n__internal_decompress_integral_integer(#3, 0)\n"}],"table": "","extra": ""}
Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│__internal_decompress_strin│                                                                                       
│           g(#0)           │                                                                                       
│             #1            │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│          ORDER_BY         │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│          ORDERS:          │                                                                                       
│ orders.o_orderpriority ASC│                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│__internal_compress_string_│                                                                                       
│        hugeint(#0)        │                                                                                       
│             #1            │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│__internal_decompress_strin│                                                                                       
│           g(#0)           │                                                                                       
│             #1            │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│       HASH_GROUP_BY       │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│             #0            │                                                                                       
│        count_star()       │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│      o_orderpriority      │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│__internal_compress_integra│                                                                                       
│     l_uinteger(#0, 1)     │                                                                                       
│__internal_compress_string_│                                                                                       
│        hugeint(#1)        │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│      RIGHT_DELIM_JOIN     │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│         RIGHT_SEMI        │                                                                                       
│ o_orderkey IS NOT DISTINCT├──────────────┐                                                                        
│       FROM o_orderkey     │              │                                                                        
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                                                        
│        EC: 1200243        │              │                                                                        
└─────────────┬─────────────┘              │                                                                                                     
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                          
│         SEQ_SCAN          ││         HASH_JOIN         │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│           orders          ││         RIGHT_SEMI        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││ o_orderkey IS NOT DISTINCT│                                                          
│         o_orderkey        ││       FROM o_orderkey     │                                                          
│      o_orderpriority      ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││        EC: 1200243        ├───────────────────────────────────────────┐              
│Filters: o_orderdate>='1993││                           │                                           │              
│     -07-01'::DATE AND     ││                           │                                           │              
│ o_orderdate<'1993-10-...  ││                           │                                           │              
│   o_orderdate IS NOT NULL ││                           │                                           │              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                           │              
│         EC: 300000        ││                           │                                           │              
└───────────────────────────┘└─────────────┬─────────────┘                                           │                                           
                             ┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐
                             │         PROJECTION        │                             │         DUMMY_SCAN        │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │                           │
                             │         o_orderkey        │                             │                           │
                             └─────────────┬─────────────┘                             └───────────────────────────┘                             
                             ┌─────────────┴─────────────┐                                                          
                             │         HASH_JOIN         │                                                          
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                             │           INNER           │                                                          
                             │  l_orderkey = o_orderkey  ├──────────────┐                                           
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                           
                             │        EC: 1200243        │              │                                           
                             └─────────────┬─────────────┘              │                                                                        
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             
                             │           FILTER          ││         DELIM_SCAN        │                             
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                             
                             │      (l_commitdate <      ││                           │                             
                             │       l_receiptdate)      ││                           │                             
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                             
                             │        EC: 6001215        ││                           │                             
                             └─────────────┬─────────────┘└───────────────────────────┘                                                          
                             ┌─────────────┴─────────────┐                                                          
                             │         SEQ_SCAN          │                                                          
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                             │          lineitem         │                                                          
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                             │         l_orderkey        │                                                          
                             │        l_commitdate       │                                                          
                             │       l_receiptdate       │                                                          
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                             │        EC: 6001215        │                                                          
                             └───────────────────────────┘                                                                                       

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

compressed filter_log_size: 786201
compressed filter_log_buffer_size: 750165
compressed limit_offset_size: 3456
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 3456
compressed perfect_full_scan_ht_log_buffer_size: 0
compressed perfect_probe_ht_log_size: 3456
compressed perfect_probe_ht_log_buffer_size: 0
compressed row_group_log_size: 171476
compressed row_group_log_buffer_size: 133120
compressed scatter_log_size: 442884
compressed scatter_log_buffer_size: 434256
compressed scatter_sel_log_size: 498781
compressed scatter_sel_log_buffer_size: 484981
compressed gather_log_size: 3456
compressed gather_log_buffer_size: 0
compressed combine_log_size: 17987
compressed combine_log_buffer_size: 12336
compressed finalize_states_log_size: 14363
compressed finalize_states_log_buffer_size: 9242
compressed join_gather_log_size: 2124439
compressed join_gather_log_buffer_size: 2001429
compressed reorder_log_size: 5424
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 3456
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 3456
compressed nlj_log_buffer_size: 0
compressed total_size: 4082291
compressed total_buffer_size: 3825529
compressed total_element_size: 256762

Clear Lineage

%%%%%%%%%%%%%%%% Running Query #  4  threads:  16
SELECT o_orderpriority, count(*) AS order_count FROM orders WHERE o_orderdate >= CAST('1993-07-01' AS date) AND o_orderdate < CAST('1993-10-01' AS date) AND EXISTS ( SELECT * FROM lineitem WHERE l_orderkey = o_orderkey AND l_commitdate < l_receiptdate) GROUP BY o_orderpriority ORDER BY o_orderpriority;
Run:  None SELECT o_orderpriority, count(*) AS order_count FROM orders WHERE o_orderdate >= CAST('1993-07-01' AS date) AND o_orderdate < CAST('1993-10-01' AS date) AND EXISTS ( SELECT * FROM lineitem WHERE l_orderkey = o_orderkey AND l_commitdate < l_receiptdate) GROUP BY o_orderpriority ORDER BY o_orderpriority;
Avg Time in sec:  0.06596192717552185  output size:  5
   o_orderpriority  order_count
0         1-URGENT        10594
1           2-HIGH        10476
2         3-MEDIUM        10410
3  4-NOT SPECIFIED        10556
4            5-LOW        10487
{'name': 'Query', 'result': 0.055038, 'timing': 0.055038, 'cardinality': 0, 'extra-info': "SELECT o_orderpriority, count(*) AS order_count FROM orders WHERE o_orderdate >= CAST('1993-07-01' AS date) AND o_orderdate < CAST('1993-10-01' AS date) AND EXISTS ( SELECT * FROM lineitem WHERE l_orderkey = o_orderkey AND l_commitdate < l_receiptdate) GROUP BY o_orderpriority ORDER BY o_orderpriority;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 1.5e-05, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 1.1e-05, 'cardinality': 5, 'extra_info': '__internal_decompress_string(#0)\n#1\n', 'children': [{'name': 'ORDER_BY', 'timing': 8.7e-05, 'cardinality': 5, 'extra_info': 'ORDERS:\norders.o_orderpriority ASC', 'children': [{'name': 'PROJECTION', 'timing': 9e-06, 'cardinality': 5, 'extra_info': '__internal_compress_string_hugeint(#0)\n#1\n', 'children': [{'name': 'PROJECTION', 'timing': 1.6e-05, 'cardinality': 5, 'extra_info': '__internal_decompress_string(#0)\n#1\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.004125, 'cardinality': 5, 'extra_info': '#0\ncount_star()', 'children': [{'name': 'PROJECTION', 'timing': 1e-05, 'cardinality': 52523, 'extra_info': 'o_orderpriority\n', 'children': [{'name': 'PROJECTION', 'timing': 0.000823, 'cardinality': 52523, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n__internal_compress_string_hugeint(#1)\n', 'children': [{'name': 'RIGHT_DELIM_JOIN', 'timing': 0.066597, 'cardinality': 0, 'extra_info': 'RIGHT_SEMI\no_orderkey IS NOT DISTINCT FROM o_orderkey\n\n[INFOSEPARATOR]\nEC: 1200243\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.106645, 'cardinality': 57218, 'extra_info': "orders\n[INFOSEPARATOR]\no_orderkey\no_orderpriority\n[INFOSEPARATOR]\nFilters: o_orderdate>='1993-07-01'::DATE AND o_orderdate<'1993-10-01'::DATE AND o_orderdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 300000", 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.023442, 'cardinality': 52523, 'extra_info': 'RIGHT_SEMI\no_orderkey IS NOT DISTINCT FROM o_orderkey\n\n[INFOSEPARATOR]\nEC: 1200243\n', 'children': [{'name': 'PROJECTION', 'timing': 0.000133, 'cardinality': 144869, 'extra_info': 'o_orderkey\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.16652, 'cardinality': 144869, 'extra_info': 'INNER\nl_orderkey = o_orderkey\n\n[INFOSEPARATOR]\nEC: 1200243\n', 'children': [{'name': 'FILTER', 'timing': 0.049, 'cardinality': 3793296, 'extra_info': '(l_commitdate < l_receiptdate)\n[INFOSEPARATOR]\nEC: 6001215', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.017197, 'cardinality': 6001215, 'extra_info': 'lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_commitdate\nl_receiptdate\n[INFOSEPARATOR]\nEC: 6001215', 'children': []}]}, {'name': 'DELIM_SCAN', 'timing': 0.0, 'cardinality': 0, 'extra_info': '', 'children': []}]}]}, {'name': 'DUMMY_SCAN', 'timing': 0.0, 'cardinality': 0, 'extra_info': '', 'children': []}]}, {'name': 'HASH_GROUP_BY', 'timing': 0.00828, 'cardinality': 57218, 'extra_info': '#0', 'children': []}]}]}]}]}]}]}]}]}]}]}
X {'RESULT_COLLECTOR0': 1.5e-05, 'PROJECTION1': 1.1e-05, 'ORDER_BY2': 8.7e-05, 'PROJECTION3': 9e-06, 'PROJECTION4': 1.6e-05, 'HASH_GROUP_BY5': 0.004125, 'PROJECTION6': 1e-05, 'PROJECTION7': 0.000823, 'RIGHT_DELIM_JOIN8': 0.066597, 'SEQ_SCAN 9': 0.106645, 'HASH_JOIN10': 0.023442, 'PROJECTION11': 0.000133, 'HASH_JOIN12': 0.16652, 'FILTER13': 0.049, 'SEQ_SCAN 14': 0.017197, 'DELIM_SCAN15': 0.0, 'DUMMY_SCAN16': 0.0, 'HASH_GROUP_BY17': 0.00828}
**** output size:  5
LINEAGE_5_FILTER_1
LINEAGE_5_HASH_GROUP_BY_12
LINEAGE_5_HASH_GROUP_BY_7
LINEAGE_5_HASH_JOIN_3
LINEAGE_5_HASH_JOIN_6
LINEAGE_5_ORDER_BY_15
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_8
SELECT o_orderpriority, count(*) AS order_count FROM orders WHERE o_orderdate >= CAST('1993-07-01' AS date) AND o_orderdate < CAST('1993-10-01' AS date) AND EXISTS ( SELECT * FROM lineitem WHERE l_orderkey = o_orderkey AND l_commitdate < l_receiptdate) GROUP BY o_orderpriority ORDER BY o_orderpriority;
   query_id  ...                                               plan
0         5  ...  {"name": "PROJECTION", "opid": "16", "children...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               SELECT o_orderpriority, count(*) AS order_coun...
size_bytes_max                                                4082291
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "PROJECTION", "opid": "16", "children...
Name: 0, dtype: object
{"name": "PROJECTION", "opid": "16", "children": [{"name": "ORDER_BY", "opid": "15", "children": [{"name": "PROJECTION", "opid": "14", "children": [{"name": "PROJECTION", "opid": "13", "children": [{"name": "HASH_GROUP_BY", "opid": "12", "children": [{"name": "PROJECTION", "opid": "11", "children": [{"name": "PROJECTION", "opid": "10", "children": [{"name": "RIGHT_DELIM_JOIN", "opid": "9", "children": [{"name": "HASH_GROUP_BY", "opid": "7", "children": [],"table": "","extra": "#0"},{"name": "HASH_JOIN", "opid": "6", "children": [{"name": "PROJECTION", "opid": "4", "children": [{"name": "HASH_JOIN", "opid": "3", "children": [{"name": "FILTER", "opid": "1", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_commitdate\nl_receiptdate\n[INFOSEPARATOR]\nEC: 6001215"}],"table": "","extra": "(l_commitdate < l_receiptdate)\n[INFOSEPARATOR]\nEC: 6001215"},{"name": "DELIM_SCAN", "opid": "2", "children": [],"table": "","extra": ""}],"table": "","extra": "INNER\nl_orderkey = o_orderkey\n\n[INFOSEPARATOR]\nEC: 1200243\n"}],"table": "","extra": "o_orderkey\n"},{"name": "DUMMY_SCAN", "opid": "5", "children": [],"table": "","extra": ""}],"table": "","extra": "RIGHT_SEMI\no_orderkey IS NOT DISTINCT FROM o_orderkey\n\n[INFOSEPARATOR]\nEC: 1200243\n"},{"name": "SEQ_SCAN ", "opid": "8", "children": [],"table": "orders","extra": "orders\n[INFOSEPARATOR]\no_orderkey\no_orderpriority\n[INFOSEPARATOR]\nFilters: o_orderdate>='1993-07-01'::DATE AND o_orderdate<'1993-10-01'::DATE AND o_orderdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 300000"}],"table": "","extra": "RIGHT_SEMI\no_orderkey IS NOT DISTINCT FROM o_orderkey\n\n[INFOSEPARATOR]\nEC: 1200243\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n__internal_compress_string_hugeint(#1)\n"}],"table": "","extra": "o_orderpriority\n"}],"table": "","extra": "#0\ncount_star()"}],"table": "","extra": "__internal_decompress_string(#0)\n#1\n"}],"table": "","extra": "__internal_compress_string_hugeint(#0)\n#1\n"}],"table": "","extra": "ORDERS:\norders.o_orderpriority ASC"}],"table": "","extra": "__internal_decompress_string(#0)\n#1\n"}
%%%%%%%%%%%%%%%% Running Query #  5  threads:  16
SELECT n_name, sum(l_extendedprice * (1 - l_discount)) AS revenue FROM customer, orders, lineitem, supplier, nation, region WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND l_suppkey = s_suppkey AND c_nationkey = s_nationkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'ASIA' AND o_orderdate >= CAST('1994-01-01' AS date) AND o_orderdate < CAST('1995-01-01' AS date) GROUP BY n_name ORDER BY revenue DESC;
Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│__internal_decompress_strin│                                                                                                                                                 
│           g(#0)           │                                                                                                                                                 
│             #1            │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│          ORDER_BY         │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│          ORDERS:          │                                                                                                                                                 
│       sum((lineitem       │                                                                                                                                                 
│.l_extendedprice * (1 ...  │                                                                                                                                                 
│    .l_discount))) DESC    │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│__internal_compress_string_│                                                                                                                                                 
│        hugeint(#0)        │                                                                                                                                                 
│             #1            │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│__internal_decompress_strin│                                                                                                                                                 
│           g(#0)           │                                                                                                                                                 
│             #1            │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│       HASH_GROUP_BY       │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│             #0            │                                                                                                                                                 
│          sum(#1)          │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│           n_name          │                                                                                                                                                 
│ (l_extendedprice * (1.00 -│                                                                                                                                                 
│        l_discount))       │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│__internal_compress_integra│                                                                                                                                                 
│     l_uinteger(#0, 1)     │                                                                                                                                                 
│__internal_compress_integra│                                                                                                                                                 
│     l_usmallint(#1, 1)    │                                                                                                                                                 
│             #2            │                                                                                                                                                 
│             #3            │                                                                                                                                                 
│__internal_compress_integra│                                                                                                                                                 
│     l_uinteger(#4, 1)     │                                                                                                                                                 
│__internal_compress_integra│                                                                                                                                                 
│     l_utinyint(#5, 0)     │                                                                                                                                                 
│__internal_compress_string_│                                                                                                                                                 
│        hugeint(#6)        │                                                                                                                                                 
│__internal_compress_integra│                                                                                                                                                 
│     l_usmallint(#7, 1)    │                                                                                                                                                 
│__internal_compress_integra│                                                                                                                                                 
│     l_utinyint(#8, 0)     │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         HASH_JOIN         │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│           INNER           │                                                                                                                                                 
│ n_nationkey = s_nationkey ├──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐              
│   l_suppkey = s_suppkey   │                                                                                                                                  │              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                  │              
│         EC: 143512        │                                                                                                                                  │              
└─────────────┬─────────────┘                                                                                                                                  │                                           
┌─────────────┴─────────────┐                                                                                                                    ┌─────────────┴─────────────┐
│         HASH_JOIN         │                                                                                                                    │         SEQ_SCAN          │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│           INNER           │                                                                                                                    │          supplier         │
│  l_orderkey = o_orderkey  │                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐                                                                                                     │         s_suppkey         │
│         EC: 144747        │              │                                                                                                     │        s_nationkey        │
│                           │              │                                                                                                     │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│                           │              │                                                                                                     │         EC: 10000         │
└─────────────┬─────────────┘              │                                                                                                     └───────────────────────────┘                             
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                                                    
│         SEQ_SCAN          ││         HASH_JOIN         │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│          lineitem         ││           INNER           │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   o_custkey = c_custkey   │                                                                                                                    
│         l_orderkey        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│         l_suppkey         ││        Build Min: 1       ├──────────────┐                                                                                                     
│      l_extendedprice      ││     Build Max: 149999     │              │                                                                                                     
│         l_discount        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                                                                                     
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││         EC: 36179         │              │                                                                                                     
│        EC: 6001215        ││                           │              │                                                                                                     
└───────────────────────────┘└─────────────┬─────────────┘              │                                                                                                                                  
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                       
                             │         SEQ_SCAN          ││         PROJECTION        │                                                                                       
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
                             │           orders          ││             #0            │                                                                                       
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││             #1            │                                                                                       
                             │         o_custkey         ││             #3            │                                                                                       
                             │         o_orderkey        ││                           │                                                                                       
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                                                                       
                             │Filters: o_orderdate>='1994││                           │                                                                                       
                             │     -01-01'::DATE AND     ││                           │                                                                                       
                             │ o_orderdate<'1995-01-...  ││                           │                                                                                       
                             │   o_orderdate IS NOT NULL ││                           │                                                                                       
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                                                                       
                             │         EC: 300000        ││                           │                                                                                       
                             └───────────────────────────┘└─────────────┬─────────────┘                                                                                                                    
                                                          ┌─────────────┴─────────────┐                                                                                       
                                                          │           FILTER          │                                                                                       
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
                                                          │   (c_custkey <= 149999)   │                                                                                       
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
                                                          │         EC: 30000         │                                                                                       
                                                          └─────────────┬─────────────┘                                                                                                                    
                                                          ┌─────────────┴─────────────┐                                                                                       
                                                          │         HASH_JOIN         │                                                                                       
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
                                                          │           INNER           │                                                                                       
                                                          │ c_nationkey = n_nationkey │                                                                                       
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐                                                                        
                                                          │        Build Min: 0       │              │                                                                        
                                                          │       Build Max: 24       │              │                                                                        
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                                                        
                                                          │         EC: 30000         │              │                                                                        
                                                          └─────────────┬─────────────┘              │                                                                                                     
                                                          ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                          
                                                          │         SEQ_SCAN          ││         HASH_JOIN         │                                                          
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                          │          customer         ││           INNER           │                                                          
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││ n_regionkey = r_regionkey │                                                          
                                                          │         c_custkey         ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐                                           
                                                          │        c_nationkey        ││           EC: 25          │              │                                           
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │              │                                           
                                                          │         EC: 150000        ││                           │              │                                           
                                                          └───────────────────────────┘└─────────────┬─────────────┘              │                                                                        
                                                                                       ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             
                                                                                       │         SEQ_SCAN          ││         SEQ_SCAN          │                             
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                                                                                       │           nation          ││           region          │                             
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                                                                                       │        n_nationkey        ││        r_regionkey        │                             
                                                                                       │        n_regionkey        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                                                                                       │           n_name          ││ Filters: r_name='ASIA' AND│                             
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││     r_name IS NOT NULL    │                             
                                                                                       │           EC: 25          ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                                                                                       │                           ││           EC: 1           │                             
                                                                                       └───────────────────────────┘└───────────────────────────┘                                                          

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

compressed filter_log_size: 4072
compressed filter_log_buffer_size: 0
compressed limit_offset_size: 3248
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 108580
compressed perfect_full_scan_ht_log_buffer_size: 104564
compressed perfect_probe_ht_log_size: 235401
compressed perfect_probe_ht_log_buffer_size: 217545
compressed row_group_log_size: 228583
compressed row_group_log_buffer_size: 188793
compressed scatter_log_size: 32797
compressed scatter_log_buffer_size: 27204
compressed scatter_sel_log_size: 431017
compressed scatter_sel_log_buffer_size: 419550
compressed gather_log_size: 3248
compressed gather_log_buffer_size: 0
compressed combine_log_size: 5499
compressed combine_log_buffer_size: 1280
compressed finalize_states_log_size: 3864
compressed finalize_states_log_buffer_size: 40
compressed join_gather_log_size: 1210153
compressed join_gather_log_buffer_size: 1090939
compressed reorder_log_size: 5192
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 3248
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 3248
compressed nlj_log_buffer_size: 0
compressed total_size: 2278150
compressed total_buffer_size: 2049915
compressed total_element_size: 228235

Run:  None SELECT n_name, sum(l_extendedprice * (1 - l_discount)) AS revenue FROM customer, orders, lineitem, supplier, nation, region WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND l_suppkey = s_suppkey AND c_nationkey = s_nationkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'ASIA' AND o_orderdate >= CAST('1994-01-01' AS date) AND o_orderdate < CAST('1995-01-01' AS date) GROUP BY n_name ORDER BY revenue DESC;
Avg Time in sec:  0.06494625192135572  output size:  5
      n_name       revenue
0  INDONESIA  5.550204e+07
1    VIETNAM  5.529509e+07
2      CHINA  5.372449e+07
3      INDIA  5.203551e+07
4      JAPAN  4.541018e+07
{'name': 'Query', 'result': 0.054597, 'timing': 0.054597, 'cardinality': 0, 'extra-info': "SELECT n_name, sum(l_extendedprice * (1 - l_discount)) AS revenue FROM customer, orders, lineitem, supplier, nation, region WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND l_suppkey = s_suppkey AND c_nationkey = s_nationkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'ASIA' AND o_orderdate >= CAST('1994-01-01' AS date) AND o_orderdate < CAST('1995-01-01' AS date) GROUP BY n_name ORDER BY revenue DESC;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 1e-05, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 8e-06, 'cardinality': 5, 'extra_info': '__internal_decompress_string(#0)\n#1\n', 'children': [{'name': 'ORDER_BY', 'timing': 0.000126, 'cardinality': 5, 'extra_info': 'ORDERS:\nsum((lineitem.l_extendedprice * (1 - lineitem.l_discount))) DESC', 'children': [{'name': 'PROJECTION', 'timing': 5e-06, 'cardinality': 5, 'extra_info': '__internal_compress_string_hugeint(#0)\n#1\n', 'children': [{'name': 'PROJECTION', 'timing': 1.7e-05, 'cardinality': 5, 'extra_info': '__internal_decompress_string(#0)\n#1\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.017702, 'cardinality': 5, 'extra_info': '#0\nsum(#1)', 'children': [{'name': 'PROJECTION', 'timing': 0.000641, 'cardinality': 7243, 'extra_info': 'n_name\n(l_extendedprice * (1.00 - l_discount))\n', 'children': [{'name': 'PROJECTION', 'timing': 0.001788, 'cardinality': 7243, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n__internal_compress_integral_usmallint(#1, 1)\n#2\n#3\n__internal_compress_integral_uinteger(#4, 1)\n__internal_compress_integral_utinyint(#5, 0)\n__internal_compress_string_hugeint(#6)\n__internal_compress_integral_usmallint(#7, 1)\n__internal_compress_integral_utinyint(#8, 0)\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.039957, 'cardinality': 7243, 'extra_info': 'INNER\nn_nationkey = s_nationkey\nl_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nEC: 143512\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.282428, 'cardinality': 184082, 'extra_info': 'INNER\nl_orderkey = o_orderkey\n\n[INFOSEPARATOR]\nEC: 144747\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.027818, 'cardinality': 6001215, 'extra_info': 'lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_suppkey\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nEC: 6001215', 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.033025, 'cardinality': 46008, 'extra_info': 'INNER\no_custkey = c_custkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 149999\n\n[INFOSEPARATOR]\nEC: 36179\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.049052, 'cardinality': 227597, 'extra_info': "orders\n[INFOSEPARATOR]\no_custkey\no_orderkey\n[INFOSEPARATOR]\nFilters: o_orderdate>='1994-01-01'::DATE AND o_orderdate<'1995-01-01'::DATE AND o_orderdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 300000", 'children': []}, {'name': 'PROJECTION', 'timing': 3e-05, 'cardinality': 30183, 'extra_info': '#0\n#1\n#3\n', 'children': [{'name': 'FILTER', 'timing': 0.000334, 'cardinality': 30183, 'extra_info': '(c_custkey <= 149999)\n[INFOSEPARATOR]\nEC: 30000', 'children': [{'name': 'HASH_JOIN', 'timing': 0.001605, 'cardinality': 30183, 'extra_info': 'INNER\nc_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 30000\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.000264, 'cardinality': 150000, 'extra_info': 'customer\n[INFOSEPARATOR]\nc_custkey\nc_nationkey\n[INFOSEPARATOR]\nEC: 150000', 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.000107, 'cardinality': 5, 'extra_info': 'INNER\nn_regionkey = r_regionkey\n\n[INFOSEPARATOR]\nEC: 25\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 2.8e-05, 'cardinality': 25, 'extra_info': 'nation\n[INFOSEPARATOR]\nn_nationkey\nn_regionkey\nn_name\n[INFOSEPARATOR]\nEC: 25', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 4.1e-05, 'cardinality': 1, 'extra_info': "region\n[INFOSEPARATOR]\nr_regionkey\n[INFOSEPARATOR]\nFilters: r_name='ASIA' AND r_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1", 'children': []}]}]}]}]}]}]}, {'name': 'SEQ_SCAN ', 'timing': 4.7e-05, 'cardinality': 10000, 'extra_info': 'supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\n[INFOSEPARATOR]\nEC: 10000', 'children': []}]}]}]}]}]}]}]}]}]}]}
X {'RESULT_COLLECTOR0': 1e-05, 'PROJECTION1': 8e-06, 'ORDER_BY2': 0.000126, 'PROJECTION3': 5e-06, 'PROJECTION4': 1.7e-05, 'HASH_GROUP_BY5': 0.017702, 'PROJECTION6': 0.000641, 'PROJECTION7': 0.001788, 'HASH_JOIN8': 0.039957, 'HASH_JOIN9': 0.282428, 'SEQ_SCAN 10': 0.027818, 'HASH_JOIN11': 0.033025, 'SEQ_SCAN 12': 0.049052, 'PROJECTION13': 3e-05, 'FILTER14': 0.000334, 'HASH_JOIN15': 0.001605, 'SEQ_SCAN 16': 0.000264, 'HASH_JOIN17': 0.000107, 'SEQ_SCAN 18': 2.8e-05, 'SEQ_SCAN 19': 4.1e-05, 'SEQ_SCAN 20': 4.7e-05}
**** output size:  5
LINEAGE_5_FILTER_7
LINEAGE_5_HASH_GROUP_BY_15
LINEAGE_5_HASH_JOIN_10
LINEAGE_5_HASH_JOIN_12
LINEAGE_5_HASH_JOIN_5
LINEAGE_5_HASH_JOIN_6
LINEAGE_5_HASH_JOIN_9
LINEAGE_5_ORDER_BY_18
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_1
LINEAGE_5_SEQ_SCAN_11
LINEAGE_5_SEQ_SCAN_2
LINEAGE_5_SEQ_SCAN_3
LINEAGE_5_SEQ_SCAN_4
SELECT n_name, sum(l_extendedprice * (1 - l_discount)) AS revenue FROM customer, orders, lineitem, supplier, nation, region WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND l_suppkey = s_suppkey AND c_nationkey = s_nationkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'ASIA' AND o_orderdate >= CAST('1994-01-01' AS date) AND o_orderdate < CAST('1995-01-01' AS date) GROUP BY n_name ORDER BY revenue DESC;
   query_id  ...                                               plan
0         5  ...  {"name": "PROJECTION", "opid": "19", "children...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               SELECT n_name, sum(l_extendedprice * (1 - l_di...
size_bytes_max                                                2278150
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "PROJECTION", "opid": "19", "children...
Name: 0, dtype: object
{"name": "PROJECTION", "opid": "19", "children": [{"name": "ORDER_BY", "opid": "18", "children": [{"name": "PROJECTION", "opid": "17", "children": [{"name": "PROJECTION", "opid": "16", "children": [{"name": "HASH_GROUP_BY", "opid": "15", "children": [{"name": "PROJECTION", "opid": "14", "children": [{"name": "PROJECTION", "opid": "13", "children": [{"name": "HASH_JOIN", "opid": "12", "children": [{"name": "HASH_JOIN", "opid": "10", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_suppkey\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nEC: 6001215"},{"name": "HASH_JOIN", "opid": "9", "children": [{"name": "SEQ_SCAN ", "opid": "1", "children": [],"table": "orders","extra": "orders\n[INFOSEPARATOR]\no_custkey\no_orderkey\n[INFOSEPARATOR]\nFilters: o_orderdate>='1994-01-01'::DATE AND o_orderdate<'1995-01-01'::DATE AND o_orderdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 300000"},{"name": "PROJECTION", "opid": "8", "children": [{"name": "FILTER", "opid": "7", "children": [{"name": "HASH_JOIN", "opid": "6", "children": [{"name": "SEQ_SCAN ", "opid": "2", "children": [],"table": "customer","extra": "customer\n[INFOSEPARATOR]\nc_custkey\nc_nationkey\n[INFOSEPARATOR]\nEC: 150000"},{"name": "HASH_JOIN", "opid": "5", "children": [{"name": "SEQ_SCAN ", "opid": "3", "children": [],"table": "nation","extra": "nation\n[INFOSEPARATOR]\nn_nationkey\nn_regionkey\nn_name\n[INFOSEPARATOR]\nEC: 25"},{"name": "SEQ_SCAN ", "opid": "4", "children": [],"table": "region","extra": "region\n[INFOSEPARATOR]\nr_regionkey\n[INFOSEPARATOR]\nFilters: r_name='ASIA' AND r_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1"}],"table": "","extra": "INNER\nn_regionkey = r_regionkey\n\n[INFOSEPARATOR]\nEC: 25\n"}],"table": "","extra": "INNER\nc_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 30000\n"}],"table": "","extra": "(c_custkey <= 149999)\n[INFOSEPARATOR]\nEC: 30000"}],"table": "","extra": "#0\n#1\n#3\n"}],"table": "","extra": "INNER\no_custkey = c_custkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 149999\n\n[INFOSEPARATOR]\nEC: 36179\n"}],"table": "","extra": "INNER\nl_orderkey = o_orderkey\n\n[INFOSEPARATOR]\nEC: 144747\n"},{"name": "SEQ_SCAN ", "opid": "11", "children": [],"table": "supplier","extra": "supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\n[INFOSEPARATOR]\nEC: 10000"}],"table": "","extra": "INNER\nn_nationkey = s_nationkey\nl_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nEC: 143512\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n__internal_compress_integral_usmallint(#1, 1)\n#2\n#3\n__internal_compress_integral_uinteger(#4, 1)\n__internal_compress_integral_utinyint(#5, 0)\n__internal_compress_string_hugeint(#6)\n__internal_compress_integral_usmallint(#7, 1)\n__internal_compress_integral_utinyint(#8, 0)\n"}],"table": "","extra": "n_name\n(l_extendedprice * (1.00 - l_discount))\n"}],"table": "","extra": "#0\nsum(#1)"}],"table": "","extra": "__internal_decompress_string(#0)\n#1\n"}],"table": "","extra": "__internal_compress_string_hugeint(#0)\n#1\n"}],"table": "","extra": "ORDERS:\nsum((lineitem.l_extendedprice * (1 - lineitem.l_discount))) DESC"}],"table": "","extra": "__internal_decompress_string(#0)\n#1\n"}
Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐
│    UNGROUPED_AGGREGATE    │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│    sum_no_overflow(#0)    │
└─────────────┬─────────────┘                             
┌─────────────┴─────────────┐
│         PROJECTION        │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│     (l_extendedprice *    │
│         l_discount)       │
└─────────────┬─────────────┘                             
┌─────────────┴─────────────┐
│         SEQ_SCAN          │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│          lineitem         │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│         l_discount        │
│      l_extendedprice      │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│ Filters: l_shipdate>='1994│
│-01-01'::DATE AND l_sh...  │
│  <'1995-01-01'::DATE AND  │
│   l_shipdate IS NOT NULL  │
│    l_discount>=0.05 AND   │
│ l_discount<=0.07 AND ...  │
│         IS NOT NULL       │
│    l_quantity<24.00 AND   │
│   l_quantity IS NOT NULL  │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│        EC: 1200243        │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

compressed filter_log_size: 1008
compressed filter_log_buffer_size: 0
compressed limit_offset_size: 1008
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 1008
compressed perfect_full_scan_ht_log_buffer_size: 0
compressed perfect_probe_ht_log_size: 1008
compressed perfect_probe_ht_log_buffer_size: 0
compressed row_group_log_size: 401709
compressed row_group_log_buffer_size: 357694
compressed scatter_log_size: 1008
compressed scatter_log_buffer_size: 0
compressed scatter_sel_log_size: 1008
compressed scatter_sel_log_buffer_size: 0
compressed gather_log_size: 1008
compressed gather_log_buffer_size: 0
compressed combine_log_size: 1008
compressed combine_log_buffer_size: 0
compressed finalize_states_log_size: 1008
compressed finalize_states_log_buffer_size: 0
compressed join_gather_log_size: 1008
compressed join_gather_log_buffer_size: 0
compressed reorder_log_size: 1512
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 1008
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 1008
compressed nlj_log_buffer_size: 0
compressed total_size: 415317
compressed total_buffer_size: 357694
compressed total_element_size: 57623

Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│__internal_decompress_strin│                                                                                                                                                 
│           g(#0)           │                                                                                                                                                 
│__internal_decompress_strin│                                                                                                                                                 
│           g(#1)           │                                                                                                                                                 
│__internal_decompress_integ│                                                                                                                                                 
│    ral_bigint(#2, 1992)   │                                                                                                                                                 
│             #3            │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│          ORDER_BY         │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│          ORDERS:          │                                                                                                                                                 
│  shipping.supp_nation ASC │                                                                                                                                                 
│  shipping.cust_nation ASC │                                                                                                                                                 
│    shipping.l_year ASC    │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│__internal_compress_string_│                                                                                                                                                 
│        hugeint(#0)        │                                                                                                                                                 
│__internal_compress_string_│                                                                                                                                                 
│        hugeint(#1)        │                                                                                                                                                 
│__internal_compress_integra│                                                                                                                                                 
│    l_utinyint(#2, 1992)   │                                                                                                                                                 
│             #3            │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│__internal_decompress_strin│                                                                                                                                                 
│           g(#0)           │                                                                                                                                                 
│__internal_decompress_strin│                                                                                                                                                 
│           g(#1)           │                                                                                                                                                 
│__internal_decompress_integ│                                                                                                                                                 
│    ral_bigint(#2, 1992)   │                                                                                                                                                 
│             #3            │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│       HASH_GROUP_BY       │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│             #0            │                                                                                                                                                 
│             #1            │                                                                                                                                                 
│             #2            │                                                                                                                                                 
│          sum(#3)          │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│        supp_nation        │                                                                                                                                                 
│        cust_nation        │                                                                                                                                                 
│           l_year          │                                                                                                                                                 
│           volume          │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│__internal_compress_string_│                                                                                                                                                 
│        hugeint(#0)        │                                                                                                                                                 
│__internal_compress_string_│                                                                                                                                                 
│        hugeint(#1)        │                                                                                                                                                 
│__internal_compress_integra│                                                                                                                                                 
│    l_utinyint(#2, 1992)   │                                                                                                                                                 
│             #3            │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│        supp_nation        │                                                                                                                                                 
│        cust_nation        │                                                                                                                                                 
│      year(l_shipdate)     │                                                                                                                                                 
│           volume          │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│             #2            │                                                                                                                                                 
│             #3            │                                                                                                                                                 
│             #4            │                                                                                                                                                 
│             #6            │                                                                                                                                                 
│             #8            │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│           FILTER          │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│ (((n_name = 'FRANCE') AND │                                                                                                                                                 
│ (n_name = 'GERMANY')) OR (│                                                                                                                                                 
│ (n_name = 'GERMANY') AND  │                                                                                                                                                 
│   (n_name = 'FRANCE')))   │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│         EC: 717564        │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         HASH_JOIN         │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│           INNER           │                                                                                                                                                 
│   l_suppkey = s_suppkey   │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├─────────────────────────────────────────────────────────────────────────────────────────────────────┐                                           
│        Build Min: 1       │                                                                                                     │                                           
│      Build Max: 10000     │                                                                                                     │                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                     │                                           
│         EC: 717564        │                                                                                                     │                                           
└─────────────┬─────────────┘                                                                                                     │                                                                        
┌─────────────┴─────────────┐                                                                                       ┌─────────────┴─────────────┐                             
│         HASH_JOIN         │                                                                                       │         HASH_JOIN         │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│           INNER           │                                                                                       │           INNER           │                             
│  l_orderkey = o_orderkey  │                                                                                       │ s_nationkey = n_nationkey │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐                                                                        │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐              
│         EC: 723735        │              │                                                                        │        Build Min: 0       │              │              
│                           │              │                                                                        │       Build Max: 24       │              │              
│                           │              │                                                                        │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              
│                           │              │                                                                        │         EC: 10000         │              │              
└─────────────┬─────────────┘              │                                                                        └─────────────┬─────────────┘              │                                           
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
│         SEQ_SCAN          ││         HASH_JOIN         │                                                          │         SEQ_SCAN          ││         SEQ_SCAN          │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│          lineitem         ││           INNER           │                                                          │          supplier         ││           nation          │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   o_custkey = c_custkey   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│         l_suppkey         ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │         s_suppkey         ││        n_nationkey        │
│         l_orderkey        ││        Build Min: 1       │                                                          │        s_nationkey        ││           n_name          │
│         l_shipdate        ││     Build Max: 149999     │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│      l_extendedprice      ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │         EC: 10000         ││           EC: 25          │
│         l_discount        ││         EC: 904486        ├──────────────┐                                           │                           ││                           │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │              │                                           │                           ││                           │
│ Filters: l_shipdate>='1995││                           │              │                                           │                           ││                           │
│-01-01'::DATE AND l_sh...  ││                           │              │                                           │                           ││                           │
│  <='1996-12-31'::DATE AND ││                           │              │                                           │                           ││                           │
│   l_shipdate IS NOT NULL  ││                           │              │                                           │                           ││                           │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │              │                                           │                           ││                           │
│        EC: 1200243        ││                           │              │                                           │                           ││                           │
└───────────────────────────┘└─────────────┬─────────────┘              │                                           └───────────────────────────┘└───────────────────────────┘                             
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                       
                             │         SEQ_SCAN          ││         HASH_JOIN         │                                                                                       
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
                             │           orders          ││           INNER           │                                                                                       
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││ c_nationkey = n_nationkey │                                                                                       
                             │         o_orderkey        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐                                                                        
                             │         o_custkey         ││         EC: 150000        │              │                                                                        
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │              │                                                                        
                             │        EC: 1500000        ││                           │              │                                                                        
                             └───────────────────────────┘└─────────────┬─────────────┘              │                                                                                                     
                                                          ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                          
                                                          │         SEQ_SCAN          ││         SEQ_SCAN          │                                                          
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                          │          customer         ││           nation          │                                                          
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                          │         c_custkey         ││        n_nationkey        │                                                          
                                                          │        c_nationkey        ││           n_name          │                                                          
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                          │ Filters: c_custkey<=149999││           EC: 25          │                                                          
                                                          │  AND c_custkey IS NOT NULL││                           │                                                          
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                                          
                                                          │         EC: 150000        ││                           │                                                          
                                                          └───────────────────────────┘└───────────────────────────┘                                                                                       

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

%%%%%%%%%%%%%%%% Running Query #  6  threads:  16
SELECT sum(l_extendedprice * l_discount) AS revenue FROM lineitem WHERE l_shipdate >= CAST('1994-01-01' AS date) AND l_shipdate < CAST('1995-01-01' AS date) AND l_discount BETWEEN 0.05 AND 0.07 AND l_quantity < 24;
Run:  None SELECT sum(l_extendedprice * l_discount) AS revenue FROM lineitem WHERE l_shipdate >= CAST('1994-01-01' AS date) AND l_shipdate < CAST('1995-01-01' AS date) AND l_discount BETWEEN 0.05 AND 0.07 AND l_quantity < 24;
Avg Time in sec:  0.01618889207020402  output size:  1
        revenue
0  1.231411e+08
{'name': 'Query', 'result': 0.01461, 'timing': 0.01461, 'cardinality': 0, 'extra-info': "SELECT sum(l_extendedprice * l_discount) AS revenue FROM lineitem WHERE l_shipdate >= CAST('1994-01-01' AS date) AND l_shipdate < CAST('1995-01-01' AS date) AND l_discount BETWEEN 0.05 AND 0.07 AND l_quantity < 24;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 6e-06, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'UNGROUPED_AGGREGATE', 'timing': 0.002544, 'cardinality': 1, 'extra_info': 'sum_no_overflow(#0)', 'children': [{'name': 'PROJECTION', 'timing': 0.010798, 'cardinality': 114160, 'extra_info': '(l_extendedprice * l_discount)\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.169625, 'cardinality': 114160, 'extra_info': "lineitem\n[INFOSEPARATOR]\nl_discount\nl_extendedprice\n[INFOSEPARATOR]\nFilters: l_shipdate>='1994-01-01'::DATE AND l_shipdate<'1995-01-01'::DATE AND l_shipdate IS NOT NULL\nl_discount>=0.05 AND l_discount<=0.07 AND l_discount IS NOT NULL\nl_quantity<24.00 AND l_quantity IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243", 'children': []}]}]}]}]}
X {'RESULT_COLLECTOR0': 6e-06, 'UNGROUPED_AGGREGATE1': 0.002544, 'PROJECTION2': 0.010798, 'SEQ_SCAN 3': 0.169625}
**** output size:  1
LINEAGE_5_SEQ_SCAN_0
SELECT sum(l_extendedprice * l_discount) AS revenue FROM lineitem WHERE l_shipdate >= CAST('1994-01-01' AS date) AND l_shipdate < CAST('1995-01-01' AS date) AND l_discount BETWEEN 0.05 AND 0.07 AND l_quantity < 24;
   query_id  ...                                               plan
0         5  ...  {"name": "UNGROUPED_AGGREGATE", "opid": "2", "...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               SELECT sum(l_extendedprice * l_discount) AS re...
size_bytes_max                                                 415317
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "UNGROUPED_AGGREGATE", "opid": "2", "...
Name: 0, dtype: object
{"name": "UNGROUPED_AGGREGATE", "opid": "2", "children": [{"name": "PROJECTION", "opid": "1", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_discount\nl_extendedprice\n[INFOSEPARATOR]\nFilters: l_shipdate>='1994-01-01'::DATE AND l_shipdate<'1995-01-01'::DATE AND l_shipdate IS NOT NULL\nl_discount>=0.05 AND l_discount<=0.07 AND l_discount IS NOT NULL\nl_quantity<24.00 AND l_quantity IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243"}],"table": "","extra": "(l_extendedprice * l_discount)\n"}],"table": "","extra": "sum_no_overflow(#0)"}
%%%%%%%%%%%%%%%% Running Query #  7  threads:  16
SELECT supp_nation, cust_nation, l_year, sum(volume) AS revenue FROM ( SELECT n1.n_name AS supp_nation, n2.n_name AS cust_nation, extract(year FROM l_shipdate) AS l_year, l_extendedprice * (1 - l_discount) AS volume FROM supplier, lineitem, orders, customer, nation n1, nation n2 WHERE s_suppkey = l_suppkey AND o_orderkey = l_orderkey AND c_custkey = o_custkey AND s_nationkey = n1.n_nationkey AND c_nationkey = n2.n_nationkey AND ((n1.n_name = 'FRANCE' AND n2.n_name = 'GERMANY') OR (n1.n_name = 'GERMANY' AND n2.n_name = 'FRANCE')) AND l_shipdate BETWEEN CAST('1995-01-01' AS date) AND CAST('1996-12-31' AS date)) AS shipping GROUP BY supp_nation, cust_nation, l_year ORDER BY supp_nation, cust_nation, l_year;
Run:  None SELECT supp_nation, cust_nation, l_year, sum(volume) AS revenue FROM ( SELECT n1.n_name AS supp_nation, n2.n_name AS cust_nation, extract(year FROM l_shipdate) AS l_year, l_extendedprice * (1 - l_discount) AS volume FROM supplier, lineitem, orders, customer, nation n1, nation n2 WHERE s_suppkey = l_suppkey AND o_orderkey = l_orderkey AND c_custkey = o_custkey AND s_nationkey = n1.n_nationkey AND c_nationkey = n2.n_nationkey AND ((n1.n_name = 'FRANCE' AND n2.n_name = 'GERMANY') OR (n1.n_name = 'GERMANY' AND n2.n_name = 'FRANCE')) AND l_shipdate BETWEEN CAST('1995-01-01' AS date) AND CAST('1996-12-31' AS date)) AS shipping GROUP BY supp_nation, cust_nation, l_year ORDER BY supp_nation, cust_nation, l_year;
Avg Time in sec:  0.19186455523595214  output size:  4
  supp_nation cust_nation  l_year       revenue
0      FRANCE     GERMANY    1995  5.463973e+07
1      FRANCE     GERMANY    1996  5.463308e+07
2     GERMANY      FRANCE    1995  5.253175e+07
3     GERMANY      FRANCE    1996  5.252055e+07
{'name': 'Query', 'result': 0.155898, 'timing': 0.155898, 'cardinality': 0, 'extra-info': "SELECT supp_nation, cust_nation, l_year, sum(volume) AS revenue FROM ( SELECT n1.n_name AS supp_nation, n2.n_name AS cust_nation, extract(year FROM l_shipdate) AS l_year, l_extendedprice * (1 - l_discount) AS volume FROM supplier, lineitem, orders, customer, nation n1, nation n2 WHERE s_suppkey = l_suppkey AND o_orderkey = l_orderkey AND c_custkey = o_custkey AND s_nationkey = n1.n_nationkey AND c_nationkey = n2.n_nationkey AND ((n1.n_name = 'FRANCE' AND n2.n_name = 'GERMANY') OR (n1.n_name = 'GERMANY' AND n2.n_name = 'FRANCE')) AND l_shipdate BETWEEN CAST('1995-01-01' AS date) AND CAST('1996-12-31' AS date)) AS shipping GROUP BY supp_nation, cust_nation, l_year ORDER BY supp_nation, cust_nation, l_year;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 1.6e-05, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 1.9e-05, 'cardinality': 4, 'extra_info': '__internal_decompress_string(#0)\n__internal_decompress_string(#1)\n__internal_decompress_integral_bigint(#2, 1992)\n#3\n', 'children': [{'name': 'ORDER_BY', 'timing': 0.000136, 'cardinality': 4, 'extra_info': 'ORDERS:\nshipping.supp_nation ASC\nshipping.cust_nation ASC\nshipping.l_year ASC', 'children': [{'name': 'PROJECTION', 'timing': 1.2e-05, 'cardinality': 4, 'extra_info': '__internal_compress_string_hugeint(#0)\n__internal_compress_string_hugeint(#1)\n__internal_compress_integral_utinyint(#2, 1992)\n#3\n', 'children': [{'name': 'PROJECTION', 'timing': 3.1e-05, 'cardinality': 4, 'extra_info': '__internal_decompress_string(#0)\n__internal_decompress_string(#1)\n__internal_decompress_integral_bigint(#2, 1992)\n#3\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.016046, 'cardinality': 4, 'extra_info': '#0\n#1\n#2\nsum(#3)', 'children': [{'name': 'PROJECTION', 'timing': 2.1e-05, 'cardinality': 5924, 'extra_info': 'supp_nation\ncust_nation\nl_year\nvolume\n', 'children': [{'name': 'PROJECTION', 'timing': 0.000411, 'cardinality': 5924, 'extra_info': '__internal_compress_string_hugeint(#0)\n__internal_compress_string_hugeint(#1)\n__internal_compress_integral_utinyint(#2, 1992)\n#3\n', 'children': [{'name': 'PROJECTION', 'timing': 0.000342, 'cardinality': 5924, 'extra_info': 'supp_nation\ncust_nation\nyear(l_shipdate)\nvolume\n', 'children': [{'name': 'PROJECTION', 'timing': 3.7e-05, 'cardinality': 5924, 'extra_info': '#2\n#3\n#4\n#6\n#8\n', 'children': [{'name': 'FILTER', 'timing': 0.11565, 'cardinality': 5924, 'extra_info': "(((n_name = 'FRANCE') AND (n_name = 'GERMANY')) OR ((n_name = 'GERMANY') AND (n_name = 'FRANCE')))\n[INFOSEPARATOR]\nEC: 717564", 'children': [{'name': 'HASH_JOIN', 'timing': 0.088044, 'cardinality': 1828450, 'extra_info': 'INNER\nl_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 717564\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.605758, 'cardinality': 1828450, 'extra_info': 'INNER\nl_orderkey = o_orderkey\n\n[INFOSEPARATOR]\nEC: 723735\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.08013, 'cardinality': 1828450, 'extra_info': "lineitem\n[INFOSEPARATOR]\nl_suppkey\nl_orderkey\nl_shipdate\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nFilters: l_shipdate>='1995-01-01'::DATE AND l_shipdate<='1996-12-31'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243", 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.081004, 'cardinality': 1500000, 'extra_info': 'INNER\no_custkey = c_custkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 149999\n\n[INFOSEPARATOR]\nEC: 904486\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.007352, 'cardinality': 1500000, 'extra_info': 'orders\n[INFOSEPARATOR]\no_orderkey\no_custkey\n[INFOSEPARATOR]\nEC: 1500000', 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.01035, 'cardinality': 149999, 'extra_info': 'INNER\nc_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nEC: 150000\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.001558, 'cardinality': 149999, 'extra_info': 'customer\n[INFOSEPARATOR]\nc_custkey\nc_nationkey\n[INFOSEPARATOR]\nFilters: c_custkey<=149999 AND c_custkey IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 150000', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 4e-05, 'cardinality': 25, 'extra_info': 'nation\n[INFOSEPARATOR]\nn_nationkey\nn_name\n[INFOSEPARATOR]\nEC: 25', 'children': []}]}]}]}, {'name': 'HASH_JOIN', 'timing': 0.000338, 'cardinality': 10000, 'extra_info': 'INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 10000\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 7.1e-05, 'cardinality': 10000, 'extra_info': 'supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\n[INFOSEPARATOR]\nEC: 10000', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 2.6e-05, 'cardinality': 25, 'extra_info': 'nation\n[INFOSEPARATOR]\nn_nationkey\nn_name\n[INFOSEPARATOR]\nEC: 25', 'children': []}]}]}]}]}]}]}]}]}]}]}]}]}]}]}
compressed filter_log_size: 59082
compressed filter_log_buffer_size: 23696
compressed limit_offset_size: 3888
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 542254
compressed perfect_full_scan_ht_log_buffer_size: 537214
compressed perfect_probe_ht_log_size: 7409382
compressed perfect_probe_ht_log_buffer_size: 7322721
compressed row_group_log_size: 806579
compressed row_group_log_buffer_size: 750855
compressed scatter_log_size: 26802
compressed scatter_log_buffer_size: 20610
compressed scatter_sel_log_size: 8163497
compressed scatter_sel_log_buffer_size: 8147888
compressed gather_log_size: 3888
compressed gather_log_buffer_size: 0
compressed combine_log_size: 5865
compressed combine_log_buffer_size: 1024
compressed finalize_states_log_size: 4496
compressed finalize_states_log_buffer_size: 32
compressed join_gather_log_size: 7710907
compressed join_gather_log_buffer_size: 7576645
compressed reorder_log_size: 6152
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 3888
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 3888
compressed nlj_log_buffer_size: 0
compressed total_size: 24750568
compressed total_buffer_size: 24380685
compressed total_element_size: 369883

Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                                                                                                                                                                                                           
│         PROJECTION        │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│__internal_decompress_integ│                                                                                                                                                                                                           
│    ral_bigint(#0, 1992)   │                                                                                                                                                                                                           
│             #1            │                                                                                                                                                                                                           
└─────────────┬─────────────┘                                                                                                                                                                                                                                        
┌─────────────┴─────────────┐                                                                                                                                                                                                           
│          ORDER_BY         │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│          ORDERS:          │                                                                                                                                                                                                           
│   all_nations.o_year ASC  │                                                                                                                                                                                                           
└─────────────┬─────────────┘                                                                                                                                                                                                                                        
┌─────────────┴─────────────┐                                                                                                                                                                                                           
│         PROJECTION        │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│__internal_compress_integra│                                                                                                                                                                                                           
│    l_utinyint(#0, 1992)   │                                                                                                                                                                                                           
│             #1            │                                                                                                                                                                                                           
└─────────────┬─────────────┘                                                                                                                                                                                                                                        
┌─────────────┴─────────────┐                                                                                                                                                                                                           
│         PROJECTION        │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│           o_year          │                                                                                                                                                                                                           
│         mkt_share         │                                                                                                                                                                                                           
└─────────────┬─────────────┘                                                                                                                                                                                                                                        
┌─────────────┴─────────────┐                                                                                                                                                                                                           
│         PROJECTION        │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│__internal_decompress_integ│                                                                                                                                                                                                           
│    ral_bigint(#0, 1992)   │                                                                                                                                                                                                           
│             #1            │                                                                                                                                                                                                           
│             #2            │                                                                                                                                                                                                           
└─────────────┬─────────────┘                                                                                                                                                                                                                                        
┌─────────────┴─────────────┐                                                                                                                                                                                                           
│   PERFECT_HASH_GROUP_BY   │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│             #0            │                                                                                                                                                                                                           
│          sum(#1)          │                                                                                                                                                                                                           
│          sum(#2)          │                                                                                                                                                                                                           
└─────────────┬─────────────┘                                                                                                                                                                                                                                        
┌─────────────┴─────────────┐                                                                                                                                                                                                           
│         PROJECTION        │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│           o_year          │                                                                                                                                                                                                           
│   CASE  WHEN ((nation =   │                                                                                                                                                                                                           
│'BRAZIL')) THEN (volum...  │                                                                                                                                                                                                           
│         .0000 END         │                                                                                                                                                                                                           
│           volume          │                                                                                                                                                                                                           
└─────────────┬─────────────┘                                                                                                                                                                                                                                        
┌─────────────┴─────────────┐                                                                                                                                                                                                           
│         PROJECTION        │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│__internal_compress_integra│                                                                                                                                                                                                           
│    l_utinyint(#0, 1992)   │                                                                                                                                                                                                           
│             #1            │                                                                                                                                                                                                           
│             #2            │                                                                                                                                                                                                           
└─────────────┬─────────────┘                                                                                                                                                                                                                                        
┌─────────────┴─────────────┐                                                                                                                                                                                                           
│         PROJECTION        │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│     year(o_orderdate)     │                                                                                                                                                                                                           
│           volume          │                                                                                                                                                                                                           
│           nation          │                                                                                                                                                                                                           
└─────────────┬─────────────┘                                                                                                                                                                                                                                        
┌─────────────┴─────────────┐                                                                                                                                                                                                           
│         HASH_JOIN         │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│           INNER           │                                                                                                                                                                                                           
│ s_nationkey = n_nationkey │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐              
│        Build Min: 0       │                                                                                                                                                                                            │              
│       Build Max: 24       │                                                                                                                                                                                            │              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                            │              
│          EC: 508          │                                                                                                                                                                                            │              
└─────────────┬─────────────┘                                                                                                                                                                                            │                                           
┌─────────────┴─────────────┐                                                                                                                                                                              ┌─────────────┴─────────────┐
│         HASH_JOIN         │                                                                                                                                                                              │         SEQ_SCAN          │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│           INNER           │                                                                                                                                                                              │           nation          │
│   s_suppkey = l_suppkey   │                                                                                                                                                                              │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐                                                                                                                                                               │        n_nationkey        │
│        Build Min: 1       │              │                                                                                                                                                               │           n_name          │
│      Build Max: 10000     │              │                                                                                                                                                               │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                                                                                                                                               │           EC: 25          │
│          EC: 508          │              │                                                                                                                                                               │                           │
└─────────────┬─────────────┘              │                                                                                                                                                               └───────────────────────────┘                             
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                                                                                                              
│         SEQ_SCAN          ││         HASH_JOIN         │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│          supplier         ││           INNER           │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││ c_nationkey = n_nationkey │                                                                                                                                                                              
│         s_suppkey         ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├─────────────────────────────────────────────────────────────────────────────────────────────────────┐                                                                        
│        s_nationkey        ││        Build Min: 0       │                                                                                                     │                                                                        
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││       Build Max: 24       │                                                                                                     │                                                                        
│         EC: 10000         ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                     │                                                                        
│                           ││          EC: 512          │                                                                                                     │                                                                        
└───────────────────────────┘└─────────────┬─────────────┘                                                                                                     │                                                                                                     
                             ┌─────────────┴─────────────┐                                                                                       ┌─────────────┴─────────────┐                                                          
                             │         HASH_JOIN         │                                                                                       │         HASH_JOIN         │                                                          
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                             │           INNER           │                                                                                       │           INNER           │                                                          
                             │   c_custkey = o_custkey   │                                                                                       │ n_regionkey = r_regionkey │                                                          
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐                                                                        │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐                                           
                             │        Build Min: 1       │              │                                                                        │        Build Min: 0       │              │                                           
                             │     Build Max: 149999     │              │                                                                        │        Build Max: 4       │              │                                           
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                                                        │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                           
                             │          EC: 2562         │              │                                                                        │           EC: 5           │              │                                           
                             └─────────────┬─────────────┘              │                                                                        └─────────────┬─────────────┘              │                                                                        
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             
                             │         SEQ_SCAN          ││         HASH_JOIN         │                                                          │         SEQ_SCAN          ││         SEQ_SCAN          │                             
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                             │          customer         ││           INNER           │                                                          │           nation          ││           region          │                             
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││  o_orderkey = l_orderkey  │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                             │         c_custkey         ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │        n_nationkey        ││        r_regionkey        │                             
                             │        c_nationkey        ││          EC: 4249         ├──────────────┐                                           │        n_regionkey        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │              │                                           │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││ Filters: r_name='AMERICA' │                             
                             │ Filters: c_custkey<=149999││                           │              │                                           │           EC: 25          ││   AND r_name IS NOT NULL  │                             
                             │  AND c_custkey IS NOT NULL││                           │              │                                           │                           ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │              │                                           │                           ││           EC: 1           │                             
                             │         EC: 150000        ││                           │              │                                           │                           ││                           │                             
                             └───────────────────────────┘└─────────────┬─────────────┘              │                                           └───────────────────────────┘└───────────────────────────┘                                                          
                                                          ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                                                    
                                                          │         SEQ_SCAN          ││         HASH_JOIN         │                                                                                                                    
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
                                                          │           orders          ││           INNER           │                                                                                                                    
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   l_partkey = p_partkey   │                                                                                                                    
                                                          │         o_orderkey        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
                                                          │         o_custkey         ││        Build Min: 1       │                                                                                                                    
                                                          │        o_orderdate        ││     Build Max: 200000     │                                                                                                                    
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐                                                                                                     
                                                          │Filters: o_orderdate>='1995││         EC: 21246         │              │                                                                                                     
                                                          │     -01-01'::DATE AND     ││                           │              │                                                                                                     
                                                          │ o_orderdate<='1996-12...  ││                           │              │                                                                                                     
                                                          │   o_orderdate IS NOT NULL ││                           │              │                                                                                                     
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │              │                                                                                                     
                                                          │         EC: 300000        ││                           │              │                                                                                                     
                                                          └───────────────────────────┘└─────────────┬─────────────┘              │                                                                                                                                  
                                                                                       ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                       
                                                                                       │         SEQ_SCAN          ││         SEQ_SCAN          │                                                                                       
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
                                                                                       │          lineitem         ││            part           │                                                                                       
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
                                                                                       │         l_partkey         ││         p_partkey         │                                                                                       
                                                                                       │         l_suppkey         ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
                                                                                       │         l_orderkey        ││  Filters: p_type='ECONOMY │                                                                                       
                                                                                       │      l_extendedprice      ││ ANODIZED STEEL' AND p...  │                                                                                       
                                                                                       │         l_discount        ││          NOT NULL         │                                                                                       
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
                                                                                       │        EC: 6001215        ││          EC: 1325         │                                                                                       
                                                                                       └───────────────────────────┘└───────────────────────────┘                                                                                                                    

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

X {'RESULT_COLLECTOR0': 1.6e-05, 'PROJECTION1': 1.9e-05, 'ORDER_BY2': 0.000136, 'PROJECTION3': 1.2e-05, 'PROJECTION4': 3.1e-05, 'HASH_GROUP_BY5': 0.016046, 'PROJECTION6': 2.1e-05, 'PROJECTION7': 0.000411, 'PROJECTION8': 0.000342, 'PROJECTION9': 3.7e-05, 'FILTER10': 0.11565, 'HASH_JOIN11': 0.088044, 'HASH_JOIN12': 0.605758, 'SEQ_SCAN 13': 0.08013, 'HASH_JOIN14': 0.081004, 'SEQ_SCAN 15': 0.007352, 'HASH_JOIN16': 0.01035, 'SEQ_SCAN 17': 0.001558, 'SEQ_SCAN 18': 4e-05, 'HASH_JOIN19': 0.000338, 'SEQ_SCAN 20': 7.1e-05, 'SEQ_SCAN 21': 2.6e-05}
**** output size:  4
LINEAGE_5_FILTER_11
LINEAGE_5_HASH_GROUP_BY_16
LINEAGE_5_HASH_JOIN_10
LINEAGE_5_HASH_JOIN_4
LINEAGE_5_HASH_JOIN_5
LINEAGE_5_HASH_JOIN_6
LINEAGE_5_HASH_JOIN_9
LINEAGE_5_ORDER_BY_19
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_1
LINEAGE_5_SEQ_SCAN_2
LINEAGE_5_SEQ_SCAN_3
LINEAGE_5_SEQ_SCAN_7
LINEAGE_5_SEQ_SCAN_8
SELECT supp_nation, cust_nation, l_year, sum(volume) AS revenue FROM ( SELECT n1.n_name AS supp_nation, n2.n_name AS cust_nation, extract(year FROM l_shipdate) AS l_year, l_extendedprice * (1 - l_discount) AS volume FROM supplier, lineitem, orders, customer, nation n1, nation n2 WHERE s_suppkey = l_suppkey AND o_orderkey = l_orderkey AND c_custkey = o_custkey AND s_nationkey = n1.n_nationkey AND c_nationkey = n2.n_nationkey AND ((n1.n_name = 'FRANCE' AND n2.n_name = 'GERMANY') OR (n1.n_name = 'GERMANY' AND n2.n_name = 'FRANCE')) AND l_shipdate BETWEEN CAST('1995-01-01' AS date) AND CAST('1996-12-31' AS date)) AS shipping GROUP BY supp_nation, cust_nation, l_year ORDER BY supp_nation, cust_nation, l_year;
   query_id  ...                                               plan
0         5  ...  {"name": "PROJECTION", "opid": "20", "children...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               SELECT supp_nation, cust_nation, l_year, sum(v...
size_bytes_max                                               24750568
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "PROJECTION", "opid": "20", "children...
Name: 0, dtype: object
{"name": "PROJECTION", "opid": "20", "children": [{"name": "ORDER_BY", "opid": "19", "children": [{"name": "PROJECTION", "opid": "18", "children": [{"name": "PROJECTION", "opid": "17", "children": [{"name": "HASH_GROUP_BY", "opid": "16", "children": [{"name": "PROJECTION", "opid": "15", "children": [{"name": "PROJECTION", "opid": "14", "children": [{"name": "PROJECTION", "opid": "13", "children": [{"name": "PROJECTION", "opid": "12", "children": [{"name": "FILTER", "opid": "11", "children": [{"name": "HASH_JOIN", "opid": "10", "children": [{"name": "HASH_JOIN", "opid": "6", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_suppkey\nl_orderkey\nl_shipdate\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nFilters: l_shipdate>='1995-01-01'::DATE AND l_shipdate<='1996-12-31'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243"},{"name": "HASH_JOIN", "opid": "5", "children": [{"name": "SEQ_SCAN ", "opid": "1", "children": [],"table": "orders","extra": "orders\n[INFOSEPARATOR]\no_orderkey\no_custkey\n[INFOSEPARATOR]\nEC: 1500000"},{"name": "HASH_JOIN", "opid": "4", "children": [{"name": "SEQ_SCAN ", "opid": "2", "children": [],"table": "customer","extra": "customer\n[INFOSEPARATOR]\nc_custkey\nc_nationkey\n[INFOSEPARATOR]\nFilters: c_custkey<=149999 AND c_custkey IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 150000"},{"name": "SEQ_SCAN ", "opid": "3", "children": [],"table": "nation","extra": "nation\n[INFOSEPARATOR]\nn_nationkey\nn_name\n[INFOSEPARATOR]\nEC: 25"}],"table": "","extra": "INNER\nc_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nEC: 150000\n"}],"table": "","extra": "INNER\no_custkey = c_custkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 149999\n\n[INFOSEPARATOR]\nEC: 904486\n"}],"table": "","extra": "INNER\nl_orderkey = o_orderkey\n\n[INFOSEPARATOR]\nEC: 723735\n"},{"name": "HASH_JOIN", "opid": "9", "children": [{"name": "SEQ_SCAN ", "opid": "7", "children": [],"table": "supplier","extra": "supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\n[INFOSEPARATOR]\nEC: 10000"},{"name": "SEQ_SCAN ", "opid": "8", "children": [],"table": "nation","extra": "nation\n[INFOSEPARATOR]\nn_nationkey\nn_name\n[INFOSEPARATOR]\nEC: 25"}],"table": "","extra": "INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 10000\n"}],"table": "","extra": "INNER\nl_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 717564\n"}],"table": "","extra": "(((n_name = 'FRANCE') AND (n_name = 'GERMANY')) OR ((n_name = 'GERMANY') AND (n_name = 'FRANCE')))\n[INFOSEPARATOR]\nEC: 717564"}],"table": "","extra": "#2\n#3\n#4\n#6\n#8\n"}],"table": "","extra": "supp_nation\ncust_nation\nyear(l_shipdate)\nvolume\n"}],"table": "","extra": "__internal_compress_string_hugeint(#0)\n__internal_compress_string_hugeint(#1)\n__internal_compress_integral_utinyint(#2, 1992)\n#3\n"}],"table": "","extra": "supp_nation\ncust_nation\nl_year\nvolume\n"}],"table": "","extra": "#0\n#1\n#2\nsum(#3)"}],"table": "","extra": "__internal_decompress_string(#0)\n__internal_decompress_string(#1)\n__internal_decompress_integral_bigint(#2, 1992)\n#3\n"}],"table": "","extra": "__internal_compress_string_hugeint(#0)\n__internal_compress_string_hugeint(#1)\n__internal_compress_integral_utinyint(#2, 1992)\n#3\n"}],"table": "","extra": "ORDERS:\nshipping.supp_nation ASC\nshipping.cust_nation ASC\nshipping.l_year ASC"}],"table": "","extra": "__internal_decompress_string(#0)\n__internal_decompress_string(#1)\n__internal_decompress_integral_bigint(#2, 1992)\n#3\n"}
%%%%%%%%%%%%%%%% Running Query #  8  threads:  16
SELECT o_year, sum( CASE WHEN nation = 'BRAZIL' THEN volume ELSE 0 END) / sum(volume) AS mkt_share FROM ( SELECT extract(year FROM o_orderdate) AS o_year, l_extendedprice * (1 - l_discount) AS volume, n2.n_name AS nation FROM part, supplier, lineitem, orders, customer, nation n1, nation n2, region WHERE p_partkey = l_partkey AND s_suppkey = l_suppkey AND l_orderkey = o_orderkey AND o_custkey = c_custkey AND c_nationkey = n1.n_nationkey AND n1.n_regionkey = r_regionkey AND r_name = 'AMERICA' AND s_nationkey = n2.n_nationkey AND o_orderdate BETWEEN CAST('1995-01-01' AS date) AND CAST('1996-12-31' AS date) AND p_type = 'ECONOMY ANODIZED STEEL') AS all_nations GROUP BY o_year ORDER BY o_year;
Run:  None SELECT o_year, sum( CASE WHEN nation = 'BRAZIL' THEN volume ELSE 0 END) / sum(volume) AS mkt_share FROM ( SELECT extract(year FROM o_orderdate) AS o_year, l_extendedprice * (1 - l_discount) AS volume, n2.n_name AS nation FROM part, supplier, lineitem, orders, customer, nation n1, nation n2, region WHERE p_partkey = l_partkey AND s_suppkey = l_suppkey AND l_orderkey = o_orderkey AND o_custkey = c_custkey AND c_nationkey = n1.n_nationkey AND n1.n_regionkey = r_regionkey AND r_name = 'AMERICA' AND s_nationkey = n2.n_nationkey AND o_orderdate BETWEEN CAST('1995-01-01' AS date) AND CAST('1996-12-31' AS date) AND p_type = 'ECONOMY ANODIZED STEEL') AS all_nations GROUP BY o_year ORDER BY o_year;
Avg Time in sec:  0.08632451808080077  output size:  2
   o_year  mkt_share
0    1995   0.034436
1    1996   0.041486
{'name': 'Query', 'result': 0.057319, 'timing': 0.057319, 'cardinality': 0, 'extra-info': "SELECT o_year, sum( CASE WHEN nation = 'BRAZIL' THEN volume ELSE 0 END) / sum(volume) AS mkt_share FROM ( SELECT extract(year FROM o_orderdate) AS o_year, l_extendedprice * (1 - l_discount) AS volume, n2.n_name AS nation FROM part, supplier, lineitem, orders, customer, nation n1, nation n2, region WHERE p_partkey = l_partkey AND s_suppkey = l_suppkey AND l_orderkey = o_orderkey AND o_custkey = c_custkey AND c_nationkey = n1.n_nationkey AND n1.n_regionkey = r_regionkey AND r_name = 'AMERICA' AND s_nationkey = n2.n_nationkey AND o_orderdate BETWEEN CAST('1995-01-01' AS date) AND CAST('1996-12-31' AS date) AND p_type = 'ECONOMY ANODIZED STEEL') AS all_nations GROUP BY o_year ORDER BY o_year;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 5e-06, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 1e-06, 'cardinality': 2, 'extra_info': '__internal_decompress_integral_bigint(#0, 1992)\n#1\n', 'children': [{'name': 'ORDER_BY', 'timing': 3.5e-05, 'cardinality': 2, 'extra_info': 'ORDERS:\nall_nations.o_year ASC', 'children': [{'name': 'PROJECTION', 'timing': 2e-06, 'cardinality': 2, 'extra_info': '__internal_compress_integral_utinyint(#0, 1992)\n#1\n', 'children': [{'name': 'PROJECTION', 'timing': 6e-06, 'cardinality': 2, 'extra_info': 'o_year\nmkt_share\n', 'children': [{'name': 'PROJECTION', 'timing': 4e-06, 'cardinality': 2, 'extra_info': '__internal_decompress_integral_bigint(#0, 1992)\n#1\n#2\n', 'children': [{'name': 'PERFECT_HASH_GROUP_BY', 'timing': 6.5e-05, 'cardinality': 2, 'extra_info': '#0\nsum(#1)\nsum(#2)', 'children': [{'name': 'PROJECTION', 'timing': 4.9e-05, 'cardinality': 2603, 'extra_info': "o_year\nCASE  WHEN ((nation = 'BRAZIL')) THEN (volume) ELSE 0.0000 END\nvolume\n", 'children': [{'name': 'PROJECTION', 'timing': 1.8e-05, 'cardinality': 2603, 'extra_info': '__internal_compress_integral_utinyint(#0, 1992)\n#1\n#2\n', 'children': [{'name': 'PROJECTION', 'timing': 7.5e-05, 'cardinality': 2603, 'extra_info': 'year(o_orderdate)\nvolume\nnation\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.000326, 'cardinality': 2603, 'extra_info': 'INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 508\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.001123, 'cardinality': 2603, 'extra_info': 'INNER\ns_suppkey = l_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 508\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 4.7e-05, 'cardinality': 10000, 'extra_info': 'supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\n[INFOSEPARATOR]\nEC: 10000', 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.001267, 'cardinality': 2603, 'extra_info': 'INNER\nc_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 512\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.010797, 'cardinality': 13389, 'extra_info': 'INNER\nc_custkey = o_custkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 149999\n\n[INFOSEPARATOR]\nEC: 2562\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.001433, 'cardinality': 149999, 'extra_info': 'customer\n[INFOSEPARATOR]\nc_custkey\nc_nationkey\n[INFOSEPARATOR]\nFilters: c_custkey<=149999 AND c_custkey IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 150000', 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.053079, 'cardinality': 13389, 'extra_info': 'INNER\no_orderkey = l_orderkey\n\n[INFOSEPARATOR]\nEC: 4249\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.025865, 'cardinality': 457263, 'extra_info': "orders\n[INFOSEPARATOR]\no_orderkey\no_custkey\no_orderdate\n[INFOSEPARATOR]\nFilters: o_orderdate>='1995-01-01'::DATE AND o_orderdate<='1996-12-31'::DATE AND o_orderdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 300000", 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.137587, 'cardinality': 43693, 'extra_info': 'INNER\nl_partkey = p_partkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 21246\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.038783, 'cardinality': 6001215, 'extra_info': 'lineitem\n[INFOSEPARATOR]\nl_partkey\nl_suppkey\nl_orderkey\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nEC: 6001215', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 0.009859, 'cardinality': 1451, 'extra_info': "part\n[INFOSEPARATOR]\np_partkey\n[INFOSEPARATOR]\nFilters: p_type='ECONOMY ANODIZED STEEL' AND p_type IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1325", 'children': []}]}]}]}, {'name': 'HASH_JOIN', 'timing': 6.6e-05, 'cardinality': 5, 'extra_info': 'INNER\nn_regionkey = r_regionkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 4\n\n[INFOSEPARATOR]\nEC: 5\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 1.3e-05, 'cardinality': 25, 'extra_info': 'nation\n[INFOSEPARATOR]\nn_nationkey\nn_regionkey\n[INFOSEPARATOR]\nEC: 25', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 3.3e-05, 'cardinality': 1, 'extra_info': "region\n[INFOSEPARATOR]\nr_regionkey\n[INFOSEPARATOR]\nFilters: r_name='AMERICA' AND r_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1", 'children': []}]}]}]}, {'name': 'SEQ_SCAN ', 'timing': 3.6e-05, 'cardinality': 25, 'extra_info': 'nation\n[INFOSEPARATOR]\nn_nationkey\nn_name\n[INFOSEPARATOR]\nEC: 25', 'children': []}]}]}]}]}]}]}]}]}]}]}]}]}
compressed filter_log_size: 2320
compressed filter_log_buffer_size: 0
compressed limit_offset_size: 2320
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 9303
compressed perfect_full_scan_ht_log_buffer_size: 5447
compressed perfect_probe_ht_log_size: 427386
compressed perfect_probe_ht_log_buffer_size: 376868
compressed row_group_log_size: 235096
compressed row_group_log_buffer_size: 194577
compressed scatter_log_size: 5636
compressed scatter_log_buffer_size: 3131
compressed scatter_sel_log_size: 313413
compressed scatter_sel_log_buffer_size: 301655
compressed gather_log_size: 2320
compressed gather_log_buffer_size: 0
compressed combine_log_size: 2496
compressed combine_log_buffer_size: 32
compressed finalize_states_log_size: 2480
compressed finalize_states_log_buffer_size: 16
compressed join_gather_log_size: 286519
compressed join_gather_log_buffer_size: 252890
compressed reorder_log_size: 3560
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 2320
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 2320
compressed nlj_log_buffer_size: 0
compressed total_size: 1297489
compressed total_buffer_size: 1134616
compressed total_element_size: 162873

Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│__internal_decompress_strin│                                                                                                                                                 
│           g(#0)           │                                                                                                                                                 
│__internal_decompress_integ│                                                                                                                                                 
│    ral_bigint(#1, 1992)   │                                                                                                                                                 
│             #2            │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│          ORDER_BY         │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│          ORDERS:          │                                                                                                                                                 
│     profit.nation ASC     │                                                                                                                                                 
│     profit.o_year DESC    │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│__internal_compress_string_│                                                                                                                                                 
│        hugeint(#0)        │                                                                                                                                                 
│__internal_compress_integra│                                                                                                                                                 
│    l_utinyint(#1, 1992)   │                                                                                                                                                 
│             #2            │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│__internal_decompress_strin│                                                                                                                                                 
│           g(#0)           │                                                                                                                                                 
│__internal_decompress_integ│                                                                                                                                                 
│    ral_bigint(#1, 1992)   │                                                                                                                                                 
│             #2            │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│       HASH_GROUP_BY       │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│             #0            │                                                                                                                                                 
│             #1            │                                                                                                                                                 
│          sum(#2)          │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│           nation          │                                                                                                                                                 
│           o_year          │                                                                                                                                                 
│           amount          │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│__internal_compress_string_│                                                                                                                                                 
│        hugeint(#0)        │                                                                                                                                                 
│__internal_compress_integra│                                                                                                                                                 
│    l_utinyint(#1, 1992)   │                                                                                                                                                 
│             #2            │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│           nation          │                                                                                                                                                 
│     year(o_orderdate)     │                                                                                                                                                 
│           amount          │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         HASH_JOIN         │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│           INNER           │                                                                                                                                                 
│  o_orderkey = l_orderkey  ├──────────────┐                                                                                                                                  
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                                                                                                                  
│        EC: 1191610        │              │                                                                                                                                  
└─────────────┬─────────────┘              │                                                                                                                                                               
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                                                    
│         SEQ_SCAN          ││         HASH_JOIN         │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│           orders          ││           INNER           │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   l_suppkey = ps_suppkey  │                                                                                                                    
│         o_orderkey        ││   l_partkey = ps_partkey  ├──────────────┐                                                                                                     
│        o_orderdate        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                                                                                     
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││        EC: 1191610        │              │                                                                                                     
│        EC: 1500000        ││                           │              │                                                                                                     
└───────────────────────────┘└─────────────┬─────────────┘              │                                                                                                                                  
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                       
                             │         SEQ_SCAN          ││         HASH_JOIN         │                                                                                       
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
                             │          lineitem         ││           INNER           │                                                                                       
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ps_suppkey = s_suppkey  │                                                                                       
                             │         l_suppkey         ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
                             │         l_partkey         ││        Build Min: 1       │                                                                                       
                             │         l_orderkey        ││      Build Max: 10000     ├───────────────────────────────────────────┐                                           
                             │      l_extendedprice      ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                           │                                           
                             │         l_discount        ││         EC: 74312         │                                           │                                           
                             │         l_quantity        ││                           │                                           │                                           
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                           │                                           
                             │        EC: 6001215        ││                           │                                           │                                           
                             └───────────────────────────┘└─────────────┬─────────────┘                                           │                                                                        
                                                          ┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐                             
                                                          │         HASH_JOIN         │                             │         HASH_JOIN         │                             
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                                                          │           INNER           │                             │           INNER           │                             
                                                          │   ps_partkey = p_partkey  │                             │ s_nationkey = n_nationkey │                             
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐              │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐              
                                                          │        Build Min: 1       │              │              │        Build Min: 0       │              │              
                                                          │     Build Max: 200000     │              │              │       Build Max: 24       │              │              
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              
                                                          │         EC: 85503         │              │              │         EC: 10000         │              │              
                                                          └─────────────┬─────────────┘              │              └─────────────┬─────────────┘              │                                           
                                                          ┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐
                                                          │         SEQ_SCAN          ││           FILTER          ││         SEQ_SCAN          ││         SEQ_SCAN          │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │          partsupp         ││ contains(p_name, 'green') ││          supplier         ││           nation          │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │         ps_suppkey        ││         EC: 40000         ││         s_suppkey         ││        n_nationkey        │
                                                          │         ps_partkey        ││                           ││        s_nationkey        ││           n_name          │
                                                          │       ps_supplycost       ││                           ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           ││         EC: 10000         ││           EC: 25          │
                                                          │         EC: 800000        ││                           ││                           ││                           │
                                                          └───────────────────────────┘└─────────────┬─────────────┘└───────────────────────────┘└───────────────────────────┘                             
                                                                                       ┌─────────────┴─────────────┐                                                          
                                                                                       │         SEQ_SCAN          │                                                          
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                                                       │            part           │                                                          
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                                                       │         p_partkey         │                                                          
                                                                                       │           p_name          │                                                          
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                                                       │         EC: 40000         │                                                          
                                                                                       └───────────────────────────┘                                                                                       

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

X {'RESULT_COLLECTOR0': 5e-06, 'PROJECTION1': 1e-06, 'ORDER_BY2': 3.5e-05, 'PROJECTION3': 2e-06, 'PROJECTION4': 6e-06, 'PROJECTION5': 4e-06, 'PERFECT_HASH_GROUP_BY6': 6.5e-05, 'PROJECTION7': 4.9e-05, 'PROJECTION8': 1.8e-05, 'PROJECTION9': 7.5e-05, 'HASH_JOIN10': 0.000326, 'HASH_JOIN11': 0.001123, 'SEQ_SCAN 12': 4.7e-05, 'HASH_JOIN13': 0.001267, 'HASH_JOIN14': 0.010797, 'SEQ_SCAN 15': 0.001433, 'HASH_JOIN16': 0.053079, 'SEQ_SCAN 17': 0.025865, 'HASH_JOIN18': 0.137587, 'SEQ_SCAN 19': 0.038783, 'SEQ_SCAN 20': 0.009859, 'HASH_JOIN21': 6.6e-05, 'SEQ_SCAN 22': 1.3e-05, 'SEQ_SCAN 23': 3.3e-05, 'SEQ_SCAN 24': 3.6e-05}
**** output size:  2
LINEAGE_5_HASH_JOIN_10
LINEAGE_5_HASH_JOIN_11
LINEAGE_5_HASH_JOIN_12
LINEAGE_5_HASH_JOIN_14
LINEAGE_5_HASH_JOIN_5
LINEAGE_5_HASH_JOIN_6
LINEAGE_5_HASH_JOIN_7
LINEAGE_5_ORDER_BY_22
LINEAGE_5_PERFECT_HASH_GROUP_BY_18
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_1
LINEAGE_5_SEQ_SCAN_13
LINEAGE_5_SEQ_SCAN_2
LINEAGE_5_SEQ_SCAN_3
LINEAGE_5_SEQ_SCAN_4
LINEAGE_5_SEQ_SCAN_8
LINEAGE_5_SEQ_SCAN_9
SELECT o_year, sum( CASE WHEN nation = 'BRAZIL' THEN volume ELSE 0 END) / sum(volume) AS mkt_share FROM ( SELECT extract(year FROM o_orderdate) AS o_year, l_extendedprice * (1 - l_discount) AS volume, n2.n_name AS nation FROM part, supplier, lineitem, orders, customer, nation n1, nation n2, region WHERE p_partkey = l_partkey AND s_suppkey = l_suppkey AND l_orderkey = o_orderkey AND o_custkey = c_custkey AND c_nationkey = n1.n_nationkey AND n1.n_regionkey = r_regionkey AND r_name = 'AMERICA' AND s_nationkey = n2.n_nationkey AND o_orderdate BETWEEN CAST('1995-01-01' AS date) AND CAST('1996-12-31' AS date) AND p_type = 'ECONOMY ANODIZED STEEL') AS all_nations GROUP BY o_year ORDER BY o_year;
   query_id  ...                                               plan
0         5  ...  {"name": "PROJECTION", "opid": "23", "children...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               SELECT o_year, sum( CASE WHEN nation = 'BRAZIL...
size_bytes_max                                                1297489
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "PROJECTION", "opid": "23", "children...
Name: 0, dtype: object
{"name": "PROJECTION", "opid": "23", "children": [{"name": "ORDER_BY", "opid": "22", "children": [{"name": "PROJECTION", "opid": "21", "children": [{"name": "PROJECTION", "opid": "20", "children": [{"name": "PROJECTION", "opid": "19", "children": [{"name": "PERFECT_HASH_GROUP_BY", "opid": "18", "children": [{"name": "PROJECTION", "opid": "17", "children": [{"name": "PROJECTION", "opid": "16", "children": [{"name": "PROJECTION", "opid": "15", "children": [{"name": "HASH_JOIN", "opid": "14", "children": [{"name": "HASH_JOIN", "opid": "12", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "supplier","extra": "supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\n[INFOSEPARATOR]\nEC: 10000"},{"name": "HASH_JOIN", "opid": "11", "children": [{"name": "HASH_JOIN", "opid": "7", "children": [{"name": "SEQ_SCAN ", "opid": "1", "children": [],"table": "customer","extra": "customer\n[INFOSEPARATOR]\nc_custkey\nc_nationkey\n[INFOSEPARATOR]\nFilters: c_custkey<=149999 AND c_custkey IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 150000"},{"name": "HASH_JOIN", "opid": "6", "children": [{"name": "SEQ_SCAN ", "opid": "2", "children": [],"table": "orders","extra": "orders\n[INFOSEPARATOR]\no_orderkey\no_custkey\no_orderdate\n[INFOSEPARATOR]\nFilters: o_orderdate>='1995-01-01'::DATE AND o_orderdate<='1996-12-31'::DATE AND o_orderdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 300000"},{"name": "HASH_JOIN", "opid": "5", "children": [{"name": "SEQ_SCAN ", "opid": "3", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_partkey\nl_suppkey\nl_orderkey\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nEC: 6001215"},{"name": "SEQ_SCAN ", "opid": "4", "children": [],"table": "part","extra": "part\n[INFOSEPARATOR]\np_partkey\n[INFOSEPARATOR]\nFilters: p_type='ECONOMY ANODIZED STEEL' AND p_type IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1325"}],"table": "","extra": "INNER\nl_partkey = p_partkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 21246\n"}],"table": "","extra": "INNER\no_orderkey = l_orderkey\n\n[INFOSEPARATOR]\nEC: 4249\n"}],"table": "","extra": "INNER\nc_custkey = o_custkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 149999\n\n[INFOSEPARATOR]\nEC: 2562\n"},{"name": "HASH_JOIN", "opid": "10", "children": [{"name": "SEQ_SCAN ", "opid": "8", "children": [],"table": "nation","extra": "nation\n[INFOSEPARATOR]\nn_nationkey\nn_regionkey\n[INFOSEPARATOR]\nEC: 25"},{"name": "SEQ_SCAN ", "opid": "9", "children": [],"table": "region","extra": "region\n[INFOSEPARATOR]\nr_regionkey\n[INFOSEPARATOR]\nFilters: r_name='AMERICA' AND r_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1"}],"table": "","extra": "INNER\nn_regionkey = r_regionkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 4\n\n[INFOSEPARATOR]\nEC: 5\n"}],"table": "","extra": "INNER\nc_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 512\n"}],"table": "","extra": "INNER\ns_suppkey = l_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 508\n"},{"name": "SEQ_SCAN ", "opid": "13", "children": [],"table": "nation","extra": "nation\n[INFOSEPARATOR]\nn_nationkey\nn_name\n[INFOSEPARATOR]\nEC: 25"}],"table": "","extra": "INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 508\n"}],"table": "","extra": "year(o_orderdate)\nvolume\nnation\n"}],"table": "","extra": "__internal_compress_integral_utinyint(#0, 1992)\n#1\n#2\n"}],"table": "","extra": "o_year\nCASE  WHEN ((nation = 'BRAZIL')) THEN (volume) ELSE 0.0000 END\nvolume\n"}],"table": "","extra": "#0\nsum(#1)\nsum(#2)"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1992)\n#1\n#2\n"}],"table": "","extra": "o_year\nmkt_share\n"}],"table": "","extra": "__internal_compress_integral_utinyint(#0, 1992)\n#1\n"}],"table": "","extra": "ORDERS:\nall_nations.o_year ASC"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1992)\n#1\n"}
%%%%%%%%%%%%%%%% Running Query #  9  threads:  16
SELECT nation, o_year, sum(amount) AS sum_profit FROM ( SELECT n_name AS nation, extract(year FROM o_orderdate) AS o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity AS amount FROM part, supplier, lineitem, partsupp, orders, nation WHERE s_suppkey = l_suppkey AND ps_suppkey = l_suppkey AND ps_partkey = l_partkey AND p_partkey = l_partkey AND o_orderkey = l_orderkey AND s_nationkey = n_nationkey AND p_name LIKE '%green%') AS profit GROUP BY nation, o_year ORDER BY nation, o_year DESC;
Run:  None SELECT nation, o_year, sum(amount) AS sum_profit FROM ( SELECT n_name AS nation, extract(year FROM o_orderdate) AS o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity AS amount FROM part, supplier, lineitem, partsupp, orders, nation WHERE s_suppkey = l_suppkey AND ps_suppkey = l_suppkey AND ps_partkey = l_partkey AND p_partkey = l_partkey AND o_orderkey = l_orderkey AND s_nationkey = n_nationkey AND p_name LIKE '%green%') AS profit GROUP BY nation, o_year ORDER BY nation, o_year DESC;
Avg Time in sec:  0.14179270202293992  output size:  175
      nation  o_year    sum_profit
0    ALGERIA    1998  2.713690e+07
1    ALGERIA    1997  4.861183e+07
2    ALGERIA    1996  4.828548e+07
3    ALGERIA    1995  4.440227e+07
4    ALGERIA    1994  4.869401e+07
..       ...     ...           ...
170  VIETNAM    1996  4.782460e+07
171  VIETNAM    1995  4.823514e+07
172  VIETNAM    1994  4.772926e+07
173  VIETNAM    1993  4.535268e+07
174  VIETNAM    1992  4.784636e+07

[175 rows x 3 columns]
{'name': 'Query', 'result': 0.125521, 'timing': 0.125521, 'cardinality': 0, 'extra-info': "SELECT nation, o_year, sum(amount) AS sum_profit FROM ( SELECT n_name AS nation, extract(year FROM o_orderdate) AS o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity AS amount FROM part, supplier, lineitem, partsupp, orders, nation WHERE s_suppkey = l_suppkey AND ps_suppkey = l_suppkey AND ps_partkey = l_partkey AND p_partkey = l_partkey AND o_orderkey = l_orderkey AND s_nationkey = n_nationkey AND p_name LIKE '%green%') AS profit GROUP BY nation, o_year ORDER BY nation, o_year DESC;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 3.9e-05, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 1.9e-05, 'cardinality': 175, 'extra_info': '__internal_decompress_string(#0)\n__internal_decompress_integral_bigint(#1, 1992)\n#2\n', 'children': [{'name': 'ORDER_BY', 'timing': 0.000261, 'cardinality': 175, 'extra_info': 'ORDERS:\nprofit.nation ASC\nprofit.o_year DESC', 'children': [{'name': 'PROJECTION', 'timing': 5e-05, 'cardinality': 175, 'extra_info': '__internal_compress_string_hugeint(#0)\n__internal_compress_integral_utinyint(#1, 1992)\n#2\n', 'children': [{'name': 'PROJECTION', 'timing': 6.4e-05, 'cardinality': 175, 'extra_info': '__internal_decompress_string(#0)\n__internal_decompress_integral_bigint(#1, 1992)\n#2\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.072865, 'cardinality': 175, 'extra_info': '#0\n#1\nsum(#2)', 'children': [{'name': 'PROJECTION', 'timing': 0.000911, 'cardinality': 319404, 'extra_info': 'nation\no_year\namount\n', 'children': [{'name': 'PROJECTION', 'timing': 0.009574, 'cardinality': 319404, 'extra_info': '__internal_compress_string_hugeint(#0)\n__internal_compress_integral_utinyint(#1, 1992)\n#2\n', 'children': [{'name': 'PROJECTION', 'timing': 0.019479, 'cardinality': 319404, 'extra_info': 'nation\nyear(o_orderdate)\namount\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.356095, 'cardinality': 319404, 'extra_info': 'INNER\no_orderkey = l_orderkey\n\n[INFOSEPARATOR]\nEC: 1191610\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.005411, 'cardinality': 1500000, 'extra_info': 'orders\n[INFOSEPARATOR]\no_orderkey\no_orderdate\n[INFOSEPARATOR]\nEC: 1500000', 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.399415, 'cardinality': 319404, 'extra_info': 'INNER\nl_suppkey = ps_suppkey\nl_partkey = ps_partkey\n\n[INFOSEPARATOR]\nEC: 1191610\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.044199, 'cardinality': 6001215, 'extra_info': 'lineitem\n[INFOSEPARATOR]\nl_suppkey\nl_partkey\nl_orderkey\nl_extendedprice\nl_discount\nl_quantity\n[INFOSEPARATOR]\nEC: 6001215', 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.007623, 'cardinality': 42656, 'extra_info': 'INNER\nps_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 74312\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.010716, 'cardinality': 42656, 'extra_info': 'INNER\nps_partkey = p_partkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 85503\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.00283, 'cardinality': 800000, 'extra_info': 'partsupp\n[INFOSEPARATOR]\nps_suppkey\nps_partkey\nps_supplycost\n[INFOSEPARATOR]\nEC: 800000', 'children': []}, {'name': 'FILTER', 'timing': 0.014107, 'cardinality': 10664, 'extra_info': "contains(p_name, 'green')\n[INFOSEPARATOR]\nEC: 40000", 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.007085, 'cardinality': 200000, 'extra_info': 'part\n[INFOSEPARATOR]\np_partkey\np_name\n[INFOSEPARATOR]\nEC: 40000', 'children': []}]}]}, {'name': 'HASH_JOIN', 'timing': 0.00047, 'cardinality': 10000, 'extra_info': 'INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 10000\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.00015, 'cardinality': 10000, 'extra_info': 'supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\n[INFOSEPARATOR]\nEC: 10000', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 4.3e-05, 'cardinality': 25, 'extra_info': 'nation\n[INFOSEPARATOR]\nn_nationkey\nn_name\n[INFOSEPARATOR]\nEC: 25', 'children': []}]}]}]}]}]}]}]}]}]}]}]}]}]}]}
compressed filter_log_size: 25292
compressed filter_log_buffer_size: 20249
compressed limit_offset_size: 3424
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 56677
compressed perfect_full_scan_ht_log_buffer_size: 52101
compressed perfect_probe_ht_log_size: 228668
compressed perfect_probe_ht_log_buffer_size: 210750
compressed row_group_log_size: 38830
compressed row_group_log_buffer_size: 0
compressed scatter_log_size: 1310684
compressed scatter_log_buffer_size: 1298726
compressed scatter_sel_log_size: 2228947
compressed scatter_sel_log_buffer_size: 2182256
compressed gather_log_size: 3424
compressed gather_log_buffer_size: 0
compressed combine_log_size: 76132
compressed combine_log_buffer_size: 70902
compressed finalize_states_log_size: 5113
compressed finalize_states_log_buffer_size: 537
compressed join_gather_log_size: 4300952
compressed join_gather_log_buffer_size: 4122184
compressed reorder_log_size: 5836
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 3424
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 3424
compressed nlj_log_buffer_size: 0
compressed total_size: 8290827
compressed total_buffer_size: 7957705
compressed total_element_size: 333122

Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                                                                                       
│           LIMIT           │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│__internal_decompress_integ│                                                                                       
│     ral_bigint(#0, 1)     │                                                                                       
│             #1            │                                                                                       
│             #2            │                                                                                       
│             #3            │                                                                                       
│__internal_decompress_strin│                                                                                       
│           g(#4)           │                                                                                       
│             #5            │                                                                                       
│__internal_decompress_strin│                                                                                       
│           g(#6)           │                                                                                       
│             #7            │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│          ORDER_BY         │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│          ORDERS:          │                                                                                       
│       sum((lineitem       │                                                                                       
│.l_extendedprice * (1 ...  │                                                                                       
│    .l_discount))) DESC    │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│__internal_compress_integra│                                                                                       
│     l_uinteger(#0, 1)     │                                                                                       
│             #1            │                                                                                       
│             #2            │                                                                                       
│             #3            │                                                                                       
│__internal_compress_string_│                                                                                       
│        hugeint(#4)        │                                                                                       
│             #5            │                                                                                       
│__internal_compress_string_│                                                                                       
│        hugeint(#6)        │                                                                                       
│             #7            │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│         c_custkey         │                                                                                       
│           c_name          │                                                                                       
│          revenue          │                                                                                       
│         c_acctbal         │                                                                                       
│           n_name          │                                                                                       
│         c_address         │                                                                                       
│          c_phone          │                                                                                       
│         c_comment         │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│__internal_decompress_integ│                                                                                       
│     ral_bigint(#0, 1)     │                                                                                       
│             #1            │                                                                                       
│             #2            │                                                                                       
│__internal_decompress_strin│                                                                                       
│           g(#3)           │                                                                                       
│__internal_decompress_strin│                                                                                       
│           g(#4)           │                                                                                       
│             #5            │                                                                                       
│             #6            │                                                                                       
│             #7            │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│       HASH_GROUP_BY       │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│             #0            │                                                                                       
│             #1            │                                                                                       
│             #2            │                                                                                       
│             #3            │                                                                                       
│             #4            │                                                                                       
│             #5            │                                                                                       
│             #6            │                                                                                       
│          sum(#7)          │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│         c_custkey         │                                                                                       
│           c_name          │                                                                                       
│         c_acctbal         │                                                                                       
│          c_phone          │                                                                                       
│           n_name          │                                                                                       
│         c_address         │                                                                                       
│         c_comment         │                                                                                       
│ (l_extendedprice * (1.00 -│                                                                                       
│        l_discount))       │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│__internal_compress_integra│                                                                                       
│     l_uinteger(#0, 1)     │                                                                                       
│             #1            │                                                                                       
│             #2            │                                                                                       
│__internal_compress_integra│                                                                                       
│     l_uinteger(#3, 1)     │                                                                                       
│__internal_compress_integra│                                                                                       
│     l_uinteger(#4, 1)     │                                                                                       
│             #5            │                                                                                       
│             #6            │                                                                                       
│__internal_compress_string_│                                                                                       
│        hugeint(#7)        │                                                                                       
│             #8            │                                                                                       
│             #9            │                                                                                       
│__internal_compress_string_│                                                                                       
│        hugeint(#10)       │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         HASH_JOIN         │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│           INNER           │                                                                                       
│  l_orderkey = o_orderkey  ├──────────────┐                                                                        
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                                                        
│         EC: 241245        │              │                                                                        
└─────────────┬─────────────┘              │                                                                                                     
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                          
│         SEQ_SCAN          ││         HASH_JOIN         │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│          lineitem         ││           INNER           │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   o_custkey = c_custkey   │                                                          
│         l_orderkey        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│      l_extendedprice      ││        Build Min: 1       │                                                          
│         l_discount        ││     Build Max: 149999     ├──────────────┐                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                           
│ Filters: l_returnflag='R' ││         EC: 180897        │              │                                           
│ AND l_returnflag IS N...  ││                           │              │                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │              │                                           
│        EC: 2000405        ││                           │              │                                           
└───────────────────────────┘└─────────────┬─────────────┘              │                                                                        
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             
                             │         SEQ_SCAN          ││         HASH_JOIN         │                             
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                             │           orders          ││           INNER           │                             
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││ c_nationkey = n_nationkey │                             
                             │         o_custkey         ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                             │         o_orderkey        ││         EC: 150000        │                             
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           ├──────────────┐              
                             │Filters: o_orderdate>='1993││                           │              │              
                             │     -10-01'::DATE AND     ││                           │              │              
                             │ o_orderdate<'1994-01-...  ││                           │              │              
                             │   o_orderdate IS NOT NULL ││                           │              │              
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │              │              
                             │         EC: 300000        ││                           │              │              
                             └───────────────────────────┘└─────────────┬─────────────┘              │                                           
                                                          ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
                                                          │         SEQ_SCAN          ││         SEQ_SCAN          │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │          customer         ││           nation          │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │         c_custkey         ││        n_nationkey        │
                                                          │        c_nationkey        ││           n_name          │
                                                          │           c_name          ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │         c_acctbal         ││           EC: 25          │
                                                          │          c_phone          ││                           │
                                                          │         c_address         ││                           │
                                                          │         c_comment         ││                           │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │
                                                          │ Filters: c_custkey<=149999││                           │
                                                          │  AND c_custkey IS NOT NULL││                           │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │
                                                          │         EC: 150000        ││                           │
                                                          └───────────────────────────┘└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

X {'RESULT_COLLECTOR0': 3.9e-05, 'PROJECTION1': 1.9e-05, 'ORDER_BY2': 0.000261, 'PROJECTION3': 5e-05, 'PROJECTION4': 6.4e-05, 'HASH_GROUP_BY5': 0.072865, 'PROJECTION6': 0.000911, 'PROJECTION7': 0.009574, 'PROJECTION8': 0.019479, 'HASH_JOIN9': 0.356095, 'SEQ_SCAN 10': 0.005411, 'HASH_JOIN11': 0.399415, 'SEQ_SCAN 12': 0.044199, 'HASH_JOIN13': 0.007623, 'HASH_JOIN14': 0.010716, 'SEQ_SCAN 15': 0.00283, 'FILTER16': 0.014107, 'SEQ_SCAN 17': 0.007085, 'HASH_JOIN18': 0.00047, 'SEQ_SCAN 19': 0.00015, 'SEQ_SCAN 20': 4.3e-05}
**** output size:  175
LINEAGE_5_FILTER_4
LINEAGE_5_HASH_GROUP_BY_15
LINEAGE_5_HASH_JOIN_10
LINEAGE_5_HASH_JOIN_11
LINEAGE_5_HASH_JOIN_5
LINEAGE_5_HASH_JOIN_8
LINEAGE_5_HASH_JOIN_9
LINEAGE_5_ORDER_BY_18
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_1
LINEAGE_5_SEQ_SCAN_2
LINEAGE_5_SEQ_SCAN_3
LINEAGE_5_SEQ_SCAN_6
LINEAGE_5_SEQ_SCAN_7
SELECT nation, o_year, sum(amount) AS sum_profit FROM ( SELECT n_name AS nation, extract(year FROM o_orderdate) AS o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity AS amount FROM part, supplier, lineitem, partsupp, orders, nation WHERE s_suppkey = l_suppkey AND ps_suppkey = l_suppkey AND ps_partkey = l_partkey AND p_partkey = l_partkey AND o_orderkey = l_orderkey AND s_nationkey = n_nationkey AND p_name LIKE '%green%') AS profit GROUP BY nation, o_year ORDER BY nation, o_year DESC;
   query_id  ...                                               plan
0         5  ...  {"name": "PROJECTION", "opid": "19", "children...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               SELECT nation, o_year, sum(amount) AS sum_prof...
size_bytes_max                                                8290827
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "PROJECTION", "opid": "19", "children...
Name: 0, dtype: object
{"name": "PROJECTION", "opid": "19", "children": [{"name": "ORDER_BY", "opid": "18", "children": [{"name": "PROJECTION", "opid": "17", "children": [{"name": "PROJECTION", "opid": "16", "children": [{"name": "HASH_GROUP_BY", "opid": "15", "children": [{"name": "PROJECTION", "opid": "14", "children": [{"name": "PROJECTION", "opid": "13", "children": [{"name": "PROJECTION", "opid": "12", "children": [{"name": "HASH_JOIN", "opid": "11", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "orders","extra": "orders\n[INFOSEPARATOR]\no_orderkey\no_orderdate\n[INFOSEPARATOR]\nEC: 1500000"},{"name": "HASH_JOIN", "opid": "10", "children": [{"name": "SEQ_SCAN ", "opid": "1", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_suppkey\nl_partkey\nl_orderkey\nl_extendedprice\nl_discount\nl_quantity\n[INFOSEPARATOR]\nEC: 6001215"},{"name": "HASH_JOIN", "opid": "9", "children": [{"name": "HASH_JOIN", "opid": "5", "children": [{"name": "SEQ_SCAN ", "opid": "2", "children": [],"table": "partsupp","extra": "partsupp\n[INFOSEPARATOR]\nps_suppkey\nps_partkey\nps_supplycost\n[INFOSEPARATOR]\nEC: 800000"},{"name": "FILTER", "opid": "4", "children": [{"name": "SEQ_SCAN ", "opid": "3", "children": [],"table": "part","extra": "part\n[INFOSEPARATOR]\np_partkey\np_name\n[INFOSEPARATOR]\nEC: 40000"}],"table": "","extra": "contains(p_name, 'green')\n[INFOSEPARATOR]\nEC: 40000"}],"table": "","extra": "INNER\nps_partkey = p_partkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 85503\n"},{"name": "HASH_JOIN", "opid": "8", "children": [{"name": "SEQ_SCAN ", "opid": "6", "children": [],"table": "supplier","extra": "supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\n[INFOSEPARATOR]\nEC: 10000"},{"name": "SEQ_SCAN ", "opid": "7", "children": [],"table": "nation","extra": "nation\n[INFOSEPARATOR]\nn_nationkey\nn_name\n[INFOSEPARATOR]\nEC: 25"}],"table": "","extra": "INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 10000\n"}],"table": "","extra": "INNER\nps_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 74312\n"}],"table": "","extra": "INNER\nl_suppkey = ps_suppkey\nl_partkey = ps_partkey\n\n[INFOSEPARATOR]\nEC: 1191610\n"}],"table": "","extra": "INNER\no_orderkey = l_orderkey\n\n[INFOSEPARATOR]\nEC: 1191610\n"}],"table": "","extra": "nation\nyear(o_orderdate)\namount\n"}],"table": "","extra": "__internal_compress_string_hugeint(#0)\n__internal_compress_integral_utinyint(#1, 1992)\n#2\n"}],"table": "","extra": "nation\no_year\namount\n"}],"table": "","extra": "#0\n#1\nsum(#2)"}],"table": "","extra": "__internal_decompress_string(#0)\n__internal_decompress_integral_bigint(#1, 1992)\n#2\n"}],"table": "","extra": "__internal_compress_string_hugeint(#0)\n__internal_compress_integral_utinyint(#1, 1992)\n#2\n"}],"table": "","extra": "ORDERS:\nprofit.nation ASC\nprofit.o_year DESC"}],"table": "","extra": "__internal_decompress_string(#0)\n__internal_decompress_integral_bigint(#1, 1992)\n#2\n"}
%%%%%%%%%%%%%%%% Running Query #  10  threads:  16
SELECT c_custkey, c_name, sum(l_extendedprice * (1 - l_discount)) AS revenue, c_acctbal, n_name, c_address, c_phone, c_comment FROM customer, orders, lineitem, nation WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate >= CAST('1993-10-01' AS date) AND o_orderdate < CAST('1994-01-01' AS date) AND l_returnflag = 'R' AND c_nationkey = n_nationkey GROUP BY c_custkey, c_name, c_acctbal, c_phone, n_name, c_address, c_comment ORDER BY revenue DESC LIMIT 20;
Run:  None SELECT c_custkey, c_name, sum(l_extendedprice * (1 - l_discount)) AS revenue, c_acctbal, n_name, c_address, c_phone, c_comment FROM customer, orders, lineitem, nation WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate >= CAST('1993-10-01' AS date) AND o_orderdate < CAST('1994-01-01' AS date) AND l_returnflag = 'R' AND c_nationkey = n_nationkey GROUP BY c_custkey, c_name, c_acctbal, c_phone, n_name, c_address, c_comment ORDER BY revenue DESC LIMIT 20;
Avg Time in sec:  0.18097635684534907  output size:  20
    c_custkey  ...                                          c_comment
0       57040  ...  ep. blithely regular foxes promise slyly furio...
1      143347  ...  endencies sleep. slyly express deposits nag ca...
2       60838  ...   tes. final instructions nag quickly according to
3      101998  ...  ost carefully. slyly regular packages cajole a...
4      125341  ...  ly furiously brave packages. quickly regular d...
5       25501  ...  y ironic foxes hinder according to the furious...
6      115831  ...  unts nag carefully final packages. express the...
7       84223  ...  longside of the slyly final deposits. blithely...
8       54289  ...      cajole furiously after the quickly unusual fo
9       39922  ...  ironic deposits sublate furiously. carefully r...
10       6226  ...  nal packages are alongside of the quickly bold...
11        922  ...                cuses cajole carefully regular idea
12     147946  ...  ly pending platelets. ironic requests haggle a...
13     115640  ...             ffily ironic deposits. blithely specia
14      73606  ...                 uests cajole according to the foxe
15     110246  ...        ow carefully. blithely careful packages hag
16     142549  ...  . slyly bold packages nag quickly against the ...
17     146149  ...  nic, special instructions. multipliers run car...
18      52528  ...  olphins. blithely silent platelets affix caref...
19      23431  ...    the final sentiments. carefully ironic packages

[20 rows x 8 columns]
{'name': 'Query', 'result': 0.168292, 'timing': 0.168292, 'cardinality': 0, 'extra-info': "SELECT c_custkey, c_name, sum(l_extendedprice * (1 - l_discount)) AS revenue, c_acctbal, n_name, c_address, c_phone, c_comment FROM customer, orders, lineitem, nation WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate >= CAST('1993-10-01' AS date) AND o_orderdate < CAST('1994-01-01' AS date) AND l_returnflag = 'R' AND c_nationkey = n_nationkey GROUP BY c_custkey, c_name, c_acctbal, c_phone, n_name, c_address, c_comment ORDER BY revenue DESC LIMIT 20;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 2.5e-05, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'LIMIT', 'timing': 0.000466, 'cardinality': 20, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 0.001184, 'cardinality': 16384, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n#1\n#2\n#3\n__internal_decompress_string(#4)\n#5\n__internal_decompress_string(#6)\n#7\n', 'children': [{'name': 'ORDER_BY', 'timing': 0.015883, 'cardinality': 16384, 'extra_info': 'ORDERS:\nsum((lineitem.l_extendedprice * (1 - lineitem.l_discount))) DESC', 'children': [{'name': 'PROJECTION', 'timing': 0.002255, 'cardinality': 37967, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n#1\n#2\n#3\n__internal_compress_string_hugeint(#4)\n#5\n__internal_compress_string_hugeint(#6)\n#7\n', 'children': [{'name': 'PROJECTION', 'timing': 5.9e-05, 'cardinality': 37967, 'extra_info': 'c_custkey\nc_name\nrevenue\nc_acctbal\nn_name\nc_address\nc_phone\nc_comment\n', 'children': [{'name': 'PROJECTION', 'timing': 0.002665, 'cardinality': 37967, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n#1\n#2\n__internal_decompress_string(#3)\n__internal_decompress_string(#4)\n#5\n#6\n#7\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.100359, 'cardinality': 37967, 'extra_info': '#0\n#1\n#2\n#3\n#4\n#5\n#6\nsum(#7)', 'children': [{'name': 'PROJECTION', 'timing': 0.001693, 'cardinality': 114705, 'extra_info': 'c_custkey\nc_name\nc_acctbal\nc_phone\nn_name\nc_address\nc_comment\n(l_extendedprice * (1.00 - l_discount))\n', 'children': [{'name': 'PROJECTION', 'timing': 0.009153, 'cardinality': 114705, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n#1\n#2\n__internal_compress_integral_uinteger(#3, 1)\n__internal_compress_integral_uinteger(#4, 1)\n#5\n#6\n__internal_compress_string_hugeint(#7)\n#8\n#9\n__internal_compress_string_hugeint(#10)\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.326285, 'cardinality': 114705, 'extra_info': 'INNER\nl_orderkey = o_orderkey\n\n[INFOSEPARATOR]\nEC: 241245\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.290151, 'cardinality': 1478870, 'extra_info': "lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nFilters: l_returnflag='R' AND l_returnflag IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 2000405", 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.05814, 'cardinality': 57069, 'extra_info': 'INNER\no_custkey = c_custkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 149999\n\n[INFOSEPARATOR]\nEC: 180897\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.026982, 'cardinality': 57069, 'extra_info': "orders\n[INFOSEPARATOR]\no_custkey\no_orderkey\n[INFOSEPARATOR]\nFilters: o_orderdate>='1993-10-01'::DATE AND o_orderdate<'1994-01-01'::DATE AND o_orderdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 300000", 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.007849, 'cardinality': 149999, 'extra_info': 'INNER\nc_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nEC: 150000\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.019249, 'cardinality': 149999, 'extra_info': 'customer\n[INFOSEPARATOR]\nc_custkey\nc_nationkey\nc_name\nc_acctbal\nc_phone\nc_address\nc_comment\n[INFOSEPARATOR]\nFilters: c_custkey<=149999 AND c_custkey IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 150000', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 2.1e-05, 'cardinality': 25, 'extra_info': 'nation\n[INFOSEPARATOR]\nn_nationkey\nn_name\n[INFOSEPARATOR]\nEC: 25', 'children': []}]}]}]}]}]}]}]}]}]}]}]}]}]}]}
compressed filter_log_size: 3168
compressed filter_log_buffer_size: 0
compressed limit_offset_size: 3312
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 574945
compressed perfect_full_scan_ht_log_buffer_size: 571393
compressed perfect_probe_ht_log_size: 191495
compressed perfect_probe_ht_log_buffer_size: 175492
compressed row_group_log_size: 947806
compressed row_group_log_buffer_size: 886993
compressed scatter_log_size: 444091
compressed scatter_log_buffer_size: 438524
compressed scatter_sel_log_size: 1097139
compressed scatter_sel_log_buffer_size: 1082486
compressed gather_log_size: 3168
compressed gather_log_buffer_size: 0
compressed combine_log_size: 601871
compressed combine_log_buffer_size: 596630
compressed finalize_states_log_size: 59274
compressed finalize_states_log_buffer_size: 54908
compressed join_gather_log_size: 1600073
compressed join_gather_log_buffer_size: 1499345
compressed reorder_log_size: 70736
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 3168
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 3168
compressed nlj_log_buffer_size: 0
compressed total_size: 5603414
compressed total_buffer_size: 5305771
compressed total_element_size: 297643

Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│__internal_decompress_integ│                                                                                                                                                 
│     ral_bigint(#0, 1)     │                                                                                                                                                 
│             #1            │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│          ORDER_BY         │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│          ORDERS:          │                                                                                                                                                 
│sum((partsupp.ps_supplycost│                                                                                                                                                 
│  * partsupp.ps_availqty)) │                                                                                                                                                 
│            DESC           │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│__internal_compress_integra│                                                                                                                                                 
│     l_uinteger(#0, 1)     │                                                                                                                                                 
│             #1            │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│         ps_partkey        │                                                                                                                                                 
│           value           │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│      NESTED_LOOP_JOIN     │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│           INNER           │                                                                                                                                                 
│       CAST(sum((CAST      │                                                                                                                                                 
│(ps_supplycost AS DECI...  │                                                                                                                                                 
│(ps_availqty AS DECIMA...  ├────────────────────────────────────────────────────────────────────────┐                                                                        
│ )))) AS DECIMAL(38,11)) > │                                                                        │                                                                        
│          SUBQUERY         │                                                                        │                                                                        
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                        │                                                                        
│           EC: 1           │                                                                        │                                                                        
└─────────────┬─────────────┘                                                                        │                                                                                                     
┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐                                                          
│         PROJECTION        │                                                          │    UNGROUPED_AGGREGATE    │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│__internal_decompress_integ│                                                          │         first(#0)         │                                                          
│     ral_bigint(#0, 1)     │                                                          │                           │                                                          
│             #1            │                                                          │                           │                                                          
└─────────────┬─────────────┘                                                          └─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐                                                          
│       HASH_GROUP_BY       │                                                          │         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│             #0            │                                                          │             #0            │                                                          
│          sum(#1)          │                                                          │                           │                                                          
└─────────────┬─────────────┘                                                          └─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐                                                          
│         PROJECTION        │                                                          │      STREAMING_LIMIT      │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │                           │                                                          
│         ps_partkey        │                                                          │                           │                                                          
│   (CAST(ps_supplycost AS  │                                                          │                           │                                                          
│    DECIMAL(34,2)) * CAST  │                                                          │                           │                                                          
│(ps_availqty AS DECIMA...  │                                                          │                           │                                                          
└─────────────┬─────────────┘                                                          └─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐                                                          
│         PROJECTION        │                                                          │         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│__internal_compress_integra│                                                          │(sum((CAST(ps_supplycost AS│                                                          
│     l_usmallint(#0, 1)    │                                                          │    DECIMAL(34,2)) * CAST  │                                                          
│__internal_compress_integra│                                                          │(ps_availqty AS DECIMA...  │                                                          
│     l_uinteger(#1, 1)     │                                                          │       * 0.000100000)      │                                                          
│             #2            │                                                          │                           │                                                          
│             #3            │                                                          │                           │                                                          
│__internal_compress_integra│                                                          │                           │                                                          
│     l_usmallint(#4, 1)    │                                                          │                           │                                                          
└─────────────┬─────────────┘                                                          └─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐                                                          
│         HASH_JOIN         │                                                          │    UNGROUPED_AGGREGATE    │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│           INNER           │                                                          │          sum(#0)          │                                                          
│   ps_suppkey = s_suppkey  │                                                          │                           │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐                                           │                           │                                                          
│        Build Min: 1       │              │                                           │                           │                                                          
│      Build Max: 10000     │              │                                           │                           │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                           │                           │                                                          
│         EC: 27811         │              │                                           │                           │                                                          
└─────────────┬─────────────┘              │                                           └─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐                                                          
│         SEQ_SCAN          ││         HASH_JOIN         │                             │         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│          partsupp         ││           INNER           │                             │   (CAST(ps_supplycost AS  │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││ s_nationkey = n_nationkey │                             │    DECIMAL(34,2)) * CAST  │                                                          
│         ps_suppkey        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │(ps_availqty AS DECIMA...  │                                                          
│         ps_partkey        ││        Build Min: 0       ├──────────────┐              │                           │                                                          
│       ps_supplycost       ││       Build Max: 24       │              │              │                           │                                                          
│        ps_availqty        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              │                           │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││          EC: 400          │              │              │                           │                                                          
│         EC: 800000        ││                           │              │              │                           │                                                          
└───────────────────────────┘└─────────────┬─────────────┘              │              └─────────────┬─────────────┘                                                                                       
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                          
                             │         SEQ_SCAN          ││         SEQ_SCAN          ││         HASH_JOIN         │                                                          
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                             │          supplier         ││           nation          ││           INNER           │                                                          
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ps_suppkey = s_suppkey  │                                                          
                             │         s_suppkey         ││        n_nationkey        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                             │        s_nationkey        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││        Build Min: 1       ├──────────────┐                                           
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││ Filters: n_name='GERMANY' ││      Build Max: 10000     │              │                                           
                             │         EC: 10000         ││   AND n_name IS NOT NULL  ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                           
                             │                           ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││         EC: 27811         │              │                                           
                             │                           ││           EC: 1           ││                           │              │                                           
                             └───────────────────────────┘└───────────────────────────┘└─────────────┬─────────────┘              │                                                                        
                                                                                       ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             
                                                                                       │         SEQ_SCAN          ││         HASH_JOIN         │                             
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                                                                                       │          partsupp         ││           INNER           │                             
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││ s_nationkey = n_nationkey │                             
                                                                                       │         ps_suppkey        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐              
                                                                                       │       ps_supplycost       ││        Build Min: 0       │              │              
                                                                                       │        ps_availqty        ││       Build Max: 24       │              │              
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              
                                                                                       │         EC: 800000        ││          EC: 400          │              │              
                                                                                       └───────────────────────────┘└─────────────┬─────────────┘              │                                           
                                                                                                                    ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
                                                                                                                    │         SEQ_SCAN          ││         SEQ_SCAN          │
                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                                                    │          supplier         ││           nation          │
                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                                                    │         s_suppkey         ││        n_nationkey        │
                                                                                                                    │        s_nationkey        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││ Filters: n_name='GERMANY' │
                                                                                                                    │         EC: 10000         ││   AND n_name IS NOT NULL  │
                                                                                                                    │                           ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                                                    │                           ││           EC: 1           │
                                                                                                                    └───────────────────────────┘└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

X {'RESULT_COLLECTOR0': 2.5e-05, 'LIMIT1': 0.000466, 'PROJECTION2': 0.001184, 'ORDER_BY3': 0.015883, 'PROJECTION4': 0.002255, 'PROJECTION5': 5.9e-05, 'PROJECTION6': 0.002665, 'HASH_GROUP_BY7': 0.100359, 'PROJECTION8': 0.001693, 'PROJECTION9': 0.009153, 'HASH_JOIN10': 0.326285, 'SEQ_SCAN 11': 0.290151, 'HASH_JOIN12': 0.05814, 'SEQ_SCAN 13': 0.026982, 'HASH_JOIN14': 0.007849, 'SEQ_SCAN 15': 0.019249, 'SEQ_SCAN 16': 2.1e-05}
**** output size:  20
LINEAGE_5_HASH_GROUP_BY_9
LINEAGE_5_HASH_JOIN_4
LINEAGE_5_HASH_JOIN_5
LINEAGE_5_HASH_JOIN_6
LINEAGE_5_LIMIT_15
LINEAGE_5_ORDER_BY_13
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_1
LINEAGE_5_SEQ_SCAN_2
LINEAGE_5_SEQ_SCAN_3
SELECT c_custkey, c_name, sum(l_extendedprice * (1 - l_discount)) AS revenue, c_acctbal, n_name, c_address, c_phone, c_comment FROM customer, orders, lineitem, nation WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate >= CAST('1993-10-01' AS date) AND o_orderdate < CAST('1994-01-01' AS date) AND l_returnflag = 'R' AND c_nationkey = n_nationkey GROUP BY c_custkey, c_name, c_acctbal, c_phone, n_name, c_address, c_comment ORDER BY revenue DESC LIMIT 20;
   query_id  ...                                               plan
0         5  ...  {"name": "LIMIT", "opid": "15", "children": [{...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               SELECT c_custkey, c_name, sum(l_extendedprice ...
size_bytes_max                                                5603414
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "LIMIT", "opid": "15", "children": [{...
Name: 0, dtype: object
{"name": "LIMIT", "opid": "15", "children": [{"name": "PROJECTION", "opid": "14", "children": [{"name": "ORDER_BY", "opid": "13", "children": [{"name": "PROJECTION", "opid": "12", "children": [{"name": "PROJECTION", "opid": "11", "children": [{"name": "PROJECTION", "opid": "10", "children": [{"name": "HASH_GROUP_BY", "opid": "9", "children": [{"name": "PROJECTION", "opid": "8", "children": [{"name": "PROJECTION", "opid": "7", "children": [{"name": "HASH_JOIN", "opid": "6", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nFilters: l_returnflag='R' AND l_returnflag IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 2000405"},{"name": "HASH_JOIN", "opid": "5", "children": [{"name": "SEQ_SCAN ", "opid": "1", "children": [],"table": "orders","extra": "orders\n[INFOSEPARATOR]\no_custkey\no_orderkey\n[INFOSEPARATOR]\nFilters: o_orderdate>='1993-10-01'::DATE AND o_orderdate<'1994-01-01'::DATE AND o_orderdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 300000"},{"name": "HASH_JOIN", "opid": "4", "children": [{"name": "SEQ_SCAN ", "opid": "2", "children": [],"table": "customer","extra": "customer\n[INFOSEPARATOR]\nc_custkey\nc_nationkey\nc_name\nc_acctbal\nc_phone\nc_address\nc_comment\n[INFOSEPARATOR]\nFilters: c_custkey<=149999 AND c_custkey IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 150000"},{"name": "SEQ_SCAN ", "opid": "3", "children": [],"table": "nation","extra": "nation\n[INFOSEPARATOR]\nn_nationkey\nn_name\n[INFOSEPARATOR]\nEC: 25"}],"table": "","extra": "INNER\nc_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nEC: 150000\n"}],"table": "","extra": "INNER\no_custkey = c_custkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 149999\n\n[INFOSEPARATOR]\nEC: 180897\n"}],"table": "","extra": "INNER\nl_orderkey = o_orderkey\n\n[INFOSEPARATOR]\nEC: 241245\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n#1\n#2\n__internal_compress_integral_uinteger(#3, 1)\n__internal_compress_integral_uinteger(#4, 1)\n#5\n#6\n__internal_compress_string_hugeint(#7)\n#8\n#9\n__internal_compress_string_hugeint(#10)\n"}],"table": "","extra": "c_custkey\nc_name\nc_acctbal\nc_phone\nn_name\nc_address\nc_comment\n(l_extendedprice * (1.00 - l_discount))\n"}],"table": "","extra": "#0\n#1\n#2\n#3\n#4\n#5\n#6\nsum(#7)"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n#1\n#2\n__internal_decompress_string(#3)\n__internal_decompress_string(#4)\n#5\n#6\n#7\n"}],"table": "","extra": "c_custkey\nc_name\nrevenue\nc_acctbal\nn_name\nc_address\nc_phone\nc_comment\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n#1\n#2\n#3\n__internal_compress_string_hugeint(#4)\n#5\n__internal_compress_string_hugeint(#6)\n#7\n"}],"table": "","extra": "ORDERS:\nsum((lineitem.l_extendedprice * (1 - lineitem.l_discount))) DESC"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n#1\n#2\n#3\n__internal_decompress_string(#4)\n#5\n__internal_decompress_string(#6)\n#7\n"}],"table": "","extra": ""}
%%%%%%%%%%%%%%%% Running Query #  11  threads:  16
SELECT ps_partkey, sum(ps_supplycost * ps_availqty) AS value FROM partsupp, supplier, nation WHERE ps_suppkey = s_suppkey AND s_nationkey = n_nationkey AND n_name = 'GERMANY' GROUP BY ps_partkey HAVING sum(ps_supplycost * ps_availqty) > ( SELECT sum(ps_supplycost * ps_availqty) * 0.000100000 FROM partsupp, supplier, nation WHERE ps_suppkey = s_suppkey AND s_nationkey = n_nationkey AND n_name = 'GERMANY') ORDER BY value DESC;
Run:  None SELECT ps_partkey, sum(ps_supplycost * ps_availqty) AS value FROM partsupp, supplier, nation WHERE ps_suppkey = s_suppkey AND s_nationkey = n_nationkey AND n_name = 'GERMANY' GROUP BY ps_partkey HAVING sum(ps_supplycost * ps_availqty) > ( SELECT sum(ps_supplycost * ps_availqty) * 0.000100000 FROM partsupp, supplier, nation WHERE ps_suppkey = s_suppkey AND s_nationkey = n_nationkey AND n_name = 'GERMANY') ORDER BY value DESC;
Avg Time in sec:  0.02274724980816245  output size:  1048
      ps_partkey        value
0         129760  17538456.86
1         166726  16503353.92
2         191287  16474801.97
3         161758  16101755.54
4          34452  15983844.72
...          ...          ...
1043      154731   7888301.33
1044      101674   7879324.60
1045       51968   7879102.21
1046       72073   7877736.11
1047        5182   7874521.73

[1048 rows x 2 columns]
{'name': 'Query', 'result': 0.016398, 'timing': 0.016398, 'cardinality': 0, 'extra-info': "SELECT ps_partkey, sum(ps_supplycost * ps_availqty) AS value FROM partsupp, supplier, nation WHERE ps_suppkey = s_suppkey AND s_nationkey = n_nationkey AND n_name = 'GERMANY' GROUP BY ps_partkey HAVING sum(ps_supplycost * ps_availqty) > ( SELECT sum(ps_supplycost * ps_availqty) * 0.000100000 FROM partsupp, supplier, nation WHERE ps_suppkey = s_suppkey AND s_nationkey = n_nationkey AND n_name = 'GERMANY') ORDER BY value DESC;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 3.8e-05, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 1.7e-05, 'cardinality': 1048, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n#1\n', 'children': [{'name': 'ORDER_BY', 'timing': 0.000351, 'cardinality': 1048, 'extra_info': 'ORDERS:\nsum((partsupp.ps_supplycost * partsupp.ps_availqty)) DESC', 'children': [{'name': 'PROJECTION', 'timing': 4.4e-05, 'cardinality': 1048, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n#1\n', 'children': [{'name': 'PROJECTION', 'timing': 1.3e-05, 'cardinality': 1048, 'extra_info': 'ps_partkey\nvalue\n', 'children': [{'name': 'NESTED_LOOP_JOIN', 'timing': 0.002244, 'cardinality': 1048, 'extra_info': 'INNER\nCAST(sum((CAST(ps_supplycost AS DECIMAL(34,2)) * CAST(ps_availqty AS DECIMAL(34,0)))) AS DECIMAL(38,11)) > SUBQUERY\n\n[INFOSEPARATOR]\nEC: 1\n', 'children': [{'name': 'PROJECTION', 'timing': 0.000131, 'cardinality': 29818, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n#1\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.021579, 'cardinality': 29818, 'extra_info': '#0\nsum(#1)', 'children': [{'name': 'PROJECTION', 'timing': 0.009086, 'cardinality': 31680, 'extra_info': 'ps_partkey\n(CAST(ps_supplycost AS DECIMAL(34,2)) * CAST(ps_availqty AS DECIMAL(34,0)))\n', 'children': [{'name': 'PROJECTION', 'timing': 0.003037, 'cardinality': 31680, 'extra_info': '__internal_compress_integral_usmallint(#0, 1)\n__internal_compress_integral_uinteger(#1, 1)\n#2\n#3\n__internal_compress_integral_usmallint(#4, 1)\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.010039, 'cardinality': 31680, 'extra_info': 'INNER\nps_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 27811\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.003327, 'cardinality': 800000, 'extra_info': 'partsupp\n[INFOSEPARATOR]\nps_suppkey\nps_partkey\nps_supplycost\nps_availqty\n[INFOSEPARATOR]\nEC: 800000', 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.00011, 'cardinality': 396, 'extra_info': 'INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 400\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 4.4e-05, 'cardinality': 10000, 'extra_info': 'supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\n[INFOSEPARATOR]\nEC: 10000', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 3.1e-05, 'cardinality': 1, 'extra_info': "nation\n[INFOSEPARATOR]\nn_nationkey\n[INFOSEPARATOR]\nFilters: n_name='GERMANY' AND n_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1", 'children': []}]}]}]}]}]}]}, {'name': 'UNGROUPED_AGGREGATE', 'timing': 2e-06, 'cardinality': 1, 'extra_info': 'first(#0)', 'children': [{'name': 'PROJECTION', 'timing': 0.0, 'cardinality': 1, 'extra_info': '#0\n', 'children': [{'name': 'STREAMING_LIMIT', 'timing': 3e-06, 'cardinality': 1, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 4e-06, 'cardinality': 1, 'extra_info': '(sum((CAST(ps_supplycost AS DECIMAL(34,2)) * CAST(ps_availqty AS DECIMAL(34,0)))) * 0.000100000)\n', 'children': [{'name': 'UNGROUPED_AGGREGATE', 'timing': 0.0009, 'cardinality': 1, 'extra_info': 'sum(#0)', 'children': [{'name': 'PROJECTION', 'timing': 0.010956, 'cardinality': 31680, 'extra_info': '(CAST(ps_supplycost AS DECIMAL(34,2)) * CAST(ps_availqty AS DECIMAL(34,0)))\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.010377, 'cardinality': 31680, 'extra_info': 'INNER\nps_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 27811\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.003365, 'cardinality': 800000, 'extra_info': 'partsupp\n[INFOSEPARATOR]\nps_suppkey\nps_supplycost\nps_availqty\n[INFOSEPARATOR]\nEC: 800000', 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.000153, 'cardinality': 396, 'extra_info': 'INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 400\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 3.8e-05, 'cardinality': 10000, 'extra_info': 'supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\n[INFOSEPARATOR]\nEC: 10000', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 5.1e-05, 'cardinality': 1, 'extra_info': "nation\n[INFOSEPARATOR]\nn_nationkey\n[INFOSEPARATOR]\nFilters: n_name='GERMANY' AND n_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1", 'children': []}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}
compressed filter_log_size: 2624
compressed filter_log_buffer_size: 0
compressed limit_offset_size: 2768
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 6574
compressed perfect_full_scan_ht_log_buffer_size: 2414
compressed perfect_probe_ht_log_size: 313112
compressed perfect_probe_ht_log_buffer_size: 294442
compressed row_group_log_size: 10946
compressed row_group_log_buffer_size: 8
compressed scatter_log_size: 138934
compressed scatter_log_buffer_size: 133780
compressed scatter_sel_log_size: 8220
compressed scatter_sel_log_buffer_size: 4595
compressed gather_log_size: 2624
compressed gather_log_buffer_size: 0
compressed combine_log_size: 10717
compressed combine_log_buffer_size: 6672
compressed finalize_states_log_size: 8531
compressed finalize_states_log_buffer_size: 4755
compressed join_gather_log_size: 2624
compressed join_gather_log_buffer_size: 0
compressed reorder_log_size: 5657
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 2624
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 8993
compressed nlj_log_buffer_size: 2913
compressed total_size: 524948
compressed total_buffer_size: 449579
compressed total_element_size: 75369

Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│__internal_decompress_strin│                             
│           g(#0)           │                             
│             #1            │                             
│             #2            │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│          ORDER_BY         │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│          ORDERS:          │                             
│  lineitem.l_shipmode ASC  │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│__internal_compress_string_│                             
│        ubigint(#0)        │                             
│             #1            │                             
│             #2            │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│__internal_decompress_strin│                             
│           g(#0)           │                             
│             #1            │                             
│             #2            │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│       HASH_GROUP_BY       │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│             #0            │                             
│          sum(#1)          │                             
│          sum(#2)          │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│         l_shipmode        │                             
│       CASE  WHEN ((       │                             
│(o_orderpriority = '1-...  │                             
│(o_orderpriority = '2-...  │                             
│     THEN (1) ELSE 0 END   │                             
│       CASE  WHEN ((       │                             
│(o_orderpriority != '1...  │                             
│(o_orderpriority != '2...  │                             
│     THEN (1) ELSE 0 END   │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│__internal_compress_integra│                             
│     l_uinteger(#0, 1)     │                             
│             #1            │                             
│__internal_compress_integra│                             
│     l_uinteger(#2, 1)     │                             
│__internal_compress_string_│                             
│        ubigint(#3)        │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         HASH_JOIN         │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│           INNER           │                             
│  o_orderkey = l_orderkey  ├──────────────┐              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              
│         EC: 240048        │              │              
└─────────────┬─────────────┘              │                                           
┌─────────────┴─────────────┐┌─────────────┴─────────────┐
│         SEQ_SCAN          ││           FILTER          │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│           orders          ││      ((l_commitdate <     │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││ l_receiptdate) AND (l...  │
│         o_orderkey        ││ l_commitdate) AND ((l...  │
│      o_orderpriority      ││= 'MAIL') OR (l_shipmode = │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││         'SHIP')))         │
│        EC: 1500000        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│                           ││         EC: 240048        │
└───────────────────────────┘└─────────────┬─────────────┘                             
                             ┌─────────────┴─────────────┐
                             │         SEQ_SCAN          │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                             │          lineitem         │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                             │         l_orderkey        │
                             │         l_shipmode        │
                             │        l_commitdate       │
                             │       l_receiptdate       │
                             │         l_shipdate        │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                             │  Filters: l_receiptdate>= │
                             │   '1994-01-01'::DATE AND  │
                             │ l_receiptdate<'1995-0...  │
                             │  AND l_receiptdate IS NOT │
                             │            NULL           │
                             │ l_commitdate<'1995-01-01':│
                             │ :DATE AND l_commitdate IS │
                             │          NOT NULL         │
                             │  l_shipdate<'1995-01-01': │
                             │:DATE AND l_shipdate IS NOT│
                             │            NULL           │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                             │         EC: 240048        │
                             └───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

X {'RESULT_COLLECTOR0': 3.8e-05, 'PROJECTION1': 1.7e-05, 'ORDER_BY2': 0.000351, 'PROJECTION3': 4.4e-05, 'PROJECTION4': 1.3e-05, 'NESTED_LOOP_JOIN5': 0.002244, 'PROJECTION6': 0.000131, 'HASH_GROUP_BY7': 0.021579, 'PROJECTION8': 0.009086, 'PROJECTION9': 0.003037, 'HASH_JOIN10': 0.010039, 'SEQ_SCAN 11': 0.003327, 'HASH_JOIN12': 0.00011, 'SEQ_SCAN 13': 4.4e-05, 'SEQ_SCAN 14': 3.1e-05, 'UNGROUPED_AGGREGATE15': 2e-06, 'PROJECTION16': 0.0, 'STREAMING_LIMIT17': 3e-06, 'PROJECTION18': 4e-06, 'UNGROUPED_AGGREGATE19': 0.0009, 'PROJECTION20': 0.010956, 'HASH_JOIN21': 0.010377, 'SEQ_SCAN 22': 0.003365, 'HASH_JOIN23': 0.000153, 'SEQ_SCAN 24': 3.8e-05, 'SEQ_SCAN 25': 5.1e-05}
**** output size:  1048
LINEAGE_5_HASH_GROUP_BY_7
LINEAGE_5_HASH_JOIN_12
LINEAGE_5_HASH_JOIN_13
LINEAGE_5_HASH_JOIN_3
LINEAGE_5_HASH_JOIN_4
LINEAGE_5_NESTED_LOOP_JOIN_20
LINEAGE_5_ORDER_BY_23
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_1
LINEAGE_5_SEQ_SCAN_10
LINEAGE_5_SEQ_SCAN_11
LINEAGE_5_SEQ_SCAN_2
LINEAGE_5_SEQ_SCAN_9
LINEAGE_5_STREAMING_LIMIT_17
SELECT ps_partkey, sum(ps_supplycost * ps_availqty) AS value FROM partsupp, supplier, nation WHERE ps_suppkey = s_suppkey AND s_nationkey = n_nationkey AND n_name = 'GERMANY' GROUP BY ps_partkey HAVING sum(ps_supplycost * ps_availqty) > ( SELECT sum(ps_supplycost * ps_availqty) * 0.000100000 FROM partsupp, supplier, nation WHERE ps_suppkey = s_suppkey AND s_nationkey = n_nationkey AND n_name = 'GERMANY') ORDER BY value DESC;
   query_id  ...                                               plan
0         5  ...  {"name": "PROJECTION", "opid": "24", "children...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               SELECT ps_partkey, sum(ps_supplycost * ps_avai...
size_bytes_max                                                 524948
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "PROJECTION", "opid": "24", "children...
Name: 0, dtype: object
{"name": "PROJECTION", "opid": "24", "children": [{"name": "ORDER_BY", "opid": "23", "children": [{"name": "PROJECTION", "opid": "22", "children": [{"name": "PROJECTION", "opid": "21", "children": [{"name": "NESTED_LOOP_JOIN", "opid": "20", "children": [{"name": "PROJECTION", "opid": "8", "children": [{"name": "HASH_GROUP_BY", "opid": "7", "children": [{"name": "PROJECTION", "opid": "6", "children": [{"name": "PROJECTION", "opid": "5", "children": [{"name": "HASH_JOIN", "opid": "4", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "partsupp","extra": "partsupp\n[INFOSEPARATOR]\nps_suppkey\nps_partkey\nps_supplycost\nps_availqty\n[INFOSEPARATOR]\nEC: 800000"},{"name": "HASH_JOIN", "opid": "3", "children": [{"name": "SEQ_SCAN ", "opid": "1", "children": [],"table": "supplier","extra": "supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\n[INFOSEPARATOR]\nEC: 10000"},{"name": "SEQ_SCAN ", "opid": "2", "children": [],"table": "nation","extra": "nation\n[INFOSEPARATOR]\nn_nationkey\n[INFOSEPARATOR]\nFilters: n_name='GERMANY' AND n_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1"}],"table": "","extra": "INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 400\n"}],"table": "","extra": "INNER\nps_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 27811\n"}],"table": "","extra": "__internal_compress_integral_usmallint(#0, 1)\n__internal_compress_integral_uinteger(#1, 1)\n#2\n#3\n__internal_compress_integral_usmallint(#4, 1)\n"}],"table": "","extra": "ps_partkey\n(CAST(ps_supplycost AS DECIMAL(34,2)) * CAST(ps_availqty AS DECIMAL(34,0)))\n"}],"table": "","extra": "#0\nsum(#1)"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n#1\n"},{"name": "UNGROUPED_AGGREGATE", "opid": "19", "children": [{"name": "PROJECTION", "opid": "18", "children": [{"name": "STREAMING_LIMIT", "opid": "17", "children": [{"name": "PROJECTION", "opid": "16", "children": [{"name": "UNGROUPED_AGGREGATE", "opid": "15", "children": [{"name": "PROJECTION", "opid": "14", "children": [{"name": "HASH_JOIN", "opid": "13", "children": [{"name": "SEQ_SCAN ", "opid": "9", "children": [],"table": "partsupp","extra": "partsupp\n[INFOSEPARATOR]\nps_suppkey\nps_supplycost\nps_availqty\n[INFOSEPARATOR]\nEC: 800000"},{"name": "HASH_JOIN", "opid": "12", "children": [{"name": "SEQ_SCAN ", "opid": "10", "children": [],"table": "supplier","extra": "supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\n[INFOSEPARATOR]\nEC: 10000"},{"name": "SEQ_SCAN ", "opid": "11", "children": [],"table": "nation","extra": "nation\n[INFOSEPARATOR]\nn_nationkey\n[INFOSEPARATOR]\nFilters: n_name='GERMANY' AND n_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1"}],"table": "","extra": "INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 400\n"}],"table": "","extra": "INNER\nps_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 27811\n"}],"table": "","extra": "(CAST(ps_supplycost AS DECIMAL(34,2)) * CAST(ps_availqty AS DECIMAL(34,0)))\n"}],"table": "","extra": "sum(#0)"}],"table": "","extra": "(sum((CAST(ps_supplycost AS DECIMAL(34,2)) * CAST(ps_availqty AS DECIMAL(34,0)))) * 0.000100000)\n"}],"table": "","extra": ""}],"table": "","extra": "#0\n"}],"table": "","extra": "first(#0)"}],"table": "","extra": "INNER\nCAST(sum((CAST(ps_supplycost AS DECIMAL(34,2)) * CAST(ps_availqty AS DECIMAL(34,0)))) AS DECIMAL(38,11)) > SUBQUERY\n\n[INFOSEPARATOR]\nEC: 1\n"}],"table": "","extra": "ps_partkey\nvalue\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n#1\n"}],"table": "","extra": "ORDERS:\nsum((partsupp.ps_supplycost * partsupp.ps_availqty)) DESC"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n#1\n"}
%%%%%%%%%%%%%%%% Running Query #  12  threads:  16
SELECT l_shipmode, sum( CASE WHEN o_orderpriority = '1-URGENT' OR o_orderpriority = '2-HIGH' THEN 1 ELSE 0 END) AS high_line_count, sum( CASE WHEN o_orderpriority <> '1-URGENT' AND o_orderpriority <> '2-HIGH' THEN 1 ELSE 0 END) AS low_line_count FROM orders, lineitem WHERE o_orderkey = l_orderkey AND l_shipmode IN ('MAIL', 'SHIP') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= CAST('1994-01-01' AS date) AND l_receiptdate < CAST('1995-01-01' AS date) GROUP BY l_shipmode ORDER BY l_shipmode;
Run:  None SELECT l_shipmode, sum( CASE WHEN o_orderpriority = '1-URGENT' OR o_orderpriority = '2-HIGH' THEN 1 ELSE 0 END) AS high_line_count, sum( CASE WHEN o_orderpriority <> '1-URGENT' AND o_orderpriority <> '2-HIGH' THEN 1 ELSE 0 END) AS low_line_count FROM orders, lineitem WHERE o_orderkey = l_orderkey AND l_shipmode IN ('MAIL', 'SHIP') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= CAST('1994-01-01' AS date) AND l_receiptdate < CAST('1995-01-01' AS date) GROUP BY l_shipmode ORDER BY l_shipmode;
Avg Time in sec:  0.06063822517171502  output size:  2
  l_shipmode  high_line_count  low_line_count
0       MAIL           6202.0          9324.0
1       SHIP           6200.0          9262.0
{'name': 'Query', 'result': 0.053494, 'timing': 0.053494, 'cardinality': 0, 'extra-info': "SELECT l_shipmode, sum( CASE WHEN o_orderpriority = '1-URGENT' OR o_orderpriority = '2-HIGH' THEN 1 ELSE 0 END) AS high_line_count, sum( CASE WHEN o_orderpriority <> '1-URGENT' AND o_orderpriority <> '2-HIGH' THEN 1 ELSE 0 END) AS low_line_count FROM orders, lineitem WHERE o_orderkey = l_orderkey AND l_shipmode IN ('MAIL', 'SHIP') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= CAST('1994-01-01' AS date) AND l_receiptdate < CAST('1995-01-01' AS date) GROUP BY l_shipmode ORDER BY l_shipmode;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 1e-05, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 6e-06, 'cardinality': 2, 'extra_info': '__internal_decompress_string(#0)\n#1\n#2\n', 'children': [{'name': 'ORDER_BY', 'timing': 6.8e-05, 'cardinality': 2, 'extra_info': 'ORDERS:\nlineitem.l_shipmode ASC', 'children': [{'name': 'PROJECTION', 'timing': 2e-06, 'cardinality': 2, 'extra_info': '__internal_compress_string_ubigint(#0)\n#1\n#2\n', 'children': [{'name': 'PROJECTION', 'timing': 8e-06, 'cardinality': 2, 'extra_info': '__internal_decompress_string(#0)\n#1\n#2\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.017096, 'cardinality': 2, 'extra_info': '#0\nsum(#1)\nsum(#2)', 'children': [{'name': 'PROJECTION', 'timing': 0.001616, 'cardinality': 30988, 'extra_info': "l_shipmode\nCASE  WHEN (((o_orderpriority = '1-URGENT') OR (o_orderpriority = '2-HIGH'))) THEN (1) ELSE 0 END\nCASE  WHEN (((o_orderpriority != '1-URGENT') AND (o_orderpriority != '2-HIGH'))) THEN (1) ELSE 0 END\n", 'children': [{'name': 'PROJECTION', 'timing': 0.000633, 'cardinality': 30988, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n#1\n__internal_compress_integral_uinteger(#2, 1)\n__internal_compress_string_ubigint(#3)\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.078653, 'cardinality': 30988, 'extra_info': 'INNER\no_orderkey = l_orderkey\n\n[INFOSEPARATOR]\nEC: 240048\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.066697, 'cardinality': 1500000, 'extra_info': 'orders\n[INFOSEPARATOR]\no_orderkey\no_orderpriority\n[INFOSEPARATOR]\nEC: 1500000', 'children': []}, {'name': 'FILTER', 'timing': 0.069741, 'cardinality': 30988, 'extra_info': "((l_commitdate < l_receiptdate) AND (l_shipdate < l_commitdate) AND ((l_shipmode = 'MAIL') OR (l_shipmode = 'SHIP')))\n[INFOSEPARATOR]\nEC: 240048", 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.354304, 'cardinality': 885773, 'extra_info': "lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_shipmode\nl_commitdate\nl_receiptdate\nl_shipdate\n[INFOSEPARATOR]\nFilters: l_receiptdate>='1994-01-01'::DATE AND l_receiptdate<'1995-01-01'::DATE AND l_receiptdate IS NOT NULL\nl_commitdate<'1995-01-01'::DATE AND l_commitdate IS NOT NULL\nl_shipdate<'1995-01-01'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 240048", 'children': []}]}]}]}]}]}]}]}]}]}]}]}
compressed filter_log_size: 161309
compressed filter_log_buffer_size: 125456
compressed limit_offset_size: 2448
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 2448
compressed perfect_full_scan_ht_log_buffer_size: 0
compressed perfect_probe_ht_log_size: 2448
compressed perfect_probe_ht_log_buffer_size: 0
compressed row_group_log_size: 688167
compressed row_group_log_buffer_size: 635605
compressed scatter_log_size: 97736
compressed scatter_log_buffer_size: 93416
compressed scatter_sel_log_size: 152556
compressed scatter_sel_log_buffer_size: 146268
compressed gather_log_size: 2448
compressed gather_log_buffer_size: 0
compressed combine_log_size: 3300
compressed combine_log_buffer_size: 416
compressed finalize_states_log_size: 2752
compressed finalize_states_log_buffer_size: 16
compressed join_gather_log_size: 339592
compressed join_gather_log_buffer_size: 301222
compressed reorder_log_size: 3832
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 2448
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 2448
compressed nlj_log_buffer_size: 0
compressed total_size: 1463932
compressed total_buffer_size: 1302399
compressed total_element_size: 161533

Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                             
│          ORDER_BY         │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│          ORDERS:          │                             
│     count_star() DESC     │                             
│   c_orders.c_count DESC   │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│       HASH_GROUP_BY       │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│             #0            │                             
│        count_star()       │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│          c_count          │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│     count(o_orderkey)     │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│__internal_decompress_integ│                             
│     ral_bigint(#0, 1)     │                             
│             #1            │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│       HASH_GROUP_BY       │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│             #0            │                             
│         count(#1)         │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│         c_custkey         │                             
│         o_orderkey        │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│__internal_compress_integra│                             
│     l_uinteger(#0, 1)     │                             
│             #1            │                             
│             #2            │                             
│__internal_compress_integra│                             
│     l_uinteger(#3, 1)     │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         HASH_JOIN         │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│           RIGHT           │                             
│   o_custkey = c_custkey   ├──────────────┐              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              
│         EC: 300000        │              │              
└─────────────┬─────────────┘              │                                           
┌─────────────┴─────────────┐┌─────────────┴─────────────┐
│           FILTER          ││         SEQ_SCAN          │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│  (o_comment !~~ '%special ││          customer         │
│        %requests%')       ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││         c_custkey         │
│         EC: 300000        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│                           ││         EC: 150000        │
└─────────────┬─────────────┘└───────────────────────────┘                             
┌─────────────┴─────────────┐                             
│         SEQ_SCAN          │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│           orders          │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│         o_custkey         │                             
│         o_comment         │                             
│         o_orderkey        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│        EC: 1500000        │                             
└───────────────────────────┘                                                          

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

X {'RESULT_COLLECTOR0': 1e-05, 'PROJECTION1': 6e-06, 'ORDER_BY2': 6.8e-05, 'PROJECTION3': 2e-06, 'PROJECTION4': 8e-06, 'HASH_GROUP_BY5': 0.017096, 'PROJECTION6': 0.001616, 'PROJECTION7': 0.000633, 'HASH_JOIN8': 0.078653, 'SEQ_SCAN 9': 0.066697, 'FILTER10': 0.069741, 'SEQ_SCAN 11': 0.354304}
**** output size:  2
LINEAGE_5_FILTER_2
LINEAGE_5_HASH_GROUP_BY_6
LINEAGE_5_HASH_JOIN_3
LINEAGE_5_ORDER_BY_9
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_1
SELECT l_shipmode, sum( CASE WHEN o_orderpriority = '1-URGENT' OR o_orderpriority = '2-HIGH' THEN 1 ELSE 0 END) AS high_line_count, sum( CASE WHEN o_orderpriority <> '1-URGENT' AND o_orderpriority <> '2-HIGH' THEN 1 ELSE 0 END) AS low_line_count FROM orders, lineitem WHERE o_orderkey = l_orderkey AND l_shipmode IN ('MAIL', 'SHIP') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= CAST('1994-01-01' AS date) AND l_receiptdate < CAST('1995-01-01' AS date) GROUP BY l_shipmode ORDER BY l_shipmode;
   query_id  ...                                               plan
0         5  ...  {"name": "PROJECTION", "opid": "10", "children...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               SELECT l_shipmode, sum( CASE WHEN o_orderprior...
size_bytes_max                                                1463932
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "PROJECTION", "opid": "10", "children...
Name: 0, dtype: object
{"name": "PROJECTION", "opid": "10", "children": [{"name": "ORDER_BY", "opid": "9", "children": [{"name": "PROJECTION", "opid": "8", "children": [{"name": "PROJECTION", "opid": "7", "children": [{"name": "HASH_GROUP_BY", "opid": "6", "children": [{"name": "PROJECTION", "opid": "5", "children": [{"name": "PROJECTION", "opid": "4", "children": [{"name": "HASH_JOIN", "opid": "3", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "orders","extra": "orders\n[INFOSEPARATOR]\no_orderkey\no_orderpriority\n[INFOSEPARATOR]\nEC: 1500000"},{"name": "FILTER", "opid": "2", "children": [{"name": "SEQ_SCAN ", "opid": "1", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_shipmode\nl_commitdate\nl_receiptdate\nl_shipdate\n[INFOSEPARATOR]\nFilters: l_receiptdate>='1994-01-01'::DATE AND l_receiptdate<'1995-01-01'::DATE AND l_receiptdate IS NOT NULL\nl_commitdate<'1995-01-01'::DATE AND l_commitdate IS NOT NULL\nl_shipdate<'1995-01-01'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 240048"}],"table": "","extra": "((l_commitdate < l_receiptdate) AND (l_shipdate < l_commitdate) AND ((l_shipmode = 'MAIL') OR (l_shipmode = 'SHIP')))\n[INFOSEPARATOR]\nEC: 240048"}],"table": "","extra": "INNER\no_orderkey = l_orderkey\n\n[INFOSEPARATOR]\nEC: 240048\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n#1\n__internal_compress_integral_uinteger(#2, 1)\n__internal_compress_string_ubigint(#3)\n"}],"table": "","extra": "l_shipmode\nCASE  WHEN (((o_orderpriority = '1-URGENT') OR (o_orderpriority = '2-HIGH'))) THEN (1) ELSE 0 END\nCASE  WHEN (((o_orderpriority != '1-URGENT') AND (o_orderpriority != '2-HIGH'))) THEN (1) ELSE 0 END\n"}],"table": "","extra": "#0\nsum(#1)\nsum(#2)"}],"table": "","extra": "__internal_decompress_string(#0)\n#1\n#2\n"}],"table": "","extra": "__internal_compress_string_ubigint(#0)\n#1\n#2\n"}],"table": "","extra": "ORDERS:\nlineitem.l_shipmode ASC"}],"table": "","extra": "__internal_decompress_string(#0)\n#1\n#2\n"}
%%%%%%%%%%%%%%%% Running Query #  13  threads:  16
SELECT c_count, count(*) AS custdist FROM ( SELECT c_custkey, count(o_orderkey) FROM customer LEFT OUTER JOIN orders ON c_custkey = o_custkey AND o_comment NOT LIKE '%special%requests%' GROUP BY c_custkey) AS c_orders (c_custkey, c_count) GROUP BY c_count ORDER BY custdist DESC, c_count DESC;
Run:  None SELECT c_count, count(*) AS custdist FROM ( SELECT c_custkey, count(o_orderkey) FROM customer LEFT OUTER JOIN orders ON c_custkey = o_custkey AND o_comment NOT LIKE '%special%requests%' GROUP BY c_custkey) AS c_orders (c_custkey, c_count) GROUP BY c_count ORDER BY custdist DESC, c_count DESC;
Avg Time in sec:  0.14623113116249442  output size:  42
    c_count  custdist
0         0     50004
1        10      6668
2         9      6563
3        11      6004
4         8      5890
5        12      5600
6        13      5029
7        19      4805
8         7      4680
9        18      4531
10       20      4507
11       14      4473
12       15      4463
13       17      4445
14       16      4410
15       21      4168
16       22      3742
17        6      3273
18       23      3189
19       24      2700
20       25      2090
21        5      1957
22       26      1653
23       27      1177
24        4      1010
25       28       901
26       29       564
27        3       408
28       30       378
29       31       242
30       32       133
31        2       128
32       33        72
33       34        52
34       35        32
35       36        20
36        1        20
37       37         8
38       38         4
39       41         3
40       40         3
41       39         1
{'name': 'Query', 'result': 0.135973, 'timing': 0.135973, 'cardinality': 0, 'extra-info': "SELECT c_count, count(*) AS custdist FROM ( SELECT c_custkey, count(o_orderkey) FROM customer LEFT OUTER JOIN orders ON c_custkey = o_custkey AND o_comment NOT LIKE '%special%requests%' GROUP BY c_custkey) AS c_orders (c_custkey, c_count) GROUP BY c_count ORDER BY custdist DESC, c_count DESC;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 9e-06, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'ORDER_BY', 'timing': 0.000139, 'cardinality': 42, 'extra_info': 'ORDERS:\ncount_star() DESC\nc_orders.c_count DESC', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.012035, 'cardinality': 42, 'extra_info': '#0\ncount_star()', 'children': [{'name': 'PROJECTION', 'timing': 2.3e-05, 'cardinality': 150000, 'extra_info': 'c_count\n', 'children': [{'name': 'PROJECTION', 'timing': 2.6e-05, 'cardinality': 150000, 'extra_info': 'count(o_orderkey)\n', 'children': [{'name': 'PROJECTION', 'timing': 0.000288, 'cardinality': 150000, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n#1\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.447363, 'cardinality': 150000, 'extra_info': '#0\ncount(#1)', 'children': [{'name': 'PROJECTION', 'timing': 0.000971, 'cardinality': 1534302, 'extra_info': 'c_custkey\no_orderkey\n', 'children': [{'name': 'PROJECTION', 'timing': 0.010885, 'cardinality': 1534302, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n#1\n#2\n__internal_compress_integral_uinteger(#3, 1)\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.312594, 'cardinality': 1534302, 'extra_info': 'RIGHT\no_custkey = c_custkey\n\n[INFOSEPARATOR]\nEC: 300000\n', 'children': [{'name': 'FILTER', 'timing': 0.175812, 'cardinality': 1484298, 'extra_info': "(o_comment !~~ '%special%requests%')\n[INFOSEPARATOR]\nEC: 300000", 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.126794, 'cardinality': 1500000, 'extra_info': 'orders\n[INFOSEPARATOR]\no_custkey\no_comment\no_orderkey\n[INFOSEPARATOR]\nEC: 1500000', 'children': []}]}, {'name': 'SEQ_SCAN ', 'timing': 0.00039, 'cardinality': 150000, 'extra_info': 'customer\n[INFOSEPARATOR]\nc_custkey\n[INFOSEPARATOR]\nEC: 150000', 'children': []}]}]}]}]}]}]}]}]}]}]}]}
X {'RESULT_COLLECTOR0': 9e-06, 'ORDER_BY1': 0.000139, 'HASH_GROUP_BY2': 0.012035, 'PROJECTION3': 2.3e-05, 'PROJECTION4': 2.6e-05, 'PROJECTION5': 0.000288, 'HASH_GROUP_BY6': 0.447363, 'PROJECTION7': 0.000971, 'PROJECTION8': 0.010885, 'HASH_JOIN9': 0.312594, 'FILTER10': 0.175812, 'SEQ_SCAN 11': 0.126794, 'SEQ_SCAN 12': 0.00039}
**** output size:  42
LINEAGE_5_FILTER_1
LINEAGE_5_HASH_GROUP_BY_10
LINEAGE_5_HASH_GROUP_BY_6
LINEAGE_5_HASH_JOIN_3
LINEAGE_5_ORDER_BY_11
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_2
SELECT c_count, count(*) AS custdist FROM ( SELECT c_custkey, count(o_orderkey) FROM customer LEFT OUTER JOIN orders ON c_custkey = o_custkey AND o_comment NOT LIKE '%special%requests%' GROUP BY c_custkey) AS c_orders (c_custkey, c_count) GROUP BY c_count ORDER BY custdist DESC, c_count DESC;
compressed filter_log_size: 81153
compressed filter_log_buffer_size: 68140
compressed limit_offset_size: 2464
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 2464
compressed perfect_full_scan_ht_log_buffer_size: 0
compressed perfect_probe_ht_log_size: 2464
compressed perfect_probe_ht_log_buffer_size: 0
compressed row_group_log_size: 9645
compressed row_group_log_buffer_size: 0
compressed scatter_log_size: 6337096
compressed scatter_log_buffer_size: 6323852
compressed scatter_sel_log_size: 701351
compressed scatter_sel_log_buffer_size: 697630
compressed gather_log_size: 2464
compressed gather_log_buffer_size: 0
compressed combine_log_size: 23598962
compressed combine_log_buffer_size: 23589765
compressed finalize_states_log_size: 47076
compressed finalize_states_log_buffer_size: 42460
compressed join_gather_log_size: 6531169
compressed join_gather_log_buffer_size: 6482857
compressed reorder_log_size: 4105
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 2464
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 2464
compressed nlj_log_buffer_size: 0
compressed total_size: 37325341
compressed total_buffer_size: 37204704
compressed total_element_size: 120637

Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│       promo_revenue       │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│    UNGROUPED_AGGREGATE    │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│          sum(#0)          │                             
│          sum(#1)          │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│CASE  WHEN (prefix(p_type, │                             
│      'PROMO')) THEN (     │                             
│(l_extendedprice * (1....  │                             
│     )) ELSE 0.0000 END    │                             
│ (l_extendedprice * (1.00 -│                             
│        l_discount))       │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         HASH_JOIN         │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│           INNER           │                             
│   l_partkey = p_partkey   │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐              
│        Build Min: 1       │              │              
│     Build Max: 200000     │              │              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              
│         EC: 641407        │              │              
└─────────────┬─────────────┘              │                                           
┌─────────────┴─────────────┐┌─────────────┴─────────────┐
│         SEQ_SCAN          ││         SEQ_SCAN          │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│          lineitem         ││            part           │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│         l_partkey         ││         p_partkey         │
│      l_extendedprice      ││           p_type          │
│         l_discount        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││         EC: 200000        │
│ Filters: l_shipdate>='1995││                           │
│-09-01'::DATE AND l_sh...  ││                           │
│  <'1995-10-01'::DATE AND  ││                           │
│   l_shipdate IS NOT NULL  ││                           │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │
│        EC: 1200243        ││                           │
└───────────────────────────┘└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

compressed filter_log_size: 1392
compressed filter_log_buffer_size: 0
compressed limit_offset_size: 1392
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 461885
compressed perfect_full_scan_ht_log_buffer_size: 460109
compressed perfect_probe_ht_log_size: 387627
compressed perfect_probe_ht_log_buffer_size: 343598
compressed row_group_log_size: 301291
compressed row_group_log_buffer_size: 255158
compressed scatter_log_size: 1392
compressed scatter_log_buffer_size: 0
compressed scatter_sel_log_size: 997036
compressed scatter_sel_log_buffer_size: 994097
compressed gather_log_size: 1392
compressed gather_log_buffer_size: 0
compressed combine_log_size: 1392
compressed combine_log_buffer_size: 0
compressed finalize_states_log_size: 1392
compressed finalize_states_log_buffer_size: 0
compressed join_gather_log_size: 1392
compressed join_gather_log_buffer_size: 0
compressed reorder_log_size: 2088
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 1392
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 1392
compressed nlj_log_buffer_size: 0
compressed total_size: 2162455
compressed total_buffer_size: 2052962
compressed total_element_size: 109493

Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                                                          
│         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│__internal_decompress_integ│                                                          
│     ral_bigint(#0, 1)     │                                                          
│             #1            │                                                          
│             #2            │                                                          
│__internal_decompress_strin│                                                          
│           g(#3)           │                                                          
│             #4            │                                                          
└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          
│          ORDER_BY         │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│          ORDERS:          │                                                          
│   supplier.s_suppkey ASC  │                                                          
└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          
│         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│__internal_compress_integra│                                                          
│     l_usmallint(#0, 1)    │                                                          
│             #1            │                                                          
│             #2            │                                                          
│__internal_compress_string_│                                                          
│        hugeint(#3)        │                                                          
│             #4            │                                                          
└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          
│         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│         s_suppkey         │                                                          
│           s_name          │                                                          
│         s_address         │                                                          
│          s_phone          │                                                          
│       total_revenue       │                                                          
└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          
│         HASH_JOIN         │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│           INNER           │                                                          
│  s_suppkey = supplier_no  │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐                                           
│        Build Min: 1       │              │                                           
│      Build Max: 10000     │              │                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                           
│           EC: 4           │              │                                           
└─────────────┬─────────────┘              │                                                                        
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             
│         SEQ_SCAN          ││         HASH_JOIN         │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│          supplier         ││           INNER           │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││  total_revenue = SUBQUERY │                             
│         s_suppkey         ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│           s_name          ││           EC: 3           ├──────────────┐              
│         s_address         ││                           │              │              
│          s_phone          ││                           │              │              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │              │              
│         EC: 10000         ││                           │              │              
└───────────────────────────┘└─────────────┬─────────────┘              │                                           
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
                             │         PROJECTION        ││    UNGROUPED_AGGREGATE    │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                             │__internal_decompress_integ││         first(#0)         │
                             │     ral_bigint(#0, 1)     ││                           │
                             │             #1            ││                           │
                             └─────────────┬─────────────┘└─────────────┬─────────────┘                             
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
                             │       HASH_GROUP_BY       ││         PROJECTION        │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                             │             #0            ││             #0            │
                             │    sum_no_overflow(#1)    ││                           │
                             └─────────────┬─────────────┘└─────────────┬─────────────┘                             
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
                             │         PROJECTION        ││      STREAMING_LIMIT      │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │
                             │         l_suppkey         ││                           │
                             │ (l_extendedprice * (1.00 -││                           │
                             │        l_discount))       ││                           │
                             └─────────────┬─────────────┘└─────────────┬─────────────┘                             
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
                             │         PROJECTION        ││    UNGROUPED_AGGREGATE    │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                             │__internal_compress_integra││          max(#0)          │
                             │     l_usmallint(#0, 1)    ││                           │
                             │             #1            ││                           │
                             │             #2            ││                           │
                             └─────────────┬─────────────┘└─────────────┬─────────────┘                             
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
                             │         SEQ_SCAN          ││         PROJECTION        │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                             │          lineitem         ││       total_revenue       │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │
                             │         l_suppkey         ││                           │
                             │      l_extendedprice      ││                           │
                             │         l_discount        ││                           │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │
                             │ Filters: l_shipdate>='1996││                           │
                             │-01-01'::DATE AND l_sh...  ││                           │
                             │  <'1996-04-01'::DATE AND  ││                           │
                             │   l_shipdate IS NOT NULL  ││                           │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │
                             │        EC: 1200243        ││                           │
                             └───────────────────────────┘└─────────────┬─────────────┘                             
                                                          ┌─────────────┴─────────────┐
                                                          │         PROJECTION        │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │  sum((l_extendedprice *   │
                                                          │(CAST(1 AS DECIMAL(16,2)) -│
                                                          │        l_discount)))      │
                                                          └─────────────┬─────────────┘                             
                                                          ┌─────────────┴─────────────┐
                                                          │         PROJECTION        │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │__internal_decompress_integ│
                                                          │     ral_bigint(#0, 1)     │
                                                          │             #1            │
                                                          └─────────────┬─────────────┘                             
                                                          ┌─────────────┴─────────────┐
                                                          │       HASH_GROUP_BY       │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │             #0            │
                                                          │    sum_no_overflow(#1)    │
                                                          └─────────────┬─────────────┘                             
                                                          ┌─────────────┴─────────────┐
                                                          │         PROJECTION        │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │         l_suppkey         │
                                                          │ (l_extendedprice * (1.00 -│
                                                          │        l_discount))       │
                                                          └─────────────┬─────────────┘                             
                                                          ┌─────────────┴─────────────┐
                                                          │         PROJECTION        │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │__internal_compress_integra│
                                                          │     l_usmallint(#0, 1)    │
                                                          │             #1            │
                                                          │             #2            │
                                                          └─────────────┬─────────────┘                             
                                                          ┌─────────────┴─────────────┐
                                                          │         SEQ_SCAN          │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │          lineitem         │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │         l_suppkey         │
                                                          │      l_extendedprice      │
                                                          │         l_discount        │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │ Filters: l_shipdate>='1996│
                                                          │-01-01'::DATE AND l_sh...  │
                                                          │  <'1996-04-01'::DATE AND  │
                                                          │   l_shipdate IS NOT NULL  │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │        EC: 1200243        │
                                                          └───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

   query_id  ...                                               plan
0         5  ...  {"name": "ORDER_BY", "opid": "11", "children":...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               SELECT c_count, count(*) AS custdist FROM ( SE...
size_bytes_max                                               37325341
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "ORDER_BY", "opid": "11", "children":...
Name: 0, dtype: object
{"name": "ORDER_BY", "opid": "11", "children": [{"name": "HASH_GROUP_BY", "opid": "10", "children": [{"name": "PROJECTION", "opid": "9", "children": [{"name": "PROJECTION", "opid": "8", "children": [{"name": "PROJECTION", "opid": "7", "children": [{"name": "HASH_GROUP_BY", "opid": "6", "children": [{"name": "PROJECTION", "opid": "5", "children": [{"name": "PROJECTION", "opid": "4", "children": [{"name": "HASH_JOIN", "opid": "3", "children": [{"name": "FILTER", "opid": "1", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "orders","extra": "orders\n[INFOSEPARATOR]\no_custkey\no_comment\no_orderkey\n[INFOSEPARATOR]\nEC: 1500000"}],"table": "","extra": "(o_comment !~~ '%special%requests%')\n[INFOSEPARATOR]\nEC: 300000"},{"name": "SEQ_SCAN ", "opid": "2", "children": [],"table": "customer","extra": "customer\n[INFOSEPARATOR]\nc_custkey\n[INFOSEPARATOR]\nEC: 150000"}],"table": "","extra": "RIGHT\no_custkey = c_custkey\n\n[INFOSEPARATOR]\nEC: 300000\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n#1\n#2\n__internal_compress_integral_uinteger(#3, 1)\n"}],"table": "","extra": "c_custkey\no_orderkey\n"}],"table": "","extra": "#0\ncount(#1)"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n#1\n"}],"table": "","extra": "count(o_orderkey)\n"}],"table": "","extra": "c_count\n"}],"table": "","extra": "#0\ncount_star()"}],"table": "","extra": "ORDERS:\ncount_star() DESC\nc_orders.c_count DESC"}
%%%%%%%%%%%%%%%% Running Query #  14  threads:  16
SELECT 100.00 * sum( CASE WHEN p_type LIKE 'PROMO%' THEN l_extendedprice * (1 - l_discount) ELSE 0 END) / sum(l_extendedprice * (1 - l_discount)) AS promo_revenue FROM lineitem, part WHERE l_partkey = p_partkey AND l_shipdate >= date '1995-09-01' AND l_shipdate < CAST('1995-10-01' AS date);
Run:  None SELECT 100.00 * sum( CASE WHEN p_type LIKE 'PROMO%' THEN l_extendedprice * (1 - l_discount) ELSE 0 END) / sum(l_extendedprice * (1 - l_discount)) AS promo_revenue FROM lineitem, part WHERE l_partkey = p_partkey AND l_shipdate >= date '1995-09-01' AND l_shipdate < CAST('1995-10-01' AS date);
Avg Time in sec:  0.05670037679374218  output size:  1
   promo_revenue
0      16.380779
{'name': 'Query', 'result': 0.051806, 'timing': 0.051806, 'cardinality': 0, 'extra-info': "SELECT 100.00 * sum( CASE WHEN p_type LIKE 'PROMO%' THEN l_extendedprice * (1 - l_discount) ELSE 0 END) / sum(l_extendedprice * (1 - l_discount)) AS promo_revenue FROM lineitem, part WHERE l_partkey = p_partkey AND l_shipdate >= date '1995-09-01' AND l_shipdate < CAST('1995-10-01' AS date);", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 4e-06, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 7e-06, 'cardinality': 1, 'extra_info': 'promo_revenue\n', 'children': [{'name': 'UNGROUPED_AGGREGATE', 'timing': 0.000548, 'cardinality': 1, 'extra_info': 'sum(#0)\nsum(#1)', 'children': [{'name': 'PROJECTION', 'timing': 0.00356, 'cardinality': 75983, 'extra_info': "CASE  WHEN (prefix(p_type, 'PROMO')) THEN ((l_extendedprice * (1.00 - l_discount))) ELSE 0.0000 END\n(l_extendedprice * (1.00 - l_discount))\n", 'children': [{'name': 'HASH_JOIN', 'timing': 0.090033, 'cardinality': 75983, 'extra_info': 'INNER\nl_partkey = p_partkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 641407\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.099464, 'cardinality': 75983, 'extra_info': "lineitem\n[INFOSEPARATOR]\nl_partkey\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nFilters: l_shipdate>='1995-09-01'::DATE AND l_shipdate<'1995-10-01'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243", 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 0.006012, 'cardinality': 200000, 'extra_info': 'part\n[INFOSEPARATOR]\np_partkey\np_type\n[INFOSEPARATOR]\nEC: 200000', 'children': []}]}]}]}]}]}]}
X {'RESULT_COLLECTOR0': 4e-06, 'PROJECTION1': 7e-06, 'UNGROUPED_AGGREGATE2': 0.000548, 'PROJECTION3': 0.00356, 'HASH_JOIN4': 0.090033, 'SEQ_SCAN 5': 0.099464, 'SEQ_SCAN 6': 0.006012}
**** output size:  1
LINEAGE_5_HASH_JOIN_2
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_1
SELECT 100.00 * sum( CASE WHEN p_type LIKE 'PROMO%' THEN l_extendedprice * (1 - l_discount) ELSE 0 END) / sum(l_extendedprice * (1 - l_discount)) AS promo_revenue FROM lineitem, part WHERE l_partkey = p_partkey AND l_shipdate >= date '1995-09-01' AND l_shipdate < CAST('1995-10-01' AS date);
   query_id  ...                                               plan
0         5  ...  {"name": "PROJECTION", "opid": "5", "children"...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               SELECT 100.00 * sum( CASE WHEN p_type LIKE 'PR...
size_bytes_max                                                2162455
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "PROJECTION", "opid": "5", "children"...
Name: 0, dtype: object
{"name": "PROJECTION", "opid": "5", "children": [{"name": "UNGROUPED_AGGREGATE", "opid": "4", "children": [{"name": "PROJECTION", "opid": "3", "children": [{"name": "HASH_JOIN", "opid": "2", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_partkey\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nFilters: l_shipdate>='1995-09-01'::DATE AND l_shipdate<'1995-10-01'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243"},{"name": "SEQ_SCAN ", "opid": "1", "children": [],"table": "part","extra": "part\n[INFOSEPARATOR]\np_partkey\np_type\n[INFOSEPARATOR]\nEC: 200000"}],"table": "","extra": "INNER\nl_partkey = p_partkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 641407\n"}],"table": "","extra": "CASE  WHEN (prefix(p_type, 'PROMO')) THEN ((l_extendedprice * (1.00 - l_discount))) ELSE 0.0000 END\n(l_extendedprice * (1.00 - l_discount))\n"}],"table": "","extra": "sum(#0)\nsum(#1)"}],"table": "","extra": "promo_revenue\n"}
%%%%%%%%%%%%%%%% Running Query #  15  threads:  16
with revenue0 (supplier_no, total_revenue) as ( select l_suppkey, sum(l_extendedprice * (1 - l_discount)) from lineitem where l_shipdate >= date '1996-01-01' and l_shipdate < date '1996-01-01' + interval '3' month group by l_suppkey ) SELECT s_suppkey, s_name, s_address, s_phone, total_revenue FROM supplier, revenue0 WHERE s_suppkey = supplier_no AND total_revenue = ( SELECT max(total_revenue) FROM revenue0) ORDER BY s_suppkey;
Run:  None with revenue0 (supplier_no, total_revenue) as ( select l_suppkey, sum(l_extendedprice * (1 - l_discount)) from lineitem where l_shipdate >= date '1996-01-01' and l_shipdate < date '1996-01-01' + interval '3' month group by l_suppkey ) SELECT s_suppkey, s_name, s_address, s_phone, total_revenue FROM supplier, revenue0 WHERE s_suppkey = supplier_no AND total_revenue = ( SELECT max(total_revenue) FROM revenue0) ORDER BY s_suppkey;
Avg Time in sec:  0.055339223239570856  output size:  1
   s_suppkey              s_name  ...          s_phone total_revenue
0       8449  Supplier#000008449  ...  20-469-856-8873  1.772627e+06

[1 rows x 5 columns]
{'name': 'Query', 'result': 0.034023, 'timing': 0.034023, 'cardinality': 0, 'extra-info': "with revenue0 (supplier_no, total_revenue) as ( select l_suppkey, sum(l_extendedprice * (1 - l_discount)) from lineitem where l_shipdate >= date '1996-01-01' and l_shipdate < date '1996-01-01' + interval '3' month group by l_suppkey ) SELECT s_suppkey, s_name, s_address, s_phone, total_revenue FROM supplier, revenue0 WHERE s_suppkey = supplier_no AND total_revenue = ( SELECT max(total_revenue) FROM revenue0) ORDER BY s_suppkey;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 1.2e-05, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 3e-06, 'cardinality': 1, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n#1\n#2\n__internal_decompress_string(#3)\n#4\n', 'children': [{'name': 'ORDER_BY', 'timing': 3.2e-05, 'cardinality': 1, 'extra_info': 'ORDERS:\nsupplier.s_suppkey ASC', 'children': [{'name': 'PROJECTION', 'timing': 6e-06, 'cardinality': 1, 'extra_info': '__internal_compress_integral_usmallint(#0, 1)\n#1\n#2\n__internal_compress_string_hugeint(#3)\n#4\n', 'children': [{'name': 'PROJECTION', 'timing': 1e-06, 'cardinality': 1, 'extra_info': 's_suppkey\ns_name\ns_address\ns_phone\ntotal_revenue\n', 'children': [{'name': 'HASH_JOIN', 'timing': 8e-05, 'cardinality': 1, 'extra_info': 'INNER\ns_suppkey = supplier_no\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 4\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.000578, 'cardinality': 10000, 'extra_info': 'supplier\n[INFOSEPARATOR]\ns_suppkey\ns_name\ns_address\ns_phone\n[INFOSEPARATOR]\nEC: 10000', 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.000282, 'cardinality': 1, 'extra_info': 'INNER\ntotal_revenue = SUBQUERY\n\n[INFOSEPARATOR]\nEC: 3\n', 'children': [{'name': 'PROJECTION', 'timing': 5.5e-05, 'cardinality': 10000, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n#1\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.084281, 'cardinality': 10000, 'extra_info': '#0\nsum_no_overflow(#1)', 'children': [{'name': 'PROJECTION', 'timing': 0.021676, 'cardinality': 225954, 'extra_info': 'l_suppkey\n(l_extendedprice * (1.00 - l_discount))\n', 'children': [{'name': 'PROJECTION', 'timing': 0.010474, 'cardinality': 225954, 'extra_info': '__internal_compress_integral_usmallint(#0, 1)\n#1\n#2\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.08756, 'cardinality': 225954, 'extra_info': "lineitem\n[INFOSEPARATOR]\nl_suppkey\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nFilters: l_shipdate>='1996-01-01'::DATE AND l_shipdate<'1996-04-01'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243", 'children': []}]}]}]}]}, {'name': 'UNGROUPED_AGGREGATE', 'timing': 3e-06, 'cardinality': 1, 'extra_info': 'first(#0)', 'children': [{'name': 'PROJECTION', 'timing': 1e-06, 'cardinality': 1, 'extra_info': '#0\n', 'children': [{'name': 'STREAMING_LIMIT', 'timing': 2e-06, 'cardinality': 1, 'extra_info': '', 'children': [{'name': 'UNGROUPED_AGGREGATE', 'timing': 3.5e-05, 'cardinality': 1, 'extra_info': 'max(#0)', 'children': [{'name': 'PROJECTION', 'timing': 5e-06, 'cardinality': 10000, 'extra_info': 'total_revenue\n', 'children': [{'name': 'PROJECTION', 'timing': 4e-06, 'cardinality': 10000, 'extra_info': 'sum((l_extendedprice * (CAST(1 AS DECIMAL(16,2)) - l_discount)))\n', 'children': [{'name': 'PROJECTION', 'timing': 4.7e-05, 'cardinality': 10000, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n#1\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.082967, 'cardinality': 10000, 'extra_info': '#0\nsum_no_overflow(#1)', 'children': [{'name': 'PROJECTION', 'timing': 0.022963, 'cardinality': 225954, 'extra_info': 'l_suppkey\n(l_extendedprice * (1.00 - l_discount))\n', 'children': [{'name': 'PROJECTION', 'timing': 0.010836, 'cardinality': 225954, 'extra_info': '__internal_compress_integral_usmallint(#0, 1)\n#1\n#2\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.089825, 'cardinality': 225954, 'extra_info': "lineitem\n[INFOSEPARATOR]\nl_suppkey\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nFilters: l_shipdate>='1996-01-01'::DATE AND l_shipdate<'1996-04-01'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243", 'children': []}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}
compressed filter_log_size: 3376
compressed filter_log_buffer_size: 0
compressed limit_offset_size: 3520
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 3776
compressed perfect_full_scan_ht_log_buffer_size: 16
compressed perfect_probe_ht_log_size: 3768
compressed perfect_probe_ht_log_buffer_size: 8
compressed row_group_log_size: 882716
compressed row_group_log_buffer_size: 792972
compressed scatter_log_size: 1965581
compressed scatter_log_buffer_size: 1932627
compressed scatter_sel_log_size: 3872
compressed scatter_sel_log_buffer_size: 16
compressed gather_log_size: 3376
compressed gather_log_buffer_size: 0
compressed combine_log_size: 5169172
compressed combine_log_buffer_size: 5162175
compressed finalize_states_log_size: 9210
compressed finalize_states_log_buffer_size: 3530
compressed join_gather_log_size: 3820
compressed join_gather_log_buffer_size: 12
compressed reorder_log_size: 5144
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 3376
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 3376
compressed nlj_log_buffer_size: 0
compressed total_size: 8064083
compressed total_buffer_size: 7891356
compressed total_element_size: 172727

Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│__internal_decompress_strin│                                                                                       
│           g(#0)           │                                                                                       
│             #1            │                                                                                       
│__internal_decompress_integ│                                                                                       
│     ral_integer(#2, 1)    │                                                                                       
│             #3            │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│          ORDER_BY         │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│          ORDERS:          │                                                                                       
│  count(DISTINCT partsupp  │                                                                                       
│     .ps_suppkey) DESC     │                                                                                       
│      part.p_brand ASC     │                                                                                       
│      part.p_type ASC      │                                                                                       
│      part.p_size ASC      │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│__internal_compress_string_│                                                                                       
│        hugeint(#0)        │                                                                                       
│             #1            │                                                                                       
│__internal_compress_integra│                                                                                       
│     l_utinyint(#2, 1)     │                                                                                       
│             #3            │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│__internal_decompress_strin│                                                                                       
│           g(#0)           │                                                                                       
│             #1            │                                                                                       
│__internal_decompress_integ│                                                                                       
│     ral_integer(#2, 1)    │                                                                                       
│             #3            │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│       HASH_GROUP_BY       │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│             #0            │                                                                                       
│             #1            │                                                                                       
│             #2            │                                                                                       
│     count(DISTINCT #3)    │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│          p_brand          │                                                                                       
│           p_type          │                                                                                       
│           p_size          │                                                                                       
│         ps_suppkey        │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│             #0            │                                                                                       
│__internal_compress_string_│                                                                                       
│        hugeint(#1)        │                                                                                       
│             #2            │                                                                                       
│__internal_compress_integra│                                                                                       
│     l_utinyint(#3, 1)     │                                                                                       
│             #4            │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│             #1            │                                                                                       
│             #3            │                                                                                       
│             #4            │                                                                                       
│             #5            │                                                                                       
│             #6            │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│           FILTER          │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│       (NOT SUBQUERY)      │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│         EC: 33778         │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         HASH_JOIN         │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│            MARK           │                                                                                       
│      ps_suppkey = #0      ├────────────────────────────────────────────────────────────────────────┐              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                        │              
│         EC: 168893        │                                                                        │              
└─────────────┬─────────────┘                                                                        │                                           
┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐
│         HASH_JOIN         │                                                          │         PROJECTION        │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│           INNER           │                                                          │         s_suppkey         │
│   ps_partkey = p_partkey  │                                                          │                           │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐                                           │                           │
│        Build Min: 1       │              │                                           │                           │
│     Build Max: 200000     │              │                                           │                           │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                           │                           │
│         EC: 168893        │              │                                           │                           │
└─────────────┬─────────────┘              │                                           └─────────────┬─────────────┘                             
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐
│         SEQ_SCAN          ││           FILTER          │                             │           FILTER          │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│          partsupp         ││ (IN (...) AND (p_brand != │                             │  (s_comment ~~ '%Customer │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││'Brand#45') AND (NOT prefix│                             │       %Complaints%')      │
│         ps_partkey        ││(p_type, 'MEDIUM POLIS...  │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│         ps_suppkey        ││             )             │                             │          EC: 2000         │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │                           │
│         EC: 800000        ││         EC: 40000         │                             │                           │
└───────────────────────────┘└─────────────┬─────────────┘                             └─────────────┬─────────────┘                             
                             ┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐
                             │         HASH_JOIN         │                             │         SEQ_SCAN          │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                             │            MARK           │                             │          supplier         │
                             │        p_size = #0        │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐              │         s_comment         │
                             │         EC: 200000        │              │              │         s_suppkey         │
                             │                           │              │              │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                             │                           │              │              │         EC: 10000         │
                             └─────────────┬─────────────┘              │              └───────────────────────────┘                             
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             
                             │         SEQ_SCAN          ││      COLUMN_DATA_SCAN     │                             
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                             
                             │            part           ││                           │                             
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                             
                             │         p_partkey         ││                           │                             
                             │          p_brand          ││                           │                             
                             │           p_type          ││                           │                             
                             │           p_size          ││                           │                             
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                             
                             │         EC: 200000        ││                           │                             
                             └───────────────────────────┘└───────────────────────────┘                                                          

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

X {'RESULT_COLLECTOR0': 1.2e-05, 'PROJECTION1': 3e-06, 'ORDER_BY2': 3.2e-05, 'PROJECTION3': 6e-06, 'PROJECTION4': 1e-06, 'HASH_JOIN5': 8e-05, 'SEQ_SCAN 6': 0.000578, 'HASH_JOIN7': 0.000282, 'PROJECTION8': 5.5e-05, 'HASH_GROUP_BY9': 0.084281, 'PROJECTION10': 0.021676, 'PROJECTION11': 0.010474, 'SEQ_SCAN 12': 0.08756, 'UNGROUPED_AGGREGATE13': 3e-06, 'PROJECTION14': 1e-06, 'STREAMING_LIMIT15': 2e-06, 'UNGROUPED_AGGREGATE16': 3.5e-05, 'PROJECTION17': 5e-06, 'PROJECTION18': 4e-06, 'PROJECTION19': 4.7e-05, 'HASH_GROUP_BY20': 0.082967, 'PROJECTION21': 0.022963, 'PROJECTION22': 0.010836, 'SEQ_SCAN 23': 0.089825}
**** output size:  1
LINEAGE_5_HASH_GROUP_BY_4
LINEAGE_5_HASH_GROUP_BY_9
LINEAGE_5_HASH_JOIN_17
LINEAGE_5_HASH_JOIN_18
LINEAGE_5_ORDER_BY_21
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_1
LINEAGE_5_SEQ_SCAN_6
LINEAGE_5_STREAMING_LIMIT_14
with revenue0 (supplier_no, total_revenue) as ( select l_suppkey, sum(l_extendedprice * (1 - l_discount)) from lineitem where l_shipdate >= date '1996-01-01' and l_shipdate < date '1996-01-01' + interval '3' month group by l_suppkey ) SELECT s_suppkey, s_name, s_address, s_phone, total_revenue FROM supplier, revenue0 WHERE s_suppkey = supplier_no AND total_revenue = ( SELECT max(total_revenue) FROM revenue0) ORDER BY s_suppkey;
   query_id  ...                                               plan
0         5  ...  {"name": "PROJECTION", "opid": "22", "children...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               with revenue0 (supplier_no, total_revenue) as ...
size_bytes_max                                                8064083
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "PROJECTION", "opid": "22", "children...
Name: 0, dtype: object
{"name": "PROJECTION", "opid": "22", "children": [{"name": "ORDER_BY", "opid": "21", "children": [{"name": "PROJECTION", "opid": "20", "children": [{"name": "PROJECTION", "opid": "19", "children": [{"name": "HASH_JOIN", "opid": "18", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "supplier","extra": "supplier\n[INFOSEPARATOR]\ns_suppkey\ns_name\ns_address\ns_phone\n[INFOSEPARATOR]\nEC: 10000"},{"name": "HASH_JOIN", "opid": "17", "children": [{"name": "PROJECTION", "opid": "5", "children": [{"name": "HASH_GROUP_BY", "opid": "4", "children": [{"name": "PROJECTION", "opid": "3", "children": [{"name": "PROJECTION", "opid": "2", "children": [{"name": "SEQ_SCAN ", "opid": "1", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_suppkey\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nFilters: l_shipdate>='1996-01-01'::DATE AND l_shipdate<'1996-04-01'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243"}],"table": "","extra": "__internal_compress_integral_usmallint(#0, 1)\n#1\n#2\n"}],"table": "","extra": "l_suppkey\n(l_extendedprice * (1.00 - l_discount))\n"}],"table": "","extra": "#0\nsum_no_overflow(#1)"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n#1\n"},{"name": "UNGROUPED_AGGREGATE", "opid": "16", "children": [{"name": "PROJECTION", "opid": "15", "children": [{"name": "STREAMING_LIMIT", "opid": "14", "children": [{"name": "UNGROUPED_AGGREGATE", "opid": "13", "children": [{"name": "PROJECTION", "opid": "12", "children": [{"name": "PROJECTION", "opid": "11", "children": [{"name": "PROJECTION", "opid": "10", "children": [{"name": "HASH_GROUP_BY", "opid": "9", "children": [{"name": "PROJECTION", "opid": "8", "children": [{"name": "PROJECTION", "opid": "7", "children": [{"name": "SEQ_SCAN ", "opid": "6", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_suppkey\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nFilters: l_shipdate>='1996-01-01'::DATE AND l_shipdate<'1996-04-01'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243"}],"table": "","extra": "__internal_compress_integral_usmallint(#0, 1)\n#1\n#2\n"}],"table": "","extra": "l_suppkey\n(l_extendedprice * (1.00 - l_discount))\n"}],"table": "","extra": "#0\nsum_no_overflow(#1)"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n#1\n"}],"table": "","extra": "sum((l_extendedprice * (CAST(1 AS DECIMAL(16,2)) - l_discount)))\n"}],"table": "","extra": "total_revenue\n"}],"table": "","extra": "max(#0)"}],"table": "","extra": ""}],"table": "","extra": "#0\n"}],"table": "","extra": "first(#0)"}],"table": "","extra": "INNER\ntotal_revenue = SUBQUERY\n\n[INFOSEPARATOR]\nEC: 3\n"}],"table": "","extra": "INNER\ns_suppkey = supplier_no\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 4\n"}],"table": "","extra": "s_suppkey\ns_name\ns_address\ns_phone\ntotal_revenue\n"}],"table": "","extra": "__internal_compress_integral_usmallint(#0, 1)\n#1\n#2\n__internal_compress_string_hugeint(#3)\n#4\n"}],"table": "","extra": "ORDERS:\nsupplier.s_suppkey ASC"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n#1\n#2\n__internal_decompress_string(#3)\n#4\n"}
%%%%%%%%%%%%%%%% Running Query #  16  threads:  16
SELECT p_brand, p_type, p_size, count(DISTINCT ps_suppkey) AS supplier_cnt FROM partsupp, part WHERE p_partkey = ps_partkey AND p_brand <> 'Brand#45' AND p_type NOT LIKE 'MEDIUM POLISHED%' AND p_size IN (49, 14, 23, 45, 19, 3, 36, 9) AND ps_suppkey NOT IN ( SELECT s_suppkey FROM supplier WHERE s_comment LIKE '%Customer%Complaints%') GROUP BY p_brand, p_type, p_size ORDER BY supplier_cnt DESC, p_brand, p_type, p_size;
Run:  None SELECT p_brand, p_type, p_size, count(DISTINCT ps_suppkey) AS supplier_cnt FROM partsupp, part WHERE p_partkey = ps_partkey AND p_brand <> 'Brand#45' AND p_type NOT LIKE 'MEDIUM POLISHED%' AND p_size IN (49, 14, 23, 45, 19, 3, 36, 9) AND ps_suppkey NOT IN ( SELECT s_suppkey FROM supplier WHERE s_comment LIKE '%Customer%Complaints%') GROUP BY p_brand, p_type, p_size ORDER BY supplier_cnt DESC, p_brand, p_type, p_size;
Avg Time in sec:  0.08213766803964972  output size:  18314
        p_brand                    p_type  p_size  supplier_cnt
0      Brand#41        MEDIUM BRUSHED TIN       3            28
1      Brand#54   STANDARD BRUSHED COPPER      14            27
2      Brand#11      STANDARD BRUSHED TIN      23            24
3      Brand#11  STANDARD BURNISHED BRASS      36            24
4      Brand#15    MEDIUM ANODIZED NICKEL       3            24
...         ...                       ...     ...           ...
18309  Brand#52      MEDIUM BRUSHED BRASS      45             3
18310  Brand#53        MEDIUM BRUSHED TIN      45             3
18311  Brand#54    ECONOMY POLISHED BRASS       9             3
18312  Brand#55        PROMO PLATED BRASS      19             3
18313  Brand#55       STANDARD PLATED TIN      49             3

[18314 rows x 4 columns]
{'name': 'Query', 'result': 0.076279, 'timing': 0.076279, 'cardinality': 0, 'extra-info': "SELECT p_brand, p_type, p_size, count(DISTINCT ps_suppkey) AS supplier_cnt FROM partsupp, part WHERE p_partkey = ps_partkey AND p_brand <> 'Brand#45' AND p_type NOT LIKE 'MEDIUM POLISHED%' AND p_size IN (49, 14, 23, 45, 19, 3, 36, 9) AND ps_suppkey NOT IN ( SELECT s_suppkey FROM supplier WHERE s_comment LIKE '%Customer%Complaints%') GROUP BY p_brand, p_type, p_size ORDER BY supplier_cnt DESC, p_brand, p_type, p_size;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 0.001428, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 0.000398, 'cardinality': 18314, 'extra_info': '__internal_decompress_string(#0)\n#1\n__internal_decompress_integral_integer(#2, 1)\n#3\n', 'children': [{'name': 'ORDER_BY', 'timing': 0.007189, 'cardinality': 18314, 'extra_info': 'ORDERS:\ncount(DISTINCT partsupp.ps_suppkey) DESC\npart.p_brand ASC\npart.p_type ASC\npart.p_size ASC', 'children': [{'name': 'PROJECTION', 'timing': 0.000397, 'cardinality': 18314, 'extra_info': '__internal_compress_string_hugeint(#0)\n#1\n__internal_compress_integral_utinyint(#2, 1)\n#3\n', 'children': [{'name': 'PROJECTION', 'timing': 0.000695, 'cardinality': 18314, 'extra_info': '__internal_decompress_string(#0)\n#1\n__internal_decompress_integral_integer(#2, 1)\n#3\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.07, 'cardinality': 18314, 'extra_info': '#0\n#1\n#2\ncount(DISTINCT #3)', 'children': [{'name': 'PROJECTION', 'timing': 0.000385, 'cardinality': 118274, 'extra_info': 'p_brand\np_type\np_size\nps_suppkey\n', 'children': [{'name': 'PROJECTION', 'timing': 0.005374, 'cardinality': 118274, 'extra_info': '#0\n__internal_compress_string_hugeint(#1)\n#2\n__internal_compress_integral_utinyint(#3, 1)\n#4\n', 'children': [{'name': 'PROJECTION', 'timing': 0.000518, 'cardinality': 118274, 'extra_info': '#1\n#3\n#4\n#5\n#6\n', 'children': [{'name': 'FILTER', 'timing': 0.002384, 'cardinality': 118274, 'extra_info': '(NOT SUBQUERY)\n[INFOSEPARATOR]\nEC: 33778', 'children': [{'name': 'HASH_JOIN', 'timing': 0.008958, 'cardinality': 118324, 'extra_info': 'MARK\nps_suppkey = #0\n\n[INFOSEPARATOR]\nEC: 168893\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.021471, 'cardinality': 118324, 'extra_info': 'INNER\nps_partkey = p_partkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 168893\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.003062, 'cardinality': 800000, 'extra_info': 'partsupp\n[INFOSEPARATOR]\nps_partkey\nps_suppkey\n[INFOSEPARATOR]\nEC: 800000', 'children': []}, {'name': 'FILTER', 'timing': 0.008217, 'cardinality': 29581, 'extra_info': "(IN (...) AND (p_brand != 'Brand#45') AND (NOT prefix(p_type, 'MEDIUM POLISHED')))\n[INFOSEPARATOR]\nEC: 40000", 'children': [{'name': 'HASH_JOIN', 'timing': 0.002739, 'cardinality': 200000, 'extra_info': 'MARK\np_size = #0\n\n[INFOSEPARATOR]\nEC: 200000\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.010266, 'cardinality': 200000, 'extra_info': 'part\n[INFOSEPARATOR]\np_partkey\np_brand\np_type\np_size\n[INFOSEPARATOR]\nEC: 200000', 'children': []}, {'name': 'COLUMN_DATA_SCAN', 'timing': 1.2e-05, 'cardinality': 8, 'extra_info': '', 'children': []}]}]}]}, {'name': 'PROJECTION', 'timing': 1e-06, 'cardinality': 4, 'extra_info': 's_suppkey\n', 'children': [{'name': 'FILTER', 'timing': 0.000257, 'cardinality': 4, 'extra_info': "(s_comment ~~ '%Customer%Complaints%')\n[INFOSEPARATOR]\nEC: 2000", 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.000276, 'cardinality': 10000, 'extra_info': 'supplier\n[INFOSEPARATOR]\ns_comment\ns_suppkey\n[INFOSEPARATOR]\nEC: 10000', 'children': []}]}]}]}]}]}]}]}]}]}]}]}]}]}]}
compressed filter_log_size: 34195
compressed filter_log_buffer_size: 26242
compressed limit_offset_size: 2160
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 85471
compressed perfect_full_scan_ht_log_buffer_size: 82927
compressed perfect_probe_ht_log_size: 225122
compressed perfect_probe_ht_log_buffer_size: 215058
compressed row_group_log_size: 6915
compressed row_group_log_buffer_size: 0
compressed scatter_log_size: 477208
compressed scatter_log_buffer_size: 472256
compressed scatter_sel_log_size: 155825
compressed scatter_sel_log_buffer_size: 151689
compressed gather_log_size: 2160
compressed gather_log_buffer_size: 0
compressed combine_log_size: 1785129
compressed combine_log_buffer_size: 1781521
compressed finalize_states_log_size: 6631
compressed finalize_states_log_buffer_size: 3315
compressed join_gather_log_size: 2160
compressed join_gather_log_buffer_size: 0
compressed reorder_log_size: 35471
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 2160
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 2160
compressed nlj_log_buffer_size: 0
compressed total_size: 2822767
compressed total_buffer_size: 2733008
compressed total_element_size: 89759

Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                                                                                                                    
│         PROJECTION        │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│         avg_yearly        │                                                                                                                    
└─────────────┬─────────────┘                                                                                                                                                 
┌─────────────┴─────────────┐                                                                                                                    
│    UNGROUPED_AGGREGATE    │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│          sum(#0)          │                                                                                                                    
└─────────────┬─────────────┘                                                                                                                                                 
┌─────────────┴─────────────┐                                                                                                                    
│         PROJECTION        │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│      l_extendedprice      │                                                                                                                    
└─────────────┬─────────────┘                                                                                                                                                 
┌─────────────┴─────────────┐                                                                                                                    
│         PROJECTION        │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│             #0            │                                                                                                                    
│             #3            │                                                                                                                    
│             #4            │                                                                                                                    
└─────────────┬─────────────┘                                                                                                                                                 
┌─────────────┴─────────────┐                                                                                                                    
│           FILTER          │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│(CAST(l_quantity AS DOUBLE)│                                                                                                                    
│         < SUBQUERY)       │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│        EC: 3000607        │                                                                                                                    
└─────────────┬─────────────┘                                                                                                                                                 
┌─────────────┴─────────────┐                                                                                                                    
│      RIGHT_DELIM_JOIN     │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│           RIGHT           │                                                                                                                    
│ p_partkey IS NOT DISTINCT ├───────────────────────────────────────────┐                                                                        
│       FROM p_partkey      │                                           │                                                                        
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                           │                                                                        
│        EC: 3000607        │                                           │                                                                        
└─────────────┬─────────────┘                                           │                                                                                                     
┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐                                                          
│         HASH_JOIN         │                             │         HASH_JOIN         │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│           INNER           │                             │           RIGHT           │                                                          
│   l_partkey = p_partkey   │                             │ p_partkey IS NOT DISTINCT │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐              │       FROM p_partkey      ├───────────────────────────────────────────┐              
│        Build Min: 1       │              │              │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                           │              
│     Build Max: 200000     │              │              │        EC: 3000607        │                                           │              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              │                           │                                           │              
│         EC: 80175         │              │              │                           │                                           │              
└─────────────┬─────────────┘              │              └─────────────┬─────────────┘                                           │                                           
┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐
│         SEQ_SCAN          ││         SEQ_SCAN          ││         PROJECTION        │                             │         DUMMY_SCAN        │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │                           │
│          lineitem         ││            part           ││  (0.2 * avg(l_quantity))  │                             │                           │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││         p_partkey         │                             │                           │
│         l_partkey         ││         p_partkey         ││                           │                             │                           │
│         l_quantity        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                             │                           │
│      l_extendedprice      ││Filters: p_brand='Brand#23'││                           │                             │                           │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   AND p_brand IS NOT NULL ││                           │                             │                           │
│        EC: 6001215        ││ p_container='MED BOX' AND ││                           │                             │                           │
│                           ││   p_container IS NOT NULL ││                           │                             │                           │
│                           ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                             │                           │
│                           ││          EC: 5000         ││                           │                             │                           │
└───────────────────────────┘└───────────────────────────┘└─────────────┬─────────────┘                             └───────────────────────────┘                             
                                                          ┌─────────────┴─────────────┐                                                          
                                                          │         PROJECTION        │                                                          
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                          │__internal_decompress_integ│                                                          
                                                          │     ral_bigint(#0, 1)     │                                                          
                                                          │             #1            │                                                          
                                                          └─────────────┬─────────────┘                                                                                       
                                                          ┌─────────────┴─────────────┐                                                          
                                                          │       HASH_GROUP_BY       │                                                          
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                          │             #0            │                                                          
                                                          │          avg(#1)          │                                                          
                                                          └─────────────┬─────────────┘                                                                                       
                                                          ┌─────────────┴─────────────┐                                                          
                                                          │         PROJECTION        │                                                          
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                          │         p_partkey         │                                                          
                                                          │         l_quantity        │                                                          
                                                          └─────────────┬─────────────┘                                                                                       
                                                          ┌─────────────┴─────────────┐                                                          
                                                          │         PROJECTION        │                                                          
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                          │__internal_compress_integra│                                                          
                                                          │     l_uinteger(#0, 1)     │                                                          
                                                          │             #1            │                                                          
                                                          │             #2            │                                                          
                                                          └─────────────┬─────────────┘                                                                                       
                                                          ┌─────────────┴─────────────┐                                                          
                                                          │         HASH_JOIN         │                                                          
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                          │           INNER           │                                                          
                                                          │   l_partkey = p_partkey   ├──────────────┐                                           
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                           
                                                          │        EC: 6001215        │              │                                           
                                                          └─────────────┬─────────────┘              │                                                                        
                                                          ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             
                                                          │         SEQ_SCAN          ││         DELIM_SCAN        │                             
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                             
                                                          │          lineitem         ││                           │                             
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                             
                                                          │         l_partkey         ││                           │                             
                                                          │         l_quantity        ││                           │                             
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                             
                                                          │        EC: 6001215        ││                           │                             
                                                          └───────────────────────────┘└───────────────────────────┘                                                          

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

X {'RESULT_COLLECTOR0': 0.001428, 'PROJECTION1': 0.000398, 'ORDER_BY2': 0.007189, 'PROJECTION3': 0.000397, 'PROJECTION4': 0.000695, 'HASH_GROUP_BY5': 0.07, 'PROJECTION6': 0.000385, 'PROJECTION7': 0.005374, 'PROJECTION8': 0.000518, 'FILTER9': 0.002384, 'HASH_JOIN10': 0.008958, 'HASH_JOIN11': 0.021471, 'SEQ_SCAN 12': 0.003062, 'FILTER13': 0.008217, 'HASH_JOIN14': 0.002739, 'SEQ_SCAN 15': 0.010266, 'COLUMN_DATA_SCAN16': 1.2e-05, 'PROJECTION17': 1e-06, 'FILTER18': 0.000257, 'SEQ_SCAN 19': 0.000276}
**** output size:  18314
LINEAGE_5_COLUMN_DATA_SCAN_2
LINEAGE_5_FILTER_10
LINEAGE_5_FILTER_4
LINEAGE_5_FILTER_7
LINEAGE_5_HASH_GROUP_BY_14
LINEAGE_5_HASH_JOIN_3
LINEAGE_5_HASH_JOIN_5
LINEAGE_5_HASH_JOIN_9
LINEAGE_5_ORDER_BY_17
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_1
LINEAGE_5_SEQ_SCAN_6
SELECT p_brand, p_type, p_size, count(DISTINCT ps_suppkey) AS supplier_cnt FROM partsupp, part WHERE p_partkey = ps_partkey AND p_brand <> 'Brand#45' AND p_type NOT LIKE 'MEDIUM POLISHED%' AND p_size IN (49, 14, 23, 45, 19, 3, 36, 9) AND ps_suppkey NOT IN ( SELECT s_suppkey FROM supplier WHERE s_comment LIKE '%Customer%Complaints%') GROUP BY p_brand, p_type, p_size ORDER BY supplier_cnt DESC, p_brand, p_type, p_size;
   query_id  ...                                               plan
0         5  ...  {"name": "PROJECTION", "opid": "18", "children...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               SELECT p_brand, p_type, p_size, count(DISTINCT...
size_bytes_max                                                2822767
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "PROJECTION", "opid": "18", "children...
Name: 0, dtype: object
{"name": "PROJECTION", "opid": "18", "children": [{"name": "ORDER_BY", "opid": "17", "children": [{"name": "PROJECTION", "opid": "16", "children": [{"name": "PROJECTION", "opid": "15", "children": [{"name": "HASH_GROUP_BY", "opid": "14", "children": [{"name": "PROJECTION", "opid": "13", "children": [{"name": "PROJECTION", "opid": "12", "children": [{"name": "PROJECTION", "opid": "11", "children": [{"name": "FILTER", "opid": "10", "children": [{"name": "HASH_JOIN", "opid": "9", "children": [{"name": "HASH_JOIN", "opid": "5", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "partsupp","extra": "partsupp\n[INFOSEPARATOR]\nps_partkey\nps_suppkey\n[INFOSEPARATOR]\nEC: 800000"},{"name": "FILTER", "opid": "4", "children": [{"name": "HASH_JOIN", "opid": "3", "children": [{"name": "SEQ_SCAN ", "opid": "1", "children": [],"table": "part","extra": "part\n[INFOSEPARATOR]\np_partkey\np_brand\np_type\np_size\n[INFOSEPARATOR]\nEC: 200000"},{"name": "COLUMN_DATA_SCAN", "opid": "2", "children": [],"table": "","extra": ""}],"table": "","extra": "MARK\np_size = #0\n\n[INFOSEPARATOR]\nEC: 200000\n"}],"table": "","extra": "(IN (...) AND (p_brand != 'Brand#45') AND (NOT prefix(p_type, 'MEDIUM POLISHED')))\n[INFOSEPARATOR]\nEC: 40000"}],"table": "","extra": "INNER\nps_partkey = p_partkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 168893\n"},{"name": "PROJECTION", "opid": "8", "children": [{"name": "FILTER", "opid": "7", "children": [{"name": "SEQ_SCAN ", "opid": "6", "children": [],"table": "supplier","extra": "supplier\n[INFOSEPARATOR]\ns_comment\ns_suppkey\n[INFOSEPARATOR]\nEC: 10000"}],"table": "","extra": "(s_comment ~~ '%Customer%Complaints%')\n[INFOSEPARATOR]\nEC: 2000"}],"table": "","extra": "s_suppkey\n"}],"table": "","extra": "MARK\nps_suppkey = #0\n\n[INFOSEPARATOR]\nEC: 168893\n"}],"table": "","extra": "(NOT SUBQUERY)\n[INFOSEPARATOR]\nEC: 33778"}],"table": "","extra": "#1\n#3\n#4\n#5\n#6\n"}],"table": "","extra": "#0\n__internal_compress_string_hugeint(#1)\n#2\n__internal_compress_integral_utinyint(#3, 1)\n#4\n"}],"table": "","extra": "p_brand\np_type\np_size\nps_suppkey\n"}],"table": "","extra": "#0\n#1\n#2\ncount(DISTINCT #3)"}],"table": "","extra": "__internal_decompress_string(#0)\n#1\n__internal_decompress_integral_integer(#2, 1)\n#3\n"}],"table": "","extra": "__internal_compress_string_hugeint(#0)\n#1\n__internal_compress_integral_utinyint(#2, 1)\n#3\n"}],"table": "","extra": "ORDERS:\ncount(DISTINCT partsupp.ps_suppkey) DESC\npart.p_brand ASC\npart.p_type ASC\npart.p_size ASC"}],"table": "","extra": "__internal_decompress_string(#0)\n#1\n__internal_decompress_integral_integer(#2, 1)\n#3\n"}
%%%%%%%%%%%%%%%% Running Query #  17  threads:  16
SELECT sum(l_extendedprice) / 7.0 AS avg_yearly FROM lineitem, part WHERE p_partkey = l_partkey AND p_brand = 'Brand#23' AND p_container = 'MED BOX' AND l_quantity < ( SELECT 0.2 * avg(l_quantity) FROM lineitem WHERE l_partkey = p_partkey);
Run:  None SELECT sum(l_extendedprice) / 7.0 AS avg_yearly FROM lineitem, part WHERE p_partkey = l_partkey AND p_brand = 'Brand#23' AND p_container = 'MED BOX' AND l_quantity < ( SELECT 0.2 * avg(l_quantity) FROM lineitem WHERE l_partkey = p_partkey);
Avg Time in sec:  0.04910630779340863  output size:  1
      avg_yearly
0  348406.054286
{'name': 'Query', 'result': 0.038462, 'timing': 0.038462, 'cardinality': 0, 'extra-info': "SELECT sum(l_extendedprice) / 7.0 AS avg_yearly FROM lineitem, part WHERE p_partkey = l_partkey AND p_brand = 'Brand#23' AND p_container = 'MED BOX' AND l_quantity < ( SELECT 0.2 * avg(l_quantity) FROM lineitem WHERE l_partkey = p_partkey);", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 4e-06, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 4e-06, 'cardinality': 1, 'extra_info': 'avg_yearly\n', 'children': [{'name': 'UNGROUPED_AGGREGATE', 'timing': 1.7e-05, 'cardinality': 1, 'extra_info': 'sum(#0)', 'children': [{'name': 'PROJECTION', 'timing': 2e-06, 'cardinality': 587, 'extra_info': 'l_extendedprice\n', 'children': [{'name': 'PROJECTION', 'timing': 7e-06, 'cardinality': 587, 'extra_info': '#0\n#3\n#4\n', 'children': [{'name': 'FILTER', 'timing': 0.000269, 'cardinality': 587, 'extra_info': '(CAST(l_quantity AS DOUBLE) < SUBQUERY)\n[INFOSEPARATOR]\nEC: 3000607', 'children': [{'name': 'RIGHT_DELIM_JOIN', 'timing': 0.021031, 'cardinality': 0, 'extra_info': 'RIGHT\np_partkey IS NOT DISTINCT FROM p_partkey\n\n[INFOSEPARATOR]\nEC: 3000607\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.076677, 'cardinality': 6088, 'extra_info': 'INNER\nl_partkey = p_partkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 80175\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.029142, 'cardinality': 6001215, 'extra_info': 'lineitem\n[INFOSEPARATOR]\nl_partkey\nl_quantity\nl_extendedprice\n[INFOSEPARATOR]\nEC: 6001215', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 0.013147, 'cardinality': 204, 'extra_info': "part\n[INFOSEPARATOR]\np_partkey\n[INFOSEPARATOR]\nFilters: p_brand='Brand#23' AND p_brand IS NOT NULL\np_container='MED BOX' AND p_container IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 5000", 'children': []}]}, {'name': 'HASH_JOIN', 'timing': 0.003604, 'cardinality': 6088, 'extra_info': 'RIGHT\np_partkey IS NOT DISTINCT FROM p_partkey\n\n[INFOSEPARATOR]\nEC: 3000607\n', 'children': [{'name': 'PROJECTION', 'timing': 2e-05, 'cardinality': 204, 'extra_info': '(0.2 * avg(l_quantity))\np_partkey\n', 'children': [{'name': 'PROJECTION', 'timing': 3.4e-05, 'cardinality': 204, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n#1\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.011972, 'cardinality': 204, 'extra_info': '#0\navg(#1)', 'children': [{'name': 'PROJECTION', 'timing': 1.4e-05, 'cardinality': 6088, 'extra_info': 'p_partkey\nl_quantity\n', 'children': [{'name': 'PROJECTION', 'timing': 8.5e-05, 'cardinality': 6088, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n#1\n#2\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.121735, 'cardinality': 6088, 'extra_info': 'INNER\nl_partkey = p_partkey\n\n[INFOSEPARATOR]\nEC: 6001215\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.014051, 'cardinality': 6001215, 'extra_info': 'lineitem\n[INFOSEPARATOR]\nl_partkey\nl_quantity\n[INFOSEPARATOR]\nEC: 6001215', 'children': []}, {'name': 'DELIM_SCAN', 'timing': 0.0, 'cardinality': 0, 'extra_info': '', 'children': []}]}]}]}]}]}]}, {'name': 'DUMMY_SCAN', 'timing': 0.0, 'cardinality': 0, 'extra_info': '', 'children': []}]}, {'name': 'HASH_GROUP_BY', 'timing': 0.003838, 'cardinality': 204, 'extra_info': '#0', 'children': []}]}]}]}]}]}]}]}]}
compressed filter_log_size: 7276
compressed filter_log_buffer_size: 844
compressed limit_offset_size: 3744
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 5071
compressed perfect_full_scan_ht_log_buffer_size: 943
compressed perfect_probe_ht_log_size: 90814
compressed perfect_probe_ht_log_buffer_size: 48704
compressed row_group_log_size: 52912
compressed row_group_log_buffer_size: 816
compressed scatter_log_size: 54496
compressed scatter_log_buffer_size: 46144
compressed scatter_sel_log_size: 47279
compressed scatter_sel_log_buffer_size: 36274
compressed gather_log_size: 3744
compressed gather_log_buffer_size: 0
compressed combine_log_size: 175680
compressed combine_log_buffer_size: 167789
compressed finalize_states_log_size: 7128
compressed finalize_states_log_buffer_size: 1080
compressed join_gather_log_size: 170686
compressed join_gather_log_buffer_size: 116477
compressed reorder_log_size: 5616
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 3744
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 3744
compressed nlj_log_buffer_size: 0
compressed total_size: 631934
compressed total_buffer_size: 419071
compressed total_element_size: 212863

Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                                                                                       
│           LIMIT           │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│             #0            │                                                                                       
│__internal_decompress_integ│                                                                                       
│     ral_bigint(#1, 1)     │                                                                                       
│__internal_decompress_integ│                                                                                       
│     ral_bigint(#2, 1)     │                                                                                       
│             #3            │                                                                                       
│             #4            │                                                                                       
│             #5            │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│          ORDER_BY         │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│          ORDERS:          │                                                                                       
│  orders.o_totalprice DESC │                                                                                       
│   orders.o_orderdate ASC  │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│             #0            │                                                                                       
│__internal_compress_integra│                                                                                       
│     l_uinteger(#1, 1)     │                                                                                       
│__internal_compress_integra│                                                                                       
│     l_uinteger(#2, 1)     │                                                                                       
│             #3            │                                                                                       
│             #4            │                                                                                       
│             #5            │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│             #0            │                                                                                       
│__internal_decompress_integ│                                                                                       
│     ral_bigint(#1, 1)     │                                                                                       
│__internal_decompress_integ│                                                                                       
│     ral_bigint(#2, 1)     │                                                                                       
│             #3            │                                                                                       
│             #4            │                                                                                       
│             #5            │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│       HASH_GROUP_BY       │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│             #0            │                                                                                       
│             #1            │                                                                                       
│             #2            │                                                                                       
│             #3            │                                                                                       
│             #4            │                                                                                       
│          sum(#5)          │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│           c_name          │                                                                                       
│         c_custkey         │                                                                                       
│         o_orderkey        │                                                                                       
│        o_orderdate        │                                                                                       
│        o_totalprice       │                                                                                       
│         l_quantity        │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│__internal_compress_integra│                                                                                       
│     l_uinteger(#0, 1)     │                                                                                       
│             #1            │                                                                                       
│__internal_compress_integra│                                                                                       
│     l_uinteger(#2, 1)     │                                                                                       
│__internal_compress_integra│                                                                                       
│     l_uinteger(#3, 1)     │                                                                                       
│             #4            │                                                                                       
│             #5            │                                                                                       
│             #6            │                                                                                       
│__internal_compress_integra│                                                                                       
│     l_uinteger(#7, 1)     │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         HASH_JOIN         │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│           INNER           │                                                                                       
│      o_orderkey = #0      ├────────────────────────────────────────────────────────────────────────┐              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                        │              
│        EC: 3618677        │                                                                        │              
└─────────────┬─────────────┘                                                                        │                                           
┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐
│         HASH_JOIN         │                                                          │         PROJECTION        │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│           INNER           │                                                          │__internal_decompress_integ│
│  l_orderkey = o_orderkey  ├──────────────┐                                           │     ral_bigint(#0, 1)     │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                           │                           │
│        EC: 3618677        │              │                                           │                           │
└─────────────┬─────────────┘              │                                           └─────────────┬─────────────┘                             
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐
│         SEQ_SCAN          ││         HASH_JOIN         │                             │       HASH_GROUP_BY       │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│          lineitem         ││           INNER           │                             │             #0            │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   o_custkey = c_custkey   │                             │                           │
│         l_orderkey        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐              │                           │
│         l_quantity        ││        Build Min: 1       │              │              │                           │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││     Build Max: 149999     │              │              │                           │
│        EC: 6001215        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              │                           │
│                           ││         EC: 904486        │              │              │                           │
└───────────────────────────┘└─────────────┬─────────────┘              │              └─────────────┬─────────────┘                             
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐
                             │         SEQ_SCAN          ││         SEQ_SCAN          ││         PROJECTION        │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                             │           orders          ││          customer         ││             #0            │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │
                             │         o_orderkey        ││         c_custkey         ││                           │
                             │         o_custkey         ││           c_name          ││                           │
                             │        o_orderdate        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │
                             │        o_totalprice       ││ Filters: c_custkey<=149999││                           │
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││  AND c_custkey IS NOT NULL││                           │
                             │        EC: 1500000        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │
                             │                           ││         EC: 150000        ││                           │
                             └───────────────────────────┘└───────────────────────────┘└─────────────┬─────────────┘                             
                                                                                       ┌─────────────┴─────────────┐
                                                                                       │         PROJECTION        │
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                       │__internal_compress_integra│
                                                                                       │     l_uinteger(#0, 1)     │
                                                                                       └─────────────┬─────────────┘                             
                                                                                       ┌─────────────┴─────────────┐
                                                                                       │         PROJECTION        │
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                       │         l_orderkey        │
                                                                                       └─────────────┬─────────────┘                             
                                                                                       ┌─────────────┴─────────────┐
                                                                                       │           FILTER          │
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                       │ (sum(l_quantity) > 300.00)│
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                       │         EC: 47042         │
                                                                                       └─────────────┬─────────────┘                             
                                                                                       ┌─────────────┴─────────────┐
                                                                                       │         PROJECTION        │
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                       │__internal_decompress_integ│
                                                                                       │     ral_bigint(#0, 1)     │
                                                                                       │             #1            │
                                                                                       └─────────────┬─────────────┘                             
                                                                                       ┌─────────────┴─────────────┐
                                                                                       │       HASH_GROUP_BY       │
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                       │             #0            │
                                                                                       │    sum_no_overflow(#1)    │
                                                                                       └─────────────┬─────────────┘                             
                                                                                       ┌─────────────┴─────────────┐
                                                                                       │         PROJECTION        │
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                       │         l_orderkey        │
                                                                                       │         l_quantity        │
                                                                                       └─────────────┬─────────────┘                             
                                                                                       ┌─────────────┴─────────────┐
                                                                                       │         PROJECTION        │
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                       │__internal_compress_integra│
                                                                                       │     l_uinteger(#0, 1)     │
                                                                                       │             #1            │
                                                                                       └─────────────┬─────────────┘                             
                                                                                       ┌─────────────┴─────────────┐
                                                                                       │         SEQ_SCAN          │
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                       │          lineitem         │
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                       │         l_orderkey        │
                                                                                       │         l_quantity        │
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                       │        EC: 6001215        │
                                                                                       └───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

X {'RESULT_COLLECTOR0': 4e-06, 'PROJECTION1': 4e-06, 'UNGROUPED_AGGREGATE2': 1.7e-05, 'PROJECTION3': 2e-06, 'PROJECTION4': 7e-06, 'FILTER5': 0.000269, 'RIGHT_DELIM_JOIN6': 0.021031, 'HASH_JOIN7': 0.076677, 'SEQ_SCAN 8': 0.029142, 'SEQ_SCAN 9': 0.013147, 'HASH_JOIN10': 0.003604, 'PROJECTION11': 2e-05, 'PROJECTION12': 3.4e-05, 'HASH_GROUP_BY13': 0.011972, 'PROJECTION14': 1.4e-05, 'PROJECTION15': 8.5e-05, 'HASH_JOIN16': 0.121735, 'SEQ_SCAN 17': 0.014051, 'DELIM_SCAN18': 0.0, 'DUMMY_SCAN19': 0.0, 'HASH_GROUP_BY20': 0.003838}
**** output size:  1
LINEAGE_5_FILTER_15
LINEAGE_5_HASH_GROUP_BY_10
LINEAGE_5_HASH_GROUP_BY_5
LINEAGE_5_HASH_JOIN_13
LINEAGE_5_HASH_JOIN_2
LINEAGE_5_HASH_JOIN_9
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_11
LINEAGE_5_SEQ_SCAN_12
SELECT sum(l_extendedprice) / 7.0 AS avg_yearly FROM lineitem, part WHERE p_partkey = l_partkey AND p_brand = 'Brand#23' AND p_container = 'MED BOX' AND l_quantity < ( SELECT 0.2 * avg(l_quantity) FROM lineitem WHERE l_partkey = p_partkey);
   query_id  ...                                               plan
0         5  ...  {"name": "PROJECTION", "opid": "19", "children...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               SELECT sum(l_extendedprice) / 7.0 AS avg_yearl...
size_bytes_max                                                 631934
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "PROJECTION", "opid": "19", "children...
Name: 0, dtype: object
{"name": "PROJECTION", "opid": "19", "children": [{"name": "UNGROUPED_AGGREGATE", "opid": "18", "children": [{"name": "PROJECTION", "opid": "17", "children": [{"name": "PROJECTION", "opid": "16", "children": [{"name": "FILTER", "opid": "15", "children": [{"name": "RIGHT_DELIM_JOIN", "opid": "14", "children": [{"name": "HASH_GROUP_BY", "opid": "10", "children": [],"table": "","extra": "#0"},{"name": "HASH_JOIN", "opid": "9", "children": [{"name": "PROJECTION", "opid": "7", "children": [{"name": "PROJECTION", "opid": "6", "children": [{"name": "HASH_GROUP_BY", "opid": "5", "children": [{"name": "PROJECTION", "opid": "4", "children": [{"name": "PROJECTION", "opid": "3", "children": [{"name": "HASH_JOIN", "opid": "2", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_partkey\nl_quantity\n[INFOSEPARATOR]\nEC: 6001215"},{"name": "DELIM_SCAN", "opid": "1", "children": [],"table": "","extra": ""}],"table": "","extra": "INNER\nl_partkey = p_partkey\n\n[INFOSEPARATOR]\nEC: 6001215\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n#1\n#2\n"}],"table": "","extra": "p_partkey\nl_quantity\n"}],"table": "","extra": "#0\navg(#1)"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n#1\n"}],"table": "","extra": "(0.2 * avg(l_quantity))\np_partkey\n"},{"name": "DUMMY_SCAN", "opid": "8", "children": [],"table": "","extra": ""}],"table": "","extra": "RIGHT\np_partkey IS NOT DISTINCT FROM p_partkey\n\n[INFOSEPARATOR]\nEC: 3000607\n"},{"name": "HASH_JOIN", "opid": "13", "children": [{"name": "SEQ_SCAN ", "opid": "11", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_partkey\nl_quantity\nl_extendedprice\n[INFOSEPARATOR]\nEC: 6001215"},{"name": "SEQ_SCAN ", "opid": "12", "children": [],"table": "part","extra": "part\n[INFOSEPARATOR]\np_partkey\n[INFOSEPARATOR]\nFilters: p_brand='Brand#23' AND p_brand IS NOT NULL\np_container='MED BOX' AND p_container IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 5000"}],"table": "","extra": "INNER\nl_partkey = p_partkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 80175\n"}],"table": "","extra": "RIGHT\np_partkey IS NOT DISTINCT FROM p_partkey\n\n[INFOSEPARATOR]\nEC: 3000607\n"}],"table": "","extra": "(CAST(l_quantity AS DOUBLE) < SUBQUERY)\n[INFOSEPARATOR]\nEC: 3000607"}],"table": "","extra": "#0\n#3\n#4\n"}],"table": "","extra": "l_extendedprice\n"}],"table": "","extra": "sum(#0)"}],"table": "","extra": "avg_yearly\n"}
%%%%%%%%%%%%%%%% Running Query #  18  threads:  16
SELECT c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, sum(l_quantity) FROM customer, orders, lineitem WHERE o_orderkey IN ( SELECT l_orderkey FROM lineitem GROUP BY l_orderkey HAVING sum(l_quantity) > 300) AND c_custkey = o_custkey AND o_orderkey = l_orderkey GROUP BY c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice ORDER BY o_totalprice DESC, o_orderdate LIMIT 100;
Run:  None SELECT c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, sum(l_quantity) FROM customer, orders, lineitem WHERE o_orderkey IN ( SELECT l_orderkey FROM lineitem GROUP BY l_orderkey HAVING sum(l_quantity) > 300) AND c_custkey = o_custkey AND o_orderkey = l_orderkey GROUP BY c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice ORDER BY o_totalprice DESC, o_orderdate LIMIT 100;
Avg Time in sec:  0.25202225567772985  output size:  57
                c_name  c_custkey  ...  o_totalprice sum(l_quantity)
0   Customer#000128120     128120  ...     544089.09           323.0
1   Customer#000144617     144617  ...     530604.44           317.0
2   Customer#000013940      13940  ...     522720.61           304.0
3   Customer#000066790      66790  ...     515531.82           327.0
4   Customer#000046435      46435  ...     508047.99           309.0
5   Customer#000015272      15272  ...     500241.33           302.0
6   Customer#000146608     146608  ...     499794.58           303.0
7   Customer#000096103      96103  ...     494398.79           312.0
8   Customer#000024341      24341  ...     491348.26           302.0
9   Customer#000137446     137446  ...     487763.25           311.0
10  Customer#000107590     107590  ...     485141.38           301.0
11  Customer#000050008      50008  ...     483891.26           302.0
12  Customer#000015619      15619  ...     480083.96           318.0
13  Customer#000077260      77260  ...     479499.43           307.0
14  Customer#000109379     109379  ...     478064.11           302.0
15  Customer#000054602      54602  ...     471220.08           307.0
16  Customer#000105995     105995  ...     469692.58           307.0
17  Customer#000148885     148885  ...     469630.44           313.0
18  Customer#000114586     114586  ...     469605.59           308.0
19  Customer#000105260     105260  ...     469360.57           303.0
20  Customer#000147197     147197  ...     467149.67           320.0
21  Customer#000064483      64483  ...     466991.35           304.0
22  Customer#000136573     136573  ...     461282.73           301.0
23  Customer#000016384      16384  ...     458378.92           312.0
24  Customer#000117919     117919  ...     456815.92           317.0
25  Customer#000012251      12251  ...     455107.26           309.0
26  Customer#000120098     120098  ...     453451.23           308.0
27  Customer#000066098      66098  ...     453436.16           304.0
28  Customer#000117076     117076  ...     449545.85           301.0
29  Customer#000129379     129379  ...     448665.79           303.0
30  Customer#000126865     126865  ...     447606.65           320.0
31  Customer#000088876      88876  ...     446717.46           304.0
32  Customer#000036619      36619  ...     446704.09           328.0
33  Customer#000141823     141823  ...     446269.12           310.0
34  Customer#000053029      53029  ...     446144.49           302.0
35  Customer#000018188      18188  ...     443807.22           308.0
36  Customer#000066533      66533  ...     443576.50           305.0
37  Customer#000037729      37729  ...     441082.97           309.0
38  Customer#000003566       3566  ...     439803.36           304.0
39  Customer#000045538      45538  ...     436275.31           305.0
40  Customer#000081581      81581  ...     435405.90           305.0
41  Customer#000119989     119989  ...     434568.25           320.0
42  Customer#000003680       3680  ...     433525.97           301.0
43  Customer#000113131     113131  ...     432957.75           301.0
44  Customer#000141098     141098  ...     430986.69           301.0
45  Customer#000093392      93392  ...     425487.51           304.0
46  Customer#000015631      15631  ...     419879.59           302.0
47  Customer#000112987     112987  ...     418161.49           305.0
48  Customer#000012599      12599  ...     415200.61           304.0
49  Customer#000105410     105410  ...     412754.51           302.0
50  Customer#000149842     149842  ...     411329.35           302.0
51  Customer#000010129      10129  ...     409129.85           309.0
52  Customer#000069904      69904  ...     408513.00           305.0
53  Customer#000017746      17746  ...     408446.93           303.0
54  Customer#000013072      13072  ...     399195.47           301.0
55  Customer#000082441      82441  ...     382579.74           305.0
56  Customer#000088703      88703  ...     363812.12           302.0

[57 rows x 6 columns]
compressed filter_log_size: 8089
compressed filter_log_buffer_size: 228
compressed limit_offset_size: 5104
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 519264
compressed perfect_full_scan_ht_log_buffer_size: 513920
compressed perfect_probe_ht_log_size: 3424664
compressed perfect_probe_ht_log_buffer_size: 3410440
compressed row_group_log_size: 60461
compressed row_group_log_buffer_size: 820
compressed scatter_log_size: 22409120
compressed scatter_log_buffer_size: 22387489
compressed scatter_sel_log_size: 8095885
compressed scatter_sel_log_buffer_size: 8078940
compressed gather_log_size: 4960
compressed gather_log_buffer_size: 0
compressed combine_log_size: 122393
compressed combine_log_buffer_size: 107710
compressed finalize_states_log_size: 628268
compressed finalize_states_log_buffer_size: 616828
compressed join_gather_log_size: 19499156
compressed join_gather_log_buffer_size: 19327914
compressed reorder_log_size: 8005
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 4960
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 4960
compressed nlj_log_buffer_size: 0
compressed total_size: 54795289
compressed total_buffer_size: 54444289
compressed total_element_size: 351000

{'name': 'Query', 'result': 0.220828, 'timing': 0.220828, 'cardinality': 0, 'extra-info': 'SELECT c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, sum(l_quantity) FROM customer, orders, lineitem WHERE o_orderkey IN ( SELECT l_orderkey FROM lineitem GROUP BY l_orderkey HAVING sum(l_quantity) > 300) AND c_custkey = o_custkey AND o_orderkey = l_orderkey GROUP BY c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice ORDER BY o_totalprice DESC, o_orderdate LIMIT 100;', 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 3.1e-05, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'LIMIT', 'timing': 0.000138, 'cardinality': 57, 'extra_info': '', 'children': [{'name': 'PROJECTION', 'timing': 1.4e-05, 'cardinality': 57, 'extra_info': '#0\n__internal_decompress_integral_bigint(#1, 1)\n__internal_decompress_integral_bigint(#2, 1)\n#3\n#4\n#5\n', 'children': [{'name': 'ORDER_BY', 'timing': 0.000292, 'cardinality': 57, 'extra_info': 'ORDERS:\norders.o_totalprice DESC\norders.o_orderdate ASC', 'children': [{'name': 'PROJECTION', 'timing': 4.6e-05, 'cardinality': 57, 'extra_info': '#0\n__internal_compress_integral_uinteger(#1, 1)\n__internal_compress_integral_uinteger(#2, 1)\n#3\n#4\n#5\n', 'children': [{'name': 'PROJECTION', 'timing': 4.3e-05, 'cardinality': 57, 'extra_info': '#0\n__internal_decompress_integral_bigint(#1, 1)\n__internal_decompress_integral_bigint(#2, 1)\n#3\n#4\n#5\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.01701, 'cardinality': 57, 'extra_info': '#0\n#1\n#2\n#3\n#4\nsum(#5)', 'children': [{'name': 'PROJECTION', 'timing': 8.1e-05, 'cardinality': 399, 'extra_info': 'c_name\nc_custkey\no_orderkey\no_orderdate\no_totalprice\nl_quantity\n', 'children': [{'name': 'PROJECTION', 'timing': 0.001273, 'cardinality': 399, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n#1\n__internal_compress_integral_uinteger(#2, 1)\n__internal_compress_integral_uinteger(#3, 1)\n#4\n#5\n#6\n__internal_compress_integral_uinteger(#7, 1)\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.141727, 'cardinality': 399, 'extra_info': 'INNER\no_orderkey = #0\n\n[INFOSEPARATOR]\nEC: 3618677\n', 'children': [{'name': 'HASH_JOIN', 'timing': 1.059397, 'cardinality': 6001215, 'extra_info': 'INNER\nl_orderkey = o_orderkey\n\n[INFOSEPARATOR]\nEC: 3618677\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.016666, 'cardinality': 6001215, 'extra_info': 'lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_quantity\n[INFOSEPARATOR]\nEC: 6001215', 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.067343, 'cardinality': 1500000, 'extra_info': 'INNER\no_custkey = c_custkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 149999\n\n[INFOSEPARATOR]\nEC: 904486\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.009497, 'cardinality': 1500000, 'extra_info': 'orders\n[INFOSEPARATOR]\no_orderkey\no_custkey\no_orderdate\no_totalprice\n[INFOSEPARATOR]\nEC: 1500000', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 0.0043, 'cardinality': 149999, 'extra_info': 'customer\n[INFOSEPARATOR]\nc_custkey\nc_name\n[INFOSEPARATOR]\nFilters: c_custkey<=149999 AND c_custkey IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 150000', 'children': []}]}]}, {'name': 'PROJECTION', 'timing': 2.5e-05, 'cardinality': 57, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.00406, 'cardinality': 57, 'extra_info': '#0', 'children': [{'name': 'PROJECTION', 'timing': 8e-06, 'cardinality': 57, 'extra_info': '#0\n', 'children': [{'name': 'PROJECTION', 'timing': 3e-05, 'cardinality': 57, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n', 'children': [{'name': 'PROJECTION', 'timing': 9e-06, 'cardinality': 57, 'extra_info': 'l_orderkey\n', 'children': [{'name': 'FILTER', 'timing': 0.007018, 'cardinality': 57, 'extra_info': '(sum(l_quantity) > 300.00)\n[INFOSEPARATOR]\nEC: 47042', 'children': [{'name': 'PROJECTION', 'timing': 0.002172, 'cardinality': 1500000, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n#1\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.811517, 'cardinality': 1500000, 'extra_info': '#0\nsum_no_overflow(#1)', 'children': [{'name': 'PROJECTION', 'timing': 0.001429, 'cardinality': 6001215, 'extra_info': 'l_orderkey\nl_quantity\n', 'children': [{'name': 'PROJECTION', 'timing': 0.014084, 'cardinality': 6001215, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n#1\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.027653, 'cardinality': 6001215, 'extra_info': 'lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_quantity\n[INFOSEPARATOR]\nEC: 6001215', 'children': []}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}
X {'RESULT_COLLECTOR0': 3.1e-05, 'LIMIT1': 0.000138, 'PROJECTION2': 1.4e-05, 'ORDER_BY3': 0.000292, 'PROJECTION4': 4.6e-05, 'PROJECTION5': 4.3e-05, 'HASH_GROUP_BY6': 0.01701, 'PROJECTION7': 8.1e-05, 'PROJECTION8': 0.001273, 'HASH_JOIN9': 0.141727, 'HASH_JOIN10': 1.059397, 'SEQ_SCAN 11': 0.016666, 'HASH_JOIN12': 0.067343, 'SEQ_SCAN 13': 0.009497, 'SEQ_SCAN 14': 0.0043, 'PROJECTION15': 2.5e-05, 'HASH_GROUP_BY16': 0.00406, 'PROJECTION17': 8e-06, 'PROJECTION18': 3e-05, 'PROJECTION19': 9e-06, 'FILTER20': 0.007018, 'PROJECTION21': 0.002172, 'HASH_GROUP_BY22': 0.811517, 'PROJECTION23': 0.001429, 'PROJECTION24': 0.014084, 'SEQ_SCAN 25': 0.027653}
**** output size:  57
LINEAGE_5_FILTER_10
LINEAGE_5_HASH_GROUP_BY_14
LINEAGE_5_HASH_GROUP_BY_19
LINEAGE_5_HASH_GROUP_BY_8
LINEAGE_5_HASH_JOIN_16
LINEAGE_5_HASH_JOIN_3
LINEAGE_5_HASH_JOIN_4
LINEAGE_5_LIMIT_24
LINEAGE_5_ORDER_BY_22
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_1
LINEAGE_5_SEQ_SCAN_2
LINEAGE_5_SEQ_SCAN_5
SELECT c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, sum(l_quantity) FROM customer, orders, lineitem WHERE o_orderkey IN ( SELECT l_orderkey FROM lineitem GROUP BY l_orderkey HAVING sum(l_quantity) > 300) AND c_custkey = o_custkey AND o_orderkey = l_orderkey GROUP BY c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice ORDER BY o_totalprice DESC, o_orderdate LIMIT 100;
   query_id  ...                                               plan
0         5  ...  {"name": "LIMIT", "opid": "24", "children": [{...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               SELECT c_name, c_custkey, o_orderkey, o_orderd...
size_bytes_max                                               54795289
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "LIMIT", "opid": "24", "children": [{...
Name: 0, dtype: object
{"name": "LIMIT", "opid": "24", "children": [{"name": "PROJECTION", "opid": "23", "children": [{"name": "ORDER_BY", "opid": "22", "children": [{"name": "PROJECTION", "opid": "21", "children": [{"name": "PROJECTION", "opid": "20", "children": [{"name": "HASH_GROUP_BY", "opid": "19", "children": [{"name": "PROJECTION", "opid": "18", "children": [{"name": "PROJECTION", "opid": "17", "children": [{"name": "HASH_JOIN", "opid": "16", "children": [{"name": "HASH_JOIN", "opid": "4", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_quantity\n[INFOSEPARATOR]\nEC: 6001215"},{"name": "HASH_JOIN", "opid": "3", "children": [{"name": "SEQ_SCAN ", "opid": "1", "children": [],"table": "orders","extra": "orders\n[INFOSEPARATOR]\no_orderkey\no_custkey\no_orderdate\no_totalprice\n[INFOSEPARATOR]\nEC: 1500000"},{"name": "SEQ_SCAN ", "opid": "2", "children": [],"table": "customer","extra": "customer\n[INFOSEPARATOR]\nc_custkey\nc_name\n[INFOSEPARATOR]\nFilters: c_custkey<=149999 AND c_custkey IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 150000"}],"table": "","extra": "INNER\no_custkey = c_custkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 149999\n\n[INFOSEPARATOR]\nEC: 904486\n"}],"table": "","extra": "INNER\nl_orderkey = o_orderkey\n\n[INFOSEPARATOR]\nEC: 3618677\n"},{"name": "PROJECTION", "opid": "15", "children": [{"name": "HASH_GROUP_BY", "opid": "14", "children": [{"name": "PROJECTION", "opid": "13", "children": [{"name": "PROJECTION", "opid": "12", "children": [{"name": "PROJECTION", "opid": "11", "children": [{"name": "FILTER", "opid": "10", "children": [{"name": "PROJECTION", "opid": "9", "children": [{"name": "HASH_GROUP_BY", "opid": "8", "children": [{"name": "PROJECTION", "opid": "7", "children": [{"name": "PROJECTION", "opid": "6", "children": [{"name": "SEQ_SCAN ", "opid": "5", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_quantity\n[INFOSEPARATOR]\nEC: 6001215"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n#1\n"}],"table": "","extra": "l_orderkey\nl_quantity\n"}],"table": "","extra": "#0\nsum_no_overflow(#1)"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n#1\n"}],"table": "","extra": "(sum(l_quantity) > 300.00)\n[INFOSEPARATOR]\nEC: 47042"}],"table": "","extra": "l_orderkey\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n"}],"table": "","extra": "#0\n"}],"table": "","extra": "#0"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n"}],"table": "","extra": "INNER\no_orderkey = #0\n\n[INFOSEPARATOR]\nEC: 3618677\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n#1\n__internal_compress_integral_uinteger(#2, 1)\n__internal_compress_integral_uinteger(#3, 1)\n#4\n#5\n#6\n__internal_compress_integral_uinteger(#7, 1)\n"}],"table": "","extra": "c_name\nc_custkey\no_orderkey\no_orderdate\no_totalprice\nl_quantity\n"}],"table": "","extra": "#0\n#1\n#2\n#3\n#4\nsum(#5)"}],"table": "","extra": "#0\n__internal_decompress_integral_bigint(#1, 1)\n__internal_decompress_integral_bigint(#2, 1)\n#3\n#4\n#5\n"}],"table": "","extra": "#0\n__internal_compress_integral_uinteger(#1, 1)\n__internal_compress_integral_uinteger(#2, 1)\n#3\n#4\n#5\n"}],"table": "","extra": "ORDERS:\norders.o_totalprice DESC\norders.o_orderdate ASC"}],"table": "","extra": "#0\n__internal_decompress_integral_bigint(#1, 1)\n__internal_decompress_integral_bigint(#2, 1)\n#3\n#4\n#5\n"}],"table": "","extra": ""}
Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                             
│    UNGROUPED_AGGREGATE    │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│          sum(#0)          │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│ (l_extendedprice * (1.00 -│                             
│        l_discount))       │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│             #1            │                             
│             #2            │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│             #1            │                             
│             #3            │                             
│             #4            │                             
│             #6            │                             
│             #7            │                             
│             #8            │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│           FILTER          │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│(((l_quantity <= 11.00) AND│                             
│ (p_size <= 5) AND (p_brand│                             
│     = 'Brand#12') AND (   │                             
│(p_container = 'SM CAS...  │                             
│(p_container = 'SM BOX...  │                             
│(p_container = 'SM PAC...  │                             
│(p_container = 'SM PKG...  │                             
│ ((l_quantity >= 10.00) AND│                             
│ (l_quantity <= 20.00) AND │                             
│(p_size <= 10) AND (p_brand│                             
│     = 'Brand#23') AND (   │                             
│(p_container = 'MED BA...  │                             
│(p_container = 'MED BO...  │                             
│(p_container = 'MED PK...  │                             
│(p_container = 'MED PA...  │                             
│  OR ((l_quantity >= 20.00)│                             
│  AND (l_quantity <= 30.00)│                             
│   AND (p_size <= 15) AND  │                             
│(p_brand = 'Brand#34')...  │                             
│(p_container = 'LG CAS...  │                             
│(p_container = 'LG BOX...  │                             
│(p_container = 'LG PAC...  │                             
│ (p_container = 'LG PKG')))│                             
│             )             │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│         EC: 160351        │                             
└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐                             
│         HASH_JOIN         │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│           INNER           │                             
│   l_partkey = p_partkey   │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐              
│        Build Min: 1       │              │              
│     Build Max: 200000     │              │              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              
│         EC: 160351        │              │              
└─────────────┬─────────────┘              │                                           
┌─────────────┴─────────────┐┌─────────────┴─────────────┐
│           FILTER          ││         SEQ_SCAN          │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│ ((l_shipmode = 'AIR') OR  ││            part           │
│ (l_shipmode = 'AIR REG')) ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││         p_partkey         │
│         EC: 300060        ││          p_brand          │
│                           ││        p_container        │
│                           ││           p_size          │
│                           ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│                           ││         EC: 200000        │
└─────────────┬─────────────┘└───────────────────────────┘                             
┌─────────────┴─────────────┐                             
│         SEQ_SCAN          │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│          lineitem         │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│         l_partkey         │                             
│         l_quantity        │                             
│         l_shipmode        │                             
│      l_extendedprice      │                             
│         l_discount        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│  Filters: l_shipinstruct= │                             
│  'DELIVER IN PERSON' AND  │                             
│ l_shipinstruct IS NOT NULL│                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│         EC: 300060        │                             
└───────────────────────────┘                                                          

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

compressed filter_log_size: 265257
compressed filter_log_buffer_size: 223760
compressed limit_offset_size: 2448
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 487267
compressed perfect_full_scan_ht_log_buffer_size: 484435
compressed perfect_probe_ht_log_size: 693102
compressed perfect_probe_ht_log_buffer_size: 651134
compressed row_group_log_size: 799136
compressed row_group_log_buffer_size: 753113
compressed scatter_log_size: 2448
compressed scatter_log_buffer_size: 0
compressed scatter_sel_log_size: 995467
compressed scatter_sel_log_buffer_size: 991537
compressed gather_log_size: 2448
compressed gather_log_buffer_size: 0
compressed combine_log_size: 2448
compressed combine_log_buffer_size: 0
compressed finalize_states_log_size: 2448
compressed finalize_states_log_buffer_size: 0
compressed join_gather_log_size: 2448
compressed join_gather_log_buffer_size: 0
compressed reorder_log_size: 3672
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 2448
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 2448
compressed nlj_log_buffer_size: 0
compressed total_size: 3263485
compressed total_buffer_size: 3103979
compressed total_element_size: 159506

%%%%%%%%%%%%%%%% Running Query #  19  threads:  16
SELECT sum(l_extendedprice * (1 - l_discount)) AS revenue FROM lineitem, part WHERE (p_partkey = l_partkey AND p_brand = 'Brand#12' AND p_container IN ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') AND l_quantity >= 1 AND l_quantity <= 1 + 10 AND p_size BETWEEN 1 AND 5 AND l_shipmode IN ('AIR', 'AIR REG') AND l_shipinstruct = 'DELIVER IN PERSON') OR (p_partkey = l_partkey AND p_brand = 'Brand#23' AND p_container IN ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') AND l_quantity >= 10 AND l_quantity <= 10 + 10 AND p_size BETWEEN 1 AND 10 AND l_shipmode IN ('AIR', 'AIR REG') AND l_shipinstruct = 'DELIVER IN PERSON') OR (p_partkey = l_partkey AND p_brand = 'Brand#34' AND p_container IN ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') AND l_quantity >= 20 AND l_quantity <= 20 + 10 AND p_size BETWEEN 1 AND 15 AND l_shipmode IN ('AIR', 'AIR REG') AND l_shipinstruct = 'DELIVER IN PERSON');
Run:  None SELECT sum(l_extendedprice * (1 - l_discount)) AS revenue FROM lineitem, part WHERE (p_partkey = l_partkey AND p_brand = 'Brand#12' AND p_container IN ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') AND l_quantity >= 1 AND l_quantity <= 1 + 10 AND p_size BETWEEN 1 AND 5 AND l_shipmode IN ('AIR', 'AIR REG') AND l_shipinstruct = 'DELIVER IN PERSON') OR (p_partkey = l_partkey AND p_brand = 'Brand#23' AND p_container IN ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') AND l_quantity >= 10 AND l_quantity <= 10 + 10 AND p_size BETWEEN 1 AND 10 AND l_shipmode IN ('AIR', 'AIR REG') AND l_shipinstruct = 'DELIVER IN PERSON') OR (p_partkey = l_partkey AND p_brand = 'Brand#34' AND p_container IN ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') AND l_quantity >= 20 AND l_quantity <= 20 + 10 AND p_size BETWEEN 1 AND 15 AND l_shipmode IN ('AIR', 'AIR REG') AND l_shipinstruct = 'DELIVER IN PERSON');
Avg Time in sec:  0.09210238792002201  output size:  1
        revenue
0  3.083843e+06
{'name': 'Query', 'result': 0.088837, 'timing': 0.088837, 'cardinality': 0, 'extra-info': "SELECT sum(l_extendedprice * (1 - l_discount)) AS revenue FROM lineitem, part WHERE (p_partkey = l_partkey AND p_brand = 'Brand#12' AND p_container IN ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') AND l_quantity >= 1 AND l_quantity <= 1 + 10 AND p_size BETWEEN 1 AND 5 AND l_shipmode IN ('AIR', 'AIR REG') AND l_shipinstruct = 'DELIVER IN PERSON') OR (p_partkey = l_partkey AND p_brand = 'Brand#23' AND p_container IN ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') AND l_quantity >= 10 AND l_quantity <= 10 + 10 AND p_size BETWEEN 1 AND 10 AND l_shipmode IN ('AIR', 'AIR REG') AND l_shipinstruct = 'DELIVER IN PERSON') OR (p_partkey = l_partkey AND p_brand = 'Brand#34' AND p_container IN ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') AND l_quantity >= 20 AND l_quantity <= 20 + 10 AND p_size BETWEEN 1 AND 15 AND l_shipmode IN ('AIR', 'AIR REG') AND l_shipinstruct = 'DELIVER IN PERSON');", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 5e-06, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'UNGROUPED_AGGREGATE', 'timing': 4.2e-05, 'cardinality': 1, 'extra_info': 'sum(#0)', 'children': [{'name': 'PROJECTION', 'timing': 7.8e-05, 'cardinality': 121, 'extra_info': '(l_extendedprice * (1.00 - l_discount))\n', 'children': [{'name': 'PROJECTION', 'timing': 1.2e-05, 'cardinality': 121, 'extra_info': '#1\n#2\n', 'children': [{'name': 'PROJECTION', 'timing': 3.4e-05, 'cardinality': 121, 'extra_info': '#1\n#3\n#4\n#6\n#7\n#8\n', 'children': [{'name': 'FILTER', 'timing': 0.098848, 'cardinality': 121, 'extra_info': "(((l_quantity <= 11.00) AND (p_size <= 5) AND (p_brand = 'Brand#12') AND ((p_container = 'SM CASE') OR (p_container = 'SM BOX') OR (p_container = 'SM PACK') OR (p_container = 'SM PKG'))) OR ((l_quantity >= 10.00) AND (l_quantity <= 20.00) AND (p_size <= 10) AND (p_brand = 'Brand#23') AND ((p_container = 'MED BAG') OR (p_container = 'MED BOX') OR (p_container = 'MED PKG') OR (p_container = 'MED PACK'))) OR ((l_quantity >= 20.00) AND (l_quantity <= 30.00) AND (p_size <= 15) AND (p_brand = 'Brand#34') AND ((p_container = 'LG CASE') OR (p_container = 'LG BOX') OR (p_container = 'LG PACK') OR (p_container = 'LG PKG'))))\n[INFOSEPARATOR]\nEC: 160351", 'children': [{'name': 'HASH_JOIN', 'timing': 0.048279, 'cardinality': 214377, 'extra_info': 'INNER\nl_partkey = p_partkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 160351\n', 'children': [{'name': 'FILTER', 'timing': 0.057375, 'cardinality': 214377, 'extra_info': "((l_shipmode = 'AIR') OR (l_shipmode = 'AIR REG'))\n[INFOSEPARATOR]\nEC: 300060", 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.508606, 'cardinality': 1500048, 'extra_info': "lineitem\n[INFOSEPARATOR]\nl_partkey\nl_quantity\nl_shipmode\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nFilters: l_shipinstruct='DELIVER IN PERSON' AND l_shipinstruct IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 300060", 'children': []}]}, {'name': 'SEQ_SCAN ', 'timing': 0.011077, 'cardinality': 200000, 'extra_info': 'part\n[INFOSEPARATOR]\np_partkey\np_brand\np_container\np_size\n[INFOSEPARATOR]\nEC: 200000', 'children': []}]}]}]}]}]}]}]}]}
X {'RESULT_COLLECTOR0': 5e-06, 'UNGROUPED_AGGREGATE1': 4.2e-05, 'PROJECTION2': 7.8e-05, 'PROJECTION3': 1.2e-05, 'PROJECTION4': 3.4e-05, 'FILTER5': 0.098848, 'HASH_JOIN6': 0.048279, 'FILTER7': 0.057375, 'SEQ_SCAN 8': 0.508606, 'SEQ_SCAN 9': 0.011077}
**** output size:  1
LINEAGE_5_FILTER_1
LINEAGE_5_FILTER_4
LINEAGE_5_HASH_JOIN_3
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_2
SELECT sum(l_extendedprice * (1 - l_discount)) AS revenue FROM lineitem, part WHERE (p_partkey = l_partkey AND p_brand = 'Brand#12' AND p_container IN ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') AND l_quantity >= 1 AND l_quantity <= 1 + 10 AND p_size BETWEEN 1 AND 5 AND l_shipmode IN ('AIR', 'AIR REG') AND l_shipinstruct = 'DELIVER IN PERSON') OR (p_partkey = l_partkey AND p_brand = 'Brand#23' AND p_container IN ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') AND l_quantity >= 10 AND l_quantity <= 10 + 10 AND p_size BETWEEN 1 AND 10 AND l_shipmode IN ('AIR', 'AIR REG') AND l_shipinstruct = 'DELIVER IN PERSON') OR (p_partkey = l_partkey AND p_brand = 'Brand#34' AND p_container IN ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') AND l_quantity >= 20 AND l_quantity <= 20 + 10 AND p_size BETWEEN 1 AND 15 AND l_shipmode IN ('AIR', 'AIR REG') AND l_shipinstruct = 'DELIVER IN PERSON');
   query_id  ...                                               plan
0         5  ...  {"name": "UNGROUPED_AGGREGATE", "opid": "8", "...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               SELECT sum(l_extendedprice * (1 - l_discount))...
size_bytes_max                                                3263485
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "UNGROUPED_AGGREGATE", "opid": "8", "...
Name: 0, dtype: object
{"name": "UNGROUPED_AGGREGATE", "opid": "8", "children": [{"name": "PROJECTION", "opid": "7", "children": [{"name": "PROJECTION", "opid": "6", "children": [{"name": "PROJECTION", "opid": "5", "children": [{"name": "FILTER", "opid": "4", "children": [{"name": "HASH_JOIN", "opid": "3", "children": [{"name": "FILTER", "opid": "1", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_partkey\nl_quantity\nl_shipmode\nl_extendedprice\nl_discount\n[INFOSEPARATOR]\nFilters: l_shipinstruct='DELIVER IN PERSON' AND l_shipinstruct IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 300060"}],"table": "","extra": "((l_shipmode = 'AIR') OR (l_shipmode = 'AIR REG'))\n[INFOSEPARATOR]\nEC: 300060"},{"name": "SEQ_SCAN ", "opid": "2", "children": [],"table": "part","extra": "part\n[INFOSEPARATOR]\np_partkey\np_brand\np_container\np_size\n[INFOSEPARATOR]\nEC: 200000"}],"table": "","extra": "INNER\nl_partkey = p_partkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 160351\n"}],"table": "","extra": "(((l_quantity <= 11.00) AND (p_size <= 5) AND (p_brand = 'Brand#12') AND ((p_container = 'SM CASE') OR (p_container = 'SM BOX') OR (p_container = 'SM PACK') OR (p_container = 'SM PKG'))) OR ((l_quantity >= 10.00) AND (l_quantity <= 20.00) AND (p_size <= 10) AND (p_brand = 'Brand#23') AND ((p_container = 'MED BAG') OR (p_container = 'MED BOX') OR (p_container = 'MED PKG') OR (p_container = 'MED PACK'))) OR ((l_quantity >= 20.00) AND (l_quantity <= 30.00) AND (p_size <= 15) AND (p_brand = 'Brand#34') AND ((p_container = 'LG CASE') OR (p_container = 'LG BOX') OR (p_container = 'LG PACK') OR (p_container = 'LG PKG'))))\n[INFOSEPARATOR]\nEC: 160351"}],"table": "","extra": "#1\n#3\n#4\n#6\n#7\n#8\n"}],"table": "","extra": "#1\n#2\n"}],"table": "","extra": "(l_extendedprice * (1.00 - l_discount))\n"}],"table": "","extra": "sum(#0)"}
Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                                                                                                                                                                              
│          ORDER_BY         │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│          ORDERS:          │                                                                                                                                                                              
│    supplier.s_name ASC    │                                                                                                                                                                              
└─────────────┬─────────────┘                                                                                                                                                                                                           
┌─────────────┴─────────────┐                                                                                                                                                                              
│         PROJECTION        │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│           s_name          │                                                                                                                                                                              
│         s_address         │                                                                                                                                                                              
└─────────────┬─────────────┘                                                                                                                                                                                                           
┌─────────────┴─────────────┐                                                                                                                                                                              
│         HASH_JOIN         │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│           INNER           │                                                                                                                                                                              
│       #0 = s_suppkey      │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐                                           
│        Build Min: 1       │                                                                                                                                  │                                           
│      Build Max: 10000     │                                                                                                                                  │                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                  │                                           
│          EC: 400          │                                                                                                                                  │                                           
└─────────────┬─────────────┘                                                                                                                                  │                                                                        
┌─────────────┴─────────────┐                                                                                                                    ┌─────────────┴─────────────┐                             
│         PROJECTION        │                                                                                                                    │         HASH_JOIN         │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│__internal_decompress_integ│                                                                                                                    │           INNER           │                             
│     ral_bigint(#0, 1)     │                                                                                                                    │ s_nationkey = n_nationkey │                             
│                           │                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐              
│                           │                                                                                                                    │        Build Min: 0       │              │              
│                           │                                                                                                                    │       Build Max: 24       │              │              
│                           │                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              
│                           │                                                                                                                    │          EC: 400          │              │              
└─────────────┬─────────────┘                                                                                                                    └─────────────┬─────────────┘              │                                           
┌─────────────┴─────────────┐                                                                                                                    ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
│       HASH_GROUP_BY       │                                                                                                                    │         SEQ_SCAN          ││         SEQ_SCAN          │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│             #0            │                                                                                                                    │          supplier         ││           nation          │
│                           │                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│                           │                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│                           │                                                                                                                    │         EC: 10000         ││  Filters: n_name='CANADA' │
│                           │                                                                                                                    │                           ││   AND n_name IS NOT NULL  │
│                           │                                                                                                                    │                           ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│                           │                                                                                                                    │                           ││           EC: 1           │
└─────────────┬─────────────┘                                                                                                                    └───────────────────────────┘└───────────────────────────┘                             
┌─────────────┴─────────────┐                                                                                                                                                                              
│         PROJECTION        │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│             #0            │                                                                                                                                                                              
└─────────────┬─────────────┘                                                                                                                                                                                                           
┌─────────────┴─────────────┐                                                                                                                                                                              
│         PROJECTION        │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│__internal_compress_integra│                                                                                                                                                                              
│     l_usmallint(#0, 1)    │                                                                                                                                                                              
└─────────────┬─────────────┘                                                                                                                                                                                                           
┌─────────────┴─────────────┐                                                                                                                                                                              
│         PROJECTION        │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│         ps_suppkey        │                                                                                                                                                                              
└─────────────┬─────────────┘                                                                                                                                                                                                           
┌─────────────┴─────────────┐                                                                                                                                                                              
│         PROJECTION        │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│             #0            │                                                                                                                                                                              
│             #4            │                                                                                                                                                                              
│             #5            │                                                                                                                                                                              
└─────────────┬─────────────┘                                                                                                                                                                                                           
┌─────────────┴─────────────┐                                                                                                                                                                              
│           FILTER          │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│    (CAST(ps_availqty AS   │                                                                                                                                                                              
│ DECIMAL(38,3)) > SUBQUERY)│                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│         EC: 800000        │                                                                                                                                                                              
└─────────────┬─────────────┘                                                                                                                                                                                                           
┌─────────────┴─────────────┐                                                                                                                                                                              
│      RIGHT_DELIM_JOIN     │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│           RIGHT           │                                                                                                                                                                              
│ ps_partkey IS NOT DISTINCT│                                                                                                                                                                              
│       FROM ps_partkey     ├───────────────────────────────────────────┐                                                                                                                                  
│ ps_suppkey IS NOT DISTINCT│                                           │                                                                                                                                  
│       FROM ps_suppkey     │                                           │                                                                                                                                  
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                           │                                                                                                                                  
│         EC: 800000        │                                           │                                                                                                                                  
└─────────────┬─────────────┘                                           │                                                                                                                                                               
┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐                                                                                                                    
│         HASH_JOIN         │                             │         HASH_JOIN         │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│           INNER           │                             │           RIGHT           │                                                                                                                    
│      ps_partkey = #0      │                             │ ps_partkey IS NOT DISTINCT│                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐              │       FROM ps_partkey     ├───────────────────────────────────────────┐                                                                        
│        Build Min: 1       │              │              │ ps_suppkey IS NOT DISTINCT│                                           │                                                                        
│     Build Max: 200000     │              │              │       FROM ps_suppkey     │                                           │                                                                        
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                           │                                                                        
│         EC: 800000        │              │              │         EC: 800000        │                                           │                                                                        
└─────────────┬─────────────┘              │              └─────────────┬─────────────┘                                           │                                                                                                     
┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐                                                          
│         SEQ_SCAN          ││         PROJECTION        ││         PROJECTION        │                             │         DUMMY_SCAN        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │                           │                                                          
│          partsupp         ││__internal_decompress_integ││  (0.5 * sum(l_quantity))  │                             │                           │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││     ral_bigint(#0, 1)     ││         ps_partkey        │                             │                           │                                                          
│         ps_partkey        ││                           ││         ps_suppkey        │                             │                           │                                                          
│        ps_availqty        ││                           ││                           │                             │                           │                                                          
│         ps_suppkey        ││                           ││                           │                             │                           │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           ││                           │                             │                           │                                                          
│         EC: 800000        ││                           ││                           │                             │                           │                                                          
└───────────────────────────┘└─────────────┬─────────────┘└─────────────┬─────────────┘                             └───────────────────────────┘                                                                                       
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                                                    
                             │       HASH_GROUP_BY       ││         PROJECTION        │                                                                                                                    
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
                             │             #0            ││__internal_decompress_integ│                                                                                                                    
                             │                           ││     ral_bigint(#0, 1)     │                                                                                                                    
                             │                           ││__internal_decompress_integ│                                                                                                                    
                             │                           ││     ral_bigint(#1, 1)     │                                                                                                                    
                             │                           ││             #2            │                                                                                                                    
                             └─────────────┬─────────────┘└─────────────┬─────────────┘                                                                                                                                                 
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                                                    
                             │         PROJECTION        ││       HASH_GROUP_BY       │                                                                                                                    
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
                             │             #0            ││             #0            │                                                                                                                    
                             │                           ││             #1            │                                                                                                                    
                             │                           ││          sum(#2)          │                                                                                                                    
                             └─────────────┬─────────────┘└─────────────┬─────────────┘                                                                                                                                                 
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                                                    
                             │         PROJECTION        ││         PROJECTION        │                                                                                                                    
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
                             │__internal_compress_integra││         ps_partkey        │                                                                                                                    
                             │     l_uinteger(#0, 1)     ││         ps_suppkey        │                                                                                                                    
                             │                           ││         l_quantity        │                                                                                                                    
                             └─────────────┬─────────────┘└─────────────┬─────────────┘                                                                                                                                                 
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                                                    
                             │         PROJECTION        ││         PROJECTION        │                                                                                                                    
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
                             │         p_partkey         ││__internal_compress_integra│                                                                                                                    
                             │                           ││     l_uinteger(#0, 1)     │                                                                                                                    
                             │                           ││__internal_compress_integra│                                                                                                                    
                             │                           ││     l_usmallint(#1, 1)    │                                                                                                                    
                             │                           ││             #2            │                                                                                                                    
                             │                           ││             #3            │                                                                                                                    
                             │                           ││             #4            │                                                                                                                    
                             └─────────────┬─────────────┘└─────────────┬─────────────┘                                                                                                                                                 
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                                                    
                             │           FILTER          ││         HASH_JOIN         │                                                                                                                    
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
                             │  prefix(p_name, 'forest') ││           INNER           │                                                                                                                    
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   l_partkey = ps_partkey  ├──────────────┐                                                                                                     
                             │          EC: 8000         ││   l_suppkey = ps_suppkey  │              │                                                                                                     
                             │                           ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                                                                                     
                             │                           ││        EC: 1200243        │              │                                                                                                     
                             └─────────────┬─────────────┘└─────────────┬─────────────┘              │                                                                                                                                  
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                       
                             │         SEQ_SCAN          ││         SEQ_SCAN          ││         DELIM_SCAN        │                                                                                       
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                                                                       
                             │            part           ││          lineitem         ││                           │                                                                                       
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                                                                       
                             │           p_name          ││         l_partkey         ││                           │                                                                                       
                             │         p_partkey         ││         l_suppkey         ││                           │                                                                                       
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││         l_quantity        ││                           │                                                                                       
                             │ Filters: p_name>='forest' ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                                                                       
                             │   AND p_name<'foresu' AND ││ Filters: l_shipdate>='1994││                           │                                                                                       
                             │     p_name IS NOT NULL    ││-01-01'::DATE AND l_sh...  ││                           │                                                                                       
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││  <'1995-01-01'::DATE AND  ││                           │                                                                                       
                             │         EC: 40000         ││   l_shipdate IS NOT NULL  ││                           │                                                                                       
                             │                           ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                                                                       
                             │                           ││        EC: 1200243        ││                           │                                                                                       
                             └───────────────────────────┘└───────────────────────────┘└───────────────────────────┘                                                                                                                    

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

%%%%%%%%%%%%%%%% Running Query #  20  threads:  16
SELECT s_name, s_address FROM supplier, nation WHERE s_suppkey IN ( SELECT ps_suppkey FROM partsupp WHERE ps_partkey IN ( SELECT p_partkey FROM part WHERE p_name LIKE 'forest%') AND ps_availqty > ( SELECT 0.5 * sum(l_quantity) FROM lineitem WHERE l_partkey = ps_partkey AND l_suppkey = ps_suppkey AND l_shipdate >= CAST('1994-01-01' AS date) AND l_shipdate < CAST('1995-01-01' AS date))) AND s_nationkey = n_nationkey AND n_name = 'CANADA' ORDER BY s_name;
Run:  None SELECT s_name, s_address FROM supplier, nation WHERE s_suppkey IN ( SELECT ps_suppkey FROM partsupp WHERE ps_partkey IN ( SELECT p_partkey FROM part WHERE p_name LIKE 'forest%') AND ps_availqty > ( SELECT 0.5 * sum(l_quantity) FROM lineitem WHERE l_partkey = ps_partkey AND l_suppkey = ps_suppkey AND l_shipdate >= CAST('1994-01-01' AS date) AND l_shipdate < CAST('1995-01-01' AS date))) AND s_nationkey = n_nationkey AND n_name = 'CANADA' ORDER BY s_name;
Avg Time in sec:  0.058550816029310226  output size:  186
                 s_name                               s_address
0    Supplier#000000020               JtPqm19E7tF 152Rl1wQZ8j0H
1    Supplier#000000091    35WVnU7GLNbQDcc2TARavGtk6RB6ZCd46UAY
2    Supplier#000000205                            Alrx5TN,hdnG
3    Supplier#000000285           q TMZEDyZtv vUiFKBhT3NJlnIxpL
4    Supplier#000000287                       UQR8bUA4V2HxVbw9K
..                  ...                                     ...
181  Supplier#000009811                  nXIxtBT6D1v6TCb2iMYkyU
182  Supplier#000009812     rbl9euXFoPLlKQVYDVyRouslbbbKDHAkyXY
183  Supplier#000009846  WTzdvihXbyqnx0JfbbVaxBOcO9d93DYbtBhi J
184  Supplier#000009899                       U3NBqk s Zz06al2m
185  Supplier#000009974         Uvh0hWngOu96WgB,OafBQOqwpWqzwg8

[186 rows x 2 columns]
{'name': 'Query', 'result': 0.049442, 'timing': 0.049442, 'cardinality': 0, 'extra-info': "SELECT s_name, s_address FROM supplier, nation WHERE s_suppkey IN ( SELECT ps_suppkey FROM partsupp WHERE ps_partkey IN ( SELECT p_partkey FROM part WHERE p_name LIKE 'forest%') AND ps_availqty > ( SELECT 0.5 * sum(l_quantity) FROM lineitem WHERE l_partkey = ps_partkey AND l_suppkey = ps_suppkey AND l_shipdate >= CAST('1994-01-01' AS date) AND l_shipdate < CAST('1995-01-01' AS date))) AND s_nationkey = n_nationkey AND n_name = 'CANADA' ORDER BY s_name;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 6.1e-05, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'ORDER_BY', 'timing': 0.000469, 'cardinality': 186, 'extra_info': 'ORDERS:\nsupplier.s_name ASC', 'children': [{'name': 'PROJECTION', 'timing': 6e-06, 'cardinality': 186, 'extra_info': 's_name\ns_address\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.000984, 'cardinality': 186, 'extra_info': 'INNER\n#0 = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 400\n', 'children': [{'name': 'PROJECTION', 'timing': 3.9e-05, 'cardinality': 4397, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.007912, 'cardinality': 4397, 'extra_info': '#0', 'children': [{'name': 'PROJECTION', 'timing': 7e-06, 'cardinality': 5833, 'extra_info': '#0\n', 'children': [{'name': 'PROJECTION', 'timing': 5.8e-05, 'cardinality': 5833, 'extra_info': '__internal_compress_integral_usmallint(#0, 1)\n', 'children': [{'name': 'PROJECTION', 'timing': 8e-06, 'cardinality': 5833, 'extra_info': 'ps_suppkey\n', 'children': [{'name': 'PROJECTION', 'timing': 1.6e-05, 'cardinality': 5833, 'extra_info': '#0\n#4\n#5\n', 'children': [{'name': 'FILTER', 'timing': 0.000692, 'cardinality': 5833, 'extra_info': '(CAST(ps_availqty AS DECIMAL(38,3)) > SUBQUERY)\n[INFOSEPARATOR]\nEC: 800000', 'children': [{'name': 'RIGHT_DELIM_JOIN', 'timing': 0.00929, 'cardinality': 0, 'extra_info': 'RIGHT\nps_partkey IS NOT DISTINCT FROM ps_partkey\nps_suppkey IS NOT DISTINCT FROM ps_suppkey\n\n[INFOSEPARATOR]\nEC: 800000\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.019399, 'cardinality': 8508, 'extra_info': 'INNER\nps_partkey = #0\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 800000\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.003975, 'cardinality': 800000, 'extra_info': 'partsupp\n[INFOSEPARATOR]\nps_partkey\nps_availqty\nps_suppkey\n[INFOSEPARATOR]\nEC: 800000', 'children': []}, {'name': 'PROJECTION', 'timing': 5e-05, 'cardinality': 2127, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.004542, 'cardinality': 2127, 'extra_info': '#0', 'children': [{'name': 'PROJECTION', 'timing': 2e-06, 'cardinality': 2127, 'extra_info': '#0\n', 'children': [{'name': 'PROJECTION', 'timing': 9e-06, 'cardinality': 2127, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n', 'children': [{'name': 'PROJECTION', 'timing': 3e-06, 'cardinality': 2127, 'extra_info': 'p_partkey\n', 'children': [{'name': 'FILTER', 'timing': 0.000691, 'cardinality': 2127, 'extra_info': "prefix(p_name, 'forest')\n[INFOSEPARATOR]\nEC: 8000", 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.013397, 'cardinality': 2127, 'extra_info': "part\n[INFOSEPARATOR]\np_name\np_partkey\n[INFOSEPARATOR]\nFilters: p_name>='forest' AND p_name<'foresu' AND p_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 40000", 'children': []}]}]}]}]}]}]}]}, {'name': 'HASH_JOIN', 'timing': 0.001818, 'cardinality': 8508, 'extra_info': 'RIGHT\nps_partkey IS NOT DISTINCT FROM ps_partkey\nps_suppkey IS NOT DISTINCT FROM ps_suppkey\n\n[INFOSEPARATOR]\nEC: 800000\n', 'children': [{'name': 'PROJECTION', 'timing': 0.000287, 'cardinality': 5843, 'extra_info': '(0.5 * sum(l_quantity))\nps_partkey\nps_suppkey\n', 'children': [{'name': 'PROJECTION', 'timing': 5.8e-05, 'cardinality': 5843, 'extra_info': '__internal_decompress_integral_bigint(#0, 1)\n__internal_decompress_integral_bigint(#1, 1)\n#2\n', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.014871, 'cardinality': 5843, 'extra_info': '#0\n#1\nsum(#2)', 'children': [{'name': 'PROJECTION', 'timing': 2.2e-05, 'cardinality': 9741, 'extra_info': 'ps_partkey\nps_suppkey\nl_quantity\n', 'children': [{'name': 'PROJECTION', 'timing': 0.0002, 'cardinality': 9741, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n__internal_compress_integral_usmallint(#1, 1)\n#2\n#3\n#4\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.124284, 'cardinality': 9741, 'extra_info': 'INNER\nl_partkey = ps_partkey\nl_suppkey = ps_suppkey\n\n[INFOSEPARATOR]\nEC: 1200243\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.109669, 'cardinality': 909455, 'extra_info': "lineitem\n[INFOSEPARATOR]\nl_partkey\nl_suppkey\nl_quantity\n[INFOSEPARATOR]\nFilters: l_shipdate>='1994-01-01'::DATE AND l_shipdate<'1995-01-01'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243", 'children': []}, {'name': 'DELIM_SCAN', 'timing': 0.0, 'cardinality': 0, 'extra_info': '', 'children': []}]}]}]}]}]}]}, {'name': 'DUMMY_SCAN', 'timing': 0.0, 'cardinality': 0, 'extra_info': '', 'children': []}]}, {'name': 'HASH_GROUP_BY', 'timing': 0.00378, 'cardinality': 8508, 'extra_info': '#0\n#2', 'children': []}]}]}]}]}]}]}]}]}, {'name': 'HASH_JOIN', 'timing': 0.000265, 'cardinality': 412, 'extra_info': 'INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 400\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.001169, 'cardinality': 10000, 'extra_info': 'supplier\n[INFOSEPARATOR]\n\n[INFOSEPARATOR]\nEC: 10000', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 6.2e-05, 'cardinality': 1, 'extra_info': "nation\n[INFOSEPARATOR]\n\n[INFOSEPARATOR]\nFilters: n_name='CANADA' AND n_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1", 'children': []}]}]}]}]}]}]}
X {'RESULT_COLLECTOR0': 6.1e-05, 'ORDER_BY1': 0.000469, 'PROJECTION2': 6e-06, 'HASH_JOIN3': 0.000984, 'PROJECTION4': 3.9e-05, 'HASH_GROUP_BY5': 0.007912, 'PROJECTION6': 7e-06, 'PROJECTION7': 5.8e-05, 'PROJECTION8': 8e-06, 'PROJECTION9': 1.6e-05, 'FILTER10': 0.000692, 'RIGHT_DELIM_JOIN11': 0.00929, 'HASH_JOIN12': 0.019399, 'SEQ_SCAN 13': 0.003975, 'PROJECTION14': 5e-05, 'HASH_GROUP_BY15': 0.004542, 'PROJECTION16': 2e-06, 'PROJECTION17': 9e-06, 'PROJECTION18': 3e-06, 'FILTER19': 0.000691, 'SEQ_SCAN 20': 0.013397, 'HASH_JOIN21': 0.001818, 'PROJECTION22': 0.000287, 'PROJECTION23': 5.8e-05, 'HASH_GROUP_BY24': 0.014871, 'PROJECTION25': 2.2e-05, 'PROJECTION26': 0.0002, 'HASH_JOIN27': 0.124284, 'SEQ_SCAN 28': 0.109669, 'DELIM_SCAN29': 0.0, 'DUMMY_SCAN30': 0.0, 'HASH_GROUP_BY31': 0.00378, 'HASH_JOIN32': 0.000265, 'SEQ_SCAN 33': 0.001169, 'SEQ_SCAN 34': 6.2e-05}
compressed filter_log_size: 9677
compressed filter_log_buffer_size: 1299
compressed limit_offset_size: 4912
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 15210
compressed perfect_full_scan_ht_log_buffer_size: 9146
compressed perfect_probe_ht_log_size: 64074
compressed perfect_probe_ht_log_buffer_size: 48369
compressed row_group_log_size: 708489
compressed row_group_log_buffer_size: 653359
compressed scatter_log_size: 110312
compressed scatter_log_buffer_size: 100637
compressed scatter_sel_log_size: 78967
compressed scatter_sel_log_buffer_size: 68275
compressed gather_log_size: 4912
compressed gather_log_buffer_size: 0
compressed combine_log_size: 265497
compressed combine_log_buffer_size: 254653
compressed finalize_states_log_size: 14044
compressed finalize_states_log_buffer_size: 4668
compressed join_gather_log_size: 220613
compressed join_gather_log_buffer_size: 156972
compressed reorder_log_size: 8077
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 4912
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 4912
compressed nlj_log_buffer_size: 0
compressed total_size: 1514608
compressed total_buffer_size: 1297378
compressed total_element_size: 217230

Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌─────────────────────┐                                                                                                                                                                                                               
│        LIMIT        │                                                                                                                                                                                                               
└──────────┬──────────┘                                                                                                                                                                                                                                      
┌──────────┴──────────┐                                                                                                                                                                                                               
│       ORDER_BY      │                                                                                                                                                                                                               
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                               
│       ORDERS:       │                                                                                                                                                                                                               
│  count_star() DESC  │                                                                                                                                                                                                               
│ supplier.s_name ASC │                                                                                                                                                                                                               
└──────────┬──────────┘                                                                                                                                                                                                                                      
┌──────────┴──────────┐                                                                                                                                                                                                               
│    HASH_GROUP_BY    │                                                                                                                                                                                                               
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                               
│          #0         │                                                                                                                                                                                                               
│     count_star()    │                                                                                                                                                                                                               
└──────────┬──────────┘                                                                                                                                                                                                                                      
┌──────────┴──────────┐                                                                                                                                                                                                               
│      PROJECTION     │                                                                                                                                                                                                               
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                               
│        s_name       │                                                                                                                                                                                                               
└──────────┬──────────┘                                                                                                                                                                                                                                      
┌──────────┴──────────┐                                                                                                                                                                                                               
│      PROJECTION     │                                                                                                                                                                                                               
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                               
│__internal_compress_i│                                                                                                                                                                                                               
│ ntegral_uinteger(#0,│                                                                                                                                                                                                               
│          1)         │                                                                                                                                                                                                               
│__internal_compress_i│                                                                                                                                                                                                               
│ntegral_usmallint(#1,│                                                                                                                                                                                                               
│          1)         │                                                                                                                                                                                                               
│__internal_compress_i│                                                                                                                                                                                                               
│ ntegral_uinteger(#2,│                                                                                                                                                                                                               
│          1)         │                                                                                                                                                                                                               
│          #3         │                                                                                                                                                                                                               
└──────────┬──────────┘                                                                                                                                                                                                                                      
┌──────────┴──────────┐                                                                                                                                                                                                               
│   RIGHT_DELIM_JOIN  │                                                                                                                                                                                                               
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                               
│      RIGHT_ANTI     │                                                                                                                                                                                                               
│  l_orderkey IS NOT  │                                                                                                                                                                                                               
│ DISTINCT FROM l...  ├─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐                                                         
│   l_suppkey IS NOT  │                                                                                                                                                     │                                                         
│ DISTINCT FROM l...  │                                                                                                                                                     │                                                         
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                     │                                                         
│     EC: 6001215     │                                                                                                                                                     │                                                         
└──────────┬──────────┘                                                                                                                                                     │                                                                                
┌──────────┴──────────┐                                                                                                                                          ┌──────────┴──────────┐                                              
│   RIGHT_DELIM_JOIN  │                                                                                                                                          │      HASH_JOIN      │                                              
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                          │   ─ ─ ─ ─ ─ ─ ─ ─   │                                              
│      RIGHT_SEMI     │                                                                                                                                          │      RIGHT_ANTI     │                                              
│  l_orderkey IS NOT  │                                                                                                                                          │  l_orderkey IS NOT  │                                              
│ DISTINCT FROM l...  ├────────────────────────────────────────────────────────────────────────────────┐                                                         │ DISTINCT FROM l...  ├──────────────────────────────────┐           
│   l_suppkey IS NOT  │                                                                                │                                                         │   l_suppkey IS NOT  │                                  │           
│ DISTINCT FROM l...  │                                                                                │                                                         │ DISTINCT FROM l...  │                                  │           
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                │                                                         │   ─ ─ ─ ─ ─ ─ ─ ─   │                                  │           
│     EC: 6001215     │                                                                                │                                                         │     EC: 6001215     │                                  │           
└──────────┬──────────┘                                                                                │                                                         └──────────┬──────────┘                                  │                                  
┌──────────┴──────────┐                                                                     ┌──────────┴──────────┐                                              ┌──────────┴──────────┐                       ┌──────────┴──────────┐
│      HASH_JOIN      │                                                                     │      HASH_JOIN      │                                              │      PROJECTION     │                       │      DUMMY_SCAN     │
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                     │   ─ ─ ─ ─ ─ ─ ─ ─   │                                              │   ─ ─ ─ ─ ─ ─ ─ ─   │                       │                     │
│        INNER        │                                                                     │      RIGHT_SEMI     │                                              │      l_orderkey     │                       │                     │
│     o_orderkey =    │                                                                     │  l_orderkey IS NOT  │                                              │      l_suppkey      │                       │                     │
│      l_orderkey     ├───────────┐                                                         │ DISTINCT FROM l...  ├──────────────────────────────────┐           │                     │                       │                     │
│   ─ ─ ─ ─ ─ ─ ─ ─   │           │                                                         │   l_suppkey IS NOT  │                                  │           │                     │                       │                     │
│      EC: 15866      │           │                                                         │ DISTINCT FROM l...  │                                  │           │                     │                       │                     │
│                     │           │                                                         │   ─ ─ ─ ─ ─ ─ ─ ─   │                                  │           │                     │                       │                     │
│                     │           │                                                         │     EC: 6001215     │                                  │           │                     │                       │                     │
└──────────┬──────────┘           │                                                         └──────────┬──────────┘                                  │           └──────────┬──────────┘                       └─────────────────────┘                       
┌──────────┴──────────┐┌──────────┴──────────┐                                              ┌──────────┴──────────┐                       ┌──────────┴──────────┐┌──────────┴──────────┐                                              
│      SEQ_SCAN       ││      HASH_JOIN      │                                              │      PROJECTION     │                       │      DUMMY_SCAN     ││      HASH_JOIN      │                                              
│   ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─   │                                              │   ─ ─ ─ ─ ─ ─ ─ ─   │                       │                     ││   ─ ─ ─ ─ ─ ─ ─ ─   │                                              
│        orders       ││        INNER        │                                              │      l_orderkey     │                       │                     ││        INNER        │                                              
│   ─ ─ ─ ─ ─ ─ ─ ─   ││l_suppkey = s_suppkey│                                              │      l_suppkey      │                       │                     ││     l_orderkey =    │                                              
│      o_orderkey     ││   ─ ─ ─ ─ ─ ─ ─ ─   │                                              │                     │                       │                     ││      l_orderkey     │                                              
│   ─ ─ ─ ─ ─ ─ ─ ─   ││     Build Min: 1    ├───────────┐                                  │                     │                       │                     ││     l_suppkey !=    ├───────────┐                                  
│Filters: o_orderstatu││   Build Max: 10000  │           │                                  │                     │                       │                     ││       l_suppkey     │           │                                  
│      s='F' AND      ││   ─ ─ ─ ─ ─ ─ ─ ─   │           │                                  │                     │                       │                     ││   ─ ─ ─ ─ ─ ─ ─ ─   │           │                                  
│ o_orderstatus I...  ││      EC: 47600      │           │                                  │                     │                       │                     ││     EC: 1200243     │           │                                  
│   ─ ─ ─ ─ ─ ─ ─ ─   ││                     │           │                                  │                     │                       │                     ││                     │           │                                  
│      EC: 500000     ││                     │           │                                  │                     │                       │                     ││                     │           │                                  
└─────────────────────┘└──────────┬──────────┘           │                                  └──────────┬──────────┘                       └─────────────────────┘└──────────┬──────────┘           │                                                         
                       ┌──────────┴──────────┐┌──────────┴──────────┐                       ┌──────────┴──────────┐                                              ┌──────────┴──────────┐┌──────────┴──────────┐                       
                       │        FILTER       ││      HASH_JOIN      │                       │      HASH_JOIN      │                                              │        FILTER       ││      DELIM_SCAN     │                       
                       │   ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─   │                       │   ─ ─ ─ ─ ─ ─ ─ ─   │                                              │   ─ ─ ─ ─ ─ ─ ─ ─   ││                     │                       
                       │   (l_receiptdate >  ││        INNER        │                       │        INNER        │                                              │   (l_receiptdate >  ││                     │                       
                       │     l_commitdate)   ││    s_nationkey =    │                       │     l_orderkey =    │                                              │     l_commitdate)   ││                     │                       
                       │   ─ ─ ─ ─ ─ ─ ─ ─   ││      n_nationkey    │                       │      l_orderkey     │                                              │   ─ ─ ─ ─ ─ ─ ─ ─   ││                     │                       
                       │     EC: 1200243     ││   ─ ─ ─ ─ ─ ─ ─ ─   ├───────────┐           │     l_suppkey !=    ├───────────┐                                  │     EC: 6001215     ││                     │                       
                       │                     ││     Build Min: 0    │           │           │       l_suppkey     │           │                                  │                     ││                     │                       
                       │                     ││    Build Max: 24    │           │           │   ─ ─ ─ ─ ─ ─ ─ ─   │           │                                  │                     ││                     │                       
                       │                     ││   ─ ─ ─ ─ ─ ─ ─ ─   │           │           │     EC: 6001215     │           │                                  │                     ││                     │                       
                       │                     ││       EC: 400       │           │           │                     │           │                                  │                     ││                     │                       
                       └──────────┬──────────┘└──────────┬──────────┘           │           └──────────┬──────────┘           │                                  └──────────┬──────────┘└─────────────────────┘                                              
                       ┌──────────┴──────────┐┌──────────┴──────────┐┌──────────┴──────────┐┌──────────┴──────────┐┌──────────┴──────────┐                       ┌──────────┴──────────┐                                              
                       │      SEQ_SCAN       ││      SEQ_SCAN       ││      SEQ_SCAN       ││      SEQ_SCAN       ││      DELIM_SCAN     │                       │      SEQ_SCAN       │                                              
                       │   ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─   ││                     │                       │   ─ ─ ─ ─ ─ ─ ─ ─   │                                              
                       │       lineitem      ││       supplier      ││        nation       ││       lineitem      ││                     │                       │       lineitem      │                                              
                       │   ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─   ││                     │                       │   ─ ─ ─ ─ ─ ─ ─ ─   │                                              
                       │      l_suppkey      ││      s_suppkey      ││     n_nationkey     ││      l_orderkey     ││                     │                       │      l_orderkey     │                                              
                       │      l_orderkey     ││     s_nationkey     ││   ─ ─ ─ ─ ─ ─ ─ ─   ││      l_suppkey      ││                     │                       │      l_suppkey      │                                              
                       │    l_receiptdate    ││        s_name       ││   Filters: n_name=  ││   ─ ─ ─ ─ ─ ─ ─ ─   ││                     │                       │    l_receiptdate    │                                              
                       │     l_commitdate    ││   ─ ─ ─ ─ ─ ─ ─ ─   ││'SAUDI ARABIA' A...  ││     EC: 6001215     ││                     │                       │     l_commitdate    │                                              
                       │   ─ ─ ─ ─ ─ ─ ─ ─   ││      EC: 10000      ││      IS NOT NULL    ││                     ││                     │                       │   ─ ─ ─ ─ ─ ─ ─ ─   │                                              
                       │     EC: 1200243     ││                     ││   ─ ─ ─ ─ ─ ─ ─ ─   ││                     ││                     │                       │     EC: 6001215     │                                              
                       │                     ││                     ││        EC: 1        ││                     ││                     │                       │                     │                                              
                       └─────────────────────┘└─────────────────────┘└─────────────────────┘└─────────────────────┘└─────────────────────┘                       └─────────────────────┘                                                                     

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

**** output size:  186
LINEAGE_5_FILTER_13
LINEAGE_5_FILTER_21
LINEAGE_5_HASH_GROUP_BY_10
LINEAGE_5_HASH_GROUP_BY_17
LINEAGE_5_HASH_GROUP_BY_26
LINEAGE_5_HASH_GROUP_BY_5
LINEAGE_5_HASH_JOIN_19
LINEAGE_5_HASH_JOIN_2
LINEAGE_5_HASH_JOIN_30
LINEAGE_5_HASH_JOIN_31
LINEAGE_5_HASH_JOIN_9
LINEAGE_5_ORDER_BY_33
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_11
LINEAGE_5_SEQ_SCAN_12
LINEAGE_5_SEQ_SCAN_28
LINEAGE_5_SEQ_SCAN_29
SELECT s_name, s_address FROM supplier, nation WHERE s_suppkey IN ( SELECT ps_suppkey FROM partsupp WHERE ps_partkey IN ( SELECT p_partkey FROM part WHERE p_name LIKE 'forest%') AND ps_availqty > ( SELECT 0.5 * sum(l_quantity) FROM lineitem WHERE l_partkey = ps_partkey AND l_suppkey = ps_suppkey AND l_shipdate >= CAST('1994-01-01' AS date) AND l_shipdate < CAST('1995-01-01' AS date))) AND s_nationkey = n_nationkey AND n_name = 'CANADA' ORDER BY s_name;
   query_id  ...                                               plan
0         5  ...  {"name": "ORDER_BY", "opid": "33", "children":...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               SELECT s_name, s_address FROM supplier, nation...
size_bytes_max                                                1514608
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "ORDER_BY", "opid": "33", "children":...
Name: 0, dtype: object
{"name": "ORDER_BY", "opid": "33", "children": [{"name": "PROJECTION", "opid": "32", "children": [{"name": "HASH_JOIN", "opid": "31", "children": [{"name": "PROJECTION", "opid": "27", "children": [{"name": "HASH_GROUP_BY", "opid": "26", "children": [{"name": "PROJECTION", "opid": "25", "children": [{"name": "PROJECTION", "opid": "24", "children": [{"name": "PROJECTION", "opid": "23", "children": [{"name": "PROJECTION", "opid": "22", "children": [{"name": "FILTER", "opid": "21", "children": [{"name": "RIGHT_DELIM_JOIN", "opid": "20", "children": [{"name": "HASH_GROUP_BY", "opid": "10", "children": [],"table": "","extra": "#0\n#2"},{"name": "HASH_JOIN", "opid": "9", "children": [{"name": "PROJECTION", "opid": "7", "children": [{"name": "PROJECTION", "opid": "6", "children": [{"name": "HASH_GROUP_BY", "opid": "5", "children": [{"name": "PROJECTION", "opid": "4", "children": [{"name": "PROJECTION", "opid": "3", "children": [{"name": "HASH_JOIN", "opid": "2", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_partkey\nl_suppkey\nl_quantity\n[INFOSEPARATOR]\nFilters: l_shipdate>='1994-01-01'::DATE AND l_shipdate<'1995-01-01'::DATE AND l_shipdate IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1200243"},{"name": "DELIM_SCAN", "opid": "1", "children": [],"table": "","extra": ""}],"table": "","extra": "INNER\nl_partkey = ps_partkey\nl_suppkey = ps_suppkey\n\n[INFOSEPARATOR]\nEC: 1200243\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n__internal_compress_integral_usmallint(#1, 1)\n#2\n#3\n#4\n"}],"table": "","extra": "ps_partkey\nps_suppkey\nl_quantity\n"}],"table": "","extra": "#0\n#1\nsum(#2)"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n__internal_decompress_integral_bigint(#1, 1)\n#2\n"}],"table": "","extra": "(0.5 * sum(l_quantity))\nps_partkey\nps_suppkey\n"},{"name": "DUMMY_SCAN", "opid": "8", "children": [],"table": "","extra": ""}],"table": "","extra": "RIGHT\nps_partkey IS NOT DISTINCT FROM ps_partkey\nps_suppkey IS NOT DISTINCT FROM ps_suppkey\n\n[INFOSEPARATOR]\nEC: 800000\n"},{"name": "HASH_JOIN", "opid": "19", "children": [{"name": "SEQ_SCAN ", "opid": "11", "children": [],"table": "partsupp","extra": "partsupp\n[INFOSEPARATOR]\nps_partkey\nps_availqty\nps_suppkey\n[INFOSEPARATOR]\nEC: 800000"},{"name": "PROJECTION", "opid": "18", "children": [{"name": "HASH_GROUP_BY", "opid": "17", "children": [{"name": "PROJECTION", "opid": "16", "children": [{"name": "PROJECTION", "opid": "15", "children": [{"name": "PROJECTION", "opid": "14", "children": [{"name": "FILTER", "opid": "13", "children": [{"name": "SEQ_SCAN ", "opid": "12", "children": [],"table": "part","extra": "part\n[INFOSEPARATOR]\np_name\np_partkey\n[INFOSEPARATOR]\nFilters: p_name>='forest' AND p_name<'foresu' AND p_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 40000"}],"table": "","extra": "prefix(p_name, 'forest')\n[INFOSEPARATOR]\nEC: 8000"}],"table": "","extra": "p_partkey\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n"}],"table": "","extra": "#0\n"}],"table": "","extra": "#0"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n"}],"table": "","extra": "INNER\nps_partkey = #0\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 200000\n\n[INFOSEPARATOR]\nEC: 800000\n"}],"table": "","extra": "RIGHT\nps_partkey IS NOT DISTINCT FROM ps_partkey\nps_suppkey IS NOT DISTINCT FROM ps_suppkey\n\n[INFOSEPARATOR]\nEC: 800000\n"}],"table": "","extra": "(CAST(ps_availqty AS DECIMAL(38,3)) > SUBQUERY)\n[INFOSEPARATOR]\nEC: 800000"}],"table": "","extra": "#0\n#4\n#5\n"}],"table": "","extra": "ps_suppkey\n"}],"table": "","extra": "__internal_compress_integral_usmallint(#0, 1)\n"}],"table": "","extra": "#0\n"}],"table": "","extra": "#0"}],"table": "","extra": "__internal_decompress_integral_bigint(#0, 1)\n"},{"name": "HASH_JOIN", "opid": "30", "children": [{"name": "SEQ_SCAN ", "opid": "28", "children": [],"table": "supplier","extra": "supplier\n[INFOSEPARATOR]\n\n[INFOSEPARATOR]\nEC: 10000"},{"name": "SEQ_SCAN ", "opid": "29", "children": [],"table": "nation","extra": "nation\n[INFOSEPARATOR]\n\n[INFOSEPARATOR]\nFilters: n_name='CANADA' AND n_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1"}],"table": "","extra": "INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 400\n"}],"table": "","extra": "INNER\n#0 = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 400\n"}],"table": "","extra": "s_name\ns_address\n"}],"table": "","extra": "ORDERS:\nsupplier.s_name ASC"}
%%%%%%%%%%%%%%%% Running Query #  21  threads:  16
SELECT s_name, count(*) AS numwait FROM supplier, lineitem l1, orders, nation WHERE s_suppkey = l1.l_suppkey AND o_orderkey = l1.l_orderkey AND o_orderstatus = 'F' AND l1.l_receiptdate > l1.l_commitdate AND EXISTS ( SELECT * FROM lineitem l2 WHERE l2.l_orderkey = l1.l_orderkey AND l2.l_suppkey <> l1.l_suppkey) AND NOT EXISTS ( SELECT * FROM lineitem l3 WHERE l3.l_orderkey = l1.l_orderkey AND l3.l_suppkey <> l1.l_suppkey AND l3.l_receiptdate > l3.l_commitdate) AND s_nationkey = n_nationkey AND n_name = 'SAUDI ARABIA' GROUP BY s_name ORDER BY numwait DESC, s_name LIMIT 100;
Run:  None SELECT s_name, count(*) AS numwait FROM supplier, lineitem l1, orders, nation WHERE s_suppkey = l1.l_suppkey AND o_orderkey = l1.l_orderkey AND o_orderstatus = 'F' AND l1.l_receiptdate > l1.l_commitdate AND EXISTS ( SELECT * FROM lineitem l2 WHERE l2.l_orderkey = l1.l_orderkey AND l2.l_suppkey <> l1.l_suppkey) AND NOT EXISTS ( SELECT * FROM lineitem l3 WHERE l3.l_orderkey = l1.l_orderkey AND l3.l_suppkey <> l1.l_suppkey AND l3.l_receiptdate > l3.l_commitdate) AND s_nationkey = n_nationkey AND n_name = 'SAUDI ARABIA' GROUP BY s_name ORDER BY numwait DESC, s_name LIMIT 100;
Avg Time in sec:  0.1735544577240944  output size:  100
                s_name  numwait
0   Supplier#000002829       20
1   Supplier#000005808       18
2   Supplier#000000262       17
3   Supplier#000000496       17
4   Supplier#000002160       17
..                 ...      ...
95  Supplier#000001916       12
96  Supplier#000001925       12
97  Supplier#000002039       12
98  Supplier#000002357       12
99  Supplier#000002483       12

[100 rows x 2 columns]
{'name': 'Query', 'result': 0.145405, 'timing': 0.145405, 'cardinality': 0, 'extra-info': "SELECT s_name, count(*) AS numwait FROM supplier, lineitem l1, orders, nation WHERE s_suppkey = l1.l_suppkey AND o_orderkey = l1.l_orderkey AND o_orderstatus = 'F' AND l1.l_receiptdate > l1.l_commitdate AND EXISTS ( SELECT * FROM lineitem l2 WHERE l2.l_orderkey = l1.l_orderkey AND l2.l_suppkey <> l1.l_suppkey) AND NOT EXISTS ( SELECT * FROM lineitem l3 WHERE l3.l_orderkey = l1.l_orderkey AND l3.l_suppkey <> l1.l_suppkey AND l3.l_receiptdate > l3.l_commitdate) AND s_nationkey = n_nationkey AND n_name = 'SAUDI ARABIA' GROUP BY s_name ORDER BY numwait DESC, s_name LIMIT 100;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 2.1e-05, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'LIMIT', 'timing': 0.000196, 'cardinality': 100, 'extra_info': '', 'children': [{'name': 'ORDER_BY', 'timing': 0.000621, 'cardinality': 411, 'extra_info': 'ORDERS:\ncount_star() DESC\nsupplier.s_name ASC', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.003252, 'cardinality': 411, 'extra_info': '#0\ncount_star()', 'children': [{'name': 'PROJECTION', 'timing': 4e-06, 'cardinality': 4141, 'extra_info': 's_name\n', 'children': [{'name': 'PROJECTION', 'timing': 4.3e-05, 'cardinality': 4141, 'extra_info': '__internal_compress_integral_uinteger(#0, 1)\n__internal_compress_integral_usmallint(#1, 1)\n__internal_compress_integral_uinteger(#2, 1)\n#3\n', 'children': [{'name': 'RIGHT_DELIM_JOIN', 'timing': 0.01426, 'cardinality': 0, 'extra_info': 'RIGHT_ANTI\nl_orderkey IS NOT DISTINCT FROM l_orderkey\nl_suppkey IS NOT DISTINCT FROM l_suppkey\n\n[INFOSEPARATOR]\nEC: 6001215\n', 'children': [{'name': 'RIGHT_DELIM_JOIN', 'timing': 0.092329, 'cardinality': 0, 'extra_info': 'RIGHT_SEMI\nl_orderkey IS NOT DISTINCT FROM l_orderkey\nl_suppkey IS NOT DISTINCT FROM l_suppkey\n\n[INFOSEPARATOR]\nEC: 6001215\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.138422, 'cardinality': 75871, 'extra_info': 'INNER\no_orderkey = l_orderkey\n\n[INFOSEPARATOR]\nEC: 15866\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.068638, 'cardinality': 729413, 'extra_info': "orders\n[INFOSEPARATOR]\no_orderkey\n[INFOSEPARATOR]\nFilters: o_orderstatus='F' AND o_orderstatus IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 500000", 'children': []}, {'name': 'HASH_JOIN', 'timing': 0.128827, 'cardinality': 156739, 'extra_info': 'INNER\nl_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 47600\n', 'children': [{'name': 'FILTER', 'timing': 0.063746, 'cardinality': 3793296, 'extra_info': '(l_receiptdate > l_commitdate)\n[INFOSEPARATOR]\nEC: 1200243', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.035626, 'cardinality': 6001215, 'extra_info': 'lineitem\n[INFOSEPARATOR]\nl_suppkey\nl_orderkey\nl_receiptdate\nl_commitdate\n[INFOSEPARATOR]\nEC: 1200243', 'children': []}]}, {'name': 'HASH_JOIN', 'timing': 0.000104, 'cardinality': 411, 'extra_info': 'INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 400\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.000258, 'cardinality': 10000, 'extra_info': 'supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\ns_name\n[INFOSEPARATOR]\nEC: 10000', 'children': []}, {'name': 'SEQ_SCAN ', 'timing': 2.7e-05, 'cardinality': 1, 'extra_info': "nation\n[INFOSEPARATOR]\nn_nationkey\n[INFOSEPARATOR]\nFilters: n_name='SAUDI ARABIA' AND n_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1", 'children': []}]}]}]}, {'name': 'HASH_JOIN', 'timing': 0.068942, 'cardinality': 73089, 'extra_info': 'RIGHT_SEMI\nl_orderkey IS NOT DISTINCT FROM l_orderkey\nl_suppkey IS NOT DISTINCT FROM l_suppkey\n\n[INFOSEPARATOR]\nEC: 6001215\n', 'children': [{'name': 'PROJECTION', 'timing': 0.00129, 'cardinality': 302356, 'extra_info': 'l_orderkey\nl_suppkey\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.178016, 'cardinality': 302356, 'extra_info': 'INNER\nl_orderkey = l_orderkey\nl_suppkey != l_suppkey\n\n[INFOSEPARATOR]\nEC: 6001215\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.012881, 'cardinality': 6001215, 'extra_info': 'lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_suppkey\n[INFOSEPARATOR]\nEC: 6001215', 'children': []}, {'name': 'DELIM_SCAN', 'timing': 0.0, 'cardinality': 0, 'extra_info': '', 'children': []}]}]}, {'name': 'DUMMY_SCAN', 'timing': 0.0, 'cardinality': 0, 'extra_info': '', 'children': []}]}, {'name': 'HASH_GROUP_BY', 'timing': 0.008613, 'cardinality': 75864, 'extra_info': '#0\n#1', 'children': []}]}, {'name': 'HASH_JOIN', 'timing': 0.03734, 'cardinality': 4141, 'extra_info': 'RIGHT_ANTI\nl_orderkey IS NOT DISTINCT FROM l_orderkey\nl_suppkey IS NOT DISTINCT FROM l_suppkey\n\n[INFOSEPARATOR]\nEC: 6001215\n', 'children': [{'name': 'PROJECTION', 'timing': 0.000496, 'cardinality': 190909, 'extra_info': 'l_orderkey\nl_suppkey\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.205292, 'cardinality': 190909, 'extra_info': 'INNER\nl_orderkey = l_orderkey\nl_suppkey != l_suppkey\n\n[INFOSEPARATOR]\nEC: 1200243\n', 'children': [{'name': 'FILTER', 'timing': 0.04506, 'cardinality': 3793296, 'extra_info': '(l_receiptdate > l_commitdate)\n[INFOSEPARATOR]\nEC: 6001215', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.020194, 'cardinality': 6001215, 'extra_info': 'lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_suppkey\nl_receiptdate\nl_commitdate\n[INFOSEPARATOR]\nEC: 6001215', 'children': []}]}, {'name': 'DELIM_SCAN', 'timing': 0.0, 'cardinality': 0, 'extra_info': '', 'children': []}]}]}, {'name': 'DUMMY_SCAN', 'timing': 0.0, 'cardinality': 0, 'extra_info': '', 'children': []}]}, {'name': 'HASH_GROUP_BY', 'timing': 0.011192, 'cardinality': 73082, 'extra_info': '#0\n#1', 'children': []}]}]}]}]}]}]}]}]}
compressed filter_log_size: 1571785
compressed filter_log_buffer_size: 1500330
compressed limit_offset_size: 6224
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 8270
compressed perfect_full_scan_ht_log_buffer_size: 1422
compressed perfect_probe_ht_log_size: 851946
compressed perfect_probe_ht_log_buffer_size: 799990
compressed row_group_log_size: 275604
compressed row_group_log_buffer_size: 187517
compressed scatter_log_size: 319359
compressed scatter_log_buffer_size: 307400
compressed scatter_sel_log_size: 1962081
compressed scatter_sel_log_buffer_size: 1934855
compressed gather_log_size: 6080
compressed gather_log_buffer_size: 0
compressed combine_log_size: 29354
compressed combine_log_buffer_size: 19018
compressed finalize_states_log_size: 69696
compressed finalize_states_log_buffer_size: 59944
compressed join_gather_log_size: 6212136
compressed join_gather_log_buffer_size: 5838894
compressed reorder_log_size: 10021
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 6080
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 6080
compressed nlj_log_buffer_size: 0
compressed total_size: 11334716
compressed total_buffer_size: 10649370
compressed total_element_size: 685346

Clear Lineage

Enable Lineage Capture

Enable Persist Lineage
┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Enable Compress Lineage
┌───────────────────────────┐                                                                                                                                                                              
│          ORDER_BY         │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│          ORDERS:          │                                                                                                                                                                              
│   custsale.cntrycode ASC  │                                                                                                                                                                              
└─────────────┬─────────────┘                                                                                                                                                                                                           
┌─────────────┴─────────────┐                                                                                                                                                                              
│       HASH_GROUP_BY       │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│             #0            │                                                                                                                                                                              
│        count_star()       │                                                                                                                                                                              
│          sum(#1)          │                                                                                                                                                                              
└─────────────┬─────────────┘                                                                                                                                                                                                           
┌─────────────┴─────────────┐                                                                                                                                                                              
│         PROJECTION        │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│         cntrycode         │                                                                                                                                                                              
│         c_acctbal         │                                                                                                                                                                              
└─────────────┬─────────────┘                                                                                                                                                                                                           
┌─────────────┴─────────────┐                                                                                                                                                                              
│         PROJECTION        │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│         cntrycode         │                                                                                                                                                                              
│         c_acctbal         │                                                                                                                                                                              
└─────────────┬─────────────┘                                                                                                                                                                                                           
┌─────────────┴─────────────┐                                                                                                                                                                              
│      RIGHT_DELIM_JOIN     │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│         RIGHT_ANTI        │                                                                                                                                                                              
│ c_custkey IS NOT DISTINCT ├─────────────────────────────────────────────────────────────────────────────────────────────────────┐                                                                        
│       FROM c_custkey      │                                                                                                     │                                                                        
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                     │                                                                        
│        EC: 1500000        │                                                                                                     │                                                                        
└─────────────┬─────────────┘                                                                                                     │                                                                                                     
┌─────────────┴─────────────┐                                                                                       ┌─────────────┴─────────────┐                                                          
│      NESTED_LOOP_JOIN     │                                                                                       │         HASH_JOIN         │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│           INNER           │                                                                                       │         RIGHT_ANTI        │                                                          
│CAST(c_acctbal AS DOUBLE) >├───────────────────────────────────────────┐                                           │ c_custkey IS NOT DISTINCT ├───────────────────────────────────────────┐              
│          SUBQUERY         │                                           │                                           │       FROM c_custkey      │                                           │              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                           │                                           │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                           │              
│           EC: 0           │                                           │                                           │        EC: 1500000        │                                           │              
└─────────────┬─────────────┘                                           │                                           └─────────────┬─────────────┘                                           │                                           
┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐
│           FILTER          │                             │    UNGROUPED_AGGREGATE    │                             │         PROJECTION        │                             │         DUMMY_SCAN        │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │                           │
│          IN (...)         │                             │         first(#0)         │                             │         c_custkey         │                             │                           │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │                           │                             │                           │                             │                           │
│         EC: 30000         │                             │                           │                             │                           │                             │                           │
└─────────────┬─────────────┘                             └─────────────┬─────────────┘                             └─────────────┬─────────────┘                             └───────────────────────────┘                             
┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐                                                          
│         HASH_JOIN         │                             │         PROJECTION        │                             │         HASH_JOIN         │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│            MARK           │                             │             #0            │                             │           INNER           │                                                          
│substring(c_phone, 1, 2) = ├──────────────┐              │                           │                             │   o_custkey = c_custkey   ├──────────────┐                                           
│             #0            │              │              │                           │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │              │                           │                             │        EC: 1500000        │              │                                           
│         EC: 150000        │              │              │                           │                             │                           │              │                                           
└─────────────┬─────────────┘              │              └─────────────┬─────────────┘                             └─────────────┬─────────────┘              │                                                                        
┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             
│         SEQ_SCAN          ││      COLUMN_DATA_SCAN     ││      STREAMING_LIMIT      │                             │         SEQ_SCAN          ││         DELIM_SCAN        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           ││                           │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                             
│          customer         ││                           ││                           │                             │           orders          ││                           │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           ││                           │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                             
│          c_phone          ││                           ││                           │                             │         o_custkey         ││                           │                             
│         c_acctbal         ││                           ││                           │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                             
│         c_custkey         ││                           ││                           │                             │        EC: 1500000        ││                           │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           ││                           │                             │                           ││                           │                             
│         EC: 150000        ││                           ││                           │                             │                           ││                           │                             
└───────────────────────────┘└───────────────────────────┘└─────────────┬─────────────┘                             └───────────────────────────┘└───────────────────────────┘                                                          
                                                          ┌─────────────┴─────────────┐                                                                                                                    
                                                          │    UNGROUPED_AGGREGATE    │                                                                                                                    
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
                                                          │          avg(#0)          │                                                                                                                    
                                                          └─────────────┬─────────────┘                                                                                                                                                 
                                                          ┌─────────────┴─────────────┐                                                                                                                    
                                                          │         PROJECTION        │                                                                                                                    
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
                                                          │         c_acctbal         │                                                                                                                    
                                                          └─────────────┬─────────────┘                                                                                                                                                 
                                                          ┌─────────────┴─────────────┐                                                                                                                    
                                                          │         PROJECTION        │                                                                                                                    
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
                                                          │             #0            │                                                                                                                    
                                                          │             #2            │                                                                                                                    
                                                          └─────────────┬─────────────┘                                                                                                                                                 
                                                          ┌─────────────┴─────────────┐                                                                                                                    
                                                          │           FILTER          │                                                                                                                    
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
                                                          │          IN (...)         │                                                                                                                    
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
                                                          │          EC: 6000         │                                                                                                                    
                                                          └─────────────┬─────────────┘                                                                                                                                                 
                                                          ┌─────────────┴─────────────┐                                                                                                                    
                                                          │         HASH_JOIN         │                                                                                                                    
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
                                                          │            MARK           │                                                                                                                    
                                                          │substring(c_phone, 1, 2) = ├──────────────┐                                                                                                     
                                                          │             #0            │              │                                                                                                     
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                                                                                     
                                                          │         EC: 30000         │              │                                                                                                     
                                                          └─────────────┬─────────────┘              │                                                                                                                                  
                                                          ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                       
                                                          │         SEQ_SCAN          ││      COLUMN_DATA_SCAN     │                                                                                       
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                                                                       
                                                          │          customer         ││                           │                                                                                       
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                                                                       
                                                          │         c_acctbal         ││                           │                                                                                       
                                                          │          c_phone          ││                           │                                                                                       
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                                                                       
                                                          │Filters: c_acctbal>0.00 AND││                           │                                                                                       
                                                          │    c_acctbal IS NOT NULL  ││                           │                                                                                       
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                                                                       
                                                          │         EC: 30000         ││                           │                                                                                       
                                                          └───────────────────────────┘└───────────────────────────┘                                                                                                                    

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             

┌───────────────────────────┐
│           PRAGMA          │
└───────────────────────────┘                             


Disable Lineage Capture

X {'RESULT_COLLECTOR0': 2.1e-05, 'LIMIT1': 0.000196, 'ORDER_BY2': 0.000621, 'HASH_GROUP_BY3': 0.003252, 'PROJECTION4': 4e-06, 'PROJECTION5': 4.3e-05, 'RIGHT_DELIM_JOIN6': 0.01426, 'RIGHT_DELIM_JOIN7': 0.092329, 'HASH_JOIN8': 0.138422, 'SEQ_SCAN 9': 0.068638, 'HASH_JOIN10': 0.128827, 'FILTER11': 0.063746, 'SEQ_SCAN 12': 0.035626, 'HASH_JOIN13': 0.000104, 'SEQ_SCAN 14': 0.000258, 'SEQ_SCAN 15': 2.7e-05, 'HASH_JOIN16': 0.068942, 'PROJECTION17': 0.00129, 'HASH_JOIN18': 0.178016, 'SEQ_SCAN 19': 0.012881, 'DELIM_SCAN20': 0.0, 'DUMMY_SCAN21': 0.0, 'HASH_GROUP_BY22': 0.008613, 'HASH_JOIN23': 0.03734, 'PROJECTION24': 0.000496, 'HASH_JOIN25': 0.205292, 'FILTER26': 0.04506, 'SEQ_SCAN 27': 0.020194, 'DELIM_SCAN28': 0.0, 'DUMMY_SCAN29': 0.0, 'HASH_GROUP_BY30': 0.011192}
**** output size:  100
LINEAGE_5_FILTER_1
LINEAGE_5_FILTER_17
LINEAGE_5_HASH_GROUP_BY_14
LINEAGE_5_HASH_GROUP_BY_27
LINEAGE_5_HASH_GROUP_BY_7
LINEAGE_5_HASH_JOIN_10
LINEAGE_5_HASH_JOIN_13
LINEAGE_5_HASH_JOIN_20
LINEAGE_5_HASH_JOIN_21
LINEAGE_5_HASH_JOIN_22
LINEAGE_5_HASH_JOIN_3
LINEAGE_5_HASH_JOIN_6
LINEAGE_5_LIMIT_29
LINEAGE_5_ORDER_BY_28
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_15
LINEAGE_5_SEQ_SCAN_16
LINEAGE_5_SEQ_SCAN_18
LINEAGE_5_SEQ_SCAN_19
LINEAGE_5_SEQ_SCAN_8
SELECT s_name, count(*) AS numwait FROM supplier, lineitem l1, orders, nation WHERE s_suppkey = l1.l_suppkey AND o_orderkey = l1.l_orderkey AND o_orderstatus = 'F' AND l1.l_receiptdate > l1.l_commitdate AND EXISTS ( SELECT * FROM lineitem l2 WHERE l2.l_orderkey = l1.l_orderkey AND l2.l_suppkey <> l1.l_suppkey) AND NOT EXISTS ( SELECT * FROM lineitem l3 WHERE l3.l_orderkey = l1.l_orderkey AND l3.l_suppkey <> l1.l_suppkey AND l3.l_receiptdate > l3.l_commitdate) AND s_nationkey = n_nationkey AND n_name = 'SAUDI ARABIA' GROUP BY s_name ORDER BY numwait DESC, s_name LIMIT 100;
   query_id  ...                                               plan
0         5  ...  {"name": "LIMIT", "opid": "29", "children": [{...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               SELECT s_name, count(*) AS numwait FROM suppli...
size_bytes_max                                               11334716
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "LIMIT", "opid": "29", "children": [{...
Name: 0, dtype: object
{"name": "LIMIT", "opid": "29", "children": [{"name": "ORDER_BY", "opid": "28", "children": [{"name": "HASH_GROUP_BY", "opid": "27", "children": [{"name": "PROJECTION", "opid": "26", "children": [{"name": "PROJECTION", "opid": "25", "children": [{"name": "RIGHT_DELIM_JOIN", "opid": "24", "children": [{"name": "HASH_GROUP_BY", "opid": "7", "children": [],"table": "","extra": "#0\n#1"},{"name": "HASH_JOIN", "opid": "6", "children": [{"name": "PROJECTION", "opid": "4", "children": [{"name": "HASH_JOIN", "opid": "3", "children": [{"name": "FILTER", "opid": "1", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_suppkey\nl_receiptdate\nl_commitdate\n[INFOSEPARATOR]\nEC: 6001215"}],"table": "","extra": "(l_receiptdate > l_commitdate)\n[INFOSEPARATOR]\nEC: 6001215"},{"name": "DELIM_SCAN", "opid": "2", "children": [],"table": "","extra": ""}],"table": "","extra": "INNER\nl_orderkey = l_orderkey\nl_suppkey != l_suppkey\n\n[INFOSEPARATOR]\nEC: 1200243\n"}],"table": "","extra": "l_orderkey\nl_suppkey\n"},{"name": "DUMMY_SCAN", "opid": "5", "children": [],"table": "","extra": ""}],"table": "","extra": "RIGHT_ANTI\nl_orderkey IS NOT DISTINCT FROM l_orderkey\nl_suppkey IS NOT DISTINCT FROM l_suppkey\n\n[INFOSEPARATOR]\nEC: 6001215\n"},{"name": "RIGHT_DELIM_JOIN", "opid": "23", "children": [{"name": "HASH_GROUP_BY", "opid": "14", "children": [],"table": "","extra": "#0\n#1"},{"name": "HASH_JOIN", "opid": "13", "children": [{"name": "PROJECTION", "opid": "11", "children": [{"name": "HASH_JOIN", "opid": "10", "children": [{"name": "SEQ_SCAN ", "opid": "8", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_orderkey\nl_suppkey\n[INFOSEPARATOR]\nEC: 6001215"},{"name": "DELIM_SCAN", "opid": "9", "children": [],"table": "","extra": ""}],"table": "","extra": "INNER\nl_orderkey = l_orderkey\nl_suppkey != l_suppkey\n\n[INFOSEPARATOR]\nEC: 6001215\n"}],"table": "","extra": "l_orderkey\nl_suppkey\n"},{"name": "DUMMY_SCAN", "opid": "12", "children": [],"table": "","extra": ""}],"table": "","extra": "RIGHT_SEMI\nl_orderkey IS NOT DISTINCT FROM l_orderkey\nl_suppkey IS NOT DISTINCT FROM l_suppkey\n\n[INFOSEPARATOR]\nEC: 6001215\n"},{"name": "HASH_JOIN", "opid": "22", "children": [{"name": "SEQ_SCAN ", "opid": "15", "children": [],"table": "orders","extra": "orders\n[INFOSEPARATOR]\no_orderkey\n[INFOSEPARATOR]\nFilters: o_orderstatus='F' AND o_orderstatus IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 500000"},{"name": "HASH_JOIN", "opid": "21", "children": [{"name": "FILTER", "opid": "17", "children": [{"name": "SEQ_SCAN ", "opid": "16", "children": [],"table": "lineitem","extra": "lineitem\n[INFOSEPARATOR]\nl_suppkey\nl_orderkey\nl_receiptdate\nl_commitdate\n[INFOSEPARATOR]\nEC: 1200243"}],"table": "","extra": "(l_receiptdate > l_commitdate)\n[INFOSEPARATOR]\nEC: 1200243"},{"name": "HASH_JOIN", "opid": "20", "children": [{"name": "SEQ_SCAN ", "opid": "18", "children": [],"table": "supplier","extra": "supplier\n[INFOSEPARATOR]\ns_suppkey\ns_nationkey\ns_name\n[INFOSEPARATOR]\nEC: 10000"},{"name": "SEQ_SCAN ", "opid": "19", "children": [],"table": "nation","extra": "nation\n[INFOSEPARATOR]\nn_nationkey\n[INFOSEPARATOR]\nFilters: n_name='SAUDI ARABIA' AND n_name IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 1"}],"table": "","extra": "INNER\ns_nationkey = n_nationkey\n\n[INFOSEPARATOR]\nBuild Min: 0\nBuild Max: 24\n\n[INFOSEPARATOR]\nEC: 400\n"}],"table": "","extra": "INNER\nl_suppkey = s_suppkey\n\n[INFOSEPARATOR]\nBuild Min: 1\nBuild Max: 10000\n\n[INFOSEPARATOR]\nEC: 47600\n"}],"table": "","extra": "INNER\no_orderkey = l_orderkey\n\n[INFOSEPARATOR]\nEC: 15866\n"}],"table": "","extra": "RIGHT_SEMI\nl_orderkey IS NOT DISTINCT FROM l_orderkey\nl_suppkey IS NOT DISTINCT FROM l_suppkey\n\n[INFOSEPARATOR]\nEC: 6001215\n"}],"table": "","extra": "RIGHT_ANTI\nl_orderkey IS NOT DISTINCT FROM l_orderkey\nl_suppkey IS NOT DISTINCT FROM l_suppkey\n\n[INFOSEPARATOR]\nEC: 6001215\n"}],"table": "","extra": "__internal_compress_integral_uinteger(#0, 1)\n__internal_compress_integral_usmallint(#1, 1)\n__internal_compress_integral_uinteger(#2, 1)\n#3\n"}],"table": "","extra": "s_name\n"}],"table": "","extra": "#0\ncount_star()"}],"table": "","extra": "ORDERS:\ncount_star() DESC\nsupplier.s_name ASC"}],"table": "","extra": ""}
%%%%%%%%%%%%%%%% Running Query #  22  threads:  16
SELECT cntrycode, count(*) AS numcust, sum(c_acctbal) AS totacctbal FROM ( SELECT substring(c_phone FROM 1 FOR 2) AS cntrycode, c_acctbal FROM customer WHERE substring(c_phone FROM 1 FOR 2) IN ('13', '31', '23', '29', '30', '18', '17') AND c_acctbal > ( SELECT avg(c_acctbal) FROM customer WHERE c_acctbal > 0.00 AND substring(c_phone FROM 1 FOR 2) IN ('13', '31', '23', '29', '30', '18', '17')) AND NOT EXISTS ( SELECT * FROM orders WHERE o_custkey = c_custkey)) AS custsale GROUP BY cntrycode ORDER BY cntrycode;
Run:  None SELECT cntrycode, count(*) AS numcust, sum(c_acctbal) AS totacctbal FROM ( SELECT substring(c_phone FROM 1 FOR 2) AS cntrycode, c_acctbal FROM customer WHERE substring(c_phone FROM 1 FOR 2) IN ('13', '31', '23', '29', '30', '18', '17') AND c_acctbal > ( SELECT avg(c_acctbal) FROM customer WHERE c_acctbal > 0.00 AND substring(c_phone FROM 1 FOR 2) IN ('13', '31', '23', '29', '30', '18', '17')) AND NOT EXISTS ( SELECT * FROM orders WHERE o_custkey = c_custkey)) AS custsale GROUP BY cntrycode ORDER BY cntrycode;
Avg Time in sec:  0.06377134239301085  output size:  7
  cntrycode  numcust  totacctbal
0        13      888  6737713.99
1        17      861  6460573.72
2        18      964  7236687.40
3        23      892  6701457.95
4        29      948  7158866.63
5        30      909  6808436.13
6        31      922  6806670.18
compressed filter_log_size: 42685
compressed filter_log_buffer_size: 37254
compressed limit_offset_size: 3024
compressed limit_offset_buffer_size: 0
compressed perfect_full_scan_ht_log_size: 2880
compressed perfect_full_scan_ht_log_buffer_size: 0
compressed perfect_probe_ht_log_size: 2880
compressed perfect_probe_ht_log_buffer_size: 0
compressed row_group_log_size: 29314
compressed row_group_log_buffer_size: 17936
compressed scatter_log_size: 101609
compressed scatter_log_buffer_size: 97873
compressed scatter_sel_log_size: 125031
compressed scatter_sel_log_buffer_size: 118576
compressed gather_log_size: 2880
compressed gather_log_buffer_size: 0
compressed combine_log_size: 6608
compressed combine_log_buffer_size: 2000
compressed finalize_states_log_size: 8103
compressed finalize_states_log_buffer_size: 3491
compressed join_gather_log_size: 2014884
compressed join_gather_log_buffer_size: 1958687
compressed reorder_log_size: 4640
compressed reorder_log_buffer_size: 0
compressed cross_log_size: 2880
compressed cross_log_buffer_size: 0
compressed nlj_log_size: 12068
compressed nlj_log_buffer_size: 7419
compressed total_size: 2359486
compressed total_buffer_size: 2243236
compressed total_element_size: 116250

{'name': 'Query', 'result': 0.056274, 'timing': 0.056274, 'cardinality': 0, 'extra-info': "SELECT cntrycode, count(*) AS numcust, sum(c_acctbal) AS totacctbal FROM ( SELECT substring(c_phone FROM 1 FOR 2) AS cntrycode, c_acctbal FROM customer WHERE substring(c_phone FROM 1 FOR 2) IN ('13', '31', '23', '29', '30', '18', '17') AND c_acctbal > ( SELECT avg(c_acctbal) FROM customer WHERE c_acctbal > 0.00 AND substring(c_phone FROM 1 FOR 2) IN ('13', '31', '23', '29', '30', '18', '17')) AND NOT EXISTS ( SELECT * FROM orders WHERE o_custkey = c_custkey)) AS custsale GROUP BY cntrycode ORDER BY cntrycode;", 'timings': [], 'children': [{'name': 'RESULT_COLLECTOR', 'timing': 1e-05, 'cardinality': 0, 'extra_info': '', 'children': [{'name': 'ORDER_BY', 'timing': 0.000192, 'cardinality': 7, 'extra_info': 'ORDERS:\ncustsale.cntrycode ASC', 'children': [{'name': 'HASH_GROUP_BY', 'timing': 0.001864, 'cardinality': 7, 'extra_info': '#0\ncount_star()\nsum(#1)', 'children': [{'name': 'PROJECTION', 'timing': 5e-06, 'cardinality': 6384, 'extra_info': 'cntrycode\nc_acctbal\n', 'children': [{'name': 'PROJECTION', 'timing': 0.000271, 'cardinality': 6384, 'extra_info': 'cntrycode\nc_acctbal\n', 'children': [{'name': 'RIGHT_DELIM_JOIN', 'timing': 0.006828, 'cardinality': 0, 'extra_info': 'RIGHT_ANTI\nc_custkey IS NOT DISTINCT FROM c_custkey\n\n[INFOSEPARATOR]\nEC: 1500000\n', 'children': [{'name': 'NESTED_LOOP_JOIN', 'timing': 0.002438, 'cardinality': 19000, 'extra_info': 'INNER\nCAST(c_acctbal AS DOUBLE) > SUBQUERY\n\n[INFOSEPARATOR]\nEC: 0\n', 'children': [{'name': 'FILTER', 'timing': 0.001202, 'cardinality': 42015, 'extra_info': 'IN (...)\n[INFOSEPARATOR]\nEC: 30000', 'children': [{'name': 'HASH_JOIN', 'timing': 0.01014, 'cardinality': 150000, 'extra_info': 'MARK\nsubstring(c_phone, 1, 2) = #0\n\n[INFOSEPARATOR]\nEC: 150000\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.003623, 'cardinality': 150000, 'extra_info': 'customer\n[INFOSEPARATOR]\nc_phone\nc_acctbal\nc_custkey\n[INFOSEPARATOR]\nEC: 150000', 'children': []}, {'name': 'COLUMN_DATA_SCAN', 'timing': 8e-06, 'cardinality': 7, 'extra_info': '', 'children': []}]}]}, {'name': 'UNGROUPED_AGGREGATE', 'timing': 2e-06, 'cardinality': 1, 'extra_info': 'first(#0)', 'children': [{'name': 'PROJECTION', 'timing': 1e-06, 'cardinality': 1, 'extra_info': '#0\n', 'children': [{'name': 'STREAMING_LIMIT', 'timing': 2e-06, 'cardinality': 1, 'extra_info': '', 'children': [{'name': 'UNGROUPED_AGGREGATE', 'timing': 0.000224, 'cardinality': 1, 'extra_info': 'avg(#0)', 'children': [{'name': 'PROJECTION', 'timing': 2.2e-05, 'cardinality': 38120, 'extra_info': 'c_acctbal\n', 'children': [{'name': 'PROJECTION', 'timing': 3.6e-05, 'cardinality': 38120, 'extra_info': '#0\n#2\n', 'children': [{'name': 'FILTER', 'timing': 0.001187, 'cardinality': 38120, 'extra_info': 'IN (...)\n[INFOSEPARATOR]\nEC: 6000', 'children': [{'name': 'HASH_JOIN', 'timing': 0.011923, 'cardinality': 136308, 'extra_info': 'MARK\nsubstring(c_phone, 1, 2) = #0\n\n[INFOSEPARATOR]\nEC: 30000\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.006097, 'cardinality': 136308, 'extra_info': 'customer\n[INFOSEPARATOR]\nc_acctbal\nc_phone\n[INFOSEPARATOR]\nFilters: c_acctbal>0.00 AND c_acctbal IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 30000', 'children': []}, {'name': 'COLUMN_DATA_SCAN', 'timing': 1.4e-05, 'cardinality': 7, 'extra_info': '', 'children': []}]}]}]}]}]}]}]}]}]}, {'name': 'HASH_JOIN', 'timing': 0.042502, 'cardinality': 6384, 'extra_info': 'RIGHT_ANTI\nc_custkey IS NOT DISTINCT FROM c_custkey\n\n[INFOSEPARATOR]\nEC: 1500000\n', 'children': [{'name': 'PROJECTION', 'timing': 0.000516, 'cardinality': 190069, 'extra_info': 'c_custkey\n', 'children': [{'name': 'HASH_JOIN', 'timing': 0.101895, 'cardinality': 190069, 'extra_info': 'INNER\no_custkey = c_custkey\n\n[INFOSEPARATOR]\nEC: 1500000\n', 'children': [{'name': 'SEQ_SCAN ', 'timing': 0.005107, 'cardinality': 1500000, 'extra_info': 'orders\n[INFOSEPARATOR]\no_custkey\n[INFOSEPARATOR]\nEC: 1500000', 'children': []}, {'name': 'DELIM_SCAN', 'timing': 0.0, 'cardinality': 0, 'extra_info': '', 'children': []}]}]}, {'name': 'DUMMY_SCAN', 'timing': 0.0, 'cardinality': 0, 'extra_info': '', 'children': []}]}, {'name': 'HASH_GROUP_BY', 'timing': 0.006323, 'cardinality': 19000, 'extra_info': '#2', 'children': []}]}]}]}]}]}]}]}
X {'RESULT_COLLECTOR0': 1e-05, 'ORDER_BY1': 0.000192, 'HASH_GROUP_BY2': 0.001864, 'PROJECTION3': 5e-06, 'PROJECTION4': 0.000271, 'RIGHT_DELIM_JOIN5': 0.006828, 'NESTED_LOOP_JOIN6': 0.002438, 'FILTER7': 0.001202, 'HASH_JOIN8': 0.01014, 'SEQ_SCAN 9': 0.003623, 'COLUMN_DATA_SCAN10': 8e-06, 'UNGROUPED_AGGREGATE11': 2e-06, 'PROJECTION12': 1e-06, 'STREAMING_LIMIT13': 2e-06, 'UNGROUPED_AGGREGATE14': 0.000224, 'PROJECTION15': 2.2e-05, 'PROJECTION16': 3.6e-05, 'FILTER17': 0.001187, 'HASH_JOIN18': 0.011923, 'SEQ_SCAN 19': 0.006097, 'COLUMN_DATA_SCAN20': 1.4e-05, 'HASH_JOIN21': 0.042502, 'PROJECTION22': 0.000516, 'HASH_JOIN23': 0.101895, 'SEQ_SCAN 24': 0.005107, 'DELIM_SCAN25': 0.0, 'DUMMY_SCAN26': 0.0, 'HASH_GROUP_BY27': 0.006323}
**** output size:  7
LINEAGE_5_COLUMN_DATA_SCAN_12
LINEAGE_5_COLUMN_DATA_SCAN_8
LINEAGE_5_FILTER_10
LINEAGE_5_FILTER_14
LINEAGE_5_HASH_GROUP_BY_25
LINEAGE_5_HASH_GROUP_BY_6
LINEAGE_5_HASH_JOIN_13
LINEAGE_5_HASH_JOIN_2
LINEAGE_5_HASH_JOIN_5
LINEAGE_5_HASH_JOIN_9
LINEAGE_5_NESTED_LOOP_JOIN_21
LINEAGE_5_ORDER_BY_26
LINEAGE_5_SEQ_SCAN_0
LINEAGE_5_SEQ_SCAN_11
LINEAGE_5_SEQ_SCAN_7
LINEAGE_5_STREAMING_LIMIT_18
SELECT cntrycode, count(*) AS numcust, sum(c_acctbal) AS totacctbal FROM ( SELECT substring(c_phone FROM 1 FOR 2) AS cntrycode, c_acctbal FROM customer WHERE substring(c_phone FROM 1 FOR 2) IN ('13', '31', '23', '29', '30', '18', '17') AND c_acctbal > ( SELECT avg(c_acctbal) FROM customer WHERE c_acctbal > 0.00 AND substring(c_phone FROM 1 FOR 2) IN ('13', '31', '23', '29', '30', '18', '17')) AND NOT EXISTS ( SELECT * FROM orders WHERE o_custkey = c_custkey)) AS custsale GROUP BY cntrycode ORDER BY cntrycode;
   query_id  ...                                               plan
0         5  ...  {"name": "ORDER_BY", "opid": "26", "children":...

[1 rows x 7 columns]
Query info:  query_id                                                            5
query               SELECT cntrycode, count(*) AS numcust, sum(c_a...
size_bytes_max                                                2359486
size_bytes_min                                                      0
nchunks                                                             0
postprocess_time                                                  0.0
plan                {"name": "ORDER_BY", "opid": "26", "children":...
Name: 0, dtype: object
{"name": "ORDER_BY", "opid": "26", "children": [{"name": "HASH_GROUP_BY", "opid": "25", "children": [{"name": "PROJECTION", "opid": "24", "children": [{"name": "PROJECTION", "opid": "23", "children": [{"name": "RIGHT_DELIM_JOIN", "opid": "22", "children": [{"name": "HASH_GROUP_BY", "opid": "6", "children": [],"table": "","extra": "#2"},{"name": "HASH_JOIN", "opid": "5", "children": [{"name": "PROJECTION", "opid": "3", "children": [{"name": "HASH_JOIN", "opid": "2", "children": [{"name": "SEQ_SCAN ", "opid": "0", "children": [],"table": "orders","extra": "orders\n[INFOSEPARATOR]\no_custkey\n[INFOSEPARATOR]\nEC: 1500000"},{"name": "DELIM_SCAN", "opid": "1", "children": [],"table": "","extra": ""}],"table": "","extra": "INNER\no_custkey = c_custkey\n\n[INFOSEPARATOR]\nEC: 1500000\n"}],"table": "","extra": "c_custkey\n"},{"name": "DUMMY_SCAN", "opid": "4", "children": [],"table": "","extra": ""}],"table": "","extra": "RIGHT_ANTI\nc_custkey IS NOT DISTINCT FROM c_custkey\n\n[INFOSEPARATOR]\nEC: 1500000\n"},{"name": "NESTED_LOOP_JOIN", "opid": "21", "children": [{"name": "FILTER", "opid": "10", "children": [{"name": "HASH_JOIN", "opid": "9", "children": [{"name": "SEQ_SCAN ", "opid": "7", "children": [],"table": "customer","extra": "customer\n[INFOSEPARATOR]\nc_phone\nc_acctbal\nc_custkey\n[INFOSEPARATOR]\nEC: 150000"},{"name": "COLUMN_DATA_SCAN", "opid": "8", "children": [],"table": "","extra": ""}],"table": "","extra": "MARK\nsubstring(c_phone, 1, 2) = #0\n\n[INFOSEPARATOR]\nEC: 150000\n"}],"table": "","extra": "IN (...)\n[INFOSEPARATOR]\nEC: 30000"},{"name": "UNGROUPED_AGGREGATE", "opid": "20", "children": [{"name": "PROJECTION", "opid": "19", "children": [{"name": "STREAMING_LIMIT", "opid": "18", "children": [{"name": "UNGROUPED_AGGREGATE", "opid": "17", "children": [{"name": "PROJECTION", "opid": "16", "children": [{"name": "PROJECTION", "opid": "15", "children": [{"name": "FILTER", "opid": "14", "children": [{"name": "HASH_JOIN", "opid": "13", "children": [{"name": "SEQ_SCAN ", "opid": "11", "children": [],"table": "customer","extra": "customer\n[INFOSEPARATOR]\nc_acctbal\nc_phone\n[INFOSEPARATOR]\nFilters: c_acctbal>0.00 AND c_acctbal IS NOT NULL\n\n[INFOSEPARATOR]\nEC: 30000"},{"name": "COLUMN_DATA_SCAN", "opid": "12", "children": [],"table": "","extra": ""}],"table": "","extra": "MARK\nsubstring(c_phone, 1, 2) = #0\n\n[INFOSEPARATOR]\nEC: 30000\n"}],"table": "","extra": "IN (...)\n[INFOSEPARATOR]\nEC: 6000"}],"table": "","extra": "#0\n#2\n"}],"table": "","extra": "c_acctbal\n"}],"table": "","extra": "avg(#0)"}],"table": "","extra": ""}],"table": "","extra": "#0\n"}],"table": "","extra": "first(#0)"}],"table": "","extra": "INNER\nCAST(c_acctbal AS DOUBLE) > SUBQUERY\n\n[INFOSEPARATOR]\nEC: 0\n"}],"table": "","extra": "RIGHT_ANTI\nc_custkey IS NOT DISTINCT FROM c_custkey\n\n[INFOSEPARATOR]\nEC: 1500000\n"}],"table": "","extra": "cntrycode\nc_acctbal\n"}],"table": "","extra": "cntrycode\nc_acctbal\n"}],"table": "","extra": "#0\ncount_star()\nsum(#1)"}],"table": "","extra": "ORDERS:\ncustsale.cntrycode ASC"}
Clear Lineage

average 29.300773447210137
tpch_benchmark_capture_output_prefix_compress.csv
