# name: test/sql/lineage/l_orderby/test_orderby.test
# description: Test order by
# group: [l_orderby]


statement ok
PRAGMA explain_output = PHYSICAL_ONLY;

statement ok
CREATE TABLE t1(i INTEGER);

statement ok
INSERT INTO t1 SELECT i FROM range(0,200000) tbl(i);
INSERT INTO t1 SELECT i FROM range(0,5) tabl(i);


statement ok
PRAGMA threads=1

statement ok
PRAGMA enable_profiling;

statement ok
PRAGMA enable_lineage;

# No filter
statement ok
select * from t1 order by i

# filter from different chunks
statement ok
select * from t1 where i < 2 order by i

# filter from end chunks
statement ok
select * from t1 where i > 199995 order by i

# filter from first chunk
statement ok
select * from t1 where i=6 order by i

statement ok
PRAGMA disable_lineage;
PRAGMA disable_profiling;


query IIII
SELECT rowid, in_index, out_index, thread_id FROM LINEAGE_1_ORDER_BY_1_0 LIMIT 10
----
0	0	0	0
1	200000	1	0
2	1	2	0
3	200001	3	0
4	2	4	0
5	200002	5	0
6	3	6	0
7	200003	7	0
8	4	8	0
9	200004	9	0

query IIII
SELECT rowid, in_index, out_index, thread_id FROM LINEAGE_2_ORDER_BY_1_0
----
0	0	0	0
1	200000	1	0
2	1	2	0
3	200001	3	0


query IIII
SELECT rowid, in_index, out_index, thread_id FROM LINEAGE_3_ORDER_BY_1_0
----
0	199996	0	0
1	199997	1	0
2	199998	2	0
3	199999	3	0

query IIII
SELECT rowid, in_index, out_index, thread_id FROM LINEAGE_4_ORDER_BY_1_0
----
0	6	0	0
