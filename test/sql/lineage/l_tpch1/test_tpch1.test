# name: test/sql/lineage_v2/l_tpch1/test_tpch1.test
# description: Test TPCH 1
# group: [l_tpch1]

require tpch


statement ok
PRAGMA threads=1

statement ok
CALL dbgen(sf=0.01);

statement ok
PRAGMA enable_profiling;
PRAGMA enable_lineage;

query IIII
SELECT
    l_returnflag,
    l_linestatus,
    sum(l_quantity) AS sum_qty,
    count(*) AS count_order
FROM
    lineitem
GROUP BY
    l_returnflag,
    l_linestatus
----
N	O	765251.00	30049
R	F	381449.00	14902
A	F	380456.00	14876
N	F	8971.00	348

statement ok
PRAGMA disable_lineage;
PRAGMA disable_optimizer;


query II
select  l_returnflag,
           l_linestatus
from lineitem
where rowid=59870
----

query III
select * from LINEAGE_1_HASH_GROUP_BY_2_0 as src
----

