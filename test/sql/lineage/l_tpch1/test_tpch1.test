# name: test/sql/lineage_v2/l_tpch1/test_tpch1.test
# description: Test TPCH 1
# group: [l_tpch1]

require tpch


statement ok
PRAGMA threads=1

statement ok
CALL dbgen(sf=0.01);

statement ok
PRAGMA enable_profiling;
PRAGMA enable_lineage;

statement ok
SELECT
    l_orderkey,
    o_orderdate,
    o_shippriority,
FROM
    customer,
    orders,
    lineitem
WHERE
    c_mktsegment = 'BUILDING'
    AND c_custkey = o_custkey
    AND l_orderkey = o_orderkey
    AND o_orderdate < CAST('1995-03-15' AS date)
    AND l_shipdate > CAST('1995-03-15' AS date)

statement ok
PRAGMA disable_lineage;
PRAGMA disable_optimizer;


query III
select * from LINEAGE_1_HASH_JOIN_3_0 as src
----