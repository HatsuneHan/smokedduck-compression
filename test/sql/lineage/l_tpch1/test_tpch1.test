# name: test/sql/lineage_v2/l_tpch1/test_tpch1.test
# description: Test TPCH 1
# group: [l_tpch1]

require tpch


statement ok
PRAGMA threads=1

statement ok
CALL dbgen(sf=0.01);

statement ok
PRAGMA enable_profiling;
PRAGMA enable_lineage;

statement ok
SELECT supp_nation, cust_nation, l_year, sum(volume) AS revenue FROM ( SELECT n1.n_name AS supp_nation, n2.n_name AS cust_nation, extract(year FROM l_shipdate) AS l_year, l_extendedprice * (1 - l_discount) AS volume FROM supplier, lineitem, orders, customer, nation n1, nation n2 WHERE s_suppkey = l_suppkey AND o_orderkey = l_orderkey AND c_custkey = o_custkey AND s_nationkey = n1.n_nationkey AND c_nationkey = n2.n_nationkey AND ((n1.n_name = 'FRANCE' AND n2.n_name = 'GERMANY') OR (n1.n_name = 'GERMANY' AND n2.n_name = 'FRANCE')) AND l_shipdate BETWEEN CAST('1995-01-01' AS date) AND CAST('1996-12-31' AS date)) AS shipping GROUP BY supp_nation, cust_nation, l_year;

statement ok
PRAGMA disable_lineage;
PRAGMA disable_optimizer;


query III
select * from LINEAGE_1_HASH_JOIN_5_0 as src
----