# name: test/sql/lineage_v2/l_aggs/test_hash_agg.test
# description: Test Hash Aggregate Lineage
# group: [l_aggs]

statement ok
PRAGMA explain_output = PHYSICAL_ONLY;
PRAGMA threads=1;

statement ok
CREATE TABLE t1(i VARCHAR(10), j INTEGER);

statement ok
INSERT INTO t1 VALUES ('Haneen', 2),  ('Omar', 2), ('Haneen', 4), ('Mohammed', 1), ('Omar', 1), ('Haneen', 3), ('Mohammed', 2), ('Omar', 1)

statement ok
PRAGMA enable_lineage;

# standalone limit
query III
select i, list(j) , list(distinct j) from t1 GROUP BY i
----
Haneen	[2, 4, 3]	[2, 4, 3]
Omar	[2, 1, 1]	[2, 1]
Mohammed	[1, 2]	[1, 2]

statement ok
PRAGMA disable_lineage;
PRAGMA disable_optimizer;
PRAGMA threads=1;

query II
select in_index, out_index from LINEAGE_1_HASH_GROUP_BY_2_0
order by in_index
----
0	0
1	1
2	0
3	2
4	1
5	0
6	2
7	1


### add distinct
### add grouping set
### add having

