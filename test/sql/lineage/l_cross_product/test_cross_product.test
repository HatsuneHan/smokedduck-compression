# name: test/sql/lineage/l_cross_product/test_cross_product.test
# description: Test Cross Product Lineage
# group: [l_cross_product]

statement ok
CREATE TABLE t1(i INTEGER, j INTEGER);
CREATE TABLE t2(j INTEGER, k INTEGER);

statement ok
INSERT INTO t1 VALUES (1, 5), (1, 4), (2, 2);
INSERT INTO t2 VALUES (3, 7), (2, 4);

statement ok
PRAGMA enable_lineage;
PRAGMA persist_lineage;
PRAGMA compress_lineage;

query IIII
SELECT t1.i, t1.j AS t1_j, t2.j AS t2_j, t2.k FROM t1 CROSS JOIN t2;
----
1	5	3	7
1	4	3	7
2	2	3	7
1	5	2	4
1	4	2	4
2	2	2	4

statement ok
PRAGMA disable_lineage;
PRAGMA disable_optimizer;

query II
select in_index, out_index from LINEAGE_3_SEQ_SCAN_0
----
0	0
1	1
2	2

query II
select in_index, out_index from LINEAGE_3_SEQ_SCAN_1
----
0	0
1	1

query III
select lhs_index, rhs_index, out_index from LINEAGE_3_CROSS_PRODUCT_2
----
0	0	0
1	0	1
2	0	2
0	1	3
1	1	4
2	1	5



