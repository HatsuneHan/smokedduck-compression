# name: test/sql/lineage/l_filter/test_filter.test
# description: Test Filter Lineage
# group: [l_filter]

statement ok
PRAGMA explain_output = PHYSICAL_ONLY;

statement ok
CREATE TABLE t1(i INTEGER);

statement ok
INSERT INTO t1 SELECT i FROM range(0,4000) tbl(i);


statement ok
PRAGMA enable_lineage;
PRAGMA persist_lineage;
PRAGMA compress_lineage;

query II
select rowid, * from t1 where 2 > i  OR i > 3998
----
0	0
1	1
3999	3999

query II
select rowid, * from t1 where i > 4000 OR i > 3998 OR i < 5 OR (i > 1005 AND i < 1050)
----
0	0
1	1
2	2
3	3
4	4
1006	1006
1007	1007
1008	1008
1009	1009
1010	1010
1011	1011
1012	1012
1013	1013
1014	1014
1015	1015
1016	1016
1017	1017
1018	1018
1019	1019
1020	1020
1021	1021
1022	1022
1023	1023
1024	1024
1025	1025
1026	1026
1027	1027
1028	1028
1029	1029
1030	1030
1031	1031
1032	1032
1033	1033
1034	1034
1035	1035
1036	1036
1037	1037
1038	1038
1039	1039
1040	1040
1041	1041
1042	1042
1043	1043
1044	1044
1045	1045
1046	1046
1047	1047
1048	1048
1049	1049
3999	3999


statement ok
PRAGMA disable_lineage;

query I
select count() from LINEAGE_3_SEQ_SCAN_0
----
4000

query I
select count() from LINEAGE_4_SEQ_SCAN_0
----
4000


query III
select rowid, in_index, out_index from LINEAGE_3_FILTER_1
----
0	0	0
1	1	1
2	3999	2


query III
select rowid, in_index, out_index from LINEAGE_4_FILTER_1
----
0	0	0
1	1	1
2	2	2
3	3	3
4	4	4
5	1006	5
6	1007	6
7	1008	7
8	1009	8
9	1010	9
10	1011	10
11	1012	11
12	1013	12
13	1014	13
14	1015	14
15	1016	15
16	1017	16
17	1018	17
18	1019	18
19	1020	19
20	1021	20
21	1022	21
22	1023	22
23	1024	23
24	1025	24
25	1026	25
26	1027	26
27	1028	27
28	1029	28
29	1030	29
30	1031	30
31	1032	31
32	1033	32
33	1034	33
34	1035	34
35	1036	35
36	1037	36
37	1038	37
38	1039	38
39	1040	39
40	1041	40
41	1042	41
42	1043	42
43	1044	43
44	1045	44
45	1046	45
46	1047	46
47	1048	47
48	1049	48
49	3999	49


statement ok
PRAGMA clear_lineage;
